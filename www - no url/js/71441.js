"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[71441],{71441:function(e,o,t){t.r(o),t.d(o,{default:function(){return _}});var n=t(8445),s=t.n(n),i=t(61758),r=t(29104),a={class:"col column"},l={key:0,class:"col scroll-y"},c={class:"row"},u={class:"row q-pa-sm"},d={class:"row"},m={class:"col column"};function f(e,o){var t=(0,i.g2)("sie-salones"),n=(0,i.g2)("sie-estudiantes"),f=(0,i.g2)("q-toolbar-title"),h=(0,i.g2)("q-btn"),p=(0,i.g2)("q-toolbar"),g=(0,i.g2)("sie-curso"),C=(0,i.g2)("q-infinite-scroll"),v=(0,i.g2)("sie-vacio"),O=(0,i.g2)("q-input"),$=(0,i.g2)("q-field"),k=(0,i.g2)("sie-upload"),b=(0,i.g2)("sie-modal"),I=(0,i.g2)("q-page");return(0,i.uX)(),(0,i.Wv)(I,{class:"column curso"},{default:(0,i.k6)(function(){return[-1===["004","005"].indexOf(e.sie.tipcod)?((0,i.uX)(),(0,i.Wv)(t,{key:0,modelValue:e.nemo,"onUpdate:modelValue":o[0]||(o[0]=function(o){return e.nemo=o}),onSeleccionar:e.seleccionarSalon,campos:["NEMO","NEMODES","INSTRUCOD","GRADOCOD"]},null,8,["modelValue","onSeleccionar"])):((0,i.uX)(),(0,i.Wv)(n,{key:1,modelValue:e.alucod,"onUpdate:modelValue":o[1]||(o[1]=function(o){return e.alucod=o}),onSelected:e.seleccionarAlumno},null,8,["modelValue","onSelected"])),(0,i.Lk)("div",a,[(0,i.bF)(p,{class:"shadow-2 z-fab",inverted:""},{default:(0,i.k6)(function(){return[(0,i.bF)(f,{class:"q-pa-none"},{default:(0,i.k6)(function(){return s()(o[4]||(o[4]=[(0,i.eW)("Cursos",-1)]))}),_:1}),e.hasReporte?((0,i.uX)(),(0,i.Wv)(h,{key:0,flat:"",round:"",icon:"print",onClick:e.goReportes},null,8,["onClick"])):(0,i.Q3)("v-if",!0),e.hasInforme?((0,i.uX)(),(0,i.Wv)(h,{key:1,flat:"",round:"",icon:"insert_chart",onClick:e.goInformes},null,8,["onClick"])):(0,i.Q3)("v-if",!0)]}),_:1}),e.cursos.length>0?((0,i.uX)(),(0,i.CE)("div",l,[(0,i.bF)(C,{handler:e.cargarContenido,ref:"infiniteScroll"},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",c,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.cursos,function(o,t){return(0,i.uX)(),(0,i.Wv)(g,{key:o.KEY,class:"col-xs-12 col-sm-6 col-md-4 col-lg-3",onClick:function(t){return e.detalleCurso(o)},title:o.CURSONOM,author:o.NOMCOMP,src:o.IMG,enlace:o.ENLACE},{default:(0,i.k6)(function(){return[e.accesoTotal?((0,i.uX)(),(0,i.Wv)(h,{key:0,class:"absolute-top-right",flat:"",round:"",icon:"edit",color:"faded",onClick:(0,r.D$)(function(t){return e.editarCurso(o)},["stop"])},null,8,["onClick"])):(0,i.Q3)("v-if",!0)]}),_:2},1032,["onClick","title","author","src","enlace"])}),128))])]}),_:1},8,["handler"])])):((0,i.uX)(),(0,i.Wv)(v,{key:1,class:"col"}))]),(0,i.bF)(b,{class:"modal-imagencurso",modelValue:e.modalEditarCurso,"onUpdate:modelValue":o[3]||(o[3]=function(o){return e.modalEditarCurso=o}),title:"Editar",ref:"modalEditarCurso",header:!0,footer:!0,onSubmit:e.editarImagen},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",u,[(0,i.bF)($,{class:"col-12",error:e.v$.descripcion.$error,"error-label":e.$t("validaciones.requerido")},{default:(0,i.k6)(function(){return[(0,i.bF)(O,{class:"q-if-outlined",type:"textarea",modelValue:e.v$.descripcion.$model,"onUpdate:modelValue":o[2]||(o[2]=function(o){return e.v$.descripcion.$model=o}),modelModifiers:{trim:!0},"float-label":e.$t("matricula.descripcion")+"*"},null,8,["modelValue","float-label"])]}),_:1},8,["error","error-label"])]),(0,i.Lk)("div",d,[(0,i.Lk)("div",m,[(0,i.bF)(k,{class:"no-wrap imagen",onUpload:e.added,botones:!1,icon:"wallpaper",src:e.imagen,allow:["jpg","png","jpeg","bmp"]},null,8,["onUpload","src"])])])]}),_:1},8,["modelValue","onSubmit"])]}),_:1})}var h=t(76080),p=t.n(h),g=t(45254),C=t.n(g),v=t(57008),O=t.n(v),$=(t(30683),t(71225),t(52133),t(10239),t(56285),t(50310),t(5962),t(6724),t(11777),t(83190),t(83972)),k=t(6123),b=t(36153),I=t(82640),S=t(88275),y=t(92173),M=t(80340),E=t(57668),A=t(91134),U=t.n(A),w={emits:["click","update:modelValue","input"],render:function(){var e=this;return(0,i.h)(k.H0,{class:"bg-white",separator:!0,onClick:this.elegirItem},{default:function(){return[(0,i.h)("img",U()({class:"img-libro",src:e.data.IMG,loading:"lazy"},"src",e.data.IMG)),(0,i.h)(k.mF,{},{default:function(){return[(0,i.h)(k.lp,{class:"text-weight-bold text-weight-bold",label:!0},{default:function(){return e.data.CURSONOM}}),(0,i.h)(k.lp,{sublabel:!0,upper:!0},{default:function(){return e.data.NOMCOMP}})]}})]}})},methods:{elegirItem:function(){this.$emit("click",this.data)},cambiarInput:function(){this.$emit("update:modelValue",this.modelValue),this.$emit("input",this.modelValue)}},data:function(){return{cinput:"fff"}},computed:{},props:["detalleCurso","data","value"]},N=t(51073),P=t(36980),V=t(30640),D=t(59089),R=t(33950),q=t(982),G=t(80660),Q=t(84569),x=t(29706),F="intranet.informes",T="intranet.reportesInstrumento",X={setup:function(){var e=(0,$.fG)();return{v$:e}},props:{recuperacion:{type:Number,default:0}},components:{sieUpload:D.A,sieModal:V.A,sieEstudiantes:y.Ay,QInfiniteScroll:k.nN,QCard:k.C$,QSearch:k.Ks,sieSalones:S.Ay,sieVacio:M.A,QPopover:k.VM,itemCurso:w,Loading:b.A,sieCurso:x.A,QPage:k.Tu,QToolbar:k.ZV,QToolbarTitle:k.r_,QBtn:k.Il,QField:k.Om,QInput:k.ie},data:function(){return{$upload:null,file$:null,dataImagen:{},sie:(0,E["default"])(),descripcion:"",imagen:"",stopScroll:!1,modalEditarCurso:!1,datos:{},itemSeleccionado:"todos",keyPeriodos:[],keyCursos:[],dataCursos:[],instrucod:"",gradocod:""}},computed:O()(O()({},(0,P.aH)("clase",["cursos","periodos","cursonom","peticiones","limitCursos","alucod","usucodAlumno"])),{},{nemo:{get:function(){return this.$store.state.clase.nemo},set:function(e){this.$store.commit("clase/setNemo",e)}},alucod:{get:function(){return this.$store.state.clase.alucod},set:function(e){this.$store.commit("clase/setAlucod",e)}},accesoTotal:function(){return this.sie.esOtros&&3===this.sie.ruta.nivel&&-1===["0090"].indexOf(this.sie.colcod)},hasReporte:function(){return!0===this.sie.esOtros&&(0,Q.yy)(T)},hasInforme:function(){return!0===this.sie.esOtros&&(0,Q.yy)(F)}}),methods:{added:function(e){this.file$=e[0]},editarImagen:function(){var e=this;return C()(p()().m(function o(){var t,n,i,r,a,l,c,u;return p()().w(function(o){while(1)switch(o.p=o.n){case 0:if(e.v$.$touch(),!e.v$.$error){o.n=1;break}return o.a(2,!1);case 1:return t=e.dataImagen,n=e,i=e.file$,r={cursocod:t.CURSOCOD,descripcion:n.descripcion,flEliminar:0,grupocod:t.GRUPOCOD,nemo:n.nemo},o.p=2,o.n=3,(0,R.Basic)({url:"api/HyoArchivo/tmp/upload",file:i,onProgress:function(e,o){}});case 3:a=o.v,l=a.result.files.file,r.imagen=l[0].originalFilename,r.imagenTemp=l[0].name,r.flEliminar=1,o.n=5;break;case 4:o.p=4,o.v;case 5:return o.p=5,o.n=6,G.$http.post("api/HyoCursoGrupo/registraDatos",r);case 6:c=s()(n.cursos),c.map(function(e){return e.KEY===t.KEY&&(e.IMG=e.IMG+"&datetime=".concat((new Date).getTime())),e}),n.$store.commit("clase/setCursos",c),(0,q["default"])("actualizado"),e.modalEditarCurso=!1,o.n=8;break;case 7:o.p=7,u=o.v,console.error(u),(0,q["default"])("No pudo actualizar completamente","error");case 8:return o.a(2)}},o,null,[[5,7],[2,4]])}))()},editarCurso:function(e){this.dataImagen=e,this.descripcion=e.DESCRIPCION,this.imagen=e.IMG,this.modalEditarCurso=!0},cargarContenido:function(e,o,t){this.peticiones[this.nemo]&&!this.peticiones[this.nemo].ajax.isPending()&&this.getCursos({nemo:this.nemo},o)},seleccionarAlumno:function(e){if(this.$store.commit("clase/setUsucodAlumno",e.USUCOD),e.NEMO){var o=e.NEMO,t=e.ALUCOD;this.alucod=t,this.nemo=o,this.seleccionarSalon(e)}},seleccionarSalon:function(e){this.instrucod=e.INSTRUCOD,this.gradocod=e.GRADOCOD,this.peticiones.hasOwnProperty(this.nemo)||this.$store.commit("clase/setInitPeticiones",this.nemo),this.stopScroll&&this.$refs.infiniteScroll.resume(),b.A.show(),this.cargarContenido()},detalleCurso:function(e){var o=e.CURSOCOD,t=e.GRUPOCOD,n=e.CURSONOM,s=e.NEMO,i=e.NOMCOMP,r=s||this.nemo;this.$router.push({name:"intranet.clase.contenido",params:{nemo:r,cursocod:o,grupocod:t}}),this.$store.commit("clase/setCursonom",n),this.$store.commit("clase/setProfesor",i)},getCursos:function(e,o){var t=this,n=e.nemo,s=this.$store;if(this.datos.hasOwnProperty(n)||(this.$store.commit("clase/setInitPeticiones",n),this.datos[n]={cursos:[]}),this.peticiones[n].lastAjaxLength<this.limitCursos&&(this.stopScroll=!0,"function"===typeof o))return o(!0);this.alucod&&(e.alucod=this.alucod);var i=s.dispatch("clase/getCursosPeriodos",e);s.commit("clase/setPeticiones",{nemo:n,ajax:i}),i.then(function(e){["0032"].indexOf(t.sie.colcod)>=0&&"S"===t.instrucod&&["4","5"].indexOf(t.gradocod>=0)&&(e=e.filter(function(e){return"108"!==e.GRUPOCOD})),b.A.hide(),t.datos[n]["cursos"]=t.datos[n]["cursos"].concat(e),t.$store.commit("clase/setCursos",t.datos[n]["cursos"]),"function"===typeof o&&o()}).catch(function(e){b.A.hide(),console.error(e.message)})},goReportes:function(){this.$router.push({name:T,query:{nemo:this.nemo}})},goInformes:function(){this.$router.push({name:F,query:{nemo:this.nemo}})}},validations:{descripcion:{required:I.mw}},created:function(){this.$store.hasModule("clase")||this.$store.registerModule("clase",N.A)}},L=t(12807);const W=(0,L.A)(X,[["render",f]]);var _=W}}]);