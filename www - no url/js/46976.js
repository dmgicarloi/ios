"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[46976],{46976:function(a,e,t){t.r(e),t.d(e,{default:function(){return T}});var s=t(61758),i=t(58790),r={ref:"audioOk",src:"statics/sound/ok.mp3"},n={ref:"audioInfo",src:"statics/sound/duplicate.mp3"},o={ref:"audioError",src:"statics/sound/error.mp3"},l={key:0,class:"column col q-ma-sm q-card"},u={class:"column justify-center text-center q-py-md",style:{"font-size":"x-large"}},c={class:"row justify-center"},d={key:0,class:"col"},f={key:1,class:"col q-ma-sm"},m=["color"],A={class:"row"},p={class:"row"};function k(a,e){var t=(0,s.g2)("q-clock"),k=(0,s.g2)("q-input"),g=(0,s.g2)("qr"),L=(0,s.g2)("q-item-tile"),b=(0,s.g2)("q-item-main"),v=(0,s.g2)("q-item"),h=(0,s.g2)("q-list"),C=(0,s.g2)("q-page");return(0,s.uX)(),(0,s.Wv)(C,null,{default:(0,s.k6)(function(){return[(0,s.Lk)("audio",r,null,512),(0,s.Lk)("audio",n,null,512),(0,s.Lk)("audio",o,null,512),a.feriados?(0,s.Q3)("v-if",!0):((0,s.uX)(),(0,s.CE)("div",l,[(0,s.Lk)("div",u,[(0,s.bF)(t)]),(0,s.Lk)("div",c,[(0,s.bF)(k,{class:"no-bottom q-if-outlined txt-especial",modelValue:a.usucod,"onUpdate:modelValue":e[0]||(e[0]=function(e){return a.usucod=e}),autofocus:!0,"stack-label":"qr"==a.tipoLectura?"Usuario":"DNI",onKeydown:a.registraPistola},null,8,["modelValue","stack-label","onKeydown"])]),(0,s.Lk)("div",{class:(0,i.C4)(["col",{row:!a.isLess,column:a.isLess}])},[!a.sinCamara&&["qr","id"].indexOf(a.tipoLectura)>=0?((0,s.uX)(),(0,s.CE)("div",d,[["qr","id"].indexOf(a.tipoLectura)>=0?((0,s.uX)(),(0,s.Wv)(g,{key:0,onLeeQr:a.leerRegistro,cargaAnterior:a.cargaAnterior},null,8,["onLeeQr","cargaAnterior"])):(0,s.Q3)("v-if",!0)])):(0,s.Q3)("v-if",!0),a.dataAsistencia.ALUCOD?((0,s.uX)(),(0,s.CE)("div",f,[(0,s.bF)(h,{class:"q-card",style:(0,i.Tr)({color:a.dataAsistencia.COLORHEXT,"background-color":a.dataAsistencia.COLORHEXF})},{default:(0,s.k6)(function(){return[(0,s.bF)(v,null,{default:(0,s.k6)(function(){return[(0,s.Q3)('q-item-sidesie-usuario.sie-usuario-xl(:usucod="dataAsistencia.USUCOD")'),(0,s.bF)(b,null,{default:(0,s.k6)(function(){return[(0,s.Lk)("div",{class:"col",color:a.dataAsistencia.COLORVUE},[(0,s.Lk)("b",null,(0,i.v_)(a.dataAsistencia.ESTADODES),1)],8,m),(0,s.bF)(L,null,{default:(0,s.k6)(function(){return[(0,s.Lk)("div",A,[(0,s.Lk)("b",null,(0,i.v_)(a.dataAsistencia.NOMCOMP),1)])]}),_:1}),(0,s.bF)(L,null,{default:(0,s.k6)(function(){return[(0,s.Lk)("div",p,[(0,s.Lk)("span",null,(0,i.v_)(a.dataAsistencia.CURSODES),1)])]}),_:1}),0===a.tipoSelect?((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[(0,s.bF)(L,{class:"row",sublabel:""},{default:(0,s.k6)(function(){return[e[1]||(e[1]=(0,s.Lk)("b",{class:"q-mr-xs"},"Hora de Asistencia:",-1)),(0,s.Lk)("span",null,(0,i.v_)(a.date(a.dataAsistencia.HORA,"hh:mm a")),1)]}),_:1}),(0,s.bF)(L,{class:"row",sublabel:""},{default:(0,s.k6)(function(){return[e[2]||(e[2]=(0,s.Lk)("b",{class:"q-mr-xs"},"Registrado:",-1)),(0,s.Lk)("span",null,(0,i.v_)(a.date(a.dataAsistencia.FECREG,"DD/MM/YYYY hh:mm a")),1)]}),_:1})],64)):((0,s.uX)(),(0,s.CE)(s.FK,{key:1},[(0,s.bF)(L,{class:"row",sublabel:""},{default:(0,s.k6)(function(){return[e[3]||(e[3]=(0,s.Lk)("b",{class:"q-mr-xs"},"Hora de Salida:",-1)),(0,s.Lk)("span",null,(0,i.v_)(a.date(a.dataAsistencia.HORASAL,"hh:mm a")),1)]}),_:1}),(0,s.bF)(L,{class:"row",sublabel:""},{default:(0,s.k6)(function(){return[e[4]||(e[4]=(0,s.Lk)("b",{class:"q-mr-xs"},"Registrado:",-1)),(0,s.Lk)("span",null,(0,i.v_)(a.date(a.dataAsistencia.FH_SALIDA,"DD/MM/YYYY hh:mm a")),1)]}),_:1})],64))]}),_:1})]}),_:1})]}),_:1},8,["style"])])):(0,s.Q3)("v-if",!0)],2)]))]}),_:1})}var g=t(76080),L=t.n(g),b=t(57008),v=t.n(b),h=t(45254),C=t.n(h),O=t(6123),S=t(80660),E=t(57668),y=t(80340),D=t(69027),q=t(30640),R=t(93616),$=t(65818),w=t(33530),Q=t(18105),_=t(982),F=t(81288),I={components:{QSelect:O.Si,sieModal:q.A,qr:w.A,sieVacio:y.A,QToggle:O.c5,QCheckbox:O.vZ,QBtnToggle:O.QL,sieSelect:R.A,QRadio:O.$,QClock:$.A,QPage:O.Tu,QInput:O.ie,QList:O.Mb,QItem:O.H0,QItemMain:O.mF,QItemTile:O.lp},data:function(){return{now:new Date,sie:(0,E["default"])(),tipoLectura:"qr",sinCamara:!1,cargaAnterior:!1,camera:"auto",usucod:"",modRegistro:0,dataAsistencia:{},dataAlumnos:{},dataSalones:{},feriados:null,estados:{},tipoDiferenciado:[{label:"REGISTRAR INGRESO",value:0},{label:"REGISTRAR SALIDA",value:1}],tipoSelect:0,editar:!1,permiteSalida:!1}},watch:{tipoSelect:function(a){this.$http.put("api/HyoControl/updateControl",{campo:"alumnoES",numero:a})}},methods:{date:Q.Ay,marcarAsistencia:function(a){var e=this;return(0,_["default"])(a),this.$http.post("api/AsistenciaTalleresController/marcarAsistencia",{codigo:a}).then(function(a){e.dataAsistencia=a.data;var t=200===a.code?"success":"warning";(0,_["default"])(a.message,t),e.$refs.audioOk.play()}).catch(function(a){var t=a.error;e.dataAsistencia={},(0,_["default"])(t.message,"error"),e.$refs.audioError.play()})},leerRegistro:function(a,e,t){var s=this;return C()(L()().m(function t(){var i,r,n,o,l;return L()().w(function(t){while(1)switch(t.n){case 0:if(a){t.n=1;break}return t.a(2,!1);case 1:a=a.toUpperCase();case 2:return s.usucod=a,t.n=3,s.marcarAsistencia(a);case 3:if(i=1,!i){t.n=4;break}return t.a(2,!1);case 4:s.dataAsistencia={},a?(a.indexOf("|")>=0&&(a=a.split("|")[0]),console.log(s.dataSalones,s.dataAlumnos),a=a.toUpperCase(),s.dataAlumnos[a]?(r=s.dataAlumnos[a].ALUCOD,s.dataAlumnos[a].NEMO?s.dataSalones[s.dataAlumnos[a].NEMO].BIMECOD?(n=s.dataAlumnos[a].NEMO,s.dataAsistencia=v()({},s.dataAlumnos[a]),o={alucod:r,nemo:n,bimecod:s.dataSalones[n].BIMECOD,tardanzagen:s.dataSalones[n].TARDANZAGEN,modo:"C"},l=0===s.tipoSelect?"registraAsistencia":"registraSalida",S.$http.get("api/HyoHorasis/".concat(l),{params:o}).then(function(a){var e=a.json;(0,_["default"])(s.$t("regAsistencia."+e.mensaje)),s.dataAsistencia=v()(v()(v()(v()({},s.dataAsistencia),e.data),s.estados[e.data.ESTADOCOD]),s.dataSalones[n]),s.$refs.audioOk.play();var t=[s.dataAsistencia.ALUCOD];0===s.tipoSelect&&S.$http.get("api/HyoHorasis/enviarAlerta",{params:{alucods:t}}).then(function(a){a.json})}).catch(function(a){var e=a.error;"e0002"!==e.message?((0,_["default"])(s.$t("regAsistencia."+e.message),"error"),s.dataAsistencia=v()(v()(v()({},s.dataAsistencia),e.params),s.estados[e.params.ESTADOCOD]),s.$refs.audioOk.play(),"m0001"===e.message||"m0008"===e.message?s.$refs.audioInfo.play():s.$refs.audioError.play()):(s.dataAsistencia={},(0,D.dialogConfirm)({title:s.$t("mensajes."+e.message),cancel:!1}),s.$refs.audioError.play())})):((0,_["default"])(s.$t("regAsistencia.m0006"),"error"),s.$refs.audioInfo.play()):((0,_["default"])(s.$t("regAsistencia.m0005"),"error"),s.$refs.audioInfo.play())):((0,_["default"])(s.$t("regAsistencia.m0004"),"error"),s.$refs.audioError.play())):s.sinCamara=e,s.cargaAnterior=!0,s.usucod=null;case 5:return t.a(2)}},t)}))()},registraPistola:function(a){13===a.which&&this.leerRegistro(this.usucod)}},computed:{isLess:function(){return(0,F.isLess)()},modoDiferenciado:function(){return this.tipoDiferenciado[this.tipoSelect].label}},created:function(){console.log("tipoLectura",this.tipoLectura,this.sinCamara)}},M=t(12807);const H=(0,M.A)(I,[["render",k]]);var T=H}}]);