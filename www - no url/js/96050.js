"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[96050],{96050:function(e,o,n){n.r(o),n.d(o,{default:function(){return Ue}});var t=n(61758);function a(e,o){var n=(0,t.g2)("header-btn"),a=(0,t.g2)("q-tab"),r=(0,t.g2)("q-tabs"),i=(0,t.g2)("q-separator"),l=(0,t.g2)("detalle-operaciones"),s=(0,t.g2)("q-tab-panel"),c=(0,t.g2)("consultas-operaciones"),u=(0,t.g2)("q-tab-panels"),d=(0,t.g2)("q-card-section"),p=(0,t.g2)("q-card"),f=(0,t.g2)("q-page");return(0,t.uX)(),(0,t.Wv)(f,{class:"movimiento-operaciones q-pa-sm sie-flat"},{default:(0,t.k6)(function(){return[(0,t.bF)(p,{flat:""},{default:(0,t.k6)(function(){return[(0,t.bF)(n,{name:"Operaciones Rápidas",buttons:e.buttons},null,8,["buttons"]),(0,t.bF)(d,{class:"q-pa-none",style:{height:"calc(100vh - 143px)",padding:"0"}},{default:(0,t.k6)(function(){return[(0,t.bF)(r,{modelValue:e.tab,"onUpdate:modelValue":o[0]||(o[0]=function(o){return e.tab=o}),dense:"",align:"left",onInput:e.invocaGetOperaciones},{default:(0,t.k6)(function(){return[(0,t.bF)(a,{default:"",name:"tab-operaciones",label:"Operaciones"}),(0,t.bF)(a,{name:"tab-consultas",label:"Consultas"})]}),_:1},8,["modelValue","onInput"]),(0,t.bF)(i),(0,t.bF)(u,{modelValue:e.tab,"onUpdate:modelValue":o[1]||(o[1]=function(o){return e.tab=o}),animated:"","keep-alive":"",style:{height:"calc(100vh - 185px)",padding:"0"}},{default:(0,t.k6)(function(){return[(0,t.bF)(s,{name:"tab-operaciones"},{default:(0,t.k6)(function(){return[(0,t.bF)(l,{ref:"refTabOpertab-operaciones",showSelectOper:!0,onOperacion:e.setOperacion},null,8,["onOperacion"])]}),_:1}),(0,t.bF)(s,{name:"tab-consultas"},{default:(0,t.k6)(function(){return[e.feriados?((0,t.uX)(),(0,t.Wv)(c,{key:0,ref:"refTabOpertab-consultas",showSelectOper:!0,feriados:e.feriados,onOperacion:e.setOperacion,onSetearHistrorico:e.setearHistrorico},null,8,["feriados","onOperacion","onSetearHistrorico"])):(0,t.Q3)("v-if",!0)]}),_:1})]}),_:1},8,["modelValue"])]}),_:1})]}),_:1})]}),_:1})}var r=n(76080),i=n.n(r),l=n(45254),s=n.n(l),c=n(6123),u=n(53093),d=n(26697),p=n(53811),f=n(43346),m=n(88567),g=n(95718),b=n(53380),O=n(57668),h=n(8445),v=n.n(h),I={class:"row"},A={class:"col-12"},E={class:"row"},C={class:"col"},F={class:"row q-pa-sm q-col-gutter-sm"},V={key:0,class:"col-xs-12 col-md-2"},k={class:"col-xs-12 col-md-2"},D={class:"col-xs-12 col-md-2"},R={class:"col-xs-12 col-md-3"},S={class:"col-xs-12 col-md-3"},w={class:"row q-gutter-xs"},P={class:"col"},N={class:"row full-height q-pt-sm"},T={class:"col column items-center justify-start"},L={class:"row sie-flat q-pt-sm"},M={class:"col-xs-12"};function y(e,o){var n=(0,t.g2)("q-select"),a=(0,t.g2)("autocomplete"),r=(0,t.g2)("q-input"),i=(0,t.g2)("q-tooltip"),l=(0,t.g2)("q-btn"),s=(0,t.g2)("q-img"),c=(0,t.g2)("sie-table"),u=(0,t.g2)("modal-obs"),d=(0,t.g2)("modal-ampliar-retornos"),p=(0,t.g2)("cronograma"),f=(0,t.g2)("modal-alertas"),m=(0,t.g2)("box-imagen");return(0,t.uX)(),(0,t.CE)("div",I,[(0,t.Lk)("div",A,[(0,t.Lk)("div",E,[(0,t.Lk)("div",C,[(0,t.Lk)("div",F,[e.showSelectOper?((0,t.uX)(),(0,t.CE)("div",V,[(0,t.bF)(n,{class:"q-ma-none",label:"Operación",type:"outlined",modelValue:e.operacion,"onUpdate:modelValue":o[0]||(o[0]=function(o){return e.operacion=o}),options:e.config.operaciones,"option-value":"ID","option-label":"DESCRIPCION",onInput:e.setearOperacion},null,8,["modelValue","options","onInput"])])):(0,t.Q3)("v-if",!0),(0,t.Lk)("div",k,[(0,t.bF)(a,{class:"q-ma-none",ref:"refSolicita",modelValue:e.solcod,"onUpdate:modelValue":o[1]||(o[1]=function(o){return e.solcod=o}),label:"Código/Nombre",data:e.solicitantes,keys:e.keysComplete,onSelected:e.selected},null,8,["modelValue","data","keys","onSelected"])]),(0,t.Lk)("div",D,[(0,t.bF)(r,{modelValue:e.numingreso,"onUpdate:modelValue":o[2]||(o[2]=function(o){return e.numingreso=o}),label:"Número de Ingreso",ref:"refNumingreso",onKeyup:e.ejecutarAccion},null,8,["modelValue","onKeyup"])]),(0,t.Lk)("div",R,[(0,t.bF)(r,{modelValue:e.nombre,"onUpdate:modelValue":o[3]||(o[3]=function(o){return e.nombre=o}),readonly:"",label:"Solicitante"},null,8,["modelValue"])]),(0,t.Lk)("div",S,[(0,t.Lk)("div",w,[(0,t.Lk)("div",P,[(0,t.bF)(r,{modelValue:e.descriptor,"onUpdate:modelValue":o[4]||(o[4]=function(o){return e.descriptor=o}),readonly:"",label:e.descriptorLabel},null,8,["modelValue","label"])]),(0,t.bF)(l,{icon:"calendar",color:"primary",dense:"",onClick:o[5]||(o[5]=function(o){return e.openCronograma()})},{default:(0,t.k6)(function(){return[(0,t.bF)(i,null,{default:(0,t.k6)(function(){return v()(o[13]||(o[13]=[(0,t.eW)("Cronograma plan Lector",-1)]))}),_:1})]}),_:1}),(0,t.bF)(l,{icon:"broom",color:"primary",dense:"",onClick:o[6]||(o[6]=function(o){return e.limpiar()})},{default:(0,t.k6)(function(){return[(0,t.bF)(i,null,{default:(0,t.k6)(function(){return v()(o[14]||(o[14]=[(0,t.eW)("Limpiar",-1)]))}),_:1})]}),_:1})])])])]),(0,t.Lk)("div",null,[(0,t.Lk)("div",N,[(0,t.Lk)("div",T,[(0,t.bF)(s,{class:"foto-alumno",src:e.rutaFoto,width:"76px",height:"76px",onClick:e.openBoxImagen},{error:(0,t.k6)(function(){return[(0,t.bF)(s,{class:"foto-alumno",src:e.rutaFotoDefault,width:"76px",height:"76px"},null,8,["src"])]}),_:1},8,["src","onClick"])])])])]),(0,t.Lk)("div",L,[(0,t.Lk)("div",M,[(0,t.bF)(c,{ref:"operVigentes",columns:e.fieldsOperVigentes,data:e.rowsOperVigentes,selection:"multiple",context:this,config:e.configTable,css:{height:"calc(100vh - 297px)"}},null,8,["columns","data","config"])])])]),e.modalObs?((0,t.uX)(),(0,t.Wv)(u,{key:0,modelValue:e.modalObs,"onUpdate:modelValue":o[7]||(o[7]=function(o){return e.modalObs=o}),operacion:e.operacion,"onUpdate:operacion":o[8]||(o[8]=function(o){return e.operacion=o}),currentRow:e.currentRow,configDB:e.config,onGetOperaciones:e.operacionesVigentes,onSetearLimite:e.setearLimite},null,8,["modelValue","operacion","currentRow","configDB","onGetOperaciones","onSetearLimite"])):(0,t.Q3)("v-if",!0),e.openModalAmpliarRetornos?((0,t.uX)(),(0,t.Wv)(d,{key:1,modelValue:e.openModalAmpliarRetornos,"onUpdate:modelValue":o[9]||(o[9]=function(o){return e.openModalAmpliarRetornos=o}),operacion:e.config.OPERACION_PRESTAMO,operSelected:e.operSelected,caso:e.caso,configDB:e.config,onGetOperaciones:e.operacionesVigentes},null,8,["modelValue","operacion","operSelected","caso","configDB","onGetOperaciones"])):(0,t.Q3)("v-if",!0),(0,t.bF)(p,{ref:"refModalCronograma"},null,512),e.openModalAlertas?((0,t.uX)(),(0,t.Wv)(f,{key:2,modelValue:e.openModalAlertas,"onUpdate:modelValue":o[10]||(o[10]=function(o){return e.openModalAlertas=o}),operacion:e.operacion,alertasOperaciones:e.alertasOperaciones,configDB:e.config,"onUpdate:configDB":o[11]||(o[11]=function(o){return e.config=o})},null,8,["modelValue","operacion","alertasOperaciones","configDB"])):(0,t.Q3)("v-if",!0),e.openModalImagen?((0,t.uX)(),(0,t.Wv)(m,{key:3,modelValue:e.openModalImagen,"onUpdate:modelValue":o[12]||(o[12]=function(o){return e.openModalImagen=o}),urlImage:e.urlImagenBox,urlImageDefault:e.rutaFotoDefault,titulo:e.nombre},null,8,["modelValue","urlImage","urlImageDefault","titulo"])):(0,t.Q3)("v-if",!0)])}n(71225),n(50310),n(5962),n(83190);var x=n(9736),_=n(3112),U=n(99515),B=n(16648),q=n(74656),Q=n(53399),$=n(3042),Y=n(57343),G={data:function(){return{configTable:{FECPREI:{component:"datetime",edit:!1},FECPREF:{component:"date",edit:!1},FECDEV:{component:"datetime",edit:!1},FECRES:{component:"datetime",edit:!1},OBS:{component:"button",icon:["write"],write:function(e){this.currentRow=e,this.config.caso=this.caso,this.modalObs=!0},tooltip:{write:"Agregar observación"},dense:!0,flat:!0}},rowsOperVigentes:[]}},computed:{fieldsOperVigentes:function(){return"tab-operaciones"===this.tab&&(this.hiddenOper=!1),[{name:"NUMINGRESO",label:"# Ingreso",field:"NUMINGRESO",align:"left"},{name:"NOMCOMP",label:"Nombre de Solicitante",field:"NOMCOMP",align:"left",wrap:!0,vIf:this.hiddenOper},{name:"NGS_CARGO",label:"NGS/Cargo",field:"NGS_CARGO",align:"left",wrap:!0,vIf:this.hiddenOper},{name:"PARTE",label:"Cod. Clasif.",field:"PARTE",align:"left"},{name:"TITULO",label:"Título",field:"TITULO",align:"left",wrap:!0,width:120},{name:"SOLOBIB",label:"SB",field:"SOLOBIB",align:"center"},{name:"PL",label:"PL",field:"PL",align:"center"},{name:"NOMESTADO",label:"Estado",field:"NOMESTADO",align:"left"},{name:"FECRES",label:"Reserva",field:"FECRES",align:"left",wrap:!0},{name:"FECPREI",label:"F. Prestamo",field:"FECPREI",align:"left",wrap:!0},{name:"FECPREF",label:"F. Fin Prestamo",field:"FECPREF",align:"left"},{name:"FECDEV",label:"Devolución",field:"FECDEV",align:"left",wrap:!0},{name:"OBS",label:"Obs",field:"OBS",align:"left"}]}}},X=n(18105),W=n(12143),H=n(95477),j=n(66592),K=n(2713),J=n(87410),z=n(50012),Z=n(90007),ee=n(98361),oe={emits:["operacion"],mixins:[G,j.A],components:{QInput:x.A,QRadio:U.A,QCheckbox:_.A,QSelect:B.A,QAvatar:q.A,QImg:Q.A,autocomplete:$.A,QDate:W.A,QPopupProxy:H.A,QCard:m.A,QCardSection:g.A,QSeparator:b.A,Cronograma:K.A,modalObs:J.A,modalAmpliarRetornos:z.A,modalAlertas:Z.A,boxImagen:ee.A,QBtn:c.Il,QTooltip:c.nC},props:{showSelectOper:{type:Boolean,default:!1}},computed:{rutaFotoDefault:function(){var e=(0,Y.getImageDefault)(this.sieInfo,this.sexo);return e},rutaFoto:function(){var e=(0,Y.imgEstudiante)(this.sieInfo,this.codigoFoto);return e}},data:function(){return{sieInfo:(0,O["default"])(),config:{},tab:"tab-operaciones",solcod:"",id_persona:"",personaSelected:{},id_perfil:"",operacion:"",solicitantes:[],keysComplete:["TEXT"],nombre:"",sexo:"M",descriptor:"",descriptorLabel:"NGS",tipoSolicita:"",numingreso:"",codigoFoto:"",solicitante:{},hiddenOper:!0,currentRow:{},openModalAmpliarRetornos:!1,checkAmpliarTodos:!1,operSelected:[],fechaAmpliacion:(0,X.Ay)(new Date,"DD/MM/YYYY"),reportCod:"relacionPrestamos",openModalObs:!1,modalObs:!1,mostrarBloqueosObs:!1,mostrarBaja:!1,openModalAlertas:!1,alertasOperaciones:[],alerta:"",formObs:{},loading:!1,usaNgs:!1,caso:2,openModalImagen:!1,urlImagenBox:""}},methods:{limpiar:function(){this.id_persona="",this.id_perfil="",this.solcod="",this.codigoFoto="",this.numingreso="",this.nombre="",this.rowsOperVigentes=[],this.descriptor="",this.descriptorLabel="NGS",this.operacion===this.config.OPERACION_DEVOLUCION?this.$refs.refNumingreso&&this.$refs.refNumingreso.$el.focus():this.$refs.refSolicita&&this.$refs.refSolicita.focusComplete()},cerrarDatepicker:function(e){console.log(this.$refs)},operacionesVigentes:function(){var e=this;return s()(i()().m(function o(){var n;return i()().w(function(o){while(1)switch(o.n){case 0:return n=e.operacion===e.config.OPERACION_DEVOLUCION?e.config.OPERACION_PRESTAMO:e.operacion,o.n=1,e.consultarOperacionesVigentes(n);case 1:return e.rowsOperVigentes=o.v,o.a(2,!0)}},o)}))()},getFilasSelected:function(e){return this.$refs.operVigentes.rowsSelected(e)},consultarNumeroIngreso:function(){var e=this;return s()(i()().m(function o(){var n,t;return i()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,e.operacionesVigentes();case 1:e.rowsOperVigentes.length>0&&e.operacion===e.config.OPERACION_DEVOLUCION&&(n="",t=[{IDOPERADET:e.rowsOperVigentes[0].IDOPERADET,TITULO:e.rowsOperVigentes[0].TITULO,EXISTCOD:e.rowsOperVigentes[0].EXISTCOD}],e.apiDevolucion(e.operacion,n,t,!1));case 2:return o.a(2)}},o)}))()},ejecutarAccion:function(e){if(13!==e.keyCode)return!1;if(!this.numingreso&&!this.solcod)return!1;if(this.solcod&&this.numingreso&&this.operacion!==this.config.OPERACION_DEVOLUCION){var o=this.operacion===this.config.OPERACION_PRESTAMO?"registrarPrestamo":"registrarReserva";return this.registrarPrestamo(o)}return this.numingreso&&this.operacion===this.config.OPERACION_DEVOLUCION?this.devolucionXNumeroIngreso():void 0},devolucionXNumeroIngreso:function(){var e=this;return s()(i()().m(function o(){var n;return i()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,e.apiDevolucionXNumeroIngreso();case 1:return n=o.v,n&&(e.rowsOperVigentes=e.rowsOperVigentes.filter(function(o){return o.NUMINGRESO!==e.numingreso}),e.numingreso=""),o.a(2,n)}},o)}))()},setearOperacion:function(){var e=this;return s()(i()().m(function o(){return i()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,e.$nextTick();case 1:e.operacion===e.config.OPERACION_DEVOLUCION?e.$refs.refNumingreso&&e.$refs.refNumingreso.$el.focus():e.$refs.refSolicita&&e.$refs.refSolicita.focusComplete(),e.$emit("operacion",e.operacion,e.caso),e.solcod&&e.operacionesVigentes();case 2:return o.a(2)}},o)}))()}},created:function(){this.setearOperacion(),this.getConfigOperaciones(),this.getPersonasBiblioteca()}},ne=n(12807);const te=(0,ne.A)(oe,[["render",y]]);var ae=te,re={class:"row"},ie={class:"col-12 q-pa-sm"},le={class:"row q-col-gutter-sm"},se={class:"col"},ce={key:0,class:"col-xs-12 col-sm-6 col-md-4 col-lg-2"},ue={class:"col-xs-12 col-sm-6 col-md-4 col-lg-2"},de={class:"col-xs-12 col-sm-6 col-md-4 col-lg-2"},pe={class:"col-xs-12 col-sm-6 col-md-4 col-lg-4"},fe={class:"col-xs-12 col-sm-6 col-md-4 col-lg-2"},me={class:"col-xs-12 col-sm-6 col-md-4 col-lg-2"},ge={class:"col-xs-12 col-sm-6 col-md-4 col-lg-4"},be={class:"col-xs-12 col-sm-6 col-md-4 col-lg-2"},Oe={key:0,class:"col-xs-12 col-sm-6 col-md-4 col-lg-2"},he={class:"col-xs-12 col-sm-6 col-md-4 col-lg-2"},ve={class:"col-xs-12 col-sm-6 col-md-4 col-lg-2"},Ie={class:"col-xs-12 col-md-6 col-lg-4"},Ae={class:"row q-gutter-xs"},Ee={class:"col"},Ce={class:"row q-gutter-xs"},Fe={class:"row full-height q-pt-sm"},Ve={class:"col column items-center justify-start"},ke={class:"row sie-flat q-pt-md"},De={class:"col-xs-12"};function Re(e,o){var n=(0,t.g2)("q-select"),a=(0,t.g2)("autocomplete"),r=(0,t.g2)("q-input"),i=(0,t.g2)("q-date"),l=(0,t.g2)("q-popup-proxy"),s=(0,t.g2)("q-icon"),c=(0,t.g2)("q-checkbox"),u=(0,t.g2)("q-tooltip"),d=(0,t.g2)("q-btn"),p=(0,t.g2)("sie-ngs"),f=(0,t.g2)("q-img"),m=(0,t.g2)("sie-table"),g=(0,t.g2)("modal-obs"),b=(0,t.g2)("modal-ampliar-retornos"),O=(0,t.g2)("cronograma"),h=(0,t.g2)("modal-alertas"),I=(0,t.g2)("box-imagen");return(0,t.uX)(),(0,t.CE)("div",re,[(0,t.Lk)("div",ie,[(0,t.Lk)("div",le,[(0,t.Lk)("div",se,[(0,t.bF)(p,{class:"q-pt-sm q-col-gutter-sm",ref:"refSieGNS",onNivel:o[23]||(o[23]=function(o){e.id_perfil=e.config.PERFIL_ALUMNO,e.getOperacionesLocal()}),onGrado:e.getOperaciones,onSeccion:e.getOperaciones,"class-nivel":"col-xs-12 col-sm-6 col-md-4 col-lg-2","class-grado":"col-xs-12 col-sm-6 col-md-4 col-lg-2","class-seccion":"col-xs-12 col-sm-6 col-md-4 col-lg-2"},{prepend:(0,t.k6)(function(){return[e.showSelectOper?((0,t.uX)(),(0,t.CE)("div",ce,[(0,t.bF)(n,{class:"q-ma-none",label:"Operación",type:"outlined",modelValue:e.operacion,"onUpdate:modelValue":o[0]||(o[0]=function(o){return e.operacion=o}),options:e.config.operaciones,"option-value":"ID","option-label":"DESCRIPCION",onInput:e.setearOperacion},null,8,["modelValue","options","onInput"])])):(0,t.Q3)("v-if",!0),(0,t.Lk)("div",ue,[(0,t.bF)(a,{class:"q-ma-none",modelValue:e.solcod,"onUpdate:modelValue":o[1]||(o[1]=function(o){return e.solcod=o}),label:"Código/Nombre",ref:"refSolicita",data:e.solicitantes,keys:e.keysComplete,onSelected:e.selected},null,8,["modelValue","data","keys","onSelected"])]),(0,t.Lk)("div",de,[(0,t.bF)(r,{modelValue:e.numingreso,"onUpdate:modelValue":o[2]||(o[2]=function(o){return e.numingreso=o}),label:"Número de Ingreso",ref:"refNumingreso",onKeyup:e.filtrarNumeroIngreso},null,8,["modelValue","onKeyup"])]),(0,t.Lk)("div",pe,[(0,t.bF)(r,{modelValue:e.nombre,"onUpdate:modelValue":o[3]||(o[3]=function(o){return e.nombre=o}),readonly:"",label:"Solicitante"},null,8,["modelValue"])]),(0,t.Lk)("div",fe,[(0,t.bF)(r,{modelValue:e.descriptor,"onUpdate:modelValue":o[4]||(o[4]=function(o){return e.descriptor=o}),readonly:"",label:e.descriptorLabel},null,8,["modelValue","label"])]),(0,t.Lk)("div",me,[(0,t.bF)(n,{class:"q-ma-none",label:"Tipo Solicitante",type:"outlined",modelValue:e.id_perfil,"onUpdate:modelValue":o[5]||(o[5]=function(o){return e.id_perfil=o}),options:e.config.solicitantes,"option-value":"ID","option-label":"DESCRIPCION",onInput:e.changeSolicitante},null,8,["modelValue","options","onInput"])])]}),default:(0,t.k6)(function(){return[(0,t.Lk)("div",ge,[(0,t.bF)(a,{class:"q-ma-nome",modelValue:e.titulo,"onUpdate:modelValue":o[6]||(o[6]=function(o){return e.titulo=o}),label:"Título",data:e.titulos,keys:e.keysTitulos,onSelected:e.tituloSelected},null,8,["modelValue","data","keys","onSelected"])]),(0,t.Lk)("div",be,[(0,t.bF)(r,{modelValue:e.parte,"onUpdate:modelValue":o[7]||(o[7]=function(o){return e.parte=o}),label:"Cod. Clasif.",onKeyup:e.cambiarClasif},null,8,["modelValue","onKeyup"])]),e.operacion===e.config.OPERACION_PRESTAMO?((0,t.uX)(),(0,t.CE)("div",Oe,[(0,t.bF)(n,{class:"q-ma-none",label:"Fecha",type:"outlined",modelValue:e.tipoFecha,"onUpdate:modelValue":o[8]||(o[8]=function(o){return e.tipoFecha=o}),options:e.dataTipoFecha,onInput:o[9]||(o[9]=function(o){return e.getOperaciones()})},null,8,["modelValue","options"])])):(0,t.Q3)("v-if",!0),(0,t.Lk)("div",he,[(0,t.bF)(r,{label:"Desde",debounce:"500",maxlength:"10",format:"##/##/####",modelValue:e.desde,"onUpdate:modelValue":o[12]||(o[12]=function(o){return e.desde=o}),mask:"##/##/####",readonly:""},{append:(0,t.k6)(function(){return[(0,t.bF)(s,{class:"cursor-pointer",name:"date_range"},{default:(0,t.k6)(function(){return[(0,t.bF)(l,{ref:"qDateProxy3","transition-show":"scale","transition-hide":"scale"},{default:(0,t.k6)(function(){return[(0,t.bF)(i,{mask:"DD/MM/YYYY",modelValue:e.desde,"onUpdate:modelValue":o[10]||(o[10]=function(o){return e.desde=o}),onInput:o[11]||(o[11]=function(o){return e.filtrarFecha("qDateProxy3")})},null,8,["modelValue"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])]),(0,t.Lk)("div",ve,[(0,t.bF)(r,{label:"Hasta",debounce:"500",maxlength:"10",format:"##/##/####",modelValue:e.hasta,"onUpdate:modelValue":o[15]||(o[15]=function(o){return e.hasta=o}),mask:"##/##/####",readonly:""},{append:(0,t.k6)(function(){return[(0,t.bF)(s,{class:"cursor-pointer",name:"date_range"},{default:(0,t.k6)(function(){return[(0,t.bF)(l,{ref:"qDateProxy4","transition-show":"scale","transition-hide":"scale"},{default:(0,t.k6)(function(){return[(0,t.bF)(i,{mask:"DD/MM/YYYY",modelValue:e.hasta,"onUpdate:modelValue":o[13]||(o[13]=function(o){return e.hasta=o}),onInput:o[14]||(o[14]=function(o){return e.filtrarFecha("qDateProxy4")})},null,8,["modelValue"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])]),(0,t.Lk)("div",Ie,[(0,t.Lk)("div",Ae,[(0,t.Lk)("div",Ee,[(0,t.Lk)("div",Ce,[e.historico||e.operacion===e.config.OPERACION_DEVOLUCION?(0,t.Q3)("v-if",!0):((0,t.uX)(),(0,t.Wv)(c,{key:0,dense:"",modelValue:e.usaFechas,"onUpdate:modelValue":o[16]||(o[16]=function(o){return e.usaFechas=o}),label:"Usar Fechas",onInput:o[17]||(o[17]=function(o){return e.getOperacionesLocal()})},null,8,["modelValue"])),(0,t.bF)(d,{icon:"calendar",color:"primary",dense:"",onClick:o[18]||(o[18]=function(o){return e.openCronograma()})},{default:(0,t.k6)(function(){return[(0,t.bF)(u,null,{default:(0,t.k6)(function(){return v()(o[30]||(o[30]=[(0,t.eW)("Cronograma plan Lector",-1)]))}),_:1})]}),_:1}),(0,t.bF)(d,{icon:"broom",color:"primary",dense:"",onClick:o[19]||(o[19]=function(o){return e.limpiar()})},{default:(0,t.k6)(function(){return[(0,t.bF)(u,null,{default:(0,t.k6)(function(){return v()(o[31]||(o[31]=[(0,t.eW)("Limpiar",-1)]))}),_:1})]}),_:1}),(0,t.bF)(d,{icon:"search",color:"primary",dense:"",onClick:o[20]||(o[20]=function(o){return e.getOperaciones()})},{default:(0,t.k6)(function(){return[(0,t.bF)(u,null,{default:(0,t.k6)(function(){return v()(o[32]||(o[32]=[(0,t.eW)("Buscar",-1)]))}),_:1})]}),_:1})])]),(0,t.bF)(c,{dense:"",modelValue:e.historico,"onUpdate:modelValue":o[21]||(o[21]=function(o){return e.historico=o}),label:"Historico",onInput:o[22]||(o[22]=function(o){return e.activarHistorico()})},null,8,["modelValue"])])])]}),_:1},8,["onGrado","onSeccion"])]),(0,t.Lk)("div",null,[(0,t.Lk)("div",Fe,[(0,t.Lk)("div",Ve,[(0,t.bF)(f,{class:"foto-alumno",src:e.rutaFoto,width:"76px",height:"76px",onClick:e.openBoxImagen},{error:(0,t.k6)(function(){return[(0,t.bF)(f,{class:"foto-alumno",src:e.rutaFotoDefault,width:"76px",height:"76px"},null,8,["src"])]}),_:1},8,["src","onClick"])])])])]),(0,t.Lk)("div",ke,[(0,t.Lk)("div",De,[(0,t.bF)(m,{ref:"refOper",columns:e.fieldsOperVigentes,onRowSelectedDbl:e.cargarDatosOper,"prevent-cell":"","sort-server":"",data:e.rowsOperaciones,selection:"multiple",context:this,config:e.configTable,css:{height:"calc(100vh - 358px)"},totalPagination:e.totalPagination,totalRegistros:e.totalRegistros,onListarPagination:e.getOperaciones},null,8,["columns","onRowSelectedDbl","data","config","totalPagination","totalRegistros","onListarPagination"])])])]),e.modalObs?((0,t.uX)(),(0,t.Wv)(g,{key:0,modelValue:e.modalObs,"onUpdate:modelValue":o[24]||(o[24]=function(o){return e.modalObs=o}),operacion:e.operacion,"onUpdate:operacion":o[25]||(o[25]=function(o){return e.operacion=o}),currentRow:e.currentRow,configDB:e.config,onGetOperaciones:e.getOperaciones,onSetearLimite:e.setearLimite},null,8,["modelValue","operacion","currentRow","configDB","onGetOperaciones","onSetearLimite"])):(0,t.Q3)("v-if",!0),e.openModalAmpliarRetornos?((0,t.uX)(),(0,t.Wv)(b,{key:1,modelValue:e.openModalAmpliarRetornos,"onUpdate:modelValue":o[26]||(o[26]=function(o){return e.openModalAmpliarRetornos=o}),feriados:e.feriados,operacion:e.config.OPERACION_PRESTAMO,operSelected:e.operSelected,configDB:e.config,onGetOperaciones:e.getOperaciones},null,8,["modelValue","feriados","operacion","operSelected","configDB","onGetOperaciones"])):(0,t.Q3)("v-if",!0),(0,t.bF)(O,{ref:"refModalCronograma"},null,512),e.openModalAlertas?((0,t.uX)(),(0,t.Wv)(h,{key:2,modelValue:e.openModalAlertas,"onUpdate:modelValue":o[27]||(o[27]=function(o){return e.openModalAlertas=o}),operacion:e.operacion,alertasOperaciones:e.alertasOperaciones,configDB:e.config,"onUpdate:configDB":o[28]||(o[28]=function(o){return e.config=o})},null,8,["modelValue","operacion","alertasOperaciones","configDB"])):(0,t.Q3)("v-if",!0),e.openModalImagen?((0,t.uX)(),(0,t.Wv)(I,{key:3,modelValue:e.openModalImagen,"onUpdate:modelValue":o[29]||(o[29]=function(o){return e.openModalImagen=o}),urlImage:e.urlImagenBox,urlImageDefault:e.rutaFotoDefault,titulo:e.nombre},null,8,["modelValue","urlImage","urlImageDefault","titulo"])):(0,t.Q3)("v-if",!0)])}n(70199),n(515),n(7346);var Se=n(26319),we=(0,Se.date)(new Date).date,Pe=function(e){var o=(0,Se.date)(new Date(e),"YYYY/MM/DD").date;return o<we},Ne={data:function(){return{configTable:{FECPREI:{tooltip:function(e){return"Reserva"===e.NOMOPERA&&Pe(e.FECPREI)?"Expiró":""},renderHtml:function(e,o,n,t){if(this.fechasRecojoVencidas=!1,e.FECPREI){if("Reserva"===e.NOMOPERA){var a=(0,Se.date)(e.FECPREI,"YYYY/MM/DD").datePeru;return Pe(e.FECPREI)?(this.fechasRecojoVencidas=!0,n.background({color:"transparent",textColor:"red",text:a,style:{fontWeight:"bold"}})):o("span",{},a)}return o("span",{},(0,Se.date)(e.FECPREI,"YYYY/MM/DD").dateTimePeru)}}},FECPREF:{component:"date",edit:!1},FECDEV:{component:"datetime",edit:!1},FECRES:{component:"datetime",edit:!1},OBS:{component:"button",icon:["write"],write:function(e){this.currentRow=e,this.config.caso=this.caso,this.modalObs=!0},tooltip:{write:"Agregar observación"},dense:!0,flat:!0}},rowsOperaciones:[]}},computed:{fieldsOperVigentes:function(){return[{name:"NUMINGRESO",label:"# Ingreso",field:"NUMINGRESO",align:"left",width:65},{name:"NOMCOMP",label:"Nombre de Solicitante",field:"NOMCOMP",align:"left",wrap:!0,order:!0},{name:"NGS_CARGO",label:"NGS/Cargo",field:"NGS_CARGO",align:"left",wrap:!0,order:!0},{name:"PARTE",label:"Cod. Clasif.",field:"PARTE",align:"left",order:!0},{name:"TITULO",label:"Título",field:"TITULO",align:"left",wrap:!0,width:120,order:!0},{name:"SOLOBIB",label:"SB",field:"SOLOBIB",align:"center"},{name:"PL",label:"PL",field:"PL",align:"center"},{name:"NOMESTADO",label:"Estado",field:"NOMESTADO",align:"left",order:!0},{name:"FECRES",label:"Reserva",field:"FECRES",align:"center",wrap:!0,order:!0},{name:"FECPREI",label:"F. Prestamo",field:"FECPREI",align:"center",wrap:!0,order:!0},{name:"FECPREF",label:"F. Fin Prestamo",field:"FECPREF",align:"center",order:!0},{name:"FECDEV",label:"Devolución",field:"FECDEV",align:"center",wrap:!0,order:!0},{name:"OBS",label:"Obs",field:"OBS",align:"left",vIf:!this.historico}]}}},Te=n(36667),Le={emits:["operacion","setearHistrorico"],mixins:[Ne,j.A],components:{QInput:x.A,QRadio:U.A,QCheckbox:_.A,QSelect:B.A,QAvatar:q.A,QImg:Q.A,autocomplete:$.A,QDate:W.A,QPopupProxy:H.A,QCard:m.A,QCardSection:g.A,QSeparator:b.A,sieNgs:Te.A,modalObs:J.A,modalAmpliarRetornos:z.A,Cronograma:K.A,modalAlertas:Z.A,boxImagen:ee.A,QIcon:c.bP,QBtn:c.Il,QTooltip:c.nC},props:{showSelectOper:{type:Boolean,default:!1},funcion:{type:String,default:"operaciones"},feriados:{type:Array,default:function(){return[]}}},computed:{rutaFotoDefault:function(){var e=(0,Y.getImageDefault)(this.sieInfo,this.sexo);return e},rutaFoto:function(){var e=(0,Y.imgEstudiante)(this.sieInfo,this.codigoFoto);return e}},data:function(){return{sieInfo:(0,O["default"])(),config:{},tab:"tab-operaciones",solcod:"",id_persona:"",personaSelected:{},id_perfil:"",operacion:1,solicitantes:[],keysComplete:["TEXT"],keysTitulos:["TITULO"],keysCatalogos:["CATALOGO"],dataTipoFecha:[{value:"fecprei",label:"F. Prestamo"},{value:"fecpref",label:"F. Fin Prestamo"}],tipoFecha:"fecprei",nombre:"",sexo:"M",descriptor:"",descriptorLabel:"NGS",tipoSolicita:"",numingreso:"",parte:"",titulo:"",titulos:[],desde:this.getFechaMesAntes(),hasta:(0,X.Ay)(new Date,"DD/MM/YYYY"),codigoFoto:"",solicitante:{},hiddenOper:!0,currentRow:{},openModalAmpliarRetornos:!1,checkAmpliarTodos:!1,operSelected:[],fechaAmpliacion:(0,X.Ay)(new Date,"DD/MM/YYYY"),reportCod:"relacionPrestamos",openModalObs:!1,modalObs:!1,mostrarBloqueosObs:!1,mostrarBaja:!1,openModalAlertas:!1,alertasOperaciones:[],alerta:"",formObs:{},loading:!1,caso:1,historico:!1,totalPagination:1,totalRegistros:"",usaFechas:!0,usaNgs:!0,openModalImagen:!1,urlImagenBox:"",fechasRecojoVencidas:!1}},methods:{limpiar:function(){this.id_persona="",this.id_perfil="",this.solcod="",this.codigoFoto="",this.desde=this.getFechaMesAntes(),this.hasta=(0,X.Ay)(new Date,"DD/MM/YYYY"),this.titulo="",this.parte="",this.numingreso="",this.nombre="",this.rowsOperaciones=[],this.descriptor="",this.descriptorLabel="NGS",this.operacion===this.config.OPERACION_DEVOLUCION?this.$refs.refNumingreso&&this.$refs.refNumingreso.$el.focus():this.$refs.refSolicita&&this.$refs.refSolicita.focusComplete(),this.tipoFecha="fecprei",this.setearNgs({}),this.getOperaciones()},getFechaMesAntes:function(){var e=new Date,o=e.setDate(e.getDate()-30);return(0,X.Ay)(new Date(o).setDate(1),"DD/MM/YYYY")},getTitulos:function(){var e=this;return s()(i()().m(function o(){var n,t;return i()().w(function(o){while(1)switch(o.p=o.n){case 0:return o.p=0,n={columnas:["titulo","catalogo"],joins:[],distinct:!0,order:{sidx:"titulo",sord:"asc"}},o.n=1,e.$http.get("api/MantenimientosController/getTitulos",{params:{parametros:n}});case 1:t=o.v,e.titulos=JSON.parse(JSON.stringify(t)),o.n=3;break;case 2:o.p=2,o.v,e.titulos=[];case 3:return o.a(2)}},o,null,[[0,2]])}))()},getFilasSelected:function(e){return this.$refs.refOper.rowsSelected(e)},consultarNumeroIngreso:function(){var e=this;return s()(i()().m(function o(){var n,t;return i()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,e.getOperaciones();case 1:e.rowsOperaciones.length>0&&e.operacion===e.config.OPERACION_DEVOLUCION&&(n="",t=[{IDOPERADET:e.rowsOperaciones[0].IDOPERADET,TITULO:e.rowsOperaciones[0].TITULO,EXISTCOD:e.rowsOperaciones[0].EXISTCOD}],e.apiDevolucion(e.operacion,n,t,!1));case 2:return o.a(2)}},o)}))()},setearOperacion:function(){this.$emit("operacion",this.operacion,this.caso),this.$emit("setearHistrorico",this.historico),this.getOperaciones()},activarHistorico:function(){this.usaFechas=!0,this.desde=this.getFechaMesAntes(),this.hasta=(0,X.Ay)(new Date,"DD/MM/YYYY"),this.$emit("setearHistrorico",this.historico),this.getOperaciones()},getOperacionesLocal:function(){this.operacion===this.config.OPERACION_DEVOLUCION&&(this.usaFechas=!0),this.getOperaciones()}},created:function(){this.getConfigOperaciones(),this.getPersonasBiblioteca(),this.getTitulos()}};const Me=(0,ne.A)(Le,[["render",Re]]);var ye=Me,xe={components:{QTab:u.A,QTabs:d.A,QTabPanels:p.A,QTabPanel:f.A,QCard:m.A,QCardSection:g.A,QSeparator:b.A,DetalleOperaciones:ae,ConsultasOperaciones:ye,QPage:c.Tu},computed:{buttons:function(){var e,o,n=[];return"tab-consultas"===this.tab&&this.historico||(n=this.operacion===(null===(e=this.$refs["refTabOper".concat(this.tab)])||void 0===e?void 0:e.config.OPERACION_DEVOLUCION)&&2!==this.caso?[this.bancoButtons.enviarAlerta,this.bancoButtons.imprimirDevoluciones,this.bancoButtons.revertirDev]:this.operacion===(null===(o=this.$refs["refTabOper".concat(this.tab)])||void 0===o?void 0:o.config.OPERACION_RESERVA)?[this.bancoButtons.enviarAlerta,this.bancoButtons.prestar,this.bancoButtons.imprimirReservas,this.bancoButtons.anular]:[this.bancoButtons.enviarAlerta,this.bancoButtons.devolucion,this.bancoButtons.imprimirPrestamos,this.bancoButtons.ampliarPrestamos,this.bancoButtons.revertir]),n}},data:function(){var e=this;return{sieInfo:(0,O["default"])(),config:{},tab:"tab-operaciones",operacion:"",caso:1,historico:!1,feriados:[],bancoButtons:{enviarAlerta:{icon:"email",permiso:">1",label:"Enviar alerta",click:function(){e.$refs["refTabOper".concat(e.tab)].openEnvioAlerta()}},devolucion:{icon:"keyboard_return",permiso:">1",label:"Devolución",click:function(){var o="¿Está seguro de realizar la devolución de las operaciones seleccionadas?";e.$refs["refTabOper".concat(e.tab)].devolucionPrestamos(e.$refs["refTabOper".concat(e.tab)].config.OPERACION_DEVOLUCION,o,!0)}},prestar:{icon:"book",permiso:">1",label:"Prestar",click:function(){var o="¿Está seguro de prestar las reservas seleccionadas?";e.$refs["refTabOper".concat(e.tab)].prestamoMultiple(o)}},imprimirReservas:{icon:"print",permiso:">=1",label:"Imprimir",click:function(){e.$refs["refTabOper".concat(e.tab)].relacionReserva()}},imprimirPrestamos:{icon:"print",permiso:">=1",label:"Imprimir",click:function(){e.$refs["refTabOper".concat(e.tab)].relacionPrestamos()}},imprimirDevoluciones:{icon:"print",permiso:">=1",label:"Imprimir",click:function(){e.$refs["refTabOper".concat(e.tab)].relacionDevoluciones()}},ampliarPrestamos:{icon:"edit",permiso:">1",label:"Ampliar prestamo",click:function(){var o=s()(i()().m(function o(){return i()().w(function(o){while(1)switch(o.n){case 0:e.$refs["refTabOper".concat(e.tab)].openAmpliarPrestamo();case 1:return o.a(2)}},o)}));function n(){return o.apply(this,arguments)}return n}()},revertir:{icon:"undo",permiso:">1",label:"Revertir",click:function(){var o="¿Está seguro de revertir las operaciones seccionadas?";e.$refs["refTabOper".concat(e.tab)].devolucionPrestamos(e.$refs["refTabOper".concat(e.tab)].config.OPERACION_ANULACION,o)}},anular:{icon:"block",permiso:">1",label:"Anular",click:function(){var o="¿Está seguro de anular las reservas seccionadas?";e.$refs["refTabOper".concat(e.tab)].devolucionPrestamos(e.$refs["refTabOper".concat(e.tab)].config.OPERACION_ANULACION,o)}},revertirDev:{icon:"undo",permiso:">1",label:"Revertir",click:function(){var o="¿Está seguro de revertir las operaciones seccionadas?";e.$refs["refTabOper".concat(e.tab)].revertirDevoluciones(o)}}}}},methods:{setOperacion:function(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.operacion=e,this.caso=o},setearHistrorico:function(e){this.historico=e},invocaGetOperaciones:function(){var e=this;return s()(i()().m(function o(){var n,t,a,r;return i()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,e.$nextTick();case 1:r=null===(n=e.$refs["refTabOper".concat(e.tab)])||void 0===n?void 0:n.config.OPERACION_PRESTAMO,e.operacion=(null===(t=e.$refs["refTabOper".concat(e.tab)])||void 0===t?void 0:t.operacion)||r||1,e.caso=(null===(a=e.$refs["refTabOper".concat(e.tab)])||void 0===a?void 0:a.caso)||1,"tab-consultas"===e.tab&&e.$refs["refTabOper".concat(e.tab)]&&e.$refs["refTabOper".concat(e.tab)].getOperaciones();case 2:return o.a(2)}},o)}))()}},mounted:function(){},created:function(){var e=this;return s()(i()().m(function o(){return i()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,e.$http.get("api/OperacionesController/getFeriados");case 1:e.feriados=o.v;case 2:return o.a(2)}},o)}))()}};const _e=(0,ne.A)(xe,[["render",a]]);var Ue=_e}}]);