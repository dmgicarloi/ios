"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[87176],{87176:function(e,o,a){a.r(o),a.d(o,{default:function(){return z}});var n=a(8445),r=a.n(n),s=a(61758),t={class:"row q-ma-xs q-col-gutter-sm"},l={class:"col-xs-2"},i={class:"col-xs-4"},c={class:"col-xs-2"},u={class:"col-xs-4"},d={class:"row q-ma-xs q-col-gutter-sm"},m={class:"col-xs-6"},p={class:"col-xs-6"},f={class:"row q-ma-xs q-col-gutter-sm"},D={class:"col-xs-6"},h={class:"col-xs-6"},g={class:"col-12"},P={class:"col-12"},w={class:"col-12"};function b(e,o){var a=(0,s.g2)("q-page-header"),n=(0,s.g2)("q-separator"),b=(0,s.g2)("q-icon"),U=(0,s.g2)("q-input"),v=(0,s.g2)("q-select"),k=(0,s.g2)("sie-grid"),_=(0,s.g2)("footer-grid"),R=(0,s.g2)("q-card-section"),I=(0,s.g2)("q-checkbox"),A=(0,s.g2)("row"),N=(0,s.g2)("sie-modal"),x=(0,s.g2)("q-card");return(0,s.uX)(),(0,s.Wv)(x,{class:"layout-v1 my-card",flat:"",bordered:""},{default:(0,s.k6)(function(){return[(0,s.bF)(a,{title:e.pageHeader.title,tabs:e.pageHeader.tabs,useTab:"",componente:e.pageHeader.componente,nivelAcceso:e.pageHeader.nivelAcceso,botones:e.pageHeader.botones},null,8,["title","tabs","componente","nivelAcceso","botones"]),(0,s.bF)(n),(0,s.bF)(R,null,{default:(0,s.k6)(function(){return[(0,s.Lk)("div",t,[(0,s.Lk)("div",l,[(0,s.bF)(U,{label:"ID Persona 1",modelValue:e.personaUno,"onUpdate:modelValue":o[1]||(o[1]=function(o){return e.personaUno=o}),onInput:e.getDatosPersonaUno},{default:(0,s.k6)(function(){return[(0,s.bF)(b,{name:"search",color:"primary",style:{"font-size":"2rem",cursor:"pointer"},onClick:o[0]||(o[0]=function(o){return e.getDataUno()})})]}),_:1},8,["modelValue","onInput"])]),(0,s.Lk)("div",i,[(0,s.bF)(v,{label:"Nombre Persona 1","option-label":"NOMBRE","option-value":"ID_PERSONA",options:e.personas,modelValue:e.selectPersonaUno,"onUpdate:modelValue":o[2]||(o[2]=function(o){return e.selectPersonaUno=o}),onInput:e.getDatosPersonaUno},null,8,["options","modelValue","onInput"])]),(0,s.Lk)("div",c,[(0,s.bF)(U,{label:"ID Persona 2",modelValue:e.personaDos,"onUpdate:modelValue":o[4]||(o[4]=function(o){return e.personaDos=o}),onInput:e.getDatosPersonaDos},{default:(0,s.k6)(function(){return[(0,s.bF)(b,{name:"search",color:"primary",style:{"font-size":"2rem",cursor:"pointer"},onClick:o[3]||(o[3]=function(o){return e.getDataDos()})})]}),_:1},8,["modelValue","onInput"])]),(0,s.Lk)("div",u,[(0,s.bF)(v,{label:"Nombre Persona 2","option-label":"NOMBRE","option-value":"ID_PERSONA",options:e.personas,modelValue:e.selectPersonaDos,"onUpdate:modelValue":o[5]||(o[5]=function(o){return e.selectPersonaDos=o}),onInput:e.getDatosPersonaDos},null,8,["options","modelValue","onInput"])])]),o[14]||(o[14]=(0,s.Lk)("div",{class:"row q-ma-xs q-col-gutter-sm"},[(0,s.Lk)("div",{class:"col-xs-12"},[(0,s.Lk)("div",{class:"text-h6"},"Registros en Tablas")])],-1)),(0,s.Lk)("div",d,[(0,s.Lk)("div",m,[(0,s.bF)(k,{class:"wh-grid ag-theme-balham",style:{width:"100%",height:"213px"},columnDefs:e.columnsUno,rowData:e.rowDataUno,frameworkComponents:e.frameworkComponents,onGridReady:e.onGridReadyUno},null,8,["columnDefs","rowData","frameworkComponents","onGridReady"]),(0,s.bF)(_,{modelValue:e.gridUno.pagina,"onUpdate:modelValue":o[6]||(o[6]=function(o){return e.gridUno.pagina=o}),max:e.gridUno.pages,rows:e.gridUno.contador,onLoad:e.getDatosPersonaUno},null,8,["modelValue","max","rows","onLoad"])]),(0,s.Lk)("div",p,[(0,s.bF)(k,{class:"wh-grid ag-theme-balham",style:{width:"100%",height:"213px"},columnDefs:e.columnsDos,rowData:e.rowDataDos,frameworkComponents:e.frameworkComponents,onGridReady:e.onGridReadyDos},null,8,["columnDefs","rowData","frameworkComponents","onGridReady"]),(0,s.bF)(_,{modelValue:e.gridDos.pagina,"onUpdate:modelValue":o[7]||(o[7]=function(o){return e.gridDos.pagina=o}),max:e.gridDos.pages,rows:e.gridDos.contador,onLoad:e.getDatosPersonaDos},null,8,["modelValue","max","rows","onLoad"])])]),o[15]||(o[15]=(0,s.Lk)("div",{class:"row q-ma-xs q-col-gutter-sm"},[(0,s.Lk)("div",{class:"col-xs-12"},[(0,s.Lk)("div",{class:"text-h6"},"Perfiles Registrados")])],-1)),(0,s.Lk)("div",f,[(0,s.Lk)("div",D,[(0,s.bF)(k,{class:"wh-grid ag-theme-balham",style:{width:"100%",height:"213px"},columnDefs:e.columnsPerUno,rowData:e.rowDataPerUno,frameworkComponents:e.frameworkComponents,onGridReady:e.onGridReadyPerUno},null,8,["columnDefs","rowData","frameworkComponents","onGridReady"]),(0,s.bF)(_,{modelValue:e.gridPerUno.pagina,"onUpdate:modelValue":o[8]||(o[8]=function(o){return e.gridPerUno.pagina=o}),max:e.gridPerUno.pages,rows:e.gridPerUno.contador,onLoad:e.getPerfilUno},null,8,["modelValue","max","rows","onLoad"])]),(0,s.Lk)("div",h,[(0,s.bF)(k,{class:"wh-grid ag-theme-balham",style:{width:"100%",height:"213px"},columnDefs:e.columnsPerDos,rowData:e.rowDataPerDos,frameworkComponents:e.frameworkComponents,onGridReady:e.onGridReadyPerDos},null,8,["columnDefs","rowData","frameworkComponents","onGridReady"]),(0,s.bF)(_,{modelValue:e.gridPerDos.pagina,"onUpdate:modelValue":o[9]||(o[9]=function(o){return e.gridPerDos.pagina=o}),max:e.gridPerDos.pages,rows:e.gridPerDos.contador,onLoad:e.getPerfilDos},null,8,["modelValue","max","rows","onLoad"])])])]}),_:1}),(0,s.bF)(R,null,{default:(0,s.k6)(function(){return[(0,s.bF)(N,{modelValue:e.openModal,"onUpdate:modelValue":o[13]||(o[13]=function(o){return e.openModal=o}),onSubmit:e.procesarPersonas,labelButtonOk:"Unir"},{default:(0,s.k6)(function(){return[(0,s.bF)(R,null,{default:(0,s.k6)(function(){return r()(o[16]||(o[16]=[(0,s.Lk)("div",{class:"row q-ma-xs q-col-gutter-sm"},[(0,s.Lk)("div",{class:"col-xs-12"},[(0,s.Lk)("div",{class:"text-h6"},"Elegir persona que se elimina y prevalece")])],-1)]))}),_:1}),(0,s.bF)(n),(0,s.bF)(R,null,{default:(0,s.k6)(function(){return[(0,s.bF)(A,{class:"q-ma-xs q-col-gutter-sm"},{default:(0,s.k6)(function(){return[(0,s.Lk)("div",g,[(0,s.bF)(v,{label:"Persona a Eliminar","option-value":"value","option-label":"label",options:e.personasDuplicadas,modelValue:e.form.id_persona_del,"onUpdate:modelValue":o[10]||(o[10]=function(o){return e.form.id_persona_del=o}),onInput:e.viewDatosPersona},null,8,["options","modelValue","onInput"])]),(0,s.Lk)("div",P,[(0,s.bF)(I,{label:"Eliminar de tablas de ADMISION: Fichas, Cronogramas, etc.",modelValue:e.form.admision_del,"onUpdate:modelValue":o[11]||(o[11]=function(o){return e.form.admision_del=o}),"true-value":e.true_value,"false-value":e.false_value},null,8,["modelValue","true-value","false-value"])]),(0,s.Lk)("div",w,[(0,s.bF)(U,{label:"Persona a Prevalecer",modelValue:e.form.persona_nombre,"onUpdate:modelValue":o[12]||(o[12]=function(o){return e.form.persona_nombre=o}),readonly:e.disabled},null,8,["modelValue","readonly"])])]}),_:1})]}),_:1})]}),_:1},8,["modelValue","onSubmit"])]}),_:1})]}),_:1})}var U=a(76080),v=a.n(U),k=a(45254),_=a.n(k),R=(a(30683),a(10239),a(11777),a(88567)),I=a(95718),A=a(53380),N=a(54489),x=a(64208),C=a(3112),L=a(12143),V=a(95477),y=a(80660),O=a(6123),F=a(36408),E=a(27560),S=a(96330),q=a(64303),G=a(78840),M=a(2652),B=a(41615),T=a(75053),Q={components:{actionButton:G.A,QDate:L.A,QPopupProxy:V.A,QCard:R.A,QCardSection:I.A,QSelect:N.S,QOptionGroup:O.EX,QSeparator:A.A,sieGrid:F.A,QInput:x.A,footerGrid:E.A,QCheckbox:C.A,crearBotones:q.A,QPageHeader:M.A,headerGrid:S.A,sieModal:T.A,QIcon:O.bP},data:function(){return{frameworkComponents:null,true_value:"S",false_value:"N",pageHeader:{botones:[],tabs:[{name:"index",label:"Comparativo"}],tabActive:"index",title:"Proceso para Unir Personas",componente:"unirPersonas",nivelAcceso:3},form:{id_persona_del:null,id_persona:null,persona_nombre:"",admision_del:"N"},openModal:!1,selectPersonaUno:null,selectPersonaDos:null,dataPersonaUno:{},dataPersonaDos:{},columnsUno:[],columnsDos:[],columnsPerUno:[],columnsPerDos:[],personaUno:null,personaDos:null,personas:[],rowDataUno:[],rowDataDos:[],rowDataPerUno:[],rowDataPerDos:[],apiUno:null,apiDos:null,personasDuplicadas:[],gridUno:{pagina:1,pages:1,contador:0},gridDos:{pagina:1,pages:1,contador:0},gridPerUno:{pagina:1,pages:1,contador:0},gridPerDos:{pagina:1,pages:1,contador:0},disabled:!0}},beforeMount:function(){var e=this;return _()(v()().m(function o(){var a;return v()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,B["default"].VERIFICAR_USUARIO_ADMINISTRADOR();case 1:a=o.v,a||e.$router.push({name:"tesoreria.home"}),e.cargarPersonas(),e.frameworkComponents={actionButton:G.A},e.columnsUno=[{field:"TABLA",headerName:"Tabla",width:250,sortable:!0},{field:"CAMPO",headerName:"Campo",width:160,sortable:!0},{field:"REGISTROS",headerName:"Cant.",width:80,sortable:!0,cellStyle:{textAlign:"right"}}],e.columnsDos=[{field:"TABLA",headerName:"Tabla",width:250,sortable:!0},{field:"CAMPO",headerName:"Campo",width:160,sortable:!0},{field:"REGISTROS",headerName:"Cant.",width:80,sortable:!0,cellStyle:{textAlign:"right"}}],e.columnsPerUno=[{field:"ID_PERFIL",headerName:"ID",width:50,sortable:!0},{field:"PERFIL",headerName:"Perfil",width:160,sortable:!0},{field:"CODIGO",headerName:"Código",width:100,sortable:!0},{field:"TIPDOC",headerName:"Tipo Doc.",width:100,sortable:!0},{field:"NUMDOC",headerName:"Nro. Doc.",width:100,sortable:!0}],e.columnsPerDos=[{field:"ID_PERFIL",headerName:"ID",width:50,sortable:!0},{field:"PERFIL",headerName:"Perfil",width:160,sortable:!0},{field:"CODIGO",headerName:"Código",width:100,sortable:!0},{field:"TIPDOC",headerName:"Tipo Doc.",width:100,sortable:!0},{field:"NUMDOC",headerName:"Nro. Doc.",width:100,sortable:!0}],e.pageHeader.botones=[{label:"Procesar",icon:"merge_type",click:e.openBox,minAcceso:1}];case 2:return o.a(2)}},o)}))()},methods:{procesarPersonas:function(){var e=this;this.$confirm("¿Esta unificar las 2 personas? Este proceso unirá la data (Tablas) y los perfiles de ambas personas").onOk(_()(v()().m(function o(){var a,n;return v()().w(function(o){while(1)switch(o.p=o.n){case 0:return o.p=0,o.n=1,y.$http.post("api/PersonaController/postUnirPersonas",{datos:e.form});case 1:a=o.v,e.$alert(a.message,"success"),e.openModal=!1,e.form.id_persona_del===e.selectPersonaUno?(e.rowDataUno=[],e.rowDataPerUno=[],e.selectPersonaUno=null,e.personaUno=null):(e.rowDataDos=[],e.rowDataPerDos=[],e.selectPersonaDos=null,e.personaDos=null),o.n=3;break;case 2:return o.p=2,n=o.v,e.$q.loading.hide(),o.a(2,e.$alert(n.error?n.error.message:n.message,"warning"));case 3:return o.a(2)}},o,null,[[0,2]])})))},openBox:function(){if(this.personasDuplicadas=[],this.form.persona_nombre="",this.form.id_persona_del=null,this.form.id_persona=null,this.form.admision_del="N",this.selectPersonaUno&&this.selectPersonaDos){if(this.selectPersonaUno===this.selectPersonaDos)return this.$alert("La persona 1 (".concat(this.selectPersonaUno,") y la persona 2 (").concat(this.selectPersonaDos,") son iguales"),"warning"),!1;this.openModal=!0,this.personasDuplicadas.push({value:this.selectPersonaUno,label:"".concat(this.dataPersonaUno.ID_PERSONA," | ").concat(this.dataPersonaUno.NOMBRE)}),this.personasDuplicadas.push({value:this.selectPersonaDos,label:"".concat(this.dataPersonaDos.ID_PERSONA," | ").concat(this.dataPersonaDos.NOMBRE)})}},viewDatosPersona:function(){this.selectPersonaUno===this.form.id_persona_del?(this.form.id_persona=this.dataPersonaDos.ID_PERSONA,this.form.persona_nombre="".concat(this.dataPersonaDos.ID_PERSONA," | ").concat(this.dataPersonaDos.NOMBRE)):(this.form.id_persona=this.dataPersonaUno.ID_PERSONA,this.form.persona_nombre="".concat(this.dataPersonaUno.ID_PERSONA," | ").concat(this.dataPersonaUno.NOMBRE))},getDataUno:function(){var e=this;return _()(v()().m(function o(){var a;return v()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,e.getDatos(e.personaUno);case 1:if(a=o.v,!(a.length>0)){o.n=3;break}return e.selectPersonaUno=Number(e.personaUno),o.n=2,e.cargarDatosUno(a);case 2:o.n=4;break;case 3:e.rowDataUno=[];case 4:return o.a(2)}},o)}))()},getDatosPersonaUno:function(){var e=this;return _()(v()().m(function o(){var a;return v()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,e.getDatos(e.selectPersonaUno);case 1:return a=o.v,o.n=2,e.cargarDatosUno(a);case 2:return o.a(2)}},o)}))()},cargarDatosUno:function(e){var o=this;return _()(v()().m(function a(){return v()().w(function(a){while(1)switch(a.n){case 0:return o.rowDataUno=e,o.gridUno.contador=e.length,a.n=1,o.getPerfilUno();case 1:return a.a(2)}},a)}))()},getPerfilUno:function(){var e=this;return _()(v()().m(function o(){var a,n,s;return v()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,e.getPerfiles(e.selectPersonaUno);case 1:a=o.v,a.perfiles.length>0?(e.rowDataPerUno=a.perfiles,n=r()(a.perfiles),s=n[0],e.dataPersonaUno=s,e.gridPerUno.contador=a.perfiles.length):e.rowDataPerUno=[];case 2:return o.a(2)}},o)}))()},getDataDos:function(){var e=this;return _()(v()().m(function o(){var a;return v()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,e.getDatos(e.personaDos);case 1:if(a=o.v,!(a.length>0)){o.n=3;break}return e.selectPersonaDos=Number(e.personaDos),o.n=2,e.cargarDatosDos();case 2:o.n=4;break;case 3:e.rowDataDos=[];case 4:return o.a(2)}},o)}))()},cargarDatosDos:function(e){var o=this;return _()(v()().m(function a(){return v()().w(function(a){while(1)switch(a.n){case 0:return o.rowDataDos=e,o.gridDos.contador=e.length,a.n=1,o.getPerfilDos();case 1:return a.a(2)}},a)}))()},getDatosPersonaDos:function(){var e=this;return _()(v()().m(function o(){var a;return v()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,e.getDatos(e.selectPersonaDos);case 1:return a=o.v,o.n=2,e.cargarDatosDos(a);case 2:return o.a(2)}},o)}))()},getDatos:function(e){return _()(v()().m(function o(){return v()().w(function(o){while(1)switch(o.n){case 0:return o.a(2,y.$http.get("api/personaController/getInfoPersona",{params:{params:{ID_PERSONA:e}}}))}},o)}))()},getPerfilDos:function(){var e=this;return _()(v()().m(function o(){var a,n,s;return v()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,e.getPerfiles(e.selectPersonaDos);case 1:a=o.v,a.perfiles.length>0?(e.rowDataPerDos=a.perfiles,n=r()(a.perfiles),s=n[0],e.dataPersonaDos=s,e.gridPerDos.contador=a.perfiles.length):e.rowDataPerDos=[];case 2:return o.a(2)}},o)}))()},cargarPersonas:function(){var e=this;return _()(v()().m(function o(){return v()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,y.$http.get("api/personaController/getPersonas");case 1:e.personas=o.v;case 2:return o.a(2)}},o)}))()},getPerfiles:function(e){return _()(v()().m(function o(){return v()().w(function(o){while(1)switch(o.n){case 0:return o.a(2,y.$http.get("api/personaController/getPerfilesPorPersona",{params:{params:{idPersona:e}}}))}},o)}))()},onGridReadyUno:function(e){this.apiUno=e.api},onGridReadyDos:function(e){this.apiDos=e.api},onGridReadyPerUno:function(e){this.apiPerUno=e.api},onGridReadyPerDos:function(e){this.apiPerDos=e.api}}},$=a(12807);const H=(0,$.A)(Q,[["render",b]]);var z=H}}]);