"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[50957],{50957:function(e,o,t){t.r(o),t.d(o,{default:function(){return he}});var i=t(8445),n=t.n(i),a=t(61758),l=t(58790),s={class:"row"},c={class:"col"},r={class:"row q-col-gutter-sm q-pa-sm"},u={key:0,class:"col-xs-12"},d={class:"row full-height q-pt-sm"},f={class:"col column items-center justify-start"},p={class:"col-xs-12 col-md-2"},m={class:"col-xs-12 col-md-4"},h={class:"col-xs-12 col-md-2"},g={class:"col-xs-12 col-sm-6 col-md-2"},b={class:"col-xs-12 col-sm-6 col-md-2"},v={class:"col-xs-12 col-sm-6 col-md-3"},F={class:"col-xs-12 col-sm-6 col-md-3"},k={class:"col-xs-12 col-sm-12 col-md-6"},I={class:"row q-gutter-sm"},w={class:"col"},R={key:0},D={class:"row full-height"},C={class:"col column items-center justify-start"},x={class:"row q-col-gutter-xs"},P={class:"col-xs-12 col-sm-12"},V={class:"row sie-flat"},O={class:"col-xs-12"},_={class:"col-xs-12"},S={class:"row q-col-gutter-sm q-pa-sm"},E={class:"col-12"},L={key:0,class:"col-12"},T={style:{"font-size":"16px","padding-left":"4px"}},A={key:1,class:"col-12"},M={class:"col-xs-12 col-md-12 row class-ligth-grey"},q={class:"col-xs-12 col-md-12",style:{"padding-right":"4px"}},B={class:"col-12"};function U(e,o){var t=this,i=(0,a.g2)("header-btn"),U=(0,a.g2)("q-separator"),N=(0,a.g2)("q-img"),y=(0,a.g2)("autocomplete"),Q=(0,a.g2)("q-input"),Y=(0,a.g2)("q-select"),H=(0,a.g2)("q-date"),G=(0,a.g2)("q-popup-proxy"),X=(0,a.g2)("q-icon"),W=(0,a.g2)("q-tooltip"),$=(0,a.g2)("q-btn"),j=(0,a.g2)("q-card-section"),z=(0,a.g2)("sie-table"),J=(0,a.g2)("q-card"),K=(0,a.g2)("sie-modal"),Z=(0,a.g2)("box-imagen"),ee=(0,a.g2)("q-page");return(0,a.uX)(),(0,a.Wv)(ee,{class:"movimiento-operaciones q-pa-sm sie-flat"},{default:(0,a.k6)(function(){return[(0,a.bF)(J,{flat:""},{default:(0,a.k6)(function(){return[(0,a.bF)(i,{name:"Reposiciones de Usuarios ",buttons:e.headerButtons},null,8,["buttons"]),(0,a.bF)(U),(0,a.bF)(j,null,{default:(0,a.k6)(function(){return[(0,a.Lk)("div",s,[(0,a.Lk)("div",c,[(0,a.Lk)("div",r,[e.getWidth<=699?((0,a.uX)(),(0,a.CE)("div",u,[(0,a.Lk)("div",d,[(0,a.Lk)("div",f,[(0,a.bF)(N,{class:"foto-alumno",src:e.rutaFoto,width:"100px",height:"100px",onClick:e.openBoxImagen},{error:(0,a.k6)(function(){return[(0,a.bF)(N,{class:"foto-alumno",src:e.rutaFotoDefault,width:"100px",height:"100px"},null,8,["src"])]}),_:1},8,["src","onClick"])])])])):(0,a.Q3)("v-if",!0),(0,a.Lk)("div",p,[(0,a.bF)(y,{class:"q-ma-none",modelValue:e.solicitante,"onUpdate:modelValue":o[0]||(o[0]=function(o){return e.solicitante=o}),data:e.listaSolicitantes,label:"Codigo / Nombre",keys:e.llaveSolicitante,onSelected:e.asignaSolicitante},null,8,["modelValue","data","keys","onSelected"])]),(0,a.Lk)("div",m,[(0,a.bF)(Q,{modelValue:e.nombre,"onUpdate:modelValue":o[1]||(o[1]=function(o){return e.nombre=o}),label:"Nombre",readonly:""},null,8,["modelValue"])]),(0,a.Lk)("div",h,[(0,a.bF)(Q,{modelValue:e.ngs,"onUpdate:modelValue":o[2]||(o[2]=function(o){return e.ngs=o}),label:"NGS",readonly:""},null,8,["modelValue"])]),(0,a.Lk)("div",g,[(0,a.bF)(Y,{options:e.listaBibliotecas,modelValue:e.biblioteca,"onUpdate:modelValue":o[3]||(o[3]=function(o){return e.biblioteca=o}),label:"Bibliotecas","option-value":"BIBCOD","option-label":"BIBDESC",onInput:e.bibliotecaSelecionada},null,8,["options","modelValue","onInput"])]),(0,a.Lk)("div",b,[(0,a.bF)(Y,{options:e.listaTipos,modelValue:e.tipo,"onUpdate:modelValue":o[4]||(o[4]=function(o){return e.tipo=o}),label:"Mostrar","option-value":"value","option-label":"label",onInput:e.tipoSeleccionado},null,8,["options","modelValue","onInput"])]),(0,a.Lk)("div",v,[(0,a.bF)(Q,{label:"Desde",debounce:"500",maxlength:"10",format:"##/##/####",modelValue:e.fechaInicio,"onUpdate:modelValue":o[7]||(o[7]=function(o){return e.fechaInicio=o}),mask:"##/##/####",readonly:""},{append:(0,a.k6)(function(){return[(0,a.bF)(X,{class:"cursor-pointer",name:"date_range"},{default:(0,a.k6)(function(){return[(0,a.bF)(G,{ref:"fechaInicio","transition-show":"scale","transition-hide":"scale"},{default:(0,a.k6)(function(){return[(0,a.bF)(H,{mask:"DD/MM/YYYY",modelValue:e.fechaInicio,"onUpdate:modelValue":o[5]||(o[5]=function(o){return e.fechaInicio=o}),onInput:o[6]||(o[6]=function(o){return e.ingresarFecha("fechaInicio")})},null,8,["modelValue"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])]),(0,a.Lk)("div",F,[(0,a.bF)(Q,{label:"Hasta",debounce:"500",maxlength:"10",format:"##/##/####",modelValue:e.fechaFin,"onUpdate:modelValue":o[10]||(o[10]=function(o){return e.fechaFin=o}),mask:"##/##/####",readonly:""},{append:(0,a.k6)(function(){return[(0,a.bF)(X,{class:"cursor-pointer",name:"date_range"},{default:(0,a.k6)(function(){return[(0,a.bF)(G,{ref:"fechaFin","transition-show":"scale","transition-hide":"scale"},{default:(0,a.k6)(function(){return[(0,a.bF)(H,{mask:"DD/MM/YYYY",modelValue:e.fechaFin,"onUpdate:modelValue":o[8]||(o[8]=function(o){return e.fechaFin=o}),onInput:o[9]||(o[9]=function(o){return e.ingresarFecha("fechaFin")})},null,8,["modelValue"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])]),(0,a.Lk)("div",k,[(0,a.Lk)("div",I,[(0,a.Lk)("div",w,[(0,a.bF)(y,{class:"q-ma-none",modelValue:e.titulo,"onUpdate:modelValue":o[11]||(o[11]=function(o){return e.titulo=o}),data:e.listaTitulos,label:"Titulos",keys:e.llaveTitulo,onSelected:e.asignaTitulo},null,8,["modelValue","data","keys","onSelected"])]),(0,a.bF)($,{class:"q-pa-sm",icon:"broom",size:"10px",color:"primary",onClick:e.limpiar},{default:(0,a.k6)(function(){return[(0,a.bF)(W,null,{default:(0,a.k6)(function(){return n()(o[20]||(o[20]=[(0,a.eW)("Limpiar",-1)]))}),_:1})]}),_:1},8,["onClick"])])])])]),e.getWidth>=700?((0,a.uX)(),(0,a.CE)("div",R,[(0,a.Lk)("div",D,[(0,a.Lk)("div",C,[(0,a.bF)(N,{class:"foto-alumno",src:e.rutaFoto,width:"76px",height:"76px",onClick:e.openBoxImagen},{error:(0,a.k6)(function(){return[(0,a.bF)(N,{class:"foto-alumno",src:e.rutaFotoDefault,width:"76px",height:"76px"},null,8,["src"])]}),_:1},8,["src","onClick"])])])])):(0,a.Q3)("v-if",!0)])]}),_:1}),(0,a.bF)(j,null,{default:(0,a.k6)(function(){return[(0,a.Lk)("div",x,[(0,a.Lk)("div",P,[(0,a.Lk)("div",V,[(0,a.Lk)("div",O,[(0,a.bF)(i,{auto:!1,name:"Deudas / Pagos","font-size":"14px",border:!1})]),(0,a.Lk)("div",_,[(0,a.bF)(z,{ref:"deudasPagos","show-search":!1,onRowSelectedDbl:e.cargarFila,columns:e.fields,data:e.listaReposiciones,selection:"single",context:t,config:e.config,css:{height:"calc(72vh - 45px)"}},null,8,["onRowSelectedDbl","columns","data","config"])])])])])]}),_:1})]}),_:1}),(0,a.bF)(K,{modelValue:e.modalDatosPago,"onUpdate:modelValue":o[18]||(o[18]=function(o){return e.modalDatosPago=o}),title:"Datos Pago",ok:"Grabar",onSubmit:e.grabarReposicion,css:{width:"700px"}},{default:(0,a.k6)(function(){return[(0,a.Lk)("div",S,[(0,a.Lk)("div",E,[(0,a.bF)(Y,{modelValue:e.tipoReposicion,"onUpdate:modelValue":o[12]||(o[12]=function(o){return e.tipoReposicion=o}),options:e.tiposReposiciones,label:"Tipo de Reposición"},null,8,["modelValue","options"])]),1===t.tipoReposicion?((0,a.uX)(),(0,a.CE)("div",L,[(0,a.bF)(Q,{modelValue:e.monto,"onUpdate:modelValue":o[13]||(o[13]=function(o){return e.monto=o}),label:"Monto",disable:""},{prepend:(0,a.k6)(function(){return[(0,a.Lk)("span",T,(0,l.v_)(e.moneda),1)]}),_:1},8,["modelValue"])])):(0,a.Q3)("v-if",!0),1===t.tipoReposicion?((0,a.uX)(),(0,a.CE)("div",A,[(0,a.bF)(Q,{modelValue:e.nroRecibo,"onUpdate:modelValue":o[14]||(o[14]=function(o){return e.nroRecibo=o}),label:"Numero Recibo"},null,8,["modelValue"])])):(0,a.Q3)("v-if",!0),(0,a.Lk)("div",M,[(0,a.Lk)("div",q,[(0,a.bF)(Q,{label:"Fecha reposicion",debounce:"500",maxlength:"10",format:"##/##/####",modelValue:e.fechaPago,"onUpdate:modelValue":o[16]||(o[16]=function(o){return e.fechaPago=o}),mask:"##/##/####",readonly:""},{append:(0,a.k6)(function(){return[(0,a.bF)(X,{class:"cursor-pointer",name:"date_range"},{default:(0,a.k6)(function(){return[(0,a.bF)(G,{ref:"fechaPago","transition-show":"scale","transition-hide":"scale"},{default:(0,a.k6)(function(){return[(0,a.bF)(H,{mask:"DD/MM/YYYY",modelValue:e.fechaPago,"onUpdate:modelValue":o[15]||(o[15]=function(o){return e.fechaPago=o})},null,8,["modelValue"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])])]),(0,a.Lk)("div",B,[(0,a.bF)(Q,{type:"textarea",modelValue:e.observaciones,"onUpdate:modelValue":o[17]||(o[17]=function(o){return e.observaciones=o}),label:"Observaciones",height:"100px","max-height":150,rows:"5",ref:"obs"},null,8,["modelValue"])])])]}),_:1},8,["modelValue","onSubmit"]),e.openModalImagen?((0,a.uX)(),(0,a.Wv)(Z,{key:0,modelValue:e.openModalImagen,"onUpdate:modelValue":o[19]||(o[19]=function(o){return e.openModalImagen=o}),urlImage:e.urlImagenBox,urlImageDefault:e.rutaFotoDefault,titulo:e.nombre},null,8,["modelValue","urlImage","urlImageDefault","titulo"])):(0,a.Q3)("v-if",!0)]}),_:1})}var N=t(57008),y=t.n(N),Q=t(76080),Y=t.n(Q),H=t(45254),G=t.n(H),X=(t(30683),t(71225),t(52133),t(10239),t(50310),t(5962),t(6724),t(83190),t(2369),t(6123)),W=t(88567),$=t(95718),j=t(53380),z=t(16648),J=t(982),K=t(57668),Z=t(30640),ee=t(93616),oe=t(78840),te=t(95477),ie=(t(77507),{data:function(){var e=this;return{config:{FECHA:{component:"date",edit:!1},FECHAREP:{component:"date",edit:!1},EDITAR:{component:"button",icon:["edit as editar"],tooltip:{editar:"Editar"},editar:function(){var o=G()(Y()().m(function o(t){return Y()().w(function(o){while(1)switch(o.n){case 0:e.modalDatosPago=!0,e.idRegistro=t.ID,e.id_persona=t.ID_PERSONA,e.id_perfil=t.ID_PERFIL,e.tipoReposicion=t.TIPOREPOSICION,e.id_deuda=t.ID_DEUDA,e.solicitante=t.SOLCOD,e.monto=t.MONTO,e.moneda=t.MONEDA,e.nroRecibo=t.NUM_RECIBO,e.observaciones=t.OBSERVACION,e.fechaPago=t.FECHAREP?t.FECHAREP.split("/").reverse().join("/"):e.formateaFechaActual();case 1:return o.a(2)}},o)}));function t(e){return o.apply(this,arguments)}return t}(),flat:!0,dense:!0}},fields:[{name:"NUMINGRESO",label:"Nro Ingreso",field:"NUMINGRESO",align:"left"},{name:"NOMCOMP",label:"Nombre de Solicitante",field:"NOMCOMP",align:"left",wrap:!0},{name:"NGS_CARGO",label:"NGS / Cargo",field:"NGS_CARGO",align:"center"},{name:"PARTE",label:"Cod. Clasif",field:"PARTE",align:"left",wrap:!0},{name:"TITULO",label:"Título",field:"TITULO",align:"center"},{name:"MONTO",label:"Monto",field:"MONTO",align:"center"},{name:"NUM_RECIBO",label:"Nro Recibo",field:"NUM_RECIBO",align:"center"},{name:"FECHA",label:"Fecha Deuda",field:"FECHA",align:"center"},{name:"FECHAREP",label:"Fecha Pago",field:"FECHAREP",align:"center"},{name:"EDITAR",label:"Editar",field:"EDITAR",align:"center"}]}}}),ne=t(3042),ae=t(4437),le=t(9736),se=t(57343),ce=t(2819),re=t(53399),ue=t(21103),de=(t(10213),t(98361)),fe={mixins:[ie],components:{QCard:W.A,QCardSection:$.A,QSeparator:j.A,sieSelect:ee.A,notify:J["default"],QSelect:z.A,sieModal:Z.A,actionButton:oe.A,QPopupProxy:te.A,autocomplete:ne.A,QDate:ae.A,QInput:le.A,QImg:re.A,boxImagen:de.A,QPage:X.Tu,QIcon:X.bP,QBtn:X.Il,QTooltip:X.nC},computed:{getWidth:function(){return ue.A.width},rutaFotoDefault:function(){var e=(0,se.getImageDefault)(this.sie,this.sexo);return e},rutaFoto:function(){var e=(0,se.imgEstudiante)(this.sie,this.codigoFoto);return e}},data:function(){var e=this;return{sie:(0,K["default"])(),headerButtons:[{icon:"file_pdf",permiso:">2",label:"Imprimir PDF",click:function(){var o=G()(Y()().m(function o(){var t;return Y()().w(function(o){while(1)switch(o.n){case 0:t={tipodeuda:e.tipo,formato:"pdf"},(0,ce.exportFilePhp)(t,"biblioteca/reportes/relacion-reposiciones");case 1:return o.a(2)}},o)}));function t(){return o.apply(this,arguments)}return t}()},{icon:"file_excel",permiso:">1",label:"Imprimir Excel",click:function(){var o={tipodeuda:e.tipo,formato:"xls"};(0,ce.exportFilePhp)(o,"biblioteca/reportes/relacion-reposiciones")}}],llaveSolicitante:["TEXT"],llaveTitulo:["CATALOGO","TITULO","FICHACOD"],listaSolicitantes:[],listaTitulos:[],listaBibliotecas:[{BIBCOD:"T",BIBDESC:"Todas"}],listaTipos:[{value:1,label:"Deudas"},{value:2,label:"Pagos"},{value:3,label:"Todos"}],listaReposiciones:[],solicitante:null,codigoFoto:"",titulo:null,biblioteca:null,fechaInicio:null,fechaFin:null,tipo:1,nombre:null,ngs:null,fichacod:null,modalDatosPago:null,monto:null,moneda:null,nroRecibo:null,observaciones:null,fechaPago:null,sexo:"M",idRegistro:null,openModalImagen:!1,urlImagenBox:"",id_persona:"",id_perfil:"",id_deuda:null,tipoReposicion:2,tiposReposiciones:[{value:1,label:"Pago"},{value:2,label:"Libro por libro"}]}},methods:{openBoxImagen:function(){this.urlImagenBox=this.codigoFoto?this.rutaFoto:this.rutaFotoDefault,this.openModalImagen=!0},getlistaSolcitantes:function(){var e=this;return G()(Y()().m(function o(){return Y()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,e.$http.get("api/OperacionesController/getPersonasBiblioteca");case 1:e.listaSolicitantes=o.v;case 2:return o.a(2)}},o)}))()},getlistaTitulos:function(){var e=this;return G()(Y()().m(function o(){return Y()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,e.$http.get("api/MantenimientosController/getTitulos");case 1:e.listaTitulos=o.v;case 2:return o.a(2)}},o)}))()},getlistaReposiciones:function(e){var o=this;return G()(Y()().m(function t(){var i;return Y()().w(function(t){while(1)switch(t.n){case 0:return i=e||{tipo:o.tipo},t.n=1,o.$http.get("api/ReposicionesController/getlistaReposiciones",{params:{params:i}});case 1:o.listaReposiciones=t.v;case 2:return t.a(2)}},t)}))()},getBibliotecas:function(){var e=this;return G()(Y()().m(function o(){var t;return Y()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,e.$http.get("api/ReposicionesController/getBibliotecas");case 1:t=o.v,t.map(function(o){e.listaBibliotecas.push(o)});case 2:return o.a(2)}},o)}))()},pagarDeuda:function(e){var o=this;return G()(Y()().m(function t(){return Y()().w(function(t){while(1)switch(t.n){case 0:return t.a(2,o.$http.post("api/ReposicionesController/subsanarDeuda",{params:e}))}},t)}))()},busquedaPorFiltro:function(){var e={solcod:this.solicitante?this.solicitante:null,titulo:this.titulo?this.titulo:null,biblioteca:this.biblioteca&&"T"!==this.biblioteca?this.biblioteca:null,fichacod:this.fichacod?this.fichacod:null,fechaInicio:this.fechaInicio?this.fechaInicio:null,fechaFin:this.fechaFin?this.fechaFin:null,tipo:this.tipo};this.getlistaReposiciones(e)},formateaFechaActual:function(){var e=new Date,o=String(e.getDate()).padStart(2,"0"),t=String(e.getMonth()+1).padStart(2,"0"),i=e.getFullYear(),n="".concat(o,"/").concat(t,"/").concat(i);return n},bibliotecaSelecionada:function(){this.busquedaPorFiltro()},asignaSolicitante:function(e){var o=this;return G()(Y()().m(function t(){return Y()().w(function(t){while(1)switch(t.n){case 0:o.id_persona=e.ID_PERSONA,o.id_perfil=e.ID_PERFIL,o.solicitante=e.SOLCOD,o.nombre=e.NOMCOMP,o.sexo=e.SEXO,o.ngs=e.DESCRIPTOR,o.solicitante=e.SOLCOD,o.codigoFoto=1===e.ID_PERFIL?e.SOLCOD:"",o.busquedaPorFiltro();case 1:return t.a(2)}},t)}))()},cargarFila:function(e){var o=this;return G()(Y()().m(function t(){var i;return Y()().w(function(t){while(1)switch(t.n){case 0:return i=o.listaSolicitantes.filter(function(o){return o.SOLCOD===e.SOLCOD}),t.n=1,o.asignaSolicitante(i[0]);case 1:return t.a(2)}},t)}))()},asignaTitulo:function(e){this.titulo=e.TITULO,this.fichacod=e.FICHACOD,this.busquedaPorFiltro()},ingresarFecha:function(e){this.$refs[e].hide(),this.busquedaPorFiltro()},tipoSeleccionado:function(){var e=this;return G()(Y()().m(function o(){return Y()().w(function(o){while(1)switch(o.n){case 0:e.solicitante?e.busquedaPorFiltro():e.getlistaReposiciones();case 1:return o.a(2)}},o)}))()},limpiar:function(){this.tipoReposicion=2,this.id_deuda=null,this.solicitante="",this.id_perfil="",this.id_persona="",this.codigoFoto="",this.nombre="",this.ngs="",this.titulo="",this.sexo="M",this.biblioteca="",this.fichacod="",this.fechaInicio="",this.fechaFin="",this.tipo=1,this.busquedaPorFiltro()},grabarReposicion:function(){var e=this;return G()(Y()().m(function o(){var t,i,n;return Y()().w(function(o){while(1)switch(o.p=o.n){case 0:if(e.fechaPago){o.n=1;break}return(0,J["default"])("Debe ingresar la fecha de reposición","warning"),o.a(2,1);case 1:if(1!==e.tipoReposicion){o.n=2;break}return(0,J["default"])("Las reposiciones de pago se gestionan desde tesorería","warning"),o.a(2,1);case 2:return t={id:e.idRegistro,fechaPago:e.fechaPago,monto:e.monto,nroRecibo:e.nroRecibo,observaciones:e.observaciones,usucod:e.sie.usucod,solcod:e.solicitante,id_deuda:e.id_deuda,tipoReposicion:e.tipoReposicion,id_perfil:e.id_perfil,id_persona:e.id_persona},o.p=3,o.n=4,e.pagarDeuda(y()({},t));case 4:return i=o.v,o.n=5,e.getlistaReposiciones();case 5:e.modalDatosPago=!1,(0,J["default"])(i.message,"success"),o.n=7;break;case 6:o.p=6,n=o.v,(0,J["default"])(n.message,"warning");case 7:return o.a(2)}},o,null,[[3,6]])}))()},cargarDatosPrincipales:function(){var e=this;return G()(Y()().m(function o(){return Y()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,e.getBibliotecas();case 1:return o.n=2,e.getlistaSolcitantes();case 2:return o.n=3,e.getlistaTitulos();case 3:e.limpiar();case 4:return o.a(2)}},o)}))()}},created:function(){var e=this;return G()(Y()().m(function o(){return Y()().w(function(o){while(1)switch(o.n){case 0:e.cargarDatosPrincipales();case 1:return o.a(2)}},o)}))()}},pe=t(12807);const me=(0,pe.A)(fe,[["render",U]]);var he=me}}]);