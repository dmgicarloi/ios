"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[56195],{56195:function(e,o,l){l.r(o),l.d(o,{default:function(){return W}});var t=l(61758),a=l(58790),s={class:"q-ma-sm"},n={class:"q-card q-my-xs"},i={class:"row justify-end q-px-sm"},u={class:"row"},r={key:2,class:"row"},c={class:"row q-pa-sm"},d={class:"q-table q-table-horizontal-separator col"},m={key:0},f={key:1},v={class:"column"},k={class:"row"},p={class:"row"},b={key:0,class:"row"},h={class:"row"},g={class:"row"},E={key:1,class:"row justify-center"},L={key:0},A={class:"row justify-center"},S={class:"row items-center"},T={class:"column"},y={class:"row justify-center"},V={key:0,class:"column q-ml-sm col-4"},C={class:"row"},O={class:"row"},F={class:"row"},q={class:"row items-center"},D={class:"column"},I={class:"row"};function Q(e,o){var l=(0,t.g2)("header-btn"),Q=(0,t.g2)("q-select"),X=(0,t.g2)("sie-salones"),w=(0,t.g2)("sie-familia"),M=(0,t.g2)("q-datetime"),R=(0,t.g2)("q-tooltip"),U=(0,t.g2)("q-icon"),x=(0,t.g2)("q-checkbox"),H=(0,t.g2)("q-radio"),j=(0,t.g2)("q-popup-edit"),N=(0,t.g2)("q-scroll-area"),_=(0,t.g2)("q-input"),G=(0,t.g2)("q-page");return(0,t.uX)(),(0,t.Wv)(G,{class:"asistencia-familia sie-flat"},{default:(0,t.k6)(function(){return[(0,t.bF)(l,{name:"Control de Asistencia a Actividades con Padres de Familia",buttons:e.buttons},null,8,["buttons"]),(0,t.Lk)("div",s,[(0,t.Lk)("div",n,[(0,t.Lk)("div",i,[(0,t.bF)(Q,{class:"q-if-outlined",options:e.tiposRegistro,modelValue:e.modoRegistro,"onUpdate:modelValue":o[0]||(o[0]=function(o){return e.modoRegistro=o}),"float-label":"Modo"},null,8,["options","modelValue"])]),(0,t.Lk)("div",u,["G"===e.modoRegistro?((0,t.uX)(),(0,t.Wv)(X,{key:0,class:"q-if-outlined col no-bottom no-border",modelValue:e.nemo,"onUpdate:modelValue":o[1]||(o[1]=function(o){return e.nemo=o}),todos:!1,onSeleccionar:e.selectNemo},null,8,["modelValue","onSeleccionar"])):((0,t.uX)(),(0,t.Wv)(w,{key:1,class:"q-if-outlined col no-bottom no-border",modelValue:e.famcod,"onUpdate:modelValue":o[2]||(o[2]=function(o){return e.famcod=o}),onSelected:e.selectFamilia},null,8,["modelValue","onSelected"])),"G"===e.modoRegistro?((0,t.uX)(),(0,t.CE)("div",r,[(0,t.bF)(M,{class:"col q-if-outlined",type:"date",modelValue:e.registro,"onUpdate:modelValue":o[3]||(o[3]=function(o){return e.registro=o}),format:"DD/MM/YYYY","float-label":"Fecha"},null,8,["modelValue"]),(0,t.bF)(M,{class:"col q-if-outlined",type:"time",modelValue:e.registro,"onUpdate:modelValue":o[4]||(o[4]=function(o){return e.registro=o}),format:"hh:mm A","float-label":"Hora"},null,8,["modelValue"])])):(0,t.Q3)("v-if",!0)]),(0,t.Lk)("div",c,[(0,t.bF)(N,{class:"col q-card",style:{height:"65vh"}},{default:(0,t.k6)(function(){return[(0,t.Lk)("table",d,[(0,t.Lk)("thead",null,[(0,t.Lk)("tr",null,[o[11]||(o[11]=(0,t.Lk)("th",null,null,-1)),o[12]||(o[12]=(0,t.Lk)("th",null,[(0,t.Lk)("span",null,"Alumno")],-1)),(0,t.Lk)("th",null,["I"===e.modoRegistro?((0,t.uX)(),(0,t.CE)("span",m,"Salón")):((0,t.uX)(),(0,t.CE)("span",f,"¿Quien Asiste?"))]),o[13]||(o[13]=(0,t.Lk)("th",null,[(0,t.Lk)("span",null,"Estado")],-1)),o[14]||(o[14]=(0,t.Lk)("th",null,[(0,t.Lk)("span",null,"Obs")],-1))])]),(0,t.Lk)("tbody",null,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.infoHijos,function(l){return(0,t.uX)(),(0,t.CE)("tr",{key:l.ALUCOD,style:(0,a.Tr)({"background-color":e.getColor(l.ESTADO).color,color:e.getColor(l.ESTADO).texto})},[l.ESTADO?((0,t.uX)(),(0,t.Wv)(R,{key:0},{default:(0,t.k6)(function(){return[(0,t.Lk)("div",v,[(0,t.Lk)("div",k,[o[15]||(o[15]=(0,t.Lk)("b",null,"Hora:  ",-1)),(0,t.Lk)("span",null,(0,a.v_)(e.date(l.H_ASISTENCIA,"hh:mm A")),1)]),(0,t.Lk)("div",p,[o[16]||(o[16]=(0,t.Lk)("b",null,"Fecha: ",-1)),(0,t.Lk)("span",null,(0,a.v_)(e.date(l.FH_REGISTRO,"DD/MM/YYYY hh:mm A")),1)]),"G"!==e.modoRegistro?((0,t.uX)(),(0,t.CE)("div",b,[o[17]||(o[17]=(0,t.Lk)("b",null,"¿Quien Asiste?: ",-1)),(0,t.Lk)("span",null,(0,a.v_)(e.parentescos[l.ASISTE].label),1)])):(0,t.Q3)("v-if",!0),(0,t.Lk)("div",h,[o[18]||(o[18]=(0,t.Lk)("b",null,"Estado: ",-1)),(0,t.Lk)("span",null,(0,a.v_)(e.getColor(l.ESTADO).estado),1)]),(0,t.Lk)("div",g,[o[19]||(o[19]=(0,t.Lk)("b",null,"Observación: ",-1)),(0,t.Lk)("span",null,(0,a.v_)(l.TEXTO),1)])])]}),_:2},1024)):(0,t.Q3)("v-if",!0),(0,t.Lk)("td",null,["G"===e.modoRegistro?((0,t.uX)(),(0,t.CE)(t.FK,{key:0},[l.ESTADO!==l.ESTADOANT?((0,t.uX)(),(0,t.Wv)(U,{key:0,name:"info"})):(0,t.Q3)("v-if",!0)],64)):((0,t.uX)(),(0,t.CE)("div",E,[(0,t.bF)(x,{modelValue:e.registrosSeleccionados,"onUpdate:modelValue":o[5]||(o[5]=function(o){return e.registrosSeleccionados=o}),val:l,color:"secondary"},null,8,["modelValue","val"])]))]),(0,t.Lk)("td",null,[(0,t.Lk)("span",null,(0,a.v_)(l.NOMCOMP),1)]),(0,t.Lk)("td",null,["G"!==e.modoRegistro?((0,t.uX)(),(0,t.CE)("span",L,(0,a.v_)(l.NEMODES),1)):((0,t.uX)(),(0,t.Wv)(Q,{key:1,class:"col",options:e.parentescos,modelValue:l.ASISTE,"onUpdate:modelValue":function(e){return l.ASISTE=e}},null,8,["options","modelValue","onUpdate:modelValue"]))]),(0,t.Lk)("td",null,[(0,t.Lk)("div",A,[(0,t.Lk)("span",null,(0,a.v_)(l.ESTADO),1)]),"G"===e.modoRegistro?((0,t.uX)(),(0,t.Wv)(j,{key:0},{default:(0,t.k6)(function(){return[(0,t.Lk)("div",S,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.estados,function(e){return(0,t.uX)(),(0,t.CE)("div",T,[(0,t.bF)(H,{class:"q-mx-xs",modelValue:l.ESTADO,"onUpdate:modelValue":function(e){return l.ESTADO=e},val:e.value},null,8,["modelValue","onUpdate:modelValue","val"]),(0,t.Lk)("div",{class:"q-card row justify-center q-mx-xs items-center",style:(0,a.Tr)({"background-color":e.color,color:e.texto})},[(0,t.Lk)("span",null,(0,a.v_)(e.value),1)],4)])}),256))])]}),_:2},1024)):(0,t.Q3)("v-if",!0)]),(0,t.Lk)("td",null,[(0,t.Lk)("div",y,[l.TEXTO?((0,t.uX)(),(0,t.Wv)(U,{key:0,name:"comment"})):(0,t.Q3)("v-if",!0)])])],4)}),128))])])]}),_:1}),"G"!==e.modoRegistro?((0,t.uX)(),(0,t.CE)("div",V,[(0,t.Lk)("div",C,[(0,t.bF)(M,{class:"col q-if-outlined",type:"date",modelValue:e.registro,"onUpdate:modelValue":o[6]||(o[6]=function(o){return e.registro=o}),format:"DD/MM/YYYY","float-label":"Fecha"},null,8,["modelValue"])]),e.infoHijos.length>0?((0,t.uX)(),(0,t.CE)(t.FK,{key:0},[(0,t.Lk)("div",O,[(0,t.bF)(M,{class:"col q-if-outlined",type:"time",modelValue:e.registro,"onUpdate:modelValue":o[7]||(o[7]=function(o){return e.registro=o}),format:"hh:mm A","float-label":"Hora"},null,8,["modelValue"])]),(0,t.Lk)("div",F,[(0,t.bF)(Q,{class:"col q-if-outlined",options:e.parentescos,modelValue:e.asiste,"onUpdate:modelValue":o[8]||(o[8]=function(o){return e.asiste=o}),"float-label":"¿Quien Asiste?"},null,8,["options","modelValue"])]),(0,t.Lk)("div",q,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.estados,function(l){return(0,t.uX)(),(0,t.CE)("div",D,[(0,t.bF)(H,{class:"q-mx-xs",modelValue:e.estado,"onUpdate:modelValue":o[9]||(o[9]=function(o){return e.estado=o}),val:l.value},null,8,["modelValue","val"]),(0,t.Lk)("div",{class:"q-card row justify-center q-mx-xs items-center",style:(0,a.Tr)({"background-color":l.color,color:l.texto})},[(0,t.Lk)("span",null,(0,a.v_)(l.value),1)],4)])}),256))]),(0,t.Lk)("div",I,[(0,t.bF)(_,{class:"col q-if-outlined","float-label":"Observación",modelValue:e.observacion,"onUpdate:modelValue":o[10]||(o[10]=function(o){return e.observacion=o}),type:"textarea",rows:"5"},null,8,["modelValue"])])],64)):(0,t.Q3)("v-if",!0)])):(0,t.Q3)("v-if",!0)])])])]}),_:1})}l(10239),l(50310),l(90095),l(515),l(83190),l(13715);var X=l(6123),w=l(96122),M=l(80660),R=l(57668),U=l(30545),x=l(88275),H=l(96529),j=l(18105),N=l(13813),_=l(982),G={components:{QPageSticky:X._U,QSelect:X.Si,QDatetime:X.T5,QTable:U.A,QTr:X.qh,QTh:X.EJ,QTd:X.Ef,QCheckbox:X.vZ,QCollapsible:X.eS,QFab:X.l6,QFabAction:X.B$,QToolbar:X.ZV,QRadio:X.$,QScrollArea:w.A,sieSalones:x.Ay,sieFamilia:H.A,QPopupEdit:X.GT,QPage:X.Tu,QTooltip:X.nC,QIcon:X.bP,QInput:X.ie},data:function(){return{sie:(0,R["default"])(),acceso:(0,R["default"])().ruta.nivel>=2,parentescos:[{label:"Ambos",value:0},{label:"Padre",value:1},{label:"Madre",value:2}],estados:[{label:"Presente",value:"P"},{label:"Tardanza",value:"T",color:"#EBE76B",texto:"#333"},{label:"Falta",value:"F",color:"#CC0C15",texto:"#FFF"}],tiposRegistro:[{label:"Individual",value:"I"},{label:"Grupal",value:"G"}],asiste:2,modoRegistro:"I",estado:"P",registro:new Date,famcod:null,nemo:null,infoHijos:[],registrosSeleccionados:[],observacion:null,buttons:[]}},methods:{date:j.Ay,getColor:function(e){var o,l,t;return"I"===this.modoRegistro&&this.estados.forEach(function(a){a.value===e&&(o=a.color,t=a.label,l=a.texto)}),{color:o,texto:l,estado:t}},cargaInfo:function(e){var o=this;this.infoHijos=[],M.$http.get("api/HyoHorasisf/getInfoAsistencia",{params:e}).then(function(e){var l=e.json;o.infoHijos=l})},selectFamilia:function(e){var o=e.FAMCOD;this.registrosSeleccionados=[],this.observacion=null,this.cargaInfo({FAMCOD:o,FECHA:this.registro})},selectNemo:function(e){var o=e.NEMO;this.cargaInfo({NEMO:o,FECHA:this.registro})},saveInfo:function(e){var o=this;M.$http.post("api/HyoHorasisf/saveRegistro",e).then(function(e){var l=e.json;(0,_["default"])(o.$t("mensajes."+l.msg),l.type),"success"===l.type&&("G"===o.modoRegistro?o.selectNemo({NEMO:o.nemo}):o.selectFamilia({FAMCOD:o.famcod}))})},saveIndividual:function(){var e=this,o={registro:this.registro};o.alumno=(0,N["default"])(this.infoHijos,function(o){var l=o.ALUCOD,t=o.NEMO,a=o.ID;return{ALUCOD:l,NEMO:t,ASISTE:e.asiste,ESTADO:e.estado,TEXTO:e.observacion,ID:a}}),this.saveInfo(o)},saveGrupal:function(){var e={registro:this.registro,alumno:[]};this.infoHijos.forEach(function(o){var l=o.ASISTE,t=o.ASISTEANT,a=o.ESTADO,s=o.ESTADOANT,n=o.ALUCOD,i=o.NEMO,u=o.ID,r={};(!u&&a!==s||l!==t)&&(r.ASISTE=l),a!==s&&(r.ESTADO=a),Object.keys(r).length>0&&(r.ALUCOD=n,r.NEMO=i,r.ID=u,e.alumno.push(r))}),this.saveInfo(e)},validarLogin:function(e,o,l){this.usuario=o,this.profcod=e,this.profnom=l,this.componenteSelect=1}},watch:{modoRegistro:function(e){this.infoHijos=[],"G"===e?this.nemo&&this.selectNemo({NEMO:this.nemo}):this.famcod&&this.selectFamilia({FAMCOD:this.famcod})}},created:function(){var e=this;this.acceso&&this.buttons.push({icon:"save",label:"Grabar",click:function(){"I"===e.modoRegistro?e.saveIndividual():e.saveGrupal()}})}},Y=l(12807);const P=(0,Y.A)(G,[["render",Q]]);var W=P}}]);