"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[25264],{25264:function(e,o,n){n.r(o),n.d(o,{default:function(){return H}});n(71225),n(50310),n(5962),n(83190);var a=n(61758),i=n(58790),t={class:"row items-center no-wrap"},r={class:"col"},l={class:"text-h6"},c={class:"row gutter-xs q-mb-sm"},s={class:"col-xs-12 col-md-2"},u={class:"col-xs-12 col-md-2"},d={class:"col-xs-12 col-md-2"},m={key:0,class:"col-xs-12 col-md-2"},f={key:0,class:"col-12"},p={class:"col-12"},h={key:1,class:"col-12"};function b(e,o){var n=(0,a.g2)("crearBotones"),b=(0,a.g2)("q-card-section"),D=(0,a.g2)("q-separator"),v=(0,a.g2)("q-input"),L=(0,a.g2)("q-date"),g=(0,a.g2)("q-popup-proxy"),w=(0,a.g2)("q-icon"),Y=(0,a.g2)("q-select"),k=(0,a.g2)("sie-grid"),A=(0,a.g2)("footer-grid"),x=(0,a.g2)("q-form"),C=(0,a.g2)("sie-modal"),M=(0,a.g2)("sie-vacio"),F=(0,a.g2)("q-card");return(0,a.uX)(),(0,a.Wv)(F,{class:(0,i.C4)(["layout-v1",{"my-card":!0,col:!e.permisoOpcion}]),flat:"",bordered:""},{default:(0,a.k6)(function(){return[e.permisoOpcion?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[(0,a.bF)(b,null,{default:(0,a.k6)(function(){return[(0,a.Lk)("div",t,[(0,a.Lk)("div",r,[(0,a.Lk)("div",l,(0,i.v_)(e.title),1)]),(0,a.bF)(n,{buttons:e.botones,nivelAcceso:e.nivelAcceso,option:e.nameComponente},null,8,["buttons","nivelAcceso","option"])])]}),_:1}),(0,a.bF)(D),(0,a.bF)(b,null,{default:(0,a.k6)(function(){return[(0,a.Lk)("div",c,[(0,a.Lk)("div",{class:(0,i.C4)(["col-xs-12",{"col-md-4":e.esDBox,"col-md-6":!e.esDBox}])},[(0,a.bF)(v,{label:"Buscar Nombre",modelValue:e.nombre,"onUpdate:modelValue":o[0]||(o[0]=function(o){return e.nombre=o}),onInput:e.filter,debounce:"500"},null,8,["modelValue","onInput"])],2),(0,a.Lk)("div",s,[(0,a.bF)(v,{label:"Desde",debounce:"500",maxlength:"10",format:"##/##/####",modelValue:e.from,"onUpdate:modelValue":o[3]||(o[3]=function(o){return e.from=o}),mask:"##/##/####",readonly:""},{prepend:(0,a.k6)(function(){return[(0,a.bF)(w,{class:"cursor-pointer",name:"date_range"},{default:(0,a.k6)(function(){return[(0,a.bF)(g,{ref:"qDateProxy1","transition-show":"scale","transition-hide":"scale"},{default:(0,a.k6)(function(){return[(0,a.bF)(L,{mask:"DD/MM/YYYY",modelValue:e.from,"onUpdate:modelValue":o[1]||(o[1]=function(o){return e.from=o}),onInput:o[2]||(o[2]=function(o){return e.closeModalCalendar("qDateProxy1")})},null,8,["modelValue"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])]),(0,a.Lk)("div",u,[(0,a.bF)(v,{label:"Hasta",debounce:"500",maxlength:"10",format:"##/##/####",modelValue:e.to,"onUpdate:modelValue":o[6]||(o[6]=function(o){return e.to=o}),mask:"##/##/####",readonly:""},{prepend:(0,a.k6)(function(){return[(0,a.bF)(w,{class:"cursor-pointer",name:"date_range"},{default:(0,a.k6)(function(){return[(0,a.bF)(g,{ref:"qDateProxy2","transition-show":"scale","transition-hide":"scale"},{default:(0,a.k6)(function(){return[(0,a.bF)(L,{mask:"DD/MM/YYYY",modelValue:e.to,"onUpdate:modelValue":o[4]||(o[4]=function(o){return e.to=o}),onInput:o[5]||(o[5]=function(o){return e.closeModalCalendar("qDateProxy2")})},null,8,["modelValue"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])]),(0,a.Lk)("div",d,[(0,a.bF)(Y,{modelValue:e.con_licencia,"onUpdate:modelValue":o[7]||(o[7]=function(o){return e.con_licencia=o}),options:e.estadoLicencia,label:"Licenciado",onInput:e.filter},null,8,["modelValue","options","onInput"])]),e.esDBox?((0,a.uX)(),(0,a.CE)("div",m,[(0,a.bF)(Y,{modelValue:e.colegio,"onUpdate:modelValue":o[8]||(o[8]=function(o){return e.colegio=o}),options:e.newLicencia.colegios,label:"Colegio",onInput:e.filter},null,8,["modelValue","options","onInput"])])):(0,a.Q3)("v-if",!0)]),(0,a.Lk)("div",null,[(0,a.bF)(k,{class:"component-consultar-comprobante-fix-tab-height ag-theme-balham",style:(0,i.Tr)({height:"calc(100vh - ".concat(e.lessHeight,"px)")}),columnDefs:e.columnDefs,rowData:e.rowData,onGridReady:e.onGridReady,frameworkComponents:e.frameworkComponents},null,8,["style","columnDefs","rowData","onGridReady","frameworkComponents"]),(0,a.bF)(A,{modelValue:e.page,"onUpdate:modelValue":o[9]||(o[9]=function(o){return e.page=o}),max:e.max,onLoad:e.filter,rows:e.rowData},null,8,["modelValue","max","onLoad","rows"])])]}),_:1}),(0,a.bF)(C,{modelValue:e.newLicencia.modal,"onUpdate:modelValue":o[13]||(o[13]=function(o){return e.newLicencia.modal=o}),title:"Agregar licencia",onSubmit:e.saveLicencia,ok:"Grabar"},{default:(0,a.k6)(function(){return[(0,a.bF)(x,{class:"row q-pa-sm q-col-gutter-sm",ref:"form"},{default:(0,a.k6)(function(){return[e.esDBox?(0,a.Q3)("v-if",!0):((0,a.uX)(),(0,a.CE)("div",f,[(0,a.bF)(Y,{modelValue:e.newLicencia.form.usucod,"onUpdate:modelValue":o[10]||(o[10]=function(o){return e.newLicencia.form.usucod=o}),options:e.newLicencia.usuarios,label:"Usuario",onInput:e.seleccionarUsuario},null,8,["modelValue","options","onInput"])])),(0,a.Lk)("div",p,[(0,a.bF)(v,{modelValue:e.newLicencia.form.usu_krismar,"onUpdate:modelValue":o[11]||(o[11]=function(o){return e.newLicencia.form.usu_krismar=o}),label:"Licencia",disable:!e.esDBox},null,8,["modelValue","disable"])]),e.esDBox?(0,a.Q3)("v-if",!0):((0,a.uX)(),(0,a.CE)("div",h,[(0,a.bF)(v,{modelValue:e.newLicencia.form.nrodoc,"onUpdate:modelValue":o[12]||(o[12]=function(o){return e.newLicencia.form.nrodoc=o}),label:"Nro. Documento",rules:[function(e){return!!e||"Ingrese el Nro. Documento"}]},null,8,["modelValue","rules"])]))]}),_:1},512)]}),_:1},8,["modelValue","onSubmit"])],64)):((0,a.uX)(),(0,a.Wv)(M,{key:1,title:"Esta opción esta reservada solo para usuarios especiales.",icon:"block"}))]}),_:1},8,["class"])}var D=n(76080),v=n.n(D),L=n(45254),g=n.n(L),w=(n(10239),n(6123)),Y=n(88567),k=n(95718),A=n(53380),x=n(3112),C=n(12143),M=n(95477),F=n(2739),V=n(36408),_=n(27560),y=n(78840),S=n(30640),O=n(80340),E=n(57668),I=n(54267),U=n(41615),R=n(78786),B=n(2819),N=n(18105),T=n(64208),q=n(54489),Q=n(64303),P=n(80660),G={components:{QCard:Y.A,QCardSection:k.A,QSeparator:A.A,QSelect:q.S,QInput:T.A,QCheckbox:x.A,QDate:C.A,QPopupProxy:M.A,QForm:F.A,CrearBotones:Q.A,SieGrid:V.A,FooterGrid:_.A,SieModal:S.A,SieVacio:O.A,QIcon:w.bP},data:function(){return{nameComponente:"licenciasRed",esDBox:U["default"].ES_DBOX,title:"Licencias de Recursos Educativos Digitales",nivelAcceso:(0,E["default"])().ruta.nivel,botones:[],lessHeight:275,nombre:"",from:(0,N.Ay)(new Date,"DD/MM/YYYY"),to:(0,N.Ay)(new Date,"DD/MM/YYYY"),colegio:U["default"].TODOS,con_licencia:1,estadoLicencia:[{label:"Todos",value:0},{label:"Con Licencia",value:1},{label:"Sin Licencia",value:2}],columnDefs:null,rowData:null,api:null,frameworkComponents:null,page:1,max:1,newLicencia:{modal:!1,colegios:[{label:"Todos",value:U["default"].TODOS},{label:"Lisson",value:"0001"},{label:"America de San Miguel",value:"0103"},{label:"Santa Ana",value:"0117"},{label:"Reina de las Americas AIEC",value:"0160"},{label:"Nuestra Señora de la Paz",value:"0182"},{label:"Salesiano Cusco",value:"0336"},{label:"Sagrado Corazon Michel",value:"0357"}],usuarios:[],personas:[],form:{usu_krismar:null,usucod:null,nrodoc:null,tipcod:null}},permisoOpcion:-1!==(0,R["default"])(["SIE","SIEWEB","DBOX"],(0,E["default"])().usucod)}},methods:{crearBotones:function(){var e=[{label:"Exportar",icon:"file_excel",click:this.exportar,minAcceso:U["default"].SOLO_LECTURA},{label:"Exportar Data Completa",icon:"file_excel",click:this.exportarFullData,minAcceso:U["default"].SOLO_LECTURA}];this.esDBox||(e.unshift({label:"Reporte Sin Licencia",icon:"file_excel",click:this.exportarSinLicencia,minAcceso:U["default"].SOLO_LECTURA}),e.unshift({label:"Agregar Licencia",icon:"plus",click:this.abrirCrearLicencia,minAcceso:U["default"].SOLO_LECTURA})),this.botones=e},exportar:function(){var e={formato:"xls",repcod:"listarLicencias"};e["parametros"]={nombre:this.nombre,fecini:(0,N.Ay)((0,I.convertToYMD)(this.from),"YYYY-MM-DD"),fecfin:(0,N.Ay)((0,I.convertToYMD)(this.to),"YYYY-MM-DD"),colcod:this.colegio,con_licencia:this.con_licencia},(0,B.exportFilePhp)(e,"intranet/reporte-node/reporte","listarLicencias")},exportarFullData:function(){var e={formato:"xls",repcod:"listarLicenciasFullData"};e["parametros"]={nombre:this.nombre,fecini:(0,N.Ay)((0,I.convertToYMD)(this.from),"YYYY-MM-DD"),fecfin:(0,N.Ay)((0,I.convertToYMD)(this.to),"YYYY-MM-DD"),colcod:this.colegio,con_licencia:this.con_licencia},(0,B.exportFilePhp)(e,"intranet/reporte-node/reporte","listarLicenciasFullData")},exportarSinLicencia:function(){var e={formato:"xls",repcod:"sinLicencias"};e["parametros"]={nombre:this.nombre,fecini:(0,N.Ay)((0,I.convertToYMD)(this.from),"YYYY-MM-DD"),fecfin:(0,N.Ay)((0,I.convertToYMD)(this.to),"YYYY-MM-DD")},(0,B.exportFilePhp)(e,"intranet/reporte-node/reporte","sinLicencias")},abrirCrearLicencia:function(){var e=this;return g()(v()().m(function o(){return v()().w(function(o){while(1)switch(o.n){case 0:return e.newLicencia.modal=!0,o.n=1,P.$http.get("api/UsuarioController/getComboUsuarios",{params:{info:{siscod:"21"}}});case 1:e.newLicencia.usuarios=o.v;case 2:return o.a(2)}},o)}))()},seleccionarUsuario:function(e){var o=(0,R["default"])(this.newLicencia.usuarios,e,{key:"value"}),n=this.newLicencia.usuarios[o],a=n.licencia,i=n.nrodoc,t=n.tipcod;this.newLicencia.form.usu_krismar=a,this.newLicencia.form.nrodoc=i,this.newLicencia.form.tipcod=t},saveLicencia:function(){var e=this;return g()(v()().m(function o(){var n,a,i,t;return v()().w(function(o){while(1)switch(o.p=o.n){case 0:return o.n=1,e.$refs.form.validate();case 1:if(n=o.v,!n){o.n=5;break}return a=e.newLicencia.form,o.p=2,o.n=3,P.$http.post("api/krismar/saveLicencia",a);case 3:o.n=5;break;case 4:o.p=4,t=o.v,i=t.error,e.$notify(i.message,"warning");case 5:return o.a(2)}},o,null,[[2,4]])}))()},onGridReady:function(e){this.api=e.api},cargarColumnas:function(){var e=this;this.columnDefs.push({headerName:"Nro. Documento",field:"NRODOC",width:120}),this.columnDefs.push({headerName:"Apellidos y Nombres",field:"NOMBRE",width:280}),this.columnDefs.push({headerName:"Licencia",field:"LICENCIA",width:140}),this.columnDefs.push({headerName:"Fecha de Registro",field:"FH_REGISTRO",valueFormatter:function(e){return(0,N.Ay)(e.value,"DD/MM/YYYY")},width:140}),this.columnDefs.push({headerName:"Estado",field:"ESTADO",valueFormatter:function(e){return e.value?"Activo":"Inactivo"},width:120}),this.columnDefs.push({headerName:"Compra Online",field:"COMPRA_ONLINE",valueFormatter:function(e){return e.value?"Si":"No"},width:120}),this.esDBox&&this.columnDefs.push({headerName:"Colegio",field:"COLCOD",valueFormatter:function(o){var n=(0,R["default"])(e.newLicencia.colegios,o.value,{key:"value"});return-1!==n?e.newLicencia.colegios[n].label:""},width:250})},filter:function(){this.getLicencias()},closeModalCalendar:function(e){this.$refs[e].hide(),this.filter()},getLicencias:function(){var e=this,o=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n={pagina:this.page,nombre:this.nombre,fecini:(0,N.Ay)((0,I.convertToYMD)(this.from),"YYYY-MM-DD"),fecfin:(0,N.Ay)((0,I.convertToYMD)(this.to),"YYYY-MM-DD"),colcod:this.colegio,con_licencia:this.con_licencia},a=P.$http.get("api/LicenciasRedController/getLicenciasRed",{params:{parametros:n}});if(o)return a;a.then(function(o){e.max=o.pages,e.rowData=o.rows})}},beforeMount:function(){var e=this;return g()(v()().m(function o(){return v()().w(function(o){while(1)switch(o.n){case 0:e.crearBotones(),e.columnDefs=[],e.rowData=[],e.cargarColumnas(),e.frameworkComponents={agActionButton:y.A},e.getLicencias();case 1:return o.a(2)}},o)}))()}},X=n(12807);const $=(0,X.A)(G,[["render",b]]);var H=$}}]);