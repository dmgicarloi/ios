"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[1573],{23954:function(e,n,t){t.r(n),t.d(n,{default:function(){return O}});var a=t(61758),o={class:"row q-col-gutter-md"},r={class:"col-xs-12"};function i(e,n){var t=(0,a.g2)("header-btn"),i=(0,a.g2)("formulario"),l=(0,a.g2)("q-card-section"),s=(0,a.g2)("q-card"),d=(0,a.g2)("sie-modal"),c=(0,a.g2)("listar-sedes"),u=(0,a.g2)("detalle-periodo-admision"),m=(0,a.g2)("sie-table"),f=(0,a.g2)("q-page");return(0,a.uX)(),(0,a.Wv)(f,{class:"q-pa-sm sie-flat"},{default:(0,a.k6)(function(){return[(0,a.bF)(s,{flat:"",bordered:""},{default:(0,a.k6)(function(){return[(0,a.bF)(t,{name:e.tituloForm,auto:!0,buttons:e.botonesForm},null,8,["name","buttons"]),(0,a.bF)(l,null,{default:(0,a.k6)(function(){return[(0,a.Lk)("div",o,[(0,a.Lk)("div",r,[(0,a.bF)(i,{schema:e.schemas.viewAdmPeriodo,ref:"formApp",key:"formApp",onClickIconGrid:e.clickIconGrid,onChangeInput:e.changeInput},null,8,["schema","onClickIconGrid","onChangeInput"])])])]}),_:1})]}),_:1}),(0,a.bF)(d,{title:e.configModalSel.titulo,modelValue:e.openModal,"onUpdate:modelValue":n[0]||(n[0]=function(n){return e.openModal=n}),ok:"GRABAR",onSubmit:e.submit},{default:(0,a.k6)(function(){return[(0,a.bF)(l,{class:"cont-modal-md"},{default:(0,a.k6)(function(){return[(0,a.bF)(i,{schema:e.schemaModal,ref:"formModal",key:"formModal",modal:!0},null,8,["schema"])]}),_:1})]}),_:1},8,["title","modelValue","onSubmit"]),(0,a.bF)(d,{title:e.modalSedes.titulo,modelValue:e.modalSedes.open,"onUpdate:modelValue":n[1]||(n[1]=function(n){return e.modalSedes.open=n}),onSubmit:e.filtrarSedes},{default:(0,a.k6)(function(){return[(0,a.bF)(l,{class:"full-width"},{default:(0,a.k6)(function(){return[(0,a.bF)(c,{ref:"listaSedes",selected:e.modalSedes.selected,seleccion:"single",opcionTodas:!0},null,8,["selected"])]}),_:1})]}),_:1},8,["title","modelValue","onSubmit"]),(0,a.bF)(d,{title:e.modalDetalle.titulo,modelValue:e.modalDetalle.open,"onUpdate:modelValue":n[2]||(n[2]=function(n){return e.modalDetalle.open=n}),footer:!1},{default:(0,a.k6)(function(){return[(0,a.bF)(l,{class:"full-width"},{default:(0,a.k6)(function(){return[(0,a.bF)(u,{ref:"detalle",selected:e.modalDetalle.selected,manejaSedes:e.sie.manejaSedes,empcod:e.sedeSel,manejaNee:e.sie.manejaNee,grado:e.modalDetalle.grado},null,8,["selected","manejaSedes","empcod","manejaNee","grado"])]}),_:1})]}),_:1},8,["title","modelValue"]),(0,a.bF)(d,{title:e.modalPerSedes.titulo,modelValue:e.modalPerSedes.open,"onUpdate:modelValue":n[3]||(n[3]=function(n){return e.modalPerSedes.open=n}),ok:"GRABAR",onSubmit:e.updatePeriodosSedes},{default:(0,a.k6)(function(){return[(0,a.bF)(l,{class:"full-width"},{default:(0,a.k6)(function(){return[(0,a.bF)(m,{selection:"single","show-search":!1,columns:e.configSedes.fields,data:e.configSedes.rows,config:e.configSedes.config},null,8,["columns","data","config"])]}),_:1})]}),_:1},8,["title","modelValue","onSubmit"])]}),_:1})}var l=t(76080),s=t.n(l),d=t(45254),c=t.n(d),u=(t(30683),t(52133),t(50310),t(6724),t(83190),t(6123)),m=t(80660),f=t(10213),p=t(65848),g=t(40714),S={data:function(){var e={config:{LIMITE:{component:"input",type:"number",autoSelect:!0,autoFocus:!0,renderHtml:function(e,n){return n("span",{},e.LIMITE)}}},rows:[],fields:[{name:"EMPDES",label:"Sede",field:"EMPDES",align:"left",sortable:!0},{name:"LIMITE",label:"Ofertas",field:"LIMITE",align:"center",wrap:!0,sortable:!0},{name:"INSCRITOS",label:"Inscritos",field:"INSCRITOS",align:"center",wrap:!0,sortable:!0},{name:"DISPONIBLES",label:"Disponibles",field:"DISPONIBLES",align:"center",wrap:!0,sortable:!0}]};return{configSedes:e}}},h=t(7968),w={class:"row"},v={class:"col-12"},b={class:"row"},A={class:"col-12"};function P(e,n){var t=(0,a.g2)("q-select"),o=(0,a.g2)("sie-table");return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.Lk)("div",w,[(0,a.Lk)("div",v,[(0,a.bF)(t,{class:"q-if-outlined",modelValue:e.tipoDetalle,"onUpdate:modelValue":n[0]||(n[0]=function(n){return e.tipoDetalle=n}),options:e.opciones,"float-label":"Opción",onInput:n[1]||(n[1]=function(n){return e.loadGrid()})},null,8,["modelValue","options"])])]),(0,a.Lk)("div",b,[(0,a.Lk)("div",A,[(0,a.bF)(o,{ref:"grid",selection:"single","show-search":!1,columns:e.config.fields,data:e.config.rows,config:e.config.config},null,8,["columns","data","config"])])])])}t(10239),t(48426);var D={data:function(){},methods:{gridDetalle:function(e){return c()(s()().m(function n(){var t,a;return s()().w(function(n){while(1)switch(n.n){case 0:return t={},a=[{name:"NOMCOMP",label:"Nombre",field:"NOMCOMP",align:"left",sortable:!0}],e.manejaSedes&&a.unshift({name:"EMPDES",label:"Sede",field:"EMPDES",align:"left",sortable:!0}),n.a(2,{config:t,rows:[],fields:a})}},n)}))()}}},I={mixins:[p.A,D],props:{manejaSedes:{type:Boolean,default:!1},empcod:{type:String,default:""},manejaNee:{type:Boolean,default:!1},grado:{type:Object,default:function(){return{}}}},data:function(){var e=this.init();return e.tipoDetalle="inscritos",e.opciones=[],e.config={},e},methods:{loadGrid:function(){var e=this;return c()(s()().m(function n(){var t,a,o,r,i;return s()().w(function(n){while(1)switch(n.n){case 0:t={idPeriodo:e.grado.idPeriodo,postulantesActivos:!0,excluirDesistio:!0,manejaSedes:e.manejaSedes,empcod:e.empcod},a=[],o=e.tipoDetalle,n.n="inscritos"===o?1:"pagantesReg"===o||"pagantesNee"===o?3:5;break;case 1:return t.campos=["F.NOMCOMP"],t.order=[{sidx:"F.NOMCOMP",sord:"ASC"}],n.n=2,e.getApiAction("api/postulacionController/getFamiliaAdmision",t);case 2:return a=n.v,n.a(3,5);case 3:return t.anoadm=e.grado.anoadm,t.nivel=e.grado.nivel,t.grado=e.grado.grado,t.poseeNee="pagantesReg"===e.tipoDetalle?"N":"S",t.order=[{sidx:"NOMCOMP",sord:"ASC"}],n.n=4,e.getApiAction("api/postulacionController/getPagantes",t);case 4:return a=n.v,n.a(3,5);case 5:return r=Object,i={},n.n=6,e.gridDetalle(t);case 6:e.config=r.assign.call(r,i,n.v),e.config.rows=a;case 7:return n.a(2)}},n)}))()}},created:function(){var e=this;return c()(s()().m(function n(){var t;return s()().w(function(n){while(1)switch(n.n){case 0:t=[{value:"inscritos",label:"Listado de inscritos"}],e.manejaNee&&(t.push({value:"pagantesReg",label:"Listado de pagantes Regular"}),t.push({value:"pagantesNee",label:"Listado de pagantes Condición"})),e.opciones=e.sieSelectOptions(t,"value","label"),e.loadGrid();case 1:return n.a(2)}},n)}))()},components:{QSelect:u.Si}},E=t(12807);const N=(0,E.A)(I,[["render",P]]);var _=N,k={mixins:[p.A,g.A,S],components:{listarSedes:h.A,detallePeriodoAdmision:_,QPage:u.Tu,QCard:u.C$},data:function(){var e=this.init();return e.sie.manejaSedes=!1,e.sie.manejaNee=!1,e.modalSedes={open:!1,titulo:"Seleccionar Sedes",selected:[]},e.modalPerSedes={open:!1,titulo:"",id_periodo:0},e.modalDetalle={open:!1,titulo:"Detalle de Inscripción",grado:{}},e.sedeSel="",e},methods:{updateGrid:function(){var e=this;return c()(s()().m(function n(){var t,a,o,r,i;return s()().w(function(n){while(1)switch(n.n){case 0:return n.n=1,e.getInputValue("formApp","INPUT_1");case 1:return t=n.v,n.n=2,e.getInputValue("formApp","INPUT_2");case 2:return a=n.v,n.n=3,e.getInputValue("formApp","INPUT_3");case 3:o=n.v,r={anoadm:t},2===a.length&&("%"!==a[0]&&(r.nivel=a[0]),"%"!==a[1]&&(r.grado=a[1])),o>0&&(r.idModalidad=o),i=e.modalSedes.selected.length>0?e.modalSedes.selected.map(function(e){return e.EMPCOD}):[],i.length>0&&(r.sedeSel=e.sedeSel=i[0]),e.sie.ano=t,e.reloadGrid("formApp","GRID_1",r);case 4:return n.a(2)}},n)}))()},filtrarDatos:function(e,n,t){var a=this;return c()(s()().m(function e(){return s()().w(function(e){while(1)switch(e.n){case 0:a.$nextTick(c()(s()().m(function e(){return s()().w(function(e){while(1)switch(e.n){case 0:return e.n=1,a.updateGrid();case 1:return e.a(2)}},e)})));case 1:return e.a(2)}},e)}))()},preSubmit:function(e){return this.sie.manejaSedes&&delete e.LIMITE,{res:!0,data:e}},postSubmit:function(e){var n=this;return c()(s()().m(function e(){return s()().w(function(e){while(1)switch(e.n){case 0:return e.n=1,n.updateGrid();case 1:return e.a(2)}},e)}))()},postDelete:function(e){var n=this;return c()(s()().m(function e(){return s()().w(function(e){while(1)switch(e.n){case 0:return e.n=1,n.updateGrid();case 1:return e.a(2)}},e)}))()},verPeriodosSedes:function(e){var n=this;return c()(s()().m(function t(){var a,o;return s()().w(function(t){while(1)switch(t.n){case 0:return n.modalPerSedes.id_periodo=e.ID_PERIODO,n.modalPerSedes.titulo="Configurar inscripciones por Sedes: "+e.ANIO_NIVEL_GRADO_MODALIDAD,n.configSedes.rows=[],a={id_periodo:n.modalPerSedes.id_periodo},n.sedeSel.length>0&&(a.sedes=[n.sedeSel]),t.n=1,n.getApiAction("api/postulacionController/getPeriodosSedes",a);case 1:o=t.v,n.configSedes.rows=o,n.modalPerSedes.open=!0;case 2:return t.a(2)}},t)}))()},verDetalle:function(e){var n=this;return c()(s()().m(function t(){return s()().w(function(t){while(1)switch(t.n){case 0:n.modalDetalle.grado={anoadm:e.ANIO,nivel:e.INSTRUCOD,grado:e.GRADOCOD,idPeriodo:e.ID_PERIODO},n.modalDetalle.open=!0;case 1:return t.a(2)}},t)}))()},updatePeriodosSedes:function(){var e=this;return c()(s()().m(function n(){return s()().w(function(n){while(1)switch(n.n){case 0:(0,f.confirm)("¿Está seguro de actualizar los registros?","update").onOk(function(){var n={id_periodo:e.modalPerSedes.id_periodo,rows:e.configSedes.rows};m.$http.post("api/postulacionController/updatePeriodosSedes",{data:n}).then(function(){var n=c()(s()().m(function n(t){var a;return s()().w(function(n){while(1)switch(n.n){case 0:return a=1===t.code?"success":"warning",e.$notify(t.message,a),e.modalPerSedes.open=!1,n.n=1,e.updateGrid();case 1:return n.a(2)}},n)}));return function(e){return n.apply(this,arguments)}}()).catch(function(n){e.$notify(n.error.message,"warning")})});case 1:return n.a(2)}},n)}))()}},created:function(){var e=this;return c()(s()().m(function n(){var t,a;return s()().w(function(n){while(1)switch(n.n){case 0:return n.n=1,e.getConstantesAdmision(["AD_MANEJA_SEDES","AD_MANEJA_NEE"]);case 1:return t=n.v,e.sie.manejaSedes=t.AD_MANEJA_SEDES,e.sie.manejaNee=t.AD_MANEJA_NEE,a=[{id:"viewAdmPeriodo",ref:"formApp"}],n.n=2,e.loadSchemas(a);case 2:e.$nextTick(c()(s()().m(function n(){var t;return s()().w(function(n){while(1)switch(n.n){case 0:return n.n=1,e.addBotonGrid({schema:"viewAdmPeriodo",index:3,icon:"search",eventos:"verDetalle",permiso:1});case 1:if(!e.sie.manejaSedes){n.n=2;break}return t={label:"Sedes",icon:"add_location",click:e.verSedes,params:{view:"viewAdmPeriodo"}},e.botonesForm=e.botonesForm.concat(t),n.n=2,e.addBotonGrid({schema:"viewAdmPeriodo",index:3,icon:"add_location",eventos:"verPeriodosSedes",permiso:3});case 2:if(!e.sie.manejaNee){n.n=4;break}return n.n=3,e.addcolGrid({schema:"viewAdmPeriodo",index:3,name:"PAGANTES",label:"Pagantes",align:"left",posi:-3});case 3:return n.n=4,e.addcolGrid({schema:"viewAdmPeriodo",index:3,name:"PAGANTES_NEE",label:"Pagantes NEE",align:"left",posi:-3});case 4:return n.a(2)}},n)})));case 3:return n.a(2)}},n)}))()}};const M=(0,E.A)(k,[["render",i]]);var O=M}}]);