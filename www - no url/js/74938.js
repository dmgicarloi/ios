"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[74938],{74938:function(t,e,n){n.r(e),n.d(e,{default:function(){return Vt}});var a=n(61758),i=n(58790),r={class:"col column q-px-sm q-pt-sm"},o={class:"row col column q-gutter-sm"},u={class:"row"},l={class:"col-12"},s={class:"row q-col-gutter-sm"},c={class:"col-3"},d={class:"col-3"},f={class:"col-3"},p={class:"col-3"},m={class:"row col column"},h={class:"col-12 column"},v={class:"row col q-col-gutter-sm"},g={class:"col-3 column"},b={class:"row justify-end"},w={class:"row col column"},C={key:1,class:"col _listado-ruletas"},k={class:"col-9 column"},R={class:"q-pa-sm"},A={class:"row q-col-gutter-sm"},_={class:"col"};function P(t,e){var n=(0,a.g2)("q-select"),P=(0,a.g2)("q-card-section"),F=(0,a.g2)("q-card"),S=(0,a.g2)("q-btn"),I=(0,a.g2)("q-item-label"),y=(0,a.g2)("q-item-section"),q=(0,a.g2)("q-item"),O=(0,a.g2)("q-list"),T=(0,a.g2)("q-scroll-area"),L=(0,a.g2)("sie-vacio"),V=(0,a.g2)("ruleta"),E=(0,a.g2)("q-input"),D=(0,a.g2)("q-form"),N=(0,a.g2)("sie-modal"),U=(0,a.g2)("q-page");return(0,a.uX)(),(0,a.Wv)(U,{class:"q-page-ruleta"},{default:(0,a.k6)(function(){return[(0,a.Lk)("div",r,[(0,a.Lk)("div",o,[(0,a.Lk)("div",u,[(0,a.Lk)("div",l,[(0,a.bF)(F,{dense:"",bordered:"",flat:""},{default:(0,a.k6)(function(){return[(0,a.bF)(P,null,{default:(0,a.k6)(function(){return[(0,a.Lk)("div",s,[(0,a.Lk)("div",c,[(0,a.bF)(n,{modelValue:t.idAmbito,"onUpdate:modelValue":e[0]||(e[0]=function(e){return t.idAmbito=e}),label:"Aula",options:t.ambitos,onInput:t.getCursos},null,8,["modelValue","options","onInput"])]),(0,a.Lk)("div",d,[(0,a.bF)(n,{modelValue:t.idCurso,"onUpdate:modelValue":e[1]||(e[1]=function(e){return t.idCurso=e}),label:"Curso",options:t.cursos,onInput:t.getGrupos},null,8,["modelValue","options","onInput"])]),(0,a.Lk)("div",f,[(0,a.bF)(n,{modelValue:t.grupocod,"onUpdate:modelValue":e[2]||(e[2]=function(e){return t.grupocod=e}),label:"Grupo",options:t.grupos,onInput:t.getPeriodos},null,8,["modelValue","options","onInput"])]),(0,a.Lk)("div",p,[(0,a.bF)(n,{modelValue:t.idClasePeriodo,"onUpdate:modelValue":e[3]||(e[3]=function(e){return t.idClasePeriodo=e}),label:"Periodo",options:t.periodos,onInput:t.getRuletas},null,8,["modelValue","options","onInput"])])])]}),_:1})]}),_:1})])]),(0,a.Lk)("div",m,[(0,a.Lk)("div",h,[(0,a.Lk)("div",v,[(0,a.Lk)("div",g,[(0,a.bF)(F,{class:"col column",dense:"",bordered:"",flat:""},{default:(0,a.k6)(function(){return[(0,a.bF)(P,{class:"col column q-gutter-sm"},{default:(0,a.k6)(function(){return[(0,a.Lk)("div",b,[(0,a.bF)(S,{label:"Nueva ruleta",size:"sm",color:"primary",onClick:t.crearRuleta},null,8,["onClick"])]),(0,a.Lk)("div",w,[t.listadoRuletas.length?((0,a.uX)(),(0,a.Wv)(T,{key:0,class:"col _listado-ruletas"},{default:(0,a.k6)(function(){return[(0,a.bF)(O,{separator:""},{default:(0,a.k6)(function(){return[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.listadoRuletas,function(e,n){return(0,a.uX)(),(0,a.Wv)(q,{key:n,clickable:"",onClick:function(n){return t.cargarRuleta(e.id)}},{default:(0,a.k6)(function(){return[(0,a.bF)(y,null,{default:(0,a.k6)(function(){return[(0,a.bF)(I,{line:"2"},{default:(0,a.k6)(function(){return[(0,a.eW)((0,i.v_)(e.titulo),1)]}),_:2},1024),(0,a.bF)(I,{caption:""},{default:(0,a.k6)(function(){return[(0,a.eW)((0,i.v_)(e.fecha),1)]}),_:2},1024)]}),_:2},1024),(0,a.bF)(y,{side:""},{default:(0,a.k6)(function(){return[(0,a.bF)(S,{icon:"delete",round:"",flat:"",size:"sm",onClick:function(n){return n.stopPropagation(),t.eliminarRuleta(e.id)}},null,8,["onClick"])]}),_:2},1024)]}),_:2},1032,["onClick"])}),128))]}),_:1})]}),_:1})):((0,a.uX)(),(0,a.CE)("div",C,[(0,a.bF)(L,{subtitle:t.msgRuletas},null,8,["subtitle"])]))])]}),_:1})]}),_:1})]),(0,a.Lk)("div",k,[(0,a.bF)(F,{class:"col column",dense:"",bordered:"",flat:""},{default:(0,a.k6)(function(){return[(0,a.bF)(P,{class:"col column"},{default:(0,a.k6)(function(){return[t.id?((0,a.uX)(),(0,a.Wv)(V,{key:0,id:t.id,"id-clase-periodo":t.idClasePeriodo},null,8,["id","id-clase-periodo"])):((0,a.uX)(),(0,a.Wv)(L,{key:1,subtitle:t.msgRuleta},null,8,["subtitle"]))]}),_:1})]}),_:1})])])])])])]),(0,a.bF)(N,{modelValue:t.mCrearRuleta,"onUpdate:modelValue":e[5]||(e[5]=function(e){return t.mCrearRuleta=e}),title:"Nueva ruleta",onSubmit:t.grabarRuleta},{default:(0,a.k6)(function(){return[(0,a.bF)(D,{ref:"formRuleta"},{default:(0,a.k6)(function(){return[(0,a.Lk)("div",R,[(0,a.Lk)("div",A,[(0,a.Lk)("div",_,[(0,a.bF)(E,{modelValue:t.fRuleta.titulo,"onUpdate:modelValue":e[4]||(e[4]=function(e){return t.fRuleta.titulo=e}),label:"Nombre",rules:[function(t){return!!t||"Debe ingresar un título"}]},null,8,["modelValue","rules"])])])])]}),_:1},512)]}),_:1},8,["modelValue","onSubmit"])]}),_:1})}var F=n(76080),S=n.n(F),I=n(45254),y=n.n(I),q=n(6123),O=n(88567),T=n(95718),L=n(11654),V=n(12205),E=n(2739),D=n(9736),N=n(16648),U=n(65673),$=n(82327),M=n(88865),Q=n(66824),x=n(30640),W=n(80340),z={class:"ruleta-participacion col column"},X={key:0,class:"row col q-col-gutter-sm q-pa-sm"},G={class:"col-md-8 col-xs-12"},H={class:"content-reload"},B={key:2,class:"row q-pa-sm q-col-gutter-sm"},j={class:"col"},Y={class:"col q-gutter-sm"},K={class:"col-md-4 col-xs-12 column"},J={class:"col column listado"},Z={class:"row"},tt={class:"col-12"},et={class:"row col column"},nt={class:"col-12 column"},at={key:0,class:"col column q-pa-sm"};function it(t,e){var n=(0,a.g2)("q-spinner"),r=(0,a.g2)("q-inner-loading"),o=(0,a.g2)("q-ruleta"),u=(0,a.g2)("sie-usuario"),l=(0,a.g2)("q-item-section"),s=(0,a.g2)("q-item"),c=(0,a.g2)("q-input"),d=(0,a.g2)("q-btn"),f=(0,a.g2)("q-toggle"),p=(0,a.g2)("q-item-label"),m=(0,a.g2)("q-list"),h=(0,a.g2)("q-scroll-area"),v=(0,a.g2)("sie-modal");return(0,a.uX)(),(0,a.CE)("div",z,[t.loading?((0,a.uX)(),(0,a.Wv)(r,{key:0,visible:t.loading},{default:(0,a.k6)(function(){return[(0,a.bF)(n,{color:"primary",name:"dots",size:"40px"})]}),_:1},8,["visible"])):((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[t.restantes.length?((0,a.uX)(),(0,a.CE)("div",X,[(0,a.Lk)("div",G,[(0,a.Lk)("div",H,[t.reload?((0,a.uX)(),(0,a.CE)("div",{key:0,style:(0,i.Tr)({width:"".concat(t.canvasWidth,"px"),height:"".concat(t.canvasHeight,"px")})},[(0,a.bF)(r,{visible:t.reload},{default:(0,a.k6)(function(){return[(0,a.bF)(n,{color:"primary",name:"dots",size:"40px"})]}),_:1},8,["visible"])],4)):((0,a.uX)(),(0,a.Wv)(o,{key:1,modelValue:t.restantes,"onUpdate:modelValue":e[0]||(e[0]=function(e){return t.restantes=e}),ancho:t.canvasWidth,alto:t.canvasHeight,sorteado:t.sorteado,"onUpdate:sorteado":e[1]||(e[1]=function(e){return t.sorteado=e})},null,8,["modelValue","ancho","alto","sorteado"])),t.infoSorteado?((0,a.uX)(),(0,a.CE)("div",B,[(0,a.Lk)("div",j,[(0,a.bF)(s,null,{default:(0,a.k6)(function(){return[(0,a.bF)(l,{avatar:""},{default:(0,a.k6)(function(){return[(0,a.bF)(u,{usucod:t.infoSorteado.usucod},null,8,["usucod"])]}),_:1}),(0,a.bF)(l,null,{default:(0,a.k6)(function(){return[(0,a.eW)((0,i.v_)(t.infoSorteado.label),1)]}),_:1})]}),_:1})]),(0,a.Lk)("div",Y,[(0,a.bF)(c,{modelValue:t.comentario,"onUpdate:modelValue":e[2]||(e[2]=function(e){return t.comentario=e}),label:"Comentario"},null,8,["modelValue"]),(0,a.bF)(d,{onClick:t.grabarParticipacion,label:"Grabar",color:"primary",size:"sm"},null,8,["onClick"])])])):(0,a.Q3)("v-if",!0)])]),(0,a.Lk)("div",K,[(0,a.Lk)("div",J,[(0,a.Lk)("div",Z,[(0,a.Lk)("div",tt,[(0,a.bF)(f,{modelValue:t.quitarSorteados,"onUpdate:modelValue":e[3]||(e[3]=function(e){return t.quitarSorteados=e}),label:"Quitar a los que ya participaron","true-value":1,"false-value":0,onInput:t.grabar},null,8,["modelValue","onInput"])])]),(0,a.Lk)("div",et,[(0,a.Lk)("div",nt,[(0,a.bF)(h,{class:"col"},{default:(0,a.k6)(function(){return[(0,a.bF)(m,{separator:""},{default:(0,a.k6)(function(){return[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.participaron,function(e,n){return(0,a.uX)(),(0,a.Wv)(s,{key:n},{default:(0,a.k6)(function(){return[(0,a.bF)(l,{avatar:""},{default:(0,a.k6)(function(){return[(0,a.bF)(u,{usucod:e.USUCOD},null,8,["usucod"])]}),_:2},1024),(0,a.bF)(l,null,{default:(0,a.k6)(function(){return[(0,a.bF)(p,{line:"2"},{default:(0,a.k6)(function(){return[(0,a.eW)((0,i.v_)(e.USUNOM),1)]}),_:2},1024)]}),_:2},1024),(0,a.bF)(l,{side:""},{default:(0,a.k6)(function(){return[(0,a.bF)(d,{icon:"comment",color:e.TIENE_COMENTARIOS?"positive":"grey",round:"",flat:"",size:"sm",onClick:function(n){return t.obtComentarios(e)}},null,8,["color","onClick"])]}),_:2},1024)]}),_:2},1024)}),128))]}),_:1})]}),_:1})])])])]),(0,a.bF)(v,{class:"ruleta-participacion-comentarios",modelValue:t.modalComentarios,"onUpdate:modelValue":e[5]||(e[5]=function(e){return t.modalComentarios=e}),title:"Comentarios",column:"",ok:!1,cancel:!1},{postButtonFooter:(0,a.k6)(function(){return[(0,a.bF)(d,{onClick:e[4]||(e[4]=function(e){return t.modalComentarios=!1}),size:"sm",color:"primary",label:"Cerrar"})]}),default:(0,a.k6)(function(){return[t.comentarios.length?((0,a.uX)(),(0,a.CE)("div",at,[(0,a.bF)(p,{header:""},{default:(0,a.k6)(function(){return[(0,a.bF)(s,null,{default:(0,a.k6)(function(){return[(0,a.bF)(l,{avatar:""},{default:(0,a.k6)(function(){return[(0,a.bF)(u,{usucod:t.comentarios[0].USUCOD},null,8,["usucod"])]}),_:1}),(0,a.bF)(l,null,{default:(0,a.k6)(function(){return[(0,a.bF)(p,null,{default:(0,a.k6)(function(){return[(0,a.eW)((0,i.v_)(t.comentarios[0].USUNOM),1)]}),_:1})]}),_:1})]}),_:1})]}),_:1}),(0,a.bF)(h,{class:"col"},{default:(0,a.k6)(function(){return[(0,a.bF)(m,{separator:""},{default:(0,a.k6)(function(){return[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.comentarios,function(e,n){return(0,a.uX)(),(0,a.Wv)(s,{key:n},{default:(0,a.k6)(function(){return[(0,a.bF)(l,null,{default:(0,a.k6)(function(){return[(0,a.bF)(c,{modelValue:e.COMENTARIO,"onUpdate:modelValue":function(t){return e.COMENTARIO=t},label:"Comentario",type:"textarea"},null,8,["modelValue","onUpdate:modelValue"])]}),_:2},1024),(0,a.bF)(l,{side:""},{default:(0,a.k6)(function(){return[(0,a.bF)(d,{icon:"save",round:"",flat:"",size:"sm",onClick:function(n){return t.grabarComentario(e)}},null,8,["onClick"]),(0,a.bF)(d,{icon:"delete",round:"",flat:"",size:"sm",onClick:function(n){return t.eliminarComentario(e)}},null,8,["onClick"])]}),_:2},1024)]}),_:2},1024)}),128))]}),_:1})]}),_:1})])):(0,a.Q3)("v-if",!0)]}),_:1},8,["modelValue"])])):(0,a.Q3)("v-if",!0)],64))])}n(39866),n(52133),n(10239),n(50310),n(90095),n(6724),n(70199),n(11777),n(2064),n(91239),n(515),n(83190),n(62692),n(7346),n(13715);var rt=n(55973),ot=n(41482),ut={class:"q-ruleta"},lt={class:"row q-col-gutter-md"},st={class:"col-12 justify-center row"},ct=["width","height"],dt={class:"col-12 justify-center row"};function ft(t,e){var n=(0,a.g2)("q-btn");return(0,a.uX)(),(0,a.CE)("div",ut,[(0,a.Lk)("div",lt,[(0,a.Lk)("div",st,[(0,a.Lk)("canvas",{ref:"canvas",width:t.ancho,height:t.alto},null,8,ct)]),(0,a.Lk)("div",dt,[(0,a.bF)(n,{onClick:t.spin,label:"Lanzar",color:"primary",size:"sm",disable:t.girando},null,8,["onClick","disable"])])])])}n(93870);var pt={emits:["update:modelValue","input","update:sorteado"],components:{QBtn:L.A},props:{modelValue:{type:Array,default:function(){return[]}},sorteado:Number,ancho:{type:Number,default:500},alto:{type:Number,default:500}},data:function(){return{startAngle:0,spinTimeout:null,spinTime:0,spinTimeTotal:0,spinAngleStart:0,ctx:null,arc:0,girando:!1}},computed:{options:{get:function(){return this.modelValue},set:function(t){this.$emit("update:modelValue",t),this.$emit("input",t)}},win:{get:function(){return this.sorteado},set:function(t){this.$emit("update:sorteado",t)}}},watch:{modelValue:function(t){t&&this.drawRouletteWheel()}},mounted:function(){this.drawRouletteWheel()},beforeMount:function(){this.arc=Math.PI/(this.options.length/2)},methods:{byte2Hex:function(t){var e="0123456789ABCDEF";return String(e.substr(t>>4&15,1))+e.substr(15&t,1)},RGB2Color:function(t,e,n){return"#"+this.byte2Hex(t)+this.byte2Hex(e)+this.byte2Hex(n)},getColor:function(t,e){var n=0,a=128,i=127,r=2*Math.PI/e,o=Math.sin(r*t+2+n)*i+a,u=Math.sin(r*t+0+n)*i+a,l=Math.sin(r*t+4+n)*i+a;return this.RGB2Color(o,u,l)},drawRouletteWheel:function(){var t=this.$refs.canvas;if(t&&t.getContext){var e=(this.ancho-2)/2,n=this.ancho/2-20,a=this.ancho/4;this.ctx=t.getContext("2d");var i=this.ctx;i.clearRect(0,0,this.ancho,this.alto),i.font="bold 14px Helvetica, Arial";for(var r=0;r<this.options.length;r++){var o=this.startAngle+r*this.arc;i.fillStyle=this.getColor(r,this.options.length),i.beginPath(),i.arc(this.ancho/2,this.alto/2,e,o,o+this.arc,!1),i.arc(this.ancho/2,this.alto/2,a,o+this.arc,o,!0),i.stroke(),i.fill(),i.save(),i.shadowOffsetX=-1,i.shadowOffsetY=-1,i.shadowBlur=0,i.shadowColor="rgb(0,0,0)",i.fillStyle="white",i.translate(this.ancho/2+Math.cos(o+this.arc/2)*n,this.alto/2+Math.sin(o+this.arc/2)*n),i.rotate(o+this.arc/2+Math.PI/2);var u=this.options[r].value;i.fillText(u,-i.measureText(u).width/2,0),i.restore()}i.fillStyle="black",i.beginPath(),i.moveTo(this.ancho/2-4,this.alto/2-(e+5)),i.lineTo(this.ancho/2+4,this.alto/2-(e+5)),i.lineTo(this.ancho/2+4,this.alto/2-(e-5)),i.lineTo(this.ancho/2+9,this.alto/2-(e-5)),i.lineTo(this.ancho/2+0,this.alto/2-(e-13)),i.lineTo(this.ancho/2-9,this.alto/2-(e-5)),i.lineTo(this.ancho/2-4,this.alto/2-(e-5)),i.lineTo(this.ancho/2-4,this.alto/2-(e+5)),i.fill()}},spin:function(){this.girando=!0,this.spinAngleStart=10*Math.random()+10,this.spinTime=0,this.spinTimeTotal=3*Math.random()+2e4,this.rotateWheel()},rotateWheel:function(){var t=this;if(this.spinTime+=30,this.spinTime>=this.spinTimeTotal)return this.stopRotateWheel(),void(this.girando=!1);var e=this.spinAngleStart-this.easeOut(this.spinTime,0,this.spinAngleStart,this.spinTimeTotal);this.startAngle+=e*Math.PI/180,this.drawRouletteWheel(),this.spinTimeout=setTimeout(function(){t.rotateWheel()},0)},stopRotateWheel:function(){var t=this.ctx;clearTimeout(this.spinTimeout);var e=180*this.startAngle/Math.PI+90,n=180*this.arc/Math.PI,a=Math.floor((360-e%360)/n);t.save(),t.fillStyle="black",t.font="bold 16px Helvetica, Arial",t.textAlign="center";var i=this.options[a].label,r=t.measureText(i).width;if(r>this.ancho/2){var o=null,u=null,l=null;i.includes(",")?(o=i.split(","),u="".concat(o[0],","),l=o[1]):(o=i.length/2,u=i.substring(0,o),l=i.substring(o)),t.fillText(u,this.ancho/2,this.alto/2-8),t.fillText(l,this.ancho/2,this.alto/2+8)}else t.fillText(i,this.ancho/2,this.alto/2);this.win=a,t.restore()},easeOut:function(t,e,n,a){var i=(t/=a)*t,r=i*t;return e+n*(r+-3*i+3*t)}}},mt=n(12807);const ht=(0,mt.A)(pt,[["render",ft]]);var vt=ht,gt=n(24974),bt=n(81288),wt=n(80660),Ct={getEstudiantes:function(t){return y()(S()().m(function e(){var n;return S()().w(function(e){while(1)switch(e.n){case 0:return e.n=1,wt.$http.get("api/ClaseAlumnoController/getClaseAlumno",{params:{parametros:{id_clase_periodo:t}}});case 1:return n=e.v,n=n.map(function(t){return{label:t.NOMCOMP,value:t.NUMORD,usucod:t.USUCOD,id_persona:t.ID_PERSONA}}),e.a(2,n)}},e)}))()},obtRuletaParticipacion:function(t){return y()(S()().m(function e(){var n;return S()().w(function(e){while(1)switch(e.n){case 0:return e.n=1,wt.$http.get("api/RuletaParticipacionController/getRuletaParticipacion",{params:{params:t}});case 1:return n=e.v,e.a(2,{quitarSorteados:n.length?n[0].QUITAR_PARTICIPARON:0})}},e)}))()},grabar:function(t){return y()(S()().m(function e(){return S()().w(function(e){while(1)switch(e.n){case 0:return e.a(2,wt.$http.post("api/RuletaParticipacionController/addRuletaParticipacion",{data:t}))}},e)}))()},actualizar:function(t,e){return y()(S()().m(function n(){return S()().w(function(n){while(1)switch(n.n){case 0:return n.a(2,wt.$http.post("api/RuletaParticipacionController/updateRuletaParticipacion",{params:t,id:e}))}},n)}))()},getParticipantes:function(t){return y()(S()().m(function e(){return S()().w(function(e){while(1)switch(e.n){case 0:return e.a(2,wt.$http.get("api/RuletaParticipacionAlumnosController/getRuletaParticipacionAlumnos",{params:{parametros:t}}))}},e)}))()},grabarParticipante:function(t){return y()(S()().m(function e(){return S()().w(function(e){while(1)switch(e.n){case 0:return e.a(2,wt.$http.post("api/RuletaParticipacionAlumnosController/addRuletaParticipacionAlumnos",{data:t}))}},e)}))()},actualizarComentario:function(t,e){return y()(S()().m(function n(){return S()().w(function(n){while(1)switch(n.n){case 0:return n.a(2,wt.$http.post("api/RuletaParticipacionAlumnosController/updateRuletaParticipacionAlumnos",{params:t,id_rpa:e}))}},n)}))()},deleteParticipacion:function(t){return y()(S()().m(function e(){return S()().w(function(e){while(1)switch(e.n){case 0:return e.a(2,wt.$http.delete("api/RuletaParticipacionAlumnosController/deleteRuletaParticipacionAlumnos",{params:{id_rpa:t}}))}},e)}))()}},kt=Ct,Rt={components:{QInput:D.A,QInnerLoading:q.SQ,QToggle:rt.A,QBtn:L.A,QList:U.A,QItem:$.A,QItemSection:M.A,QItemLabel:Q.A,QScrollArea:V.A,QSpinner:ot.A,QRuleta:vt,SieUsuario:gt.A,SieModal:x.A},props:{idClasePeriodo:[String,Number],id:[String,Number]},data:function(){return{total:[],totalFreeze:[],participaron:[],sorteado:null,comentario:null,quitarSorteados:0,loading:!1,reload:!1,comentarios:[],modalComentarios:!1}},computed:{restantes:function(){var t=[];if(this.quitarSorteados){var e=this.participaron.map(function(t){return t.USUCOD}),n=[];this.totalFreeze.forEach(function(t){e.includes(t.usucod)||n.push(t)}),t=n}else t=this.totalFreeze;return t},infoSorteado:function(){var t=null;return Object.is(this.sorteado,null)||(t=this.restantes[this.sorteado]),t},canvasWidth:function(){var t=500;return(0,bt.isLess)()&&(t=300),t},canvasHeight:function(){var t=500;return(0,bt.isLess)()&&(t=300),t}},methods:{init:function(){var t=this;return y()(S()().m(function e(){var n,a;return S()().w(function(e){while(1)switch(e.n){case 0:return t.loading=!0,e.n=1,kt.getEstudiantes(t.idClasePeriodo);case 1:return t.total=e.v,t.totalFreeze=Object.freeze(JSON.parse(JSON.stringify(t.total))),e.n=2,kt.obtRuletaParticipacion({id:t.id});case 2:return n=e.v,a=n.quitarSorteados,t.quitarSorteados=a,e.n=3,kt.getParticipantes({id:t.id,sinRepeticiones:!0});case 3:t.participaron=e.v,t.loading=!1;case 4:return e.a(2)}},e)}))()},grabarParticipacion:function(){var t=this;return y()(S()().m(function e(){var n,a,i,r;return S()().w(function(e){while(1)switch(e.p=e.n){case 0:return t.reload=!0,e.p=1,n={id:t.id,comentario:t.comentario,id_persona:t.infoSorteado.id_persona},e.n=2,kt.grabarParticipante(n);case 2:a=e.v,i=a.message,r=a.data,t.comentario=null,t.participaron=r,t.quitarSorteados&&(t.sorteado=null),t.$notify(i,"success"),e.n=4;break;case 3:e.p=3,e.v,t.$notify("No se pudo grabar","warning");case 4:t.reload=!1;case 5:return e.a(2)}},e,null,[[1,3]])}))()},grabar:function(){var t=this;return y()(S()().m(function e(){var n,a,i;return S()().w(function(e){while(1)switch(e.p=e.n){case 0:return t.reload=!0,t.sorteado=null,e.p=1,n={quitar_participaron:t.quitarSorteados},e.n=2,kt.actualizar(n,t.id);case 2:return a=e.v,i=a.message,e.n=3,kt.getParticipantes({id:t.id,sinRepeticiones:!0});case 3:t.participaron=e.v,t.$notify(i,"success"),e.n=5;break;case 4:e.p=4,e.v,t.$notify("No se pudo actualizar","warning");case 5:t.reload=!1;case 6:return e.a(2)}},e,null,[[1,4]])}))()},obtComentarios:function(t){var e=this;return y()(S()().m(function n(){var a;return S()().w(function(n){while(1)switch(n.p=n.n){case 0:return a={id:t.ID,id_persona:t.ID_PERSONA},n.p=1,n.n=2,kt.getParticipantes(a);case 2:e.comentarios=n.v,e.modalComentarios=!0,n.n=4;break;case 3:n.p=3,n.v,e.comentarios=[];case 4:return n.a(2)}},n,null,[[1,3]])}))()},grabarComentario:function(t){var e=this;return y()(S()().m(function n(){var a,i,r;return S()().w(function(n){while(1)switch(n.p=n.n){case 0:return n.p=0,n.n=1,e.$confirmar("¿Está seguro de editar el comentario?","info");case 1:if(a=n.v,!a){n.n=4;break}return n.n=2,kt.actualizarComentario({comentario:t.COMENTARIO},t.ID_RPA);case 2:return i=n.v,r=i.message,n.n=3,kt.getParticipantes({id:t.ID,id_persona:t.ID_PERSONA});case 3:e.comentarios=n.v,e.$notify(r,"success");case 4:n.n=6;break;case 5:n.p=5,n.v,e.$notify("No se pudo actualizar","warning");case 6:return n.a(2)}},n,null,[[0,5]])}))()},eliminarComentario:function(t){var e=this;return y()(S()().m(function n(){var a,i,r;return S()().w(function(n){while(1)switch(n.p=n.n){case 0:return n.p=0,n.n=1,e.$confirmar("¿Está seguro de eliminar esta participación?","delete");case 1:if(a=n.v,!a){n.n=6;break}return n.n=2,kt.deleteParticipacion(t.ID_RPA);case 2:return i=n.v,r=i.message,n.n=3,kt.getParticipantes({id:t.ID,id_persona:t.ID_PERSONA});case 3:if(e.comentarios=n.v,0!==e.comentarios.length){n.n=5;break}return e.reload=!0,n.n=4,kt.getParticipantes({id:e.id,sinRepeticiones:!0});case 4:e.participaron=n.v,e.modalComentarios=!1,e.reload=!1;case 5:e.$notify(r,"success");case 6:n.n=8;break;case 7:n.p=7,n.v,e.$notify("No se pudo eliminar","warning");case 8:return n.a(2)}},n,null,[[0,7]])}))()}},watch:{id:function(){var t=this;return y()(S()().m(function e(){return S()().w(function(e){while(1)switch(e.n){case 0:return e.n=1,t.init();case 1:return e.a(2)}},e)}))()}},created:function(){var t=this;return y()(S()().m(function e(){return S()().w(function(e){while(1)switch(e.n){case 0:return e.n=1,t.init();case 1:return e.a(2)}},e)}))()}};const At=(0,mt.A)(Rt,[["render",it]]);var _t=At,Pt=n(57668),Ft=n(69027),St=n(34707),It=n(26319),yt=n(8261),qt={getAmbitos:function(t){return y()(S()().m(function e(){var n;return S()().w(function(e){while(1)switch(e.n){case 0:return e.n=1,St.A.getAmbitos(t);case 1:return n=e.v,n=n.map(function(t){return{value:t.ID_AMBITO,label:t.DESCRIPCION}}),e.a(2,n)}},e)}))()},getCursos:function(t){return y()(S()().m(function e(){var n;return S()().w(function(e){while(1)switch(e.n){case 0:return e.n=1,St.A.getCursos(t);case 1:return n=e.v,n=n.map(function(t){return{value:t.ID_CURSO,label:t.CURSONOM}}),n=(0,yt["default"])(n,"value"),e.a(2,n)}},e)}))()},getGrupos:function(t,e){return y()(S()().m(function n(){var a;return S()().w(function(n){while(1)switch(n.n){case 0:return n.n=1,wt.$http.get("api/curso/getComboGrupos",{params:{id_ambito:t,id_curso:e}});case 1:return a=n.v,a=a.map(function(t){return{value:t.GRUPOCOD,label:t.GRUPODES}}),n.a(2,a)}},n)}))()},getPeriodos:function(t,e,n){return y()(S()().m(function a(){var i;return S()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,wt.$http.get("api/curso/getComboPeriodos",{params:{id_ambito:t,id_curso:e,grupocod:n}});case 1:return i=a.v,i=i.map(function(t){return{value:t.ID_CLASE_PERIODO,label:t.PERIODO}}),a.a(2,i)}},a)}))()},getRuletas:function(t){return y()(S()().m(function e(){var n;return S()().w(function(e){while(1)switch(e.n){case 0:return e.n=1,wt.$http.get("api/RuletaParticipacionController/getRuletaParticipacion",{params:{params:{id_clase_periodo:t}}});case 1:return n=e.v,n=n.map(function(t){return{titulo:t.TITULO,id:t.ID,id_clase_periodo:t.ID_CLASE_PERIODO,fecha:(0,It.formatDate)(t.FH_REGISTRO,"DD/MM/YYYY")}}),e.a(2,n)}},e)}))()},deleteRuletaParticipacion:function(t){return y()(S()().m(function e(){return S()().w(function(e){while(1)switch(e.n){case 0:return e.a(2,wt.$http.delete("api/RuletaParticipacionController/deleteRuletaParticipacion",{params:{id:t}}))}},e)}))()}},Ot=qt,Tt={components:{QCard:O.A,QCardSection:T.A,QBtn:L.A,QScrollArea:V.A,QForm:E.A,QInput:D.A,QSelect:N.A,QList:U.A,QItem:$.A,QItemSection:M.A,QItemLabel:Q.A,SieModal:x.A,SieVacio:W.A,Ruleta:_t,QPage:q.Tu},data:function(){return{sie:(0,Pt["default"])(),fRuleta:{titulo:null},ambitos:[],cursos:[],grupos:[],periodos:[],id:null,idAmbito:null,idCurso:null,grupocod:null,idClasePeriodo:null,mCrearRuleta:!1,listadoRuletas:[]}},computed:{msgRuletas:function(){var t="Debe seleccionar todos los campos";return this.idAmbito&&this.idCurso&&this.grupocod&&this.idClasePeriodo&&(t="No existe información para los valores seleccionados"),t},msgRuleta:function(){var t="Debe seleccionar todos los campos";return this.idAmbito&&this.idCurso&&this.grupocod&&this.idClasePeriodo&&(t="Seleccione un elemento de la lista"),t}},methods:{crearRuleta:function(){this.idAmbito&&this.idCurso&&this.grupocod&&this.idClasePeriodo?this.mCrearRuleta=!0:this.$notify("Debe seleccionar la clase antes de crear una ruleta","warning")},grabarRuleta:function(){var t=this;return y()(S()().m(function e(){var n,a,i,r,o;return S()().w(function(e){while(1)switch(e.p=e.n){case 0:return e.n=1,t.$refs.formRuleta.validate();case 1:if(n=e.v,!n){e.n=5;break}return e.p=2,a={titulo:t.fRuleta.titulo,id_clase_periodo:t.idClasePeriodo},e.n=3,kt.grabar(a);case 3:i=e.v,r=i.data,o=i.message,t.listadoRuletas=r,t.$notify(o,"success"),e.n=5;break;case 4:e.p=4,e.v,t.$notify("No se pudo grabar","warning");case 5:return e.a(2)}},e,null,[[2,4]])}))()},getCursos:function(){var t=this;return y()(S()().m(function e(){return S()().w(function(e){while(1)switch(e.n){case 0:return t.resetCampoOpciones(["idCurso","grupocod","idClasePeriodo","id"],["cursos","grupos","periodos","listadoRuletas"]),e.n=1,Ot.getCursos(t.idAmbito);case 1:t.cursos=e.v;case 2:return e.a(2)}},e)}))()},getGrupos:function(){var t=this;return y()(S()().m(function e(){return S()().w(function(e){while(1)switch(e.n){case 0:return t.resetCampoOpciones(["grupocod","idClasePeriodo","id"],["grupos","periodos","listadoRuletas"]),e.n=1,Ot.getGrupos(t.idAmbito,t.idCurso);case 1:t.grupos=e.v;case 2:return e.a(2)}},e)}))()},getPeriodos:function(){var t=this;return y()(S()().m(function e(){return S()().w(function(e){while(1)switch(e.n){case 0:return t.resetCampoOpciones(["idClasePeriodo","id"],["periodos","listadoRuletas"]),e.n=1,Ot.getPeriodos(t.idAmbito,t.idCurso,t.grupocod);case 1:t.periodos=e.v;case 2:return e.a(2)}},e)}))()},getRuletas:function(){var t=this;return y()(S()().m(function e(){return S()().w(function(e){while(1)switch(e.n){case 0:return t.resetCampoOpciones(["id"],["listadoRuletas"]),e.n=1,Ot.getRuletas(t.idClasePeriodo);case 1:t.listadoRuletas=e.v;case 2:return e.a(2)}},e)}))()},cargarRuleta:function(t){this.id=t},resetCampoOpciones:function(t,e){for(var n=0;n<t.length;n++)this[t[n]]=null,this[e[n]]=[]},eliminarRuleta:function(t){var e=this;return y()(S()().m(function n(){var a;return S()().w(function(n){while(1)switch(n.p=n.n){case 0:return n.n=1,(0,Ft.confirmacion)("Se eliminará esta ruleta. Tambien se eliminaran las participaciones","¿Está seguro de realizar esta acción?");case 1:if(a=n.v,!a){n.n=6;break}return n.p=2,n.n=3,Ot.deleteRuletaParticipacion(t);case 3:return n.n=4,e.getRuletas();case 4:e.$notify("Se eliminó correctamente","success"),n.n=6;break;case 5:n.p=5,n.v,e.$notify("No se pudo eliminar la ruleta","warning");case 6:return n.a(2)}},n,null,[[2,5]])}))()}},created:function(){var t=this;return y()(S()().m(function e(){return S()().w(function(e){while(1)switch(e.n){case 0:return e.n=1,Ot.getAmbitos(t.sie.ano);case 1:t.ambitos=e.v;case 2:return e.a(2)}},e)}))()}};const Lt=(0,mt.A)(Tt,[["render",P]]);var Vt=Lt}}]);