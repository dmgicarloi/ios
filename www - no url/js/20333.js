"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[20333],{20333:function(e,t,a){a.r(t),a.d(t,{default:function(){return J}});var l=a(61758);function n(e,t){var a=(0,l.g2)("q-page");return(0,l.uX)(),(0,l.Wv)(a,null,{default:(0,l.k6)(function(){return[((0,l.uX)(),(0,l.Wv)((0,l.$y)(e.tabSelect),{class:"q-ma-xs",onCambiar:e.cambiarEstado,idDetalle:e.id_detalle,estado:e.estado,tipo:e.tipo,onActivoInactivo:e.activoInactivo},null,40,["onCambiar","idDetalle","estado","tipo","onActivoInactivo"]))]}),_:1})}var o=a(6123),i={class:"column"};function r(e,t){var a=(0,l.g2)("header-btn"),n=(0,l.g2)("sie-pdf"),o=(0,l.g2)("sie-modal"),r=(0,l.g2)("sie-table");return(0,l.uX)(),(0,l.CE)("div",i,[(0,l.bF)(a,{name:"Listado de Plantillas"}),e.modalDetalle?((0,l.uX)(),(0,l.Wv)(o,{key:0,modelValue:e.modalDetalle,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.modalDetalle=t}),title:"Detalle de "+e.dataModal.DESCTIPO},{default:(0,l.k6)(function(){return[(0,l.bF)(n,{class:"col",src:e.url(e.dataModal),style:{"min-height":"60vh","min-width":"50vw"}},null,8,["src"])]}),_:1},8,["modelValue","title"])):(0,l.Q3)("v-if",!0),(0,l.bF)(r,{class:"q-ma-sm",dense:"",flat:"",bordered:"","wrap-cells":"",css:"height: calc(70vh - 180px)",context:this,columns:e.columns,data:e.listaCabeceras,config:e.config},null,8,["columns","data","config"])])}var c=a(57008),u=a.n(c),s=a(76080),d=a.n(s),f=a(45254),m=a.n(f),p=(a(30683),a(33777)),D=a(57668),v=(a(78131),a(84603)),h=a(30640),b={emits:["cambiar"],components:{SieTable:p.A,siePdf:v.A,sieModal:h.A},data:function(){return{modalDetalle:!1,dataModal:{},columns:[{name:"DESCTIPO",label:"Tipo",align:"left",field:"DESCTIPO"},{name:"ESTADO",label:"Estado",align:"left",field:"ESTADO"},{name:"ACCION",align:"center",field:"ACCION"}],listaCabeceras:[],config:{ESTADO:{renderHtml:function(e,t,a,l){return a.checkbox({value:e.ESTADO,trueValue:1,falseValue:0,checkedIcon:"check_box",uncheckedIcon:"check_box_outline_blank",color:"primary"})},renderAction:function(e,t){var a=this;return m()(d()().m(function l(){return d()().w(function(l){while(1)switch(l.n){case 0:return l.n=1,a.$http.post("api/AfPlantillaController/updateAfPlantilla",{params:{ESTADO:1===e.ESTADO?0:1},id:e.ID});case 1:t.ESTADO=1===e.ESTADO?0:1;case 2:return l.a(2)}},l)}))()}},ACCION:{component:"button",icon:["edit as editar","remove_red_eye as verDetalles"],editar:function(e){this.$emit("cambiar","nuevo",e.ID,e.ESTADO,e.ID_TIPO)},verDetalles:function(e){var t=this;return m()(d()().m(function a(){return d()().w(function(a){while(1)switch(a.n){case 0:t.dataModal=u()({},e),t.modalDetalle=!0;case 1:return a.a(2)}},a)}))()},flat:!0,round:!0}}}},methods:{cargarPlantillas:function(){var e=this;return m()(d()().m(function t(){return d()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,e.$http.get("api/AfPlantillaController/getAfPlantilla");case 1:e.listaCabeceras=t.v;case 2:return t.a(2)}},t)}))()},url:function(e){var t=e.ID_TIPO,a=e.TIPO_DETALLE;switch(t){case 1:case 2:var l=(0,D["default"])().api+"/AfSolicitudController/getConstancia"+"?ID=0&ID_SOLICITUD_TIPO=".concat(t,"&token2=").concat((0,D["default"])().token,"&access_token=").concat((0,D["default"])().token);return console.log({url:l}),l;case 3:return(0,D["default"])().api+"/AfTransferenciaController/getConstancia"+"?ID_TRANSFERENCIA=0&itdipo=".concat(a,"&token2=").concat((0,D["default"])().token,"&access_token=").concat((0,D["default"])().token);case 4:var n=(0,D["default"])().api+"/AfDevolucionController/getConstancia"+"?ID=0&token2=".concat((0,D["default"])().token,"&access_token=").concat((0,D["default"])().token);return console.log(n),n}}},mounted:function(){this.cargarPlantillas()}},A=a(12807);const k=(0,A.A)(b,[["render",r]]);var E=k,g=a(8445),T=a.n(g),L=a(58790),I={class:"column"},C={class:"q-ma-sm q-card"},_={class:"q-table q-table-horizontal-separator q-card"},O={class:"ancho-texto"},w={class:"q-tr"},P={style:{"text-align":"center"}},S=["innerHTML"],V={class:"row justify-center"},q={class:"row justify-center"},M={class:"q-ma-sm"},F={class:"row q-col-gutter-sm"},x={class:"row justify-end col"},$={class:"q-ma-sm"},N={class:"col q-pa-xs border-field q-mb-sm"},y={class:"col row wrap justify-between q-ma-xs"},U={class:"q-ma-sm"};function R(e,t){var a=(0,l.g2)("header-btn"),n=(0,l.g2)("q-icon"),o=(0,l.g2)("q-select"),i=(0,l.g2)("q-toggle"),r=(0,l.g2)("q-btn"),c=(0,l.g2)("draggable"),u=(0,l.g2)("sie-editor"),s=(0,l.g2)("sie-modal");return(0,l.uX)(),(0,l.CE)("div",I,[(0,l.bF)(a,{name:"Detalle de Plantilla",buttons:e.buttons},null,8,["buttons"]),(0,l.Lk)("div",C,[(0,l.Lk)("table",_,[(0,l.Lk)("thead",null,[(0,l.Lk)("tr",null,[(0,l.Lk)("th",null,[(0,l.bF)(n,{name:"import_export",size:"20px"})]),(0,l.Lk)("th",O,[(0,l.Lk)("span",null,(0,L.v_)(e.$t("matricula.descripcion")),1)]),(0,l.Lk)("th",null,[(0,l.Lk)("span",null,(0,L.v_)(e.$t("tipo")),1)]),(0,l.Lk)("th",null,[(0,l.Lk)("span",null,(0,L.v_)(e.$t("activo")),1)]),t[5]||(t[5]=(0,l.Lk)("th",null,null,-1))])]),(0,l.bF)(c,{modelValue:e.infoDetalle,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.infoDetalle=t}),tag:"tbody",onChange:e.ordenarDetalle},{default:(0,l.k6)(function(){return[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.infoDetalle,function(t,a){return(0,l.uX)(),(0,l.CE)("tr",w,[(0,l.Lk)("td",P,[(0,l.bF)(n,{name:"blur_on",size:"20px"})]),(0,l.Lk)("td",{innerHTML:t.DETALLE},null,8,S),(0,l.Lk)("td",null,[(0,l.bF)(o,{modelValue:t.TIPO,"onUpdate:modelValue":function(e){return t.TIPO=e},options:e.tipoAceptaciones,disable:""},null,8,["modelValue","onUpdate:modelValue","options"])]),(0,l.Lk)("td",null,[(0,l.Lk)("div",V,[(0,l.bF)(i,{modelValue:t.ESTADO,"onUpdate:modelValue":function(e){return t.ESTADO=e},"true-value":1,"false-value":0,disable:""},null,8,["modelValue","onUpdate:modelValue"])])]),(0,l.Lk)("td",null,[(0,l.Lk)("div",q,[(0,l.bF)(r,{flat:"",dense:"",round:"",icon:"edit",onClick:function(a){return e.openDetalle(t)}},null,8,["onClick"])])])])}),256))]}),_:1},8,["modelValue","onChange"])])]),(0,l.bF)(s,{modelValue:e.modalAdd,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.modalAdd=t}),title:"Agregar Componente",onSubmit:e.saveDetalle},{default:(0,l.k6)(function(){return[(0,l.Lk)("div",M,[(0,l.Lk)("div",F,[(0,l.bF)(o,{class:"col",modelValue:e.infoDetalleModal.TIPO,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.infoDetalleModal.TIPO=t}),label:"Tipo",options:e.tipoAceptaciones,disable:e.infoDetalleModal.ID_DETALLE},null,8,["modelValue","options","disable"]),(0,l.Lk)("div",x,[(0,l.bF)(i,{modelValue:e.infoDetalleModal.ESTADO,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.infoDetalleModal.ESTADO=t}),"true-value":1,"false-value":0},{default:(0,l.k6)(function(){return T()(t[6]||(t[6]=[(0,l.eW)("Activo",-1)]))}),_:1},8,["modelValue"])])])]),(0,l.Lk)("div",$,[(0,l.Lk)("fieldset",N,[t[7]||(t[7]=(0,l.Lk)("legend",{class:"leyenda"},"Etiquetas",-1)),(0,l.Lk)("div",y,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.tags,function(e){return(0,l.uX)(),(0,l.CE)("div",{key:e.ID_TAG,class:"col-5"},[(0,l.Lk)("b",null,(0,L.v_)(e.DESCRIPCION+": "),1),(0,l.Lk)("span",null,(0,L.v_)(e.ETIQUETA),1)])}),128))])])]),(0,l.Lk)("div",U,[(0,l.bF)(u,{class:"col",modelValue:e.infoDetalleModal.DETALLE,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.infoDetalleModal.DETALLE=t}),label:e.$t("matricula.descripcion"),extra:{ruler:!0}},null,8,["modelValue","label"])])]}),_:1},8,["modelValue","onSubmit"])])}a(52133),a(10239),a(50310),a(90095),a(6724),a(83190),a(13715);var Q=a(39231),X=a(6083),j=a(16648),z=Q.Hi,G={emits:["cambiar"],components:{draggable:z,sieEditor:X.A,sieModal:h.A,QSelect:j.A,QIcon:o.bP,QToggle:o.c5,QBtn:o.Il},props:["idDetalle","estado","tipo"],data:function(){return{infoDetalle:[],tags:[],modalAdd:!1,infoDetalleModal:{ESTADO:1,ORDEN:1,DETALLE:null,TIPO:2},tipoAceptaciones:[{label:"Encabezado",value:1},{label:"Cuerpo",value:2},{label:"Pie",value:3}]}},methods:{saveDetalle:function(){var e=this;return m()(d()().m(function t(){var a;return d()().w(function(t){while(1)switch(t.p=t.n){case 0:return t.n=1,e.$confirmar("¿está seguro de registrar el detalle?");case 1:if(a=t.v,!a){t.n=5;break}return t.p=2,t.n=3,e.$http.post("api/AfPlantillaController/savePlantilla",{params:e.infoDetalleModal});case 3:e.$notify("Guardado Correctamente"),e.modalAdd=!1,e.listaDetalles(),t.n=5;break;case 4:t.p=4,t.v;case 5:return t.a(2)}},t,null,[[2,4]])}))()},listaDetalles:function(){var e=this;return m()(d()().m(function t(){return d()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,e.$http.get("api/AfPlantillaController/getDetalle",{params:{id:e.idDetalle}});case 1:e.infoDetalle=t.v;case 2:return t.a(2)}},t)}))()},volver:function(){this.$emit("cambiar","listado")},addDetalle:function(){this.openDetalle({})},openDetalle:function(e){e.ID_DETALLE?this.infoDetalleModal=u()({},e):this.infoDetalleModal={ESTADO:1,ORDEN:this.infoDetalle.length+1||1,DETALLE:null,TIPO:2,ID_CABECERA:this.idDetalle},this.modalAdd=!0},ordenarDetalle:function(e){var t=this;return m()(d()().m(function a(){var l;return d()().w(function(a){while(1)switch(a.p=a.n){case 0:return e=e.moved,l=[],t.infoDetalle.forEach(function(e,t){console.log(e.ORDEN,t+1),e.ORDEN!==t+1&&l.push({ID_DETALLE:e.ID_DETALLE,ORDEN:t+1})}),a.p=1,a.n=2,t.$http.post("api/AfPlantillaController/updateOrden",{datos:l});case 2:a.n=4;break;case 3:a.p=3,a.v;case 4:return a.a(2)}},a,null,[[1,3]])}))()},activar:function(){var e=this;return m()(d()().m(function t(){var a;return d()().w(function(t){while(1)switch(t.p=t.n){case 0:return t.p=0,a=1===e.estado?0:1,t.n=1,e.$http.post("api/AfPlantillaController/updateAfPlantilla",{params:{ESTADO:a},id:e.idDetalle});case 1:e.volver(),t.n=3;break;case 2:t.p=2,t.v;case 3:return t.a(2)}},t,null,[[0,2]])}))()}},mounted:function(){var e=this;return m()(d()().m(function t(){var a;return d()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,e.$http.get("api/AfPlantillaController/getTagsDetalles",{params:{id:e.tipo}});case 1:a=t.v,e.tags=a.map(function(e){var t=e.ID_TAG,a=e.ID_PLANTILLA,l=e.ETIQUETA,n=e.DESCRIPCION;return{ID_TAG:t,ID_PLANTILLA:a,ETIQUETA:"{{".concat(l,"}}"),DESCRIPCION:n}}),e.listaDetalles();case 2:return t.a(2)}},t)}))()},computed:{buttons:function(){var e=[];if(e.push({label:"Volver",icon:"arrow_left",click:this.volver}),3===(0,D["default"])().ruta.nivel){var t=(1===this.estado?"Desa":"A")+"ctivar",a=1===this.estado?"check_box_outline_blank":"check_box";e.push({label:t,icon:a,click:this.activar}),e.push({label:"Agregar",icon:"add",click:this.addDetalle})}return e}}};const H=(0,A.A)(G,[["render",R]]);var W=H,B={components:{nuevo:W,listado:E,QPage:o.Tu},data:function(){return{tabSelect:"listado",id_detalle:null,estado:1,tipo:null}},methods:{cambiarEstado:function(e,t,a,l){this.tabSelect=e,this.id_detalle=t,this.estado=a,this.tipo=l},activoInactivo:function(e,t){}}};const K=(0,A.A)(B,[["render",n]]);var J=K}}]);