"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[1433],{1433:function(e,a,r){r.r(a),r.d(a,{default:function(){return S}});var o=r(8445),l=r.n(o),n=r(61758),t=r(58790),s={class:"column",style:{display:"grid"}},i={class:"row"},d={class:"row justify-end"},u={class:"q-ma-sm"},c={style:{display:"flex","justify-content":"space-between"}},f={class:"q-ma-sm"},R={class:"q-card"},v={class:"row-md col"},b={class:"row justify-center"},m={class:"row justify-around"};function p(e,a){var r=(0,n.g2)("header-btn"),o=(0,n.g2)("q-btn"),p=(0,n.g2)("q-select"),C=(0,n.g2)("q-field"),I=(0,n.g2)("q-input"),E=(0,n.g2)("q-color"),h=(0,n.g2)("sie-modal"),O=(0,n.g2)("q-search"),A=(0,n.g2)("q-td"),M=(0,n.g2)("q-table");return(0,n.uX)(),(0,n.CE)("div",s,[(0,n.bF)(r,{name:"Unidades Reservables",buttons:e.buttons},null,8,["buttons"]),(0,n.bF)(h,{modelValue:e.estadoModal,"onUpdate:modelValue":a[6]||(a[6]=function(a){return e.estadoModal=a}),title:"Agregar Unidad Reservable",ok:!1,noClose:!0,escClick:!0,esc:!0},{footerMobile:(0,n.k6)(function(){return[(0,n.Lk)("div",i,[(0,n.bF)(o,{class:"q-ma-xs",dense:"",round:"",flat:"",icon:"close",onClick:e.cancelarAgregacion},null,8,["onClick"]),(0,n.bF)(o,{class:"q-ma-xs",dense:"",round:"",flat:"",icon:"save",onClick:e.ejecutarAccion},null,8,["onClick"])])]}),footer:(0,n.k6)(function(){return[(0,n.Lk)("div",d,[(0,n.bF)(o,{class:"q-ma-xs style-button",dense:"",color:"secondary",onClick:e.cancelarAgregacion},{default:(0,n.k6)(function(){return l()(a[9]||(a[9]=[(0,n.eW)("Cancelar",-1)]))}),_:1},8,["onClick"]),(0,n.bF)(o,{class:"q-ma-xs style-button",dense:"",color:"primary",onClick:e.ejecutarAccion},{default:(0,n.k6)(function(){return[(0,n.eW)((0,t.v_)(e.lbAccion),1)]}),_:1},8,["onClick"])])]}),default:(0,n.k6)(function(){return[(0,n.Lk)("div",u,[(0,n.bF)(C,{error:e.v$.datosModal.TIPO_RESERVA_ID.$error,"error-label":e.$t("validaciones.requerido")},{default:(0,n.k6)(function(){return[(0,n.bF)(p,{class:"q-if-outlined","float-label":"Tipo de Reserva",modelValue:e.v$.datosModal.TIPO_RESERVA_ID.$model,"onUpdate:modelValue":a[0]||(a[0]=function(a){return e.v$.datosModal.TIPO_RESERVA_ID.$model=a}),options:e.tiposReserva,filter:"",placeholder:"Seleccione el tipo de reserva"},null,8,["modelValue","options"])]}),_:1},8,["error","error-label"]),3===e.datosModal.TIPO_RESERVA_ID?((0,n.uX)(),(0,n.Wv)(C,{key:0,error:e.v$.datosModal.ES_INTERNO.$error,"error-label":e.$t("validaciones.requerido")},{default:(0,n.k6)(function(){return[(0,n.bF)(p,{class:"q-if-outlined","float-label":"Seleccione tipo de movilidad",modelValue:e.v$.datosModal.ES_INTERNO.$model,"onUpdate:modelValue":a[1]||(a[1]=function(a){return e.v$.datosModal.ES_INTERNO.$model=a}),options:[{label:"Interno",value:1},{label:"Externo",value:0}],placeholder:"Seleccione tipo de movilidad"},null,8,["modelValue"])]}),_:1},8,["error","error-label"])):(0,n.Q3)("v-if",!0),(0,n.bF)(C,{error:e.v$.datosModal.NOMBRE.$error,"error-label":e.$t("validaciones.requerido")},{default:(0,n.k6)(function(){return[(0,n.bF)(I,{class:"q-if-outlined","float-label":"Nombre",modelValue:e.v$.datosModal.NOMBRE.$model,"onUpdate:modelValue":a[2]||(a[2]=function(a){return e.v$.datosModal.NOMBRE.$model=a}),placeholder:"Escriba un nuevo nombre...",maxlength:"50"},null,8,["modelValue"])]}),_:1},8,["error","error-label"]),(0,n.bF)(C,{error:e.v$.datosModal.CAPACIDAD.$error,"error-label":e.$t("validaciones.requerido")},{default:(0,n.k6)(function(){return[(0,n.bF)(I,{class:"q-if-outlined","float-label":"Capacidad",modelValue:e.v$.datosModal.CAPACIDAD.$model,"onUpdate:modelValue":a[3]||(a[3]=function(a){return e.v$.datosModal.CAPACIDAD.$model=a}),placeholder:"Escriba una capacidad...",type:"number"},null,8,["modelValue"])]}),_:1},8,["error","error-label"]),(0,n.bF)(C,{error:e.v$.datosModal.COLOR.$error,"error-label":e.$t("validaciones.requerido")},{default:(0,n.k6)(function(){return[(0,n.Lk)("div",c,[(0,n.bF)(E,{class:"q-if-outlined","float-label":"Color",modelValue:e.v$.datosModal.COLOR.$model,"onUpdate:modelValue":a[4]||(a[4]=function(a){return e.v$.datosModal.COLOR.$model=a}),placeholder:"Seleccione un color...","format-model":"hex",style:{width:"78%"}},null,8,["modelValue"]),(0,n.bF)(o,{style:(0,t.Tr)([{background:e.datosModal.COLOR},{width:"20%"}])},null,8,["style"])])]}),_:1},8,["error","error-label"]),(0,n.bF)(C,null,{default:(0,n.k6)(function(){return[(0,n.bF)(I,{class:"q-if-outlined","float-label":"Descripción",modelValue:e.datosModal.DESCRIPCION,"onUpdate:modelValue":a[5]||(a[5]=function(a){return e.datosModal.DESCRIPCION=a}),placeholder:"Escriba un descripción...",type:"textarea",maxlength:"200",rows:"4"},null,8,["modelValue"])]}),_:1})])]}),_:1},8,["modelValue"]),(0,n.Lk)("div",f,[(0,n.Lk)("div",R,[(0,n.bF)(M,{data:e.unidadesReservables,columns:e.columns,filter:e.filtro,"virtual-scroll":"",style:(0,t.Tr)({width:e.size})},{"top-right":(0,n.k6)(function(){return[(0,n.Lk)("div",v,[(0,n.bF)(O,{class:"q-if-outlined",modelValue:e.filtro,"onUpdate:modelValue":a[7]||(a[7]=function(a){return e.filtro=a})},null,8,["modelValue"]),(0,n.bF)(p,{class:"q-if-outlined",modelValue:e.filtroTipoReserva,"onUpdate:modelValue":a[8]||(a[8]=function(a){return e.filtroTipoReserva=a}),options:e.tiposReserva,filter:"",multiple:"",chips:"",placeholder:"Tipos de Reserva",style:{width:"100%"},onInput:e.filtrarUnidadesReservables},null,8,["modelValue","options","onInput"])])]}),"body-cell-COLOR":(0,n.k6)(function(e){return[(0,n.bF)(A,null,{default:(0,n.k6)(function(){return[(0,n.Lk)("div",b,[(0,n.bF)(o,{style:(0,t.Tr)({background:e.row.COLOR}),size:"sm"},null,8,["style"])])]}),_:2},1024)]}),"body-cell-ACCIONES":(0,n.k6)(function(a){return[(0,n.bF)(A,{props:a},{default:(0,n.k6)(function(){return[(0,n.Lk)("div",m,[(0,n.bF)(o,{color:"blue",icon:"edit",flat:"",dense:"",round:"",onClick:function(r){return e.mostrarModal(a.row)}},null,8,["onClick"]),(0,n.bF)(o,{color:"red",icon:"delete",flat:"",dense:"",round:"",onClick:function(r){return e.eliminarUnidadReservable(a.row)}},null,8,["onClick"])])]}),_:2},1032,["props"])]}),_:1},8,["data","columns","filter","style"])])])])}var C=r(76080),I=r.n(C),E=r(45254),h=r.n(E),O=(r(77507),r(10239),r(50310),r(90095),r(48426),r(83190),r(68017),r(13715),r(83972)),A=r(30545),M=r(30640),D=r(6123),$=r(82640),g=r(57668),k={setup:function(){var e=(0,O.fG)();return{v$:e}},components:{QTable:A.A,sieModal:M.A,QDatetime:D.T5,QSelect:D.Si,QTr:D.qh,QTh:D.EJ,QTd:D.Ef,QColor:D.zy,QToolbar:D.ZV,QBtn:D.Il,QField:D.Om,QInput:D.ie,QSearch:D.Ks},data:function(){return{size:"100%",permiso:(0,g["default"])().ruta.nivel,lbAccion:"",estadoModal:!1,filtro:"",filtroTipoReserva:[],datosModal:{ID:null,NOMBRE:null,DESCRIPCION:null,CAPACIDAD:null,COLOR:"#FFFFFF",TIPO_RESERVA_ID:null,ES_INTERNO:1},tiposReserva:[],unidadesReservables:[],columns:[{name:"ID",label:"Id",field:"ID",align:"center",sortable:!0},{name:"NOMBRE",label:"Nombre",field:"NOMBRE",align:"column-style"},{name:"DESCRIPCION",label:"Descripción",field:"DESCRIPCION",align:"column-style"},{name:"TIPO_RESERVA",label:"Tipos de Reserva",field:"TIPO_RESERVA",align:"center"},{name:"CAPACIDAD",label:"Capacidad",field:"CAPACIDAD",align:"center"},{name:"COLOR",label:"Color",field:"COLOR",align:"center"}]}},mounted:function(){this.obtenerUnidadesReservables(),this.obtenerTiposReservas(),3===this.permiso&&this.columns.push({name:"ACCIONES",label:"Acciones",field:"ACCIONES",align:"center",style:"width: 90px"});var e=window.innerWidth;e<500&&(this.size=e-16+"px"),window.addEventListener("resize",this.onResize)},validations:function(){var e={TIPO_RESERVA_ID:{required:$.mw},NOMBRE:{required:$.mw},CAPACIDAD:{required:$.mw},COLOR:{required:$.mw}};return 3===this.datosModal.TIPO_RESERVA_ID&&(e.ES_INTERNO={required:$.mw}),{datosModal:e}},computed:{buttons:function(){var e=[];return this.permiso>=2&&e.push({label:"Agregar Unidad",icon:"add",click:this.mostrarModal}),e}},methods:{mostrarModal:function(e){e.ID?(this.lbAccion="Actualizar",this.datosModal=Object.assign({},e)):(this.limpiarCampos(),this.lbAccion="Agregar"),this.estadoModal=!0},ejecutarAccion:function(){this.v$.$touch(),this.v$.$error||(this.datosModal.ID?this.actualizarUnidadReservable():this.agregarUnidadReservable(),this.estadoModal=!1,this.limpiarCampos())},agregarUnidadReservable:function(){var e=this;return h()(I()().m(function a(){var r,o,l;return I()().w(function(a){while(1)switch(a.p=a.n){case 0:return a.p=0,r={NOMBRE:e.datosModal.NOMBRE.trim(),DESCRIPCION:null===e.datosModal.DESCRIPCION?e.datosModal.DESCRIPCION:e.datosModal.DESCRIPCION.trim(),CAPACIDAD:e.datosModal.CAPACIDAD,COLOR:e.datosModal.COLOR,TIPO_RESERVA_ID:e.datosModal.TIPO_RESERVA_ID},3===e.datosModal.TIPO_RESERVA_ID&&(r.ES_INTERNO=e.datosModal.ES_INTERNO),a.n=1,e.$http.post("api/RsUnidadReservableController/addRsUnidadReservable",{data:r});case 1:o=a.v,1===o.code&&(e.obtenerUnidadesReservables(),e.$notify("Agregado","success")),a.n=3;break;case 2:a.p=2,l=a.v,e.$notify(l.error.message,"error");case 3:return a.a(2)}},a,null,[[0,2]])}))()},actualizarUnidadReservable:function(){var e=this;return h()(I()().m(function a(){var r,o,l;return I()().w(function(a){while(1)switch(a.p=a.n){case 0:return a.p=0,r={NOMBRE:e.datosModal.NOMBRE.trim(),DESCRIPCION:null===e.datosModal.DESCRIPCION?e.datosModal.DESCRIPCION:e.datosModal.DESCRIPCION.trim(),TIPO_RESERVA_ID:e.datosModal.TIPO_RESERVA_ID,CAPACIDAD:e.datosModal.CAPACIDAD,COLOR:e.datosModal.COLOR},3===e.datosModal.TIPO_RESERVA_ID&&(r.ES_INTERNO=e.datosModal.ES_INTERNO),a.n=1,e.$http.post("api/RsUnidadReservableController/updateRsUnidadReservable",{id:e.datosModal.ID,params:r});case 1:o=a.v,1===o.code&&(e.obtenerUnidadesReservables(),e.$notify("Actualizado","success")),a.n=3;break;case 2:a.p=2,l=a.v,console.log(l),e.$notify(l.error.message,"error");case 3:return a.a(2)}},a,null,[[0,2]])}))()},eliminarUnidadReservable:function(e){var a=this;return h()(I()().m(function r(){var o,l,n;return I()().w(function(r){while(1)switch(r.p=r.n){case 0:return r.n=1,a.$confirmar("¿Esta Ud. Seguro de Eliminar la Unidad?","warning",!0);case 1:if(o=r.v,!o){r.n=5;break}return r.p=2,e={id:e.ID},r.n=3,a.$http.delete("api/RsUnidadReservableController/deleteRsUnidadReservable",{data:e});case 3:l=r.v,1===l.code?(a.obtenerUnidadesReservables(),a.$notify("Eliminado","success")):a.$notify(l.message,"error"),r.n=5;break;case 4:r.p=4,n=r.v,a.$notify(n.error.message,"error");case 5:return r.a(2)}},r,null,[[2,4]])}))()},obtenerUnidadesReservables:function(){var e=this;return h()(I()().m(function a(){var r;return I()().w(function(a){while(1)switch(a.p=a.n){case 0:return a.p=0,a.n=1,e.$http.get("api/RsUnidadReservableController/getRsUnidadReservable",{params:{tipoReserva:""}});case 1:e.unidadesReservables=a.v,a.n=3;break;case 2:a.p=2,r=a.v,e.$notify(r.error.message,"error");case 3:return a.a(2)}},a,null,[[0,2]])}))()},obtenerTiposReservas:function(){var e=this;return h()(I()().m(function a(){var r,o;return I()().w(function(a){while(1)switch(a.p=a.n){case 0:return a.p=0,a.n=1,e.$http.get("api/RsTipoReservaController/getRsTipoReserva");case 1:r=a.v,r.forEach(function(a){var r={label:a.NOMBRE,value:a.ID};e.tiposReserva.push(r)}),a.n=3;break;case 2:a.p=2,o=a.v,e.$notify(o.error.message,"error");case 3:return a.a(2)}},a,null,[[0,2]])}))()},filtrarUnidadesReservables:function(){var e=this;return h()(I()().m(function a(){var r,o,l;return I()().w(function(a){while(1)switch(a.p=a.n){case 0:return a.p=0,r=e.filtroTipoReserva.join(","),a.n=1,e.$http.get("api/RsUnidadReservableController/getRsUnidadReservable",{params:{tipoReserva:r}});case 1:o=a.v,e.unidadesReservables=o,a.n=3;break;case 2:a.p=2,l=a.v,e.$notify(l.error.message,"error");case 3:return a.a(2)}},a,null,[[0,2]])}))()},cancelarAgregacion:function(){this.limpiarCampos(),this.estadoModal=!1},limpiarCampos:function(){for(var e in this.datosModal)this.datosModal[e]=null;this.v$.$reset()},onResize:function(){var e=window.innerWidth;this.size=e<500?e-16+"px":"100%"}}},_=r(12807);const N=(0,_.A)(k,[["render",p]]);var S=N}}]);