"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[37556],{37556:function(o,e,a){a.r(e),a.d(e,{default:function(){return tt}});var t=a(8445),r=a.n(t),i=a(61758),n=a(58790),l={class:"row q-card q-pa-sm gutter-xs"},s={class:"col-xs-12 col-md-2"},c={class:"col-xs-12 col-md-5"},d={class:"col-xs-12 col-md-2"},u={class:"col column scroll-y relative-position q-mt-lg-sm bg-white"},m={class:"header q-px-sm q-pt-sm"},f={class:"boxBotones"},p={class:"datosSelecionAlumno"},v={class:"fotoAlumno"},g={class:"nombreAlumno"},C={class:"text-bold"},h={class:"nombreTutor"},b={class:"text-bold"},N={class:"totalAlumnos"},P={class:"mensajeRegistro bg-warning mensajeRegistro text-center text-white"},E={class:"text-bold"},k={key:0,class:"totalAlumnos"};function A(o,e){var a=(0,i.g2)("q-select"),t=(0,i.g2)("q-tooltip"),A=(0,i.g2)("q-fab-action"),T=(0,i.g2)("registroCriterios"),y=(0,i.g2)("q-spinner-oval"),R=(0,i.g2)("q-inner-loading"),x=(0,i.g2)("modalCopiaCriterioNotas"),D=(0,i.g2)("sie-vacio"),I=(0,i.g2)("q-btn"),L=(0,i.g2)("sie-usuario"),M=(0,i.g2)("grillaNotas"),S=(0,i.g2)("modalReportes"),O=(0,i.g2)("modalImportExportNotasExcel"),q=(0,i.g2)("q-fab"),_=(0,i.g2)("q-page-sticky"),j=(0,i.g2)("q-page");return(0,i.uX)(),(0,i.Wv)(j,{class:"column"},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",l,[(0,i.Lk)("div",s,[(0,i.bF)(a,{modelValue:o.obFiltro.duracionTaller,"onUpdate:modelValue":e[0]||(e[0]=function(e){return o.obFiltro.duracionTaller=e}),options:o.dataPeriodosTalleres,onSelected:o.cambiarPeriodoTaller,preSelect:o.preSelectPeriodo,"option-label":"DURADES","option-value":"DURACOD",label:o.lblPeriodo},null,8,["modelValue","options","onSelected","preSelect","label"])]),(0,i.Lk)("div",c,[(0,i.bF)(a,{modelValue:o.obFiltro.cursoTaller,"onUpdate:modelValue":e[1]||(e[1]=function(e){return o.obFiltro.cursoTaller=e}),options:o.dataCursoTalleres,onSelected:o.cambiarCursoTaller,preSelect:o.preSelectPeriodo,"option-label":"CURSODES","option-value":"ID_CURSO_PERIODO",label:"Taller"},null,8,["modelValue","options","onSelected","preSelect"])]),(0,i.Lk)("div",d,[(0,i.bF)(a,{modelValue:o.obFiltro.periodo,"onUpdate:modelValue":e[2]||(e[2]=function(e){return o.obFiltro.periodo=e}),options:o.dataPeriodo,onSelected:o.cambiarPeriodo,preSelect:o.preSelectPeriodo,"option-label":"PERIODODES","option-value":"ID_TALLER_PERIODO",label:"Periodo"},null,8,["modelValue","options","onSelected","preSelect"])])]),(0,i.Lk)("div",u,[o.bolMostrarConfigCriterios?((0,i.uX)(),(0,i.CE)(i.FK,{key:0},[o.objPeriodoSelected.ID_TALLER_PERIODO&&o.bolCargarComponentePesosYCriterios?((0,i.uX)(),(0,i.Wv)(T,{key:0,dataTalleres:o.dataCursoTalleres,dataPeridoSelect:o.objPeriodoTallerSelected,dataTallerSelect:o.objCursoTallerSelected,bolRegistroNotas:!0,editarAPartirDelPrograma:o.editarAPartirDelPrograma,arrCriteriosABloquear:o.permisosRegistro.arrCriteriosABloquear,arrCritPorProfe:o.permisosRegistro.arrCritPorProfe,onGuardarCriterios:e[4]||(e[4]=function(e){return o.volverARegistroNotas()})},{botonExta:(0,i.k6)(function(){return[(0,i.bF)(A,{color:"secondary",icon:"undo",onClick:e[3]||(e[3]=function(e){return o.volverARegistroNotas()})},{default:(0,i.k6)(function(){return[(0,i.bF)(t,{anchor:"center left",self:"center right"},{default:(0,i.k6)(function(){return[(0,i.eW)((0,n.v_)(o.$t("botones.atras")),1)]}),_:1})]}),_:1})]}),_:1},8,["dataTalleres","dataPeridoSelect","dataTallerSelect","editarAPartirDelPrograma","arrCriteriosABloquear","arrCritPorProfe"])):(0,i.Q3)("v-if",!0)],64)):((0,i.uX)(),(0,i.CE)(i.FK,{key:1},[(0,i.bF)(R,{class:"bg-white",visible:o.cargandoRegistro},{default:(0,i.k6)(function(){return[(0,i.bF)(y,{size:"50px",color:"primary"})]}),_:1},8,["visible"]),(0,i.bF)(R,{class:"loadingGrabandoNotas",visible:o.grabandoRegistro},{default:(0,i.k6)(function(){return[(0,i.bF)(y,{size:"50px",color:"primary"})]}),_:1},8,["visible"]),o.bolModalCopiaNotas?((0,i.uX)(),(0,i.Wv)(x,{key:0,pDataCurso:o.dataCursoTalleres,dataClaseSelect:o.objCursoTallerSelected,periodo:o.objCursoTallerSelected.PERIODO,idPeriodoDestino:o.objPeriodoSelected.ID_TALLER_PERIODO,onCerrarModal:o.cerrarModalCopiaNotas,onProcesoFinalizado:o.procesarCopiaNotas},null,8,["pDataCurso","dataClaseSelect","periodo","idPeriodoDestino","onCerrarModal","onProcesoFinalizado"])):(0,i.Q3)("v-if",!0),0===o.dataRegistroNotas.cabeceraNotas.length?((0,i.uX)(),(0,i.Wv)(D,{key:1,class:"col"})):((0,i.uX)(),(0,i.CE)(i.FK,{key:2},[(0,i.Lk)("div",m,[(0,i.Lk)("div",f,[(0,i.bF)(I,{class:(0,n.C4)(["btn",o.classDirEdit]),round:"",color:"secondary",icon:"text_rotation_none",size:"md",modelValue:o.dirEdit,"onUpdate:modelValue":e[5]||(e[5]=function(e){return o.dirEdit=e}),onClick:o.cambiarDireccionEdicion},{default:(0,i.k6)(function(){return[(0,i.bF)(t,{anchor:"center left",self:"center right"},{default:(0,i.k6)(function(){return[(0,i.eW)((0,n.v_)(o.$t("registroDeNotas.direccionDeEdicion")),1)]}),_:1})]}),_:1},8,["modelValue","onClick","class"]),(0,i.bF)(I,{class:"btn q-ma-xs-sm",round:"",color:"secondary",icon:o.visualizarComentario?"comment":"comment_off",size:"md",modelValue:o.visualizarComentario,"onUpdate:modelValue":e[6]||(e[6]=function(e){return o.visualizarComentario=e}),onClick:e[7]||(e[7]=function(e){return o.visualizarComentario=!o.visualizarComentario})},{default:(0,i.k6)(function(){return[(0,i.bF)(t,{anchor:"center left",self:"center right"},{default:(0,i.k6)(function(){return[(0,i.eW)((0,n.v_)(o.$t("comentarios")),1)]}),_:1})]}),_:1},8,["icon","modelValue"]),o.permisosRegistro.verHistorial?((0,i.uX)(),(0,i.Wv)(I,{key:0,class:"btn q-ma-xs-sm",round:"",color:"secondary",icon:o.visualizarHistorial?"view_history":"view_history_off",size:"md",modelValue:o.visualizarHistorial,"onUpdate:modelValue":e[8]||(e[8]=function(e){return o.visualizarHistorial=e}),onClick:e[9]||(e[9]=function(e){return o.visualizarHistorial=!o.visualizarHistorial})},{default:(0,i.k6)(function(){return[(0,i.bF)(t,{anchor:"center left",self:"center right"},{default:(0,i.k6)(function(){return r()(e[14]||(e[14]=[(0,i.eW)("Historial notas",-1)]))}),_:1})]}),_:1},8,["icon","modelValue"])):(0,i.Q3)("v-if",!0),o.dataRegistroNotas.infoTallerPeriodo.verNotasPeriodoAnterior?((0,i.uX)(),(0,i.Wv)(I,{key:1,class:"btn q-ma-xs-sm",round:"",color:"secondary",icon:o.visualizarNotaAnterior?"Recurso-3":"Recurso-2",size:"md",modelValue:o.visualizarNotaAnterior,"onUpdate:modelValue":e[10]||(e[10]=function(e){return o.visualizarNotaAnterior=e}),onClick:e[11]||(e[11]=function(e){return o.visualizarNotaAnterior=!o.visualizarNotaAnterior})},{default:(0,i.k6)(function(){return[(0,i.bF)(t,{anchor:"center left",self:"center right"},{default:(0,i.k6)(function(){return r()(e[15]||(e[15]=[(0,i.eW)("Ver Notas del Periodo Anterior",-1)]))}),_:1})]}),_:1},8,["icon","modelValue"])):(0,i.Q3)("v-if",!0),o.permisosRegistro.refrescarRegistro?((0,i.uX)(),(0,i.Wv)(I,{key:2,class:"btn q-ma-xs-sm",round:"",color:"secondary",icon:"refresh",size:"md",onClick:o.refrescarRegistro},{default:(0,i.k6)(function(){return[(0,i.bF)(t,{anchor:"center left",self:"center right"},{default:(0,i.k6)(function(){return r()(e[16]||(e[16]=[(0,i.eW)("Refrescar Registro",-1)]))}),_:1})]}),_:1},8,["onClick"])):(0,i.Q3)("v-if",!0)]),(0,i.Lk)("div",p,[(0,i.Lk)("div",v,[(0,i.bF)(L,{class:"sie-usuario-xl",alucod:o.alumnoSelecionado.alucod+"",debounce:250},null,8,["alucod"])]),(0,i.Lk)("ul",null,[(0,i.Lk)("li",g,[(0,i.Lk)("span",C,(0,n.v_)(o.$t("estudiante"))+":",1),(0,i.Lk)("span",null,(0,n.v_)(o.alumnoSelecionado.nomcomp),1)]),(0,i.Lk)("li",h,[(0,i.Lk)("span",b,(0,n.v_)(o.$t("profesor"))+":",1),(0,i.Lk)("span",null,(0,n.v_)(o.profesorClase),1)]),(0,i.Lk)("li",N,[e[17]||(e[17]=(0,i.Lk)("span",{class:"text-bold"},"Total de Alumnos:",-1)),(0,i.Lk)("span",null,(0,n.v_)(o.dataRegistroNotas.alumnos.length),1)]),(0,i.Lk)("li",P,[(0,i.Lk)("span",E,(0,n.v_)(o.permisosRegistro.mensajeRegistro),1)]),o.dataRegistroNotas.infoTallerPeriodo["muestraUltimaActualizacion"]?((0,i.uX)(),(0,i.CE)("li",k,[e[18]||(e[18]=(0,i.Lk)("span",{class:"text-bold"},"Ultima Modificación:",-1)),(0,i.Lk)("span",null,(0,n.v_)(o.ultimaModificacion),1)])):(0,i.Q3)("v-if",!0)])])]),(0,i.bF)(M,{ref:"refRegistroNotas",dataRegistro:o.dataRegistroNotas,editarComentarios:o.permisosRegistro.editarComentarios,visualizarHistorial:o.visualizarHistorial,visualizarNotaAnterior:o.visualizarNotaAnterior,visualizarComentario:o.visualizarComentario,direccionEdicion:o.dirEdit,dataAlumnos:o.dataCboAlumno,visualizarRubrica:o.permisosRegistro.verRubrica,hasTallerNuevo:o.hasTallerNuevo,onFilaAlumnoSelecionado:o.filaAlumnoSelecionado,onGuardarNotasModalRevisar:o.guardarNotasModalRevisar},null,8,["dataRegistro","editarComentarios","visualizarHistorial","visualizarNotaAnterior","visualizarComentario","direccionEdicion","dataAlumnos","visualizarRubrica","hasTallerNuevo","onFilaAlumnoSelecionado","onGuardarNotasModalRevisar"]),o.bolModalReporte?((0,i.uX)(),(0,i.Wv)(S,{key:0,idTallerPeriodo:o.objPeriodoSelected.ID_TALLER_PERIODO,idContenido:o.objPeriodoSelected.ID_CONTENIDO,infoTallerPeriodo:o.dataRegistroNotas.infoTallerPeriodo,verInforme:o.permisosRegistro.verInformeAcademico,dataAlumno:o.dataCboAlumno,onCerrarModal:o.cerrarModalReportes},null,8,["idTallerPeriodo","idContenido","infoTallerPeriodo","verInforme","dataAlumno","onCerrarModal"])):(0,i.Q3)("v-if",!0),(0,i.bF)(O,{modelValue:o.bolModalImportExportNotasExcel,"onUpdate:modelValue":e[12]||(e[12]=function(e){return o.bolModalImportExportNotasExcel=e}),datos:o.permisosRegistro.importExport,editarNotas:o.permisosRegistro.editarNotas,idTallerPeriodo:o.objPeriodoSelected.ID_TALLER_PERIODO,idContenido:o.objPeriodoSelected.ID_CONTENIDO,onResult:o.resultImportacionNotasExcel},null,8,["modelValue","datos","editarNotas","idTallerPeriodo","idContenido","onResult"]),(0,i.bF)(_,{position:"bottom-right",offset:[10,10]},{default:(0,i.k6)(function(){return[(0,i.bF)(q,{icon:"more_vert",direction:"up",color:"secondary"},{default:(0,i.k6)(function(){return[(o.permisosRegistro.importExport["notas"]||o.permisosRegistro.importExport["comentarios"])&&o.permisosRegistro.editarNotas?((0,i.uX)(),(0,i.Wv)(A,{key:0,color:"secondary",icon:"import_export_excel_new",onClick:o.abrirModalImportExportNotasExcel},{default:(0,i.k6)(function(){return[(0,i.bF)(t,{anchor:"center left",self:"center right"},{default:(0,i.k6)(function(){return[(0,i.eW)((0,n.v_)(o.$t("botones.importarExportar")),1)]}),_:1})]}),_:1},8,["onClick"])):(0,i.Q3)("v-if",!0),(0,i.bF)(A,{color:"secondary",icon:"printer",onClick:o.abrirModalReportes},{default:(0,i.k6)(function(){return[(0,i.bF)(t,{anchor:"center left",self:"center right"},{default:(0,i.k6)(function(){return[(0,i.eW)((0,n.v_)(o.$t("botones.imprimir")),1)]}),_:1})]}),_:1},8,["onClick"]),o.permisosRegistro.editarNotas?((0,i.uX)(),(0,i.Wv)(A,{key:1,color:"secondary",icon:"pesos_criterios",onClick:o.configurarEvaluaciones},{default:(0,i.k6)(function(){return[(0,i.bF)(t,{anchor:"center left",self:"center right"},{default:(0,i.k6)(function(){return[(0,i.eW)((0,n.v_)(o.$t("registroDeNotas.pesosYCriterios")),1)]}),_:1})]}),_:1},8,["onClick"])):(0,i.Q3)("v-if",!0),o.permisosRegistro.editarNotas?((0,i.uX)(),(0,i.Wv)(A,{key:2,color:"secondary",icon:"save",onClick:o.guardarNotas},{default:(0,i.k6)(function(){return[(0,i.bF)(t,{anchor:"center left",self:"center right"},{default:(0,i.k6)(function(){return[(0,i.eW)((0,n.v_)(o.$t("botones.guardar")),1)]}),_:1})]}),_:1},8,["onClick"])):(0,i.Q3)("v-if",!0),o.permisosRegistro.recalcularNotas?((0,i.uX)(),(0,i.Wv)(A,{key:3,color:"secondary",icon:"calculator",onClick:e[13]||(e[13]=function(e){return o.recalcularNotas(o.dataRegistroNotas.infoTallerPeriodo)})},{default:(0,i.k6)(function(){return[(0,i.bF)(t,{anchor:"center left",self:"center right"},{default:(0,i.k6)(function(){return r()(e[19]||(e[19]=[(0,i.eW)("Recálculo",-1)]))}),_:1})]}),_:1})):(0,i.Q3)("v-if",!0)]}),_:1})]}),_:1})],64))],64))])]}),_:1})}var T=a(14794),y=a.n(T),R=a(76080),x=a.n(R),D=a(45254),I=a.n(D),L=(a(12563),a(74260),a(23825),a(10239),a(50310),a(32203),a(90095),a(83190),a(27153),a(66307),a(13715),a(24066),a(6123)),M=(a(515),a(29104)),S={class:"col column"},O={class:"q-px-sm q-pt-sm"},q={class:"barraPorcentaje"},_={class:"textoPorcentaje text-black"},j={class:"column col relative-position scroll-y"},V={class:"q-px-sm q-pt-sm column boxRegistro"},F={class:"contentRegistro column",ref:"contentRegistro"},$={class:"head"},w={class:"headAlumno"},B={class:"headNotas"},H={class:"relative-position",ref:"headNotas"},z={class:"bodyAlumno"},U={class:"relative-position",ref:"bodyAlumno"},X=["r","onClick"],Q={key:0,class:"banderaComentarioCurso iconRevisar"},W=["onClick"],K=["onClick"],G={class:"textDatosAlumno"},Y={class:"bodyNotas",ref:"bodyNotas"},Z={class:"relative-position"},J=["r"],oo=["onClick","c","r"],eo=["onClick"],ao=["onClick"],to={key:0,class:"footerNotas"},ro={class:"boxLeyenda"},io={class:"boxCeldaAlumno text-right"},no={class:"text-secondary text-right"},lo={class:"boxLeyenda"},so={class:"boxCelda text-primary text-right"},co={key:0,class:"boxLeyenda"},uo={key:1,class:"boxLeyenda"};function mo(o,e){var a=(0,i.g2)("headNotas"),t=(0,i.g2)("q-icon"),l=(0,i.g2)("imgEstdoAlumno"),s=(0,i.g2)("tdNota"),c=(0,i.g2)("modalComentarioCurso"),d=(0,i.g2)("modalComentarioNota"),u=(0,i.g2)("modalHistorialNotas"),m=(0,i.g2)("modalRevisar");return(0,i.uX)(),(0,i.CE)("div",S,[(0,i.Lk)("div",O,[(0,i.Lk)("div",q,[(0,i.Lk)("div",{class:"porcentajeBg bg-secondary",style:(0,n.Tr)({width:o.porcentaje+"%"})},null,4),(0,i.Lk)("div",_,"Registro Completado al "+(0,n.v_)(o.porcentaje)+" %",1)])]),(0,i.Lk)("div",j,[(0,i.Lk)("div",V,[(0,i.Lk)("div",F,[(0,i.Lk)("div",$,[(0,i.Lk)("div",w,[e[0]||(e[0]=(0,i.Lk)("div",{class:"thAlumno boxImgEstado"},null,-1)),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(o.cabeceraAlumno,function(o){return(0,i.uX)(),(0,i.CE)("div",{class:(0,n.C4)(["thAlumno",o.classCss])},[(0,i.Lk)("span",null,(0,n.v_)(o.desc),1)],2)}),256))]),(0,i.Lk)("div",B,[(0,i.Lk)("div",H,[(0,i.bF)(a,{maxNivel:o.maxNivel,cabeceraNotas:o.cabeceraNotas,objKeysCabecera:o.objKeysCabecera,ocultarPB:o.ocultarPB,onDropNota:o.dropNota},null,8,["maxNivel","cabeceraNotas","objKeysCabecera","ocultarPB","onDropNota"])],512)])]),(0,i.bo)((0,i.Lk)("div",{class:(0,n.C4)(["body",{visualizarComentario:o.visualizarComentario,visualizarHistorial:o.visualizarHistorial}])},[(0,i.Lk)("div",z,[(0,i.Lk)("div",U,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(o.alumnos,function(e,a){return(0,i.uX)(),(0,i.CE)("div",{class:(0,n.C4)(["tr",[e.classEstado,{resaltarClase:e.datos.flResaltar,revisarClase:e.datos.flRevisar,alumnoInclusivo:!1}]]),r:a,onClick:function(t){return o.abrirModalRevisarClase(e,a)}},[e.datos.flRevisar?((0,i.uX)(),(0,i.CE)("div",Q,[(0,i.bF)(t,{name:"warning",size:"2em"})])):(0,i.Q3)("v-if",!0),(0,i.bF)(l,{class:"td boxImgEstado",estadoAnual:e.datos.estadoAnual,objNotaPromedio:e.objNotaPromedio,configNotaPromedio:o.vistaEstadistica?{}:o.configNotaPromedio.config},null,8,["estadoAnual","objNotaPromedio","configNotaPromedio"]),(0,i.Lk)("div",{class:"comentario text-secondary",onClick:function(a){return o.abrirModalComentarioCurso(e.datos,o.itemPromedioCurso)}},[(0,i.bF)(t,{name:"comment",size:"1.5rem"})],8,W),(0,i.Lk)("div",{class:(0,n.C4)(["banderaComentarioCurso text-secondary",{existeComentario:o.showBanderaComentarioCurso(e.datos.alucod)}])},[(0,i.bF)(t,{name:"comment",size:"1em"})],2),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(o.cabeceraAlumno,function(t){return(0,i.uX)(),(0,i.CE)("div",{class:(0,n.C4)(["td",t.classCss]),onClick:function(e){return o.clickAlumno(a)}},[(0,i.Lk)("div",G,(0,n.v_)(e.datos[t.key]),1)],10,K)}),256))],10,X)}),256))],512)]),(0,i.Lk)("div",Y,[(0,i.Lk)("div",Z,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(o.alumnos,function(e,a){return(0,i.uX)(),(0,i.CE)("div",{class:(0,n.C4)(["tr",[e.classEstado,{resaltarClase:e.datos.flResaltar,revisarClase:e.datos.flRevisar,alumnoInclusivo:!1}]]),r:a},[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(o.cabeceraNotas,function(r,l){return(0,i.uX)(),(0,i.CE)("div",{key:"k_"+a+"_"+l,class:(0,n.C4)(["td",o.classTd(r,e.datos.idPersona)]),onClick:function(e){return o.clickAlumno(a,l)},c:l,r:a},[r.addConclDescrp&&!r.esPromedioCurso?((0,i.uX)(),(0,i.CE)("div",{key:0,class:"comentario text-primary",onClick:function(a){return o.abrirModalComentarioNota(e.datos,r.idTallerContenido,r.id,r)}},[(0,i.bF)(t,{name:"comment",size:"1.5rem"})],8,eo)):(0,i.Q3)("v-if",!0),(0,i.Lk)("div",{class:(0,n.C4)(["banderaComentarioNota text-primary",{existeComentario:o.existeComentarioNota(r.idTallerContenido,e.datos.idPersona)}])},[(0,i.bF)(t,{name:"comment",size:"1em"})],2),(0,i.Lk)("div",{class:"historial text-primary",onClick:function(a){return o.abrirModalHistorialNotas(e.datos,r)}},[(0,i.bF)(t,{name:"view_history",size:"1.5rem"})],8,ao),(0,i.bF)(s,{ref_for:!0,ref:"refnota_"+a+"_"+l,fila:a,columna:l,objNota:e.notas[r.id],currentComponent:r.component,bloquear:o.bolBloquearNota(r,e),habilitadoInclusivo:o.bolHabilitadoNotaInclusivo(r,e),config:r.config,visualizarNotaAnterior:o.visualizarNotaAnterior,usaNotaAnterior:o.infoTallerPeriodo.verNotasPeriodoAnterior,onSiguienteEdicion:o.siguienteEdicion,onCalcularPromedio:o.calcularPromedio},null,8,["fila","columna","objNota","currentComponent","bloquear","habilitadoInclusivo","config","visualizarNotaAnterior","usaNotaAnterior","onSiguienteEdicion","onCalcularPromedio"])],10,oo)}),128))],10,J)}),256))])],512)],2),[[M.aG,o.alumnos.length]]),o.vistaEstadistica?(0,i.Q3)("v-if",!0):((0,i.uX)(),(0,i.CE)("div",to,[(0,i.Lk)("div",ro,[(0,i.Lk)("span",io,[(0,i.Lk)("span",no,[(0,i.bF)(t,{name:"comment",size:"1em"})])]),e[1]||(e[1]=(0,i.Lk)("span",{class:"text"},"Estudiante con comentario en el curso",-1))]),(0,i.Lk)("div",lo,[(0,i.Lk)("span",so,[(0,i.bF)(t,{name:"comment",size:"1em"})]),e[2]||(e[2]=(0,i.Lk)("span",{class:"text"},"Nota con conclusión descriptiva",-1))]),Object.keys(o.dataObjBgAlertaNotasConclusionesSalon).length>0?((0,i.uX)(),(0,i.CE)("div",co,r()(e[3]||(e[3]=[(0,i.Lk)("span",{class:"boxCelda bgAlertaConcDescriptiva"},null,-1),(0,i.Lk)("span",{class:"text"},"Falta conclusión descriptiva",-1)])))):(0,i.Q3)("v-if",!0),o.infoTallerPeriodo.verNotasPeriodoAnterior?((0,i.uX)(),(0,i.CE)("div",uo,r()(e[4]||(e[4]=[(0,i.Lk)("span",{class:"boxCelda"},[(0,i.Lk)("span",{class:"notaAnteriorMenor"})],-1),(0,i.Lk)("span",{class:"text"},"Nota menor al periodo anterior",-1)])))):(0,i.Q3)("v-if",!0)]))],512)])]),o.bolModalComentarioCurso?((0,i.uX)(),(0,i.Wv)(c,{key:0,idTallerContenido:o.utilComentarioCurso.idTallerContenido,alucod:o.utilComentarioCurso.alucod,idPersona:o.utilComentarioCurso.idPersona,idContenido:o.utilComentarioCurso.idContenido,nomcomp:o.utilComentarioCurso.nomcomp,cursocod:o.utilComentarioCurso.cursocod,bimecod:o.utilComentarioCurso.bimecod,edicion:o.utilComentarioCurso.edicion,dataAlumnos:o.dataAlumnos,onEditarComentarioCurso:o.editarComentarioCurso,onCerrarModal:o.cerrarModalComentarioCurso},null,8,["idTallerContenido","alucod","idPersona","idContenido","nomcomp","cursocod","bimecod","edicion","dataAlumnos","onEditarComentarioCurso","onCerrarModal"])):(0,i.Q3)("v-if",!0),o.bolModalComentarioNota?((0,i.uX)(),(0,i.Wv)(d,{key:1,idPersona:o.utilComentarioNota.idPersona,idContenido:o.utilComentarioNota.idContenido,idTallerContenido:o.utilComentarioNota.idTallerContenido,bolArbolInfo:o.utilComentarioNota.bolArbolInfo,nomcomp:o.utilComentarioNota.nomcomp,edicion:o.utilComentarioNota.edicion,dataAlumnos:o.dataAlumnos,bolUsaDescriptor:o.utilComentarioNota.usaDescriptor,dataDescriptor:o.utilComentarioNota.dataDescriptor,onEditarComentario:o.editarComentarioNota,onCerrarModal:o.cerrarModalComentarioNota},null,8,["idPersona","idContenido","idTallerContenido","bolArbolInfo","nomcomp","edicion","dataAlumnos","bolUsaDescriptor","dataDescriptor","onEditarComentario","onCerrarModal"])):(0,i.Q3)("v-if",!0),o.bolHistorialNotas?((0,i.uX)(),(0,i.Wv)(u,{key:2,tipoFiltro:o.utilHistorialNotas.tipoFiltro,nemo:o.utilHistorialNotas.nemo,cursocod:o.utilHistorialNotas.cursocod,bimecod:o.utilHistorialNotas.bimecod,alucod:o.utilHistorialNotas.alucod,nomcomp:o.utilHistorialNotas.nomcomp,idTallerPeriodo:o.utilHistorialNotas.idTallerPeriodo,iconoPrograma:o.utilHistorialNotas.iconoPrograma,colorPrograma:o.utilHistorialNotas.colorPrograma,evaluaciondesc:o.utilHistorialNotas.evaluaciondesc,idTallerContenido:o.utilHistorialNotas.idTallerContenido,arrIdsTallerContenido:o.utilHistorialNotas.arrIdsTallerContenido,onCerrarModal:o.cerrarModalHistorialNotas},null,8,["tipoFiltro","nemo","cursocod","bimecod","alucod","nomcomp","idTallerPeriodo","iconoPrograma","colorPrograma","evaluaciondesc","idTallerContenido","arrIdsTallerContenido","onCerrarModal"])):(0,i.Q3)("v-if",!0),o.bolRevisarClase?((0,i.uX)(),(0,i.Wv)(m,{key:3,idTallerPeriodo:o.utilRevisarClase.idTallerPeriodo,idCurso:o.utilRevisarClase.idCurso,grupocod:o.utilRevisarClase.grupocod,periodo:o.utilRevisarClase.periodo,objAlumno:o.utilRevisarClase.objAlumno,objKeysCabecera:o.utilRevisarClase.objKeysCabecera,fila:o.utilRevisarClase.fila,onRecalcularInterno:o.recalcularInterno,onCalcularPromedio:o.calcularPromedio,onCerrarModal:o.cerrarModalRevisarClase,onGuardarNotasModalRevisar:o.guardarNotasModalRevisar},null,8,["idTallerPeriodo","idCurso","grupocod","periodo","objAlumno","objKeysCabecera","fila","onRecalcularInterno","onCalcularPromedio","onCerrarModal","onGuardarNotasModalRevisar"])):(0,i.Q3)("v-if",!0)])}a(30683),a(77507),a(89571),a(49089);var fo=a(80660),po={getListaIdsComentariosPorNota:function(o){return fo.$http.get("api/HyoTallercomentario/listaArrIdsComentarios",{params:{idTallerPeriodo:o}}).then(function(o){var e=o.json;return e}).catch(function(){})},bgAlertaConclusiones:function(o,e){return fo.$http.get("api/HyoTallercomentario/bgAlertaConclusiones",{params:{arrTalleres:o,periodo:e}}).then(function(o){var e=o.json;return e}).catch(function(){})},getListaIdsComentariosPorTaller:function(o){return fo.$http.get("api/HyoTallercomentario/listaArrIdsComentariosPb",{params:{idTallerPeriodo:o}}).then(function(o){var e=o.json;return e}).catch(function(){return[]})},getListaIdsComentariosPorTallerNuevo:function(o){return fo.$http.get("api/HyoTallercomentario/listaArrIdsComentariosPbTallerNuevo",{params:{idTallerPeriodo:o}}).then(function(o){var e=o.json;return e}).catch(function(){return[]})}},vo={key:1,class:"textNota"};function go(o,e){return(0,i.uX)(),(0,i.CE)("div",{class:(0,n.C4)(["boxNota",o.classCss]),onClick:e[1]||(e[1]=function(e){return o.clickEdicion()})},[o.isClick?((0,i.uX)(),(0,i.Wv)((0,i.$y)(o.currentComponent),{key:0,modelValue:o.nota,"onUpdate:modelValue":e[0]||(e[0]=function(e){return o.nota=e}),notaIni:o.nota,sinNota:o.config.sinNota,escalaExtraNumeros:o.config.escalaExtraNumeros,sinCalculo:o.config.sinCalculo,usarArrEscala:o.config.usarArrEscala,arrEscala:o.config.notasEscala,configEditor:o.config.configEditor,onBlur:o.blur,onSiguienteEdicion:o.siguienteEdicion,onMountedComponentNota:o.mountedComponentNota},null,40,["modelValue","notaIni","sinNota","escalaExtraNumeros","sinCalculo","usarArrEscala","arrEscala","configEditor","onBlur","onSiguienteEdicion","onMountedComponentNota"])):((0,i.uX)(),(0,i.CE)("span",vo,(0,n.v_)(o.nota),1)),o.classCss.existeNotaAnterior&&o.visualizarNotaAnterior?((0,i.uX)(),(0,i.CE)("span",{key:2,class:(0,n.C4)(["textNotaAnt",o.cssEstadoNotaAnt])},(0,n.v_)(o.objNota.notaPeAnt),3)):(0,i.Q3)("v-if",!0)],2)}a(11777),a(48426),a(15547);var Co={isNumeric:function(o){return!isNaN(o-parseFloat(o))},roundDecimal:function(o,e){var a=Number(Math.round(o+"e"+e)+"e-"+e);return a.toFixed(e)},constCssNota:function(){return{SINNOTA:"sinNota",APROBADO:"aprobado",DESAPROBADO:"desaprobado"}},estadoCssNota:function(o,e){var a=null;if(o.length>0){var t=this.constCssNota();if(e.sinNota===o)a=t.SINNOTA;else{var r=e.valorAprobado;if(e.usarArrEscala)for(var i=0;i<e.notasEscala.length;i++){var n=e.notasEscala[i];if(o===n.nota){a=n.valorCalculo>=r?t.APROBADO:t.DESAPROBADO;break}}else{for(var l=0;l<e.escalaExtraNumeros.length;l++){var s=e.escalaExtraNumeros[l];s.nota===o&&(o=s.valorCalculo)}this.isNumeric(o)&&(a=o>=r?t.APROBADO:t.DESAPROBADO)}}}return a},estadoNotaAntMenorCss:function(o,e,a){var t=!1;if(o.length>0&&e.length>0)if(a.sinNota===o)t=!0;else if(a.usarArrEscala)for(var r=a.notasEscala.find(function(o){return o.nota===e}),i=0;i<a.notasEscala.length;i++){var n=a.notasEscala[i];if(o===n.nota){n.valorCalculo<r.valorCalculo&&(t=!0);break}}else{for(var l=0;l<a.escalaExtraNumeros.length;l++){var s=a.escalaExtraNumeros[l];s.nota===o&&(o=s.valorCalculo)}this.isNumeric(o)&&this.isNumeric(e)&&o<e&&(t=!0)}return t}};function ho(o,e){return(0,i.bo)(((0,i.uX)(),(0,i.CE)("input",{"onUpdate:modelValue":e[0]||(e[0]=function(e){return o.nota=e}),onBlur:e[1]||(e[1]=function(){return o.blur&&o.blur.apply(o,arguments)}),onKeydown:e[2]||(e[2]=function(){return o.keydown&&o.keydown.apply(o,arguments)}),onPaste:e[3]||(e[3]=function(){return o.paste&&o.paste.apply(o,arguments)}),onClick:e[4]||(e[4]=function(){return o.click&&o.click.apply(o,arguments)})},null,544)),[[M.Jo,o.nota]])}var bo=a(32307),No={emits:["mountedComponentNota","update:modelValue","input","siguienteEdicion","blur"],props:{modelValue:{required:!0},notaIni:{required:!0},usarArrEscala:{type:Boolean,required:!0},sinNota:{type:String},escalaExtraNumeros:{type:Array},sinCalculo:{type:Array},arrEscala:{type:Array},configEditor:{type:Object}},data:function(){return{notaInicial:this.notaIni,oldValue:this.notaIni,notaMinIng:this.configEditor.notaMinIng,notaMaxIng:this.configEditor.notaMaxIng,numDecimales:this.configEditor.numDecimales,lengthNotaMax:String(this.configEditor.notaMaxIng).length,cerosDelante:this.configEditor.cerosDelante}},computed:{nota:{get:function(){return this.modelValue},set:function(o){var e=String(o).toUpperCase();this.setNota(e)}}},mounted:function(){this.$el.focus(),this.$el.select(),this.$el.placeholder=this.notaInicial,this.$el.autocomplete="off",this.$emit("mountedComponentNota"),this.notasKeyPress=this.getNotasKeyPress()},methods:{getNotasKeyPress:function(){var o={};o[this.sinNota]={valorCalculo:0,nota:this.sinNota};for(var e=0;e<this.sinCalculo.length;e++){var a=this.sinCalculo[e];o[a]={valorCalculo:0,nota:a}}if(this.usarArrEscala)for(var t=0;t<this.arrEscala.length;t++)for(var r=this.arrEscala[t],i=r.valorCalculo,n=r.notasKey,l=0;l<n.length;l++)o[n[l]]={valorCalculo:i,nota:r.nota};else{for(var s=0;s<this.escalaExtraNumeros.length;s++){var c=this.escalaExtraNumeros[s];o[c.nota]={valorCalculo:c.valorCalculo,nota:c.nota}}for(var d=this.notaMinIng;d<=this.notaMaxIng;d++)if(this.cerosDelante&&(d+"").length<this.lengthNotaMax){var u=(0,bo["default"])(d,this.lengthNotaMax,"0");o[u]={valorCalculo:d,nota:u},o[d]={valorCalculo:d,nota:u}}else o[d]={valorCalculo:d,nota:d}}return o},click:function(o){o.stopPropagation()},emitirNota:function(o){this.$emit("update:modelValue",o),this.$emit("input",o),this.$emit("siguienteEdicion")},setNota:function(o,e){var a=this.numDecimales,t=a>0,r=this.notasKeyPress,i=0,n=!1;for(var l in r)if(0===l.lastIndexOf(o,0)&&i++,o===l&&(n=!0),i>1&&n)break;if(t&&n&&Co.isNumeric(o))if(o.indexOf(".")>=0){var s=o.split(".").pop();if(s.length<a){for(var c=0;c<=9;c++)r[o+c]={nota:o+c};i=2}}else o.length<=this.lengthNotaMax&&(r[o+"."]={nota:o+"."},i=2);if(e)if(n){var d=r[o].nota;this.emitirNota(this.getNotaEmitFormat(t,d))}else this.emitirNota(this.notaInicial);else if(i>0){var u=i>1;if(n&&!u){var m=r[o].nota;this.emitirNota(this.getNotaEmitFormat(t,m))}else this.$el.value=o}else this.$el.value=this.oldValue},getNotaEmitFormat:function(o,e){if(o&&Co.isNumeric(e)){var a=parseFloat(e).toFixed(this.numDecimales);return this.cerosDelante&&(a=(0,bo["default"])(a,this.lengthNotaMax+this.numDecimales+1,"0")),a}return e},keydown:function(o){27===o.keyCode?this.blur():8===o.keyCode?this.oldValue="":46===o.keyCode?this.emitirNota(""):13===o.keyCode?this.setNota(this.$el.value,!0):this.oldValue=this.$el.value},paste:function(o){o.preventDefault()},blur:function(){this.$emit("blur")}}},Po=a(12807);const Eo=(0,Po.A)(No,[["render",ho]]);var ko=Eo,Ao={emits:["calcularPromedio","siguienteEdicion"],components:{inputNota:ko},props:{fila:Number,columna:Number,currentComponent:String,bloquear:Boolean,habilitadoInclusivo:Boolean,config:Object,visualizarNotaAnterior:Boolean,usaNotaAnterior:Boolean,objNota:{required:!0,type:Object,validator:function(o){return Object.prototype.hasOwnProperty.call(o,"notaReg")&&Object.prototype.hasOwnProperty.call(o,"notaIni")}}},data:function(){return{isClick:!1,cbMountedNota:null}},computed:{nota:{get:function(){return String(this.objNota.notaReg)},set:function(o){this.objNota.notaReg=String(o),this.$emit("calcularPromedio",this.fila,this.objNota)}},classCss:function(){var o=this.objNota.notaReg!==this.objNota.notaIni,e={modificado:o,bloqueada:this.bloquear,bloqueoInclusivo:!1};if(this.usaNotaAnterior&&null!==this.objNota.notaPeAnt){var a=Co.estadoNotaAntMenorCss(this.nota,this.objNota.notaPeAnt,this.config);e.existeNotaAnterior=!!this.visualizarNotaAnterior&&a,e.flNotaAnteriorMenor=a}return this.config.configEditor.aplicarColor&&(e=Object.assign(e,this.estadoCss(this.nota,this.config))),e},cssEstadoNotaAnt:function(){var o={};return this.visualizarNotaAnterior&&Object.keys(this.config).length>0&&this.config.configEditor.aplicarColor&&(o=Object.assign(o,this.estadoCss(this.objNota.notaPeAnt,this.config))),o}},methods:{estadoCss:function(o,e){var a={},t=Co.constCssNota(),r=Co.estadoCssNota(o,e);switch(r){case t.APROBADO:a.aprobado=!0;break;case t.DESAPROBADO:a.desaprobado=!0;break}return a},mountedComponentNota:function(){this.cbMountedNota&&(this.cbMountedNota(),this.cbMountedNota=null)},clickEdicion:function(o,e){this.bloquear?o&&this.siguienteEdicion():(this.isClick=!0,e&&(this.cbMountedNota=e))},blur:function(){this.isClick=!1},siguienteEdicion:function(){this.$emit("siguienteEdicion",this.fila,this.columna)}}};const To=(0,Po.A)(Ao,[["render",go]]);var yo=To,Ro=["title"];function xo(o,e){return(0,i.uX)(),(0,i.CE)("div",null,[(0,i.Lk)("div",{class:(0,n.C4)(["estadoNotaAlumno",o.estadoRenderer.classCss]),title:o.estadoRenderer.title},null,10,Ro)])}var Do={props:{estadoAnual:{type:String,required:!0},objNotaPromedio:{type:Object,required:!0},configNotaPromedio:{type:Object,required:!0}},data:function(){return{}},computed:{estadoRenderer:function(){var o=this.estadoAnual,e=Object.prototype.hasOwnProperty.call(this.objNotaPromedio,"notaReg")?this.objNotaPromedio.notaReg:"",a={J:{classCss:"DesaprobadoAnual",title:"Desaprobado."},M:{classCss:"EvaluacionPostergada",title:"Evaluacion Postergada"},P:{classCss:"Aprobado",title:"Aprobado"},R:{classCss:"Retirado",title:"Retirado"},E:{classCss:"Exonerado",title:"Exonerado"},T:{classCss:"Trasladado",title:"Trasladado"},F:{classCss:"Fallecido",title:"Fallecido"},SinNota:{classCss:"SinNota",title:"Sin Nota"},Aprobado:{classCss:"Aprobado",title:"Aprobado"},Desaprobado:{classCss:"Desaprobado",title:"Desaprobado"},porDefecto:{classCss:"Vigente",title:"Vigente"}},t={};if(t=a.hasOwnProperty(o)?a[o]:a["porDefecto"],String(e).length>0){var r=Co.constCssNota(),i=Co.estadoCssNota(e,this.configNotaPromedio);switch(i){case r.SINNOTA:t=a["SinNota"];break;case r.APROBADO:t=a["Aprobado"];break;case r.DESAPROBADO:t=a["Desaprobado"];break}}return t}}};const Io=(0,Po.A)(Do,[["render",xo]]);var Lo=Io,Mo={filaColSiguienteEdicion:function(o,e,a,t,r){var i,n,l=0,s=0;switch(a){case"HI":e===s?(n=r,i=o===t?l:o+1):(i=o,n=e-1);break;case"HD":e===r?(n=s,i=o===t?l:o+1):(i=o,n=e+1);break;case"VI":case"VD":default:o===t?(i=l,n="VI"===a?e===s?r:e-1:e===r?s:e+1):(i=o+1,n=e);break}return{sigFila:i,sigCol:n}},obtenerPorcentaje:function(o,e){for(var a,t=0,r=0,i=0;i<o.length;i++)if(!o[i].datos.flBloqEst)for(var n=!1,l=0;l<e.length;l++){var s=e[l].nivelEva<=1||n&&2!==e[l].inclusivo||!n&&1!==e[l].inclusivo;e[l].incluirPorcentaje&&s&&(t++,o[i].notas[e[l].id].notaReg.length&&r++)}return a=0===t?0:100*r/t,Math.round(100*a)/100}},So=(a(71225),a(39866),a(52133),a(5962),a(6724),a(97772),a(52776),a(84433),a(62692),{LETRAS:0,NUMEROENTERO:1,DECIMAL:2});function Oo(o,e,a){var t=e-String(o).length+1;return Array(t>0?t:0).join(a||"0")+o}function qo(o,e){var a=Number(Math.round(o+"e"+e)+"e-"+e);return a.toFixed(e)}function _o(o){return!isNaN(o-parseFloat(o))}function jo(o,e,a,t){if(e<=0)return"";var r,i=o/e,n=t.tipoCalculo,l=t.truncar,s=t.fraccionRedondeoEntero,c=t.numDecimales,d=t.puntosExtrasNum,u=String(i);switch(n){case So.LETRAS:var m;if(l)m=Math.floor(u);else{var f=Math.max(String(s).length,2),p=parseInt(qo(u,f).split(".").pop(),10);m=p>=s*Math.pow(10,f)?Math.ceil(u):Math.floor(u)}r="";for(var v=0;v<t.notasEscala.length;v++){var g=t.notasEscala[v];if(g.valorCalculo===m){r=g.nota;break}}break;case So.NUMEROENTERO:if(l)r=Math.floor(u);else{var C=Math.max(String(s).length,2),h=parseInt(qo(u,C).split(".").pop(),10);r=h>=s*Math.pow(10,C)?Math.ceil(u):Math.floor(u)}r=Number(r)+a+d;break;case So.DECIMAL:if(l){var b=u.split(".");if(b.length>1){var N=b[1];r=N.length>=c?String(b[0])+"."+String(b[1].substring(0,c)):Number(u).toFixed(c)}else r=Number(u).toFixed(c)}else r=qo(u,c);r=Number(Number(r)+a+d).toFixed(c);break}return Vo(r,t)}function Vo(o,e){var a=e.tipoCalculo,t=e.notaMin,r=e.notaMax,i=e.esPromedioSumativo,n=e.configEditor,l=e.numDecimales;switch(a){case So.LETRAS:break;case So.NUMEROENTERO:case So.DECIMAL:if(!i&&_o(o)&&(o<t?o=t:o>r&&(o=r),n.cerosDelante)){var s=String(r).length;a===So.DECIMAL&&(o=Number(o).toFixed(l),s=s+l+1),o=Oo(o,s,"0")}break}return o+""}function Fo(o,e){_o(o)&&(o=parseInt(o,10));var a="";for(var t in e)if(o>=parseInt(e[t].notaIni,10)&&o<=parseInt(e[t].notaFin,10)){a=t;break}return a}var $o={getFormatoNota:function(o,e){return Vo(o,e)},calcularPromedioAlumno:function(o,e,a){var t=a[e];if(!t.config.excluirCalculo&&t.idpadre in a){var r=a[t.idpadre],i=r.config,n=i.esPromedioSumativo,l="";if(!i.promedioCalculado)return;var s=[];if(r.idsHijos.forEach(function(o){var e=a[o];e.esAgrupador?e.config.excluirCalculo||(s=s.concat(e.idsHijos)):s.push(o)}),s.length>0&&!0===i.calcularSoloUltimoHijo){var c=s.pop();s=[c]}for(var d,u=s,m=0,f=0,p=0,v=0,g=!1,C=!1,h="",b=!1,N=0;N<u.length;N++){var P=a[u[N]].config;if(!P.excluirCalculo){var E=String(o[u[N]].notaReg);if(0!==E.length){if(P.esPromedioSumativo&&i.usarArrEscala){b=!0;break}if(P.sinNota===E){g=!0;break}if(0===m&&P.sinCalculo.indexOf(E)>=0){C=!0,h=E;break}if(-1===P.sinCalculo.indexOf(E)){var k=parseInt(P.peso,10);if(P.usarArrEscala){for(var A=!1,T=0;T<P.notasEscala.length;T++){var y=P.notasEscala[T];if(y.nota===E){A=!0,f+=y.valorCalculo*k,v+=k;break}}if(!A){b=!0;break}}else if(P.esBonificacion)_o(E)?p+=Number(E):b=!0;else{for(var R=0;R<P.escalaExtraNumeros.length;R++){var x=P.escalaExtraNumeros[R];x.nota===E&&(E=x.valorCalculo)}_o(E)?(f+=E*k,v+=k):b=!0}}}}}if(r.esAgrupador&&!t.config.esCalculoParticularPRG||b?d="":g?d=i.sinNota:C?d=h:(n&&f>0&&(v=1),d=jo(f,v,p,i)),o[r.id].notaReg=d,""!==l&&2==t.nivelEva){var D="";if(d.length>0){var I=a[l].config.equiNotaPrevista;D=Fo(d,I)}o[l].notaReg=D}this.calcularPromedioAlumno(o,r.id,a)}},esNotaValidaParaImportar:function(o,e){var a=o.config,t=!1;if(""===e||a.sinNota===e||a.sinCalculo.indexOf(e)>=0)t=!0;else if(a.usarArrEscala){for(var r=!1,i=0;i<a.notasEscala.length;i++){var n=a.notasEscala[i];if(n.nota===e){r=!0;break}}t=r}else{for(var l=0;l<a.escalaExtraNumeros.length;l++){var s=a.escalaExtraNumeros[l];s.nota===e&&(e=s.valorCalculo)}_o(e)&&e>=a.notaMin&&e<=a.notaMax&&(t=!0)}return t},getNotaTarea:function(o,e,a,t,r,i,n){var l=a.usarArrEscala,s=a.notasEscala,c=a.notaMin,d=a.notaMax,u=c;if(null===e||""===e||0===e)return{nota:"",notaRegistro:"",nuevaNota:"",idError:1,msgError:"El puntaje maximo debe ser mayor a 0"};var m=/^[0-9]+$/.test(o),f={},p=null,v=m?100*o/e:0;v=Math.round(v);var g=[];if(t&&Array.isArray(t)){if(s&&s.length){var C=s.map(function(o){return o.nota});g=t.filter(function(o){return!C.includes(o.LETRA)}),g=g.map(function(o){return o.LETRA}),t=t.filter(function(o){return C.includes(o.LETRA)})}for(var h=0;h<t.length;h++)f[t[h].LETRA]=t[h],v<=t[h].PORCENTAJE&&(p=t[h].LETRA)}if(2==n&&r&&r.length>0){var b={1:"C",2:"B",3:"A",4:"AD"},N="",P=null,E=r.length-1;u=r[E].NOTA,P=/^[0-9]+$/.test(u)?jo(u,1,0,a):u;var k=Math.trunc(4*u/20);p=/^[0-9]+$/.test(u)?b[k]:u;for(var A=E;A>=0;A--){if(!(o>=r[A].NRO_CRITERIOS_ALCANZADO))break;N=r[A].TITULO_NIVEL,u=r[A].NOTA,P=/^[0-9]+$/.test(u)?jo(u,1,0,a):u;var T=Math.trunc(4*u/20);p=/^[0-9]+$/.test(u)?b[T]:u}return{porcentaje:v,notaLetra:p,nivel:N,nota:u,notaRegistro:P}}for(var y="",R=0;R<r.length;R++){if(!(v<=r[R].NRO_CRITERIOS_ALCANZADO))break;y=r[R].TITULO_NIVEL}if(0!=c&&!c&&!d){var x=20*o/e,D=x%1===0?x:x.toFixed(2);return{porcentaje:v,notaLetra:p,nivel:y,nota:x,notaRegistro:D}}if(l){var I=s.find(function(o){return o.valorCalculo===d}),L=I.nota,M=s.find(function(o){return o.valorCalculo===c}),S=M.nota;if((!f.hasOwnProperty(L)||!f.hasOwnProperty(S))&&2!==i)return console.error("".concat(S," y  ").concat(L," no estan definidos en las equivalencias de la rúbrica")),{porcentaje:v,notaLetra:p,nivel:y,notaRegistro:"",idError:1,msgError:"".concat(S," y  ").concat(L," no estan definidos en las equivalencias de la rúbrica")};if(![2,7].includes(i)){if(null===p){var O=g.length>0?g.join(",")+" No se usa en este registro. Verifique la configuración de equivalencias":"",q=g.length>0?O:"Falta configurar la equivalencia para un alcance al ".concat(v,"%  de la rúbrica");return{porcentaje:v,notaLetra:p,nivel:y,notaRegistro:"",idError:1,msgError:q}}var _=s.find(function(o){return o.nota==p}),j=_.valorCalculo;return{porcentaje:v,notaLetra:p,nivel:y,nota:j,notaRegistro:p}}if(!m){var V=s.find(function(e){return e.nota==o}),F=V.valorCalculo;return p=o,{porcentaje:v,notaLetra:p,nivel:y,nota:F,notaRegistro:o}}}u=o*d/e;var $=jo(u,1,0,a);return{porcentaje:v,notaLetra:p,nivel:y,nota:u,notaRegistro:$}}},wo=(a(24985),{class:"tablaCabecera"}),Bo=["rowspan","colspan","onClick"],Ho={class:"textTh"},zo=["onDrop"],Uo=["rowspan","onClick"],Xo={class:"textThProm"},Qo=["onDrop"];function Wo(o,e){var a=(0,i.g2)("q-icon");return(0,i.uX)(),(0,i.CE)("table",wo,[(0,i.Lk)("thead",null,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(o.maxNivel+1,function(t,r){return(0,i.uX)(),(0,i.CE)("tr",null,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(o.cabeceraNotas,function(t,l){return(0,i.uX)(),(0,i.CE)(i.FK,null,[r==t.nivelEva?(0,i.bo)(((0,i.uX)(),(0,i.CE)("th",{key:0,rowspan:t.rowspan,colspan:t.colspan,class:(0,n.C4)(["bgprograma_"+t.idPrograma,{ocultarPB:o.ocultarPB&&t.esPromedioCurso,flatEvaExcluido:t.config.excluirCalculo,excluirPorc:t.excPorc,inclusivo:!1}]),onClick:function(e){return o.mostrarDetalleCabecera(t,e)},onMouseleave:e[3]||(e[3]=function(){return o.ocultarDetalleCabecera&&o.ocultarDetalleCabecera.apply(o,arguments)})},[(0,i.Lk)("div",Ho,[t.config.esPromedioSumativo?((0,i.uX)(),(0,i.Wv)(a,{key:0,class:"text-primary",name:"functions",size:"1.4em"})):(0,i.Q3)("v-if",!0),t.excPorc&&1===t.nivelEva?((0,i.uX)(),(0,i.Wv)(a,{key:1,name:"grid_off",size:"1.4em"})):(0,i.Q3)("v-if",!0),(0,i.Lk)("span",null,(0,n.v_)(t.desc),1)]),t.bloquear||0!==t.idsHijos.length||t.excPorc?(0,i.Q3)("v-if",!0):((0,i.uX)(),(0,i.CE)("div",{key:0,class:"dropNota",onDragenter:e[0]||(e[0]=(0,M.D$)(function(){return o.dragenter&&o.dragenter.apply(o,arguments)},["stop","prevent"])),onDragleave:e[1]||(e[1]=(0,M.D$)(function(){return o.dragleave&&o.dragleave.apply(o,arguments)},["stop","prevent"])),onDragover:e[2]||(e[2]=(0,M.D$)(function(){return o.dragover&&o.dragover.apply(o,arguments)},["stop","prevent"])),onDrop:(0,M.D$)(function(e){return o.drop(l,e)},["stop","prevent"])},null,40,zo))],42,Bo)),[[M.aG,!t.esPromedioCurso]]):(0,i.Q3)("v-if",!0),r==t.nivelEva+1&&t.idsHijos.length>0||t.esPromedioCurso&&0===o.maxNivel?((0,i.uX)(),(0,i.CE)("th",{key:1,rowspan:o.maxNivel-r+1,class:(0,n.C4)(["bgprograma_"+t.idPrograma,{ocultarPB:o.ocultarPB&&t.esPromedioCurso,notaFixed:t.esPromedioCurso,flatEvaExcluido:t.config.excluirCalculo,excluirPorc:t.excPorc,esAgrupador:t.esAgrupador&&!t.config.esCalculoParticularPRG,inclusivo:!1}]),onClick:function(e){return o.mostrarDetalleCabecera(t,e)},onMouseleave:e[7]||(e[7]=function(){return o.ocultarDetalleCabecera&&o.ocultarDetalleCabecera.apply(o,arguments)})},[(0,i.Lk)("div",Xo,(0,n.v_)(t.descProm),1),t.bloquear?(0,i.Q3)("v-if",!0):((0,i.uX)(),(0,i.CE)("div",{key:0,class:"dropNota",onDragenter:e[4]||(e[4]=(0,M.D$)(function(){return o.dragenter&&o.dragenter.apply(o,arguments)},["stop","prevent"])),onDragleave:e[5]||(e[5]=(0,M.D$)(function(){return o.dragleave&&o.dragleave.apply(o,arguments)},["stop","prevent"])),onDragover:e[6]||(e[6]=(0,M.D$)(function(){return o.dragover&&o.dragover.apply(o,arguments)},["stop","prevent"])),onDrop:(0,M.D$)(function(e){return o.drop(l,e)},["stop","prevent"])},null,40,Qo))],42,Uo)):(0,i.Q3)("v-if",!0)],64)}),256))])}),256))])])}a(81813),a(34993);var Ko={emits:["dropNota"],props:{maxNivel:{type:Number,required:!0},cabeceraNotas:{type:Array,required:!0},objKeysCabecera:{type:Object,required:!0},ocultarPB:{type:Boolean,required:!0}},mounted:function(){this.appendfloatDescripcionEvaluacionRegNotas(),this.appendDropNotaMask()},methods:{appendDropNotaMask:function(){if(!document.getElementById("dropNotaMask")){var o=document.createElement("div");o.id="dropNotaMask",document.querySelector("body").appendChild(o)}},appendfloatDescripcionEvaluacionRegNotas:function(){if(!document.getElementById("floatDescripcionEvaluacionRegNotas")){var o=document.createElement("div");o.id="floatDescripcionEvaluacionRegNotas",document.querySelector("body").appendChild(o)}},getInfoHtmlCabecera:function(o,e){var a=this.objKeysCabecera[o];if(!a.esPromedioCurso){var t=a.info,r=a.config.excluirCalculo?" <b>(Excluido)</b>":"";e.unshift("<b>".concat(t.programa,"</b> (Peso: ").concat(t.peso,")").concat(r," <br> ").concat(t.descComp)),a.idpadre in this.objKeysCabecera&&this.getInfoHtmlCabecera(a.idpadre,e)}},textDescCabecera:function(o){var e=[];return this.getInfoHtmlCabecera(o.id,e),e.join("<br><br>")},mostrarDetalleCabecera:function(o,e){if(!o.esPromedioCurso){var a=document.getElementById("floatDescripcionEvaluacionRegNotas"),t=e.target,r=L.tT.offset,i=r(t),n=i.top+t.clientHeight-5,l=i.left+t.clientWidth-5,s=280,c=this.$parent.$refs["contentRegistro"].clientWidth;l+s>c?(l=i.left-s+5,a.className="right"):a.className="left",a.style.top=n+"px",a.style.left=l+"px",a.style.display="block",a.innerHTML=this.textDescCabecera(o)}},ocultarDetalleCabecera:function(){var o=document.getElementById("floatDescripcionEvaluacionRegNotas");o.innerHTML="",o.style.display="none"},dragenter:function(o){o.dataTransfer.dropEffect="copy";var e=o.target,a=L.tT.offset,t=a(e),r=t.top+o.target.clientHeight+2,i=t.left,n=document.getElementById("dropNotaMask"),l=this.$parent.$refs["bodyNotas"].clientHeight;n.style.top=r+"px",n.style.left=i+"px",n.style.height=l+"px",n.style.display="block",e.classList.add("enter")},dragover:function(o){this.dragenter(o)},dragleave:function(o){var e=o.target,a=document.getElementById("dropNotaMask");a.style.display="none",e.classList.remove("enter")},dragexit:function(o){this.dragleave(o)},drop:function(o,e){this.dragleave(e);var a=e.dataTransfer.getData("text"),t=/\r\n|\r|\n/,r=/\t/,i=a.replace(/(.)?(\r\n|\r|\n)$/,"$1"),n=i.split(t).map(function(o){return o.split(r)});this.$emit("dropNota",o,n)}},beforeDestroy:function(){var o=document.getElementById("dropNotaMask");o&&o.remove();var e=document.getElementById("floatDescripcionEvaluacionRegNotas");e&&e.remove()},components:{QIcon:L.bP}};const Go=(0,Po.A)(Ko,[["render",Wo]]);var Yo=Go,Zo={class:"row q-px-sm q-pt-sm"},Jo={class:"col-xs-12"},oe={class:"q-body-1 q-mb-lg-xs"},ee={class:"row q-px-sm q-pt-sm"},ae={key:0,class:"col-xs-12"},te={class:"col-xs-12"};function re(o,e){var a=(0,i.g2)("sie-select"),t=(0,i.g2)("q-toolbar-title"),r=(0,i.g2)("q-icon"),l=(0,i.g2)("q-input"),s=(0,i.g2)("q-field"),c=(0,i.g2)("sie-modal");return(0,i.uX)(),(0,i.Wv)(c,{class:"modalComentarioNota",modelValue:o.openModal,"onUpdate:modelValue":e[3]||(e[3]=function(e){return o.openModal=e}),title:o.titulo,header:!0,ok:o.okButton,loading:o.loadingModal,onSubmit:o.guardarComentario,footer:o.edicion,onClose:o.cerrarModal},{default:(0,i.k6)(function(){return[(0,i.bF)(t,{class:"toolbar-title q-pt-md q-pb-none no-shadow"},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",null,[(0,i.bF)(a,{type:"outlined",placeholder:"estudiante",modelValue:o.vmEstudiante.idPersona,"onUpdate:modelValue":e[0]||(e[0]=function(e){return o.vmEstudiante.idPersona=e}),options:o.dataAlumnos,onSelected:o.seleccionaEstudiante,label:"nombre",val:"idPersona"},null,8,["modelValue","options","onSelected"])])]}),_:1}),e[4]||(e[4]=(0,i.Lk)("div",{class:"q-item-separator-component"},null,-1)),(0,i.Lk)("div",Zo,[(0,i.Lk)("div",Jo,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(o.infoContenido,function(o,e){return(0,i.uX)(),(0,i.CE)("div",{style:(0,n.Tr)({marginLeft:8*o.NIVEL+"px"})},[(0,i.Lk)("div",oe,[(0,i.bF)(r,{class:"shadow-icon float-left q-mr-sm",name:o.ICONO,style:(0,n.Tr)({color:o.COLOR}),size:"15px"},null,8,["name","style"]),(0,i.Lk)("p",null,(0,n.v_)(o.DESCRIPCION),1)])],4)}),256))])]),(0,i.Lk)("div",ee,[o.mostrarComentario2?((0,i.uX)(),(0,i.CE)("div",ae,[(0,i.bF)(s,{helper:"Caracteres: ",count:o.maxLength2},{default:(0,i.k6)(function(){return[(0,i.bF)(l,{class:"q-if-outlined",modelValue:o.comentario2,"onUpdate:modelValue":e[1]||(e[1]=function(e){return o.comentario2=e}),modelModifiers:{trim:!0},type:"textarea",maxlength:o.maxLength,"float-label":"Avance","max-height":100,rows:"7",disable:!o.edicion},null,8,["modelValue","maxlength","disable"])]}),_:1},8,["count"])])):(0,i.Q3)("v-if",!0),(0,i.Lk)("div",te,[(0,i.bF)(s,{helper:"Caracteres: ",count:o.maxLength},{default:(0,i.k6)(function(){return[(0,i.bF)(l,{class:"q-if-outlined",modelValue:o.comentario,"onUpdate:modelValue":e[2]||(e[2]=function(e){return o.comentario=e}),modelModifiers:{trim:!0},type:"textarea",maxlength:o.maxLength,"float-label":o.titulo,"max-height":100,rows:"7",disable:!o.edicion},null,8,["modelValue","maxlength","float-label","disable"])]}),_:1},8,["count"])])])]}),_:1},8,["modelValue","title","ok","loading","onSubmit","footer","onClose"])}var ie=a(30640),ne={getContenidoInfo:function(o){return fo.$http.get("api/HyoProgramaTallerContenido/info",{params:{idContenido:o}}).then(function(o){var e=o.json;return e})},getComentario:function(o,e){return fo.$http.get("api/HyoTallercomentario/obtComentario",{params:{idPersona:o,idTallerContenido:e}}).then(function(o){var e=o.json;return e})},grabarComentario:function(o,e,a,t){return fo.$http.put("api/HyoTallercomentario/actualizar",{idPersona:o,idTallerContenido:e,comentario:a,comentario2:t}).then(function(o){var e=o.json;return e})}},le=a(982),se=a(93616),ce={emits:["cerrarModal","editarComentario"],components:{sieModal:ie.A,sieSelect:se.A,QToolbarTitle:L.r_,QIcon:L.bP,QField:L.Om,QInput:L.ie},props:{idPersona:{required:!0,type:Number},idContenido:{required:!0,type:Number},bolArbolInfo:{required:!0,type:Boolean},idTallerContenido:{required:!0,type:Number},nomcomp:{required:!0,type:String},edicion:{required:!0,type:Boolean},dataAlumnos:{required:!0,type:Array},bolUsaDescriptor:{required:!0,type:Boolean},dataDescriptor:{required:!0,type:Object}},computed:{okButton:function(){return!(!this.edicion||this.bolUsaDescriptor)&&this.$t("botones.guardar")}},data:function(){return{openModal:!0,loadingModal:!0,comentario:"",maxLength:0,comentario2:"",maxLength2:0,infoContenido:[],titulo:"Conclusión Descriptiva",vmEstudiante:{idPersona:null,nombre:null},mostrarComentario2:!1}},mounted:function(){this.seleccionaEstudiante({idPersona:this.idPersona,nombre:this.nomcomp})},methods:{cerrarModal:function(){this.$emit("cerrarModal")},seleccionaEstudiante:function(o){var e=this;this.vmEstudiante.idPersona=o.idPersona,this.vmEstudiante.nombre=o.nombre;var a=[ne.getContenidoInfo(this.idContenido),ne.getComentario(this.vmEstudiante.idPersona,this.idTallerContenido)];Promise.all(a).then(function(o){e.loadingModal=!1,e.bolUsaDescriptor?e.comentario=e.dataDescriptor[e.vmEstudiante.idPersona][e.idTallerContenido]?e.dataDescriptor[e.vmEstudiante.idPersona][e.idTallerContenido]:"":(e.comentario=o[1].comentario,e.maxLength=o[1].maxLength,e.comentario2=o[1].comentario2,e.maxLength2=o[1].maxLength2,e.mostrarComentario2=o[1].mostrarComentario2),e.bolArbolInfo?e.infoContenido=o[0]:e.infoContenido=o[0].filter(function(o){return o.ID_CONTENIDO===e.idContenido})}).catch(function(){e.loadingModal=!1})},guardarComentario:function(){var o=this;this.loadingModal=!0,ne.grabarComentario(this.vmEstudiante.idPersona,this.idTallerContenido,this.comentario,this.comentario2).then(function(){o.loadingModal=!1,(0,le["default"])(o.$t("mensajes.m0001"));var e=0===String(o.comentario).length;o.$emit("editarComentario",o.vmEstudiante.idPersona,e)}).catch(function(){o.loadingModal=!1,(0,le["default"])(o.$t("mensajes.e0006"),"warning")})}}};const de=(0,Po.A)(ce,[["render",re]]);var ue=de,me={class:"row q-px-sm q-pt-sm"},fe={class:"col-xs-12"};function pe(o,e){var a=(0,i.g2)("sie-select"),t=(0,i.g2)("q-toolbar-title"),r=(0,i.g2)("q-input"),l=(0,i.g2)("q-field"),s=(0,i.g2)("sie-modal");return(0,i.uX)(),(0,i.Wv)(s,{class:(0,n.C4)(["modalComentarioCurso",o.classModal]),modelValue:o.openModal,"onUpdate:modelValue":e[2]||(e[2]=function(e){return o.openModal=e}),title:"Comentario Del Curso",header:!0,ok:o.okButton,loading:o.loadingModal,onSubmit:o.guardarComentario,footer:o.edicion,onClose:o.cerrarModal},{default:(0,i.k6)(function(){return[(0,i.bF)(t,{class:"toolbar-title q-pt-md q-pb-none no-shadow"},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",null,[(0,i.bF)(a,{type:"outlined",placeholder:"estudiante",modelValue:o.vmEstudiante.alucod,"onUpdate:modelValue":e[0]||(e[0]=function(e){return o.vmEstudiante.alucod=e}),options:o.dataAlumnos,onSelected:o.seleccionaEstudiante,label:"nombre",val:"alucod"},null,8,["modelValue","options","onSelected"])])]}),_:1}),(0,i.Lk)("div",me,[(0,i.Lk)("div",fe,[(0,i.bF)(l,{helper:"Caracteres: ",count:o.maxLength},{default:(0,i.k6)(function(){return[(0,i.bF)(r,{class:"q-if-outlined",modelValue:o.comentario,"onUpdate:modelValue":e[1]||(e[1]=function(e){return o.comentario=e}),modelModifiers:{trim:!0},type:"textarea",maxlength:o.maxLength,"float-label":"Comentario de Taller","max-height":100,rows:"7",disable:!o.edicion},null,8,["modelValue","maxlength","disable"])]}),_:1},8,["count"])])])]}),_:1},8,["modelValue","ok","loading","onSubmit","footer","onClose","class"])}var ve={getContenidoInfo:function(o){return fo.$http.get("api/HyoProgramaTallerContenido/info",{params:{idContenido:o}}).then(function(o){var e=o.json;return e})},getComentario:function(o,e){return fo.$http.get("api/HyoTallercomentario/obtComentario",{params:{idPersona:o,idTallerContenido:e}}).then(function(o){var e=o.json;return e})},grabarComentario:function(o,e,a,t){return fo.$http.put("api/HyoTallercomentario/actualizar",{idPersona:o,idTallerContenido:e,comentario:a,comentario2:t}).then(function(o){var e=o.json;return e})}},ge={emits:["cerrarModal","editarComentarioCurso"],components:{sieModal:ie.A,sieSelect:se.A,QCheckbox:L.vZ,QToolbarTitle:L.r_,QField:L.Om,QInput:L.ie},props:{idTallerContenido:{required:!0,type:Number},alucod:{required:!0,type:[String,Number]},idPersona:{required:!0,type:[String,Number]},idContenido:{required:!0,type:Number},cursocod:{required:!0,type:String},bimecod:{required:!0,type:[String,Number]},nomcomp:{required:!0,type:[String,Number]},edicion:{required:!0,type:Boolean},dataAlumnos:{required:!0,type:Array}},data:function(){return{openModal:!0,loadingModal:!0,comentario:"",maxLength:0,mostrarPlantilla:!1,vmEstudiante:{alucod:null,nombre:null,idpersona:null},infoContenido:[],comentarios:[]}},computed:{okButton:function(){return!!this.edicion&&this.$t("botones.guardar")},classModal:function(){return"modal1"},classColComentario:function(){return"col-md-12"}},watch:{},mounted:function(){this.vmEstudiante.alucod=this.alucod,this.vmEstudiante.idPersona=this.idPersona,this.seleccionaEstudiante({alucod:this.alucod,idPersona:this.idPersona})},methods:{cerrarModal:function(){this.$emit("cerrarModal")},seleccionaEstudiante:function(o){var e=this;this.vmEstudiante.nombre=o.nombre,this.vmEstudiante.idPersona=o.idPersona;var a=[ve.getContenidoInfo(this.idContenido),ve.getComentario(o.idPersona,this.idTallerContenido)];Promise.all(a).then(function(o){e.loadingModal=!1,e.comentario=o[1].comentario,e.maxLength=o[1].maxLength,e.bolArbolInfo?e.infoContenido=o[0]:e.infoContenido=o[0].filter(function(o){return o.ID_CONTENIDO===e.idContenido})}).catch(function(){e.loadingModal=!1})},guardarComentario:function(){var o=this;this.loadingModal=!0,ve.grabarComentario(this.vmEstudiante.idPersona,this.idTallerContenido,this.comentario,null).then(function(){o.loadingModal=!1,(0,le["default"])(o.$t("mensajes.m0001"));var e=0===String(o.comentario).length;o.$emit("editarComentarioCurso",o.vmEstudiante.alucod,e)}).catch(function(){o.loadingModal=!1,(0,le["default"])(o.$t("mensajes.e0006"),"warning")})},getObjItems:function(o){var e={};return o.forEach(function(o){e[o.ID]=o.DESCRIPCION}),e}}};const Ce=(0,Po.A)(ge,[["render",pe]]);var he=Ce,be={class:"row q-px-sm"},Ne={class:"col-12"},Pe={class:"row q-px-sm q-pt-sm q-pb-sm"},Ee={class:"col-12"};function ke(o,e){var a=(0,i.g2)("q-toolbar-title"),t=(0,i.g2)("q-icon"),r=(0,i.g2)("q-search"),l=(0,i.g2)("q-table"),s=(0,i.g2)("sie-modal");return(0,i.uX)(),(0,i.Wv)(s,{class:"modal-historial",modelValue:o.openModal,"onUpdate:modelValue":e[1]||(e[1]=function(e){return o.openModal=e}),title:"Historial de notas",header:!0,ok:!1,onClose:o.cerrarModal,loading:o.loadingModal},{default:(0,i.k6)(function(){return[(0,i.bF)(a,{class:"toolbar-title q-pt-md q-pb-none no-shadow"},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",null,(0,n.v_)(o.nomcomp),1)]}),_:1}),e[2]||(e[2]=(0,i.Lk)("div",{class:"q-item-separator-component"},null,-1)),(0,i.Lk)("div",be,[(0,i.Lk)("div",Ne,[(0,i.bF)(t,{class:"shadow-icon float-left q-mr-sm",name:o.iconoPrograma,style:(0,n.Tr)({color:o.colorPrograma}),size:"15px"},null,8,["name","style"]),(0,i.Lk)("p",null,(0,n.v_)(o.evaluaciondesc),1)])]),(0,i.Lk)("div",Pe,[(0,i.Lk)("div",Ee,[(0,i.bF)(l,{style:{height:"57vh"},"row-key":"_id",color:"secondary",data:o.data,columns:o.configTabla.columnas,filter:o.filtroTabla},{"top-left":(0,i.k6)(function(a){return[(0,i.bF)(r,{color:"secondary",modelValue:o.filtroTabla,"onUpdate:modelValue":e[0]||(e[0]=function(e){return o.filtroTabla=e})},null,8,["modelValue"])]}),_:1},8,["data","columns","filter"])])])]}),_:1},8,["modelValue","onClose","loading"])}var Ae=a(30545),Te={listadoPorClaseAlumno:function(o,e){return fo.$http.get("api/HyoAuditoriaTaller/listadoPorClaseAlumno",{params:{alucod:o,idTallerPeriodo:e}}).then(function(o){var e=o.json;return e})},listarNotaEspecifica:function(o,e,a){return fo.$http.get("api/HyoAuditoriaTaller/listarNotaEspecifica",{params:{alucod:o,idTallerPeriodo:e,idTallerContenido:a}}).then(function(o){var e=o.json;return e})}},ye={emits:["cerrarModal"],components:{sieModal:ie.A,QTable:Ae.A,QToolbarTitle:L.r_,QIcon:L.bP,QSearch:L.Ks},props:{tipoFiltro:{required:!0,type:Number},idTallerPeriodo:{required:!0,type:Number},alucod:{required:!0,type:String},nomcomp:{required:!0,type:String},idTallerContenido:{required:!1,type:Number},evaluaciondesc:{required:!1,type:String},iconoPrograma:{required:!1,type:String},colorPrograma:{required:!1,type:String}},data:function(){return{openModal:!0,loadingModal:!0,data:[],configTabla:{},filtroTabla:""}},created:function(){var o,e=this;switch(this.configurarTablaClases(),this.tipoFiltro){case 1:o=Te.listarNotaEspecifica(this.alucod,this.idTallerPeriodo,this.idTallerContenido);break;case 2:o=Te.listadoPorClaseAlumno(this.alucod,this.idTallerPeriodo);break}o.then(function(o){e.data=o,e.loadingModal=!1}).catch(function(){e.loadingModal=!1})},computed:{},methods:{configurarTablaClases:function(){var o=[{name:"usucod",field:"usucod",label:"Usuario",align:"left",sortable:!0},{name:"fecha",field:"fecha",label:"Fecha",align:"left",sortable:!0}];2===this.tipoFiltro&&o.push({name:"evaluaciondesc",field:"evaluaciondesc",label:"Evaluación",align:"left",sortable:!0}),o.push({name:"nota",field:"nota",label:"Nota",align:"center",sortable:!0}),this.configTabla={},this.configTabla.columnas=o},cerrarModal:function(){this.$emit("cerrarModal")}}};const Re=(0,Po.A)(ye,[["render",ke]]);var xe=Re,De={class:"row"},Ie={class:"col"},Le={class:"q-mb-sm"},Me={class:"row"},Se={class:"col"},Oe={class:"row justify-around"},qe={class:"col-xs-12 col-md-11"},_e={class:"row tituloSalon"},je={class:"col"},Ve={class:"col"},Fe={class:"row itemsRevisar"},$e={class:"descPrograma"},we={class:"col-md-1 itemNota"},Be={class:"descPrograma"},He={class:"col-md-1 itemNota"};function ze(o,e){var a=(0,i.g2)("q-spinner-oval"),t=(0,i.g2)("q-inner-loading"),r=(0,i.g2)("tdNota"),l=(0,i.g2)("q-btn"),s=(0,i.g2)("q-toolbar"),c=(0,i.g2)("sie-modal");return(0,i.uX)(),(0,i.Wv)(c,{class:"modal-revisar",modelValue:o.openModal,"onUpdate:modelValue":e[0]||(e[0]=function(e){return o.openModal=e}),title:o.$t("revisarClase"),header:!0,ok:!1,onClose:o.cerrarModal,loading:o.loadingModal},{footer:(0,i.k6)(function(){return[(0,i.bF)(s,{class:"justify-end",color:"grey-2"},{default:(0,i.k6)(function(){return[(0,i.bF)(l,{class:"q-mx-xs",color:"primary",icon:"cog",label:"Regularizar Clase",onClick:o.regularizarClase},null,8,["onClick"])]}),_:1})]}),default:(0,i.k6)(function(){return[(0,i.Lk)("div",De,[(0,i.Lk)("div",Ie,[(0,i.Lk)("blockquote",null,[(0,i.Lk)("p",Le,[e[1]||(e[1]=(0,i.Lk)("b",null,"Estudiante:",-1)),(0,i.Lk)("span",null,(0,n.v_)(o.nomcomp),1)]),e[2]||(e[2]=(0,i.Lk)("p",null,"Al cambiar de salón al estudiante, se encontraron diferencias por ello se necesita regularizar.",-1)),e[3]||(e[3]=(0,i.Lk)("small",null,"Las diferencias pueden ser: indice, peso, criterio excluido o sumativo.",-1))])])]),(0,i.Lk)("div",Me,[(0,i.Lk)("div",Se,[(0,i.bF)(t,{visible:o.loadingNotas},{default:(0,i.k6)(function(){return[(0,i.bF)(a,{size:"50px",color:"primary"}),e[4]||(e[4]=(0,i.Lk)("p",{class:"q-mt-lg text-primary text-weight-bold q-title"},"Recalculando notas",-1))]}),_:1},8,["visible"])])]),(0,i.bo)((0,i.Lk)("div",Oe,[(0,i.Lk)("div",qe,[(0,i.Lk)("div",_e,[e[5]||(e[5]=(0,i.Lk)("div",{class:"div divIgual"},null,-1)),(0,i.Lk)("div",je,"Salón: "+(0,n.v_)(o.objSalon.actual),1),(0,i.Lk)("div",Ve,"Salón: "+(0,n.v_)(o.objSalon.antiguo),1)]),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(o.dataRevisar,function(a){return(0,i.uX)(),(0,i.CE)("div",Fe,[(0,i.Lk)("div",{class:(0,n.C4)(a.FL_REVISAR?"divDiferente":"divIgual")},null,2),a.ID_NOTA_NUEVO?((0,i.uX)(),(0,i.CE)(i.FK,{key:0},[(0,i.Lk)("div",{class:"col",style:(0,n.Tr)({background:a.COLOR})},[(0,i.Lk)("span",$e,(0,n.v_)(a.DESC_PROGRAMA+a.INDICE+":  "),1),(0,i.Lk)("span",null,(0,n.v_)(a.DESCRIPCION_NUEVO),1)],4),(0,i.Lk)("div",we,[(0,i.bF)(r,{ref_for:!0,ref:"refnota_"+o.fila+"_1",fila:o.fila,columna:1,objNota:o.objAlumno.notas[a.ID_CONTENIDO_NUEVO],currentComponent:o.objKeysCabecera[a.ID_CONTENIDO_NUEVO].component,bloquear:o.objKeysCabecera[a.ID_CONTENIDO_NUEVO].bloquear,config:o.objKeysCabecera[a.ID_CONTENIDO_NUEVO].config,onSiguienteEdicion:o.siguienteEdicion,onCalcularPromedio:function(e){return o.calcularPromedio(a.ID_CONTENIDO_NUEVO)}},null,8,["fila","objNota","currentComponent","bloquear","config","onSiguienteEdicion","onCalcularPromedio"])])],64)):((0,i.uX)(),(0,i.CE)(i.FK,{key:1},[e[6]||(e[6]=(0,i.Lk)("div",{class:"col itemNota"},"-",-1)),e[7]||(e[7]=(0,i.Lk)("div",{class:"col-md-1 itemNota"},"-",-1))],64)),a.ID_NOTA_ANTIGUO?((0,i.uX)(),(0,i.CE)(i.FK,{key:2},[(0,i.Lk)("div",{class:"col",style:(0,n.Tr)({background:a.COLOR})},[(0,i.Lk)("span",Be,(0,n.v_)(a.DESC_PROGRAMA+""+a.INDICE+":  "),1),(0,i.Lk)("span",null,(0,n.v_)(a.DESCRIPCION_ANTIGUO),1)],4),(0,i.Lk)("div",He,(0,n.v_)(a.NOTA_ANTIGUO),1)],64)):((0,i.uX)(),(0,i.CE)(i.FK,{key:3},[e[8]||(e[8]=(0,i.Lk)("div",{class:"col itemNota"},"-",-1)),e[9]||(e[9]=(0,i.Lk)("div",{class:"col-md-1 itemNota"},"-",-1))],64))])}),256))])],512),[[M.aG,!o.loadingNotas]])]}),_:1},8,["modelValue","title","onClose","loading"])}var Ue={getRegistrosPorRevisar:function(o,e,a,t,r,i){return fo.$http.get("api/HyoClasePeriodo/obtRegistroPorRevisar",{params:{idCurso:o,grupocod:e,periodo:a,idPersona:t,nemoAct:r,nemoAnt:i}}).then(function(o){var e=o.json;return e})},saveRegularizarClase:function(o,e,a,t,r){return fo.$http.post("api/HyoClaseAlumno/regularizarClase",{idClaseContenidoAnt:o,idClasePeriodo:e,idPersona:a,nemoAct:t,nemoAnt:r}).then(function(o){var e=o.json;return e}).catch(function(o){return o})}},Xe=a(69027),Qe={emits:["recalcularInterno","cerrarModal","siguienteEdicion","calcularPromedio","guardarNotasModalRevisar"],components:{sieModal:ie.A,tdNota:yo,QInnerLoading:L.SQ,QSpinnerOval:L.VA,QToolbar:L.ZV,QBtn:L.Il},props:{idClasePeriodo:[Number],idCurso:[Number],grupocod:String,periodo:[Number],objAlumno:{},objKeysCabecera:{},fila:[Number]},data:function(){return{openModal:!0,loadingModal:!0,dataRevisar:[],loadingNotas:!0,objSalon:{},idPersona:0,nomcomp:"",nemoAct:"",nemoAnt:""}},mounted:function(){var o=this;this.idPersona=this.objAlumno.datos.idPersona,this.nomcomp=this.objAlumno.datos.nomcomp,this.nemoAct=this.objAlumno.datos.nemo,this.nemoAnt=this.objAlumno.datos.nemoAnt,Ue.getRegistrosPorRevisar(this.idCurso,this.grupocod,this.periodo,this.idPersona,this.nemoAct,this.nemoAnt).then(function(e){o.dataRevisar=e.dataRevisar,o.objSalon["actual"]=e.objSalon[o.nemoAct],o.objSalon["antiguo"]=e.objSalon[o.nemoAnt],o.loadingModal=!1,o.$emit("recalcularInterno",function(){setTimeout(function(){o.loadingNotas=!1},1e3)},o.objAlumno.datos.alucod)}).catch(function(){o.loadingModal=!1})},computed:{},methods:{cargandoLoading:function(o){console.log(o)},cerrarModal:function(){this.$emit("cerrarModal")},siguienteEdicion:function(){this.$emit("siguienteEdicion")},calcularPromedio:function(o){this.$emit("calcularPromedio",this.fila,this.objAlumno.notas[o])},regularizarClase:function(){var o=this;console.log(this.fila,"FILA");var e=this.$t;return this.$q.dialog({title:e("registroDeNotas.regularizarClase"),message:e("registroDeNotas.deseaRegularizarClase"),ok:e("botones.si"),cancel:e("botones.no"),preventClose:!0}).onOk(function(){var e=o.dataRevisar[0].ID_NOTA_ANTIGUO;return Ue.saveRegularizarClase(e,o.idClasePeriodo,o.idPersona,o.nemoAct,o.nemoAnt).then(function(e){return 1===e.estado?new Promise(function(e,a){var t=o.$emit("guardarNotasModalRevisar",e,a,o.objAlumno.datos.alucod,o.fila);return o.openModal=!1,t}):((0,Xe.alertModal)(o.$t("aviso"),o.$t("mensajes.m0071")),Promise.resolve(!0))})}).onCancel(function(){return(0,Xe.alertModal)(o.$t("aviso"),o.$t("mensajes.m0071")),!1})}}};const We=(0,Po.A)(Qe,[["render",ze]]);var Ke=We,Ge={emits:["guardarNotasModalRevisar","filaAlumnoSelecionado"],components:{imgEstdoAlumno:Lo,tdNota:yo,modalComentarioCurso:he,modalComentarioNota:ue,modalHistorialNotas:xe,modalRevisar:Ke,headNotas:Yo,QIcon:L.bP},props:{dataRegistro:{required:!0,type:Object},editarComentarios:{required:!0,type:Boolean},direccionEdicion:{required:!0,type:String,validator:function(o){return-1!==["VD","VI","HD","HI"].indexOf(o)}},dataAlumnos:{required:!0,type:Array},vistaEstadistica:{required:!1,type:Boolean,default:!1},visualizarHistorial:Boolean,visualizarRubrica:Boolean,visualizarComentario:Boolean,visualizarNotaAnterior:Boolean,hasTallerNuevo:{required:!1,type:Boolean,default:!1}},data:function(){return{porcentaje:0,cabeceraNotas:this.dataRegistro.cabeceraNotas,cabeceraAlumno:this.dataRegistro.cabeceraAlumno,itemPromedioCurso:this.dataRegistro.itemPromedioCurso,maxNivel:this.dataRegistro.maxNivel,infoTallerPeriodo:this.dataRegistro.infoTallerPeriodo,bolMostrarDetalleCabecera:!1,bolModalComentarioRubrica:!1,bolModalComentarioNota:!1,bolModalComentarioCurso:!1,bolHistorialNotas:!1,bolRevisarClase:!1,utilComentarioRubrica:{},utilComentarioNota:{},utilComentarioCurso:{},utilHistorialNotas:{},utilRevisarClase:{},dataArrIdsComentariosPorNota:[],dataArrIdsComentariosPorCurso:[],bgAlertaConclusionNota:[],dataObjBgAlertaNotasConclusionesSalon:{},regSoloComentarios:this.dataRegistro.regSoloComentarios,arrBloqueoNotas:this.dataRegistro.arrBloqueoNotas,ocultarPB:this.dataRegistro.infoTallerPeriodo.ocultarPB,arrConclusionesDescriptivas:[],dataDescriptor:{usaDescriptor:!1,idPrograma:"",data:{},arrIds:[],objAlumnos:{}}}},mounted:function(){this.porcentaje=this.obtenerPorcentaje(),this.scrollNotas(),this.setearDataBanderasComentarios(),this.addCssBackgroundNotas()},watch:{"dataRegistro.alumnos":{deep:!0,handler:(0,L.sg)(function(){this.porcentaje=this.obtenerPorcentaje(),this.bgAlertaConclusionNota=this.getCambiosAlertaConclusiones(),this.arrConclusionesDescriptivas=this.setConslusionesDescriptores()},250)},dataArrIdsComentariosPorNota:{deep:!0,handler:(0,L.sg)(function(){this.bgAlertaConclusionNota=this.getCambiosAlertaConclusiones()},250)}},computed:{objKeysCabecera:function(){for(var o={},e=0;e<this.cabeceraNotas.length;e++){var a=this.cabeceraNotas[e];o[a.id]=a}return o},configNotaPromedio:function(){for(var o={},e=0;e<this.cabeceraNotas.length;e++){var a=this.cabeceraNotas[e];if(a.esPromedioCurso){o=a;break}}return o},alumnos:function(){for(var o=this.dataRegistro.alumnos,e=0;e<o.length;e++){var a=o[e],t=a.notas;for(var r in a.objNotaPromedio={},t){var i=t[r];if(i.idCabecera===this.configNotaPromedio.id){a.objNotaPromedio=i;break}}}return o}},methods:{recalcularInterno:function(o,e){for(var a=0;a<this.alumnos.length;a++)if(!e||this.alumnos[a].datos.alucod===e){var t=this.alumnos[a].notas;for(var r in t)this.calcularPromedio(a,t[r])}o()},setearDataBanderasComentarios:function(){var o=this,e=[];e.push(po.getListaIdsComentariosPorNota(this.infoTallerPeriodo.idTallerPeriodo)),this.hasTallerNuevo?e.push(po.getListaIdsComentariosPorTallerNuevo(this.infoTallerPeriodo.idTallerPeriodo)):e.push(po.getListaIdsComentariosPorTaller(this.infoTallerPeriodo.idTallerPeriodo)),e.push(po.bgAlertaConclusiones(this.infoTallerPeriodo.arrTaller,this.infoTallerPeriodo.periodo)),Promise.all(e).then(function(e){o.dataArrIdsComentariosPorNota=e[0],o.dataArrIdsComentariosPorCurso=e[1].comentarios,o.dataObjBgAlertaNotasConclusionesSalon=e[2].notasBgTaller,o.addCssAlertaConclusionDescriptiva(e[2].background),o.arrConclusionesDescriptivas=o.setConslusionesDescriptores()})},setConslusionesDescriptores:function(){if(this.dataDescriptor.objAlumnos={},!this.dataDescriptor.usaDescriptor)return[];for(var o=[],e=this.dataRegistro.alumnos,a=0;a<e.length;a++)for(var t=e[a],r=t.notas,i=t.datos.idPersona,n=0;n<this.cabeceraNotas.length;n++){var l=this.cabeceraNotas[n],s=r[l.id],c=s.notaReg;Co.isNumeric(c)&&(c=parseInt(Co.roundDecimal(c,0),10));var d=t.datos.nemo+"_"+l.idPrograma+"-"+l.indiceNota;if(this.dataDescriptor.data.hasOwnProperty(d))for(var u=this.dataDescriptor.data[d],m=0;m<u.length;m++){var f=u[m];if(c>=f.NLINI&&c<=f.NLFIN){this.dataDescriptor.objAlumnos.hasOwnProperty(i)||(this.dataDescriptor.objAlumnos[i]={}),this.dataDescriptor.objAlumnos[i][s.idNota]=f.DSCRTRDES,o.push(i+"--"+s.idNota);break}}}return o},getCambiosAlertaConclusiones:function(){for(var o=this.dataRegistro.alumnos,e=this.dataObjBgAlertaNotasConclusionesSalon,a=[],t=0;t<o.length;t++)for(var r=o[t],i=r.notas,n=0;n<this.cabeceraNotas.length;n++){var l=this.cabeceraNotas[n],s=i[l.id],c=s.notaReg,d=!1;e.hasOwnProperty(r.datos.cursocod)&&l.validarAlertaCD&&(Co.isNumeric(c)&&(c=parseInt(Co.roundDecimal(c,0),10)),d=e[r.datos.cursocod].indexOf(c)>=0),d&&!this.existeComentarioNota(s.idNota,r.datos.idPersona)&&a.push(r.datos.idPersona+"--"+s.idNota)}return a},getUtilHistorialNotas:function(o,e){return{tipoFiltro:o,nemo:e.nemo,cursocod:this.infoTallerPeriodo.cursocod,bimecod:this.infoTallerPeriodo.periodo,alucod:e.alucod,idTallerPeriodo:this.infoTallerPeriodo.idTallerPeriodo,nomcomp:e.nomcomp}},abrirModalHistorialNotas:function(o,e){this.bolHistorialNotas=!0,this.utilHistorialNotas=this.getUtilHistorialNotas(1,o),this.utilHistorialNotas.idTallerContenido=e.idTallerContenido,this.utilHistorialNotas.iconoPrograma=e.iconoPrograma,this.utilHistorialNotas.colorPrograma=e.backgroundColor,this.utilHistorialNotas.evaluaciondesc=e.info.descComp},abrirModalHistorialNotasAlumno:function(o){this.bolHistorialNotas=!0,this.utilHistorialNotas=this.getUtilHistorialNotas(2,o)},cerrarModalHistorialNotas:function(){this.bolHistorialNotas=!1,this.utilHistorialNotas={}},abrirModalRevisarClase:function(o,e){if(!o.datos.flRevisar)return this.bolRevisarClase=!1,!1},cerrarModalRevisarClase:function(){this.bolRevisarClase=!1,this.utilRevisarClase={}},guardarNotasModalRevisar:function(o,e,a,t){this.$emit("guardarNotasModalRevisar",o,e,a,t)},classTd:function(o,e){return["bgprograma_"+o.idPrograma,{ocultarPB:this.ocultarPB&&o.esPromedioCurso,notaFixed:o.esPromedioCurso,esAgrupador:o.esAgrupador&&!o.config.esCalculoParticularPRG&&o.idsHijos.length,bgAlertaConcDescriptiva:this.bgAlertaConclusionNota.indexOf(e+"--"+o.idTallerContenido)>=0}]},abrirModalComentarioNota:function(o,e,a,t){this.bolModalComentarioNota=!0;var r=!1;this.utilComentarioNota={idPersona:o.idPersona,idTallerContenido:e,idContenido:a,bolArbolInfo:this.regSoloComentarios,nomcomp:o.nomcomp,edicion:this.editarComentarios,usaDescriptor:r,dataDescriptor:{}}},cerrarModalComentarioNota:function(){this.bolModalComentarioNota=!1,this.utilComentarioNota={}},editarComentarioNota:function(o,e){var a=o+"--"+this.utilComentarioNota.idTallerContenido;if(e){var t=this.dataArrIdsComentariosPorNota.indexOf(a);t>=0&&this.dataArrIdsComentariosPorNota.splice(t,1)}else this.dataArrIdsComentariosPorNota.push(a)},existeComentarioNota:function(o,e){var a=this.dataArrIdsComentariosPorNota.concat(this.arrConclusionesDescriptivas);return a.indexOf(e+"--"+o)>=0},abrirModalComentarioCurso:function(o,e){this.bolModalComentarioCurso=!0,this.utilComentarioCurso={alucod:o.alucod,idPersona:o.idPersona,idTallerContenido:e.idTallerContenido,idContenido:e.id,nomcomp:o.nomcomp,cursocod:this.infoTallerPeriodo.cursocod,bimecod:this.infoTallerPeriodo.periodo,edicion:this.editarComentarios}},cerrarModalComentarioCurso:function(){this.bolModalComentarioCurso=!1,this.utilComentarioCurso={}},editarComentarioCurso:function(o,e){if(e){var a=this.dataArrIdsComentariosPorCurso.indexOf(o);a>=0&&this.dataArrIdsComentariosPorCurso.splice(a,1)}else this.dataArrIdsComentariosPorCurso.push(o)},showBanderaComentarioCurso:function(o){return this.dataArrIdsComentariosPorCurso.indexOf(o)>=0},bolBloquearPorExamen:function(o,e){return!1},bolHabilitadoNotaInclusivo:function(o,e){return!1},bolBloquearNota:function(o,e){var a=o.validaModificacion&&""!==e.notas[o.id].notaIni;return o.bloquear||e.bloquearNotas||a},siguienteEdicion:function(o,e){var a=this,t=this.alumnos.length-1,r=this.cabeceraNotas.length-1,i=Mo.filaColSiguienteEdicion(o,e,this.direccionEdicion,t,r),n=i.sigFila,l=i.sigCol;this.$refs["refnota_"+n+"_"+l][0].clickEdicion(!0,function(){a.clickAlumno(n,l)})},scrollNotas:function(){var o=this,e=this.$refs["bodyNotas"];e.addEventListener("scroll",function(){var a=e.scrollLeft,t=e.scrollTop,r=o.$refs["headNotas"],i=o.$refs["bodyAlumno"];r.style.left="-"+a+"px",i.style.top="-"+t+"px";for(var n=o.$el.querySelectorAll(".notaFixed"),l=0;l<n.length;l++)n[l].style.left=a+"px"})},calcularPromedio:function(o,e){var a=this.alumnos[o].notas;$o.calcularPromedioAlumno(a,e.idCabecera,this.objKeysCabecera)},calcularPromedioRubrica:function(o,e,a){},obtenerPorcentaje:function(){return Mo.obtenerPorcentaje(this.alumnos,this.cabeceraNotas)},clickAlumno:function(o,e){var a,t;this.$emit("filaAlumnoSelecionado",o),e?(a=this.$el.querySelectorAll(".tr.editando:not([r='".concat(o,"']), .td.editando:not([c='").concat(e,"'])")),t=this.$el.querySelectorAll(".tr[r='".concat(o,"']:not(.editando), .td[c='").concat(e,"']:not(.editando)"))):(a=this.$el.querySelectorAll(".tr.editando:not([r='".concat(o,"']), .td.editando")),t=this.$el.querySelectorAll(".tr[r='".concat(o,"']:not(.editando)"))),a.forEach(function(o){o.classList.remove("editando")}),t.forEach(function(o){o.classList.add("editando")})},dropNota:function(o,e){for(var a=this.alumnos.length-1,t=this.cabeceraNotas.length-1,r=[],i=0;i<e.length;i++)if(!(i>a))for(var n=this.alumnos[i],l=e[i],s=0;s<l.length;s++){var c=o+s;if(!(c>t)){var d=this.cabeceraNotas[c],u=d.id,m=String(l[s]).toUpperCase();!1===this.bolBloquearNota(d,n)&&$o.esNotaValidaParaImportar(d,m)&&r.push({indexAlucod:i,idObjNota:u,nuevaNota:$o.getFormatoNota(m,d.config)})}}if(r.length>0){for(var f=0;f<r.length;f++){var p=r[f];this.alumnos[p.indexAlucod].notas[p.idObjNota].notaReg=p.nuevaNota}this.recalcularInterno(function(){})}},addCssBackgroundNotas:function(){for(var o={},e=0;e<this.cabeceraNotas.length;e++){var a=this.cabeceraNotas[e],t=".bgprograma_"+a.idPrograma;o[t]=t+"{ background-color:"+a.backgroundColor+" }"}var r=Object.values(o).join(" "),i=document.getElementsByTagName("head")[0],n=document.createElement("style");n.setAttribute("id","styleBackgroundNotas"),n.setAttribute("type","text/css"),n.appendChild(document.createTextNode(r)),i.appendChild(n)},addCssAlertaConclusionDescriptiva:function(o){var e=".bgAlertaConcDescriptiva{ background-color: ".concat(o," !important}"),a=document.getElementsByTagName("head")[0],t=document.createElement("style");t.setAttribute("id","styleAlertaConclusionDescriptiva"),t.setAttribute("type","text/css"),t.appendChild(document.createTextNode(e)),a.appendChild(t)}},beforeUnmount:function(){var o=document.getElementById("styleBackgroundNotas");o&&o.remove();var e=document.getElementById("styleAlertaConclusionDescriptiva");e&&e.remove()}};const Ye=(0,Po.A)(Ge,[["render",mo]]);var Ze=Ye,Je={class:"row"},oa={class:"col-12 col-sm-6 q-bl-sm"},ea={class:"q-list-header"},aa={class:"q-px-sm q-pt-sm"},ta={class:"col-12 col-sm-6 q-bl-sm"},ra={class:"q-list-header"},ia={class:"q-px-sm q-pt-sm"};function na(o,e){var a=(0,i.g2)("q-radio"),t=(0,i.g2)("q-checkbox"),r=(0,i.g2)("sie-select"),l=(0,i.g2)("q-btn"),s=(0,i.g2)("q-toolbar"),c=(0,i.g2)("sie-modal");return(0,i.uX)(),(0,i.Wv)(c,{class:(0,n.C4)({modalReporte:"informeAcademico"==o.reporteCase}),modelValue:o.openModal,"onUpdate:modelValue":e[13]||(e[13]=function(e){return o.openModal=e}),title:o.$t("reportes"),header:!0,ok:!1,onClose:o.cerrarModal,loading:o.loadingModal},{footer:(0,i.k6)(function(){return[(0,i.bF)(s,{class:"justify-end",color:"grey-2"},{default:(0,i.k6)(function(){return[o.mostrarBtnPdf?((0,i.uX)(),(0,i.Wv)(l,{key:0,class:"q-mx-xs",color:"primary",icon:"file_pdf",onClick:e[9]||(e[9]=function(e){return o.exportar("pdf")}),label:"PDF"})):(0,i.Q3)("v-if",!0),o.mostrarBtnExcel?((0,i.uX)(),(0,i.Wv)(l,{key:1,class:"q-mx-xs",color:"primary",icon:"file_excel",onClick:e[10]||(e[10]=function(e){return o.exportar("xls")}),label:"Excel"})):(0,i.Q3)("v-if",!0)]}),_:1})]}),footerMobile:(0,i.k6)(function(){return[o.mostrarBtnPdf?((0,i.uX)(),(0,i.Wv)(l,{key:0,flat:"",round:"",icon:"file_pdf",onClick:e[11]||(e[11]=function(e){return o.exportar("pdf")})})):(0,i.Q3)("v-if",!0),o.mostrarBtnExcel?((0,i.uX)(),(0,i.Wv)(l,{key:1,flat:"",round:"",icon:"file_excel",onClick:e[12]||(e[12]=function(e){return o.exportar("xls")})})):(0,i.Q3)("v-if",!0)]}),default:(0,i.k6)(function(){return[(0,i.Lk)("div",null,[(0,i.Lk)("div",Je,[(0,i.Lk)("div",{class:(0,n.C4)(["col-12",{"col-sm-6":o.mostrarParametros||o.mostrarTipoInforme||o.mostrarNivelReporteOfiConInt}])},[(0,i.Lk)("div",null,[(0,i.bF)(a,{class:"q-if-outlined",modelValue:o.reporteCase,"onUpdate:modelValue":e[0]||(e[0]=function(e){return o.reporteCase=e}),val:"registroAuxiliarTaller",label:"Registro Auxiliar Taller"},null,8,["modelValue"])]),(0,i.Lk)("div",null,[(0,i.bF)(a,{class:"q-if-outlined",modelValue:o.reporteCase,"onUpdate:modelValue":e[1]||(e[1]=function(e){return o.reporteCase=e}),val:"reporteObservacionesTaller",label:"Reporte de Observaciones(Taller)"},null,8,["modelValue"])]),(0,i.Lk)("div",null,[(0,i.bF)(a,{class:"q-if-outlined",modelValue:o.reporteCase,"onUpdate:modelValue":e[2]||(e[2]=function(e){return o.reporteCase=e}),val:"reporteComentarioNotasTaller",label:"Conclusiones Descriptivas Talleres"},null,8,["modelValue"])])],2),(0,i.bo)((0,i.Lk)("div",oa,[(0,i.Lk)("div",ea,(0,n.v_)(o.$t("matricula.parametros")),1),(0,i.Lk)("div",aa,[(0,i.bF)(t,{class:"q-mb-sm",modelValue:o.chkReporteIncluirNotas,"onUpdate:modelValue":e[3]||(e[3]=function(e){return o.chkReporteIncluirNotas=e}),"true-value":1,"false-value":0,label:"Incluir notas",color:"secondary"},null,8,["modelValue"]),(0,i.bF)(t,{class:"q-mb-sm",modelValue:o.chkAgregarEncabezado,"onUpdate:modelValue":e[4]||(e[4]=function(e){return o.chkAgregarEncabezado=e}),"true-value":1,"false-value":0,label:"Encabezado igual al registro de notas",color:"secondary"},null,8,["modelValue"]),(0,i.bo)((0,i.bF)(r,{type:"outlined",modelValue:o.keySelectedNivel,"onUpdate:modelValue":e[5]||(e[5]=function(e){return o.keySelectedNivel=e}),options:o.dataNiveles,label:"desc",val:"id",placeholder:"registroDeNotas.limiteNivel"},null,8,["modelValue","options"]),[[M.aG,o.mostrarNivelReporte]]),(0,i.bo)((0,i.bF)(r,{type:"outlined",modelValue:o.keySelectTipoEva,"onUpdate:modelValue":e[6]||(e[6]=function(e){return o.keySelectTipoEva=e}),options:o.dataTipoEva,label:"label",val:"value",placeholder:"Seleccionar Tipo de Evaluación"},null,8,["modelValue","options"]),[[M.aG,o.mostrarTipoEva]]),(0,i.bo)((0,i.bF)(r,{type:"outlined",modelValue:o.keySelectTipoAlumno,"onUpdate:modelValue":e[7]||(e[7]=function(e){return o.keySelectTipoAlumno=e}),options:o.dataTipoAlumnos,label:"descripcion",val:"id",placeholder:"Filtrar Alumnos"},null,8,["modelValue","options"]),[[M.aG,o.mostrarTipoAlumnos]])])],512),[[M.aG,o.mostrarParametros]]),(0,i.bo)((0,i.Lk)("div",ta,[(0,i.Lk)("div",ra,(0,n.v_)(o.$t("matricula.parametros")),1),(0,i.Lk)("div",ia,[(0,i.bF)(r,{type:"outlined",modelValue:o.keySelectedNivelOfiConInt,"onUpdate:modelValue":e[8]||(e[8]=function(e){return o.keySelectedNivelOfiConInt=e}),options:o.dataNivelesOfiConInt,label:"desc",val:"id",placeholder:"registroDeNotas.limiteNivel"},null,8,["modelValue","options"])])],512),[[M.aG,o.mostrarNivelReporteOfiConInt]])])])]}),_:1},8,["class","modelValue","title","onClose","loading"])}var la=a(99550),sa=a.n(la),ca=(a(70199),a(7346),a(2819)),da=a(57668),ua={getContenidoInfo:function(o){return fo.$http.get("api/HyoTallerContenido/info",{params:{idContenido:o}}).then(function(o){var e=o.json;return e})},getOpcDataTipoAlumno:function(){return[{id:0,descripcion:"TODOS"},{id:1,descripcion:"Inclusivos"},{id:2,descripcion:"No Inclusivos"}]},infoReporte:function(){return fo.$http.get("api/HyoPrograma/infoReporte",{params:{tipoPrograma:4}}).then(function(o){var e=o.json;return e})}},ma={emits:["cerrarModal"],components:{sieModal:ie.A,QRadio:L.$,QCheckbox:L.vZ,sieSelect:se.A,QToolbar:L.ZV,QBtn:L.Il},props:{idTallerPeriodo:[Number],idContenido:[Number],infoTallerPeriodo:Object,verInforme:Boolean,dataAlumno:Array},data:function(){return{openModal:!0,loadingModal:!0,reporteCase:"registroAuxiliarTaller",dataNiveles:[],dataTipoEva:[],dataTipoAlumnos:[],keySelectedNivel:0,keySelectedNivelOfiConInt:1,dataNivelesOfiConInt:[{id:1,desc:"Nivel 1"},{id:2,desc:"Nivel 2"}],chkAgregarEncabezado:1,optTipoInforme:[{value:"%",label:"Todos"},{value:"B",label:"Trimestral"},{value:"I",label:"Intervaluación"}],tipoInforme:"%",vmEstudiante:"T",optEstudiantes:[],chkReporteIncluirNotas:1,keySelectTipoEva:0,keySelectTipoAlumno:0,mostrarTipoEva:!1,mostrarTipoAlumnos:!1}},mounted:function(){var o=this,e={},a={};this.optEstudiantes=JSON.parse(JSON.stringify(this.dataAlumno)),this.optEstudiantes.unshift({nombre:"Todos",nemo:"",alucod:"T"}),Promise.all([ua.getContenidoInfo(this.idContenido),ua.infoReporte()]).then(function(t){var r=sa()(t,2),i=r[0],n=r[1];o.loadingModal=!1;for(var l=0;l<i.length;l++){var s=i[l],c="k"+s.NIVEL;0!==s.NIVEL&&(a.hasOwnProperty(c)||(a[c]={nivel:s.NIVEL,programas:[]}),-1===a[c].programas.indexOf(s.ID_PROGRAMA)&&(a[c].programas.push(s.ID_PROGRAMA),e[s.ID_PROGRAMA]=s))}var d=null;for(var u in a){var m=a[u].nivel,f=m+" "+a[u].programas.map(function(o){return e[o].DESCPROGRAMA}).join(", ");o.dataNiveles.push({id:m,desc:f}),d=m}o.keySelectedNivel=d,o.mostrarTipoEva=n.usaFiltrosReportes,o.mostrarTipoAlumnos=n.usaFiltrosReportes,o.dataTipoEva=n.optsTiposEvaluacion,o.dataTipoEva.unshift({value:0,label:"TODOS"}),o.dataTipoAlumnos=ua.getOpcDataTipoAlumno()}).catch(function(){o.loadingModal=!1})},computed:{esOficialConInterno:function(){return!1},mostrarBtnPdf:function(){return!0},mostrarBtnExcel:function(){return!0},mostrarParametros:function(){return["registroAuxiliarTaller","registroAuxiliarTallerPorProfesor"].indexOf(this.reporteCase)>=0},mostrarNivelReporte:function(){return this.dataNiveles.length>0&&["registroAuxiliarTaller"].indexOf(this.reporteCase)>=0},mostrarNivelReporteOfiConInt:function(){return!1},mostrarTipoInforme:function(){return!1},profcod:function(){return(0,da["default"])().profcod}},methods:{cerrarModal:function(){this.$emit("cerrarModal")},exportar:function(o){var e={ano:this.infoTallerPeriodo.ano,formato:o,repcod:this.reporteCase};switch(this.reporteCase){case"reporteObservacionesTaller":e.periodo=this.infoTallerPeriodo.periodo,e.cursocod=this.infoTallerPeriodo.cursocod,e.idClaseTaller=this.infoTallerPeriodo.idClaseTaller,e.idCursovac=this.infoTallerPeriodo.idCursovac;break;case"reporteComentarioNotasTaller":e.idTallerPeriodo=this.idTallerPeriodo,e.periodo=this.infoTallerPeriodo.periodo,e.durades=this.infoTallerPeriodo.durades,e.cursocod=this.infoTallerPeriodo.cursocod,e.cursodes=this.infoTallerPeriodo.cursonom,e.nomProfesor=this.infoTallerPeriodo.nomProfesor,e.idClaseTaller=this.infoTallerPeriodo.idClaseTaller,e.idCursovac=this.infoTallerPeriodo.idCursovac;break;case"registroAuxiliarTaller":e.agregarEncabezado=this.chkAgregarEncabezado,e.maxnivel=this.keySelectedNivel,e.idTallerPeriodo=this.idTallerPeriodo,e.idContenido=this.idContenido,e.keySelectTipoEva=this.keySelectTipoEva,e.keySelectTipoAlumno=this.keySelectTipoAlumno,e.chkReporteIncluirNotas=this.chkReporteIncluirNotas;break;case"registroAuxiliarTallerPorProfesor":e.bimecod=this.infoTallerPeriodo.periodo,e.profcod=this.profcod,e.chksinnota=1===this.chkReporteIncluirNotas?"N":"S",e.chkencabezadoigualregnotas=1===this.chkAgregarEncabezado?"S":"N",e.keySelectTipoEva=this.keySelectTipoEva,e.keySelectTipoAlumno=this.keySelectTipoAlumno;break}(0,ca.exportFilePhp)(e,"webservice/reportes/reporte")}}};const fa=(0,Po.A)(ma,[["render",na]]);var pa=fa,va={key:0,class:"row column q-px-sm q-pt-sm"},ga={class:"col-12"},Ca={key:1,class:"row column q-px-sm q-pt-sm"},ha={class:"col-12"},ba={key:2,class:"row column q-px-sm q-pt-sm"},Na={class:"col-12"},Pa={key:0,class:"row column q-px-sm q-pt-sm"},Ea={class:"col-12"},ka={key:1,class:"row column q-px-sm q-pt-sm"},Aa={class:"col-12"},Ta={key:2,class:"row column q-px-sm q-pt-sm"},ya={class:"col-12"};function Ra(o,e){var a=(0,i.g2)("q-tab"),t=(0,i.g2)("q-radio"),r=(0,i.g2)("sie-upload"),n=(0,i.g2)("q-tab-pane"),l=(0,i.g2)("q-tabs"),s=(0,i.g2)("sie-modal");return(0,i.uX)(),(0,i.Wv)(s,{modelValue:o.openModal,"onUpdate:modelValue":e[7]||(e[7]=function(e){return o.openModal=e}),title:o.$t("registroDeNotas.importarExportar"),header:!0,footer:!0,loading:o.loadingModal,onSubmit:o.aceptar},{default:(0,i.k6)(function(){return[(0,i.bF)(l,{inverted:"",animated:"",modelValue:o.tabActive,"onUpdate:modelValue":e[6]||(e[6]=function(e){return o.tabActive=e})},{title:(0,i.k6)(function(){return[o.editarNotas?((0,i.uX)(),(0,i.Wv)(a,{key:0,name:"importar",label:o.$t("importar")},null,8,["label"])):(0,i.Q3)("v-if",!0),(0,i.bF)(a,{name:"exportar",label:o.$t("exportar")},null,8,["label"])]}),default:(0,i.k6)(function(){return[o.editarNotas?((0,i.uX)(),(0,i.Wv)(n,{key:0,name:"importar"},{default:(0,i.k6)(function(){return[o.importarNotas?((0,i.uX)(),(0,i.CE)("div",va,[(0,i.Lk)("div",ga,[(0,i.bF)(t,{class:"q-if-outlined",modelValue:o.reporteCaseI,"onUpdate:modelValue":e[0]||(e[0]=function(e){return o.reporteCaseI=e}),val:"notas",label:o.$t("registroDeNotas.importarRegNotasExcel")},null,8,["modelValue","label"])])])):(0,i.Q3)("v-if",!0),o.importarComentario?((0,i.uX)(),(0,i.CE)("div",Ca,[(0,i.Lk)("div",ha,[(0,i.bF)(t,{class:"q-if-outlined",modelValue:o.reporteCaseI,"onUpdate:modelValue":e[1]||(e[1]=function(e){return o.reporteCaseI=e}),val:"comentario",label:o.$t("registroDeNotas.importarComentariosExcel")},null,8,["modelValue","label"])])])):(0,i.Q3)("v-if",!0),o.importarConcluDesc?((0,i.uX)(),(0,i.CE)("div",ba,[(0,i.Lk)("div",Na,[(0,i.bF)(t,{class:"q-if-outlined",modelValue:o.reporteCaseI,"onUpdate:modelValue":e[2]||(e[2]=function(e){return o.reporteCaseI=e}),val:"concludesc",label:o.$t("registroDeNotas.importarConcluDescExcel")},null,8,["modelValue","label"])])])):(0,i.Q3)("v-if",!0),(0,i.bF)(r,{class:"no-wrap imagen",onUpload:o.added,allow:["xlsx"],icon:"file_excel"},null,8,["onUpload"])]}),_:1})):(0,i.Q3)("v-if",!0),(0,i.bF)(n,{name:"exportar"},{default:(0,i.k6)(function(){return[o.importarNotas?((0,i.uX)(),(0,i.CE)("div",Pa,[(0,i.Lk)("div",Ea,[(0,i.bF)(t,{class:"q-if-outlined",modelValue:o.reporteCaseE,"onUpdate:modelValue":e[3]||(e[3]=function(e){return o.reporteCaseE=e}),val:"notas",label:o.$t("registroDeNotas.exportarRegNotasExcel")},null,8,["modelValue","label"])])])):(0,i.Q3)("v-if",!0),o.importarComentario?((0,i.uX)(),(0,i.CE)("div",ka,[(0,i.Lk)("div",Aa,[(0,i.bF)(t,{class:"q-if-outlined",modelValue:o.reporteCaseE,"onUpdate:modelValue":e[4]||(e[4]=function(e){return o.reporteCaseE=e}),val:"comentario",label:o.$t("registroDeNotas.exportarComentariosExcel")},null,8,["modelValue","label"])])])):(0,i.Q3)("v-if",!0),o.importarConcluDesc?((0,i.uX)(),(0,i.CE)("div",Ta,[(0,i.Lk)("div",ya,[(0,i.bF)(t,{class:"q-if-outlined",modelValue:o.reporteCaseE,"onUpdate:modelValue":e[5]||(e[5]=function(e){return o.reporteCaseE=e}),val:"concludesc",label:o.$t("registroDeNotas.exportarConcluDescExcel")},null,8,["modelValue","label"])])])):(0,i.Q3)("v-if",!0)]}),_:1})]}),_:1},8,["modelValue"])]}),_:1},8,["modelValue","title","loading","onSubmit"])}var xa=a(59089),Da=a(33950),Ia={emits:["update:modelValue","input","result"],components:{sieModal:ie.A,sieUpload:xa.A,QRadio:L.$,QTabs:L.uw,QTab:L.zu,QTabPane:L.dg},props:{modelValue:Boolean,idTallerPeriodo:{required:!0,type:Number},idContenido:{required:!0,type:Number},editarNotas:{required:!0,type:Boolean},datos:{required:!0,type:Object}},data:function(){return{loadingModal:!1,reporteCaseI:"reporte",reporteCaseE:"reporte",tabActive:this.editarNotas?"importar":"exportar",file:null}},computed:{openModal:{get:function(){return this.modelValue},set:function(o){console.log("set:openModal",o),this.$emit("update:modelValue",o),this.$emit("input",o)}},importarNotas:function(){return this.datos["notas"]},importarComentario:function(){return this.datos["comentarios"]},importarConcluDesc:function(){return this.datos["concludesc"]}},methods:{added:function(o){this.file=o[0]},importarArchivo:function(){var o=this;this.loadingModal=!0;var e=this.file,a=(0,Da.Basic)({root:!0,url:"webservice/reportes/reporte/repcod/importacionRegistro",file:e,data:{idTallerPeriodo:this.idTallerPeriodo,tipo:this.reporteCaseI}});a.then(function(e){o.loadingModal=!1,1===e.estado?(o.openModal=!1,"notas"===o.reporteCaseI?o.$emit("result",e.notas,o.reporteCaseI):((0,le["default"])("Importado correctamente","success"),o.$emit("result",{},o.reporteCaseI))):(0,le["default"])(e.msjError,"warning")}).catch(function(e){o.loadingModal=!1,(0,le["default"])("error al subir archivo","error")})},exportar:function(){var o={formato:"xlsx",repcod:"exportacionRegistro",idContenido:this.idContenido,idTallerPeriodo:this.idTallerPeriodo,tipo:this.reporteCaseE};(0,ca.exportFilePhp)(o,"webservice/reportes/reporte")},aceptar:function(){"importar"===this.tabActive?this.importarArchivo():this.exportar()}},created:function(){this.datos["comentarios"]&&(this.reporteCaseE="comentario",this.reporteCaseI="comentario"),this.datos["notas"]&&(this.reporteCaseE="notas",this.reporteCaseI="notas")}};const La=(0,Po.A)(Ia,[["render",Ra]]);var Ma=La,Sa=a(2123),Oa={class:"q-pa-lg-md"},qa={class:"row"},_a={class:"col"},ja={class:"row"},Va={class:"col"},Fa={class:"row q-px-sm text-weight-bold text-info"},$a={class:"col-auto flex-center"},wa={class:"col self-center"},Ba={class:"row q-px-sm"},Ha={class:"col"},za={class:"text-bold"},Ua={key:0};function Xa(o,e){var a=(0,i.g2)("sie-select"),t=(0,i.g2)("q-icon"),r=(0,i.g2)("q-btn"),l=(0,i.g2)("q-toolbar"),s=(0,i.g2)("sie-modal");return(0,i.uX)(),(0,i.Wv)(s,{class:"modalCopiaNotas",modelValue:o.openModal,"onUpdate:modelValue":e[2]||(e[2]=function(e){return o.openModal=e}),title:o.$t("registroDeNotas.copiarCriteriosNotas"),header:!0,ok:!1,onClose:o.cerrarModal},{footer:(0,i.k6)(function(){return[(0,i.bF)(l,{class:"justify-end",color:"grey-2"},{default:(0,i.k6)(function(){return[(0,i.bF)(r,{class:"q-mx-xs",color:"primary",icon:"copy",onClick:o.procesarCopia,label:o.$t("registroDeNotas.procesarCopia"),loading:o.loading},null,8,["onClick","label","loading"])]}),_:1})]}),footerMobile:(0,i.k6)(function(){return[(0,i.bF)(r,{flat:"",round:"",icon:"copy",onClick:o.procesarCopia,loading:o.loading},null,8,["onClick","loading"])]}),default:(0,i.k6)(function(){return[(0,i.Lk)("div",Oa,[(0,i.Lk)("div",qa,[(0,i.Lk)("div",_a,[(0,i.bF)(a,{type:"outlined",modelValue:o.vmCurso,"onUpdate:modelValue":e[0]||(e[0]=function(e){return o.vmCurso=e}),options:o.pDataCurso,onSelected:o.cambiarCurso,label:"CURSONOM",val:"ID_CLASE",placeholder:"curso"},null,8,["modelValue","options","onSelected"])])]),(0,i.Lk)("div",ja,[(0,i.Lk)("div",Va,[(0,i.bF)(a,{type:"outlined",modelValue:o.vmPeriodo,"onUpdate:modelValue":e[1]||(e[1]=function(e){return o.vmPeriodo=e}),options:o.dataPeriodo,label:"PERIODODES",val:"ID_CLASE_PERIODO",placeholder:"periodo"},null,8,["modelValue","options"])])]),(0,i.Lk)("div",Fa,[(0,i.Lk)("div",$a,[(0,i.bF)(t,{class:"q-mr-sm",name:"info",size:"28px"})]),(0,i.Lk)("div",wa,[(0,i.Lk)("div",null,(0,n.v_)(o.$t("registroDeNotas.mensajeCopia")),1)])]),(0,i.Lk)("div",Ba,[(0,i.Lk)("div",Ha,[(0,i.Lk)("p",za,"Clase Destino: "+(0,n.v_)(o.dataClaseSelect.CURSONOM)+" - periodo "+(0,n.v_)(o.periodo),1),o.dataClaseSelect.ANUAL_REPLICA?((0,i.uX)(),(0,i.CE)("p",Ua,"*"+(0,n.v_)(o.$t("mensajes.a0029")),1)):(0,i.Q3)("v-if",!0)])])])]}),_:1},8,["modelValue","title","onClose"])}var Qa={getListaPeriodoTalleres:function(){return fo.$http.get("api/HyoDuraVac/getListaDuraciones",{params:{}}).then(function(o){var e=o.json;return e}).catch(function(){return[]})},getListaCursoTalleres:function(o){return fo.$http.get("api/HyoCursoVac/getListaCursosPeriodo",{params:{duracod:o}}).then(function(o){var e=o.json;return e}).catch(function(){return[]})},obtRegistroNotas:function(o,e,a,t,r){return fo.$http.get("api/HyoClasePeriodo/obtRegistroNotas",{params:{idClasePeriodo:o,idContenido:e,permisoMenu:a,objInfoEstadistica:t,idPeriodoAnt:r}}).then(function(o){var e=o.json;return e})},obtRegistroNotasTalleres:function(o,e,a,t,r){return fo.$http.get("api/HyoTallerPeriodo/obtRegistroNotas",{params:{idTallerPeriodo:o,idContenido:e,permisoMenu:a,objInfoEstadistica:t,idPeriodoAnt:r}}).then(function(o){var e=o.json;return e})},actualizarNotas:function(o,e,a,t,r){return fo.$http.put("api/HyoTallernota/actualizar",{registros:o,cursocod:e,periodo:a,idTallerPeriodo:t,ano:r}).then(function(o){var e=o.json;return e})},getPeriodoTaller:function(o){return fo.$http.get("api/HyoTallerPeriodo/obtTallerPeriodo",{params:{idClaseTaller:o}}).then(function(o){var e=o.json;return e}).catch(function(){return[]})},getListaPeriodoTalleresNuevo:function(){return fo.$http.get("api/HyoDuraVac/getListaDuracionesNuevo",{params:{}}).then(function(o){var e=o.json;return e}).catch(function(){return[]})},getListaCursoTalleresNuevo:function(o){return fo.$http.get("api/HyoCtCursoPeriodo/getListaCursosPeriodo",{params:{duracod:o}}).then(function(o){var e=o.json;return e}).catch(function(){return[]})},getPeriodoTallerNuevo:function(o){return fo.$http.get("api/HyoTallerPeriodo/obtTallerNuevoPeriodo",{params:{idClaseTaller:o}}).then(function(o){var e=o.json;return e}).catch(function(){return[]})}},Wa={emits:["cerrarModal","procesoFinalizado"],components:{sieModal:ie.A,sieSelect:se.A,QIcon:L.bP,QToolbar:L.ZV,QBtn:L.Il},props:{pDataCurso:{required:!0,type:Array},dataClaseSelect:{required:!0,type:Object},periodo:[Number],idPeriodoDestino:{required:!0,type:Number}},data:function(){return{openModal:!0,dataPeriodo:[],vmPeriodo:null,vmCurso:null,loading:!1}},methods:{cerrarModal:function(){this.$emit("cerrarModal")},cambiarCurso:function(o){var e=this;this.vmPeriodo=null,Qa.getPeriodoCLase(o.ID_CLASE).then(function(o){e.dataPeriodo=o})},procesarCopia:function(){var o=this;if(null===this.vmPeriodo)return!1;if(this.vmPeriodo===this.idPeriodoDestino)return!1;var e=this.$t;return this.$q.dialog({title:e("mensajes.m0007"),message:"",ok:e("botones.si"),cancel:e("botones.no"),preventClose:!0}).onOk(function(){return o.loading=!0,Qa.copiaCriteriosYnotas(o.vmPeriodo,o.idPeriodoDestino).then(function(e){1===e.estado?o.$emit("procesoFinalizado"):(o.loading=!1,(0,le["default"])(o.$t("mensajes.m0009")))})}).onCancel(function(){return!1})}}};const Ka=(0,Po.A)(Wa,[["render",Xa]]);var Ga=Ka,Ya=a(16648),Za=a(80340),Ja=a(24974),ot=a(81288),et={components:{QSelect:Ya.S,QPageSticky:L._U,QFab:L.l6,QFabAction:L.B$,sieVacio:Za.A,QInnerLoading:L.SQ,QSpinnerOval:L.VA,sieUsuario:Ja.A,grillaNotas:Ze,registroCriterios:Sa.A,modalReportes:pa,modalImportExportNotasExcel:Ma,modalCopiaCriterioNotas:Ga,QPage:L.Tu,QTooltip:L.nC,QBtn:L.Il},data:function(){return{dirEdit:"VD",optDirEdit:{VD:{label:"Vertical Derecha",nextDir:"HD",class:"rotate-90"},HD:{label:"Horizontal Derecha",nextDir:"VD",class:""}},obFiltro:{curso:null,periodo:null,duracionTaller:null,cursoTaller:null},objPeriodoSelected:{},dataPeriodo:[],dataPeriodosTalleres:[],dataCursoTalleres:[],objPeriodoTallerSelected:{},objCursoTallerSelected:{},dataRegistroNotas:{},permisosRegistro:{},dataImportacionNotas:{},profesorClase:"",ultimaModificacion:"",editarAPartirDelPrograma:100,alumnoSelecionado:{alucod:null,nomcomp:null},visualizarComentario:!1,visualizarHistorial:!1,visualizarNotaAnterior:!1,cargandoRegistro:!1,grabandoRegistro:!1,bolMostrarConfigCriterios:!1,bolCargarComponentePesosYCriterios:!1,bolModalReporte:!1,bolModalCopiaNotas:!1,bolModalInforme:!1,bolModalImportExportNotasExcel:!1,bolImportarNotasTareaRubrica:!1,bolImportarNotasExamen:!1,lblPeriodo:"Periodo",hasTallerNuevo:!1}},computed:{classDirEdit:function(){return this.optDirEdit[this.dirEdit].class},numPermisoMenu:function(){return(0,da["default"])().ruta["nivel"]},dataCboAlumno:function(){var o=[];return this.dataRegistroNotas.alumnos.forEach(function(e,a){o.push({nombre:e.datos["nomcomp"],nemo:e.datos["nemo"],alucod:e.datos["alucod"],fila:a,idPersona:e.datos["idPersona"]})}),o}},methods:{cambiarDireccionEdicion:function(){this.dirEdit=this.optDirEdit[this.dirEdit].nextDir},refrescarRegistro:function(){var o=this;this.preSelectPeriodo().then(function(){o.cargarDataTaller()})},resetearDataRegistro:function(){this.dataRegistroNotas={cabeceraNotas:[],cabeceraAlumno:[],itemPromedioCurso:[],alumnos:[],maxNivel:0,infoTallerPeriodo:{},regSoloComentarios:!1,arrBloqueoNotas:[]},this.dataImportacionNotas={},this.permisosRegistro={},this.bolCargarComponentePesosYCriterios=!1},resetearDataFiltro:function(o){switch(this.resetearDataRegistro(),this.alumnoSelecionado={alucod:null,nomcomp:null},o){case"periodo_taller":this.dataCursoTalleres=[],this.objCursoTallerSelected={},this.obFiltro.cursoTaller=null;break;case"curso_taller":break;case"nroperiodo":break}},cambiarPeriodoTaller:function(o){var e=this;this.resetearDataFiltro("periodo_taller"),this.objPeriodoTallerSelected=o,this.hasTallerNuevo?Qa.getListaCursoTalleresNuevo(o.DURACOD).then(function(o){e.dataCursoTalleres=o}):Qa.getListaCursoTalleres(o.DURACOD).then(function(o){e.dataCursoTalleres=o})},cambiarCursoTaller:function(o){var e=this;this.resetearDataFiltro("curso_taller"),this.objCursoTallerSelected=o,this.hasTallerNuevo?Qa.getPeriodoTallerNuevo(o.ID_CLASE_TALLER).then(function(o){e.dataPeriodo=o}):Qa.getPeriodoTaller(o.ID_CLASE_TALLER).then(function(o){e.dataPeriodo=o})},cambiarPeriodo:function(o){this.resetearDataFiltro("nroperiodo"),this.objPeriodoSelected=o,this.cargarDataTaller()},preSelectPeriodo:function(){var o=this;return I()(x()().m(function e(){var a,t;return x()().w(function(e){while(1)switch(e.n){case 0:if(!o.existenNotasModificadas()){e.n=2;break}return a=o.$t,e.n=1,(0,Xe.dialogConfirm)({title:a("registroDeNotas.registroHaSidoModificado"),message:a("registroDeNotas.deseaGuardarCambios"),ok:a("botones.si"),cancel:a("botones.no"),preventClose:!0});case 1:if(t=e.v,!t){e.n=2;break}return e.a(2,new Promise(function(e,a){o.guardarNotas(e,a)}));case 2:return e.a(2,Promise.resolve(!0))}},e)}))()},obtNotasNivel2:function(){var o=this;return I()(x()().m(function e(){var a,t,r,i,n,l;return x()().w(function(e){while(1)switch(e.n){case 0:return a=o.obtPeriodoAnt(),e.n=1,Qa.obtNotaPorNivelPeriodoAnterior(a);case 1:t=e.v,r=[],i=o.dataRegistroNotas.alumnos,n=x()().m(function e(a){var n;return x()().w(function(e){while(1)switch(e.n){case 0:n=i[a].datos,r.forEach(function(e){var r=o.dataRegistroNotas.alumnos[a].notas[e].llave;t.hasOwnProperty(n.idPersona)&&t[n.idPersona].hasOwnProperty(r)&&(o.dataRegistroNotas.alumnos[a].notas[e].notaReg=t[n.idPersona][r])});case 1:return e.a(2)}},e)}),l=0;case 2:if(!(l<i.length)){e.n=4;break}return e.d(y()(n(l)),3);case 3:l++,e.n=2;break;case 4:o.$refs["refRegistroNotas"].recalcularInterno(function(){o.guardarNotas()});case 5:return e.a(2)}},e)}))()},obtPeriodoAnt:function(){var o=0;if(this.objPeriodoSelected.PERIODO>this.dataPeriodo[0].PERIODO){var e=this.objPeriodoSelected.PERIODO-1,a=this.dataPeriodo.find(function(o){return o.PERIODO===e});o=a.ID_CLASE_PERIODO}return o},cargarDataTaller:function(){var o=this;return I()(x()().m(function e(){var a,t;return x()().w(function(e){while(1)switch(e.p=e.n){case 0:return o.resetearDataRegistro(),o.cargandoRegistro=!0,e.p=1,e.n=2,Qa.obtRegistroNotasTalleres(o.objPeriodoSelected.ID_TALLER_PERIODO,o.objPeriodoSelected.ID_CONTENIDO,o.numPermisoMenu,{},0);case 2:a=e.v,t=a.infoTallerPeriodo,o.objPeriodoTallerSelected.ID_CLASE_TALLER=t.idClaseTaller,o.objPeriodoTallerSelected.ID_CONTENIDO=t.idContenido,o.objPeriodoTallerSelected.ID_CURSOVAC=t.idCursoVac,o.objPeriodoTallerSelected.ID_TALLER_CONTENIDO=t.idTallerContenido,o.objPeriodoTallerSelected.PERIODO=o.objPeriodoSelected.PERIODO,o.objPeriodoTallerSelected.ID_TALLER_PERIODO=o.objPeriodoSelected.ID_TALLER_PERIODO,o.dataRegistroNotas={alumnos:a.dataAlumno,maxNivel:a.maxNivel,cabeceraNotas:a.cabeceraNotas,cabeceraAlumno:a.cabeceraAlumno,itemPromedioCurso:a.itemPromedioCurso,infoTallerPeriodo:t,regSoloComentarios:a.regSoloComentarios,arrBloqueoNotas:[]},o.permisosRegistro=a.dataPermisoRegistro,o.profesorClase=t.nomProfesor,o.ultimaModificacion=t.muestraUltimaActualizacion&&t.auditoriaRegistro["fecha"]?t.auditoriaRegistro["fecha"]+" - "+t.auditoriaRegistro["usuario"]:"",o.editarAPartirDelPrograma=t.editarAPartirDelPrograma,o.bolCargarComponentePesosYCriterios=!0,e.n=4;break;case 3:e.p=3,e.v;case 4:return o.cargandoRegistro=!1,e.a(2,!0)}},e,null,[[1,3]])}))()},configurarEvaluaciones:function(){this.existenNotasModificadas()?(0,Xe.alertModal)(this.$t("registroDeNotas.registroHaSidoModificado"),this.$t("registroDeNotas.primeroDebeGuardar")):this.bolMostrarConfigCriterios=!0},volverARegistroNotas:function(){this.bolMostrarConfigCriterios=!1,this.cargarDataTaller()},filaAlumnoSelecionado:function(o){this.alumnoSelecionado={alucod:this.dataRegistroNotas.alumnos[o].datos.alucod,nomcomp:this.dataRegistroNotas.alumnos[o].datos.nomcomp,nemo:this.dataRegistroNotas.alumnos[o].datos.nemo,nemoAnt:this.dataRegistroNotas.alumnos[o].datos.nemoAnt,flRevisar:this.dataRegistroNotas.alumnos[o].datos.flRevisar,flResaltar:this.dataRegistroNotas.alumnos[o].datos.flResaltar}},existenNotasModificadas:function(o){for(var e=this.dataRegistroNotas.alumnos,a=0;a<e.length;a++){var t=e[a].notas;if(!o||e[a].datos.alucod===o)for(var r in t)if(t[r].notaIni!==t[r].notaReg)return!0}return!1},procesarCopiaNotas:function(){},guardarNotasModalRevisar:function(o,e,a,t){this.dataRegistroNotas.alumnos[t].datos.flRevisar=!1,this.existenNotasModificadas(a)?this.guardarNotas(o,e,a):((0,le["default"])(this.$t("mensajes.m0001")),o(0))},guardarNotas:function(o,e,a,t){for(var r=this,i=this.dataRegistroNotas.alumnos,n=[],l=[],s=this.objCursoTallerSelected.CURSOCOD,c=this.objPeriodoSelected.PERIODO,d=this.objPeriodoSelected.ID_TALLER_PERIODO,u=0;u<i.length;u++){var m=i[u].notas,f=i[u].datos;if(!a||f.alucod===a)for(var p in m)(m[p].notaIni!==m[p].notaReg||t)&&(l.push({indexAlucod:u,idObjNota:p,nuevaNota:m[p].notaReg}),n.push({idNota:m[p].idNota,notaNue:m[p].notaReg,nivelEva:m[p].nivelEva,idPersona:f.idPersona,alucod:f.alucod,cursocod:f.cursocod,idCursovac:f.idCursovac}))}n.length>0?(this.grabandoRegistro=!0,Qa.actualizarNotas(n,s,c,d,this.dataRegistroNotas.infoTallerPeriodo.ano).then(function(a){if(r.grabandoRegistro=!1,1===a.estado){var t=L.p6.formatDate(new Date,"DD/MM/YYYY hh.mm.ss a");r.ultimaModificacion=r.dataRegistroNotas.infoTallerPeriodo["muestraUltimaActualizacion"]?t+" - "+(0,da["default"])().usucod:"";for(var i=0;i<l.length;i++){var n=l[i];r.dataRegistroNotas.alumnos[n.indexAlucod].notas[n.idObjNota].notaIni=n.nuevaNota}(0,le["default"])(r.$t("mensajes.m0001")),"function"===typeof o&&o(!0)}else(0,le["default"])(r.$t("mensajes.e0006"),"warning"),"function"===typeof e&&e(new Error("error"))}).catch(function(o){r.grabandoRegistro=!1,(0,le["default"])(r.$t("mensajes.e0006"),"warning"),"function"===typeof e&&e(new Error("error"))})):(0,Xe.alertModal)(this.$t("aviso"),this.$t("mensajes.a0025"))},abrirModalInforme:function(){},abrirModalReportes:function(){this.bolModalReporte=!0},abrirModalCopiaNotas:function(){this.bolModalCopiaNotas=!0},cerrarModalReportes:function(){this.bolModalReporte=!1},cerrarModalCopiaNotas:function(){this.bolModalCopiaNotas=!1},cerrarModalInforme:function(){},abrirModalImportExportNotasExcel:function(){this.bolModalImportExportNotasExcel=!0},resultImportacionNotasExcel:function(o,e){if("comentario"===e||"concludesc"===e)return this.refrescarRegistro(),!1;for(var a=this.dataRegistroNotas.alumnos,t=this.dataRegistroNotas.cabeceraNotas,r={},i=0;i<t.length;i++){var n=t[i];r[n.id]=n}for(var l=0;l<a.length;l++){var s=a[l].notas,c=a[l].datos;if(o.hasOwnProperty(c.alucod)){var d=o[c.alucod];for(var u in s){var m=s[u].idCabecera;if(d.hasOwnProperty(m)&&r.hasOwnProperty(m)){var f=r[m].config,p=d[m];this.__actualizarNuevaNota(s[u],$o.getFormatoNota(p,f))}}}}this.$refs["refRegistroNotas"].recalcularInterno(function(){})},__actualizarNuevaNota:function(o,e){o.notaReg=e},recalcularNotas:function(o){var e=this,a=this.$t;this.$q.dialog({title:"Se realizará el recálculo de notas",message:a("registroDeNotas.deseaGuardarCambios"),ok:a("botones.si"),cancel:a("botones.no"),preventClose:!0}).onOk(function(){e.$refs["refRegistroNotas"].recalcularInterno(function(){e.guardarNotas()})}).onCancel(function(){return!1})}},created:function(){var o=this,e=["TALLERES_NUEVO"],a=(0,da["default"])(),t=a.colcod;switch(this.resetearDataRegistro(),t){case"0078":this.lblPeriodo="Programa";break}(0,ot.constantes)(e).then(function(e){o.hasTallerNuevo=e.TALLERES_NUEVO||!1,o.hasTallerNuevo?Qa.getListaPeriodoTalleresNuevo().then(function(e){o.dataPeriodosTalleres=e}):Qa.getListaPeriodoTalleres().then(function(e){o.dataPeriodosTalleres=e})})}};const at=(0,Po.A)(et,[["render",A]]);var tt=at}}]);