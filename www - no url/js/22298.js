"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[22298],{22298:function(e,n,o){o.r(n),o.d(n,{default:function(){return F}});var a=o(61758),i={key:0,class:"column col items-center justify-center"},r={key:1,class:"column col"},t={key:0,class:"column col items-center justify-center"},s={key:1,class:"col column relative-position _visor"},l={class:"absolute xy-buttons q-gutter-sm"};function c(e,n){var o=(0,a.g2)("header-btn"),c=(0,a.g2)("sie-salones"),u=(0,a.g2)("sie-vacio"),m=(0,a.g2)("q-btn"),d=(0,a.g2)("q-iframe"),g=(0,a.g2)("sie-upload"),p=(0,a.g2)("q-spinner-oval"),C=(0,a.g2)("q-inner-loading"),f=(0,a.g2)("q-card-section"),v=(0,a.g2)("q-card"),b=(0,a.g2)("q-page");return(0,a.uX)(),(0,a.Wv)(b,{class:"intranet--horario q-pa-sm"},{default:(0,a.k6)(function(){return[(0,a.bF)(v,{class:"col column",dense:"",flat:"",bordered:""},{default:(0,a.k6)(function(){return[(0,a.bF)(o,{name:"Horario"}),(0,a.bF)(f,{class:"col column"},{default:(0,a.k6)(function(){return[(0,a.bF)(c,{modelValue:e.nemo,"onUpdate:modelValue":n[0]||(n[0]=function(n){return e.nemo=n}),onSeleccionar:e.loadImage,campos:["NEMO","NEMODES","INSTRUCOD","GRADOCOD","SECCIONCOD"],todos:!0},null,8,["modelValue","onSeleccionar"]),e.permiso?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[e.vacio?((0,a.uX)(),(0,a.CE)("div",i,[(0,a.bF)(u,{subtitle:"validaciones.seleccioneSalon",icon:"wallpaper"})])):((0,a.uX)(),(0,a.CE)("div",r,[(0,a.bF)(g,{onUpload:e.added,onDelete:e.eliminarImg,botones:!!e.objImage.src,icon:"wallpaper",title:"Seleccione una imagen",src:e.objImage.src,allow:["jpg","png","jpeg","bmp","pdf"],hideEventUpload:!!e.objImage.src},{print:(0,a.k6)(function(){return[(0,a.bF)(m,{color:"primary",icon:"print",round:"",onClick:e.onPrint},null,8,["onClick"])]}),"preload-image":(0,a.k6)(function(){return[e.objImage.src?((0,a.uX)(),(0,a.Wv)(d,{key:0,class:"col",src:e.objImage.src},null,8,["src"])):(0,a.Q3)("v-if",!0)]}),_:1},8,["onUpload","onDelete","botones","src","hideEventUpload"])]))],64)):((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[e.vacio?((0,a.uX)(),(0,a.CE)("div",t,[(0,a.bF)(u,{subtitle:"horario.msjImagen",icon:"wallpaper"})])):((0,a.uX)(),(0,a.CE)("div",s,[(0,a.Lk)("div",l,[(0,a.bF)(m,{color:"primary",icon:"print",onClick:e.onPrint,round:""},null,8,["onClick"])]),(0,a.bF)(d,{class:"col",src:e.objImage.src},null,8,["src"])]))],64)),(0,a.bF)(C,{class:"bg-white",visible:e.visible},{default:(0,a.k6)(function(){return[(0,a.bF)(p,{size:"50px",color:"primary"})]}),_:1},8,["visible"])]}),_:1})]}),_:1})]}),_:1})}var u=o(99550),m=o.n(u),d=o(76080),g=o.n(d),p=o(45254),C=o.n(p),f=(o(30683),o(56285),o(6123)),v=o(88275),b=o(59089),O=o(80340),I=o(56089),h=o(88567),D=o(95718),j=o(33950),k=o(57668),S=o(47206),w=o(78131),y=o(80660),A={components:{QInnerLoading:f.SQ,QSpinnerOval:f.VA,SieSalones:v.Ay,SieUpload:b.A,SieVacio:O.A,QIframe:I.A,QCard:h.A,QCardSection:D.A,QPage:f.Tu,QBtn:f.Il},data:function(){return{objImage:{},vacio:!0,visible:!1,ngs:[],permiso:!1,nemo:""}},methods:{loadImage:function(e){var n=this;return C()(g()().m(function o(){var a,i,r,t;return g()().w(function(o){while(1)switch(o.p=o.n){case 0:return n.vacio=!0,n.visible=!0,o.p=1,e.INSTRUCOD||(e.INSTRUCOD="T"),e.GRADOCOD||(e.GRADOCOD="T"),e.SECCIONCOD||(e.SECCIONCOD="T"),o.n=2,y.$http.get("api/HyowImgHorario/horario/info/".concat(e.INSTRUCOD,"/").concat(e.GRADOCOD,"/").concat(e.SECCIONCOD));case 2:a=o.v,i=a.file,r=a.name,t={origin:"".concat((0,y.getBase)(),"/api/HyowImgHorario/horario/").concat(i),type:-1===r.indexOf(".pdf")?"image":"pdf",name:r},t.src=(0,S.linkPreview)(t.origin,n.$info),n.objImage=t,n.vacio=!1,o.n=4;break;case 3:o.p=3,o.v,n.objImage={},n.vacio="T"===e.NEMO||!1===n.permiso;case 4:return o.p=4,n.visible=!1,n.ngs=e,o.f(4);case 5:return o.a(2)}},o,null,[[1,3,4,5]])}))()},addedFinal:function(e){var n,o=this,a=this.ngs,i="api/HyoArchivo/horario/upload";return n=this.objImage.src?"api/HyowImgHorario/updateImagen":"api/HyowImgHorario/grabarImagen",(0,j.Upload)({url:i,file:e}).then(function(e){var o={INSTRUCOD:a.INSTRUCOD,GRADOCOD:a.GRADOCOD,SECCIONCOD:a.SECCIONCOD,ARCHIVO:e.name};return y.$http.post(n,{datosimg:o})}).then(function(e){"m0001"===e.json&&(o.$q.dialog({title:"Proceso Finalizado",message:o.$t("mensajes."+e.json)}),o.loadImage(o.ngs)),"e0006"===e.json&&o.$q.dialog({title:"Advertencia",message:o.$t("mensajes."+e.json)})})},added:function(e){var n=this;return C()(g()().m(function o(){var a,i,r;return g()().w(function(o){while(1)switch(o.p=o.n){case 0:return a=m()(e,1),i=a[0],n.$q.loading.show(),o.p=1,o.n=2,n.addedFinal(i);case 2:o.n=4;break;case 3:o.p=3,r=o.v,console.error(r),n.$q.dialog({title:"Advertencia",message:n.$t("Vuelva a intentarlo")});case 4:return o.p=4,n.$q.loading.hide(),o.f(4);case 5:return o.a(2)}},o,null,[[1,3,4,5]])}))()},eliminarImg:function(){var e=this,n=this.ngs,o=this.$t.bind(this),a={INSTRUCOD:n.INSTRUCOD,GRADOCOD:n.GRADOCOD,SECCIONCOD:n.SECCIONCOD};this.$q.dialog({title:o("mensajes.m0006.confirmacion"),message:o("mensajes.m0010"),ok:o("botones.eliminar"),cancel:"Cancelar",preventClose:!0}).onOk(function(){y.$http.post("api/HyowImgHorario/eliminarFoto",{datosimg:a}).then(function(n){"m0006.ok"===n.json&&(e.$q.dialog({title:"Proceso Finalizado",message:o("mensajes."+n.json)}),e.objImage={}),"e0006"===n.json&&e.$q.dialog({title:"Error",message:o("mensajes."+n.json)})})}).onCancel(function(){})},onPrint:function(){if(this.objImage.src){var e=(0,S.linkDownload)(this.objImage.origin,this.$info);(0,w["default"])(e,this.objImage.name)}else this.$q.dialog({title:"Advertencia",message:"No existe el horario"})}},created:function(){var e=(0,k["default"])();this.permiso=e.esOtros&&3===e.ruta.nivel,this.$info=e}},E=o(12807);const N=(0,E.A)(A,[["render",c]]);var F=N}}]);