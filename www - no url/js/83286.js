"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[83286],{83286:function(e,o,t){t.r(o),t.d(o,{default:function(){return ce}});var r=t(61758),a={class:"row items-center no-wrap"},n={class:"col-auto"},i={class:"col-md-6 q-pb-md q-pr-sm"},l={class:"row q-ma-xs q-col-gutter-sm"},c={class:"col-xs-12"},s={class:"row q-ma-xs q-col-gutter-sm"},u={class:"col-xs-12"},d={class:"row q-ma-xs q-col-gutter-sm"},C={class:"col-xs-12 col-sm-6"},O={class:"col-xs-12 col-sm-6"},m={class:"row q-ma-xs q-col-gutter-sm"},f={class:"col-xs-12 col-sm-6"},p={class:"col-xs-12 col-sm-6"},A={class:"row q-ma-xs q-col-gutter-sm"},g={class:"col-xs-12 col-sm-6"},h={class:"col-xs-12 col-sm-6"},N={class:"row q-ma-xs q-col-gutter-sm"},D={class:"col-xs-12 col-sm-12"},w={class:"col-md-6 q-pb-md q-pr-sm"},v={class:"width col-md-6 q-pb-md q-pr-sm margin"};function I(e,o){var t=(0,r.g2)("q-btn"),I=(0,r.g2)("q-card-section"),E=(0,r.g2)("q-separator"),R=(0,r.g2)("q-select"),b=(0,r.g2)("q-input"),T=(0,r.g2)("q-checkbox"),k=(0,r.g2)("sie-grid"),S=(0,r.g2)("q-card");return(0,r.uX)(),(0,r.Wv)(S,null,{default:(0,r.k6)(function(){return[(0,r.bF)(I,null,{default:(0,r.k6)(function(){return[(0,r.Lk)("div",a,[o[9]||(o[9]=(0,r.Lk)("div",{class:"col"},[(0,r.Lk)("div",{class:"text-h6"},"Categorías de Cobro Anual")],-1)),(0,r.Lk)("div",n,[e.nivelAcceso>=2?((0,r.uX)(),(0,r.Wv)(t,{key:0,class:"q-mr-sm",icon:"add",color:"primary",label:"Nuevo",size:"sm",onClick:e.agregar},null,8,["onClick"])):(0,r.Q3)("v-if",!0)])])]}),_:1}),(0,r.bF)(E),(0,r.bF)(I,{class:"flex"},{default:(0,r.k6)(function(){return[(0,r.bF)(I,{style:{width:"60%"}},{default:(0,r.k6)(function(){return[(0,r.Lk)("div",i,[(0,r.Lk)("div",l,[(0,r.Lk)("div",c,[(0,r.bF)(R,{options:e.opAnios,"option-label":"label","option-value":"value",label:"Año",modelValue:e.form.ANO,"onUpdate:modelValue":o[0]||(o[0]=function(o){return e.form.ANO=o})},null,8,["options","modelValue"])])]),(0,r.Lk)("div",s,[(0,r.Lk)("div",u,[(0,r.bF)(R,{options:e.catOption,"option-label":"label","option-value":"value",label:"Categoria",modelValue:e.form.ID_CATEGORIA,"onUpdate:modelValue":o[1]||(o[1]=function(o){return e.form.ID_CATEGORIA=o})},null,8,["options","modelValue"])])]),(0,r.Lk)("div",d,[(0,r.Lk)("div",C,[(0,r.bF)(R,{options:e.opNivel,"option-label":"label","option-value":"value",label:"Nivel",onInput:e.getGrados,modelValue:e.form.INSTRUCOD,"onUpdate:modelValue":o[2]||(o[2]=function(o){return e.form.INSTRUCOD=o})},null,8,["options","onInput","modelValue"])]),(0,r.Lk)("div",O,[(0,r.bF)(R,{options:e.gradOption,"option-label":"label","option-value":"value",label:"Grado",modelValue:e.form.GRADOCOD,"onUpdate:modelValue":o[3]||(o[3]=function(o){return e.form.GRADOCOD=o})},null,8,["options","modelValue"])])]),(0,r.Lk)("div",m,[(0,r.Lk)("div",f,[(0,r.bF)(R,{options:e.secOp,"option-label":"label","option-value":"value",label:"Sección",modelValue:e.form.SECCIONCOD,"onUpdate:modelValue":o[4]||(o[4]=function(o){return e.form.SECCIONCOD=o})},null,8,["options","modelValue"])]),(0,r.Lk)("div",p,[(0,r.bF)(R,{options:e.monOption,"option-label":"label","option-value":"value",label:"Moneda",modelValue:e.form.MONCOD,"onUpdate:modelValue":o[5]||(o[5]=function(o){return e.form.MONCOD=o})},null,8,["options","modelValue"])])]),(0,r.Lk)("div",A,[(0,r.Lk)("div",g,[(0,r.bF)(b,{type:"number",label:"Monto",placeholder:"Ingrese monto",modelValue:e.form.MONTO,"onUpdate:modelValue":o[6]||(o[6]=function(o){return e.form.MONTO=o})},null,8,["modelValue"])]),(0,r.Lk)("div",h,[(0,r.bF)(b,{type:"number",label:"Descuento",placeholder:"Ingrese descuento",modelValue:e.form.DESCUENTO,"onUpdate:modelValue":o[7]||(o[7]=function(o){return e.form.DESCUENTO=o})},null,8,["modelValue"])])]),(0,r.Lk)("div",N,[(0,r.Lk)("div",D,[(0,r.bF)(T,{modelValue:e.repetir,"onUpdate:modelValue":o[8]||(o[8]=function(o){return e.repetir=o}),label:"Continuar Registrando"},null,8,["modelValue"])])])])]}),_:1}),(0,r.bF)(I,{style:{width:"40%"}},{default:(0,r.k6)(function(){return[(0,r.Lk)("div",w,[(0,r.Lk)("div",v,[(0,r.bF)(k,{class:"ag-theme-balham",columnDefs:e.columnDefsModal,frameworkComponents:e.frameworkComponentsModal,rowData:e.rowDataModal,onGridReady:e.onGridReadyModal,onRowClicked:e.configConceptos,style:{width:"350px",height:"280px"}},null,8,["columnDefs","frameworkComponents","rowData","onGridReady","onRowClicked"])])])]}),_:1})]}),_:1})]}),_:1})}var E=t(76080),R=t.n(E),b=t(45254),T=t.n(b),k=(t(30683),t(71225),t(74260),t(52133),t(10239),t(50310),t(5962),t(32203),t(6724),t(83190),t(36408)),S=t(96330),_=t(27560),G=t(80660),M=t(42037),U=t(19852),x=t(7729),V=t(30640),$=t(26697),q=t(53093),L=t(2739),F=t(43346),P=t(53811),B=t(88567),Q=t(95718),y=t(53380),K=t(99515),H=t(3112),z=t(93616),X=t(54489),Y=t(80340),j=t(6123),W=t(78840),J=["checked"];function Z(e,o){return(0,r.uX)(),(0,r.CE)("input",{type:"checkbox",onClick:o[0]||(o[0]=function(o){return e.checkedHandler(o,e.params)}),checked:e.params.value},null,8,J)}t(56285);var ee={name:"checkboxRender",props:{},methods:{checkedHandler:function(e,o){var t=o.data,r=o.name,a=t.CONCOB,n=e.target.checked;t[r]=n?a:{del:!0,CONCOB:a}}}},oe=t(12807);const te=(0,oe.A)(ee,[["render",Z]]);var re=te,ae=t(64208),ne=t(41615),ie={components:{actionButton:W.A,sieGrid:k.A,sieVacio:Y.A,headerGrid:S.A,footerGrid:_.A,sieSelect:z.A,QRadio:K.A,QForm:L.A,QCheckbox:H.A,createGrid:x.A,formulario:U.A,QCard:B.A,QCardSection:Q.A,QSeparator:y.A,QTabs:$.A,QTab:q.A,QTabPanels:P.A,QTabPanel:F.A,QPagination:j.ao,sieModal:V.A,QSearch:j.Ks,QSelect:X.S,QInput:ae.A,QBtn:j.Il},data:function(){return{rowData:[],openModal:!1,nivelAcceso:2,max:1,pagina:1,selectAnio:ne["default"].TOKEN_YEAR,instrucod:ne["default"].TODOS,anios:[],nivel:[],api:{},columnDefs:[],frameworkComponents:{},opAnios:[],opNivel:[],currentRow:[],del:[],idDel:0,filter:{ANO:ne["default"].TOKEN_YEAR,INSTRUCOD:ne["default"].TODOS},ID_CATEGORIA_ANO:0,mode:"insert",apiModal:[],frameworkComponentsModal:{},ID_CATEGORIA_CONCOB:0,repetir:!1,form:{ID_CATEGORIA_ANO:null,ANO:ne["default"].TOKEN_YEAR,INSTRUCOD:"",GRADOCOD:"",SECCIONCOD:"",MONCOD:"",MONTO:"",DESCUENTO:"",PERIODO_PAGO:1,ID_CATEGORIA:0},catOption:[],conceptosAgregar:[],nivOption:[],monOption:[],gradOption:[],opAniosModal:[],secOp:[],columnDefsModal:[],rowDataModal:[]}},computed:{},methods:{rowSelected:function(e){this.currentRow=e.data},getAnio:function(){var e=this;return T()(R()().m(function o(){return R()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,ne["default"].API_ANIOS();case 1:e.opAnios=o.v;case 2:return o.a(2)}},o)}))()},getNivel:function(){var e=this;return T()(R()().m(function o(){return R()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,ne["default"].API_NIVELES();case 1:e.opNivel=o.v;case 2:return o.a(2)}},o)}))()},onGridReady:function(e){this.api=e.api,this.api.sizeColumnsToFit()},agregar:function(){var e=this;return T()(R()().m(function o(){return R()().w(function(o){while(1)switch(o.n){case 0:return e.clear(),e.mode="insert",o.n=1,e.getConceptos();case 1:e.rowDataModal=o.v,e.openModal=!0;case 2:return o.a(2)}},o)}))()},filterOptions:function(){var e=this;return T()(R()().m(function o(){var t,r,a,n;return R()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,G.$http.get("api/CategoriaCobroController/getCategoriaAnioCobro",{params:{params:{concepto:"combo"}}});case 1:return t=o.v,r=t.filter(function(o){return o.MONTO===e.currentRow.MONTO}),o.n=2,G.$http.get("api/CategoriaCobroController/getCategoriaConcepto");case 2:a=o.v,n=a.filter(function(e){return r[0]["ID_CATEGORIA_ANO"]===e.ID_CATEGORIA_ANO}),e.del=[],e.openModal=!0,n.map(function(o){return e.del.push({label:o.CONDES,value:o.ID_CATEGORIA_CONCOB})});case 3:return o.a(2)}},o)}))()},searchCategoria:function(){var e=this;return T()(R()().m(function o(){return R()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,e.getCategoriaCobro();case 1:e.rowData=o.v;case 2:return o.a(2)}},o)}))()},getCategoriaCobro:function(){var e=this;return T()(R()().m(function o(){return R()().w(function(o){while(1)switch(o.n){case 0:return o.a(2,G.$http.get("api/CategoriaCobroController/getCategoriaAnioCobro",{params:{params:{ano:e.filter.ANO,instrucod:e.filter.INSTRUCOD}}}))}},o)}))()},created:function(){var e=this;return T()(R()().m(function o(){var t;return R()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,e.getCategoriaCobro();case 1:t=o.v,e.columnDefs=[{headerName:"Id",field:"ID_CATEGORIA_ANO",width:50},{headerName:"Categoría",field:"CATEGORIA",width:200},{headerName:"Año",field:"ANIO",width:70},{headerName:"Nivel",field:"INSTRUDES",width:120},{headerName:"Grado",field:"GRADODES",width:120},{headerName:"Sección",field:"SECCIONDES",width:80},{headerName:"Moneda",field:"MONEDA",width:80},{headerName:"Monto",field:"MONTO",width:80,valueFormatter:M.toFixed,cellClass:"text-right"},{headerName:"Desc.",field:"DESCUENTO",width:80,valueFormatter:M.toFixed,cellClass:"text-right"},{cellRenderer:W.A,cellRendererParams:{icon:"edit",onClick:function(){var o=T()(R()().m(function o(t){return R()().w(function(o){while(1)switch(o.n){case 0:return e.form.ID_CATEGORIA_ANO=t.data.ID_CATEGORIA_ANO,e.mode="update",e.clear(),o.n=1,e.filterCategoriaCon();case 1:e.openModal=!0;case 2:return o.a(2)}},o)}));function t(e){return o.apply(this,arguments)}return t}()},width:50},{cellRenderer:W.A,cellRendererParams:{icon:"delete",onClick:function(){var o=T()(R()().m(function o(t){return R()().w(function(o){while(1)switch(o.n){case 0:e.$confirm("¿Esta seguro de eliminar la categoría?","delete").onOk(T()(R()().m(function o(){var r,a;return R()().w(function(o){while(1)switch(o.p=o.n){case 0:return o.p=0,o.n=1,G.$http.get("api/CategoriaAnoController/getverificarAsignacionAlumno",{params:{parametros:{id_categoria_ano:t.data.ID_CATEGORIA_ANO}}});case 1:if(r=o.v,"ok"===r){o.n=2;break}return o.a(2,e.$alert("Error no se completo la ejecución : Existen (".concat(r.data.registros,') registros relacionados con la categoria "').concat(t.data.DESCRIPCION,'" para el año ').concat(t.data.ANO),"warning"));case 2:return o.n=3,G.$http.delete("api/CategoriaAnoController/deleteCategoriaAno",{params:{id:t.data.ID_CATEGORIA_ANO}});case 3:return o.n=4,e.getCategoriaCobro();case 4:e.rowData=o.v,e.$alert("Categoria Eliminado(a) Correctamente","success"),o.n=6;break;case 5:o.p=5,a=o.v,e.$alert(a.error.message);case 6:return o.a(2)}},o,null,[[0,5]])})));case 1:return o.a(2)}},o)}));function t(e){return o.apply(this,arguments)}return t}()},width:50}],e.rowData=t;case 2:return o.a(2)}},o)}))()},onGridReadyModal:function(e){this.apiModal=e},configConceptos:function(e){if(e.data[void 0].del)return this.conceptosAgregar=this.conceptosAgregar.filter(function(o){return o.CONCOB!==e.data["undefined"].CONCOB}),!0;this.conceptosAgregar.push({CONCOB:e.data[void 0]})},getSecciones:function(){var e=this;return T()(R()().m(function o(){return R()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,ne["default"].API_SECCIONES(e.form.GRADOCOD,e.form.INSTRUCOD);case 1:e.secOp=o.v;case 2:return o.a(2)}},o)}))()},getConceptos:function(){return T()(R()().m(function e(){return R()().w(function(e){while(1)switch(e.n){case 0:return e.a(2,G.$http.get("api/CalendarController/getConceptos"))}},e)}))()},getMonedas:function(){var e=this;return T()(R()().m(function o(){return R()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,ne["default"].API_MONEDAS();case 1:e.monOption=o.v;case 2:return o.a(2)}},o)}))()},getGrados:function(){var e=this;return T()(R()().m(function o(){return R()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,ne["default"].API_GRADOS(e.form.INSTRUCOD);case 1:e.gradOption=o.v;case 2:return o.a(2)}},o)}))()},registrarCategoria:function(){var e=this;this.$confirm("¿ Estas seguro de registrar la categoría?").onOk(T()(R()().m(function o(){var t,r;return R()().w(function(o){while(1)switch(o.p=o.n){case 0:return o.p=0,o.n=1,G.$http.post("api/CategoriaAnoController/addCategoriaAno",{data:{form:{ANO:e.form.ANO,INSTRUCOD:e.form.INSTRUCOD,GRADOCOD:e.form.GRADOCOD,SECCIONCOD:e.form.SECCIONCOD,MONCOD:e.form.MONCOD,MONTO:e.form.MONTO,DESCUENTO:e.form.DESCUENTO,PERIODO_PAGO:1,ID_CATEGORIA:e.form.ID_CATEGORIA},conceptos:e.conceptosAgregar}});case 1:return t=o.v,e.repetir||(e.clear(),e.openModal=!1),o.n=2,e.getCategoriaCobro();case 2:e.rowData=o.v,e.$alert(t.message,"success"),o.n=4;break;case 3:o.p=3,r=o.v,e.$alert(r.error.message,"warning");case 4:return o.a(2)}},o,null,[[0,3]])})))},nuevaCategoria:function(){return this.form.ANO?this.form.ID_CATEGORIA?this.form.INSTRUCOD?this.form.GRADOCOD?this.form.SECCIONCOD?this.form.MONCOD?0===this.conceptosAgregar.length?this.$alert("No se seleccionó ningun concepto para la categoría","warning"):this.registrarCategoria():this.$alert("No seleccionó la moneda","warning"):this.$alert("No seleccionó la seccion","warning"):this.$alert("No seleccionó el grado","warning"):this.$alert("No seleccionó el nivel","warning"):this.$alert("No se seleccionó la categoria","warning"):this.$alert("No se seleccionó el año","warning")},updateCalendario:function(){var e=this;this.$confirm("Estas seguro de guardar los cambios?").onOk(T()(R()().m(function o(){var t;return R()().w(function(o){while(1)switch(o.p=o.n){case 0:if(o.p=0,0!==e.conceptosAgregar.length){o.n=1;break}return o.a(2,e.$alert("No se seleccionó ningun concepto","warning"));case 1:return o.n=2,G.$http.post("api/CategoriaAnoController/updateCalendario",{params:{form:{ID_CATEGORIA_ANO:e.form.ID_CATEGORIA_ANO,ANO:e.form.ANO,INSTRUCOD:e.form.INSTRUCOD,GRADOCOD:e.form.GRADOCOD,SECCIONCOD:e.form.SECCIONCOD,MONCOD:e.form.MONCOD,MONTO:e.form.MONTO,DESCUENTO:e.form.DESCUENTO,PERIODO_PAGO:1,ID_CATEGORIA:e.form.ID_CATEGORIA},conceptos:e.conceptosAgregar}});case 2:return o.n=3,e.getCategoriaCobro();case 3:e.rowData=o.v,e.openModal=!1,e.$alert("Categoría Actualizada Satisfactoriamente","success"),o.n=5;break;case 4:o.p=4,t=o.v,e.$alert(t.error.message,"warning");case 5:return o.a(2)}},o,null,[[0,4]])})))},submit:function(){if("insert"===this.mode)return this.nuevaCategoria();this.updateCalendario()},filterCategoriaCon:function(){var e=this;return T()(R()().m(function o(){var t,r,a,n,i;return R()().w(function(o){while(1)switch(o.n){case 0:if(0===e.form.ID_CATEGORIA_ANO){o.n=4;break}return o.n=1,G.$http.get("api/CategoriaAnoController/getCategoriaAno",{params:{parametros:{joins:"listar"}}});case 1:return t=o.v,o.n=2,G.$http.get("api/CategoriaCobroControlle/getCategoriaConcepto");case 2:return r=o.v,a=r.filter(function(o){return o.ID_CATEGORIA_ANO===e.form.ID_CATEGORIA_ANO}),n=t.find(function(o){return o.ID_CATEGORIA_ANO===e.form.ID_CATEGORIA_ANO}),a.map(function(o){return e.conceptosAgregar.push({CONCOB:o.CONCOB})}),o.n=3,e.getConceptos();case 3:i=o.v,i.map(function(o){e.conceptosAgregar.map(function(e){o.CHECKED||(o.CHECKED=e.CONCOB===o.CONCOB)})}),e.getGrados(),e.form.ID_CATEGORIA=n["ID_CATEGORIA"],e.form.ANO=n["ANO"],e.form.INSTRUCOD=n["INSTRUCOD"],e.form.GRADOCOD=n["GRADOCOD"],e.form.SECCIONCOD=n["SECCIONCOD"],e.form.MONCOD=n["MONCOD"],e.form.MONTO=n["MONTO"],e.form.DESCUENTO=n["DESCUENTO"],e.rowDataModal=i;case 4:return o.a(2)}},o)}))()},clear:function(){this.form.ID_CATEGORIA="",this.form.INSTRUCOD="",this.form.GRADOCOD="",this.form.SECCIONCOD="",this.form.MONCOD="",this.form.MONTO="",this.form.DESCUENTO="",this.conceptosAgregar=[]},getCategoriaCobroModal:function(){var e=this;return T()(R()().m(function o(){var t;return R()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,G.$http.get("api/CategoriaCobroController/getCategoriaCobro");case 1:t=o.v,t.map(function(o){return e.catOption.push({label:o.DESCRIPCION,value:o.ID_CATEGORIA})});case 2:return o.a(2)}},o)}))()}},beforeMount:function(){var e=this;return T()(R()().m(function o(){return R()().w(function(o){while(1)switch(o.n){case 0:return e.frameworkComponents={actionButton:W.A},e.frameworkComponentsModal={checkboxRender:re,actionButton:W.A},e.columnDefsModal=[{cellRenderer:re,width:30,field:"CHECKED",headerName:""},{headerName:"Código",field:"CONCOB"},{headerName:"Concepto",field:"CONDES"}],o.n=1,e.getConceptos();case 1:e.rowDataModal=o.v,e.created();case 2:return o.a(2)}},o)}))()},mounted:function(){this.getAnio(),this.getNivel(),this.getCategoriaCobroModal(),this.getConceptos(),this.getMonedas(),this.getAnio(),this.getSecciones()}};const le=(0,oe.A)(ie,[["render",I]]);var ce=le}}]);