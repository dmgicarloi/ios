"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[59491],{59491:function(a,o,n){n.r(o),n.d(o,{default:function(){return Pa}});var e=n(8445),t=n.n(e),r=n(61758),i=n(58790),s={class:"row q-card q-pa-sm gutter-xs"},l={class:"col-1"},c={key:0,class:"col-xs-12 col-md-2"},u={class:"col-xs-12 col-md-3"},d={class:"col-xs-12 col-md-4"},p={class:"col-xs-12 col-md-2"},m={key:0,class:"col column"},f={key:0,class:"col column relative-position q-mt-lg-sm"},v={class:"contentGrillaScroll q-ma-lg-md"},C={class:"grillaScroll"},g={class:"headGrid"},h={class:"fijo"},k={key:0,class:"th nota_etapa_ant"},b={class:"tr"},E={class:"th titulo"},O={class:"tr"},A={class:"th fecha"},N={class:"totales"},L={class:"th"},F={class:"bodyGrid bgEvenOdd"},_={class:"tr"},I={class:"fijo"},R={class:"td numord"},D={class:"td nomcomp"},S={class:"td ndic"},P={key:0,class:"td nota_etapa_ant"},U={key:0,class:"boxContenido"},T={key:0,class:"calificacion"},M=["onClick"],w={class:"box-nota"},y=["onClick"],q={class:"fecha_ea"},V={key:1,class:"boxContenido"},x={class:"row"},X={class:"col"},G={class:"totales"},Q={class:"td"},j={class:"bodyGrid footerGrid"},K={class:"tr"},z={class:"fijo"},B={class:"td textR"},W={class:"totales"},Y={class:"td"},$={class:"leyendaGrilla"},H={class:"row q-pa-sm"},J={class:"col"},Z={class:"comentario"},aa={class:"row q-pa-sm"},oa={class:"col-12"};function na(a,o){var n=(0,r.g2)("sie-select"),e=(0,r.g2)("sie-salones"),na=(0,r.g2)("sie-vacio"),ea=(0,r.g2)("q-spinner-oval"),ta=(0,r.g2)("q-inner-loading"),ra=(0,r.g2)("q-icon"),ia=(0,r.g2)("q-inputV1"),sa=(0,r.g2)("q-form"),la=(0,r.g2)("detalle-entrega"),ca=(0,r.g2)("q-toolbar-title"),ua=(0,r.g2)("sie-modal"),da=(0,r.g2)("q-input"),pa=(0,r.g2)("q-field"),ma=(0,r.g2)("q-tooltip"),fa=(0,r.g2)("q-fab-action"),va=(0,r.g2)("q-fab"),Ca=(0,r.g2)("q-page-sticky"),ga=(0,r.g2)("q-page");return(0,r.uX)(),(0,r.Wv)(ga,{class:"column bg-white"},{default:(0,r.k6)(function(){return[(0,r.Lk)("div",s,[(0,r.Lk)("div",l,[(0,r.bF)(n,{type:"outlined",modelValue:a.ano,"onUpdate:modelValue":o[0]||(o[0]=function(o){return a.ano=o}),options:a.years,val:"ANO",label:"ANO",placeholder:"ano"},null,8,["modelValue","options"])]),a.ano?((0,r.uX)(),(0,r.CE)("div",c,[(0,r.bF)(e,{modelValue:a.vmFiltro.nemo,"onUpdate:modelValue":o[1]||(o[1]=function(o){return a.vmFiltro.nemo=o}),onSeleccionar:a.cambiarSalon,campos:["NEMO","NEMODES","INSTRUCOD","GRADOCOD","SECCIONCOD","TIPCAL","TIPO"],noClass:!1,ano:a.ano,gradonivel:!0,recuperacion:!0,todos:!1},null,8,["modelValue","onSeleccionar","ano"])])):(0,r.Q3)("v-if",!0),(0,r.Lk)("div",u,[(0,r.bF)(n,{type:"outlined",modelValue:a.vmFiltro.cursogrupo,"onUpdate:modelValue":o[2]||(o[2]=function(o){return a.vmFiltro.cursogrupo=o}),options:a.cursos,val:"KEYCURSOGRUPO",label:"CURSONOM",placeholder:"curso",onInput:a.cambiarCurso},null,8,["modelValue","options","onInput"])]),(0,r.Lk)("div",d,[(0,r.bF)(n,{type:"outlined",modelValue:a.vmFiltro.indice,"onUpdate:modelValue":o[3]||(o[3]=function(o){return a.vmFiltro.indice=o}),options:a.competencias,val:"INDICE",label:"DESCRIPCION",placeholder:"Competencia",onInput:a.cambiarCompetencia},null,8,["modelValue","options","onInput"])]),(0,r.Lk)("div",p,[(0,r.bF)(n,{type:"outlined",modelValue:a.vmFiltro.periodo,"onUpdate:modelValue":o[4]||(o[4]=function(o){return a.vmFiltro.periodo=o}),options:a.periodos,label:"DESCRIPCION",val:"ID_ETAPA",placeholder:"Etapa",onInput:a.cambiarPeriodo},null,8,["modelValue","options","onInput"])])]),0===a.dataContenidos.length?((0,r.uX)(),(0,r.CE)("div",m,[(0,r.bF)(na,{class:"col"})])):((0,r.uX)(),(0,r.CE)(r.FK,{key:1},[a.bolCargandoTabla?((0,r.uX)(),(0,r.CE)("div",f,[(0,r.bF)(ta,null,{default:(0,r.k6)(function(){return[(0,r.bF)(ea,{size:"50px",color:"primary"})]}),_:1})])):((0,r.uX)(),(0,r.CE)(r.FK,{key:1},[(0,r.bF)(sa,{class:"col q-pr-sm",ref:"form"},{default:(0,r.k6)(function(){return[(0,r.Lk)("div",v,[(0,r.Lk)("div",C,[(0,r.Lk)("div",g,[(0,r.Lk)("div",h,[o[10]||(o[10]=(0,r.Lk)("div",{class:"th numord"},[(0,r.Lk)("span",null,"Nro. Orden")],-1)),o[11]||(o[11]=(0,r.Lk)("div",{class:"th nomcomp"},[(0,r.Lk)("span",null,"Alumno")],-1)),o[12]||(o[12]=(0,r.Lk)("div",{class:"th ndic"},[(0,r.Lk)("span",null,"Nota Anual (Dic.)")],-1)),a.dataAlumnos[0].contenidos[0]["infoCR"]["etapa"]>1?((0,r.uX)(),(0,r.CE)("div",k,t()(o[9]||(o[9]=[(0,r.Lk)("span",null,"Nota Etapa Recuperación",-1)])))):(0,r.Q3)("v-if",!0)]),(0,r.Lk)("div",null,[(0,r.Lk)("div",b,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(a.dataContenidos,function(a){return(0,r.uX)(),(0,r.CE)("div",E,[(0,r.Lk)("span",null,(0,i.v_)(a.titulo),1)])}),256))]),(0,r.Lk)("div",O,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(a.dataContenidos,function(a){return(0,r.uX)(),(0,r.CE)("div",A,[(0,r.Lk)("span",null,(0,i.v_)(a.fecha),1)])}),256))])]),(0,r.Lk)("div",N,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(a.keysTotales,function(a){return(0,r.uX)(),(0,r.CE)("div",L,[(0,r.Lk)("span",null,(0,i.v_)(a),1)])}),256))])]),(0,r.Lk)("div",F,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(a.dataAlumnos,function(o){return(0,r.uX)(),(0,r.CE)("div",_,[(0,r.Lk)("div",I,[(0,r.Lk)("div",R,[(0,r.Lk)("span",null,(0,i.v_)(o.numord),1)]),(0,r.Lk)("div",D,[(0,r.Lk)("span",null,(0,i.v_)(o.nomcomp),1)]),(0,r.Lk)("div",S,[(0,r.Lk)("span",null,(0,i.v_)(o.nota_dic_comp),1)]),o.contenidos[0]["infoCR"]["etapa"]>1?((0,r.uX)(),(0,r.CE)("div",P,[(0,r.Lk)("span",null,(0,i.v_)(o.nota_etapa_ant),1)])):(0,r.Q3)("v-if",!0)]),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(o.contenidos,function(n){return(0,r.uX)(),(0,r.CE)("div",{class:(0,i.C4)(["td",[{bg_temprano:n.temprano,bg_tarde:n.tarde,bg_noEntregado:n.noEntregado,bg_noLeido:n.noLeido,bg_noAsignado:!n.asignado}]])},[n.asignado?((0,r.uX)(),(0,r.CE)(r.FK,{key:0},[n.esContenido?((0,r.uX)(),(0,r.CE)("div",U,[n.calificacion?((0,r.uX)(),(0,r.CE)("span",T,[(0,r.Lk)("div",{class:"box-icon-calificacion",onClick:function(e){return a.abrirModalCalificacion(n,o)}},[(0,r.bF)(ra,{name:n.inst_revisado?"notas2":"registro",size:"1.5rem"},null,8,["name"])],8,M),(0,r.Lk)("div",w,(0,i.v_)(n.nota),1),n.comentario.length>0?((0,r.uX)(),(0,r.CE)("div",{key:0,class:"box-icon-comentario",onClick:function(o){return a.abrirModalComentarioTarea(n.comentario)}},[(0,r.bF)(ra,{class:"color-icon-comentario",name:"comment",size:"1.5rem"})],8,y)):(0,r.Q3)("v-if",!0)])):(0,r.Q3)("v-if",!0),(0,r.Lk)("div",q,(0,i.v_)(n.fh_entrega_alumno),1)])):((0,r.uX)(),(0,r.CE)("div",V,[(0,r.Lk)("div",x,[(0,r.Lk)("div",X,[(0,r.bF)(ia,{class:"inputNota",outlined:"",modelValue:n.nota,"onUpdate:modelValue":function(a){return n.nota=a},rules:[a.rules],disable:!(a.vmFiltro.periodo===a.etapaActiva)&&a.notaBloqueada},null,8,["modelValue","onUpdate:modelValue","rules","disable"])]),(0,r.bF)(ra,{onClick:function(o){return a.abrirModalComentarioTareaEtapa(n)},name:"comment",size:"1.5rem",class:(0,i.C4)(n.comentarioEtapa?"color-icon-comentario":"color-icon-calificacion")},null,8,["onClick","class"])])]))],64)):(0,r.Q3)("v-if",!0)],2)}),256)),(0,r.Lk)("div",G,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(a.keysTotales,function(a,n){return(0,r.uX)(),(0,r.CE)("div",Q,[(0,r.Lk)("span",null,(0,i.v_)(o.totales[n]),1)])}),256))])])}),256))]),(0,r.Lk)("div",j,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(a.keysTotales,function(o,n){return(0,r.uX)(),(0,r.CE)("div",K,["totGenereal"===n?((0,r.uX)(),(0,r.CE)(r.FK,{key:0},[(0,r.Lk)("div",z,[(0,r.Lk)("div",{class:(0,i.C4)(["td textR",a.dataAlumnos[0].contenidos[0]["infoCR"]["etapa"]>1?"totalFooter2":"totalFooter"])},[(0,r.Lk)("span",null,(0,i.v_)(o),1)],2)]),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(a.dataContenidos,function(o){return(0,r.uX)(),(0,r.CE)("div",B,[(0,r.Lk)("span",null,(0,i.v_)(a.totalAlumnos),1)])}),256)),(0,r.Lk)("div",W,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(a.keysTotales,function(a,o){return(0,r.uX)(),(0,r.CE)("div",Y,"-")}),256))])],64)):(0,r.Q3)("v-if",!0)])}),256))])]),(0,r.Lk)("div",$,[(0,r.Lk)("ul",null,[o[16]||(o[16]=(0,r.Lk)("li",null,[(0,r.Lk)("span",{class:"boxLeyenda bg_noAsignado"}),(0,r.Lk)("span",{class:"descripcion"},"No Asignado")],-1)),o[17]||(o[17]=(0,r.Lk)("li",null,[(0,r.Lk)("span",{class:"boxLeyenda bg_temprano"}),(0,r.Lk)("span",{class:"descripcion"},"A tiempo")],-1)),o[18]||(o[18]=(0,r.Lk)("li",null,[(0,r.Lk)("span",{class:"boxLeyenda bg_tarde"}),(0,r.Lk)("span",{class:"descripcion"},"Fuera de tiempo")],-1)),o[19]||(o[19]=(0,r.Lk)("li",null,[(0,r.Lk)("span",{class:"boxLeyenda bg_noEntregado"}),(0,r.Lk)("span",{class:"descripcion"},"Sin entrega")],-1)),o[20]||(o[20]=(0,r.Lk)("li",null,[(0,r.Lk)("span",{class:"boxLeyenda bg_noLeido"}),(0,r.Lk)("span",{class:"descripcion"},"Sin leer")],-1)),(0,r.Lk)("li",null,[(0,r.Lk)("span",null,[(0,r.bF)(ra,{name:"registro",size:"1.5rem"})]),o[13]||(o[13]=(0,r.Lk)("span",{class:"descripcion"},"Instrumento de evaluación",-1))]),(0,r.Lk)("li",null,[(0,r.Lk)("span",null,[(0,r.bF)(ra,{name:"notas2",size:"1.5rem"})]),o[14]||(o[14]=(0,r.Lk)("span",{class:"descripcion"},"Nota Publicada",-1))]),(0,r.Lk)("li",null,[(0,r.Lk)("span",null,[(0,r.bF)(ra,{class:"color-icon-comentario",name:"comment",size:"1.5rem"})]),o[15]||(o[15]=(0,r.Lk)("span",{class:"descripcion"},"Conclusión",-1))])])])])]}),_:1},512),a.bolAbrirModalCalificacion?((0,r.uX)(),(0,r.Wv)(la,{key:0,modelValue:a.bolAbrirModalCalificacion,"onUpdate:modelValue":o[5]||(o[5]=function(o){return a.bolAbrirModalCalificacion=o}),id:a.evaluacion.id_contenido,alucod:a.evaluacion.estudiante.ALUCOD,title:"Tarea Calificada",contenido:a.contenido,ano:a.ano,indice:a.vmFiltro.indice,onClose:a.closeCalificacion},null,8,["modelValue","id","alucod","contenido","ano","indice","onClose"])):(0,r.Q3)("v-if",!0),(0,r.bF)(ua,{class:"modalComentarioTarea",modelValue:a.openModalComentario,"onUpdate:modelValue":o[6]||(o[6]=function(o){return a.openModalComentario=o}),title:"Conclusión",header:!0,footer:!1},{default:(0,r.k6)(function(){return[(0,r.bF)(ca,{class:"toolbar-title q-pt-md q-pb-none no-shadow"}),(0,r.Lk)("div",H,[(0,r.Lk)("div",J,[(0,r.Lk)("div",Z,(0,i.v_)(a.comentarioTarea),1)])])]}),_:1},8,["modelValue"]),(0,r.bF)(ua,{class:"modalComentarioTarea",modelValue:a.openModalComentarioEtapa,"onUpdate:modelValue":o[8]||(o[8]=function(o){return a.openModalComentarioEtapa=o}),title:"Conclusión Descriptiva",header:!0,footer:!1},{default:(0,r.k6)(function(){return[(0,r.bF)(ca,{class:"toolbar-title q-pt-md q-pb-none no-shadow"}),(0,r.Lk)("div",aa,[(0,r.Lk)("div",oa,[(0,r.bF)(pa,{helper:"Caracteres: ",count:300},{default:(0,r.k6)(function(){return[(0,r.bF)(da,{class:"q-if-outlined",modelValue:a.comentarioTareaEtapa.comentarioEtapa,"onUpdate:modelValue":o[7]||(o[7]=function(o){return a.comentarioTareaEtapa.comentarioEtapa=o}),type:"textarea",maxlength:"300","float-label":"Ingresar Conclusión Descriptiva",rows:"7"},null,8,["modelValue"])]}),_:1})])])]}),_:1},8,["modelValue"])],64))],64)),(0,r.bF)(Ca,{position:"bottom-right",offset:[20,20]},{default:(0,r.k6)(function(){return[(0,r.bF)(va,{icon:"more_vert",direction:"up",color:"secondary"},{default:(0,r.k6)(function(){return[a.acceso>=2?((0,r.uX)(),(0,r.Wv)(fa,{key:0,color:"secondary",icon:"save",onClick:a.grabarNotas},{default:(0,r.k6)(function(){return[(0,r.bF)(ma,{anchor:"center left",self:"center right"},{default:(0,r.k6)(function(){return t()(o[21]||(o[21]=[(0,r.eW)("Grabar",-1)]))}),_:1})]}),_:1},8,["onClick"])):(0,r.Q3)("v-if",!0),a.acceso>=2&&a.ano<=2022?((0,r.uX)(),(0,r.Wv)(fa,{key:1,color:"secondary",icon:"cogs",onClick:a.cerrarEtapa},{default:(0,r.k6)(function(){return[(0,r.bF)(ma,{anchor:"center left",self:"center right"},{default:(0,r.k6)(function(){return t()(o[22]||(o[22]=[(0,r.eW)("Cerrar Etapa",-1)]))}),_:1})]}),_:1},8,["onClick"])):(0,r.Q3)("v-if",!0),3==a.acceso?((0,r.uX)(),(0,r.Wv)(fa,{key:2,color:"secondary",icon:"lock_open",onClick:a.desbloquearNota},{default:(0,r.k6)(function(){return[(0,r.bF)(ma,{anchor:"center left",self:"center right"},{default:(0,r.k6)(function(){return t()(o[23]||(o[23]=[(0,r.eW)("Desbloquea las notas para editarlas",-1)]))}),_:1})]}),_:1},8,["onClick"])):(0,r.Q3)("v-if",!0)]}),_:1})]}),_:1})]}),_:1})}var ea=n(76080),ta=n.n(ea),ra=n(45254),ia=n.n(ra),sa=n(57008),la=n.n(sa),ca=n(99550),ua=n.n(ca),da=(n(30683),n(71225),n(39866),n(23825),n(77507),n(52133),n(10239),n(50310),n(5962),n(90095),n(6724),n(70199),n(11777),n(515),n(83190),n(49089),n(27153),n(52776),n(84433),n(39300),n(17225),n(28743),n(12858),n(32071),n(55520),n(2775),n(46203),n(62692),n(66307),n(81813),n(7346),n(13715),n(24066),n(6123)),pa=n(62760),ma=n(3927),fa=n(16648),va=n(9736),Ca=n(80340),ga=n(24974),ha=n(88275),ka=n(93616),ba=n(30640),Ea=n(75079),Oa=n(61828),Aa=n(78786),Na=n(982),La=n(69027),Fa=n(10213),_a=n(2739),Ia=n(57668),Ra={components:{QSelect:fa.S,QPageSticky:da._U,QFab:da.l6,QFabAction:da.B$,QInnerLoading:da.SQ,QSpinnerOval:da.VA,QInput:da.ie,QForm:_a.A,sieVacio:Ca.A,sieUsuario:ga.A,sieSalones:ha.Ay,sieSelect:ka.A,sieModal:ba.A,CalificarTarea:Ea.A,DetalleEntrega:Oa.A,QInputV1:va.A,QPage:da.Tu,QIcon:da.bP,QToolbarTitle:da.r_,QField:da.Om,QTooltip:da.nC},data:function(){return{etapaActiva:null,notaBloqueada:!0,ano:null,tipcal:null,cursocod:null,instrucod:null,gradocod:null,vmFiltro:{nemo:null,cursogrupo:null,periodo:null,indice:null},cursos:[],periodos:[],competencias:[],bolCargandoTabla:!1,bolAbrirModalCalificacion:!1,dataContenidos:[],dataAlumnos:[],openModalComentario:!1,openModalComentarioEtapa:!1,evaluacion:{id_contenido:null,estudiante:{},filtroUsuarios:[]},comentarioTarea:"",comentarioTareaEtapa:{comentarioEtapa:""},keysTotales:{totGenereal:"Total general",temprano:"Total a tiempo",tarde:"Total fuera de tiempo",noEntregado:"Total sin entrega",noLeido:"Total no leido"},configNota:{},years:[],contenido:{},totalAlumnos:0}},computed:{acceso:function(){return(0,Ia["default"])().ruta.nivel}},methods:{getCompetencias:function(){var a=this,o=this.vmFiltro.cursogrupo.split("-separador-"),n=ua()(o,1),e=n[0];if(this.instrucod&&this.gradocod&&e&&this.ano){var t={instrucod:this.instrucod,gradocod:this.gradocod,tipcal:this.tipcal,cursocod:e,anio:this.ano};pa.A.getCompetencias(t).then(function(o){o&&o.length>0&&(a.vmFiltro.indice=o[0].INDICE,a.competencias=o,a.mostrarTabla())})}},cambiarSalon:function(a){var o=this;this.cursos=[],this.periodos=[],this.gradocod=a.GRADOCOD,this.instrucod=a.INSTRUCOD,this.tipcal=a.TIPCAL;var n={nemo:a.NEMO,cursogrupo:null,periodo:null,indice:null};pa.A.getCursosPeriodos(n.nemo,this.ano,!0).then(function(a){var e=(0,ma["default"])(a.cursos.k,a.cursos.v).map(function(a){var o=a.CURSOCOD+"-separador-"+a.GRUPOCOD;return a.KEYCURSOGRUPO=o,null===n.cursogrupo&&(n.cursogrupo=o),a.CURSONOM=a.CURSOCOD+"- "+a.CURSONOM,a}),r=[];e=e.filter(function(a){return r.includes(a.CURSOCOD)||"001"===a.GRUPOCOD||(r.push(a.CURSOCOD),a.GRUPOCOD="001",a.CURSONOM=a.CURSONOM?a.CURSONOM.replace(/\([\wáéíóú\s]+\)/gi,"").replace(/\([\wáéíóú\s]+\)/gi,""):a.CURSONOM,a.DESCRIPCION=a.DESCRIPCION?a.DESCRIPCION.replace(/\([\wáéíóú\s]+\)/gi,"").replace(/\([\wáéíóú\s]+\)/gi,""):a.DESCRIPCION),"001"===a.GRUPOCOD}),e=e.map(function(a){return{CURSOCOD:a.CURSOCOD,NOMCOMP:a.NOMCOMP,CURSONOM:a.CURSONOM,GRUPOCOD:a.GRUPOCOD,DESCRIPCION:a.DESCRIPCION,KEYCURSOGRUPO:a.KEYCURSOGRUPO}}),e=t()(new Set(e.map(JSON.stringify))).map(JSON.parse);var i={};e.forEach(function(a){var o="".concat(a.CURSOCOD,"-").concat(a.CURSONOM,"-").concat(a.GRUPOCOD,"-").concat(a.KEYCURSOGRUPO);i[o]?i[o].NOMCOMP+="; ".concat(a.NOMCOMP):i[o]=la()({},a)}),e=Object.values(i),o.cursos=e,o.cursos.length>0&&(o.periodos=(0,ma["default"])(a.periodos.k,a.periodos.v).map(function(a){return a.BIMEDES="".concat([a.BIMECOD]," ").concat(a.PERIDES),1===a.ESTADO&&(n.periodo=a.ID_ETAPA),a})),o.vmFiltro=n,o.mostrarTabla()})},cambiarCurso:function(a){this.vmFiltro.indice=null,this.getCompetencias()},cambiarCompetencia:function(){this.mostrarTabla()},cambiarPeriodo:function(a){this.mostrarTabla()},mostrarTabla:function(){var a=this;return ia()(ta()().m(function o(){var n,e,t,r,i;return ta()().w(function(o){while(1)switch(o.p=o.n){case 0:if(a.notaBloqueada=!0,a.dataContenidos=[],a.dataAlumnos=[],!(!1===a.bolCargandoTabla&&a.vmFiltro.nemo&&a.vmFiltro.cursogrupo&&a.vmFiltro.periodo&&a.vmFiltro.indice)){o.n=5;break}return o.p=1,n=a.vmFiltro.cursogrupo.split("-separador-"),e=ua()(n,2),t=e[0],r=e[1],a.cursocod=t,a.bolCargandoTabla=!0,o.n=2,pa.A.consolidadoTareas(a.vmFiltro.nemo,t,r,a.vmFiltro.indice,a.vmFiltro.periodo);case 2:i=o.v,a.dataContenidos=i.dataContenidos,a.dataAlumnos=i.dataAlumnos,o.n=4;break;case 3:o.p=3,o.v;case 4:a.bolCargandoTabla=!1;case 5:return a.totalAlumnos=a.dataAlumnos.length,o.n=6,a.getConfigDesempenio();case 6:a.configNota=o.v;case 7:return o.a(2)}},o,null,[[1,3]])}))()},abrirModalComentarioTarea:function(a){this.openModalComentario=!0,this.comentarioTarea=a},abrirModalComentarioTareaEtapa:function(a){this.openModalComentarioEtapa=!0,this.comentarioTareaEtapa=a},abrirModalCalificacion:function(a,o){if(30===a.id_contenido_tipo)return!1;this.bolAbrirModalCalificacion=!0,this.evaluacion={id_contenido:a.id,estudiante:{USUCOD:o.usucod,ALUCOD:o.alucod,USUNOM:o.nomcomp,ENTREGA:!0},filtroUsuarios:[o.usucod]},this.contenido={ID_CONTENIDO:a.id,CALIFICACION:a.calificacion,BIMECOD:a.bimecod,NEMO:a.nemo,GRUPOCOD:a.grupocod,CURSOCOD:a.cursocod,USUCOD:a.usucod,COMPARTIDO:a.compartido,USARDRIVECLOUD:a.usardrivecloud,FH_ENTREGA:a.fh_entrega,FH_SERVIDOR:a.fh_servidor,INDICE_EVALUACION:a.indice_evaluacion,ID_CLASE_CONTENIDO:a.id_clase_contenido,EXTEMPORANEO:a.extemporaneo}},closeCalificacion:function(){this.bolAbrirModalCalificacion=!1,this.mostrarTabla()},desbloquearNota:function(){(0,La.alertModal)(this.$t("aviso"),'Las notas seran editables, solo para esta sesión. \nLuego de editar las notas debe Ejecutar el proceso "Cerrar Etapa"'),this.notaBloqueada=!1},cerrarEtapaPromGuiada:function(a){for(var o=this,n=[],e=[],t=[],r="Se realiza el cierre de etapa, ¿ desea ejecutarlo ?",i=0;i<a.length;i++){var s=/[0-9]/.test(a[i].nota),l=s?a[i].nota<11:["C","",null,void 0].includes(a[i].nota),c=s?a[i].nota>10:["AD","A","B"].includes(a[i].nota);l&&n.push(a[i].id_alumno_anual),c&&e.push(a[i])}if(e.length>0&&(t=this.validarDatos(e,!0),r="Se realizará el cierre de etapa. Asimismo, a los alumnos que aprobaron, se reprocesarán las notas anuales. Click en Aceptar para continuar con el proceso."),!n.length&&!e.length)return(0,Na["default"])("No existen registros para procesar","warning"),!1;(0,Fa.confirm)(r).onOk(function(){pa.A.cerrarEtapa(o.vmFiltro.indice,o.instrucod,o.gradocod,o.cursocod,o.vmFiltro.periodo,n,t).then(function(a){(0,Na["default"])(a.message,"success")}).catch(function(a){(0,Na["default"])(a.message,"warning")})})},getNotaEquivale:function(a,o){var n=a;return o&&o.length>0&&o.forEach(function(o,e){a&&Math.round(a)>=parseInt(o.NOTAINI)&&Math.round(a)<=parseInt(o.NOTAFIN)&&(n=o.LETRA)}),n},cerrarEtapaRecPedag:function(a){var o=this;return ia()(ta()().m(function n(){var e,t,r,i,s,l,c,u,d,p,m,f,v,C,g;return ta()().w(function(n){while(1)switch(n.n){case 0:return e=[],t={ano:o.ano,instrucod:o.instrucod,gradocod:o.gradocod,cursocod:o.cursocod},r="Se realiza el cierre de etapa, ¿ desea ejecutarlo ?",i=!1,s=["C","",null,void 0],n.n=1,pa.A.getDatosCursoPerSocial(t);case 1:return l=n.v,n.n=2,pa.A.getDatosEquiNota(t);case 2:c=n.v,u=c.json.notas,d=l.length>0,p=a[0].contenidos[0].infoCR,d&&s.push("B"),m=0;case 3:if(!(m<a.length)){n.n=8;break}if(""!==a[m].nota&&(i=!0),f=/[0-9]/.test(a[m].nota),v=a[m].nota,f&&(v=o.getNotaEquivale(v,u)),1!==p.etapa){n.n=7;break}C=!1,g=o.instrucod,n.n="S"===g||"B"===g?4:"P"===g?5:6;break;case 4:return C=s.includes(v),n.a(3,6);case 5:return d&&(C=s.includes(v)),n.a(3,6);case 6:C&&e.push(a[m].id_alumno_anual);case 7:m++,n.n=3;break;case 8:if(i){n.n=9;break}return(0,Na["default"])("No existen calificaciones requeridas para procesar","warning"),n.a(2,!1);case 9:e.length>0&&(r="Se realiza el cierre de etapa, existen estudiantes que iran a Acompañamiento. ¿ desea ejecutarlo ?"),(0,Fa.confirm)(r).onOk(ia()(ta()().m(function a(){var n,t;return ta()().w(function(a){while(1)switch(a.p=a.n){case 0:return a.p=0,a.n=1,pa.A.cerrarEtapaRecPedag(o.vmFiltro.indice,o.instrucod,o.gradocod,o.cursocod,o.vmFiltro.periodo,e);case 1:n=a.v,(0,Na["default"])(n.message,"success"),a.n=3;break;case 2:a.p=2,t=a.v,(0,Na["default"])(t.message,"warning");case 3:return a.a(2)}},a,null,[[0,2]])})));case 10:return n.a(2)}},n)}))()},cerrarEtapa:function(){var a=this;return ia()(ta()().m(function o(){var n,e;return ta()().w(function(o){while(1)switch(o.n){case 0:if(n=a.dataAlumnos,e=a.validarDatos(n),!e.length){o.n=1;break}return(0,Na["default"])("Debe guardar los cambios antes de Cerrar la etapa","warning"),o.a(2,!1);case 1:if(a.vmFiltro.periodo){o.n=2;break}return(0,Na["default"])("Debe selecionar  la etapa","warning"),o.a(2,!1);case 2:a.ano>=2023?a.cerrarEtapaRecPedag(n,e):a.cerrarEtapaPromGuiada(n);case 3:return o.a(2)}},o)}))()},validarDatos:function(a,o){var n=[];"undefined"===typeof o&&(o=!1);for(var e=0;e<a.length;e++){var t=a[e],r=t.contenidos[0];if(!r.esContenido){var i=r.nota!==r.notaIni||r.comentarioEtapa!==r.comentarioEtapaIni||o;if(i){var s=r.nota,l=this.validarIngresoNota(s);if(!0===l){s=s.toUpperCase();var c=r.infoCR,u=0;u=this.ano>=2023?this.estadoNota2023(s,this.configNota):this.estadoNota(s,this.configNota),c.nota=s,c.comentarioEtapa=r.comentarioEtapa,c.nemo=t.nemo,c.cursocod=this.cursocod,c.indice=this.vmFiltro.indice,c.alucod=t.alucod,c.estado=u,c.nota_etapa_ant=t.nota_etapa_ant,n.push(c)}}}}return n},registrarNotasPromGuiada:function(){var a=this;return ia()(ta()().m(function o(){var n,e;return ta()().w(function(o){while(1)switch(o.p=o.n){case 0:if(n=a.validarDatos(a.dataAlumnos),!(n.length>0)){o.n=5;break}return o.p=1,o.n=2,pa.A.registrarNotas(a.ano,n);case 2:e=o.v,(0,Na["default"])(e.message,"success"),a.mostrarTabla(),o.n=4;break;case 3:o.p=3,o.v,(0,Na["default"])("No se pudo grabar","warning");case 4:o.n=6;break;case 5:(0,Na["default"])(a.$t("mensajes.a0025"),"warning");case 6:return o.a(2)}},o,null,[[1,3]])}))()},registrarNotasRecPedag:function(){var a=this;return ia()(ta()().m(function o(){var n,e,t,r,i,s,l,c,u,d,p,m,f,v;return ta()().w(function(o){while(1)switch(o.p=o.n){case 0:if(n=a.validarDatos(a.dataAlumnos),!(n.length>0)){o.n=15;break}return o.p=1,o.n=2,pa.A.registrarNotasRecPedag(a.ano,n);case 2:if(e=o.v,(0,Na["default"])(e.message,"success"),!(e.actualizados.length>0)){o.n=12;break}t=[],r=n[0].etapa,f=r,o.n=1===f?3:2===f?10:12;break;case 3:for(i=0;i<n.length;i++)t.push(n[i].alucod);return s={ano:a.ano,cursocod:a.cursocod,instrucod:a.instrucod,gradocod:a.gradocod,etapaActiva:a.etapaActiva,arrAlumnos:t},o.n=4,pa.A.revisarNotasCompAreaPendientes(s);case 4:return l=o.v,c={ano:a.ano,instrucod:a.instrucod,gradocod:a.gradocod,etapaActiva:a.etapaActiva,arrAlumnos:t},o.n=5,pa.A.revisarNotasPendientes(c);case 5:if(u=o.v,d="Procesando notas de las competencias para las notas anuales del area",l.length>0&&u.length>0&&(d="Procesando notas de las competencias para las notas anuales y el cierre de año escolar"),(l.length>0||u.length>0)&&(0,Na["default"])(d,"success"),!(l.length>0)){o.n=7;break}return o.n=6,pa.A.calculoNotasAnualesReqRecupera(l,s);case 6:o.n=8;break;case 7:return o.n=8,pa.A.revertirNotasSituacionAlumnoRecupera(n,s);case 8:if(!(u.length>0)){o.n=9;break}return o.n=9,pa.A.cierreAnoEscolarReqRecupera(u,c);case 9:return(l.length>0||u.length>0)&&(0,Na["default"])("Proceso Finalizado","success"),o.a(3,12);case 10:for(p=0;p<n.length;p++)t.push(n[p].alucod);return m={ano:a.ano,instrucod:a.instrucod,gradocod:a.gradocod,etapaActiva:a.etapaActiva,arrAlumnos:t},o.n=11,pa.A.actualizarAcompanamiento(n,m);case 11:return o.a(3,12);case 12:a.mostrarTabla(),o.n=14;break;case 13:o.p=13,v=o.v,console.log(v),(0,Na["default"])("No se pudo grabar","warning");case 14:o.n=16;break;case 15:(0,Na["default"])(a.$t("mensajes.a0025"),"warning");case 16:return o.a(2)}},o,null,[[1,13]])}))()},preValidaRegEtapa2:function(){var a=this;return ia()(ta()().m(function o(){var n,e,t,r,i,s,l,c;return ta()().w(function(o){while(1)switch(o.n){case 0:for(n=a.validarDatos(a.dataAlumnos),e=[],t=0;t<n.length;t++)e.push(n[t].alucod);if(!(n[0].etapa>=2)){o.n=1;break}return o.a(2,0);case 1:return r=a.vmFiltro.cursogrupo.split("-separador-"),i=ua()(r,1),s=i[0],l={instrucod:a.instrucod,gradocod:a.gradocod,cursocod:s,ano:a.ano,alumnos:e,indice:a.vmFiltro.indice},o.n=2,pa.A.getTotalAluAcompanamiento(l);case 2:return c=o.v,o.a(2,c.TOTALES)}},o)}))()},grabarNotas:function(){var a=this;return ia()(ta()().m(function o(){var n,e;return ta()().w(function(o){while(1)switch(o.n){case 0:if(!(a.ano>=2023)){o.n=2;break}return n="Existen uno o más estudiantes relacionados a la etapa de acompanamiento y tienen notas, desea aun así actualizar la información?",o.n=1,a.preValidaRegEtapa2();case 1:e=o.v,e>0?(0,Fa.confirm)(n).onOk(function(){a.registrarNotasRecPedag()}):a.registrarNotasRecPedag(),o.n=3;break;case 2:a.registrarNotasPromGuiada();case 3:return o.a(2)}},o)}))()},estadoNota:function(a,o){var n=0;if(a.length>0)if(o.sinNota===a)n=null;else{var e=o.valorAprobado;if(o.usarArrEscala)for(var t=0;t<o.notasEscala.length;t++){var r=o.notasEscala[t];if(a===r.nota){n=r.valorCalculo>=e?1:0;break}}else{for(var i=0;i<o.escalaExtraNumeros.length;i++){var s=o.escalaExtraNumeros[i];s.nota===a&&(a=s.valorCalculo)}this.isNumeric(a)&&(n=a>=e?1:0)}}return n},estadoNota2023:function(a,o){var n=0;if(a.length>0)if(o.sinNota===a)n=null;else{o.valorAprobado;if(o.usarArrEscala)for(var e=0;e<o.notasEscala.length;e++){var t=o.notasEscala[e];if(a===t.nota){n=1;break}}else{for(var r=0;r<o.escalaExtraNumeros.length;r++){var i=o.escalaExtraNumeros[r];i.nota===a&&(a=i.valorCalculo)}this.isNumeric(a)&&(n=1)}}return n},isNumeric:function(a){return Number(a)},validarIngresoNota:function(a){a=null!==a?a.toUpperCase():a;var o=this.configNota,n=!0,e=!!a||n||"Debe colocar la nota",t=o.tipoCalculo;switch(t){case 0:a&&(e=-1!==(0,Aa["default"])(o.notasEscala,a,{key:"nota"})||"Calificaciones: "+o.notasEscala.map(function(a){return a.nota}).join(","));break;case 1:a&&(e=this.minPuntaje(a)||"La mínima nota es "+o.notaMin,this.minPuntaje(a)&&(e=this.maxPuntaje(a)||"La máxima nota es "+o.notaMax));break;case 2:a&&(e=this.minPuntaje(a)||n||"La mínima nota es "+o.notaMin,this.minPuntaje(a)&&(e=this.maxPuntaje(a)||n||"La máxima nota es "+o.notaMax));break}return e},rules:function(a){var o=this;return new Promise(function(n,e){setTimeout(function(){n(o.validarIngresoNota(a))},200)})},maxPuntaje:function(a){return parseInt(a)<=parseInt(this.configNota.notaMax)},minPuntaje:function(a){return parseInt(a)>=parseInt(this.configNota.notaMin)},getConfigDesempenio:function(){if(!this.vmFiltro.indice||!this.cursocod)return!1;var a={nemo:this.vmFiltro.nemo,periodo:1,cursocod:this.cursocod,id_clase_contenido:null,ano:this.ano,indice:this.vmFiltro.indice,isCalificaCarpeta:!0};return pa.A.getConfiguracionSalon(a)},listarAnios:function(){var a=this;pa.A.getAnios().then(function(o){a.years=o})}},watch:{vmFiltro:function(a){this.getCompetencias()}},created:function(){var a=this;this.notaBloqueada=!0,pa.A.getAnio().then(function(o){a.etapaActiva=o.ID_ETAPA,a.ano=o.ANO}),this.listarAnios()}},Da=n(12807);const Sa=(0,Da.A)(Ra,[["render",na]]);var Pa=Sa}}]);