"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[58224],{58224:function(r,e,t){t.r(e),t.d(e,{default:function(){return W}});var o=t(61758),a=t(58790),n={key:2,class:"relative-position"};function i(r,e){var t=(0,o.g2)("sie-salones"),i=(0,o.g2)("sie-estudiantes"),l=(0,o.g2)("q-item-side"),u=(0,o.g2)("q-item-tile"),d=(0,o.g2)("q-item-main"),s=(0,o.g2)("q-item"),c=(0,o.g2)("q-list"),f=(0,o.g2)("q-popover"),m=(0,o.g2)("q-card"),p=(0,o.g2)("q-scroll-area"),h=(0,o.g2)("sie-vacio"),b=(0,o.g2)("q-btn"),g=(0,o.g2)("q-toolbar-title"),v=(0,o.g2)("q-toolbar"),O=(0,o.g2)("sie-modal"),C=(0,o.g2)("modalCrearCarpeta"),I=(0,o.g2)("sie-cloud"),k=(0,o.g2)("sie-pdf"),T=(0,o.g2)("q-page-sticky"),F=(0,o.g2)("q-page"),A=(0,o.gN)("close-overlay");return(0,o.uX)(),(0,o.Wv)(F,{class:"col-auto column no-wrap"},{default:(0,o.k6)(function(){return["005"!==r.sie.tipcod&&"004"!==r.sie.tipcod?((0,o.uX)(),(0,o.Wv)(t,{key:0,modelValue:r.nemo,"onUpdate:modelValue":e[0]||(e[0]=function(e){return r.nemo=e}),onSeleccionar:r.cargarOrganizadores,campos:["NEMO","NEMODES","INSTRUCOD","GRADOCOD"],todos:!1},null,8,["modelValue","onSeleccionar"])):((0,o.uX)(),(0,o.Wv)(i,{key:1,modelValue:r.alucod,"onUpdate:modelValue":e[1]||(e[1]=function(e){return r.alucod=e}),onSelected:r.cargarOrganizadores,campos:["NEMO"]},null,8,["modelValue","onSelected"])),r.list.length?((0,o.uX)(),(0,o.CE)("div",n,[(0,o.bF)(p,{style:(0,a.Tr)(r.isLess?"005"!==r.sie.tipcod&&"004"!==r.sie.tipcod?"height:83vh":"height: 91vh":"005"!==r.sie.tipcod&&"004"!==r.sie.tipcod?"height:84vh":"height: 92vh")},{default:(0,o.k6)(function(){return[(0,o.bF)(m,null,{default:(0,o.k6)(function(){return[(0,o.bF)(c,{class:"q-pa-none",link:"",separator:""},{default:(0,o.k6)(function(){return[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.list,function(e,t){return(0,o.uX)(),(0,o.Wv)(s,{key:t},{default:(0,o.k6)(function(){return[(0,o.bF)(l,{"text-color":"amber",icon:"folder"}),(0,o.bF)(d,{onClick:function(t){return r.openModal(e)}},{default:(0,o.k6)(function(){return[(0,o.bF)(u,{label:"",color:"primary"},{default:(0,o.k6)(function(){return[(0,o.eW)((0,a.v_)(e.TITULO),1)]}),_:2},1024),(0,o.bF)(u,{sublabel:""},{default:(0,o.k6)(function(){return[(0,o.eW)((0,a.v_)(e.ANOTACION),1)]}),_:2},1024)]}),_:2},1032,["onClick"]),r.tienePermiso?((0,o.uX)(),(0,o.Wv)(l,{key:0},{default:(0,o.k6)(function(){return[(0,o.bF)(u,{class:"cursor-pointer",icon:"more_vert"},{default:(0,o.k6)(function(){return[(0,o.bF)(f,null,{default:(0,o.k6)(function(){return[(0,o.bF)(c,{class:"no-border",link:""},{default:(0,o.k6)(function(){return[r.permisoEditar?(0,o.bo)(((0,o.uX)(),(0,o.Wv)(s,{key:0,onClick:function(t){return r.abrirModalCrearCarpeta("editar",e)}},{default:(0,o.k6)(function(){return[(0,o.bF)(d,{label:r.$t("botones.editar")},null,8,["label"])]}),_:1},8,["onClick"])),[[A]]):(0,o.Q3)("v-if",!0),r.permisoEditar?(0,o.bo)(((0,o.uX)(),(0,o.Wv)(s,{key:1,onClick:function(t){return r.abrirModalCrearCarpeta("crearHijo",e)}},{default:(0,o.k6)(function(){return[(0,o.bF)(d,{label:r.$t("crearCarpeta")},null,8,["label"])]}),_:1},8,["onClick"])),[[A]]):(0,o.Q3)("v-if",!0),r.permisoEditar?(0,o.bo)(((0,o.uX)(),(0,o.Wv)(s,{key:2,onClick:function(t){return r.subirArchivos(e.ID)}},{default:(0,o.k6)(function(){return[(0,o.bF)(d,{label:r.$t("subirArchivo")},null,8,["label"])]}),_:1},8,["onClick"])),[[A]]):(0,o.Q3)("v-if",!0),3===r.sie.ruta.nivel?(0,o.bo)(((0,o.uX)(),(0,o.Wv)(s,{key:3,onClick:function(t){return r.eliminarCarpeta(e)}},{default:(0,o.k6)(function(){return[(0,o.bF)(d,{label:r.$t("botones.eliminar")},null,8,["label"])]}),_:1},8,["onClick"])),[[A]]):(0,o.Q3)("v-if",!0)]}),_:2},1024)]}),_:2},1024)]}),_:2},1024)]}),_:2},1024)):(0,o.Q3)("v-if",!0)]}),_:2},1024)}),128))]}),_:1})]}),_:1})]}),_:1},8,["style"])])):((0,o.uX)(),(0,o.Wv)(h,{key:3,class:"col",subtitle:"Agregar Carpeta",icon:"person"})),(0,o.bF)(O,{class:"silabus",modelValue:r.modal,"onUpdate:modelValue":e[3]||(e[3]=function(e){return r.modal=e}),title:r.organizador.TITULO,footer:!0,ref:"modal",header:!r.hasProperty(r.organizador,"idParent"),loading:r.loading,ok:!1},{header:(0,o.k6)(function(){return[r.hasProperty(r.organizador,"idParent")?((0,o.uX)(),(0,o.Wv)(v,{key:0},{default:(0,o.k6)(function(){return[(0,o.bF)(b,{flat:"",round:"",dense:"",icon:"arrow_back",onClick:e[2]||(e[2]=function(e){return r.getOrganizadorParent()})}),(0,o.bF)(g,null,{default:(0,o.k6)(function(){return[(0,o.eW)((0,a.v_)(r.organizador.TITULO),1)]}),_:1})]}),_:1})):(0,o.Q3)("v-if",!0)]}),default:(0,o.k6)(function(){return[(0,o.bF)(c,{link:"","no-border":""},{default:(0,o.k6)(function(){return[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.organizador.list,function(e,t){return(0,o.uX)(),(0,o.Wv)(s,{key:t},{default:(0,o.k6)(function(){return[(0,o.bF)(l,{icon:r.getIcon(e).icon,color:r.getIcon(e).color,onClick:function(t){return r.getOrganizadorChildren(e)}},null,8,["icon","color","onClick"]),(0,o.bF)(d,{label:e.TITULO,onClick:function(t){return r.getOrganizadorChildren(e)}},null,8,["label","onClick"]),r.tienePermiso?((0,o.uX)(),(0,o.Wv)(l,{key:0},{default:(0,o.k6)(function(){return[(0,o.bF)(u,{class:"cursor-pointer",icon:"more_vert"},{default:(0,o.k6)(function(){return[(0,o.bF)(f,null,{default:(0,o.k6)(function(){return[(0,o.bF)(c,{class:"no-border",link:""},{default:(0,o.k6)(function(){return["folder"===r.getIcon(e).icon&&r.permisoEditar?(0,o.bo)(((0,o.uX)(),(0,o.Wv)(s,{key:0,onClick:function(t){return r.abrirModalCrearCarpeta("editar",e,"C")}},{default:(0,o.k6)(function(){return[(0,o.bF)(d,{label:r.$t("botones.editar")},null,8,["label"])]}),_:1},8,["onClick"])),[[A]]):(0,o.Q3)("v-if",!0),"folder"!==r.getIcon(e).icon&&r.permisoEditar?(0,o.bo)(((0,o.uX)(),(0,o.Wv)(s,{key:1,onClick:function(t){return r.abrirModalCrearCarpeta("editar",e,"A")}},{default:(0,o.k6)(function(){return[(0,o.bF)(d,{label:r.$t("botones.editar")},null,8,["label"])]}),_:1},8,["onClick"])),[[A]]):(0,o.Q3)("v-if",!0),"folder"===r.getIcon(e).icon&&r.permisoEditar?(0,o.bo)(((0,o.uX)(),(0,o.Wv)(s,{key:2,onClick:function(t){return r.abrirModalCrearCarpeta("crearHijo",e,"C")}},{default:(0,o.k6)(function(){return[(0,o.bF)(d,{label:r.$t("crearCarpeta")},null,8,["label"])]}),_:1},8,["onClick"])),[[A]]):(0,o.Q3)("v-if",!0),"folder"===r.getIcon(e).icon&&r.permisoEditar?(0,o.bo)(((0,o.uX)(),(0,o.Wv)(s,{key:3,onClick:function(t){return r.subirArchivos(e.ID)}},{default:(0,o.k6)(function(){return[(0,o.bF)(d,{label:r.$t("subirArchivo")},null,8,["label"])]}),_:1},8,["onClick"])),[[A]]):(0,o.Q3)("v-if",!0),"folder"!==r.getIcon(e).icon&&r.sie.ruta.nivel>=1?(0,o.bo)(((0,o.uX)(),(0,o.Wv)(s,{key:4,onClick:function(t){return r.donwloadArchivo(e,"download")}},{default:(0,o.k6)(function(){return[(0,o.bF)(d,{label:r.$t("botones.descargar")},null,8,["label"])]}),_:1},8,["onClick"])),[[A]]):(0,o.Q3)("v-if",!0),3===r.sie.ruta.nivel?(0,o.bo)(((0,o.uX)(),(0,o.Wv)(s,{key:5,onClick:function(t){return r.eliminarCarpeta(e)}},{default:(0,o.k6)(function(){return[(0,o.bF)(d,{label:r.$t("botones.eliminar")},null,8,["label"])]}),_:1},8,["onClick"])),[[A]]):(0,o.Q3)("v-if",!0)]}),_:2},1024)]}),_:2},1024)]}),_:2},1024)]}),_:2},1024)):(0,o.Q3)("v-if",!0)]}),_:2},1024)}),128))]}),_:1})]}),_:1},8,["modelValue","title","header","loading"]),(0,o.bF)(C,{modelValue:r.modalCrear,"onUpdate:modelValue":e[4]||(e[4]=function(e){return r.modalCrear=e}),data:r.dataModalCrear,modo:r.modoModalCrear,onClick:r.crearCarpeta},null,8,["modelValue","data","modo","onClick"]),(0,o.bF)(O,{class:"subir-modal-organizador",modelValue:r.subir.modal,"onUpdate:modelValue":e[6]||(e[6]=function(e){return r.subir.modal=e}),title:r.subir.title,header:!0,footer:!0,ok:"Grabar",onSubmit:r.grabarArchivos},{default:(0,o.k6)(function(){return[(0,o.bF)(I,{modelValue:r.subir.adjuntos,"onUpdate:modelValue":e[5]||(e[5]=function(e){return r.subir.adjuntos=e})},null,8,["modelValue"])]}),_:1},8,["modelValue","title","onSubmit"]),(0,o.bF)(O,{class:"modal-visor-organizador",modelValue:r.visor.modal,"onUpdate:modelValue":e[7]||(e[7]=function(e){return r.visor.modal=e}),title:r.visor.title,header:!0,footer:!1,ok:!1},{default:(0,o.k6)(function(){return[r.visor.url?((0,o.uX)(),(0,o.Wv)(k,{key:0,class:"col",src:r.visor.url,style:{"min-height":"60vh","min-width":"50vw"}},null,8,["src"])):(0,o.Q3)("v-if",!0)]}),_:1},8,["modelValue","title"]),3===r.sie.ruta.nivel&&r.nemo?((0,o.uX)(),(0,o.Wv)(T,{key:4,position:"bottom-right",offset:[20,20]},{default:(0,o.k6)(function(){return[(0,o.bF)(b,{fab:"",round:"",color:"secondary",icon:"plus",onClick:e[8]||(e[8]=function(e){return r.abrirModalCrearCarpeta("crear")})})]}),_:1})):(0,o.Q3)("v-if",!0)]}),_:1})}var l=t(57008),u=t.n(l),d=t(76080),s=t.n(d),c=t(45254),f=t.n(c),m=(t(39866),t(52133),t(10239),t(56285),t(50310),t(6724),t(83190),{class:"row q-pa-sm"}),p={class:"col-12"},h={class:"col-12"};function b(r,e){var t=(0,o.g2)("q-input"),a=(0,o.g2)("q-field"),n=(0,o.g2)("sie-modal");return(0,o.uX)(),(0,o.Wv)(n,{modelValue:r.estado,"onUpdate:modelValue":e[2]||(e[2]=function(e){return r.estado=e}),title:"Nuevo Organizador",footer:!0,ref:"estado",header:!0,loading:!1,onSubmit:r.agregar,ok:r.$t("botones.guardar"),onShow:r.show},{default:(0,o.k6)(function(){return[(0,o.Lk)("div",m,[(0,o.Lk)("div",p,[(0,o.bF)(a,{error:r.v$.dataForm.TITULO.$error,"error-label":r.$t("validaciones.requerido"),count:100},{default:(0,o.k6)(function(){return[(0,o.bF)(t,{class:"q-if-outlined",modelValue:r.dataForm.TITULO,"onUpdate:modelValue":e[0]||(e[0]=function(e){return r.dataForm.TITULO=e}),"float-label":r.$t("titulo")+"*",onBlur:r.v$.dataForm.TITULO.$touch},null,8,["modelValue","float-label","onBlur"])]}),_:1},8,["error","error-label"])]),(0,o.Lk)("div",h,[(0,o.bF)(t,{class:"q-if-outlined",modelValue:r.dataForm.ANOTACION,"onUpdate:modelValue":e[1]||(e[1]=function(e){return r.dataForm.ANOTACION=e}),type:"textarea","float-label":"DescripciÃ³n","max-height":100,rows:"1"},null,8,["modelValue"])])])]}),_:1},8,["modelValue","onSubmit","ok","onShow"])}var g=t(83972),v=t(6123),O=t(82640),C=t(30640),I={setup:function(){var r=(0,g.fG)();return{v$:r}},emits:["update:modelValue","input","click"],components:{SieModal:C.A,QModal:v.tU,QDialog:v.OQ,QModalLayout:v.hT,QToolbar:v.ZV,QToolbarTitle:v.r_,QBtn:v.Il,QField:v.Om,QInput:v.ie,QToggle:v.c5,QTabs:v.uw,QTab:v.zu,QTabPane:v.dg},props:{modelValue:{type:Boolean,default:!1},modo:{type:String},clickHandler:{type:Function},data:{type:Object}},data:function(){return{}},computed:{estado:{get:function(){return this.modelValue},set:function(r){this.$emit("update:modelValue",r),this.$emit("input",r)}},dataForm:function(){return this.data}},methods:{show:function(){this.v$.dataForm.$reset(),"editar"!==this.modo&&this.limpiar()},limpiar:function(){this.dataForm.TITULO="",this.dataForm.ANOTACION=""},agregar:function(){this.v$.dataForm.$touch(),this.v$.dataForm.$error||this.$emit("click",this.dataForm)},hasProperty:function(r,e){return r.hasOwnProperty(e)}},validations:{dataForm:{TITULO:{required:O.mw,maxLength:(0,O.Ru)(100)}}}},k=t(12807);const T=(0,k.A)(I,[["render",b]]);var F=T,A=t(96122),D=t(88275),_=t(92173),y=t(80340),N=t(32195),U=t(84603),E=t(69027),L=t(81288),Q=t(57668),R=t(80660),V=t(982),$=t(85540),z=t(99637),M=t(78131),w={emits:["update:permiso"],components:{modalCrearCarpeta:F,QScrollArea:A.A,QPageSticky:v._U,SieModal:C.A,QChip:v.wQ,SieSalones:D.Ay,sieEstudiantes:_.Ay,sieCloud:N.A,SieVacio:y.A,siePdf:U.A,permiso:!0,QPage:v.Tu,QCard:v.C$,QList:v.Mb,QItem:v.H0,QItemSide:v.n1,QItemMain:v.mF,QItemTile:v.lp,QPopover:v.VM,QToolbar:v.ZV,QBtn:v.Il,QToolbarTitle:v.r_},data:function(){return{sie:(0,Q["default"])(),nemo:"",alucod:null,list:[],modal:!1,modalCrear:!1,loading:!1,tienePermiso:3===(0,Q["default"])().ruta.nivel,accesoTotal:"T"===(0,Q["default"])().acceso_salon,modoModalCrear:"",dataModalCrear:{TITULO:"",ANOTACION:""},organizador:{},padres:{},subir:{id:null,modal:!1,adjuntos:[],title:"Adjuntar"},tipo:"",visor:{modal:!1,title:"",url:""}}},methods:{getOrganizadorParent:function(){var r=this.organizador.IDREF,e={ID:r,TITULO:this.padres[r].TITULO,IDREF:this.padres[r].IDREF};this.cargarDetalle(e)},getOrganizadorChildren:function(r){var e=this;return f()(s()().m(function t(){return s()().w(function(t){while(1)switch(t.n){case 0:"C"===r.TDOC?e.cargarDetalle(r):e.donwloadArchivo(r,"view");case 1:return t.a(2)}},t)}))()},openModal:function(r){var e=this;return f()(s()().m(function t(){return s()().w(function(t){while(1)switch(t.n){case 0:e.modal=!0,e.cargarDetalle(r);case 1:return t.a(2)}},t)}))()},cargarDetalle:function(r){var e=this;return f()(s()().m(function t(){var o,a;return s()().w(function(t){while(1)switch(t.n){case 0:return o={},r.IDREF&&(o.idParent=r.IDREF),e.loading=!0,t.n=1,e.cargarHijos(r.ID);case 1:a=t.v,o.TITULO=r.TITULO,o.IDREF=r.IDREF,o.ID=r.ID,o.list=a,e.organizador=o,e.loading=!1;case 2:return t.a(2)}},t)}))()},donwloadArchivo:function(r,e){var t="";r.URL?t=r.URL.split(".")[1]:(t=r.TITULO.split("."),t=t.pop()),"pdf"===t&&"view"===e?(this.visor.modal=!0,this.visor.title=r.TITULO,this.visor.url=(0,Q["default"])().api+"/HyoOrganizadoradjunto/vista/"+r.ID+"/?sie-token="+this.sie.token):(0,M["default"])((0,Q["default"])().api+"/HyoOrganizadoradjunto/archivo/"+r.ID+"?access_token="+this.sie.token,r.TITULO)},hasProperty:function(r,e){return r.hasOwnProperty(e)},getIcon:function(r){var e="";e=r.URL?r.URL:r.TITULO;var t=e.lastIndexOf("."),o=t>=0?e.substr(t+1,e.length):"folder";return(0,$.getIcon)(o)},abrirModalCrearCarpeta:function(r,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";this.modoModalCrear=r,"editar"===r&&(this.tipo=t,this.dataModalCrear.TITULO=e.TITULO,this.dataModalCrear.ANOTACION=e.ANOTACION,this.dataModalCrear.ID=e.ID,this.dataModalCrear.IDREF=e.IDREF),"crearHijo"===r&&(this.dataModalCrear.IDREF=e.ID),this.modalCrear=!0},crearCarpeta:function(r){var e=this;if(this.modalCrear=!1,"crearHijo"===this.modoModalCrear){var t=r.IDREF,o=r.TITULO,a=r.ANOTACION,n={ID_ORGANIZADOR_CONTENIDO_REF:t,TITULO:o,ANOTACION:a};n.NEMO=this.nemo,R.$http.post("api/HyoOrganizadorcontenido/crearContenido",{dato:n}).then(function(r){r.json;(0,V["default"])("Datos guardados")})}if("crear"===this.modoModalCrear){var i=r.TITULO,l=r.ANOTACION,u={TITULO:i,ANOTACION:l,NEMO:this.nemo};R.$http.post("api/HyoOrganizadorcontenido/crearContenido",{dato:u}).then(function(t){t.json;(0,V["default"])("Datos guardados"),e.cargarOrganizadores(),e.recargar(r.ID)})}if("editar"===this.modoModalCrear){var d=r.ANOTACION,s=r.TITULO,c=r.ID;"C"===this.tipo?R.$http.get("api/HyoOrganizadorcontenido/editarRepositorio",{params:{titulo:s,descripcion:d,id:c}}).then(function(t){t.json;(0,V["default"])("Editado correctamente"),e.recargar(r.ID)}):R.$http.get("api/HyoOrganizadoradjunto/editaDocumento",{params:{titulo:s,descripcion:d,id:c}}).then(function(t){t.json;(0,V["default"])("Editado correctamente"),e.recargar(r.ID)})}},eliminarCarpeta:function(r){var e=this,t=r.ID,o={id:t};(0,E.confirmar)(this.$t("mensajes.m0038"),function(){var a="";a=["B","N"].includes(r.TDOC)?"HyoOrganizadoradjunto/eliminaDocumento":"HyoOrganizadorcontenido/eliminarRepositorio",R.$http.get("api/".concat(a),{params:o}).then(function(r){(0,V["default"])("Se elimino Correctamente");try{e.recargar(t)}catch(r){console.error(r)}}).catch(function(r){(0,V["default"])("Error","warning")})})},recargar:function(r){if(this.padres[r]&&this.padres[r].IDREF){var e=u()({},this.organizador);this.cargarHijos(this.padres[r].IDREF).then(function(r){e.list=r}),this.organizador=e}else this.cargarOrganizadores()},cargarOrganizadores:function(r){var e=this,t=r?r.NEMO:this.nemo;R.$http.get("api/HyoOrganizadorcontenido/cargarOrganizadoresPadres",{params:{nemo:t}}).then(function(r){var t=r.json,o=u()({},e.padres),a=t?t.map(function(r){var e=r.ID_ORGANIZADOR_CONTENIDO,t=r.TITULO,a=r.ANOTACION,n=r.IDREF;r.TDOC;return o[e]={},o[e].IDREF=n,o[e].TITULO=t,{ID:e,TITULO:t,ANOTACION:a,IDREF:n}}):[];e.padres=o,e.list=a})},cargarHijos:function(r){var e=this;return R.$http.get("api/HyoOrganizadoradjunto/listarAdjuntos",{params:{idCont:r}}).then(function(r){var t=r.json,o=u()({},e.padres),a=t?t.map(function(r){var e=r.ID_ORGANIZADOR_CONTENIDO,t=r.ID_ORGANIZADOR_CONTENIDO_REF,a=r.TITULO,n=r.ANOTACION,i=r.TDOC,l=r.URL;return o.hasOwnProperty(e)||(o[e]={},o[e].IDREF=t,o[e].TITULO=a),{ID:e,TITULO:a,ANOTACION:n,IDREF:t,TDOC:i,URL:l}}):e.list;return e.padres=o,a})},grabar:function(r){console.log(r)},subirArchivos:function(r){this.subir.modal=!0,this.subir.id=r},grabarArchivos:function(r){var e=this,t=this.subir.adjuntos,o=[];(0,z["default"])(t,function(r){o.push({titulo:r.name,descripcion:"",repositorio:e.subir.id,tipo:r.esEnlace?"E":"B",archivo:r.url,temporal:r.temp})}),R.$http.post("api/HyoOrganizadoradjunto/registraArchivo",{datos:o}).then(function(r){(0,V["default"])("Se grabÃ³ correctamente","success"),e.subir.modal=!1,e.subir.adjuntos=[]})}},computed:{isLess:function(){return(0,L.isLess)()},acceso:{get:function(){return this.permiso},set:function(r){this.$emit("update:permiso",r)}},permisoEditar:function(){return this.sie.ruta.nivel>=2}}};const j=(0,k.A)(w,[["render",i]]);var W=j}}]);