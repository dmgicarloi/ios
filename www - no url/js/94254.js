"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[94254],{94254:function(e,o,a){a.r(o),a.d(o,{default:function(){return X}});var n=a(8445),t=a.n(n),i=a(61758),l=a(58790),r={class:"column",style:{display:"grid"}},s={class:"row"},c={class:"row justify-between"},u={class:"row"},d={class:"row"},f={class:"q-ma-sm"},p={class:"row"},m={class:"chip-container"},v={class:"row col justify-end"},M={class:"q-ma-xs"},b={class:"col row"},h={class:"col row"},O={class:"col row"},g={class:"col row"},k={class:"col border-field"},E={class:"leyenda"},R={class:"col row-md wrap justify-between q-ma-xs"},T={class:"q-ma-sm"},C={class:"col q-card"},w={class:"column"},A={class:"row-md col"},I={class:"row justify-center"},N={class:"row justify-center"},S={class:"row justify-center"},j={class:"row justify-around"};function U(e,o){var a=(0,i.g2)("header-btn"),n=(0,i.g2)("q-btn"),U=(0,i.g2)("q-checkbox"),V=(0,i.g2)("q-chip"),D=(0,i.g2)("q-toggle"),$=(0,i.g2)("q-select"),_=(0,i.g2)("q-field"),y=(0,i.g2)("sie-select"),q=(0,i.g2)("sie-modal"),F=(0,i.g2)("q-input"),P=(0,i.g2)("sie-editor"),L=(0,i.g2)("q-search"),x=(0,i.g2)("q-td"),z=(0,i.g2)("q-table");return(0,i.uX)(),(0,i.CE)("div",r,[(0,i.bF)(a,{name:"Notificaciones: Definición del responsable del Tipo de Reserva",buttons:e.buttons},null,8,["buttons"]),(0,i.bF)(q,{modelValue:e.estadoModal,"onUpdate:modelValue":o[5]||(o[5]=function(o){return e.estadoModal=o}),title:"Agregar Notificación",ok:!1,noClose:!0,escClick:!0,esc:!0},{footerMobile:(0,i.k6)(function(){return[(0,i.Lk)("div",s,[(0,i.bF)(n,{class:"q-ma-xs",dense:"",round:"",flat:"",icon:"close",onClick:e.cancelarAgregacion},null,8,["onClick"]),(0,i.bF)(n,{class:"q-ma-xs",dense:"",round:"",flat:"",icon:"save",onClick:e.ejecutarAccion},null,8,["onClick"])])]}),footer:(0,i.k6)(function(){return[(0,i.Lk)("div",c,[(0,i.Lk)("div",u,[(0,i.bF)(U,{class:"q-ma-xs",modelValue:e.insContinua,"onUpdate:modelValue":o[0]||(o[0]=function(o){return e.insContinua=o}),color:"secondary"},{default:(0,i.k6)(function(){return t()(o[13]||(o[13]=[(0,i.eW)("Repetir",-1)]))}),_:1},8,["modelValue"])]),(0,i.Lk)("div",d,[(0,i.bF)(n,{class:"q-ma-xs style-button",dense:"",color:"secondary",onClick:e.cancelarAgregacion},{default:(0,i.k6)(function(){return t()(o[14]||(o[14]=[(0,i.eW)("Cancelar",-1)]))}),_:1},8,["onClick"]),(0,i.bF)(n,{class:"q-ma-xs style-button",dense:"",color:"primary",onClick:e.ejecutarAccion},{default:(0,i.k6)(function(){return[(0,i.eW)((0,l.v_)(e.lbAccion),1)]}),_:1},8,["onClick"])])])]}),default:(0,i.k6)(function(){return[(0,i.Lk)("div",f,[(0,i.Lk)("div",p,[(0,i.Lk)("span",m,[(0,i.bF)(V,{square:"",color:0===e.datosModal.ESTADO?"grey":"green",style:{width:"155px",margin:"10px 6px 10px 0px"}},{default:(0,i.k6)(function(){return[(0,i.eW)("Estado: "+(0,l.v_)(e.datosModal.ESTADO?"Habilitado":"Desabilitado"),1)]}),_:1},8,["color"])]),(0,i.bF)(D,{modelValue:e.datosModal.ESTADO,"onUpdate:modelValue":o[1]||(o[1]=function(o){return e.datosModal.ESTADO=o}),"true-value":1,"false-value":0,color:0===e.datosModal.ESTADO?"grey":"green"},null,8,["modelValue","color"])]),(0,i.bF)(_,{error:e.v$.datosModal.TIPO_RESERVA_ID.$error,"error-label":e.$t("validaciones.requerido")},{default:(0,i.k6)(function(){return[(0,i.bF)($,{class:"q-if-outlined",modelValue:e.v$.datosModal.TIPO_RESERVA_ID.$model,"onUpdate:modelValue":o[2]||(o[2]=function(o){return e.v$.datosModal.TIPO_RESERVA_ID.$model=o}),options:e.tiposReserva,"float-label":"Tipo de Reserva",filter:"",placeholder:"Seleccione el tipo de reserva"},null,8,["modelValue","options"])]}),_:1},8,["error","error-label"]),(0,i.bF)(_,{error:e.v$.datosModal.TIPO.$error,"error-label":e.$t("validaciones.requerido")},{default:(0,i.k6)(function(){return[(0,i.bF)($,{class:"q-if-outlined",modelValue:e.v$.datosModal.TIPO.$model,"onUpdate:modelValue":o[3]||(o[3]=function(o){return e.v$.datosModal.TIPO.$model=o}),options:e.tipoNotificacion,"float-label":"Tipo de Notificación",filter:"",placeholder:"Seleccione el tipo de Notificación"},null,8,["modelValue","options"])]}),_:1},8,["error","error-label"]),(0,i.bF)(_,{error:e.v$.datosModal.USUCOD.$error,"error-label":e.$t("validaciones.requerido")},{default:(0,i.k6)(function(){return[(0,i.bF)(y,{class:"q-if-outlined select-usuarios",modelValue:e.v$.datosModal.USUCOD.$model,"onUpdate:modelValue":o[4]||(o[4]=function(o){return e.v$.datosModal.USUCOD.$model=o}),options:e.usuarios,label:"label",val:"value",placeholder:"Usuario",type:"outlined"},null,8,["modelValue","options"])]}),_:1},8,["error","error-label"])])]}),_:1},8,["modelValue"]),(0,i.bF)(q,{modelValue:e.modalMensaje,"onUpdate:modelValue":o[10]||(o[10]=function(o){return e.modalMensaje=o}),title:"Configuración de Mensajes",ok:!1,noClose:!0,escClick:!0,esc:!0},{footerMobile:(0,i.k6)(function(){return[(0,i.bF)(n,{class:"q-ma-xs style-button",dense:"",flat:"",rounr:"",icon:"close",onClick:e.cancelarMensaje},null,8,["onClick"]),(0,i.bF)(n,{class:"q-ma-xs style-button",dense:"",flat:"",rounr:"",icon:"save",onClick:e.grabarMensaje},null,8,["onClick"])]}),footer:(0,i.k6)(function(){return[(0,i.Lk)("div",v,[(0,i.bF)(n,{class:"q-ma-xs style-button",dense:"",color:"secondary",onClick:e.cancelarMensaje},{default:(0,i.k6)(function(){return t()(o[15]||(o[15]=[(0,i.eW)("Cerrar",-1)]))}),_:1},8,["onClick"]),(0,i.bF)(n,{class:"q-ma-xs style-button",dense:"",color:"primary",onClick:e.grabarMensaje},{default:(0,i.k6)(function(){return t()(o[16]||(o[16]=[(0,i.eW)("Grabar",-1)]))}),_:1},8,["onClick"])])]}),default:(0,i.k6)(function(){return[(0,i.Lk)("div",M,[(0,i.Lk)("div",b,[(0,i.bF)($,{class:"q-if-outlined col",modelValue:e.camposModalMensaje.TIPO,"onUpdate:modelValue":o[6]||(o[6]=function(o){return e.camposModalMensaje.TIPO=o}),options:e.tipoMensaje,"float-label":"Tipo de Mensaje",onInput:e.cargarMensaje},null,8,["modelValue","options","onInput"])]),(0,i.Lk)("div",h,[(0,i.bF)($,{class:"q-if-outlined col",modelValue:e.camposModalMensaje.MOMENTO,"onUpdate:modelValue":o[7]||(o[7]=function(o){return e.camposModalMensaje.MOMENTO=o}),options:e.momentoMensaje,"float-label":"Momento de Mensaje",onInput:e.cargarMensaje},null,8,["modelValue","options","onInput"])]),(0,i.Lk)("div",O,[(0,i.bF)(F,{class:"q-if-outlined col",modelValue:e.camposModalMensaje.ASUNTO,"onUpdate:modelValue":o[8]||(o[8]=function(o){return e.camposModalMensaje.ASUNTO=o}),"float-label":"Asunto"},null,8,["modelValue"])]),(0,i.Lk)("div",g,[(0,i.Lk)("fieldset",k,[(0,i.Lk)("legend",E,(0,l.v_)(e.$t("biblioteca.campos")),1),(0,i.Lk)("div",R,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.camposMensaje,function(o){return(0,i.uX)(),(0,i.CE)("div",{key:o.titulo,class:"col-5"},[(0,i.Lk)("b",null,(0,l.v_)(e.$t(o.titulo)+": "),1),(0,i.Lk)("span",null,(0,l.v_)(o.campo),1)])}),128))])])]),(0,i.bF)(P,{class:"col",modelValue:e.camposModalMensaje.MENSAJE,"onUpdate:modelValue":o[9]||(o[9]=function(o){return e.camposModalMensaje.MENSAJE=o}),label:e.$t("matricula.mensaje")},null,8,["modelValue","label"])])]}),_:1},8,["modelValue"]),(0,i.Lk)("div",T,[(0,i.Lk)("div",C,[(0,i.Lk)("div",w,[(0,i.Lk)("div",A,[(0,i.bF)(L,{class:"q-if-outlined col",modelValue:e.filtro,"onUpdate:modelValue":o[11]||(o[11]=function(o){return e.filtro=o})},null,8,["modelValue"]),(0,i.bF)($,{class:"q-if-outlined",modelValue:e.filtroTipoReserva,"onUpdate:modelValue":o[12]||(o[12]=function(o){return e.filtroTipoReserva=o}),options:e.tiposReserva,filter:"",multiple:"",chips:"",placeholder:"Tipos de Reserva",style:{width:"100%"},onInput:e.filtrarNotificaciones},null,8,["modelValue","options","onInput"])])]),(0,i.bF)(z,{data:e.notificaciones,columns:e.columns,filter:e.filtro,style:(0,l.Tr)({height:e.alto+"px"})},{"body-cell-NOMBRE":(0,i.k6)(function(e){return[(0,i.bF)(x,null,{default:(0,i.k6)(function(){return[(0,i.Lk)("div",I,(0,l.v_)(e.row.USUNOM),1)]}),_:2},1024)]}),"body-cell-ESTADO":(0,i.k6)(function(e){return[(0,i.bF)(x,null,{default:(0,i.k6)(function(){return[(0,i.Lk)("div",N,[(0,i.bF)(V,{flat:"",squared:"",style:{padding:"6px","font-size":"12px"},color:0===e.row.ESTADO?"grey":"green"},{default:(0,i.k6)(function(){return[(0,i.eW)((0,l.v_)(0===e.row.ESTADO?"Deshabilitado":"Habilitado"),1)]}),_:2},1032,["color"])])]}),_:2},1024)]}),"body-cell-TIPO":(0,i.k6)(function(e){return[(0,i.bF)(x,null,{default:(0,i.k6)(function(){return[(0,i.Lk)("div",S,(0,l.v_)(1===e.row.TIPO?"Reservar":"Cancelar"),1)]}),_:2},1024)]}),"body-cell-ACCIONES":(0,i.k6)(function(o){return[(0,i.bF)(x,{props:o},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",j,[(0,i.bF)(n,{color:"blue",icon:"edit",flat:"",dense:"",round:"",onClick:function(a){return e.mostrarModal(o.row)}},null,8,["onClick"]),(0,i.bF)(n,{color:"red",icon:"delete",flat:"",dense:"",round:"",onClick:function(a){return e.eliminarNotificacion(o.row)}},null,8,["onClick"])])]}),_:2},1032,["props"])]}),_:1},8,["data","columns","filter","style"])])])])}var V=a(76080),D=a.n(V),$=a(45254),_=a.n($),y=(a(77507),a(10239),a(50310),a(90095),a(48426),a(83190),a(44264),a(13715),a(83972)),q=a(30545),F=a(93616),P=a(30640),L=a(6123),x=a(24974),z=(a(69027),a(82640)),Q=a(57668),W=a(6083),H={setup:function(){var e=(0,y.fG)();return{v$:e}},components:{QTable:q.A,sieModal:P.A,QDatetime:L.T5,QSelect:L.Si,QTd:L.Ef,sieUsuario:x.A,QChip:L.wQ,QToggle:L.c5,QToolbar:L.ZV,sieSelect:F.A,sieEditor:W.A,QCheckbox:L.vZ,QBtn:L.Il,QField:L.Om,QInput:L.ie,QSearch:L.Ks},data:function(){return{size:"100%",modalMensaje:!1,mensajeConfig:{},permiso:(0,Q["default"])().ruta.nivel,lbAccion:"",estadoModal:!1,filtro:"",filtroTipoReserva:[],camposModalMensaje:{TIPO:0,MOMENTO:1,MENSAJE:null,ASUNTO:null},tipoMensaje:[{value:0,label:"Usuario"},{value:1,label:"Responsable"}],momentoMensaje:[{value:1,label:"Realizada"},{value:0,label:"Cancelación"}],insContinua:!1,datosModal:{ID:null,TIPO:null,TIPO_RESERVA_ID:null,USUARIO_ID:null,USUCOD:null,ESTADO:1},tipoNotificacion:[{label:"Reservar",value:1},{label:"Cancelar",value:0}],tiposReserva:[],notificaciones:[],usuarios:[],columns:[{name:"ID",label:"Id",field:"ID",align:"center",sortable:!0},{name:"NOMBRE",label:"Nombre",field:"NOMBRE",align:"center"},{name:"ESTADO",label:"Estado",field:"ESTADO",align:"center"},{name:"TIPO",label:"Tipo",field:"TIPO",align:"center"},{name:"TIPO_RESERVA",label:"Tipos de Reserva",field:"TIPO_RESERVA",align:"center"}]}},unmounted:function(){window.removeEventListener("resize",this.handleResize)},mounted:function(){var e=this;return _()(D()().m(function o(){var a;return D()().w(function(o){while(1)switch(o.n){case 0:return e.obtenerTiposReservas(),e.obtenerNotificaciones(),window.addEventListener("resize",e.handleResize),e.handleResize(),o.n=1,e.$http.get("api/UsuarioController/getComboUsuarios",{params:{info:{siscod:"21",tipcodsOmit:["004","005"]}}});case 1:e.usuarios=o.v,3===e.permiso&&e.columns.push({name:"ACCIONES",label:"Acciones",field:"ACCIONES",align:"center",style:"width: 90px"}),a=window.innerWidth,a<500&&(e.size=a-16+"px"),window.addEventListener("resize",e.onResize);case 2:return o.a(2)}},o)}))()},validations:function(){var e={TIPO:{required:z.mw},TIPO_RESERVA_ID:{required:z.mw},USUCOD:{required:z.mw},ESTADO:{required:z.mw}};return{datosModal:e}},computed:{buttons:function(){var e=[];return this.permiso>=2&&e.push({label:"Agregar Notificación",icon:"add",click:this.mostrarModal}),3===this.permiso&&e.push({label:"Configuración de Mensajes",icon:"email",click:this.mostrarModalMensaje}),e},camposMensaje:function(){var e=[{titulo:"Usuario",campo:"{{USUNOM}}"},{titulo:"Tipo de reserva",campo:"{{TIPO}}"},{titulo:"Unidad Reservable",campo:"{{UNIDAD}}"},{titulo:"Observacion Registrada",campo:"{{OBSERVACIONES}}"},{titulo:"Fecha",campo:"{{FECHA}}"},{titulo:"Hora de inicio",campo:"{{HORA_INICIO}}"},{titulo:"Hora de Fin",campo:"{{HORA_FIN}}"},{titulo:"Id de reserva",campo:"{{ID}}"}];return 1===this.camposModalMensaje.TIPO&&e.push({titulo:"Usuario Registrado",campo:"{{USUNOMRESERVA}}"}),e}},methods:{handleResize:function(){var e=210;this.alto=window.innerHeight-e},obtenerNotificaciones:function(){var e=this;return _()(D()().m(function o(){return D()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,e.$http.get("api/RsNotificacionController/getRsNotificacion",{params:{filtros:""}});case 1:e.notificaciones=o.v;case 2:return o.a(2)}},o)}))()},cargarMensaje:function(){var e=this.camposModalMensaje.TIPO.toString(),o=this.camposModalMensaje.MOMENTO;this.camposModalMensaje.MENSAJE=this.mensajeConfig[e][o]["MENSAJE"],this.camposModalMensaje.ASUNTO=this.mensajeConfig[e][o]["ASUNTO"]},mostrarModalMensaje:function(){var e=this;return _()(D()().m(function o(){return D()().w(function(o){while(1)switch(o.n){case 0:return e.modalMensaje=!0,o.n=1,e.$http("api/RsNotificacionMensajeController/getRsNotificacionMensaje");case 1:e.mensajeConfig=o.v,e.camposModalMensaje={TIPO:0,MOMENTO:1,MENSAJE:null,ASUNTO:null},e.cargarMensaje();case 2:return o.a(2)}},o)}))()},grabarMensaje:function(){var e=this;return _()(D()().m(function o(){var a,n;return D()().w(function(o){while(1)switch(o.p=o.n){case 0:return o.p=0,o.n=1,e.$http.post("api/RsNotificacionMensajeController/updateRsNotificacionMensaje",{data:e.camposModalMensaje});case 1:if(a=o.v,1!==a.code){o.n=3;break}return e.$notify(a.message,"success"),o.n=2,e.$http("api/RsNotificacionMensajeController/getRsNotificacionMensaje");case 2:e.mensajeConfig=o.v;case 3:o.n=5;break;case 4:o.p=4,n=o.v,e.$notify(n.error.message,"error");case 5:return o.a(2)}},o,null,[[0,4]])}))()},cancelarMensaje:function(){this.modalMensaje=!1},mostrarModal:function(e){e.ID?(this.lbAccion="Actualizar",this.datosModal=Object.assign({},e)):(this.limpiarCampos(),this.lbAccion="Agregar"),this.estadoModal=!0,this.insContinua=!1},ejecutarAccion:function(){this.v$.$touch(),this.v$.$error||(this.datosModal.ID?this.actualizarNotificacion():this.agregarNotificacion(),this.insContinua||(this.limpiarCampos(),this.estadoModal=!1))},agregarNotificacion:function(){var e=this;return _()(D()().m(function o(){var a,n,t;return D()().w(function(o){while(1)switch(o.p=o.n){case 0:return o.p=0,a={ESTADO:e.datosModal.ESTADO,TIPO:e.datosModal.TIPO,TIPO_RESERVA_ID:e.datosModal.TIPO_RESERVA_ID,USUARIO_ID:"SIE",USUCOD:e.datosModal.USUCOD},o.n=1,e.$http.post("api/RsNotificacionController/addRsNotificacion",{data:a});case 1:n=o.v,1===n.code&&(e.obtenerNotificaciones(),e.$notify("Agregado","success")),o.n=3;break;case 2:o.p=2,t=o.v,e.$notify(t.error.message,"error");case 3:return o.a(2)}},o,null,[[0,2]])}))()},actualizarNotificacion:function(){var e=this;return _()(D()().m(function o(){var a,n,t;return D()().w(function(o){while(1)switch(o.p=o.n){case 0:return o.p=0,a={ESTADO:e.datosModal.ESTADO,TIPO:e.datosModal.TIPO,TIPO_RESERVA_ID:e.datosModal.TIPO_RESERVA_ID,USUCOD:e.datosModal.USUCOD},o.n=1,e.$http.post("api/RsNotificacionController/updateRsNotificacion",{id:e.datosModal.ID,params:a});case 1:n=o.v,1===n.code&&(e.obtenerNotificaciones(),e.$notify("Actualizado","success")),o.n=3;break;case 2:o.p=2,t=o.v,e.$notify(t.error.message,"error");case 3:return o.a(2)}},o,null,[[0,2]])}))()},eliminarNotificacion:function(e){var o=this;return _()(D()().m(function a(){var n,t,i;return D()().w(function(a){while(1)switch(a.p=a.n){case 0:return a.n=1,o.$confirmar("¿Esta Ud. Seguro de Eliminar la Notificación?","warning",!0);case 1:if(n=a.v,!n){a.n=5;break}return a.p=2,e={id:e.ID},a.n=3,o.$http.delete("api/RsNotificacionController/deleteRsNotificacion",{data:e});case 3:t=a.v,1===t.code&&(o.obtenerNotificaciones(),o.$notify("Eliminado","success")),a.n=5;break;case 4:a.p=4,i=a.v,o.$notify(i.error.message,"error");case 5:return a.a(2)}},a,null,[[2,4]])}))()},filtrarNotificaciones:function(){var e=this;return _()(D()().m(function o(){var a,n,t;return D()().w(function(o){while(1)switch(o.p=o.n){case 0:return o.p=0,a=e.filtroTipoReserva.join(","),o.n=1,e.$http.get("api/RsNotificacionController/getRsNotificacion",{params:{filtros:a}});case 1:n=o.v,e.notificaciones=n,o.n=3;break;case 2:o.p=2,t=o.v,e.$notify(t.error.message,"error");case 3:return o.a(2)}},o,null,[[0,2]])}))()},obtenerTiposReservas:function(){var e=this;return _()(D()().m(function o(){var a,n;return D()().w(function(o){while(1)switch(o.p=o.n){case 0:return o.p=0,o.n=1,e.$http.get("api/RsTipoReservaController/getRsTipoReserva");case 1:a=o.v,a.forEach(function(o){var a={label:o.NOMBRE,value:o.ID};e.tiposReserva.push(a)}),o.n=3;break;case 2:o.p=2,n=o.v,e.$notify(n.error.message,"error");case 3:return o.a(2)}},o,null,[[0,2]])}))()},cancelarAgregacion:function(){this.estadoModal=!1},limpiarCampos:function(){for(var e in this.datosModal)this.datosModal[e]="ESTADO"===e?1:null;this.v$.$reset()},onResize:function(){var e=window.innerWidth;this.size=e<500?e-16+"px":"100%"}}},B=a(12807);const J=(0,B.A)(H,[["render",U]]);var X=J}}]);