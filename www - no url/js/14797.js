"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[14797],{14797:function(e,a,o){o.r(a),o.d(a,{default:function(){return La}});var r=o(8445),n=o.n(r),i=(o(71225),o(56285),o(50310),o(5962),o(83190),o(61758)),t=o(29104),s=o(58790),l={class:"row q-col-gutter-xs"},c={class:"col-xs-12 col-sm-12 col-md-3 scroll",style:{height:"calc(100vh - 150px)"}},u={class:"col-xs-12 col-sm-12 col-md-9"},d={class:"row q-pt-sm q-col-gutter-sm"},p={class:"col-xs-12 col-sm-4 col-md-3"},m={class:"col-xs-12"},f={class:"row q-pa-sm q-col-gutter-sm"},g={class:"col-12"},v={class:"row q-pa-sm q-col-gutter-sm"},b={class:"row"},U={class:"col-xs-12 column items-center"},h={class:"row q-col-gutter-sm"},w={class:"col-12 text-center"},k={class:"row"},C={class:"col-xs-12 column items-center"},x={class:"row q-col-gutter-sm"},y={class:"col-12 text-center"},O={class:"row"},A={class:"col-xs-12 column items-center"},S={class:"row q-col-gutter-sm"},L={class:"col-12 text-center"},I={class:"col-12 text-center"},E={class:"text-bold"},P={class:"row"},V={class:"col-xs-12 column items-center"},z={class:"row q-col-gutter-sm"},$={class:"col-12 text-center"},N={class:"col-xs-12 sie-flat"},F={class:"row q-mb-md q-col-gutter-md q-pa-sm"},q={class:"row"},M={class:"col-12 text-center"},D={class:"row"},R={class:"col-12 text-center"},T={class:"row q-pa-sm q-col-gutter-md"},_={class:"col-xs-12 sie-flat",style:{"padding-top":"0"}},G={class:"row q-mb-md q-col-gutter-md q-pa-sm"},H={class:"row"},Q={class:"col-12 text-center"},X={class:"row"},B={class:"col-12 text-center"},J={class:"row q-pa-sm q-col-gutter-md"},W={class:"col-xs-12 sie-flat",style:{"padding-top":"0"}},j={class:"row q-pa-sm q-col-gutter-sm"},K={class:"col-xs-12"},Z={class:"col-xs-12 col-sm-6"},Y={class:"col-xs-12 col-sm-6"},ee={class:"col-xs-12"},ae={class:"col-xs-12"},oe={class:"col-xs-12"},re={class:"col-xs-12"},ne={class:"col-xs-12"},ie={class:"row q-pa-sm q-col-gutter-sm"},te={class:"col-xs-12"},se={class:"col-xs-12"},le={class:"row"},ce={class:"col"},ue={class:"row q-pa-md q-col-gutter-sm"},de={class:"col-xs-12"},pe={class:"row"},me={class:"col"},fe={class:"col-xs-12"},ge={class:"row q-pa-sm q-col-gutter-sm"},ve={class:"col-xs-12"},be={class:"col-xs-12"};function Ue(e,a){var o=this,r=(0,i.g2)("loading"),Ue=(0,i.g2)("sie-upload"),he=(0,i.g2)("header-btn"),we=(0,i.g2)("tree-unidad-organizativa"),ke=(0,i.g2)("q-card-section"),Ce=(0,i.g2)("q-select"),xe=(0,i.g2)("q-icon"),ye=(0,i.g2)("sie-table"),Oe=(0,i.g2)("q-card"),Ae=(0,i.g2)("sie-modal"),Se=(0,i.g2)("q-tab"),Le=(0,i.g2)("q-tabs"),Ie=(0,i.g2)("q-form"),Ee=(0,i.g2)("q-tab-panel"),Pe=(0,i.g2)("q-tab-panels"),Ve=(0,i.g2)("q-input"),ze=(0,i.g2)("q-btn"),$e=(0,i.g2)("q-tooltip"),Ne=(0,i.g2)("q-checkbox"),Fe=(0,i.g2)("generar-correo"),qe=(0,i.g2)("q-page");return(0,i.uX)(),(0,i.Wv)(qe,{class:"q-pa-sm intranet-classrrom sie-flat"},{default:(0,i.k6)(function(){return[(0,i.bF)(r,{ref:"loading",modelValue:e.loading,"onUpdate:modelValue":a[0]||(a[0]=function(a){return e.loading=a}),label:"Generando Usuarios",type:"proceso",porcentage:e.sumPorcentage},null,8,["modelValue","porcentage"]),(0,i.bF)(r,{modelValue:e.loadingUsers,"onUpdate:modelValue":a[1]||(a[1]=function(a){return e.loadingUsers=a}),label:"<b>".concat(e.rows.length,"</b> Usuario(s) cargado(s)")},null,8,["modelValue","label"]),(0,i.bo)((0,i.bF)(Ue,{allow:["xlsx","xls"],onUpload:e.uploadExcel,ref:"upload"},null,8,["onUpload"]),[[t.aG,!1]]),(0,i.bF)(Oe,{flat:""},{default:(0,i.k6)(function(){return[(0,i.bF)(ke,null,{default:(0,i.k6)(function(){return[!0===e.isLogged?((0,i.uX)(),(0,i.Wv)(he,{key:0,name:"Usuarios Google",buttons:e.buttons},null,8,["buttons"])):((0,i.uX)(),(0,i.Wv)(he,{key:1,name:"Usuarios Google",buttons:e.buttonsLogin,auto:!1},null,8,["buttons"])),(0,i.Lk)("div",l,[(0,i.Lk)("div",c,[(0,i.bF)(he,{name:"Unidades Org.","font-size":"13px"}),(0,i.bF)(ke,null,{default:(0,i.k6)(function(){return[(0,i.bF)(we,{ref:"treePrincipal",all:"",onSelected:e.selectedTree},null,8,["onSelected"])]}),_:1})]),(0,i.Lk)("div",u,[(0,i.Lk)("div",d,[(0,i.Lk)("div",p,[(0,i.bF)(Ce,{modelValue:e.userEstado,"onUpdate:modelValue":a[2]||(a[2]=function(a){return e.userEstado=a}),options:e.usersEstado,label:"Estado",onInput:e.getUsers},null,8,["modelValue","options","onInput"])]),(0,i.Lk)("div",m,[(0,i.bF)(ye,{selection:"multiple","header-tr":e.headerTrUsuarios,ref:"tableUsuariosGoogle",data:e.rows,columns:e.fields,config:e.config,context:o,css:"height: calc(100vh - 180px)"},{beforeBottom:(0,i.k6)(function(){return[(0,i.Lk)("span",null,[(0,i.bF)(xe,{name:"user_cancel",size:"19px",color:"negative"}),a[39]||(a[39]=(0,i.Lk)("b",null,"No Asociado:",-1)),(0,i.Lk)("span",null,(0,s.v_)(e.infoUsuarios.noAsociados),1)]),(0,i.Lk)("span",null,[(0,i.bF)(xe,{name:"user_add",size:"19px",color:"positive"}),a[40]||(a[40]=(0,i.Lk)("b",null,"Asociado:",-1)),(0,i.Lk)("span",null,(0,s.v_)(e.infoUsuarios.asociados),1)])]}),_:1},8,["header-tr","data","columns","config"])])])])])]}),_:1})]}),_:1}),(0,i.bF)(Ae,{modelValue:e.openModalImportarUsuarios,"onUpdate:modelValue":a[7]||(a[7]=function(a){return e.openModalImportarUsuarios=a}),"esc-click":"",title:"Asociar Usuarios",css:{width:"600px"},ok:"Importar",onSubmit:e.subirArchivo},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",f,[(0,i.Lk)("div",g,[(0,i.Lk)("div",v,[(0,i.Lk)("div",{class:"col-xs-12 col-sm-4 pointer",onClick:a[3]||(a[3]=function(a){return e.downloadPlantilla("alumno")})},[(0,i.Lk)("div",b,[(0,i.Lk)("div",U,[(0,i.Lk)("div",h,[(0,i.Lk)("div",w,[(0,i.bF)(xe,{name:"file_download",color:"primary",size:"30px"})]),a[41]||(a[41]=(0,i.Lk)("div",{class:"col-12 text-center"},[(0,i.Lk)("span",{class:"text-bold"},"Plantilla Alumno")],-1))])])])]),(0,i.Lk)("div",{class:"col-xs-12 col-sm-4 pointer",onClick:a[4]||(a[4]=function(a){return e.downloadPlantilla("docente")})},[(0,i.Lk)("div",k,[(0,i.Lk)("div",C,[(0,i.Lk)("div",x,[(0,i.Lk)("div",y,[(0,i.bF)(xe,{name:"file_download",color:"primary",size:"30px"})]),a[42]||(a[42]=(0,i.Lk)("div",{class:"col-12 text-center"},[(0,i.Lk)("span",{class:"text-bold"},"Plantilla Docente")],-1))])])])]),e.file.uplodad.name?((0,i.uX)(),(0,i.CE)("div",{key:0,class:"col-xs-12 col-sm-4 column items-center pointer",onClick:a[5]||(a[5]=function(){return e.importFile&&e.importFile.apply(e,arguments)})},[(0,i.Lk)("div",O,[(0,i.Lk)("div",A,[(0,i.Lk)("div",S,[(0,i.Lk)("div",L,[(0,i.bF)(xe,{name:"file_excel",color:"positive",size:"30px"})]),(0,i.Lk)("div",I,[(0,i.Lk)("span",E,(0,s.v_)(e.file.uplodad.name),1)])])])])])):((0,i.uX)(),(0,i.CE)("div",{key:1,class:"col-xs-12 col-sm-4 column items-center pointer",onClick:a[6]||(a[6]=function(){return e.importFile&&e.importFile.apply(e,arguments)})},[(0,i.Lk)("div",P,[(0,i.Lk)("div",V,[(0,i.Lk)("div",z,[(0,i.Lk)("div",$,[(0,i.bF)(xe,{name:"upload",color:"black",size:"30px"})]),a[43]||(a[43]=(0,i.Lk)("div",{class:"col-12 text-center"},[(0,i.Lk)("span",{class:"text-bold"},"Subir Plantilla Excel")],-1))])])])])),(0,i.Lk)("div",N,[(0,i.bF)(ye,{ref:"tableUsuariosGoogleImportacion","load-disabled":e.loadDisabled,selection:"multiple",data:e.rowsImportacion,columns:e.fieldsImportacion,config:e.configImportacion,context:o,css:"height: 350px"},null,8,["load-disabled","data","columns","config"])])])])])]}),_:1},8,["modelValue","onSubmit"]),(0,i.bF)(Ae,{modelValue:e.openModalGenerarUsuarios,"onUpdate:modelValue":a[14]||(a[14]=function(a){return e.openModalGenerarUsuarios=a}),css:{width:"600px"},footer:!1,title:"Generar Usuarios Google",ok:!1,"esc-click":"",onSubmit:a[15]||(a[15]=function(){})},{default:(0,i.k6)(function(){return[(0,i.bF)(Le,{modelValue:e.tipoTab,"onUpdate:modelValue":a[8]||(a[8]=function(a){return e.tipoTab=a}),dense:"","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:(0,i.k6)(function(){return[(0,i.bF)(Se,{name:"alumnos",label:"Alumnos",onClick:e.generarCorreos},null,8,["onClick"]),(0,i.bF)(Se,{name:"personal",label:"Docentes",onClick:e.generarCorreos},null,8,["onClick"])]}),_:1},8,["modelValue"]),(0,i.bF)(Pe,{modelValue:e.tipoTab,"onUpdate:modelValue":a[13]||(a[13]=function(a){return e.tipoTab=a}),animated:""},{default:(0,i.k6)(function(){return[(0,i.bF)(Ee,{name:"alumnos"},{default:(0,i.k6)(function(){return[(0,i.bF)(Ie,{ref:"refGenerarAlumno"},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",F,[(0,i.Lk)("div",{class:"col-xs-12 col-sm-6 pointer",onClick:a[9]||(a[9]=function(){return e.openGenerarCorreo&&e.openGenerarCorreo.apply(e,arguments)})},[(0,i.Lk)("div",q,[(0,i.Lk)("div",M,[(0,i.bF)(xe,{name:"settings",color:"primary",size:"40px"})]),a[44]||(a[44]=(0,i.Lk)("div",{class:"col-12 text-center"},[(0,i.Lk)("span",{class:"text-bold",style:{"font-size":"15px"}},"Configurar Usuario")],-1))])]),(0,i.Lk)("div",{class:"col-xs-12 col-sm-6 pointer",onClick:a[10]||(a[10]=function(){return e.autogenerarAlumno&&e.autogenerarAlumno.apply(e,arguments)})},[(0,i.Lk)("div",D,[(0,i.Lk)("div",R,[(0,i.bF)(xe,{name:"group_add",color:"primary",size:"40px"})]),a[45]||(a[45]=(0,i.Lk)("div",{class:"col-12 text-center"},[(0,i.Lk)("span",{class:"text-bold",style:{"font-size":"15px"}},"Generar Usuarios")],-1))])])]),(0,i.Lk)("div",T,[(0,i.Lk)("div",_,[(0,i.bF)(ye,{ref:"alumnosNoImportados",selection:"multiple",data:e.rowsAlumnosNoImportados,columns:e.fieldsUsuariosNoImportados,config:e.configUsuariosNoImportados,context:o,css:"height: 300px"},null,8,["data","columns","config"])])])]}),_:1},512)]}),_:1}),(0,i.bF)(Ee,{name:"personal"},{default:(0,i.k6)(function(){return[(0,i.bF)(Ie,{ref:"refGenerarpersonal"},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",G,[(0,i.Lk)("div",{class:"col-xs-12 col-sm-6 pointer",onClick:a[11]||(a[11]=function(){return e.openGenerarCorreo&&e.openGenerarCorreo.apply(e,arguments)})},[(0,i.Lk)("div",H,[(0,i.Lk)("div",Q,[(0,i.bF)(xe,{name:"settings",color:"primary",size:"40px"})]),a[46]||(a[46]=(0,i.Lk)("div",{class:"col-12 text-center"},[(0,i.Lk)("span",{class:"text-bold",style:{"font-size":"15px"}},"Configurar Usuario")],-1))])]),(0,i.Lk)("div",{class:"col-xs-12 col-sm-6 pointer",onClick:a[12]||(a[12]=function(){return e.autogenerarPersonal&&e.autogenerarPersonal.apply(e,arguments)})},[(0,i.Lk)("div",X,[(0,i.Lk)("div",B,[(0,i.bF)(xe,{name:"group_add",color:"primary",size:"40px"})]),a[47]||(a[47]=(0,i.Lk)("div",{class:"col-12 text-center"},[(0,i.Lk)("span",{class:"text-bold",style:{"font-size":"15px"}},"Generar Usuarios")],-1))])])]),(0,i.Lk)("div",J,[(0,i.Lk)("div",W,[(0,i.bF)(ye,{ref:"personalNoImportados",selection:"multiple",data:e.rowsPersonalNoImportados,columns:e.fieldsUsuariosNoImportados,config:e.configUsuariosNoImportados,context:o,menu:!1,css:"height: 300px"},null,8,["data","columns","config"])])])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])]}),_:1},8,["modelValue"]),(0,i.bF)(Ae,{modelValue:e.openModalCrearUsuario,"onUpdate:modelValue":a[23]||(a[23]=function(a){return e.openModalCrearUsuario=a}),css:{width:"600px"},title:"Crear Usuario","esc-click":"",onSubmit:e.createUser},{default:(0,i.k6)(function(){return[(0,i.bF)(Ie,{ref:"refCrearUsuario"},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",j,[(0,i.Lk)("div",K,[(0,i.bF)(Ve,{modelValue:e.formCreateUsers.nombres,"onUpdate:modelValue":a[16]||(a[16]=function(a){return e.formCreateUsers.nombres=a}),label:"Nombres",rules:[function(e){return!!e||"Campo obligatorio"}]},null,8,["modelValue","rules"])]),(0,i.Lk)("div",Z,[(0,i.bF)(Ve,{modelValue:e.formCreateUsers.apellidoPaterno,"onUpdate:modelValue":a[17]||(a[17]=function(a){return e.formCreateUsers.apellidoPaterno=a}),label:"Apellido Paterno",rules:[function(e){return!!e||"Campo obligatorio"}]},null,8,["modelValue","rules"])]),(0,i.Lk)("div",Y,[(0,i.bF)(Ve,{modelValue:e.formCreateUsers.apellidoMaterno,"onUpdate:modelValue":a[18]||(a[18]=function(a){return e.formCreateUsers.apellidoMaterno=a}),label:"Apellido Materno",rules:[function(e){return!!e||"Campo obligatorio"}]},null,8,["modelValue","rules"])]),(0,i.Lk)("div",ee,[(0,i.bF)(Ve,{class:"usuarioGooglePrefix",modelValue:e.formCreateUsers.correo,"onUpdate:modelValue":a[19]||(a[19]=function(a){return e.formCreateUsers.correo=a}),label:"Correo",suffix:"@".concat(e.dominio),rules:[function(e){return!!e||"Campo obligatorio"}]},null,8,["modelValue","suffix","rules"])]),(0,i.Lk)("div",ae,[(0,i.bF)(Ve,{modelValue:e.formCreateUsers.contrasenia,"onUpdate:modelValue":a[20]||(a[20]=function(a){return e.formCreateUsers.contrasenia=a}),label:"Contraseña",type:"password",rules:[function(e){return!!e||"Campo obligatorio"}]},null,8,["modelValue","rules"])]),(0,i.Lk)("div",oe,[(0,i.bF)(Ce,{modelValue:e.tipoNuevo,"onUpdate:modelValue":a[21]||(a[21]=function(a){return e.tipoNuevo=a}),"map-options":"",options:e.tipos,onInput:e.getUsuariosBySistema,label:"Tipo"},null,8,["modelValue","options","onInput"])]),(0,i.Lk)("div",re,[(0,i.bF)(Ce,{modelValue:e.usuarioNuevo,"onUpdate:modelValue":a[22]||(a[22]=function(a){return e.usuarioNuevo=a}),options:e.usuarios,"use-input":"","hide-selected":"","fill-input":"",onFilter:e.filter,"option-value":"USUCOD","option-label":"USUNOM",label:"Usuario SieWeb",rules:[function(e){return!!e||"Campo obligatorio"}]},null,8,["modelValue","options","onFilter","rules"])]),(0,i.Lk)("div",ne,[(0,i.bF)(we,{ref:"crearTreeUniOrg",onSelected:e.selectedCrearUniOrg},null,8,["onSelected"])])])]}),_:1},512)]}),_:1},8,["modelValue","onSubmit"]),(0,i.bF)(Ae,{modelValue:e.openModalMoverUsuario,"onUpdate:modelValue":a[27]||(a[27]=function(a){return e.openModalMoverUsuario=a}),css:{width:"400px"},title:"Mover Usuarios","esc-click":"",onSubmit:e.moverUsuarios},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",ie,[(0,i.Lk)("div",te,[(0,i.bF)(Ve,{modelValue:e.deUnidadOrganizativa,"onUpdate:modelValue":a[24]||(a[24]=function(a){return e.deUnidadOrganizativa=a}),readonly:"",label:"Origen"},null,8,["modelValue"])]),(0,i.Lk)("div",se,[(0,i.Lk)("div",le,[(0,i.Lk)("div",ce,[(0,i.bF)(Ve,{modelValue:e.aUnidadOrganizativa,"onUpdate:modelValue":a[25]||(a[25]=function(a){return e.aUnidadOrganizativa=a}),readonly:"",label:"Destino"},null,8,["modelValue"])]),(0,i.bF)(ze,{flat:"",dense:"",icon:"cached",onClick:a[26]||(a[26]=function(a){return e.openModalAUnidadOrganizativa=!0})})])])])]}),_:1},8,["modelValue","onSubmit"]),(0,i.bF)(Ae,{modelValue:e.openModalAUnidadOrganizativa,"onUpdate:modelValue":a[28]||(a[28]=function(a){return e.openModalAUnidadOrganizativa=a}),title:"Unidad Organizativa"},{default:(0,i.k6)(function(){return[(0,i.bF)(we,{onSelected:e.selectAUnidadOrganizativa,all:"","label-todos":"/"},null,8,["onSelected"])]}),_:1},8,["modelValue"]),(0,i.bF)(Ae,{modelValue:e.openModalCambioPassword,"onUpdate:modelValue":a[33]||(a[33]=function(a){return e.openModalCambioPassword=a}),title:"Cambiar Contraseña",css:{width:"400px"},onSubmit:e.saveCambioPassword},{default:(0,i.k6)(function(){return[(0,i.bF)(Ie,{ref:"refPassword"},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",ue,[(0,i.Lk)("div",de,[(0,i.Lk)("div",pe,[(0,i.Lk)("div",me,[(0,i.bF)(Ve,{modelValue:e.password,"onUpdate:modelValue":a[30]||(a[30]=function(a){return e.password=a}),type:e.showPassword?"text":"password",label:"Contraseña",maxlength:"20",rules:[e.required,e.minimoCaracteres]},{append:(0,i.k6)(function(){return[(0,i.bF)(xe,{class:"icon-login",color:"primary",name:e.showPassword?"visibility":"visibility_off",onClick:a[29]||(a[29]=function(a){return e.showPassword=!e.showPassword})},null,8,["name"])]}),_:1},8,["modelValue","type","rules"])]),(0,i.bF)(ze,{icon:"refresh",dense:"",flat:"",color:"primary",onClick:a[31]||(a[31]=function(a){return e.generarContraseña()})},{default:(0,i.k6)(function(){return[(0,i.bF)($e,null,{default:(0,i.k6)(function(){return n()(a[48]||(a[48]=[(0,i.eW)("Autogenerar Contraseña",-1)]))}),_:1})]}),_:1})])]),(0,i.Lk)("div",fe,[(0,i.bF)(Ne,{modelValue:e.puedeCambiarContraseña,"onUpdate:modelValue":a[32]||(a[32]=function(a){return e.puedeCambiarContraseña=a}),label:"Pedirle al usuario que cambie la contraseña cuando acceda"},null,8,["modelValue"])])])]}),_:1},512)]}),_:1},8,["modelValue","onSubmit"]),(0,i.bF)(Ae,{modelValue:e.openModalAsociarUsuario,"onUpdate:modelValue":a[37]||(a[37]=function(a){return e.openModalAsociarUsuario=a}),css:{width:"400px"},title:"Asociar Usuario - ".concat(e.rowUserNoAsociado.fullName||""),"esc-click":"",onSubmit:e.asociarUsuario},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",ge,[(0,i.Lk)("div",ve,[(0,i.bF)(Ce,{modelValue:e.tipo,"onUpdate:modelValue":a[34]||(a[34]=function(a){return e.tipo=a}),"map-options":"",options:e.tipos,label:"Tipo",onInput:a[35]||(a[35]=function(a){return e.getUsuariosBySistema(e.tipo)})},null,8,["modelValue","options"])]),(0,i.Lk)("div",be,[(0,i.bF)(Ce,{modelValue:e.usuario,"onUpdate:modelValue":a[36]||(a[36]=function(a){return e.usuario=a}),options:e.usuarios,"use-input":"","hide-selected":"","fill-input":"",onFilter:e.filter,"option-value":"USUCOD","option-label":"USUNOM",label:"Usuario SieWeb"},null,8,["modelValue","options","onFilter"])])])]}),_:1},8,["modelValue","title","onSubmit"]),(0,i.bF)(Fe,{type:e.tipoTab,onUpdate:e.generarCorreos,ref:"refConfigurarCorreo","correo-expresion":e.correoExp,modelValue:e.openModalGenerarCorreo,"onUpdate:modelValue":a[38]||(a[38]=function(a){return e.openModalGenerarCorreo=a}),dominio:e.dominio,fields:e.info},null,8,["type","onUpdate","correo-expresion","modelValue","dominio","fields"])]}),_:1})}var he=o(99550),we=o.n(he),ke=o(76080),Ce=o.n(ke),xe=o(45254),ye=o.n(xe),Oe=(o(30683),o(39866),o(23825),o(52133),o(10239),o(6724),o(70199),o(515),o(62692),o(68017),o(7346),o(27360),o(24066),o(60858),o(64702),o(53514),o(6123)),Ae=o(95718),Se=o(9736),Le=o(16648),Ie=o(2739),Ee=o(26697),Pe=o(53093),Ve=o(53811),ze=o(43346),$e=o(30640),Ne=o(3112),Fe={class:"row q-col-gutter-sm"},qe={class:"col-xs-12"},Me={key:0,class:"col-xs-12"};function De(e,a){var o=(0,i.g2)("q-select");return(0,i.uX)(),(0,i.CE)("div",Fe,[(0,i.Lk)("div",qe,[(0,i.bF)(o,{modelValue:e.unidadOrganizativa,"onUpdate:modelValue":a[0]||(a[0]=function(a){return e.unidadOrganizativa=a}),options:e.unidadesOrganizativas,"option-label":"orgUnitPath","option-value":"orgUnitId",label:"Unidad Organizativa Principal",onInput:e.getSubUnidadesOraganizativas,"emit-value":!1,rules:[function(e){return!!e||"Campo obligatorio"}]},null,8,["modelValue","options","onInput","rules"])]),e.subUnidadesOrganizativas.length>0?((0,i.uX)(),(0,i.CE)("div",Me,[(0,i.bF)(o,{modelValue:e.subUnidadOrganizativa,"onUpdate:modelValue":a[1]||(a[1]=function(a){return e.subUnidadOrganizativa=a}),options:e.subUnidadesOrganizativas,"option-label":"orgUnitPath","option-value":"orgUnitId",label:"Unidad Organizativa","emit-value":!1,rules:[function(e){return!!e||"Campo obligatorio"}]},null,8,["modelValue","options","rules"])])):(0,i.Q3)("v-if",!0)])}var Re={components:{QCardSection:Ae.A,QSelect:Le.A,sieModal:$e.A},data:function(){return{unidadOrganizativa:null,unidadesOrganizativas:[],subUnidadOrganizativa:null,subUnidadesOrganizativas:[]}},methods:{getUnidadOrganizativa:function(){return this.subUnidadesOrganizativas.length>0?this.subUnidadOrganizativa?(this.subUnidadOrganizativa||{}).orgUnitPath:null:this.unidadOrganizativa?(this.unidadOrganizativa||{}).orgUnitPath:null},getUnidadesOraganizativas:function(){var e=arguments,a=this;return ye()(Ce()().m(function o(){var r,n,i,t;return Ce()().w(function(o){while(1)switch(o.n){case 0:return r=e.length>0&&void 0!==e[0]?e[0]:"CHILDREN",n=e.length>1?e[1]:void 0,a.subUnidadOrganizativa=null,o.n=1,a.$http.get("api/HyoDirectory/getOrgunits",{params:{type:r,orgUnitPath:n}});case 1:return i=o.v,t=i.organizationUnits,o.a(2,t)}},o)}))()},getSubUnidadesOraganizativas:function(){var e=this;return ye()(Ce()().m(function a(){var o;return Ce()().w(function(a){while(1)switch(a.n){case 0:return e.subUnidadesOrganizativas=[],a.n=1,e.getUnidadesOraganizativas("ALL",(e.unidadOrganizativa||{}).orgUnitPath);case 1:if(o=a.v,o){a.n=2;break}o=[];case 2:e.subUnidadesOrganizativas=o;case 3:return a.a(2)}},a)}))()}},created:function(){var e=this;return ye()(Ce()().m(function a(){var o;return Ce()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,e.getUnidadesOraganizativas();case 1:if(o=a.v,o){a.n=2;break}o=[];case 2:e.unidadesOrganizativas=o;case 3:return a.a(2)}},a)}))()}},Te=o(12807);const _e=(0,Te.A)(Re,[["render",De]]);var Ge=_e,He={class:"row q-pa-sm q-col-gutter-sm"},Qe={class:"col-sm-6 col-md-4"},Xe={class:"col-xs-12"},Be={class:"row"},Je={class:"col-xs-12"},We={class:"row q-pa-sm"},je={class:"col"},Ke={class:"col-sm-6 col-md-4"},Ze={class:"col-xs-12"},Ye={class:"row"},ea={class:"col-xs-8 offset-2"},aa={class:"row q-pa-sm"},oa={class:"col"},ra={class:"row q-pa-sm q-col-gutter-sm"},na={class:"col-xs-12"},ia={key:0,class:"col-xs-12"},ta={class:"row"},sa={class:"col"},la={key:1,class:"col-xs-12"};function ca(e,a){var o=(0,i.g2)("q-checkbox"),r=(0,i.g2)("q-input"),t=(0,i.g2)("q-tooltip"),s=(0,i.g2)("q-icon"),l=(0,i.g2)("q-form"),c=(0,i.g2)("q-select"),u=(0,i.g2)("sie-modal");return(0,i.uX)(),(0,i.Wv)(u,{modelValue:e.openModal,"onUpdate:modelValue":a[7]||(a[7]=function(a){return e.openModal=a}),"esc-click":"",title:"Configurar Usuario",css:{width:"600px"},ok:"Guardar",onSubmit:e.saveConfiguracion},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",He,[a[10]||(a[10]=(0,i.Lk)("div",{class:"col-xs-12 q-pt-sm text-bold q-subheading"},[(0,i.Lk)("span",null,"Generar Correo")],-1)),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.fields,function(a){return(0,i.uX)(),(0,i.CE)("div",Qe,[(0,i.bF)(o,{dense:"",modelValue:e.fieldsA[a.value],"onUpdate:modelValue":function(o){return e.fieldsA[a.value]=o},label:a.value,color:"primary",onInput:function(o){return e.changeCheckbox(e.fieldsA[a.value],a.value)}},null,8,["modelValue","onUpdate:modelValue","label","onInput"])])}),256)),(0,i.Lk)("div",Xe,[(0,i.Lk)("div",Be,[(0,i.Lk)("div",Je,[(0,i.bF)(l,{ref:"formConfCorreo"},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",We,[(0,i.Lk)("div",je,[(0,i.bF)(r,{class:"fix-input-prefix",modelValue:e.correo[e.type],"onUpdate:modelValue":a[0]||(a[0]=function(a){return e.correo[e.type]=a}),label:"Expresión Correo",suffix:"@".concat(e.domain),onInput:e.validateCorreo,rules:[e.isValidExpresion]},null,8,["modelValue","suffix","onInput","rules"])]),(0,i.bF)(s,{class:"pointer",name:"refresh",size:"30px",color:"positive",onClick:e.recargarConfiguracion},{default:(0,i.k6)(function(){return[(0,i.bF)(t,null,{default:(0,i.k6)(function(){return n()(a[8]||(a[8]=[(0,i.eW)("Recargar Configuración",-1)]))}),_:1})]}),_:1},8,["onClick"]),(0,i.bF)(s,{class:"pointer",name:"broom",size:"30px",color:"primary",onClick:e.clearCorreo},{default:(0,i.k6)(function(){return[(0,i.bF)(t,null,{default:(0,i.k6)(function(){return n()(a[9]||(a[9]=[(0,i.eW)("Limpiar",-1)]))}),_:1})]}),_:1},8,["onClick"])])]}),_:1},512)])])]),a[11]||(a[11]=(0,i.Lk)("div",{class:"col-xs-12 q-pt-sm text-bold q-subheading"},[(0,i.Lk)("span",null,"Resultado")],-1)),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.fields,function(a){return(0,i.uX)(),(0,i.CE)("div",Ke,[(0,i.bF)(r,{modelValue:e.fieldsB[a.value],"onUpdate:modelValue":function(o){return e.fieldsB[a.value]=o},label:a.label,onInput:e.processExpresion},null,8,["modelValue","onUpdate:modelValue","label","onInput"])])}),256)),(0,i.Lk)("div",Ze,[(0,i.Lk)("div",Ye,[(0,i.Lk)("div",ea,[(0,i.Lk)("div",aa,[(0,i.Lk)("div",oa,[(0,i.bF)(r,{class:"fix-input-prefix",readonly:"",modelValue:e.correoConvertido,"onUpdate:modelValue":a[1]||(a[1]=function(a){return e.correoConvertido=a}),label:"Correo",suffix:"@".concat(e.domain)},null,8,["modelValue","suffix"])])])])])])]),(0,i.bF)(u,{modelValue:e.openModalExpresion,"onUpdate:modelValue":a[5]||(a[5]=function(a){return e.openModalExpresion=a}),"esc-click":"",title:"Expresión",onClose:e.acceptExpresion,css:{width:"300px"},ok:"Aceptar",onSubmit:a[6]||(a[6]=function(a){return e.openModalExpresion=!1})},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",ra,[(0,i.Lk)("div",na,[(0,i.bF)(c,{modelValue:e.expresion,"onUpdate:modelValue":a[2]||(a[2]=function(a){return e.expresion=a}),options:e.expresiones,label:"Seleccione"},null,8,["modelValue","options"])]),"split"===e.expresion?((0,i.uX)(),(0,i.CE)("div",ia,[(0,i.Lk)("div",ta,[(0,i.Lk)("div",sa,[(0,i.bF)(r,{modelValue:e.posicion,"onUpdate:modelValue":a[3]||(a[3]=function(a){return e.posicion=a}),type:"number",label:"Posición Palabra"},null,8,["modelValue"])])])])):"full"!==e.expresion?((0,i.uX)(),(0,i.CE)("div",la,[(0,i.bF)(r,{modelValue:e.extraer,"onUpdate:modelValue":a[4]||(a[4]=function(a){return e.extraer=a}),type:"number",label:"Extraer Caracteres"},null,8,["modelValue"])])):(0,i.Q3)("v-if",!0)])]}),_:1},8,["modelValue","onClose"])]}),_:1},8,["modelValue","onSubmit"])}o(76921),o(13600),o(52776),o(37406),o(84433),o(44264),o(81813);var ua={emits:["update:modelValue","input","update"],props:{type:{type:String,default:"alumno"},modelValue:{type:Boolean,default:!1},dominio:{type:String,default:"sindominio"},correoExpresion:{type:Object,default:function(){return{}}},fields:{type:Array,default:function(){return[]}}},computed:{domain:function(){return this.dominio},openModal:{set:function(e){this.$emit("update:modelValue",e),this.$emit("input",e)},get:function(){return this.modelValue}}},components:{QForm:Ie.A,QCardSection:Ae.A,QSelect:Le.A,QCheckbox:Ne.A,QTooltip:Oe.nC,sieModal:$e.A,QInput:Se.A,QIcon:Oe.bP},data:function(){return{fieldsA:{},fieldsB:{},correo:{},expresiones:[],expresion:"full",extraer:2,posicion:1,tipo:"",correoConvertido:"",openModalExpresion:!1}},methods:{dinamycRegex:function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"g",o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e=e||"[a-z]+";var r="(\\[".concat(e,"\\])(\\{F\\}|\\{R\\-[0-9]+\\}|\\{L\\-[0-9]+\\}|\\{S\\-[0-9]+\\})?(\\||_|\\-|\\.|\\$|\\#)*");return!0===o&&(r="^(".concat(r,")+$")),new RegExp(r,a)},isValidExpresion:function(e){var a=this.dinamycRegex(null,"g",!0);return!!a.test(e)||"La expresión no es válida."},processExpresion:function(){var e,a=this.dinamycRegex(),o=[];while(null!==(e=a.exec(this.correo[this.type])))o.push(e[0]);for(var r=this.dinamycRegex(null,""),n="",i=0;i<o.length;i++){var t=o[i],s=t.replace(r,"$1"),l=t.replace(r,"$2"),c=t.replace(r,"$3");s=s.replace(/(^\[|\]$)/g,""),l=l.replace(/(^\{|\}$)/g,"");var u=l.split("-"),d=u[0],p=u[1]||0;this.fieldsA.hasOwnProperty(s)&&(this.fieldsA[s]=!0),n+=this.getText(s,d,p,c)}var m=["á","Á","é","É","í","Í","ó","Ó","ú","Ú","ñ","Ñ"],f=["a","A","e","E","i","I","o","O","u","U","n","N"];return m.map(function(e,a){n=n.replace(new RegExp(e,"g"),f[a])}),this.correoConvertido=n,n},getText:function(e,a,o,r){var n=String(this.fieldsB[e])||"";r=r||"",n=n.toLowerCase();var i="";return"F"===a?i=n:"S"===a?(o=o||1,o--,o=o<0?0:o,i=n.split(" ")[o]||""):"L"===a?i=n.substring(0,parseInt(o)):"R"===a&&(i=n.substring(n.length-parseInt(o))),i=i.replace(/\s*/g,""),i+=r,i},clearCorreo:function(){for(var e=0;e<this.fields.length;e++){var a=this.fields[e];this.fieldsA[a.value]=!1}this.correo[this.type]="",this.processExpresion()},changeCheckbox:function(e,a){if(!0===e)this.expresion="full",this.extraer=2,this.posicion=1,this.expresiones="nombres"===a?[{label:"Completo",value:"full"},{label:"Dividir",value:"split"},{label:"Extraer Izquirda",value:"left"},{label:"Extraer Derecha",value:"right"}]:[{label:"Completo",value:"full"},{label:"Extraer Izquirda",value:"left"},{label:"Extraer Derecha",value:"right"}],this.openModalExpresion=!0,this.tipo=a;else if(!1===e){var o=this.dinamycRegex(a,"");this.correo[this.type]=this.correo[this.type].replace(o,""),this.processExpresion()}},acceptExpresion:function(){var e="".concat(this.tipo);"full"===this.expresion?e="[".concat(e,"]{F}"):"split"===this.expresion?e="[".concat(e,"]{S-").concat(this.posicion,"}"):"left"===this.expresion?e="[".concat(e,"]{L-").concat(this.extraer,"}"):"right"===this.expresion&&(e="[".concat(e,"]{R-").concat(this.extraer,"}")),this.correo[this.type]+=e,this.processExpresion(),this.openModalExpresion=!1},validateCorreo:function(e){e||this.clearCorreo(),this.processExpresion()},recargarConfiguracion:function(){var e=this;return ye()(Ce()().m(function a(){var o,r;return Ce()().w(function(a){while(1)switch(a.n){case 0:return e.clearCorreo(),a.n=1,e.$http.get("api/HyoDirectory/getDomain");case 1:o=a.v,r=o.EXP_CORREO;try{r=JSON.parse(r),e.setProps(r)}catch(a){e.correo={},e.correo[e.type]=""}e.processExpresion();case 2:return a.a(2)}},a)}))()},saveConfiguracion:function(){var e=this;return ye()(Ce()().m(function a(){return Ce()().w(function(a){while(1)switch(a.p=a.n){case 0:return a.n=1,e.$refs.formConfCorreo.validate();case 1:if(a.v){a.n=2;break}return e.$notify("La expresión generada no es válida, corrígelo antes de continuar","warning"),a.a(2);case 2:return a.p=2,e.$q.loading.show(),a.n=3,e.$http.put("api/HyoApis/saveConfiguracion",{exp_correo:JSON.stringify(e.correo)});case 3:e.$emit("update"),e.$q.loading.hide(),e.$notify("Se ha guardado la configuración de correo","success"),a.n=5;break;case 4:a.p=4,a.v,e.$notify("No ha sido posible guardar la configuracion","warning");case 5:return a.a(2)}},a,null,[[2,4]])}))()},setProps:function(e){for(var a in e[this.type]||(e[this.type]=""),e){var o=e[a];this.correo[a]=o}}},created:function(){var e=this;return ye()(Ce()().m(function a(){var o,r;return Ce()().w(function(a){while(1)switch(a.n){case 0:for(o=0;o<e.fields.length;o++)r=e.fields[o],e.fieldsA[r.value]=!1,e.fieldsB[r.value]=r.default;case 1:return a.a(2)}},a)}))()},watch:{modelValue:{immediate:!0,handler:function(e){!0===e&&this.recargarConfiguracion()}},correoExpresion:{immediate:!0,handler:function(e){this.setProps(e)}}}};const da=(0,Te.A)(ua,[["render",ca]]);var pa=da,ma=(o(89571),{data:function(){return{rowUserNoAsociado:{},headerTrUsuarios:[[{label:"SieWeb",colspan:"3",textColor:"white",bgColor:"#562598"},{label:"Google",colspan:"4",textColor:"white",bgColor:"green"}]],config:{primaryEmail:{renderHtml:function(e,a,o){return o.copy({unique:e.primaryEmail,value:e.primaryEmail})},prevent:!0},asociado:{renderHtml:function(e,a,o){var r=[],n=a("div",{style:{width:"19px",height:"19px"}});return e.asociado?r.push(n,o.icon({name:"user_add",color:"positive"})):r.push(o.icon({name:"user_cancel",color:"negative"}),n),a("div",{class:"row q-gutter-sm"},r)},tooltip:function(e){return e.asociado?"Asociado":"No Asociado"}},action:{component:"button",icon:["swap_horiz as asociar","user_cancel as desasociar","history as suspender","undo as restaurar","vpn_key as password"],asociar:function(e,a){var o=this;return ye()(Ce()().m(function r(){return Ce()().w(function(r){while(1)switch(r.n){case 0:if(o.usuario="",e.asociado){r.n=2;break}if(o.selectedUnidadOrganizativa&&"all"!==o.selectedUnidadOrganizativa){r.n=1;break}return o.$notify("Seleccione una unidad organizativa","info"),r.a(2);case 1:o.rowUserNoAsociado=a,o.openModalAsociarUsuario=!0;case 2:return r.a(2)}},r)}))()},suspender:function(e,a){var o=this;return ye()(Ce()().m(function e(){return Ce()().w(function(e){while(1)switch(e.n){case 0:o.cambiarEstadoUsuario(a,!0);case 1:return e.a(2)}},e)}))()},desasociar:function(e,a){var o=this;return ye()(Ce()().m(function r(){var n,i,t;return Ce()().w(function(r){while(1)switch(r.p=r.n){case 0:return r.p=0,r.n=1,o.$confirmar("¿Realmente desea desasociar al usuario <b>".concat(e.asociado," - ").concat(e.primaryEmail,"</b>?"),"delete",!0);case 1:if(n=r.v,!n){r.n=3;break}return r.n=2,o.$http.delete("api/HyoClassRoomAdmin/quitarAsociacionUsuario",{params:{email:e.primaryEmail,usucod:e.asociado,orgUnitPath:e.orgUnitPath}});case 2:i=r.v,t=i.message,delete a.asociado,o.$notify(t,"success");case 3:r.n=5;break;case 4:r.p=4,r.v,o.$notify("No ha sido posible desaociar al usuario","warning");case 5:return r.a(2)}},r,null,[[0,4]])}))()},restaurar:function(e,a){var o=this;return ye()(Ce()().m(function e(){return Ce()().w(function(e){while(1)switch(e.n){case 0:o.cambiarEstadoUsuario(a,!1);case 1:return e.a(2)}},e)}))()},password:function(e){var a=this;return ye()(Ce()().m(function o(){return Ce()().w(function(o){while(1)switch(o.n){case 0:a.password="",a.puedeCambiarContraseña=!0,a.currentUser=e,a.openModalCambioPassword=!0;case 1:return o.a(2)}},o)}))()},tooltip:{asociar:"Asociar Usuario",suspender:"Suspender Usuario",desasociar:"Desasociar Usuario",restaurar:"Restaurar Usuario",password:"Cambiar Contraseña"},validate:{asociar:function(e){return!e.asociado},desasociar:function(e){return!!e.asociado},suspender:function(){return"A"===this.userEstado},restaurar:function(){return"I"===this.userEstado}},flat:!0,dense:!0,prevent:!0}},rows:[],fields:[{name:"asociado",label:"Asociado",field:"asociado",align:"center",sortable:!0},{name:"ngs",label:"NGS",field:"ngs",align:"center",sortable:!0},{name:"orgUnitPath",label:"Unidad Org.",field:"orgUnitPath",align:"left",sortable:!0},{name:"fullName",label:"Nombres",field:"fullName",align:"left",sortable:!0},{name:"primaryEmail",label:"Correo",field:"primaryEmail",align:"left",sortable:!0},{name:"action",label:"Accíon",field:"action",align:"center",width:70}]}},methods:{cambiarEstadoUsuario:function(e){var a=arguments,o=this;return ye()(Ce()().m(function r(){var n,i,t,s;return Ce()().w(function(r){while(1)switch(r.p=r.n){case 0:return n=a.length>1&&void 0!==a[1]&&a[1],r.p=1,i="I"===o.userEstado?"restaurar":"suspender",t="I"===o.userEstado?"undo":"history",r.n=2,o.$confirmar("¿Realmente desea ".concat(i," a ").concat(e.fullName,"?"),{color:"primary",icon:t});case 2:if(s=r.v,!s){r.n=4;break}return r.n=3,o.$http.put("api/HyoDirectory/updateUser",{userKey:e.primaryEmail,params:{suspended:n}});case 3:o.rows.splice(o.rows.indexOf(e),1);case 4:r.n=6;break;case 5:r.p=5,r.v,o.$notify("No ha sido posible suspender la cuenta.","warning");case 6:return r.a(2)}},r,null,[[1,5]])}))()}}}),fa={data:function(){return{configImportacion:{EXISTS:{renderHtml:function(e,a,o){return o.background({color:"".concat(Object.prototype.hasOwnProperty.call(e,"EXISTS")?"positive":"negative"),text:"".concat(Object.prototype.hasOwnProperty.call(e,"EXISTS")?"Asociado":"No Asociado")})}}},rowsImportacion:[],fieldsImportacion:[{name:"EXISTS",label:"Estado",field:"EXISTS",align:"center",sortable:!0},{name:"USUCOD",label:"Código Usuario",field:"USUCOD",align:"center",sortable:!0},{name:"USUARIO",label:"Correo",field:"USUARIO",align:"left",sortable:!0},{name:"URL",label:"Unidad Organizativa",field:"URL",align:"left",sortable:!0}]}}},ga=function(e,a,o){return e[a]?o("span",e[a]||""):o("div",{class:"full-width bg-negative text-white q-pa-xs",style:"height: 20px"},"")},va={data:function(){return{configUsuariosNoImportados:{REPEAT:{renderHtml:function(e,a,o){var r=this.usersRepeat[e.USUARIO];return o.background({textColor:"white",color:"S"===r?"negative":"positive",text:"S"===r?"Repetido":""})}},USUARIO:{component:"input",prevent:!0,autoFocus:!0,input:function(e,a,o){var r=this.usersRepeat[o],n=this.usersRepeat[a.USUARIO];n?n&&(this.usersRepeat[a.USUARIO]="S"):this.usersRepeat[o]="N",console.log(n),console.log(r)}},TIPCOD:{renderHtml:function(e,a,o){return o.icon({name:"".concat("005"===e.TIPCOD?"boy":"teaching")})}},USUCOD:{renderHtml:function(e,a){return ga(e,"USUCOD",a)}},DOCIDENRO:{renderHtml:function(e,a){return ga(e,"DOCIDENRO",a)}}},rowsAlumnosNoImportados:[],rowsPersonalNoImportados:[],fieldsUsuariosNoImportados:[{name:"REPEAT",label:"Repetidos",field:"REPEAT",align:"center",sortable:!0},{name:"TIPCOD",label:"",field:"TIPCOD",align:"center",sortable:!0},{name:"USUARIO",label:"Correo",field:"USUARIO",align:"left",sortable:!0},{name:"USUCOD",label:"Código Usuario",field:"USUCOD",align:"left",sortable:!0},{name:"USUNOM",label:"Usuario",field:"USUNOM",align:"left",sortable:!0},{name:"DOCIDENRO",label:"Nro Documento",field:"DOCIDENRO",align:"center",sortable:!0}]}}},ba=o(33950),Ua=o(59089),ha=o(80660),wa=o(85226),ka=o(52220),Ca=o(49723),xa=o(81288),ya=o(57668),Oa=o(95655),Aa={components:{QTabPanels:Ve.A,QTabPanel:ze.A,QTabs:Ee.A,QTab:Pe.A,QCheckbox:Ne.A,sieUpload:Ua.A,unidadesOrganizativas:Ge,generarCorreo:pa,QCardSection:Ae.A,QInput:Se.A,QSelect:Le.A,QForm:Ie.A,sieModal:$e.A,loading:wa.A,QTree:ka.A,treeUnidadOrganizativa:Ca.A,QPage:Oe.Tu,QCard:Oe.C$,QIcon:Oe.bP,QBtn:Oe.Il,QTooltip:Oe.nC},mixins:[ma,fa,va],data:function(){return{buttons:[{icon:"refresh",label:"Actualizar",click:this.getUsers},{icon:"settings",label:"Generar",click:this.openGenerarUsuarios},{icon:"import_exam",label:"Asociar Usuarios",click:this.openImportarUsuario},{icon:"plus",label:"Crear Usuario",click:this.openCreateuser},{icon:"sync_problem",label:"Mover Usuario",click:this.openMoverUsuario},{label:"Cerrar Sesión",icon:"account_lock",click:this.cerrarSesionAdmin}],buttonsLogin:[{label:"Iniciar Sesión",icon:"vpn_key",click:this.login}],token:"first",openModalCrearUsuario:!1,openModalImportarUsuarios:!1,openModalGenerarCorreo:!1,openModalGenerarUsuarios:!1,openModalMoverUsuario:!1,openModalAUnidadOrganizativa:!1,openModalCambioPassword:!1,formCreateUsers:{nombres:"",apellidoPaterno:"",apellidoMaterno:"",correo:"",contrasenia:""},dominio:"",file:{uplodad:{},response:{}},info:[{value:"nombres",label:"Nombres",default:"John Doe"},{value:"apepat",label:"Apellido Paterno",default:"Sanchez"},{value:"apemat",label:"Apellido Materno",default:"Gutierrez"},{value:"docidenro",label:"Número Documento",default:"12345678"},{value:"usucod",label:"Usuario",default:"U202212345"}],loadDisabled:{key:"USUCOD",values:[]},tipoTab:"alumnos",loading:!1,sumPorcentage:0,rowsClone:[],openModalAsociarUsuario:!1,tipos:[{value:"006",label:"Docente"},{value:"005",label:"Alumno"}],tipoNuevo:"",tipo:"",deUnidadOrganizativa:"",aUnidadOrganizativa:"",selectedUnidadOrganizativa:null,aIdUnidadOrganizativa:null,usuarios:[],usuario:"",usuarioNuevo:"",usuariosCopy:[],selectCrearUniOrg:null,loadingUsers:!1,correoExp:{},sie:{},isLogged:!1,usersRepeat:{},userEstado:"A",usersEstado:[{label:"Activos",value:"A"},{label:"Suspendidos",value:"I"}],currentUser:{},password:"","puedeCambiarContraseña":!1,showPassword:!1}},computed:{infoUsuarios:function(){var e={asociados:0,noAsociados:0};return this.rows.map(function(a){Object.prototype.hasOwnProperty.call(a,"asociado")?e.asociados+=1:e.noAsociados+=1}),e}},methods:{required:function(e){return!!e||"Campo requerido"},minimoCaracteres:function(e){return e=e||"",e.length>=8||"La contraseña debe tener al menos 8 caracteres"},saveCambioPassword:function(){var e=this;return ye()(Ce()().m(function a(){var o,r,n,i;return Ce()().w(function(a){while(1)switch(a.p=a.n){case 0:return a.n=1,e.$refs.refPassword.validate();case 1:if(o=a.v,o){a.n=2;break}return a.a(2);case 2:return a.p=2,a.n=3,e.$confirmar("¿Realmente desea actualizar la contraseña para el usuario ".concat(e.currentUser.primaryEmail,"?"));case 3:if(r=a.v,!r){a.n=5;break}return a.n=4,e.$http.put("api/HyoDirectory/updateUser",{userKey:e.currentUser.primaryEmail,params:{changePasswordAtNextLogin:e.puedeCambiarContraseña,password:e.password}});case 4:e.$notify("Contraseña para el usuario ".concat(e.currentUser.primaryEmail," actualizada."),"success"),e.openModalCambioPassword=!1;case 5:a.n=7;break;case 6:a.p=6,i=a.v,n=i.error||{message:"No ha sido posible actualizar la contraseña"},e.$notify(n.message,"warning");case 7:return a.a(2)}},a,null,[[2,6]])}))()},login:function(){var e=this;return ye()(Ce()().m(function a(){var o;return Ce()().w(function(a){while(1)switch(a.p=a.n){case 0:return a.p=0,delete window.localStorage._apiGoogle,e.isLogged=!1,a.n=1,e.$http.post("api/HyoLoginGoogleAdmin/login");case 1:if(o=a.v,"string"!==typeof o){a.n=2;break}(0,Oa["default"])(o,"_system",500,500),a.n=3;break;case 2:return e.isLogged=!0,a.n=3,e.init();case 3:a.n=5;break;case 4:a.p=4,a.v,e.$notify("Intentalo nuevamente.","warning");case 5:return a.a(2)}},a,null,[[0,4]])}))()},moverUsuarios:function(){var e=this;return ye()(Ce()().m(function a(){var o,r,n;return Ce()().w(function(a){while(1)switch(a.p=a.n){case 0:if(e.aUnidadOrganizativa){a.n=1;break}return e.$notify("Seleccione unidad organizativa destino","info"),a.a(2);case 1:if(o=e.$refs.tableUsuariosGoogle.rowsSelected(["primaryEmail","asociado"]),!(o.length<1)){a.n=2;break}return e.$notify("Debe seleccionar al menos un usuario","info"),a.a(2);case 2:return a.n=3,e.$confirmar("¿Realmente desea mover los ".concat(o.length," usuarios seleccionados de <b>").concat(e.deUnidadOrganizativa,"</b> a <b>").concat(e.aUnidadOrganizativa,"</b>?"),"info",!0);case 3:if(r=a.v,!r){a.n=8;break}return e.$q.loading.show(),a.p=4,a.n=5,e.$http.put("api/HyoDirectory/moverUsuarios",{aUnidadOrganizativa:e.aUnidadOrganizativa,users:o});case 5:n=a.v,e.rowsClone.map(function(a){n.includes(a.primaryEmail)&&(a.orgUnitPath=e.aUnidadOrganizativa)}),e.filterUsers(e.deUnidadOrganizativa),e.openModalMoverUsuario=!1,a.n=7;break;case 6:a.p=6,a.v,e.$notify("No ha sido posible mover los usuarios selecciodos.","warning");case 7:e.$q.loading.hide();case 8:return a.a(2)}},a,null,[[4,6]])}))()},selectAUnidadOrganizativa:function(e){e="all"===e?{orgUnitPath:"/"}:e,this.aUnidadOrganizativa=e.orgUnitPath,this.aIdUnidadOrganizativa=e.orgUnitId,this.openModalAUnidadOrganizativa=!1},selectedTree:function(e){this.selectedUnidadOrganizativa=e,this.filterUsers("all"===this.selectedUnidadOrganizativa?"all":this.selectedUnidadOrganizativa.orgUnitPath||"")},openMoverUsuario:function(){this.selectedUnidadOrganizativa?(this.deUnidadOrganizativa="all"===this.selectedUnidadOrganizativa?"all":this.selectedUnidadOrganizativa.orgUnitPath||"",this.aUnidadOrganizativa="",this.openModalMoverUsuario=!0):this.$notify("Seleccione una unidad organizativa","info")},generarCorreos:function(){var e=this;return ye()(Ce()().m(function a(){var o,r,n,i,t;return Ce()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,e.$nextTick();case 1:o=e.$refs.refConfigurarCorreo,r=o.fieldsB,n="alumnos"===e.tipoTab?"rowsAlumnosNoImportados":"rowsPersonalNoImportados",e.$q.loading.show(),i={},t=e[n].map(function(a){for(var n in a){var t=(n||"").toLowerCase();r.hasOwnProperty(t)&&(r[t]=a[n]||"")}var s=o.processExpresion();a.TIPCOD="alumno"===a.TIPO?"005":"006",s=s||"",s=s.trim();var l=s?"@".concat(e.dominio):"";a.USUARIO="".concat(s).concat(l),a.APEPAT=(0,xa.upperCamelCase)(a.APEPAT," "),a.APEMAT=(0,xa.upperCamelCase)(a.APEMAT," "),a.NOMBRES=(0,xa.upperCamelCase)(a.NOMBRES," ");var c=(a.USUNOM||"").split(", "),u=we()(c,2),d=u[0],p=u[1];d=d||"",p=p||"";var m=(0,xa.upperCamelCase)(d," "),f=(0,xa.upperCamelCase)(p," "),g="".concat(m.trim(),", ").concat(f.trim());return a.USUNOM=g,[null,void 0].includes(i[a.USUARIO])?(a.REPEAT="N",i[a.USUARIO]="N"):(a.REPEAT="S",i[a.USUARIO]="S"),a}),e.usersRepeat=i,e[n]=t,e.$q.loading.hide();case 2:return a.a(2)}},a)}))()},"generarContraseña":function(){this.showPassword=!0,this.password=btoa(Math.ceil(Math.random()*Date.now()))},autogenerarAlumno:function(){var e=this.$refs.alumnosNoImportados;this.autogenerarUsuarios(e)},autogenerarPersonal:function(){var e=this.$refs.personalNoImportados;this.autogenerarUsuarios(e)},autogenerarUsuarios:function(e){var a=this;return ye()(Ce()().m(function o(){var r,n,i,t,s,l;return Ce()().w(function(o){while(1)switch(o.p=o.n){case 0:if(r=e.rowsSelected(),!(r.length<1)){o.n=1;break}return a.$alert("Debe seleccionar al menos un registro","info"),o.a(2);case 1:if(n=!0,i=[],t=[],r.map(function(e){e.APEPAT=(0,xa.upperCamelCase)(e.APEPAT," "),e.APEMAT=(0,xa.upperCamelCase)(e.APEMAT," "),e.NOMBRES=(0,xa.upperCamelCase)(e.NOMBRES," ");var a={USUCOD:e.USUCOD,CODIGO:e.CODIGO,USUARIO:e.USUARIO,TIPCOD:e.TIPCOD,NOMBRES:e.NOMBRES,URL:e.ID_UNIDAD_ORGANIZATIVA,APELLIDOS:"".concat(e.APEPAT," ").concat(e.APEMAT)};e.USUARIO?i[i.length]=a:(n=!1,t[t.length]=a)}),!1!==n){o.n=3;break}return o.n=2,a.$confirmar("Algunos usuarios no tienen correo generado, ¿desea exclurilos y continuar con el proceso?","warning");case 2:if(s=o.v,!1!==s){o.n=3;break}return o.a(2);case 3:return o.p=3,l="alumnos"===a.tipoTab?"alumno":"docente",a.loading=!0,o.n=4,(0,ha.streamFetch)("api/HyoDirectory/generarUsuarios",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({usuarios:i,tipo:l})},function(e){var o=e.totalProgress,r=e.progress;a.sumPorcentage=a.$refs.loading.progress(o,r)});case 4:return a.sumPorcentage=100,o.n=5,a.openGenerarUsuarios();case 5:a.sumPorcentage=0,a.$notify("Proceso completado","success"),o.n=7;break;case 6:o.p=6,o.v,a.$notify("Ha ocurrido un problema al intentar completar el proceso","warning");case 7:a.loading=!1;case 8:return o.a(2)}},o,null,[[3,6]])}))()},openImportarUsuario:function(){this.openModalImportarUsuarios=!0},openGenerarUsuarios:function(){var e=this;return ye()(Ce()().m(function a(){var o,r,n;return Ce()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,e.$http.get("api/HyoDirectory/getUsuariosNoImportados");case 1:o=a.v,r=o.alumnos,n=o.personal,e.rowsAlumnosNoImportados=r,e.rowsPersonalNoImportados=n,e.generarCorreos(),e.openModalGenerarUsuarios=!0;case 2:return a.a(2)}},a)}))()},importFile:function(){this.$refs.upload.$el.querySelector("input").click()},downloadPlantilla:function(e){window.open("".concat(this.sie.api,"/HyoDirectory/exportarPlantilla/").concat(e,"/plantilla-asociar-usuario.xlsx?sie-token=").concat(this.sie.token),"_blank")},subirArchivo:function(){var e=this;return ye()(Ce()().m(function a(){var o,r,n;return Ce()().w(function(a){while(1)switch(a.p=a.n){case 0:if(e.file.response.name){a.n=1;break}return e.$notify("Debe seleccionar una plantilla formato excel","warning"),a.a(2);case 1:if(a.p=1,o=e.$refs.tableUsuariosGoogleImportacion.rowsSelected(["ID_SISTEMA","USUCOD","TIPCOD","USUARIO","URL"]),o.map(function(e){e.USUARIO=(e.USUARIO||"").toLowerCase()}),o=o.filter(function(e){return e.ID_SISTEMA&&e.TIPCOD&&e.URL&&e.USUARIO&&e.USUCOD}),!(o.length<1)){a.n=2;break}return e.$notify("Debe seleccionar al menos un registro o falta rellenar campos","warning"),a.a(2);case 2:return e.$q.loading.show(),a.n=3,e.$http.post("api/HyoDirectory/importarUsuarios",{data:o});case 3:r=e.$refs.tableUsuariosGoogleImportacion.selected,n=r.map(function(e){return e.EXISTS=!0,e.USUCOD}),e.$refs.tableUsuariosGoogleImportacion.selected=[],e.loadDisabled.values=e.loadDisabled.values.concat(n),e.$notify("Se importaron los registros de marcación","success"),a.n=5;break;case 4:a.p=4,a.v,e.$notify("No ha sido posible importar el archivo","warning");case 5:e.$q.loading.hide();case 6:return a.a(2)}},a,null,[[1,4]])}))()},prepareUsers:function(){var e=this;return ye()(Ce()().m(function a(){var o,r,n,i,t,s,l;return Ce()().w(function(a){while(1)switch(a.n){case 0:if(o="I"===e.userEstado,"first"!==e.token){a.n=6;break}return a.n=1,e.$http.get("api/HyoDirectory/getUsers",{params:{suspended:o}});case 1:if(r=a.v,n=r.users,i=r.nextPageToken,e.token=i,e.rows=e.rows.concat(n),e.rowsClone=e.rowsClone.concat(JSON.parse(JSON.stringify(n))),!i){a.n=3;break}return a.n=2,e.prepareUsers();case 2:a.n=5;break;case 3:return a.n=4,(0,xa.sleep)(1e3);case 4:e.loadingUsers=!1;case 5:a.n=11;break;case 6:if(!e.token||"first"===e.token){a.n=9;break}return a.n=7,e.$http.get("api/HyoDirectory/getUsers",{params:{nextToken:e.token,suspended:o}});case 7:return t=a.v,s=t.users,l=t.nextPageToken,e.token=l,e.rows=e.rows.concat(s),e.rowsClone=e.rowsClone.concat(JSON.parse(JSON.stringify(s))),a.n=8,e.prepareUsers();case 8:a.n=11;break;case 9:return a.n=10,(0,xa.sleep)(1e3);case 10:e.loadingUsers=!1;case 11:return a.a(2)}},a)}))()},openCreateuser:function(){var e=this;return ye()(Ce()().m(function a(){return Ce()().w(function(a){while(1)switch(a.n){case 0:return e.openModalCrearUsuario=!0,a.n=1,e.$nextTick();case 1:e.$refs.crearTreeUniOrg.selected="";case 2:return a.a(2)}},a)}))()},openGenerarCorreo:function(){this.openModalGenerarCorreo=!0},uploadExcel:function(e){var a=this;return ye()(Ce()().m(function o(){var r,n,i,t;return Ce()().w(function(o){while(1)switch(o.p=o.n){case 0:return r=e[0],a.file.uplodad=r,a.$q.loading.show(),o.p=1,o.n=2,(0,ba.Upload)({url:"api/HyoArchivo/tmp/upload",file:r});case 2:return n=o.v,a.file.response=n,o.n=3,a.$http.post("api/HyoDirectory/prepareImportacion",{pathExcel:a.file.response});case 3:i=o.v,t=[],i.map(function(e){Object.prototype.hasOwnProperty.call(e,"EXISTS")&&(t[t.length]=e.USUCOD)}),a.loadDisabled.values=t,a.rowsImportacion=i,a.$notify("Archivo importado con éxito","success"),o.n=5;break;case 4:o.p=4,o.v,a.$notify("No ha sido posible importar el archivo","warning");case 5:a.$q.loading.hide();case 6:return o.a(2)}},o,null,[[1,4]])}))()},selectedCrearUniOrg:function(e){this.selectCrearUniOrg=e},createUser:function(){var e=this;return ye()(Ce()().m(function a(){var o,r,n,i,t,s,l,c,u,d;return Ce()().w(function(a){while(1)switch(a.p=a.n){case 0:if(e.$refs.crearTreeUniOrg.selected){a.n=1;break}return e.$notify("Seleccione unidad organizativa","info"),a.a(2);case 1:return a.n=2,e.$refs.refCrearUsuario.validate();case 2:if(o=a.v,!0!==o){a.n=8;break}return a.p=3,e.$q.loading.show(),r=e.selectCrearUniOrg.orgUnitPath,n={familyName:"".concat(e.formCreateUsers.apellidoPaterno," ").concat(e.formCreateUsers.apellidoMaterno),givenName:e.formCreateUsers.nombres,password:e.formCreateUsers.contrasenia,primaryEmail:"".concat(e.formCreateUsers.correo,"@").concat(e.dominio),orgUnitPath:r,usucod:e.usuarioNuevo,tipo:e.tipoNuevo},a.n=4,e.$http.post("api/HyoDirectory/createUser",n);case 4:return i=a.v,t=i.id,s=i.primaryEmail,l=i.name,c=i.asociado,u={id:t,primaryEmail:s,name:l,orgUnitPath:r,fullName:"".concat(l.familyName," ").concat(l.givenName)},e.$refs.tableUsuariosGoogle.createRow(u),e.formCreateUsers={nombres:"",apellidoPaterno:"",apellidoMaterno:"",correo:"",contrasenia:""},e.usuarioNuevo="",e.tipoNuevo="",d={id:t,primaryEmail:s,name:l,orgUnitPath:r,fullName:"".concat(l.givenName," ").concat(l.familyName),asociado:c},e.rowsClone.push(d),e.selectedUnidadOrganizativa?e.filterUsers(e.selectedUnidadOrganizativa.orgUnitPath):e.rows.unshift(d),a.n=5,e.getUsuariosBySistema();case 5:e.openModalCrearUsuario=!1,e.$notify("Usuario guardado correctamente.","success"),a.n=7;break;case 6:a.p=6,a.v,e.$notify("Usuario guardado correctamente.","warning");case 7:e.$q.loading.hide();case 8:return a.a(2)}},a,null,[[3,6]])}))()},filterUsers:function(e){if("all"!==e){var a=[];this.rowsClone.map(function(o){o.orgUnitPath===e&&(a[a.length]=o)}),this.rows=a}else this.rows=JSON.parse(JSON.stringify(this.rowsClone))},getUsers:function(){var e=this;return ye()(Ce()().m(function a(){return Ce()().w(function(a){while(1)switch(a.p=a.n){case 0:return e.token="first",e.deUnidadOrganizativa="",e.$refs.treePrincipal.selected="",e.selectedUnidadOrganizativa=null,e.rows=[],e.rowsClone=[],a.p=1,e.loadingUsers=!0,a.n=2,e.prepareUsers();case 2:a.n=4;break;case 3:a.p=3,a.v,e.loadingUsers=!1;case 4:return a.a(2)}},a,null,[[1,3]])}))()},filter:function(e,a){var o=this;a(function(){try{var a=e.toLowerCase();o.usuarios=o.usuariosCopy.filter(function(e){return e.USUNOM.toLowerCase().indexOf(a)>-1})}catch(e){}})},asociarUsuario:function(){var e=this;return ye()(Ce()().m(function a(){return Ce()().w(function(a){while(1)switch(a.p=a.n){case 0:if(e.selectedUnidadOrganizativa&&"all"!==e.selectedUnidadOrganizativa){a.n=1;break}return e.$notify("Seleccione una unidad organizativa","info"),a.a(2);case 1:if(e.usuario){a.n=2;break}return e.$notify("Seleccione un usuario","info"),a.a(2);case 2:return a.p=2,e.$q.loading.show(),a.n=3,e.$http.post("api/HyoDirectory/asociarUsuario",{tipcod:e.tipo,usuario:e.rowUserNoAsociado.primaryEmail,usucod:e.usuario,orgUnitPath:e.selectedUnidadOrganizativa.orgUnitPath,orgUnitId:e.selectedUnidadOrganizativa.orgUnitId});case 3:return e.rowUserNoAsociado["asociado"]=e.usuario,e.usuario="",e.tipo="005",a.n=4,e.getUsuariosBySistema();case 4:e.openModalAsociarUsuario=!1,e.$notify("Usuario asocidado.","success"),a.n=6;break;case 5:a.p=5,a.v,e.$notify("No ha sido posible asociar al usuario seleccionado.","warning");case 6:e.$q.loading.hide();case 7:return a.a(2)}},a,null,[[2,5]])}))()},getUsuariosBySistema:function(e){var a=this;return ye()(Ce()().m(function o(){var r,n;return Ce()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,a.$http.get("api/HyoUsuario/getUsuariosBySistema",{params:{siscod:"21",estado:"A",sinUsuariosExternos:!0,tipo:e||a.tipoNuevo}});case 1:r=o.v,n=r.json,a.usuarios=n,a.usuariosCopy=JSON.parse(JSON.stringify(n));case 2:return o.a(2)}},o)}))()},init:function(){var e=this;return ye()(Ce()().m(function a(){var o,r,n;return Ce()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,e.$http.get("api/HyoDirectory/getDomain");case 1:o=a.v,r=o.DOMINIO,n=o.EXP_CORREO;try{e.correoExp=JSON.parse(n)}catch(a){e.correoExp={}}return e.dominio=r,a.n=2,e.getUsers();case 2:return a.n=3,e.$refs.treePrincipal.getAllOrgunits();case 3:return a.a(2)}},a)}))()},cerrarSesionAdmin:function(){var e=this;return ye()(Ce()().m(function a(){var o,r,n;return Ce()().w(function(a){while(1)switch(a.p=a.n){case 0:return a.p=0,a.n=1,e.$http.post("api/HyoLoginGoogleAdmin/cerrarSesionAdmin");case 1:o=a.v,r=o.message,e.$notify(r,"success"),e.$router.push({name:"intranet.muro"}),e.isLogged=!1,a.n=3;break;case 2:a.p=2,n=a.v,e.$notify(n.message,"warning");case 3:return a.a(2)}},a,null,[[0,2]])}))()}},created:function(){var e=this;return ye()(Ce()().m(function a(){return Ce()().w(function(a){while(1)switch(a.n){case 0:return e.sie=(0,ya["default"])(),a.n=1,e.login();case 1:window.currentSieCloud=!1,(0,xa.watchAuth2)(["_apiGoogle"],function(){var a=ye()(Ce()().m(function a(o,r){var n,i,t,s;return Ce()().w(function(a){while(1)switch(a.p=a.n){case 0:t=r,a.n="_apiGoogle"===t?1:7;break;case 1:return e.$q.loading.show(),a.p=2,a.n=3,e.$http.post("api/HyoLoginGoogleAdmin/guardarCodigo",{codigo:o});case 3:return n=a.v,e.isLogged=!0,a.n=4,e.init();case 4:e.$notify(n.message,"success"),a.n=6;break;case 5:a.p=5,s=a.v,i=s.error||{},e.$notify(i.msg||i.message||"No ha sido posible iniciar sesión.","warning");case 6:return e.$q.loading.hide(),a.a(3,7);case 7:return a.a(2)}},a,null,[[2,5]])}));return function(e,o){return a.apply(this,arguments)}}());case 2:return a.a(2)}},a)}))()},unmounted:function(){window.callback&&window.removeEventListener("storage",window.callback.cb)},beforeCreate:function(){window.callback&&window.removeEventListener("storage",window.callback.cb)}};const Sa=(0,Te.A)(Aa,[["render",Ue]]);var La=Sa}}]);