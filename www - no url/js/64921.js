"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[64921],{64921:function(e,o,a){a.r(o),a.d(o,{default:function(){return H}});var t=a(61758),i={class:"row q-col-gutter-sm"},n={class:"col-md-5 col-xs-12"},l={class:"col-md-7 col-xs-12"},r={class:"row q-gutter-sm items-center"},c={class:"col"},s={class:"col"},d={class:"q-mt-sm"},m={class:"q-pa-md"},u={class:"row q-col-gutter-sm"},f={class:"col-12"},p={class:"row q-col-gutter-sm"},b={class:"col-md-6 col-xs-4"},g={class:"col-md-6 col-xs-4"},M={class:"col-md-6 col-xs-4"},D={class:"col-md-6 col-xs-4"},h={class:"col-md-3 col-xs-4"},E={class:"col-md-3 col-xs-4"},F={class:"col-md-6 col-xs-4"},C={class:"col-12"};function v(e,o){var a=this,v=(0,t.g2)("header-btn"),w=(0,t.g2)("q-input"),O=(0,t.g2)("q-btn"),V=(0,t.g2)("sie-table"),k=(0,t.g2)("q-card-section"),I=(0,t.g2)("q-card"),R=(0,t.g2)("q-datetime"),S=(0,t.g2)("sie-modal"),N=(0,t.g2)("modal-medicamento"),A=(0,t.g2)("q-page");return(0,t.uX)(),(0,t.Wv)(A,{class:"q-pa-sm consulta-medicamentos"},{default:(0,t.k6)(function(){return[(0,t.bF)(I,{dense:"",flat:"",bordered:""},{default:(0,t.k6)(function(){return[(0,t.bF)(v,{name:e.title,buttons:e.buttons},null,8,["name","buttons"]),(0,t.bF)(k,null,{default:(0,t.k6)(function(){return[(0,t.Lk)("div",i,[(0,t.Lk)("div",n,[(0,t.bF)(w,{modelValue:e.form.usuario,"onUpdate:modelValue":o[0]||(o[0]=function(o){return e.form.usuario=o}),label:"Usuario",disable:""},null,8,["modelValue"])]),(0,t.Lk)("div",l,[(0,t.Lk)("div",r,[(0,t.Lk)("div",c,[(0,t.bF)(w,{modelValue:e.form.fecIni,"onUpdate:modelValue":o[1]||(o[1]=function(o){return e.form.fecIni=o}),label:"De",type:"date"},null,8,["modelValue"])]),(0,t.Lk)("div",s,[(0,t.bF)(w,{modelValue:e.form.fecFin,"onUpdate:modelValue":o[2]||(o[2]=function(o){return e.form.fecFin=o}),label:"Hasta",type:"date"},null,8,["modelValue"])]),(0,t.bF)(O,{dense:"",icon:"search",flat:"",round:"",size:"md",onClick:e.searchMedicamento},null,8,["onClick"])])])]),(0,t.Lk)("div",d,[(0,t.bF)(V,{class:"sie-table_alto","row-key":"id","persistent-row-select":"",data:e.rows,config:e.config,columns:e.fields,onRowSelected:e.itemClick,selection:"single",context:a,flat:"",bordered:"","wrap-cells":""},null,8,["data","config","columns","onRowSelected"])])]}),_:1})]}),_:1}),(0,t.bF)(S,{title:e.titleModal,modelValue:e.modificarIngreso,"onUpdate:modelValue":o[10]||(o[10]=function(o){return e.modificarIngreso=o}),ok:"Grabar",css:{width:"600px"},onSubmit:e.modificar},{default:(0,t.k6)(function(){return[(0,t.Lk)("div",m,[(0,t.Lk)("div",u,[(0,t.Lk)("div",f,[(0,t.Lk)("div",p,[(0,t.Lk)("div",b,[(0,t.bF)(R,{modelValue:e.formModificar.FECMOV,"onUpdate:modelValue":o[3]||(o[3]=function(o){return e.formModificar.FECMOV=o}),label:"Fecha","hide-bottom-space":""},null,8,["modelValue"])]),(0,t.Lk)("div",g,[(0,t.bF)(w,{disable:"",modelValue:e.formModificar.ANOMOV,"onUpdate:modelValue":o[4]||(o[4]=function(o){return e.formModificar.ANOMOV=o}),label:"Año"},null,8,["modelValue"])]),(0,t.Lk)("div",M,[(0,t.bF)(w,{disable:"",modelValue:e.formModificar.DOCREF,"onUpdate:modelValue":o[5]||(o[5]=function(o){return e.formModificar.DOCREF=o}),label:"Documento"},null,8,["modelValue"])]),(0,t.Lk)("div",D,[(0,t.bF)(w,{disable:"",modelValue:e.formModificar.NROMOV,"onUpdate:modelValue":o[6]||(o[6]=function(o){return e.formModificar.NROMOV=o}),label:"Movimiento"},null,8,["modelValue"])]),(0,t.Lk)("div",h,[(0,t.bF)(w,{disable:"",modelValue:e.formModificar.SERREF,"onUpdate:modelValue":o[7]||(o[7]=function(o){return e.formModificar.SERREF=o}),label:"Serie"},null,8,["modelValue"])]),(0,t.Lk)("div",E,[(0,t.bF)(w,{disable:"",modelValue:e.formModificar.NROREF,"onUpdate:modelValue":o[8]||(o[8]=function(o){return e.formModificar.NROREF=o}),label:"Nro. Doc"},null,8,["modelValue"])]),(0,t.Lk)("div",F,[(0,t.bF)(w,{disable:"",modelValue:e.formModificar.USUCOD,"onUpdate:modelValue":o[9]||(o[9]=function(o){return e.formModificar.USUCOD=o}),label:"Usuario"},null,8,["modelValue"])])])]),(0,t.Lk)("div",C,[(0,t.bF)(I,{flat:"",bordered:""},{default:(0,t.k6)(function(){return[(0,t.bF)(v,{name:"Medicamentos Agregados",buttons:e.buttonsAgregados},null,8,["buttons"]),(0,t.bF)(V,{"row-key":"id",data:e.rowsMod,config:e.tablaConfig,columns:e.tablaConfig.fieldsMod,onRowSelected:e.itemClickModificar,selection:"single",context:a,css:{height:"400px"},flat:"",dense:"",bordered:"","wrap-cells":""},null,8,["data","config","columns","onRowSelected"])]}),_:1})])])])]}),_:1},8,["title","modelValue","onSubmit"]),(0,t.bF)(N,{title:e.title,modelValue:e.openModalAgregar,"onUpdate:modelValue":o[11]||(o[11]=function(o){return e.openModalAgregar=o}),rows:e.rowsMod,datos:e.mediData,"onUpdate:datos":o[12]||(o[12]=function(o){return e.mediData=o})},null,8,["title","modelValue","rows","datos"])]}),_:1})}var w=a(57008),O=a.n(w),V=a(76080),k=a.n(V),I=a(45254),R=a.n(I),S=(a(39866),a(77507),a(52133),a(10239),a(89571),a(50310),a(6724),a(83190),a(62692),a(6123)),N=a(88567),A=a(95718),T=a(9736),Y=a(16648),U=a(50425),x=a(88275),L=a(92173),y=a(30640),P=a(17823),Q=a(50304),q=a(33777),_=a(87827),$=a(2819),B={data:function(){return{config:{CANTIDAD:{edit:!0},FECMOV:{component:"date",edit:!1},PRINTER:{component:"button",icon:["printer as reportar"],tooltip:{reportar:"Imprimir"},reportar:function(e){var o=S.p6.formatDate(this.form.fecIni,"DD/MM/YYYY"),a=S.p6.formatDate(this.form.fecFin,"DD/MM/YYYY"),t={del:this.del||o,al:this.al||a,tipo:0,id:e.MEDCOD,hdmov:e.NROMOV,medcodxx:"",meddesxx:""};"I"===this.tipoconsulta?(0,$.exportFilePhp)(t,"medico/regis-ingreso/imprimir"):"S"===this.tipoconsulta?(t.fechaini=t.del,t.fechafin=t.al,(0,$.exportFilePhp)(t,"medico/regis-salida/imprimir")):(0,$.exportFilePhp)(t,"medico/regis-consultas/imprimir")},flat:!0,dense:!0,color:"primary"},DELETE:{component:"button",icon:["delete as eliminar"],tooltip:{eliminar:"Eliminar"},eliminar:function(e){console.log("Eliminnar Elemento",e)},flat:!0,dense:!0,color:"primary"}}}},methods:{getDocNom:function(e){var o={"001":"Boleta","002":"Factura","003":"Guia","004":"Inventario Inicial","005":"Regularizar Stock","008":"Reprocesar stock Medicamentos"};return o[e]}}},z=a(57668),G=a(26319),K={mixins:[B],props:{tipoconsulta:{type:String}},components:{QCard:N.A,QCardSection:A.A,QInput:T.A,QSelect:Y.A,modalMedicamento:_.A,sieTable:q.A,sieSalones:x.Ay,sieEstudiantes:L.Ay,sieModal:y.A,SieFecha:P.A,QTable:U.A,QTd:S.Ef,QTr:S.qh,QPopupEdit:S.GT,QDatetime:Q.A,QToggle:S.c5,QPageSticky:S._U,QFab:S.l6,QFabAction:S.B$,QPage:S.Tu,QBtn:S.Il},data:function(){var e=this,o=(0,z["default"])();return{del:null,al:null,movimientos:["I","S"],eliminados:[],mediData:[],modificarIngreso:!1,titleModal:"I"===this.tipoconsulta?"Modificar Ingreso":"Modificar Salida",formModificar:{fecmov:new Date},title:"I"===this.tipoconsulta?"Consultar Medicamentos (Ingresos)":"S"===this.tipoconsulta?"Consultar Medicamentos (Salidas)":"Consultar Medicamentos",rows:[],rowsMod:[],openModalAgregar:!1,tablaConfig:{DELETE:{component:"button",icon:["delete as eliminar"],tooltip:{eliminar:"Eliminar"},eliminar:function(e,o){this.eliminados.push(e);var a=o.$$key;this.rowsMod.splice(a,1)},flat:!0,dense:!0,color:"primary"},CANTIDAD:{component:"input",type:"number",maxlength:100,input:function(e){}},fieldsMod:[{name:"MEDCOD",label:"Codigo",field:"MEDCOD",sortable:!0,align:"center"},{name:"MEDDES",label:"Descripción",field:"MEDDES",sortable:!0,align:"left"},{name:"CANTIDAD",label:"Cantidad",field:"CANTIDAD",sortable:!0,align:"left",editable:!0},{name:"DELETE",label:"",field:"DELETE",align:"left"}],paginacion:{page:1,rowsPerPage:20},registrosSeleccionados:[]},fields:"I"===this.tipoconsulta||"S"===this.tipoconsulta?[{name:"FECMOV",label:"Fecha Movimiento",field:"FECMOV",sortable:!0,align:"center"},{name:"NROMOV",label:"N° Mov",field:"NROMOV",sortable:!0,align:"left"},{name:"DOCREF",label:"Documento",field:"DOCREF",sortable:!0,align:"left"},{name:"SERREF",label:"Serie",field:"SERREF",sortable:!0,align:"left"},{name:"NROREF",label:"N° Documento",field:"NROREF",sortable:!0,align:"left"},{name:"USUCOD",label:"Usuario",field:"USUCOD",sortable:!0,align:"left"},{name:"PRINTER",label:"",field:"PRINTER",sortable:!0,align:"left"}]:[{name:"MEDCOD",label:"Codigo",field:"MEDCOD",sortable:!0,align:"center"},{name:"MEDDES",label:"Descripción",field:"MEDDES",sortable:!0,align:"left"},{name:"MEDUNI",label:"Sin Unid",field:"MEDUNI",sortable:!0,align:"left"},{name:"FECSTO",label:"Fecha Stock",field:"FECSTO",sortable:!0,align:"left"},{name:"VENCIMIENTO",label:"Vencimeinto",field:"VENCIMIENTO",sortable:!0,align:"left"},{name:"STOCK",label:"Stock",field:"STOCK",sortable:!0,align:"left"},{name:"PRINTER",label:"",field:"PRINTER",sortable:!0,align:"left"}],form:{usuario:o.usucod,fecIni:(0,G.formatDate)(new Date,"YYYY-MM-DD"),fecFin:(0,G.formatDate)(new Date,"YYYY-MM-DD")},buttonsAgregados:[{icon:"add_circle",round:!0,click:this.modificarAdd,tooltip:"Agregar"}],buttons:"I"===this.tipoconsulta||"S"===this.tipoconsulta?[{icon:"arrow_back",label:"Atrás",click:function(){"I"===e.tipoconsulta?e.$router.push({name:"medico.ingreso"}):e.$router.push({name:"medico.salida"})}}]:[{icon:"file_pdf_o",label:"Imprimir PDF",click:function(){e.imprimir("pdf")}},{icon:"file_excel",label:"Imprimir EXCEL",click:function(){e.imprimir("xls")}}]}},methods:{imprimir:function(e){var o={del:this.del||"%",al:this.al||"%",tipo:0,format:e};(0,$.exportFilePhp)(o,"medico/regis-consultas/ireport")},modificarAdd:function(){var e=this;return R()(k()().m(function o(){return k()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,e.listarMedicamento();case 1:e.openModalAgregar=!0;case 2:return o.a(2)}},o)}))()},modificarDelete:function(){},searchMedicamento:function(){var e=this;return R()(k()().m(function o(){var a;return k()().w(function(o){while(1)switch(o.n){case 0:if(a={tipmov:e.tipoconsulta,fecIni:(0,G.convertirFormatoFecha)(e.form.fecIni,"-","."),fecFin:(0,G.convertirFormatoFecha)(e.form.fecFin,"-",".")},e.del=(0,G.convertirFormatoFecha)(e.form.fecIni,"-","/"),e.al=(0,G.convertirFormatoFecha)(e.form.fecFin,"-","/"),!e.movimientos.includes(e.tipoconsulta)){o.n=2;break}return o.n=1,e.$http.get("api/medicamentoController/getConsultaMed/",{params:{params:a}}).then(function(o){e.rows=o.data.map(function(o){return o.DOCREF=e.getDocNom(o.DOCREF),o})}).catch(function(e){console.error(e.message)});case 1:o.n=3;break;case 2:return o.n=3,e.$http.get("api/medicamentoController/getMedicamento/",{params:{params:a}}).then(function(o){e.rows=o.data.map(function(e){return e.FECSTO=S.p6.formatDate(e.FECSTO,"DD/MM/YYYY"),e.VENCIMIENTO=S.p6.formatDate(e.VENCIMIENTO,"DD/MM/YYYY"),e})}).catch(function(e){console.error(e.message)});case 3:return o.a(2)}},o)}))()},itemClick:function(e){var o=this;return R()(k()().m(function a(){return k()().w(function(a){while(1)switch(a.n){case 0:if(o.tipoconsulta){a.n=1;break}return a.a(2,0);case 1:return o.modificarIngreso=!0,o.formModificar=O()({},e),a.n=2,o.getDataByNro(o.formModificar.NROMOV);case 2:return a.a(2)}},a)}))()},revertDate:function(e){return e.split("/").reverse().join("-")},itemClickModificar:function(e){},listarMedicamento:function(){var e=this;return R()(k()().m(function o(){var a,t;return k()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,e.$http.get("/api/medicamentoController/getMedicamento",{params:{params:{constock:!0}}});case 1:a=o.v,t=a.data,e.mediData=t;case 2:return o.a(2)}},o)}))()},actualizarMedicamento:function(){var e=this;return R()(k()().m(function o(){var a,t,i;return k()().w(function(o){while(1)switch(o.n){case 0:return a=e.eliminados,t=e.rowsMod,i=e.formModificar,o.n=1,e.$http.post("/api/medicamentoController/actualizarMedicamento/",{data:t,cabecera:i,eliminados:a});case 1:e.formModificar={};case 2:return o.a(2)}},o)}))()},modificar:function(){var e=this;return R()(k()().m(function o(){return k()().w(function(o){while(1)switch(o.n){case 0:return e.modificarIngreso=!1,o.n=1,e.actualizarMedicamento();case 1:return o.a(2)}},o)}))()},getDataByNro:function(e){var o=this;return R()(k()().m(function a(){return k()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,o.$http.get("api/medicamentoController/getByNro/",{params:{params:{nromov:e}}}).then(function(e){o.rowsMod=e.data});case 1:return a.a(2)}},a)}))()}},created:function(){var e=this;return R()(k()().m(function o(){var a;return k()().w(function(o){while(1)switch(o.n){case 0:if(!e.movimientos.includes(e.tipoconsulta)){o.n=2;break}return o.n=1,e.$http.get("api/medicamentoController/getConsultaMed/",{params:{params:{tipmov:e.tipoconsulta}}}).then(function(o){e.rows=o.data.map(function(o){return o.DOCREF=e.getDocNom(o.DOCREF),o})});case 1:o.n=4;break;case 2:return o.n=3,e.$http.get("api/medicamentoController/getMedicamento/");case 3:a=o.v,e.rows=a.data.map(function(e){return e.FECSTO=S.p6.formatDate(e.FECSTO,"DD/MM/YYYY"),e.VENCIMIENTO=S.p6.formatDate(e.VENCIMIENTO,"DD/MM/YYYY"),e});case 4:return o.a(2)}},o)}))()}},X=a(12807);const j=(0,X.A)(K,[["render",v],["__scopeId","data-v-2f3fc999"]]);var H=j}}]);