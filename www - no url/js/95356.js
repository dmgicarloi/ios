"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[95356],{95356:function(e,n,o){o.r(n),o.d(n,{default:function(){return ae}});var t=o(8445),a=o.n(t),i=o(61758),r={class:"row"},s={class:"col-12 q-pa-sm"},l={class:"row q-col-gutter-sm"},c={class:"col"},u={class:"row q-pt-sm q-col-gutter-sm"},d={key:0,class:"col-xs-12"},p={class:"row full-height q-pt-sm"},f={class:"col column items-center justify-start"},m={class:"col-xs-12 col-md-2"},g={class:"col-xs-12 col-md-2"},b={class:"col-xs-12 col-md-5"},h={class:"col-xs-12 col-md-3"},v={key:0,class:"col-xs-12 col-sm-6 col-md-2"},O={class:"col-xs-12 col-sm-6 col-md-2"},I={key:1,class:"col-xs-12 col-md-2"},w={key:0},k={class:"row full-height q-pt-sm"},A={class:"col column items-center justify-start"},C={class:"row sie-flat q-pt-sm"},E={class:"col-12"},S={class:"row q-col-gutter-sm"},_={class:"col-12"};function N(e,n){var o=this,t=(0,i.g2)("header-btn"),N=(0,i.g2)("q-img"),L=(0,i.g2)("q-select"),P=(0,i.g2)("autocomplete"),y=(0,i.g2)("q-input"),D=(0,i.g2)("q-checkbox"),F=(0,i.g2)("q-tooltip"),R=(0,i.g2)("q-btn"),q=(0,i.g2)("sie-ngs"),x=(0,i.g2)("sie-table"),B=(0,i.g2)("q-card-section"),$=(0,i.g2)("q-card"),V=(0,i.g2)("modal-obs"),T=(0,i.g2)("box-imagen"),Q=(0,i.g2)("q-page");return(0,i.uX)(),(0,i.Wv)(Q,{class:"sie-flat biblioteca-bancolibros q-pa-sm"},{default:(0,i.k6)(function(){return[(0,i.bF)($,{flat:""},{default:(0,i.k6)(function(){return[(0,i.bF)(t,{name:"Banco Libros",buttons:e.buttons},null,8,["buttons"]),(0,i.bF)(B,{class:"q-pb-xs",style:{height:"calc(100vh - 143px)",padding:"0"}},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",r,[(0,i.Lk)("div",s,[(0,i.Lk)("div",l,[(0,i.Lk)("div",c,[(0,i.Lk)("div",u,[e.getWidth<=699?((0,i.uX)(),(0,i.CE)("div",d,[(0,i.Lk)("div",p,[(0,i.Lk)("div",f,[(0,i.bF)(N,{class:"foto-alumno",src:e.rutaFoto,width:"100px",height:"100px"},{error:(0,i.k6)(function(){return[(0,i.bF)(N,{class:"foto-alumno",src:e.rutaFotoDefault,width:"100px",height:"100px"},null,8,["src"])]}),_:1},8,["src"])])])])):(0,i.Q3)("v-if",!0),(0,i.Lk)("div",m,[(0,i.bF)(L,{class:"q-ma-none",label:"Operación",type:"outlined",modelValue:e.operacion,"onUpdate:modelValue":n[0]||(n[0]=function(n){return e.operacion=n}),options:e.config.operacionesBanco,"option-value":"ID","option-label":"DESCRIPCION",onInput:e.setearOperacion},null,8,["modelValue","options","onInput"])]),(0,i.Lk)("div",g,[(0,i.bF)(P,{class:"q-ma-none",ref:"refSolicita",modelValue:e.solcod,"onUpdate:modelValue":n[1]||(n[1]=function(n){return e.solcod=n}),label:"Código/Nombre",data:e.solicitantes,keys:e.keysComplete,onSelected:e.selectedBanco},null,8,["modelValue","data","keys","onSelected"])]),(0,i.Lk)("div",b,[(0,i.bF)(y,{readonly:"",modelValue:e.nombre,"onUpdate:modelValue":n[2]||(n[2]=function(n){return e.nombre=n}),label:"Solicitante"},null,8,["modelValue"])]),(0,i.Lk)("div",h,[(0,i.bF)(y,{modelValue:e.descriptor,"onUpdate:modelValue":n[3]||(n[3]=function(n){return e.descriptor=n}),readonly:"",label:e.descriptorLabel},null,8,["modelValue","label"])])]),(0,i.bF)(q,{class:"q-pt-sm q-col-gutter-sm",ref:"refSieGNS","seccion-btn":"",onNivel:n[10]||(n[10]=function(n){e.id_perfil=e.config.PERFIL_ALUMNO,e.getOperaciones()}),onGrado:e.getOperaciones,onSeccion:e.getOperaciones,"class-nivel":"col-xs-12 col-sm-6 col-md-4 col-lg-2","class-grado":"col-xs-12 col-sm-6 col-md-4 col-lg-2","class-seccion":"col-xs-12 col-sm-6 col-md-4 col-lg-2"},{prepend:(0,i.k6)(function(){return[e.operacion===e.config.OPERACION_PRESTAMO?((0,i.uX)(),(0,i.CE)("div",v,[(0,i.bF)(y,{modelValue:e.numpaq,"onUpdate:modelValue":n[4]||(n[4]=function(n){return e.numpaq=n}),ref:"refNumpaq",label:"Número Paquete",onKeyup:e.prestarPaquete},null,8,["modelValue","onKeyup"])])):(0,i.Q3)("v-if",!0),(0,i.Lk)("div",O,[(0,i.bF)(y,{modelValue:e.numingreso,"onUpdate:modelValue":n[5]||(n[5]=function(n){return e.numingreso=n}),ref:"refNumingreso",label:"Nro Ingreso",onKeyup:e.ejecutarAccion},null,8,["modelValue","onKeyup"])]),e.operacion===e.config.OPERACION_PRESTAMO?((0,i.uX)(),(0,i.CE)("div",I,[(0,i.bF)(D,{dense:"",modelValue:e.agenda,"onUpdate:modelValue":n[6]||(n[6]=function(n){return e.agenda=n}),label:e.txtAgenda,onInput:n[7]||(n[7]=function(n){return e.evaluarAgenda()})},null,8,["modelValue","label"])])):(0,i.Q3)("v-if",!0)]}),seccionbotones:(0,i.k6)(function(){return[(0,i.bF)(R,{icon:"search",color:"primary",dense:"",onClick:n[8]||(n[8]=function(n){return e.getOperaciones()})},{default:(0,i.k6)(function(){return[(0,i.bF)(F,null,{default:(0,i.k6)(function(){return a()(n[14]||(n[14]=[(0,i.eW)("Buscar",-1)]))}),_:1})]}),_:1}),(0,i.bF)(R,{icon:"broom",color:"primary",dense:"",onClick:n[9]||(n[9]=function(n){return e.limpiar()})},{default:(0,i.k6)(function(){return[(0,i.bF)(F,null,{default:(0,i.k6)(function(){return a()(n[15]||(n[15]=[(0,i.eW)("Limpiar",-1)]))}),_:1})]}),_:1})]}),_:1},8,["onGrado","onSeccion"])]),e.getWidth>=700?((0,i.uX)(),(0,i.CE)("div",w,[(0,i.Lk)("div",k,[(0,i.Lk)("div",A,[(0,i.bF)(N,{class:"foto-alumno",src:e.rutaFoto,width:"76px",height:"76px",onClick:e.openBoxImagen},{error:(0,i.k6)(function(){return[(0,i.bF)(N,{class:"foto-alumno",src:e.rutaFotoDefault,width:"76px",height:"76px"},null,8,["src"])]}),_:1},8,["src","onClick"])])])])):(0,i.Q3)("v-if",!0)]),(0,i.Lk)("div",C,[(0,i.Lk)("div",E,[(0,i.Lk)("div",S,[(0,i.Lk)("div",_,[(0,i.bF)(x,{ref:"refOper",columns:e.fields,onRowSelectedDbl:e.cargarDatosOper,"prevent-cell":"",data:e.rowsOperaciones,selection:"multiple",context:o,config:e.configTable,css:{height:"calc(100vh - 252px)"},totalPagination:e.totalPagination,totalRegistros:e.totalRegistros,onListarPagination:e.getOperaciones},null,8,["columns","onRowSelectedDbl","data","config","totalPagination","totalRegistros","onListarPagination"])])])])])])])]}),_:1})]}),_:1}),e.modalObs?((0,i.uX)(),(0,i.Wv)(V,{key:0,modelValue:e.modalObs,"onUpdate:modelValue":n[11]||(n[11]=function(n){return e.modalObs=n}),operacion:e.operacion,"onUpdate:operacion":n[12]||(n[12]=function(n){return e.operacion=n}),currentRow:e.currentRow,configDB:e.config,onGetOperaciones:e.getOperaciones,onSetearLimite:e.setearLimite},null,8,["modelValue","operacion","currentRow","configDB","onGetOperaciones","onSetearLimite"])):(0,i.Q3)("v-if",!0),e.openModalImagen?((0,i.uX)(),(0,i.Wv)(T,{key:1,modelValue:e.openModalImagen,"onUpdate:modelValue":n[13]||(n[13]=function(n){return e.openModalImagen=n}),urlImage:e.urlImagenBox,urlImageDefault:e.rutaFotoDefault,titulo:e.nombre},null,8,["modelValue","urlImage","urlImageDefault","titulo"])):(0,i.Q3)("v-if",!0)]}),_:1})}var L=o(76080),P=o.n(L),y=o(45254),D=o.n(y),F=(o(515),o(68017),o(6123)),R=o(9736),q=o(16648),x=o(3112),B=o(2739),$={data:function(){return{configTable:{FECPREI:{component:"datetime",edit:!1},FECDEV:{component:"datetime",edit:!1},OBS:{component:"button",icon:["write"],write:function(e){this.currentRow=e,this.config.caso=this.caso,this.modalObs=!0},tooltip:{write:"Agregar observación"},dense:!0,flat:!0}},rowsOperaciones:[],fields:[{name:"NUMINGRESO",label:"# Ingreso",field:"NUMINGRESO",align:"left",width:65},{name:"NUMPAQ",label:"# Paquete",field:"NUMPAQ",align:"left",width:65},{name:"NOMCOMP",label:"Nombre de Solicitante",field:"NOMCOMP",align:"left",wrap:!0},{name:"NGS_CARGO",label:"NGS/Cargo",field:"NGS_CARGO",align:"left",wrap:!0},{name:"TITULO",label:"Título",field:"TITULO",align:"left",wrap:!0,width:120},{name:"NOMESTADO",label:"Operación",field:"NOMESTADO",align:"left"},{name:"FECPREI",label:"F. Prestamo",field:"FECPREI",align:"left",wrap:!0},{name:"FECDEV",label:"F. Devolución",field:"FECDEV",align:"left",wrap:!0},{name:"OBS",label:"Obs",field:"OBS",align:"left"}]}}},V=o(57668),T=o(88567),Q=o(95718),U=o(53380),M=o(57343),G=o(53399),j=o(95477),X=o(65673),W=o(82327),K=o(88865),z=o(21103),H=o(2713),J=o(66592),Y=o(36667),Z=o(87410),ee=o(98361),ne={components:{QList:X.A,QItem:W.A,QItemSection:K.A,QInput:R.A,QSelect:q.A,QCheckbox:x.A,QForm:B.A,QCard:T.A,QCardSection:Q.A,QSeparator:U.A,QImg:G.A,QPopupProxy:j.A,Cronograma:H.A,sieNgs:Y.A,modalObs:Z.A,boxImagen:ee.A,QPage:F.Tu,QBtn:F.Il,QTooltip:F.nC},mixins:[$,J.A],data:function(){var e=this;return{bancoButtons:{enviarAlerta:{icon:"email",permiso:">1",label:"Enviar alerta",click:function(){e.enviarAlerta()}},devolucion:{icon:"keyboard_return",permiso:">1",label:"Devolución",click:function(){var n="¿Está seguro de realizar la devolución de las operaciones seleccionadas?";e.devolucionPrestamos(e.config.OPERACION_DEVOLUCION,n,!0)}},imprimir:{icon:"print",permiso:">=1",label:"Imprimir",click:function(){e.imprimirCargo()}},baja:{icon:"vertical_align_bottom",permiso:">1",label:"Dar de Baja Libro de regalos",click:function(){e.darBajaLibrosRegalos()}},revertirDev:{icon:"undo",permiso:">1",label:"Revertir",click:function(){var n="¿Está seguro de revertir las operaciones seccionadas?";e.revertirDevoluciones(n)}}},operacion:"",sieInfo:(0,V["default"])(),tab:"prestamo",personaSelected:{},codigoFoto:"",id_persona:"",id_perfil:"",tipoSolicita:"",solcod:"",sexo:"",referencia:"B",nombre:"",numingreso:"",solicitantes:[],keysComplete:["TEXT"],config:{operacionesBanco:[]},openModalObs:!1,modalObs:!1,currentRow:{},descriptor:"",descriptorLabel:"",agenda:!1,dataAgenda:{},numpaq:"",optAgenda:[{ID:0,DESCRIPCION:"Seleccione"},{ID:1,DESCRIPCION:"Incluye agenda"},{ID:2,DESCRIPCION:"Solo agenda"}],caso:1,totalPagination:1,totalRegistros:"",openModalImagen:!1,urlImagenBox:""}},computed:{getWidth:function(){return z.A.width},rutaFotoDefault:function(){var e=(0,M.getImageDefault)(this.sieInfo,this.sexo);return e},rutaFoto:function(){var e=(0,M.imgEstudiante)(this.sieInfo,this.codigoFoto);return e},txtAgenda:function(){return this.agenda?"Quitar agenda":"Entregar agenda"},buttons:function(){var e=[];return e=this.operacion===this.config.OPERACION_DEVOLUCION?[this.bancoButtons.enviarAlerta,this.bancoButtons.imprimir,this.bancoButtons.revertirDev,this.bancoButtons.baja]:[this.bancoButtons.enviarAlerta,this.bancoButtons.devolucion,this.bancoButtons.imprimir,this.bancoButtons.baja],e}},methods:{setearOperacion:function(){var e=this;return D()(P()().m(function n(){return P()().w(function(n){while(1)switch(n.n){case 0:if(e.operacion!==e.config.OPERACION_DEVOLUCION){n.n=2;break}return e.getOperaciones(),n.n=1,e.$nextTick();case 1:e.$refs.refNumingreso&&e.$refs.refNumingreso.$el.focus(),n.n=3;break;case 2:e.$refs.refSolicita&&e.$refs.refSolicita.focusComplete(),e.limpiar();case 3:return n.a(2)}},n)}))()},evaluarAgenda:function(){var e=this;return D()(P()().m(function n(){var o,t;return P()().w(function(n){while(1)switch(n.p=n.n){case 0:if(e.solcod){n.n=1;break}return e.$notify("Aviso- Debe indicar un solicitante.","info"),e.agenda=!e.agenda,n.a(2,!1);case 1:if(n.p=1,!e.agenda){n.n=4;break}return n.n=2,e.$http.post("api/OperacionesController/entregarAgenda",{data:{solcod:e.solcod,id_persona:e.id_persona,id_perfil:e.id_perfil}});case 2:return o=n.v,n.n=3,e.getAgendaEstudiante();case 3:n.n=6;break;case 4:return n.n=5,e.$http.post("api/OperacionesController/quitarAgenda",{id:e.dataAgenda.ID});case 5:o=n.v;case 6:e.$notify(o.message,"success"),n.n=8;break;case 7:n.p=7,t=n.v,e.agenda=!e.agenda,e.$notify(t.message,"warning");case 8:return n.a(2)}},n,null,[[1,7]])}))()},prestarPaquete:function(e){var n=this;return D()(P()().m(function o(){var t,a,i;return P()().w(function(o){while(1)switch(o.p=o.n){case 0:if(o.p=0,13===e.keyCode){o.n=1;break}return o.a(2,!1);case 1:if(n.numpaq){o.n=2;break}return n.$notify("Aviso- Debe indicar un paquete.","info"),o.a(2,!1);case 2:return n.solcod||n.$notify("Aviso- Debe indicar un solicitante.","info"),o.n=3,n.$http.post("api/OperacionesController/prestarPaquete",{data:{solcod:n.solcod,id_persona:n.id_persona,id_perfil:n.id_perfil,numpaq:n.numpaq}});case 3:t=o.v,a=t.message,n.numpaq="",n.$notify(a,"success"),n.getOperaciones(),o.n=5;break;case 4:return o.p=4,i=o.v,n.$notify(i.message,"warning"),o.a(2,!1);case 5:return o.a(2)}},o,null,[[0,4]])}))()},limpiar:function(){this.codigoFoto="",this.id_persona="",this.id_perfil="",this.solcod="",this.numpaq="",this.numingreso="",this.nombre="",this.descriptor="",this.descriptorLabel="NGS",this.agenda=!1,this.operacion=this.config.OPERACION_PRESTAMO,this.rowsOperaciones=[],this.setearNgs({})},selectedBanco:function(e){var n=this;return D()(P()().m(function o(){return P()().w(function(o){while(1)switch(o.n){case 0:if(n.personaSelected=e,e&&0!==Object.keys(e).length){o.n=1;break}return o.a(2,!1);case 1:return n.id_perfil=e.ID_PERFIL,n.id_persona=e.ID_PERSONA,n.nombre=e.NOMCOMP,n.solcod=e.SOLCOD,n.sexo=e.SEXO,n.tipoSolicita=e.TIPO_SOLICITA,n.descriptorLabel=e.ETIQUETA?e.ETIQUETA.trim():"NGS",n.descriptor=e.DESCRIPTOR||"--",n.$refs.refNumpaq.$el.focus(),n.codigoFoto=e.TIPO_SOLICITA===n.config.SOLICITA_ALUMNO?e.SOLCOD:"",n.getOperaciones(),o.n=2,n.getAgendaEstudiante();case 2:Object.keys(n.dataAgenda).length>0&&(n.agenda=!0);case 3:return o.a(2)}},o)}))()},getPersonasBiblioteca:function(){var e=this;return D()(P()().m(function n(){return P()().w(function(n){while(1)switch(n.p=n.n){case 0:return n.p=0,n.n=1,e.$http.get("api/OperacionesController/getPersonasBiblioteca",{params:{parametros:{id_perfil:e.config.PERFIL_ALUMNO}}});case 1:e.solicitantes=n.v,n.n=3;break;case 2:return n.p=2,n.v,n.a(2,[]);case 3:return n.a(2)}},n,null,[[0,2]])}))()},getAgendaEstudiante:function(){var e=this;return D()(P()().m(function n(){var o;return P()().w(function(n){while(1)switch(n.n){case 0:return n.n=1,e.$http.get("api/OperacionesController/getAgendaEstudiante",{params:{id_persona:e.id_persona}});case 1:o=n.v,e.dataAgenda=o.length>0?o[0]:{};case 2:return n.a(2)}},n)}))()},getFilasSelected:function(e){return this.$refs.refOper.rowsSelected(e)},ejecutarAccion:function(e){return 13===e.keyCode&&(!(!this.numingreso&&!this.solcod)&&(this.solcod&&this.numingreso&&this.operacion===this.config.OPERACION_PRESTAMO?this.prestamoIndividualBanco():this.numingreso&&this.operacion===this.config.OPERACION_DEVOLUCION?this.devolucionXNumeroIngreso():void 0))},devolucionXNumeroIngreso:function(){var e=this;return D()(P()().m(function n(){var o,t,a,i;return P()().w(function(n){while(1)switch(n.p=n.n){case 0:return n.p=0,n.n=1,e.$http.post("api/OperacionesController/devolucionXNumeroIngreso",{numingreso:e.numingreso,referencia:"B"});case 1:return o=n.v,t=o.message,a=o.data,a.conHtml?e.$alert(t,a.type||"success",!0):e.$notify(t,a.type||"success"),e.numingreso="",e.getOperaciones(),n.a(2,!0);case 2:return n.p=2,i=n.v,e.$notify(i.message,"warning"),n.a(2,!1)}},n,null,[[0,2]])}))()},darBajaLibrosRegalos:function(){var e=this;return D()(P()().m(function n(){var o,t,a,i;return P()().w(function(n){while(1)switch(n.p=n.n){case 0:return n.p=0,n.n=1,e.$http.post("api/OperacionesController/darBajaLibrosRegalos");case 1:return o=n.v,t=o.message,a=o.data,e.$notify(t,a.type||"success"),n.a(2,!0);case 2:return n.p=2,i=n.v,e.$notify(i.message,"warning"),n.a(2,!1)}},n,null,[[0,2]])}))()},prestamoIndividualBanco:function(){var e=this;return D()(P()().m(function n(){var o,t,a,i,r;return P()().w(function(n){while(1)switch(n.p=n.n){case 0:return n.p=0,o={solcod:e.solcod,id_persona:e.id_persona,id_perfil:e.id_perfil,numingreso:e.numingreso},n.n=1,e.$http.post("api/OperacionesController/prestamoIndividualBanco",{data:o});case 1:return t=n.v,a=t.message,i=t.data,e.$notify(a,i.type||"success"),e.numingreso="",e.getOperaciones(),n.a(2,!0);case 2:return n.p=2,r=n.v,e.$notify(r.message,"warning"),n.a(2,!1)}},n,null,[[0,2]])}))()},enviarAlerta:function(){var e=this;return D()(P()().m(function n(){var o,t,a,i,r,s;return P()().w(function(n){while(1)switch(n.p=n.n){case 0:if(n.p=0,o=[],e.id_persona){n.n=1;break}if(o=e.getFilasSelected(["IDOPERADET"]),0!==o.length){n.n=1;break}return e.$notify("Aviso- Debe seleccionar los registros a enviar la alerta","info"),n.a(2,!1);case 1:return e.loading=!0,t={operaciones:o,tipo:e.operacion,alumno:e.solcod,id_persona:e.id_persona,referencia:"B",token:e.sieInfo.token},n.n=2,e.$http.post("api/OperacionesController/enviarAlertas",{data:t});case 2:a=n.v,i=a.message,r=a.data,e.$alert(i,r.type||"success",!0),n.n=4;break;case 3:n.p=3,s=n.v,e.$alert(s.message,"warning",!0);case 4:return n.a(2)}},n,null,[[0,3]])}))()}},mounted:function(){var e=this;return D()(P()().m(function n(){return P()().w(function(n){while(1)switch(n.n){case 0:e.limpiar(),e.$refs.refSolicita&&e.$refs.refSolicita.focusComplete();case 1:return n.a(2)}},n)}))()},created:function(){var e=this;return D()(P()().m(function n(){return P()().w(function(n){while(1)switch(n.n){case 0:return n.n=1,e.getConfigOperaciones();case 1:return n.n=2,e.getPersonasBiblioteca();case 2:return n.a(2)}},n)}))()}},oe=o(12807);const te=(0,oe.A)(ne,[["render",N]]);var ae=te}}]);