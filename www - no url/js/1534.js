"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[1534],{1534:function(e,n,o){o.r(n),o.d(n,{default:function(){return D}});o(56285),o(515);var t=o(61758),a=o(58790),r={key:1,class:"column col items-center justify-center"},s={class:"row q-px-sm q-pt-sm"},l={class:"col-xs-12"};function i(e,n){var o=(0,t.g2)("sie-estudiantes"),i=(0,t.g2)("sie-vacio"),u=(0,t.g2)("q-search"),c=(0,t.g2)("q-tab"),d=(0,t.g2)("q-tabs"),f=(0,t.g2)("q-checkbox"),b=(0,t.g2)("q-item-tile"),p=(0,t.g2)("q-item-side"),m=(0,t.g2)("q-item-main"),h=(0,t.g2)("q-item"),v=(0,t.g2)("q-list"),C=(0,t.g2)("sie-usuario"),j=(0,t.g2)("q-spinner-oval"),g=(0,t.g2)("q-inner-loading"),k=(0,t.g2)("q-tab-panel"),U=(0,t.g2)("q-tab-panels"),O=(0,t.g2)("q-page");return(0,t.uX)(),(0,t.Wv)(O,{class:"contactos bg-white"},{default:(0,t.k6)(function(){return["005"!==e.sieInfo.tipcod?((0,t.uX)(),(0,t.Wv)(o,{key:0,onSelected:e.getContactos,modelValue:e.alucod,"onUpdate:modelValue":n[0]||(n[0]=function(n){return e.alucod=n})},null,8,["onSelected","modelValue"])):(0,t.Q3)("v-if",!0),e.vacio||e.ocultaCompañeros&&e.ocultaProfes||!Object.keys(e.objActual).length?((0,t.uX)(),(0,t.CE)("div",r,[(0,t.bF)(i,{subtitle:e.mensajeError,icon:"person"},null,8,["subtitle"])])):((0,t.uX)(),(0,t.CE)(t.FK,{key:2},[(0,t.Lk)("div",s,[(0,t.Lk)("div",l,[(0,t.bF)(u,{class:"q-if-outlined",modelValue:e.buscar,"onUpdate:modelValue":n[1]||(n[1]=function(n){return e.buscar=n}),clearable:"",debounce:300},null,8,["modelValue"])])]),(0,t.bF)(d,{class:"q-caption",modelValue:e.selectedTab,"onUpdate:modelValue":n[2]||(n[2]=function(n){return e.selectedTab=n}),inverted:"","active-color":"primary",dense:"",align:"left"},{default:(0,t.k6)(function(){return[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.tabs,function(n,o){return(0,t.uX)(),(0,t.Wv)(c,{key:o,name:n.name,label:n.label,onSelect:e.selectTab},null,8,["name","label","onSelect"])}),128))]}),_:1},8,["modelValue"]),(0,t.bF)(U,{modelValue:e.selectedTab,"onUpdate:modelValue":n[7]||(n[7]=function(n){return e.selectedTab=n}),infinite:"",swipeable:"",animated:""},{default:(0,t.k6)(function(){return[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.tabs,function(o,r){return(0,t.uX)(),(0,t.Wv)(k,{key:r,class:"q-pa-none bg-white no-padding",name:o.name},{default:(0,t.k6)(function(){return[(0,t.bF)(v,{class:"bg-white q-py-none"},{default:(0,t.k6)(function(){return[(0,t.bF)(h,null,{default:(0,t.k6)(function(){return[e.verAcceso?((0,t.uX)(),(0,t.Wv)(p,{key:0},{default:(0,t.k6)(function(){return[(0,t.bF)(b,null,{default:(0,t.k6)(function(){return[(0,t.bF)(f,{modelValue:e.all,"onUpdate:modelValue":n[3]||(n[3]=function(n){return e.all=n}),color:"secondary",onInput:e.seleccionarTodos,disable:e.disabled},null,8,["modelValue","onInput","disable"])]}),_:1})]}),_:1})):(0,t.Q3)("v-if",!0),e.verAcceso?((0,t.uX)(),(0,t.Wv)(p,{key:1},{default:(0,t.k6)(function(){return[(0,t.bF)(b,null,{default:(0,t.k6)(function(){return[(0,t.eW)((0,a.v_)(e.$t(e.all?"desSeleccionarTodos":"seleccionarTodos")),1)]}),_:1})]}),_:1})):(0,t.Q3)("v-if",!0),e.objEnviar.length>0?((0,t.uX)(),(0,t.Wv)(m,{key:2},{default:(0,t.k6)(function(){return[(0,t.bF)(b,{class:"float-right hidden","text-color":"faded"},{default:(0,t.k6)(function(){return[(0,t.eW)((0,a.v_)(e.objEnviar.length)+" "+(0,a.v_)(e.$t(e.objEnviar.length>1?"contactosSeleccionados":"contactoSeleccionado")),1)]}),_:1})]}),_:1})):((0,t.uX)(),(0,t.Wv)(m,{key:3},{default:(0,t.k6)(function(){return[(0,t.bF)(b,{class:"float-right hidden","text-color":"faded"},{default:(0,t.k6)(function(){return[(0,t.eW)((0,a.v_)(e.objActual.length)+" "+(0,a.v_)(e.$t("intranet.contactos")),1)]}),_:1})]}),_:1})),e.objEnviar.length>0?((0,t.uX)(),(0,t.Wv)(p,{key:4,right:""},{default:(0,t.k6)(function(){return[(0,t.bF)(b,{class:"cursor-pointer",icon:"email",color:"primary",onClick:n[4]||(n[4]=function(n){return e.enviarMensaje(e.objEnviar)})})]}),_:1})):(0,t.Q3)("v-if",!0)]}),_:1})]}),_:1}),(0,t.bF)(v,{"inset-separator":""},{default:(0,t.k6)(function(){return[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.objActual,function(o,r){return(0,t.uX)(),(0,t.Wv)(h,{key:r},{default:(0,t.k6)(function(){return[e.verAcceso?((0,t.uX)(),(0,t.Wv)(p,{key:0},{default:(0,t.k6)(function(){return[(0,t.bF)(b,null,{default:(0,t.k6)(function(){return[(0,t.bF)(f,{modelValue:e.objEnviar,"onUpdate:modelValue":n[5]||(n[5]=function(n){return e.objEnviar=n}),val:o,color:"secondary",onInput:n[6]||(n[6]=function(n){return e.marcar(e.objEnviar)})},null,8,["modelValue","val"])]}),_:2},1024)]}),_:2},1024)):(0,t.Q3)("v-if",!0),(0,t.bF)(p,null,{default:(0,t.k6)(function(){return[(0,t.bF)(C,{usucod:o.USUCOD},null,8,["usucod"])]}),_:2},1024),(0,t.bF)(m,null,{default:(0,t.k6)(function(){return[(0,t.bF)(b,{label:""},{default:(0,t.k6)(function(){return[(0,t.eW)((0,a.v_)(o.NOMCOMP),1)]}),_:2},1024),(0,t.bF)(b,{sublabel:""},{default:(0,t.k6)(function(){return[(0,t.eW)((0,a.v_)(o.CURSONOM),1)]}),_:2},1024)]}),_:2},1024),e.objEnviar.length<1&&e.mensaje[o.tipo]?((0,t.uX)(),(0,t.Wv)(p,{key:1,right:""},{default:(0,t.k6)(function(){return[(0,t.bF)(b,{class:"cursor-pointer",icon:"email",color:"primary",onClick:function(n){return e.enviarMensaje(o,o.tipo)}},null,8,["onClick"])]}),_:2},1024)):(0,t.Q3)("v-if",!0)]}),_:2},1024)}),128))]}),_:1}),(0,t.bF)(g,{visible:e.visible},{default:(0,t.k6)(function(){return[(0,t.bF)(j,{size:"50px",color:"primary"})]}),_:1},8,["visible"])]}),_:1},8,["name"])}),128))]}),_:1},8,["modelValue"])],64))]}),_:1})}var u=o(63053),c=o.n(u),d=o(76080),f=o.n(d),b=o(45254),p=o.n(b),m=(o(30683),o(52133),o(10239),o(23513),o(50310),o(6724),o(70199),o(48426),o(83190),o(6123)),h=o(96122),v=o(80660),C=o(92173),j=o(80340),g=o(24974),k=o(26697),U=o(53093),O=o(53811),A=o(43346),S=o(33001),y=o(57668),_=o(99637),P=o(81288),T={components:{QInnerLoading:m.SQ,QSpinnerOval:m.VA,QCard:m.C$,QCardMedia:m.wy,QTabs:k.A,QTab:U.A,QTabPanels:O.A,QTabPanel:A.A,QSearch:m.Ks,QCheckbox:m.vZ,QChip:m.wQ,QScrollArea:h.A,sieEstudiantes:C.Ay,sieVacio:j.A,sieUsuario:g.A,QPage:m.Tu,QList:m.Mb,QItem:m.H0,QItemSide:m.n1,QItemTile:m.lp,QItemMain:m.mF},data:function(){return{tabs:[{name:"todos",label:"Todos"},{name:"companero",label:"Compañeros"},{name:"profesor",label:"Profesores"}],selectedTab:"todos",objCompaneros:[],objProfesores:[],vacio:!0,sininfo:!0,buscar:"",all:!1,disabled:!1,objEnviar:[],sieInfo:(0,y["default"])(),visible:!1,alucod:"",envioAlumno:!0,envioProfesor:!0,mensajeError:"mensajes.m0014","ocultaCompañeros":!1,ocultaProfes:!1,mensaje:{companero:!0,profesor:!0},verAcceso:(0,y["default"])().ruta.nivel>=2}},computed:{objActual:function(){var e=[];return"todos"===this.selectedTab&&(e=this.objCompaneros.concat(this.objProfesores)),"companero"===this.selectedTab&&(e=this.objCompaneros),"profesor"===this.selectedTab&&(e=this.objProfesores),""!==this.buscar?(this.disabled=!0,e=(0,S.filterArray)(this.buscar,{field:"NOMCOMP",list:e})):this.disabled=!1,e},isLess:function(){return(0,P.isLess)()}},methods:{getContactos:function(e){var n=this;return p()(f()().m(function o(){var t,a,r;return f()().w(function(o){while(1)switch(o.n){case 0:return n.objEnviar=[],n.vacio=!1,n.visible=!0,o.n=1,(0,P.isNuevoRegistro)();case 1:return t=o.v,o.n=2,v.$http.post("api/HyoAlumnos/retornaCompaneros",{alucod:e.ALUCOD});case 2:if(a=o.v,r=[],!t){o.n=4;break}return o.n=3,v.$http.post("api/HyoAsignaprs/obtListaProfesoresNR",{alucod:e.ALUCOD});case 3:r=o.v,o.n=6;break;case 4:return o.n=5,v.$http.post("api/HyoAsignaprs/retornaProfesores",{alucod:e.ALUCOD});case 5:r=o.v;case 6:n.objCompaneros=a.json.map(function(e){return Object.assign({tipo:"companero"},e)}),n.objProfesores=r.json.map(function(e){return Object.assign({tipo:"profesor"},e)}),n.visible=!1,n.mensajeError="I"===n.sieInfo.anoest?"El año escolar está en inicio":"mensajes.m0014";case 7:return o.a(2)}},o)}))()},seleccionarTodos:function(){"todos"===this.selectedTab&&(this.objEnviar=this.all?this.objCompaneros.concat(this.objProfesores):[]),"companero"===this.selectedTab&&(this.objEnviar=this.all?this.objCompaneros:[]),"profesor"===this.selectedTab&&(this.objEnviar=this.all?this.objProfesores:[])},marcar:function(e){"todos"===this.selectedTab&&(this.all=e.length===this.objCompaneros.concat(this.objProfesores).length),"companero"===this.selectedTab&&(this.all=e.length===this.objCompaneros.length),"profesor"===this.selectedTab&&(this.all=e.length===this.objProfesores.length)},selectTab:function(){this.all=!1,this.objEnviar=[]},enviarMensaje:function(e,n){var o=this,t=[];n||"object"!==c()(e)?("profesor"===n?t.push({USUCOD:e.USUCOD,USUNOM:e.USUNOM+"("+e.CURSONOM+")",CURSOCOD:e.CURSOCOD,ALUCODP:e.ALUCOD,checked:!0}):t.push({USUCOD:e.USUCOD,USUNOM:e.NOMCOMP,ALUCODP:e.ALUCOD,checked:!0}),this.$router.push({name:"intranet.mensajeria.redactar",params:{folder:1,type:3},query:{send:JSON.stringify(t)}})):(0,_["default"])(e,function(e){"profesor"===e.tipo?t.push({USUCOD:e.USUCOD,USUNOM:e.USUNOM+"("+e.CURSONOM+")",CURSOCOD:e.CURSOCOD,ALUCODP:e.ALUCOD,checked:!0}):t.push({USUCOD:e.USUCOD,USUNOM:e.NOMCOMP,ALUCODP:e.ALUCOD,checked:!0}),o.$router.push({name:"intranet.mensajeria.redactar",params:{folder:1,type:3},query:{send:JSON.stringify(t)}})})}},created:function(){var e=this;return p()(f()().m(function n(){var o,t,a,r,s,l,i;return f()().w(function(n){while(1)switch(n.n){case 0:return"005"===e.sieInfo.tipcod&&(o={ALUCOD:e.sieInfo.alucod},e.getContactos(o)),n.n=1,v.$http.get("api/ContactosController/getConfiguracion");case 1:t=n.v,a=t.tabCompaneros,r=t.tabProfesores,s=t.ocultarDocentes,l=t.ocultarEstudiantes,e.mensaje.companero=a,e.mensaje.profesor=r,e.ocultaCompañeros=l,e.ocultaProfes=s,e.mensajeError=e.envioAlumno||e.envioProfesor?"mensajes.m0014":"No puede enviar mensajes a alumnos ni a profesores",e.ocultaCompañeros&&(i=e.tabs,i=i.slice(2),e.tabs=i,e.selectedTab="profesor"),e.ocultaProfes&&(e.tabs.shift(),e.tabs.pop(),e.selectedTab="companero");case 2:return n.a(2)}},n)}))()},unmounted:function(){this.$store.unregisterModule("send")}},F=o(12807);const E=(0,F.A)(T,[["render",i]]);var D=E}}]);