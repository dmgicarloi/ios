"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[41348],{41348:function(e,r,n){n.r(r),n.d(r,{default:function(){return ie}});var o=n(61758),a=n(58790),t={class:"clase-curso q-pa-sm col column"},s={class:"row"},i={key:0,class:"col"},c={key:1,class:"col"},l={class:"row q-col-gutter-sm"},u={class:"q-pa-md"},d={class:"row q-col-gutter-sm"},g={class:"col-12"},p={class:"col-12"},m={class:"caption"},f={class:"col-12"},v={class:"absolute-full flex flex-center"},h={class:"q-pa-md"},b={class:"row q-col-gutter-sm"},C={class:"col-12"},O={class:"col-12"},k={class:"caption"},w={class:"col-12"},S={class:"absolute-full flex flex-center"};function A(e,r){var n=(0,o.g2)("header-btn"),A=(0,o.g2)("q-select"),E=(0,o.g2)("card-curso"),P=(0,o.g2)("q-intersection"),R=(0,o.g2)("q-scroll-area"),L=(0,o.g2)("sie-vacio"),D=(0,o.g2)("q-badge"),F=(0,o.g2)("q-linear-progress"),V=(0,o.g2)("q-btn"),U=(0,o.g2)("sie-modal"),I=(0,o.g2)("q-card-section"),N=(0,o.g2)("q-card");return(0,o.uX)(),(0,o.CE)("div",t,[(0,o.bF)(N,{class:"col column",dense:"",flat:"",bordered:""},{default:(0,o.k6)(function(){return[(0,o.bF)(n,{name:"Cursos",buttons:e.buttons},null,8,["buttons"]),(0,o.bF)(I,{class:"col column q-gutter-sm"},{default:(0,o.k6)(function(){return[(0,o.Lk)("div",s,[e.info.esOtros?((0,o.uX)(),(0,o.CE)("div",i,[(0,o.bF)(A,{modelValue:e.salon,"onUpdate:modelValue":r[0]||(r[0]=function(r){return e.salon=r}),options:e.salones,"option-value":"NEMO","option-label":"NEMODES",onInput:e.changeSalon,label:"Seleccionar salón"},null,8,["modelValue","options","onInput"])])):((0,o.uX)(),(0,o.CE)("div",c,[(0,o.bF)(A,{modelValue:e.alumno,"onUpdate:modelValue":r[1]||(r[1]=function(r){return e.alumno=r}),options:e.alumnos,"option-value":"ALUCOD","option-label":"NOMCOMP",onSelected:e.changeAlumno,label:"Seleccionar estudiante"},null,8,["modelValue","options","onSelected"])]))]),e.salon||e.esAlumno&&e.cursos.length?((0,o.uX)(),(0,o.Wv)(R,{key:0,class:"col"},{default:(0,o.k6)(function(){return[(0,o.Lk)("div",l,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.cursos,function(r,n){return(0,o.uX)(),(0,o.Wv)(P,{key:r.NEMO+r.CURSOCOD+r.GRUPOCOD+r.PROFCOD,class:"col-xs-12 col-sm-6 col-md-4 col-lg-3",once:""},{default:(0,o.k6)(function(){return[((0,o.uX)(),(0,o.Wv)(E,{bordered:"","control-asistencia":e.controlAsistencia,key:r.NEMO+r.CURSOCOD+r.GRUPOCOD+r.PROFCOD,title:r.CURSONOM,author:r.NOMCOMP,src:e.srcImagen(r.IMG),nemo:r.NEMO,cursocod:r.CURSOCOD,grupocod:r.GRUPOCOD,profcod:r.PROFCOD,description:r.DESCRIPCION,numero:r.NUMERO,enlace:r.ENLACE,editable:e.editable,editcover:e.editcover,onClick:function(n){return e.onCurso(r)},onSave:e.saveCurso},null,8,["control-asistencia","title","author","src","nemo","cursocod","grupocod","profcod","description","numero","enlace","editable","editcover","onClick","onSave"]))]}),_:2},1024)}),128))])]}),_:1})):((0,o.uX)(),(0,o.Wv)(L,{key:1,class:"col",icon:"desktop",title:"Clase",subtitle:e.msgSieVacio},null,8,["subtitle"])),(0,o.bF)(U,{class:"intranet--clase-2--curso--sie-modal--regularizar-contenidos",modelValue:e.ventanaRegularizarContenido,"onUpdate:modelValue":r[4]||(r[4]=function(r){return e.ventanaRegularizarContenido=r}),title:"Regularizar contenido",onSubmit:e.process,ok:"Continuar","btn-load":e.inProgress,"no-close":"","esc-click":""},{preButtonFooter:(0,o.k6)(function(){return[(0,o.bF)(V,{label:"Cerrar",onClick:r[3]||(r[3]=function(r){return e.ventanaRegularizarContenido=!1}),color:"negative",disable:e.inProgress},null,8,["disable"])]}),default:(0,o.k6)(function(){return[(0,o.Lk)("div",u,[(0,o.Lk)("div",d,[(0,o.Lk)("div",g,[(0,o.bF)(A,{modelValue:e.bimecod,"onUpdate:modelValue":r[2]||(r[2]=function(r){return e.bimecod=r}),options:e.periodos,label:"Seleccionar periodo"},null,8,["modelValue","options"])]),(0,o.Lk)("div",p,[(0,o.Lk)("div",m,(0,a.v_)(e.messageProgress),1)]),(0,o.Lk)("div",f,[(0,o.bF)(F,{size:"50px",value:e.progress,color:"secondary",rounded:"",stripe:""},{default:(0,o.k6)(function(){return[(0,o.Lk)("div",v,[(0,o.bF)(D,{color:"white","text-color":"primary",label:e.progressLabel},null,8,["label"])])]}),_:1},8,["value"])])])])]}),_:1},8,["modelValue","onSubmit","btn-load"]),(0,o.bF)(U,{class:"intranet--clase-2--curso--sie-modal--cerrar-entrega-actividades",modelValue:e.ventanaCierreEntregaTareas,"onUpdate:modelValue":r[7]||(r[7]=function(r){return e.ventanaCierreEntregaTareas=r}),title:"Cierre de entrega de Actividades",onSubmit:e.cierreEntregaTareas,ok:"Continuar","btn-load":e.inProgress,"no-close":"","esc-click":""},{preButtonFooter:(0,o.k6)(function(){return[(0,o.bF)(V,{label:"Cerrar",onClick:r[6]||(r[6]=function(r){return e.ventanaCierreEntregaTareas=!1}),color:"negative",disable:e.inProgress},null,8,["disable"])]}),default:(0,o.k6)(function(){return[(0,o.Lk)("div",h,[(0,o.Lk)("div",b,[(0,o.Lk)("div",C,[(0,o.bF)(A,{modelValue:e.bimecod,"onUpdate:modelValue":r[5]||(r[5]=function(r){return e.bimecod=r}),options:e.periodos,label:"Seleccionar periodo"},null,8,["modelValue","options"])]),(0,o.Lk)("div",O,[(0,o.Lk)("div",k,(0,a.v_)(e.messageProgress),1)]),(0,o.Lk)("div",w,[(0,o.bF)(F,{size:"50px",value:e.progress,color:"secondary",rounded:"",stripe:""},{default:(0,o.k6)(function(){return[(0,o.Lk)("div",S,[(0,o.bF)(D,{color:"white","text-color":"primary",label:e.progressLabel},null,8,["label"])])]}),_:1},8,["value"])])])])]}),_:1},8,["modelValue","onSubmit","btn-load"])]}),_:1})]}),_:1})])}var E=n(76080),P=n.n(E),R=n(45254),L=n.n(R),D=(n(30683),n(39866),n(52133),n(10239),n(56285),n(50310),n(6724),n(15547),n(2064),n(83190),n(6123)),F=n(88567),V=n(95718),U=n(12205),I=n(16648),N=n(9736),q=n(23540),M=n(80340),y=n(30640),_=n(63065),z=n(24982),$=(n(11777),n(52776),n(81813),n(93616)),T=n(78786);function B(){return $.A.__salon}function Q(e){$.A.__salon=e}$.A,I.S,Boolean,Boolean,Boolean,Boolean,Boolean,Boolean,Boolean;var G=n(24812),x=n(62565),X=n(34963),W=n(20456),H=n(41126),j=n(34262),K=n(81288),J=n(57668),Y=n(982),Z=n(8261),ee=n(80660),re=n(47180),ne="intranet.informes",oe="intranet.reportesInstrumento",ae={props:{nemo:String},components:{QCard:F.A,QCardSection:V.A,QScrollArea:U.A,QSpinnerDots:D.FS,QPageSticky:D._U,QIntersection:q.A,QSelect:I.S,QInput:N.A,sieVacio:M.A,SieModal:y.A,CardCurso:_.A,QCardActions:W.A,QBadge:x.A,QLinearProgress:X.A,QBar:H.A,QIcon:j.A,QBtn:D.Il},computed:{isGreater:function(){return(0,K.isGreater)("sm")},buttons:function(){var e=this,r=[];return this.hasreporte&&r.push({icon:"print",label:"Reportes de Instrumentos",click:function(){e.goReportes()}}),(0,K.isGreater)("sm")&&this.esAdministrador&&r.push({icon:"cog",label:"Regularizar contenidos",click:function(){e.openVentanaRegularizarContenidos()}}),(0,K.isGreater)("sm")&&this.cierraentregastareas&&r.push({icon:"alarm_off",label:"Cierre entrega actividades",click:function(){e.openVentanaCierreEntregaTareas()}}),r},progressLabel:function(){return"".concat((100*this.progress).toFixed(2)," %")}},data:function(){return{editable:!1,hasreporte:!1,hasinforme:!1,editcover:!1,cierraentregastareas:!1,info:(0,J["default"])(),salon:B(),salones:[],alumno:(0,G.$m)(),alumnos:[],cursos:[],alucod:null,esAlumno:["004","005"].includes((0,J["default"])().tipcod),esAdministrador:["SIE","SIEWEB"].includes((0,J["default"])().usucod),ventanaRegularizarContenido:!1,ventanaCierreEntregaTareas:!1,periodos:[],bimecod:null,controlAsistencia:"",msgSieVacio:"No hay información",inProgress:!1,progress:0,complete:!1,messageProgress:"Preparándose para iniciar el proceso..."}},created:function(){var e=this;return L()(P()().m(function r(){var n,o;return P()().w(function(r){while(1)switch(r.n){case 0:return r.n=1,e.$http.get("api/HyoControl/readControl",{params:{campo:"asis_auto"}});case 1:n=r.v,o=n.NUMERO,e.controlAsistencia=o,e.configOpcion(),e.info.esOtros?e.getSalones():e.getEstudiantes();case 2:return r.a(2)}},r)}))()},methods:{configOpcion:function(){var e=this;return L()(P()().m(function r(){var n,o,a,t,s,i;return P()().w(function(r){while(1)switch(r.n){case 0:return r.n=1,e.$http.get("api/HyoCursos/configOpcion");case 1:n=r.v,o=n.editable,a=n.hasinforme,t=n.hasreporte,s=n.editcover,i=n.cierraentregastareas,e.editable=o,e.hasreporte=t,e.hasinforme=a,e.editcover=s,e.cierraentregastareas=i;case 2:return r.a(2)}},r)}))()},getSalones:function(){var e=this;return L()(P()().m(function r(){var n;return P()().w(function(r){while(1)switch(r.n){case 0:return r.n=1,e.$http.get("api/HyoSalones/getAll");case 1:n=r.v,n.length>1&&n.unshift({NEMO:"all",NEMODES:"Todos"}),e.salones=Object.freeze(n);case 2:return r.a(2)}},r)}))()},getEstudiantes:function(){var e=this;return L()(P()().m(function r(){var n,o,a;return P()().w(function(r){while(1)switch(r.n){case 0:return r.n=1,e.$http.get("api/Alumno/getEstudiantes");case 1:n=r.v,o=n.estudiantes,e.alumnos=Object.freeze((0,Z["default"])(o,"ALUCOD")),e.alumnos.length>0&&(a=e.alumnos[0],e.alumno=a.ALUCOD,e.alucod=a.ALUCOD,e.changeAlumno(a));case 2:return r.a(2)}},r)}))()},getCursos:function(e){var r=this;return L()(P()().m(function n(){var o,a,t;return P()().w(function(n){while(1)switch(n.p=n.n){case 0:if(void 0!==e){n.n=1;break}return n.a(2,!1);case 1:return"all"===e&&(e=null),o={nemo:e},n.p=2,n.n=3,r.$http.get("api/HyoAsignaprs/getCursosClase",{params:o});case 3:a=n.v,n.n=5;break;case 4:n.p=4,t=n.v,t&&t.error&&t.error.message&&"SieError"===t.error.name&&(r.msgSieVacio=t.error.message),a=[];case 5:return n.a(2,Object.freeze(a))}},n,null,[[2,4]])}))()},changeSalon:function(e){var r=this;return L()(P()().m(function n(){return P()().w(function(n){while(1)switch(n.n){case 0:return Q(e),n.n=1,r.getCursos(e);case 1:r.cursos=n.v;case 2:return n.a(2)}},n)}))()},changeAlumno:function(e){var r=this;return L()(P()().m(function n(){return P()().w(function(n){while(1)switch(n.n){case 0:return r.alucod=e.ALUCOD,(0,G.hl)(e.ALUCOD),r.salon=e.NEMO,n.n=1,r.getCursos(e.NEMO);case 1:r.cursos=n.v;case 2:return n.a(2)}},n)}))()},onCurso:function(e){var r={nemo:e.NEMO,cursocod:e.CURSOCOD,grupocod:e.GRUPOCOD||"001"};this.esAlumno&&(r.alucod=this.alucod||this.info.alucod),this.$router.push({name:"intranet.clase2.contenido",params:r})},goInformes:function(){this.$router.push({name:ne,query:{nemo:this.nemo}})},goReportes:function(){this.$router.push({name:oe,query:{nemo:this.nemo}})},saveCurso:function(e){return L()(P()().m(function r(){return P()().w(function(r){while(1)switch(r.n){case 0:e.$el.querySelector("img")&&e.$el.querySelector("img").setAttribute("src","".concat(e.info.imagen,"&irnd=").concat(Date.now()));case 1:return r.a(2)}},r)}))()},getPeriodos:function(){var e=this;return L()(P()().m(function r(){var n;return P()().w(function(r){while(1)switch(r.n){case 0:return r.n=1,e.$http.post("api/contenido/getPeriodos");case 1:n=r.v,e.periodos=n.map(function(e){return{value:e.BIMECOD,label:e.PERIODO}});case 2:return r.a(2)}},r)}))()},openVentanaRegularizarContenidos:function(){var e=this;return L()(P()().m(function r(){return P()().w(function(r){while(1)switch(r.n){case 0:return r.n=1,e.getPeriodos();case 1:e.progress=0,e.complete=!1,e.messageProgress="Aquí verá el progreso del proceso.",e.ventanaRegularizarContenido=!0;case 2:return r.a(2)}},r)}))()},openVentanaCierreEntregaTareas:function(){var e=this;return L()(P()().m(function r(){return P()().w(function(r){while(1)switch(r.n){case 0:return r.n=1,e.getPeriodos();case 1:e.progress=0,e.complete=!1,e.messageProgress="Aquí verá el progreso del proceso.",e.ventanaCierreEntregaTareas=!0;case 2:return r.a(2)}},r)}))()},process:function(){var e=this;return L()(P()().m(function r(){var n,o,a,t,s,i;return P()().w(function(r){while(1)switch(r.p=r.n){case 0:if(null!==e.bimecod){r.n=1;break}return(0,Y["default"])("Seleccione el periodo que desea regularizar","warning"),r.a(2);case 1:return e.progress=0,e.complete=!1,e.messageProgress="Preparándose para iniciar el proceso...",r.p=2,e.inProgress=!0,r.n=3,(0,ee.streamFetch)("api/contenido/regularizarData",{method:"POST",data:{bimecod:e.bimecod}},function(r){if(r&&"preparing"in r&&(e.messageProgress="Preparando la información: Paso ".concat(r.preparing.step," de 9")),r&&"error"in r){var n=r.error;e.$alert(n.message,"info"),e.complete=!0}if(r&&"progress"in r){e.messageProgress="Regularizando contenidos...";var o=r.progress;e.progress=o.progress/o.total}});case 3:n=r.v,o=n.length,o&&(a=n[o-2],t=n[o-1],a&&"progress"in a&&(s=a.progress,e.progress=s.progress/s.total),t&&"final"in t&&(e.complete=!0,e.messageProgress="Proceso completado",e.progress=1)),r.n=5;break;case 4:r.p=4,i=r.v,i.error&&(0,Y["default"])(i.error.message,"warning");case 5:e.inProgress=!1;case 6:return r.a(2)}},r,null,[[2,4]])}))()},srcImagen:function(e){return(0,z.Lb)(this.info.api,this.info.token,e)},cierreEntregaTareas:function(){var e=this;return L()(P()().m(function r(){var n,o,a,t,s,i,c;return P()().w(function(r){while(1)switch(r.p=r.n){case 0:if(e.progress=0,e.complete=!1,null!==e.bimecod){r.n=1;break}return e.$alert("Debe seleccionar un periodo antes de cerrar la entrega de actividades.","warning"),r.a(2);case 1:return r.p=1,r.n=2,e.$confirmar(re["default"].CONTENIDOS.CIERRE_ENTREGA_TAREAS.MSG_CONFIRMACION(e.info.colcod),"warning",!0);case 2:if(n=r.v,n){r.n=3;break}return r.a(2);case 3:return e.inProgress=!0,r.n=4,(0,ee.streamFetch)("api/contenido/cierreEntregaTareas",{method:"POST",data:{bimecod:e.bimecod}},function(r){if(r&&"error"in r){var n=r.error;e.$alert(n.message,"info"),e.complete=!0}if(r&&"progress"in r){e.messageProgress="Cerrando la entrega de tareas del periodo ".concat(e.bimecod,"...");var o=r.progress;e.progress=o.progress/o.total}});case 4:o=r.v,a=o.length,a&&(t=o[a-2],s=o[a-1],t&&"progress"in t&&(i=t.progress,e.progress=i.progress/i.total),s&&"final"in s&&(e.complete=!0,e.messageProgress="Proceso completado",e.progress=1)),r.n=6;break;case 5:r.p=5,c=r.v,e.$alert(c.error.message,"warning");case 6:e.inProgress=!1;case 7:return r.a(2)}},r,null,[[1,5]])}))()}},watch:{nemo:{immediate:!0,handler:function(e){var r=this;return L()(P()().m(function n(){return P()().w(function(n){while(1)switch(n.n){case 0:return e&&(r.salon=e),n.n=1,r.getCursos(r.salon);case 1:r.cursos=n.v;case 2:return n.a(2)}},n)}))()}}}},te=n(12807);const se=(0,te.A)(ae,[["render",A]]);var ie=se}}]);