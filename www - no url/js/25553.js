"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[25553],{25553:function(e,n,r){r.r(n),r.d(n,{default:function(){return R}});var a=r(61758),t={class:"row"},c={class:"col-xs-12"},o={class:"row q-pa-sm q-col-gutter-sm"},i={class:"col-xs-12"},l={class:"col-xs-12"},s={class:"col-xs-12"},u={class:"col-xs-12"};function m(e,n){var r=this,m=(0,a.g2)("header-btn"),f=(0,a.g2)("sie-table"),d=(0,a.g2)("q-card-section"),A=(0,a.g2)("q-card"),p=(0,a.g2)("q-select"),w=(0,a.g2)("q-checkbox"),I=(0,a.g2)("q-input"),C=(0,a.g2)("q-form"),g=(0,a.g2)("sie-modal"),h=(0,a.g2)("q-page");return(0,a.uX)(),(0,a.Wv)(h,{class:"q-pa-sm sie-flat"},{default:(0,a.k6)(function(){return[(0,a.bF)(A,{flat:"",bordered:""},{default:(0,a.k6)(function(){return[(0,a.bF)(m,{name:"Mantenimiento Almacen",buttons:e.buttons},null,8,["buttons"]),(0,a.bF)(d,null,{default:(0,a.k6)(function(){return[(0,a.Lk)("div",t,[(0,a.Lk)("div",c,[(0,a.bF)(f,{type:"normal",data:e.rows,columns:e.fields,config:e.config,selection:"single","save-cells":"",ref:"tableAlmacen",onRowSelected:e.rowSelectAlmacen,css:"height:calc(100vh - 140px)",context:r},null,8,["data","columns","config","onRowSelected"])])])]}),_:1})]}),_:1}),(0,a.bF)(g,{esc:"","esc-click":"",modelValue:e.openAdd,"onUpdate:modelValue":n[4]||(n[4]=function(n){return e.openAdd=n}),css:{width:"500px"},title:"create"===e.action?"Agregar Almacén":"Modificar Almacén",onSubmit:e.saveAcccion},{default:(0,a.k6)(function(){return[(0,a.bF)(C,{ref:"refForm"},{default:(0,a.k6)(function(){return[(0,a.Lk)("div",o,[(0,a.Lk)("div",i,[(0,a.bF)(p,{modelValue:e.empresacodigo,"onUpdate:modelValue":n[0]||(n[0]=function(n){return e.empresacodigo=n}),label:"Empresa *",options:e.empresas,"emit-value":"","option-label":"RAZONSOCIAL","option-value":"EMPCOD",rules:[e.required],onInput:e.cambiarEmpresa},null,8,["modelValue","options","rules","onInput"])]),(0,a.Lk)("div",l,[(0,a.bF)(p,{modelValue:e.form.ID_LOCAL,"onUpdate:modelValue":n[1]||(n[1]=function(n){return e.form.ID_LOCAL=n}),label:"Local *",options:e.sedes,"emit-value":"","option-label":"NOMBRE","option-value":"ID_LOCAL",rules:[e.required]},null,8,["modelValue","options","rules"])]),(0,a.Lk)("div",s,[(0,a.bF)(w,{modelValue:e.form.PRINCIPAL,"onUpdate:modelValue":n[2]||(n[2]=function(n){return e.form.PRINCIPAL=n}),"true-value":1,"false-value":0,label:"Principal"},null,8,["modelValue"])]),(0,a.Lk)("div",u,[(0,a.bF)(I,{type:"textarea",counter:"",modelValue:e.form.DESCRIPCION,"onUpdate:modelValue":n[3]||(n[3]=function(n){return e.form.DESCRIPCION=n}),label:"Descripción *",rules:[e.required]},null,8,["modelValue","rules"])])])]}),_:1},512)]}),_:1},8,["modelValue","title","onSubmit"])]}),_:1})}var f=r(76080),d=r.n(f),A=r(45254),p=r.n(A),w=(r(89571),r(6123)),I={data:function(){return{config:{ACTION:{component:"button",icon:["edit as editar","delete as eliminar"],editar:function(e,n){var r=this;return p()(d()().m(function e(){return d()().w(function(e){while(1)switch(e.n){case 0:return r.rowAlmacen=n,e.n=1,r.openActualizar();case 1:return e.a(2)}},e)}))()},eliminar:function(e,n){var r=this;return p()(d()().m(function e(){return d()().w(function(e){while(1)switch(e.n){case 0:return r.rowAlmacen=n,e.n=1,r.deleteAlmacen();case 1:return e.a(2)}},e)}))()},tooltip:{editar:"Editar",eliminar:"Eliminar"},permisos:{editar:">1",eliminar:"===3"},flat:!0,dense:!0},PRINCIPAL:{renderHtml:function(e,n,r){return r.checkbox({trueValue:1,value:e.PRINCIPAL})}}},rows:[],fields:[{name:"IDALMACEN",label:"Código",field:"IDALMACEN",align:"center",sortable:!0},{name:"DESCRIPCION",label:"Almacén",field:"DESCRIPCION",align:"left",sortable:!0},{name:"PRINCIPAL",label:"Principal",field:"PRINCIPAL",align:"center",sortable:!0},{name:"ACTION",label:"Acción",field:"ACTION",align:"center",width:"80"}]}}},C=r(39893),g=r(81288),h=r(2739),v=r(9736),b=r(16648),L=r(88567),P=r(95718),N=r(43136),E=r(3112),k={mixins:[I,N.initialConfig],components:{QForm:h.A,QInput:v.A,QSelect:b.A,QCard:L.A,QCardSection:P.A,QCheckbox:E.A,QPage:w.Tu},data:function(){return{required:C.require,buttons:[{label:"Agregar",icon:"plus",click:this.openAgregar}],openAdd:!1,action:"create",rowAlmacen:null,empresacodigo:null,empresas:[],sedes:[],form:{ID_LOCAL:null,PRINCIPAL:0,DESCRIPCION:null}}},methods:{cambiarEmpresa:function(e){var n=this;return p()(d()().m(function r(){return d()().w(function(r){while(1)switch(r.n){case 0:return n.form.ID_LOCAL=null,r.n=1,n.readSede(e);case 1:return r.a(2)}},r)}))()},openAgregar:function(){var e=this;return p()(d()().m(function n(){return d()().w(function(n){while(1)switch(n.n){case 0:return e.action="create",e.rowAlmacen=null,(0,g.clear)(e.form),e.empresacodigo=null,e.form.PRINCIPAL=0,e.openAdd=!0,n.n=1,e.readCEmpresa();case 1:return n.a(2)}},n)}))()},openActualizar:function(){var e=this;return p()(d()().m(function n(){return d()().w(function(n){while(1)switch(n.n){case 0:if(e.rowAlmacen){n.n=1;break}e.$notify("Selecciona un registro","info"),n.n=4;break;case 1:return n.n=2,e.readCEmpresa();case 2:return n.n=3,e.readSede(e.rowAlmacen.EMPCOD);case 3:e.action="update",e.empresacodigo=e.rowAlmacen.EMPCOD,e.form.ID_LOCAL=e.rowAlmacen.ID_LOCAL,e.form.PRINCIPAL=e.rowAlmacen.PRINCIPAL,e.form.DESCRIPCION=e.rowAlmacen.DESCRIPCION,e.openAdd=!0;case 4:return n.a(2)}},n)}))()},saveAcccion:function(){var e=this;return p()(d()().m(function n(){var r,a,t;return d()().w(function(n){while(1)switch(n.n){case 0:return n.n=1,e.$refs.refForm.validate();case 1:if(r=n.v,r){n.n=2;break}return n.a(2);case 2:if("create"!==e.action){n.n=4;break}return n.n=3,e.$confirmar("El registro se creará ¿Desea continuar?","info");case 3:a=n.v,a&&e.createAlmacen(),n.n=6;break;case 4:return n.n=5,e.$confirmar("El registro se modificará ¿Desea continuar?","info");case 5:t=n.v,t&&e.updateAlmacen();case 6:return n.a(2)}},n)}))()},rowSelectAlmacen:function(e,n){this.rowAlmacen=n},createAlmacen:function(){var e=this;return p()(d()().m(function n(){var r,a,t,c,o;return d()().w(function(n){while(1)switch(n.p=n.n){case 0:return n.p=0,n.n=1,e.$http.post("api/HyoAlmacenes/createAlmacen",{data:e.form});case 1:r=n.v,a=r.result,t=r.message,c={IDALMACEN:a.IDALMACEN,ID_LOCAL:e.form.ID_LOCAL,PRINCIPAL:e.form.PRINCIPAL,DESCRIPCION:e.form.DESCRIPCION},e.rows.unshift(c),e.openAdd=!1,e.$notify(t,"success"),n.n=3;break;case 2:n.p=2,o=n.v,e.$notify(o.message,"warning");case 3:return n.a(2)}},n,null,[[0,2]])}))()},readCEmpresa:function(){var e=this;return p()(d()().m(function n(){var r,a;return d()().w(function(n){while(1)switch(n.p=n.n){case 0:return n.p=0,n.n=1,e.$http.get("api/HyoEmpresas/getAllEmpresa",{params:{fields:["EMPCOD","RAZONSOCIAL"]}});case 1:r=n.v,e.empresas=r,n.n=3;break;case 2:n.p=2,a=n.v,e.$notify(a.message,"warning");case 3:return n.a(2)}},n,null,[[0,2]])}))()},readSede:function(e){var n=this;return p()(d()().m(function r(){var a,t;return d()().w(function(r){while(1)switch(r.p=r.n){case 0:return r.p=0,r.n=1,n.$http.get("api/HyoSedes/getSedesByEmpresa",{params:{empcod:e,fields:["ID_LOCAL","NOMBRE"]}});case 1:a=r.v,n.sedes=a,r.n=3;break;case 2:r.p=2,t=r.v,n.$notify(t.message,"warning");case 3:return r.a(2)}},r,null,[[0,2]])}))()},readAlmacen:function(){var e=this;return p()(d()().m(function n(){var r,a;return d()().w(function(n){while(1)switch(n.p=n.n){case 0:return n.p=0,n.n=1,e.$http.get("api/HyoAlmacenes/getAlmacenesBySede",{params:{id_local:e.id_local}});case 1:r=n.v,e.rows=r,n.n=3;break;case 2:n.p=2,a=n.v,e.$notify(a.message,"warning");case 3:return n.a(2)}},n,null,[[0,2]])}))()},deleteAlmacen:function(){var e=this;return p()(d()().m(function n(){var r,a,t,c;return d()().w(function(n){while(1)switch(n.p=n.n){case 0:if(e.rowAlmacen){n.n=1;break}e.$notify("Selecciona un registro","info"),n.n=6;break;case 1:return n.n=2,e.$confirmar("¿Estás seguro de eliminar el registro?","delete");case 2:if(r=n.v,!r){n.n=6;break}return n.p=3,n.n=4,e.$http.delete("api/HyoAlmacenes/deleteAlmacen",{params:{idalmacen:e.rowAlmacen.IDALMACEN}});case 4:a=n.v,t=a.message,e.rows.splice(e.rows.indexOf(e.rowAlmacen),1),e.rowAlmacen=null,e.$notify(t,"success"),n.n=6;break;case 5:n.p=5,c=n.v,e.$notify(c.message,"warning");case 6:return n.a(2)}},n,null,[[3,5]])}))()},updateAlmacen:function(){var e=this;return p()(d()().m(function n(){var r,a,t,c;return d()().w(function(n){while(1)switch(n.p=n.n){case 0:return n.p=0,r=e.$refs.tableAlmacen,n.n=1,e.$http.put("api/HyoAlmacenes/updateAlmacen",{idalmacen:e.rowAlmacen.IDALMACEN,data:{PRINCIPAL:e.form.PRINCIPAL,DESCRIPCION:e.form.DESCRIPCION}});case 1:a=n.v,t=a.message,e.openAdd=!1,r.updateRow(e.rowAlmacen,e.form),e.$notify(t,"success"),n.n=3;break;case 2:n.p=2,c=n.v,e.$notify(c.message,"warning");case 3:return n.a(2)}},n,null,[[0,2]])}))()}},created:function(){var e=this;return p()(d()().m(function n(){return d()().w(function(n){while(1)switch(n.n){case 0:try{e.readAlmacen()}catch(n){e.$notify(n.message,"warning")}case 1:return n.a(2)}},n)}))()}},O=r(12807);const D=(0,O.A)(k,[["render",m]]);var R=D}}]);