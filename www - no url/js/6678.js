"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[6678],{6678:function(e,a,n){n.r(a),n.d(a,{default:function(){return E}});var o=n(61758),i={class:"row q-col-gutter-sm"},t={class:"col-xs-12 col-sm-4"},l={class:"col-xs-12 col-sm-8"},r={class:"col-xs-12 col-sm-4"},u={class:"col-xs-12 col-sm-8"},s={class:"row q-pa-sm q-col-gutter-sm"},c={class:"col-xs-12 sie-flat"};function d(e,a){var n=this,d=(0,o.g2)("header-btn"),m=(0,o.g2)("q-input"),f=(0,o.g2)("q-form"),g=(0,o.g2)("q-card-section"),h=(0,o.g2)("q-card"),v=(0,o.g2)("sie-table"),F=(0,o.g2)("sie-modal"),p=(0,o.g2)("q-page");return(0,o.uX)(),(0,o.Wv)(p,{class:"cambio-codigo-familia q-pa-sm"},{default:(0,o.k6)(function(){return[(0,o.bF)(h,null,{default:(0,o.k6)(function(){return[(0,o.bF)(d,{name:"Modificar Código de Familia",buttons:e.buttons},null,8,["buttons"]),(0,o.bF)(g,{style:{height:"calc(100vh - 115px)"}},{default:(0,o.k6)(function(){return[(0,o.bF)(f,{ref:"refForm"},{default:(0,o.k6)(function(){return[(0,o.Lk)("div",i,[(0,o.Lk)("div",t,[(0,o.bF)(m,{modelValue:e.codigo,"onUpdate:modelValue":a[0]||(a[0]=function(a){return e.codigo=a}),"float-label":"Código de familia",label:"Código de familia",rules:[e.campoRequerido],debounce:"500",onInput:e.buscarFamilia},null,8,["modelValue","rules","onInput"])]),(0,o.Lk)("div",l,[(0,o.bF)(m,{modelValue:e.famdes,"onUpdate:modelValue":a[1]||(a[1]=function(a){return e.famdes=a}),readonly:!0},null,8,["modelValue"])]),(0,o.Lk)("div",r,[(0,o.bF)(m,{modelValue:e.nuevoCodigo,"onUpdate:modelValue":a[2]||(a[2]=function(a){return e.nuevoCodigo=a}),"float-label":"Nuevo código de familia",label:"Nuevo código de familia",maxlength:"8",rules:[e.alphanumericRule],debounce:"500",onInput:e.validarNuevoCodigo},null,8,["modelValue","rules","onInput"])]),(0,o.Lk)("div",u,[(0,o.bF)(m,{modelValue:e.famdesNuevo,"onUpdate:modelValue":a[3]||(a[3]=function(a){return e.famdesNuevo=a}),"float-label":"Familia",readonly:!0},null,8,["modelValue"])])])]}),_:1},512)]}),_:1})]}),_:1}),(0,o.bF)(F,{class:"modal-familia-filtro",modelValue:e.openModal,"onUpdate:modelValue":a[4]||(a[4]=function(a){return e.openModal=a}),title:"Buscar Familias"},{default:(0,o.k6)(function(){return[(0,o.Lk)("div",s,[(0,o.Lk)("div",c,[(0,o.bF)(v,{selection:"single",context:n,css:"height: 400px",search:"Buscar Familia",columns:e.columns,onRowSelected:e.rowSelected,data:e.rowsFamilias,config:e.config},null,8,["columns","onRowSelected","data","config"])])])]}),_:1},8,["modelValue"])]}),_:1})}var m=n(99550),f=n.n(m),g=n(76080),h=n.n(g),v=n(45254),F=n.n(v),p=(n(71225),n(50310),n(5962),n(83190),n(52776),n(84433),n(44264),n(6123)),b=n(88567),w=n(95718),C=n(9736),k=n(2739),A={data:function(){return{config:{},rowsFamilias:[],columns:[{name:"FAMCOD",label:"Código",field:"FAMCOD",align:"center"},{name:"FAMDES",label:"Apellidos y Nombres",field:"FAMDES",align:"left"}]}}},M=n(30640),V=n(982),D=n(80660),S={cambiarCodigo:function(e,a){return D.$http.post("api/FamiliaController/cambiarCodigoFamilia",{famcod:e,newfamcod:a})}},q={mixins:[A],components:{QCard:b.A,QCardSection:w.A,QInput:C.A,QForm:k.A,config:A,sieModal:M.A,QPage:p.Tu},data:function(){return{codigo:null,nuevoCodigo:null,famdes:null,famdesNuevo:null,dataSinMatricula:[],rowsFamilias:[],openModal:!1,buttons:[{icon:"search",label:"Buscar",click:this.buscar},{icon:"cogs",label:"Procesar",click:this.procesar}]}},methods:{buscar:function(){var e=this;return F()(h()().m(function a(){return h()().w(function(a){while(1)switch(a.n){case 0:e.openModal=!0;case 1:return a.a(2)}},a)}))()},campoRequerido:function(e){return!!e||"Campo requerido"},rowSelected:function(e){this.codigo=e.FAMCOD,this.famdes=e.FAMDES,this.openModal=!1},procesar:function(){var e=this;return F()(h()().m(function a(){var n;return h()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,e.$refs.refForm.validate();case 1:if(n=a.v,n){a.n=2;break}return a.a(2);case 2:if(!e.famdesNuevo){a.n=3;break}return(0,V["default"])("El nuevo código ingresado ya se encuentra registrado","warning"),a.a(2,!1);case 3:S.cambiarCodigo(e.codigo,e.nuevoCodigo).then(function(){var a=F()(h()().m(function a(n){return h()().w(function(a){while(1)switch(a.n){case 0:return(0,V["default"])("Proceso terminado","success"),a.n=1,e.getDatosFamilia();case 1:e.rowsFamilias=a.v,e.limpiar();case 2:return a.a(2)}},a)}));return function(e){return a.apply(this,arguments)}}()).catch(function(e){(0,V["default"])(e.message||"Ocurrió un problema","warning")});case 4:return a.a(2)}},a)}))()},limpiar:function(){this.codigo=null,this.nuevoCodigo=null,this.famdes=null,this.famdesNuevo=null,this.$refs.refForm.reset()},getDatosFamilia:function(){var e=this;return F()(h()().m(function a(){var n;return h()().w(function(a){while(1)switch(a.n){case 0:return n={},n.columnas=["FAMCOD","FAMDES"],n.order={sidx:"famdes",sord:"asc"},a.a(2,e.$http.get("api/FamiliaController/getDatosFamilia",{params:{parametros:n}}))}},a)}))()},encontrarFamilia:function(e){var a=this.rowsFamilias.filter(function(a){return a.FAMCOD===e}),n=f()(a,1),o=n[0];return o?o.FAMDES:null},buscarFamilia:function(){this.famdes=this.encontrarFamilia(this.codigo)},alphanumericRule:function(e){return!!(!e||/^[a-zA-Z0-9]*$/.test(e)||e.toString().length<=3||e.toString().length>=9)||"El código debe ser alfanumérico entre 4 a 8 dígitos"},validarNuevoCodigo:function(){this.famdesNuevo=this.encontrarFamilia(this.nuevoCodigo),this.famdesNuevo&&(0,V["default"])("El nuevo código ingresado ya se encuentra registrado","warning")}},created:function(){var e=this;return F()(h()().m(function a(){return h()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,e.getDatosFamilia();case 1:e.rowsFamilias=a.v;case 2:return a.a(2)}},a)}))()}},N=n(12807);const x=(0,N.A)(q,[["render",d]]);var E=x}}]);