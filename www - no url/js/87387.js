"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[87387],{87387:function(e,n,o){o.r(n),o.d(n,{default:function(){return J}});var a=o(61758),t=o(29104),i={class:"medico-salida q-pa-sm"},r={class:"row q-col-gutter-sm"},c={class:"col-md-6 col-xs-12"},l={class:"col-md-2 col-xs-4"},d={class:"col-md-2 col-xs-4"},s={class:"col-md-2 col-xs-4"},u={class:"col-md-6 col-xs-12"},m={class:"col-md-2 col-xs-4"},f={class:"col-md-4 col-xs-8"},p={class:"q-mt-sm"},D={class:"q-pa-sm"},h={class:"row q-col-gutter-sm"},M={class:"col-md-4 col-xs-12"},v={class:"col-md-2 col-xs-12"},b={class:"col-md-6 col"},g={class:"row q-gutter-sm"},w={class:"col"},C={class:"row q-mt-sm"},E={class:"col-12"};function k(e,n){var o=this,k=(0,a.g2)("header-btn"),O=(0,a.g2)("q-input"),S=(0,a.g2)("q-select"),F=(0,a.g2)("sie-table"),A=(0,a.g2)("q-card-section"),R=(0,a.g2)("q-card"),V=(0,a.g2)("q-btn"),I=(0,a.g2)("sie-modal"),U=(0,a.g2)("q-page");return(0,a.uX)(),(0,a.Wv)(U,null,{default:(0,a.k6)(function(){return[(0,a.Lk)("div",i,[(0,a.bF)(R,{dense:"",flat:"",bordered:""},{default:(0,a.k6)(function(){return[(0,a.bF)(k,{name:"Salida de Medicamentos",buttons:e.buttons},null,8,["buttons"]),(0,a.bF)(A,null,{default:(0,a.k6)(function(){return[(0,a.Lk)("div",r,[(0,a.Lk)("div",c,[(0,a.bF)(O,{modelValue:e.form.usuario,"onUpdate:modelValue":n[0]||(n[0]=function(n){return e.form.usuario=n}),label:"Usuario",disable:""},null,8,["modelValue"])]),(0,a.Lk)("div",l,[(0,a.bF)(O,{modelValue:e.form.nromov,"onUpdate:modelValue":n[1]||(n[1]=function(n){return e.form.nromov=n}),label:"Num movimiento",disable:""},null,8,["modelValue"])]),(0,a.Lk)("div",d,[(0,a.bF)(O,{modelValue:e.form.fecmov,"onUpdate:modelValue":n[2]||(n[2]=function(n){return e.form.fecmov=n}),label:"Fecha",disable:""},null,8,["modelValue"])]),(0,a.Lk)("div",s,[(0,a.bF)(O,{modelValue:e.form.anomov,"onUpdate:modelValue":n[3]||(n[3]=function(n){return e.form.anomov=n}),label:"Año",disable:""},null,8,["modelValue"])]),(0,a.Lk)("div",u,[(0,a.bF)(S,{modelValue:e.form.documento,"onUpdate:modelValue":n[4]||(n[4]=function(n){return e.form.documento=n}),options:e.documentos,label:e.$t("documento")},null,8,["modelValue","options","label"])]),(0,a.Lk)("div",m,[(0,a.bF)(O,{modelValue:e.form.nroserie,"onUpdate:modelValue":n[5]||(n[5]=function(n){return e.form.nroserie=n}),label:"N° Serie",maxlength:"4",mask:"####"},null,8,["modelValue"])]),(0,a.Lk)("div",f,[(0,a.bF)(O,{modelValue:e.form.nrodocumento,"onUpdate:modelValue":n[6]||(n[6]=function(n){return e.form.nrodocumento=n}),label:"N° Documento",maxlength:"15",mask:"###############"},null,8,["modelValue"])])]),(0,a.Lk)("div",p,[(0,a.bF)(F,{class:"sie-table_alto",data:e.rows,columns:e.fields,config:e.config,context:o,dense:"",flat:"",bordered:"","wrap-cells":"",onRowSelected:e.rowSelectDetalle},null,8,["data","columns","config","onRowSelected"])])]}),_:1})]}),_:1})]),(0,a.bF)(I,{title:e.title,modelValue:e.openModalAgregar,"onUpdate:modelValue":n[10]||(n[10]=function(n){return e.openModalAgregar=n}),footer:!1},{default:(0,a.k6)(function(){return[(0,a.Lk)("div",D,[(0,a.Lk)("div",h,[(0,a.Lk)("div",M,[(0,a.bF)(O,{modelValue:e.formMedicina.codigo,"onUpdate:modelValue":n[7]||(n[7]=function(n){return e.formMedicina.codigo=n}),label:"Código",disable:""},null,8,["modelValue"])]),(0,a.Lk)("div",v,[(0,a.bF)(O,{modelValue:e.formMedicina.cantidad,"onUpdate:modelValue":n[8]||(n[8]=function(n){return e.formMedicina.cantidad=n}),label:"Cantidad",onKeypress:(0,t.jR)(e.addMedicina,["enter"])},null,8,["modelValue","onKeypress"])]),(0,a.Lk)("div",b,[(0,a.Lk)("div",g,[(0,a.Lk)("div",w,[(0,a.bF)(O,{modelValue:e.formMedicina.descripcion,"onUpdate:modelValue":n[9]||(n[9]=function(n){return e.formMedicina.descripcion=n}),label:"Descripcion",disable:""},null,8,["modelValue"])]),(0,a.bF)(V,{color:"primary",size:"sm",icon:"check",onClick:e.addMedicina},null,8,["onClick"])])])]),(0,a.Lk)("div",C,[(0,a.Lk)("div",E,[((0,a.uX)(),(0,a.Wv)(F,{dense:"",flat:"",bordered:"","wrap-cells":"",key:e.key,data:e.rowsMedicina,columns:e.fieldsMedicina,config:e.configMedicina,context:o,css:{height:"58vh"},selection:"single",onRowSelected:e.rowSelect},null,8,["data","columns","config","onRowSelected"]))])])])]}),_:1},8,["title","modelValue"])]}),_:1})}var O=o(76080),S=o.n(O),F=o(45254),A=o.n(F),R=(o(71225),o(52133),o(10239),o(89571),o(50310),o(5962),o(6724),o(83190),o(88567)),V=o(95718),I=o(9736),U=o(16648),N=o(18105),T={data:function(){return{config:{FECMOV:{component:"date",edit:!1},DOCREF:{multiRender:[{renderHtml:function(e,n,o){var a="";return"001"===e.DOCREF?a="Boleta":"002"===e.DOCREF?a="Factura":"003"===e.DOCREF?a="Guia":"004"===e.DOCREF?a="Inventario Inicial":"005"===e.DOCREF?a="Regularizar Stock":"006"===e.DOCREF?a="Donaciones":"007"===e.DOCREF?a="Medicamento vencido":"008"===e.DOCREF&&(a="Reprocesar stock Medicamentos"),n("span",{},a)}}]},ACTIVO:{component:"button",iconIf:{0:{icon:"check_box_outline_blank",color:"primary"},1:{icon:"check_box",color:"primary"}},flat:!0},ACTION:{component:"button",icon:["remove_red_eye as ver","edit as editar","delete as eliminar"],tooltip:{ver:"Ver",editar:"Editar",eliminar:"Eliminar"},validate:{ver:function(e){return 2!==e.ACCION}},ver:function(e){var n=e.RUTA.split("."),o=n[n.length-1].toLowerCase();this.titleModalPdf=e.NOMBRE,this.url=this.getUrl(e),this.openModalPdf="pdf"===o,"pdf"!==o&&this.$refs.downloadFile.onClick()},editar:function(e){this.editRow=e,this.form.titulo=e.TITULO,this.form.id_proceso=e.ID_PROCESO,this.form.activo=e.ACTIVO,this.form.orden=e.ORDEN,this.form.accion=e.ACCION,this.showUpload(),this.flagAction="update",this.openModalCovidDocumento=!0},eliminar:function(e){var n=this;this.$confirm("¿Está seguro de eliminar este registro?","delete").onOk(A()(S()().m(function o(){return S()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,n.deleteCovidDocumento(e.ID_DOCUMENTO);case 1:return o.a(2)}},o)})))},permisos:{editar:">1",eliminar:"===3"},flat:!0,dense:!0,color:"primary"}},rows:[],fields:[{name:"MEDCOD",label:"Código",field:"MEDCOD",align:"center"},{name:"MEDDES",label:"Descripción",field:"MEDDES",align:"center"},{name:"CANTIDAD",label:"Cantidad",field:"CANTIDAD",align:"center"}]}}},y={data:function(){return{configMedicina:{MEDUNI:{renderHtml:function(e,n,o,a){return o.checkbox({value:e.MEDUNI,trueValue:"S"})}}},rowsMedicina:[],fieldsMedicina:[{name:"MEDUNI",label:"S/Uni",field:"MEDUNI",align:"center"},{name:"MEDCOD",label:"Código",field:"MEDCOD",align:"center"},{name:"MEDDES",label:"Descripción",field:"MEDDES",align:"center"},{name:"STOCK",label:"Stock",field:"STOCK",align:"center"}]}}},L=o(88275),_=o(92173),$=o(30640),x=o(17823),Q=o(80660),Y=o(6123),q=o(57668);function P(e,n){return null}var B={data:function(){return{config:{FECMOV:{component:"date",edit:!1},DOCREF:{multiRender:[{renderHtml:function(e,n,o){var a="";return"001"===e.DOCREF?a="Boleta":"002"===e.DOCREF?a="Factura":"003"===e.DOCREF?a="Guia":"004"===e.DOCREF?a="Inventario Inicial":"005"===e.DOCREF?a="Regularizar Stock":"006"===e.DOCREF?a="Donaciones":"007"===e.DOCREF?a="Medicamento vencido":"008"===e.DOCREF&&(a="Reprocesar stock Medicamentos"),n("span",{},a)}}]},ACTIVO:{component:"button",iconIf:{0:{icon:"check_box_outline_blank",color:"primary"},1:{icon:"check_box",color:"primary"}},flat:!0},ACTION:{component:"button",icon:["remove_red_eye as ver","edit as editar","delete as eliminar"],tooltip:{ver:"Ver",editar:"Editar",eliminar:"Eliminar"},validate:{ver:function(e){return 2!==e.ACCION}},ver:function(e){var n=e.RUTA.split("."),o=n[n.length-1].toLowerCase();this.titleModalPdf=e.NOMBRE,this.url=this.getUrl(e),this.openModalPdf="pdf"===o,"pdf"!==o&&this.$refs.downloadFile.onClick()},editar:function(e){this.editRow=e,this.form.titulo=e.TITULO,this.form.id_proceso=e.ID_PROCESO,this.form.activo=e.ACTIVO,this.form.orden=e.ORDEN,this.form.accion=e.ACCION,this.showUpload(),this.flagAction="update",this.openModalCovidDocumento=!0},eliminar:function(e){var n=this;this.$confirm("¿Está seguro de eliminar este registro?","delete").onOk(A()(S()().m(function o(){return S()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,n.deleteCovidDocumento(e.ID_DOCUMENTO);case 1:return o.a(2)}},o)})))},permisos:{editar:">1",eliminar:"===3"},flat:!0,dense:!0,color:"primary"}},rows:[],fields:[{name:"MEDCOD",label:"Código",field:"MEDCOD",align:"center"},{name:"MEDDES",label:"Descripción",field:"MEDDES",align:"center"},{name:"STOCK",label:"Stock",field:"STOCK",align:"center"}]}}},K=o(75053),G={mixins:[B],components:{sieModal:K.A,SieFecha:x.A,QInput:I.A,QSelect:U.A},props:{title:{type:String,default:function(){return""}},openModal:{type:Boolean,default:function(){return!1}}},data:function(){var e=(0,q["default"])();return{form:{usuario:e.usucod,nromov:"",fecmov:(0,N.Ay)(new Date,"DD/MM/YYYY"),anomov:e.ano,documento:[]},formMedicina:{codigo:"",cantidad:""},rows:[],openModalAgregar:!1,rowSelected:{}}},methods:{listar:function(){var e=this;return A()(S()().m(function n(){var o;return S()().w(function(n){while(1)switch(n.n){case 0:return n.n=1,Q.$http.get("api/MedicinaController/getMedicinaStock",{params:{}});case 1:return o=n.v,e.rows=o,n.a(2,o)}},n)}))()},rowSelected:function(e){return this.rowSelected=e},data:function(){return{formMedicina:{codigo:"",cantidad:""},rowSelected:rowSelected}}},created:function(){this.listar()}},z=o(12807);const H=(0,z.A)(G,[["render",P],["__scopeId","data-v-a9702110"]]);var W=H,X={mixins:[T,y],components:{sieSalones:L.Ay,sieEstudiantes:_.Ay,sieModal:$.A,SieFecha:x.A,QCard:R.A,QCardSection:V.A,QInput:I.A,QSelect:U.A,QTd:Y.Ef,QTr:Y.qh,QPopupEdit:Y.GT,QDatetime:Y.T5,QToggle:Y.c5,QPageSticky:Y._U,QFab:Y.l6,QFabAction:Y.B$,medicina:W,QPage:Y.Tu,QBtn:Y.Il},data:function(){var e=this,n=(0,q["default"])();return{form:{usuario:n.usucod,nromov:"",fecmov:(0,N.Ay)(new Date,"DD/MM/YYYY"),anomov:n.ano,documento:"",nroserie:"",nrodocumento:""},formMedicina:{codigo:"",cantidad:"",descripcion:""},formMedicinaSearch:{codigo:null,descripcion:null},documentos:[{value:"001",label:"Boleta"},{value:"002",label:"Factura"},{value:"003",label:"Guia"},{value:"004",label:"Inventario Inicial"},{value:"005",label:"Regularizar Stock"},{value:"007",label:"Medicamento vencido"},{value:"008",label:"Reprocesar stock Medicamentos"}],title:"Medicinas",openModalAgregar:!1,buttons:[{icon:"search",label:"Consultar",click:function(){e.$router.push({name:"medico.consulta",params:{tipoconsulta:"S"}})}},{icon:"delete",label:"Eliminar",click:function(){e.rowSelectedDetalle.MEDCOD?e.rows.map(function(n){n.MEDCOD===e.rowSelectedDetalle.MEDCOD&&(e.rows.splice(e.rows.indexOf(n),1),e.rowSelectedDetalle={})}):e.rows.length<1?e.$alert("No tiene medicamentos agregados"):e.$alert("Selecciona una medicina")}},{icon:"addcircle",label:"Agregar",tooltip:"Agregar Medicina",click:function(){e.openModalAgregar=!0,e.cleanFormMedicina(),e.listarMedicinaStock()}},{icon:"calendar",label:"Nuevo",click:function(){var n=A()(S()().m(function n(){var o;return S()().w(function(n){while(1)switch(n.n){case 0:if(!(e.rows.length>0)){n.n=2;break}return n.n=1,e.$confirmar("Ud. ha ingresado datos. ¿Desea grabar?","info",{okLabel:"Si",cancelLabel:"No",html:!0});case 1:if(o=n.v,o)try{e.buttons.map(function(e){"Grabar"===e.label&&e.click()})}catch(n){e.$notify("Ocurrió un problema de conexión.","warning")}else e.cleanForm(),e.cleanFormMedicina(),e.rows=[];case 2:return n.a(2)}},n)}));function o(){return n.apply(this,arguments)}return o}()},{icon:"save",label:"Grabar",click:function(){var n=A()(S()().m(function n(){var o;return S()().w(function(n){while(1)switch(n.p=n.n){case 0:if(n.p=0,e.form.documento){n.n=1;break}return e.$alert("Seleccionar un tipo de documento"),n.a(2);case 1:if(e.form.nroserie){n.n=2;break}return e.$alert("Ingresar la serie del documento"),n.a(2);case 2:if(e.form.nrodocumento){n.n=3;break}return e.$alert("Ingresar el número del documento"),n.a(2);case 3:if(!(e.rows.length<1)){n.n=4;break}return e.$alert("Seleccionar al menos un medicamento"),n.a(2);case 4:return n.n=5,Q.$http.post("api/MovMedCaController/addMovMedCa",{data:{NROMOV:e.form.nromov,TIPMOV:"S",FECMOV:(0,N.Ay)(new Date,"YYYY/MM/DD"),DOCREF:e.form.documento,ANOMOV:e.form.anomov,SERREF:e.form.nroserie,NROREF:e.form.nrodocumento,USUCOD:e.form.usuario,DATADETALLE:e.rows}});case 5:e.cleanForm(),e.rows=[],e.obtenerNromovDisponible(),e.$alert("<b>Proceso Finalizado.<b> <br>Salida de medicamentos registrada</br>","success",!0),n.n=7;break;case 6:n.p=6,o=n.v,e.$alert(o.message,"warning"),e.obtenerNromovDisponible();case 7:return n.a(2)}},n,null,[[0,6]])}));function o(){return n.apply(this,arguments)}return o}()}],rowSelected:{},rowSelectedDetalle:{},key:Date.now()}},methods:{listar:function(){var e=this;return A()(S()().m(function n(){var o;return S()().w(function(n){while(1)switch(n.n){case 0:return n.n=1,Q.$http.get("api/MovMedCaController/getListar",{params:{parametros:{USUCOD:e.form.usuario,TIPMOV:"S"}}});case 1:return o=n.v,e.rows=o,n.a(2,o)}},n)}))()},cleanForm:function(){this.form={usuario:(0,q["default"])().usucod,nromov:"",fecmov:(0,N.Ay)(new Date,"DD/MM/YYYY"),anomov:(0,q["default"])().ano,documento:"",nroserie:"",nrodocumento:""}},cleanFormMedicina:function(){this.formMedicina={codigo:"",cantidad:"",descripcion:""},this.formMedicinaSearch={codigo:"",descripcion:""}},insertMedicina:function(){this.rows.push({MEDCOD:this.rowSelected.MEDCOD,MEDDES:this.rowSelected.MEDDES,CANTIDAD:this.formMedicina.cantidad}),this.key=Date.now(),this.rowSelected={}},addMedicina:function(){var e=this;return A()(S()().m(function n(){var o;return S()().w(function(n){while(1)switch(n.n){case 0:if(e.rowSelected.MEDCOD){n.n=2;break}return n.n=1,e.$alert("Selecciona mínimo una medicina");case 1:return n.a(2);case 2:if(e.formMedicina.cantidad){n.n=4;break}return n.n=3,e.$alert("Debe ingresar una cantidad","","","#f8bb86");case 3:return n.a(2);case 4:if(!(e.formMedicina.cantidad>e.rowSelected.STOCK)){n.n=6;break}return n.n=5,e.$alert("La cantidad ingresada no puede ser mayor al stock actual");case 5:return n.a(2);case 6:if(!(e.rows.length>0)){n.n=10;break}if(o=e.rows.filter(function(n){return n.MEDCOD===e.rowSelected.MEDCOD}),!(o.length>0)){n.n=8;break}return n.n=7,e.$alert("El medicamento seleccionado ya se encuentra en lista");case 7:return n.a(2);case 8:e.insertMedicina();case 9:n.n=11;break;case 10:e.insertMedicina();case 11:e.cleanFormMedicina();case 12:return n.a(2)}},n)}))()},searchMedicina:function(){var e=this;return A()(S()().m(function n(){var o;return S()().w(function(n){while(1)switch(n.n){case 0:return n.n=1,Q.$http.get("api/MedicinaController/getMedicinaStock",{params:{parametros:{MEDCOD:e.formMedicinaSearch.codigo,MEDDES:e.formMedicinaSearch.descripcion.toUpperCase()}}});case 1:return o=n.v,e.rowsMedicina=o,n.a(2,o)}},n)}))()},listarMedicinaStock:function(){var e=this;return A()(S()().m(function n(){var o;return S()().w(function(n){while(1)switch(n.n){case 0:return n.n=1,Q.$http.get("api/MedicinaController/getMedicinaStock",{params:{}});case 1:return o=n.v,e.rowsMedicina=o,n.a(2,o)}},n)}))()},obtenerNromovDisponible:function(){var e=this;return A()(S()().m(function n(){var o,a;return S()().w(function(n){while(1)switch(n.n){case 0:return n.n=1,Q.$http.get("api/controlController/getNroMov",{params:{parametros:{}}});case 1:return o=n.v,a=o.NUMERO,e.form.nromov=a,n.a(2,a)}},n)}))()},rowSelect:function(e){this.rowSelected=e,this.formMedicina.codigo=e.MEDCOD,this.formMedicina.cantidad="",this.formMedicina.descripcion=e.MEDDES},rowSelectDetalle:function(e){this.rowSelectedDetalle=e}},created:function(){this.obtenerNromovDisponible(),"0253"===(0,q["default"])().colcod&&this.documentos.push({value:"006",label:"Donaciones"})}};const j=(0,z.A)(X,[["render",k],["__scopeId","data-v-d38b6134"]]);var J=j}}]);