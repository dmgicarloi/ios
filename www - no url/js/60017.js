"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[60017],{60017:function(e,o,a){a.r(o),a.d(o,{default:function(){return k}});var n=a(8445),t=a.n(n),l=a(61758),r=a(58790),i={class:"q-pa-sm"},u={class:"row gutter-sm"},d={class:"col-4"},c={class:"col-8"},s={class:"col"},f={class:"col"};function p(e,o){var a=(0,l.g2)("q-toolbar-title"),n=(0,l.g2)("q-toolbar"),p=(0,l.g2)("q-td"),m=(0,l.g2)("q-input"),b=(0,l.g2)("q-popup-edit"),g=(0,l.g2)("q-datetime"),E=(0,l.g2)("sie-select"),C=(0,l.g2)("q-toggle"),F=(0,l.g2)("q-tooltip"),V=(0,l.g2)("q-btn"),Y=(0,l.g2)("q-tr"),h=(0,l.g2)("q-table"),A=(0,l.g2)("q-page-sticky"),I=(0,l.g2)("q-field"),v=(0,l.g2)("sie-modal"),k=(0,l.g2)("q-page");return(0,l.uX)(),(0,l.Wv)(k,{class:"bg-white"},{default:(0,l.k6)(function(){return[(0,l.bF)(n,{class:"shadow-2 z-fab",inverted:""},{default:(0,l.k6)(function(){return[(0,l.bF)(a,{class:"q-pa-none"},{default:(0,l.k6)(function(){return t()(o[7]||(o[7]=[(0,l.eW)("Mantenimiento Año",-1)]))}),_:1})]}),_:1}),(0,l.bF)(h,{class:"q-mx-sm q-mt-md",data:e.dataYears,columns:e.columns,"table-class":"no-scroll",pagination:e.pagination,"onUpdate:pagination":o[0]||(o[0]=function(o){return e.pagination=o}),"rows-per-page-options":[0],"hide-bottom":"","row-key":"ANO"},{body:(0,l.k6)(function(a){return[(0,l.bF)(Y,{props:a},{default:(0,l.k6)(function(){return[(0,l.bF)(p,{key:"ANO",props:a},{default:(0,l.k6)(function(){return[(0,l.eW)((0,r.v_)(a.row.ANO),1)]}),_:2},1032,["props"]),(0,l.bF)(p,{key:"DES",props:a},{default:(0,l.k6)(function(){return[(0,l.eW)((0,r.v_)(a.row.DES),1),(0,l.bF)(b,{modelValue:a.row.DES,"onUpdate:modelValue":function(e){return a.row.DES=e},buttons:"",onSave:function(o){return e.editarYear(a.row,"DES")},disable:!e.acceso},{default:(0,l.k6)(function(){return[(0,l.bF)(m,{class:"q-if-outlined",modelValue:a.row.DES,"onUpdate:modelValue":function(e){return a.row.DES=e},"float-label":"Descripción"},null,8,["modelValue","onUpdate:modelValue"])]}),_:2},1032,["modelValue","onUpdate:modelValue","onSave","disable"])]}),_:2},1032,["props"]),(0,l.bF)(p,{key:"FECINICLA",props:a},{default:(0,l.k6)(function(){return[(0,l.eW)((0,r.v_)(e.date(a.row.FECINICLA,"DD/MM/YYYY")),1),(0,l.bF)(b,{modelValue:a.row.FECINICLA,"onUpdate:modelValue":function(e){return a.row.FECINICLA=e},disable:!e.acceso},{default:(0,l.k6)(function(){return[(0,l.bF)(g,{type:"date",modelValue:a.row.FECINICLA,"onUpdate:modelValue":function(e){return a.row.FECINICLA=e},format:"DD/MM/YYYY",placeholder:"Fecha de inicio",onChange:function(o){return e.editarYear(a.row,"FECINICLA")}},null,8,["modelValue","onUpdate:modelValue","onChange"])]}),_:2},1032,["modelValue","onUpdate:modelValue","disable"])]}),_:2},1032,["props"]),(0,l.bF)(p,{key:"FECFINCLA",props:a},{default:(0,l.k6)(function(){return[(0,l.eW)((0,r.v_)(e.date(a.row.FECFINCLA,"DD/MM/YYYY")),1),(0,l.bF)(b,{modelValue:a.row.FECFINCLA,"onUpdate:modelValue":function(e){return a.row.FECFINCLA=e},disable:!e.acceso},{default:(0,l.k6)(function(){return[(0,l.bF)(g,{type:"date",modelValue:a.row.FECFINCLA,"onUpdate:modelValue":function(e){return a.row.FECFINCLA=e},format:"DD/MM/YYYY",placeholder:"Fecha de fin",onChange:function(o){return e.editarYear(a.row,"FECFINCLA")}},null,8,["modelValue","onUpdate:modelValue","onChange"])]}),_:2},1032,["modelValue","onUpdate:modelValue","disable"])]}),_:2},1032,["props"]),(0,l.bF)(p,{key:"ESTADO",props:a},{default:(0,l.k6)(function(){return[(0,l.eW)((0,r.v_)("I"===a.row.ESTADO?"Inicio":"C"===a.row.ESTADO?"Cierre":"P"===a.row.ESTADO?"Proceso":"-"),1),(0,l.bF)(b,{modelValue:a.row.ESTADO,"onUpdate:modelValue":function(e){return a.row.ESTADO=e},disable:!e.acceso},{default:(0,l.k6)(function(){return[(0,l.bF)(E,{modelValue:a.row.ESTADO,"onUpdate:modelValue":function(e){return a.row.ESTADO=e},type:"outlined",options:e.opcEstado,val:"value",label:"label",placeholder:"Estado",onSelected:function(o){return e.editarYear(a.row,"ESTADO")}},null,8,["modelValue","onUpdate:modelValue","options","onSelected"])]}),_:2},1032,["modelValue","onUpdate:modelValue","disable"])]}),_:2},1032,["props"]),(0,l.bF)(p,{key:"VIGENTE",props:a},{default:(0,l.k6)(function(){return[(0,l.bF)(C,{modelValue:a.row.VIGENTE,"onUpdate:modelValue":function(e){return a.row.VIGENTE=e},"true-value":"S","false-value":"N",onInput:function(o){return e.cambiarVigencia(a.row)},disable:!e.acceso},null,8,["modelValue","onUpdate:modelValue","onInput","disable"])]}),_:2},1032,["props"]),(0,l.bF)(p,{key:"ACCIONES",props:a},{default:(0,l.k6)(function(){return[(0,l.bF)(V,{color:"negative",icon:"delete",flat:"",onClick:function(o){return e.eliminarYear(a.row.ANO)},disable:!e.acceso},{default:(0,l.k6)(function(){return[(0,l.bF)(F,{anchor:"bottom middle",self:"top middle"},{default:(0,l.k6)(function(){return t()(o[8]||(o[8]=[(0,l.eW)("Eliminar",-1)]))}),_:1})]}),_:1},8,["onClick","disable"])]}),_:2},1032,["props"])]}),_:2},1032,["props"])]}),_:1},8,["data","columns","pagination"]),e.acceso?((0,l.uX)(),(0,l.Wv)(A,{key:0,expand:"",position:"bottom-right",offset:[20,20]},{default:(0,l.k6)(function(){return[(0,l.bF)(V,{fab:"",round:"",color:"secondary",icon:"add",onClick:o[1]||(o[1]=function(o){return e.openModal=!0})})]}),_:1})):(0,l.Q3)("v-if",!0),(0,l.bF)(v,{modelValue:e.openModal,"onUpdate:modelValue":o[6]||(o[6]=function(o){return e.openModal=o}),title:"Añadir nuevo año",ok:"Guardar",onSubmit:e.grabarYear,onClose:e.limpiarFormYear,css:{minWidth:"40vw"}},{default:(0,l.k6)(function(){return[(0,l.Lk)("div",i,[(0,l.Lk)("div",u,[(0,l.Lk)("div",d,[(0,l.bF)(I,{"error-label":e.$t("validaciones.requerido"),error:e.v$.formYear.ano.$error},{default:(0,l.k6)(function(){return[(0,l.bF)(E,{type:"outlined",modelValue:e.formYear.ano,"onUpdate:modelValue":o[2]||(o[2]=function(o){return e.formYear.ano=o}),options:e.listaAnios,val:"value",label:"label",placeholder:"Año",onBlur:e.v$.formYear.ano.$touch},null,8,["modelValue","options","onBlur"])]}),_:1},8,["error-label","error"])]),(0,l.Lk)("div",c,[(0,l.bF)(m,{class:"q-if-outlined",modelValue:e.formYear.des,"onUpdate:modelValue":o[3]||(o[3]=function(o){return e.formYear.des=o}),"float-label":"Descripción"},null,8,["modelValue"])]),(0,l.Lk)("div",s,[(0,l.bF)(g,{type:"date",modelValue:e.formYear.fecinicla,"onUpdate:modelValue":o[4]||(o[4]=function(o){return e.formYear.fecinicla=o}),format:"DD/MM/YYYY",placeholder:"Fecha de inicio"},null,8,["modelValue"])]),(0,l.Lk)("div",f,[(0,l.bF)(g,{type:"date",modelValue:e.formYear.fecfincla,"onUpdate:modelValue":o[5]||(o[5]=function(o){return e.formYear.fecfincla=o}),format:"DD/MM/YYYY",placeholder:"Fecha de fin"},null,8,["modelValue"])])])])]}),_:1},8,["modelValue","onSubmit","onClose"])]}),_:1})}a(10239);var m=a(83972),b=a(6123),g=a(24729),E=a(93616),C=a(30640),F=a(57668),V=a(982),Y=a(18105),h=a(82640),A={setup:function(){var e=(0,m.fG)();return{v$:e}},components:{QTable:b.kH,QTr:b.qh,QTd:b.Ef,QCard:b.C$,QPopupEdit:b.GT,QCardTitle:b.u0,QCardMain:b.d1,QToggle:b.c5,QDatetime:b.T5,Dialog:g.A,QPageSticky:b._U,sieSelect:E.A,sieModal:C.A,notify:V["default"],sieInfo:F["default"],QPage:b.Tu,QToolbar:b.ZV,QToolbarTitle:b.r_,QInput:b.ie,QBtn:b.Il,QTooltip:b.nC,QField:b.Om},data:function(){return{acceso:(0,F["default"])().ruta.nivel>=2,openModal:!1,dataYears:[],formYear:{ano:"",des:"",fecinicla:null,fecfincla:null},opcEstado:[{label:"Inicio",value:"I"},{label:"Cierre",value:"C"},{label:"Proceso",value:"P"}],columns:[{label:"AÑO",name:"ANO",field:"ANO",align:"center"},{label:"DESCRIPCIÓN",name:"DES",field:"DES",align:"center"},{label:"INICIO",name:"FECINICLA",field:"FECINICLA",align:"center"},{label:"FIN",name:"FECFINCLA",field:"FECFINCLA",align:"center"},{label:"ESTADO",name:"ESTADO",field:"ESTADO",align:"center"},{label:"VIGENTE",name:"VIGENTE",field:"VIGENTE",align:"center"},{label:"ACCIONES",name:"ACCIONES",field:"ACCIONES",align:"center"}],pagination:{sortBy:null,descending:!1,page:1,rowsPerPage:500}}},validations:{formYear:{ano:{required:h.mw}}},computed:{listaAnios:function(){for(var e=[],o=1950,a=parseInt((0,F["default"])().ano),n=a+10,t=n;t>=o;t--)e.push({label:t,value:t});return e}},methods:{date:Y.Ay,init:function(){this.obtenerYears()},obtenerYears:function(){var e=this;this.$http.get("api/HyoAnos/getAllYears").then(function(o){e.dataYears=o.json})},grabarYear:function(){var e=this;this.v$.$touch(),this.v$.$invalid||(console.log(this.formYear),this.$http.post("api/HyoAnos/saveYearProcess",{data:this.formYear}).then(function(o){e.openModal=!1,(0,V["default"])(o.json.message)}).then(function(){e.obtenerYears()}).catch(function(e){(0,V["default"])(e.error.message,"error")}))},editarYear:function(e,o){var a={};a[o]=e[o];var n={year:e.ANO,data:a};this.$http.put("api/HyoAnos/updateYear",n).then(function(e){(0,V["default"])(e.json.message)})},eliminarYear:function(e){var o=this;this.$q.dialog({title:"¿Esta seguro de eliminar el registro?",ok:"Si",cancel:"No"}).onOk(function(){o.$http.delete("api/HyoAnos/deleteYear",{params:{year:e}}).then(function(e){(0,V["default"])(e.json.message)}).then(function(){o.obtenerYears()}).catch(function(e){(0,V["default"])(e.error.message,"error")})})},cambiarVigencia:function(e){var o=this,a={year:e.ANO,vigente:e.VIGENTE};"N"===e.VIGENTE?(e.VIGENTE="S",(0,V["default"])("No puede quedar un año sin vigencia","warning")):this.$http.put("api/HyoAnos/setYearVigente",a).then(function(e){(0,V["default"])(e.json.message)}).then(function(){o.obtenerYears()})},limpiarFormYear:function(){this.v$.$reset(),this.formYear={ano:"",des:"",fecinicla:null,fecfincla:null}}},created:function(){this.init()}},I=a(12807);const v=(0,I.A)(A,[["render",p]]);var k=v}}]);