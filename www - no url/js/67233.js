"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[67233],{67233:function(n,o,e){e.r(o),e.d(o,{default:function(){return M}});var a=e(8445),t=e.n(a),r=e(61758),i={class:"col-xs-12 row"},u={class:"col-xs-12 q-pa-sm row"},l={class:"col-xs-12 col-md-6"},c={class:"col-xs-12 col-md-6"},s={class:"row q-col-gutter-sm q-pa-md"},d={class:"col-xs-12 col-sm-6"},f={class:"col-xs-12 col-sm-6"};function m(n,o){var e=this,a=(0,r.g2)("header-btn"),m=(0,r.g2)("q-tab"),h=(0,r.g2)("sie-select"),I=(0,r.g2)("sie-table"),T=(0,r.g2)("q-card-main"),C=(0,r.g2)("q-card"),p=(0,r.g2)("q-tab-pane"),O=(0,r.g2)("q-tabs"),b=(0,r.g2)("q-tooltip"),E=(0,r.g2)("q-fab-action"),F=(0,r.g2)("q-fab"),g=(0,r.g2)("q-page-sticky"),D=(0,r.g2)("q-datetime"),N=(0,r.g2)("q-field"),R=(0,r.g2)("sie-modal"),v=(0,r.g2)("q-page");return(0,r.uX)(),(0,r.Wv)(v,{class:"talleres--turno-inscripcion"},{default:(0,r.k6)(function(){return[(0,r.bF)(a,{name:"Cronograma de inscripción",buttons:n.buttons},null,8,["buttons"]),(0,r.bF)(O,{class:"col",inverted:"",modelValue:n.tabModel,"onUpdate:modelValue":o[6]||(o[6]=function(o){return n.tabModel=o})},{title:(0,r.k6)(function(){return[(0,r.bF)(m,{default:"",label:"Por Nivel y Grado",name:"1",id:"tab-list",onClick:o[0]||(o[0]=function(o){return n.cambiarTab(1)})}),(0,r.bF)(m,{label:"Por Curso",name:"2",id:"tab-page",onClick:o[1]||(o[1]=function(o){return n.cambiarTab(2)})})]}),default:(0,r.k6)(function(){return[(0,r.bF)(p,{name:"1"},{default:(0,r.k6)(function(){return[(0,r.bF)(C,null,{default:(0,r.k6)(function(){return[(0,r.bF)(T,{class:"q-pa-none"},{default:(0,r.k6)(function(){return[(0,r.bF)(h,{class:"q-pa-sm",type:"outlined",modelValue:n.duracod,"onUpdate:modelValue":o[2]||(o[2]=function(o){return n.duracod=o}),val:"DURACOD",label:"DURADES",options:n.optPeriodo,readonly:!1,placeholder:"Periodo",onInput:o[3]||(o[3]=function(o){return n.cambiarTab(1)})},null,8,["modelValue","options"]),(0,r.bF)(I,{"show-search":!0,data:n.dataTurno,columns:n.columnsTurno,initChecked:!0,context:e,config:n.configTurno,css:"height: calc(90vh - 110px)"},null,8,["data","columns","config"])]}),_:1})]}),_:1})]}),_:1}),(0,r.bF)(p,{name:"2"},{default:(0,r.k6)(function(){return[(0,r.bF)(C,null,{default:(0,r.k6)(function(){return[(0,r.bF)(T,{class:"q-pa-none"},{default:(0,r.k6)(function(){return[(0,r.bF)(h,{class:"q-pa-sm",type:"outlined",modelValue:n.duracod,"onUpdate:modelValue":o[4]||(o[4]=function(o){return n.duracod=o}),val:"DURACOD",label:"DURADES",options:n.optPeriodo,readonly:!1,placeholder:"Periodo",onInput:o[5]||(o[5]=function(o){return n.cambiarTab(2)})},null,8,["modelValue","options"]),(0,r.bF)(I,{"show-search":!0,data:n.dataTurno,columns:n.columnsTurno,initChecked:!0,context:e,config:n.configTurno,css:"height: calc(90vh - 110px)"},null,8,["data","columns","config"])]}),_:1})]}),_:1})]}),_:1})]}),_:1},8,["modelValue"]),(0,r.bF)(g,{position:"bottom-right",offset:[10,10]},{default:(0,r.k6)(function(){return[(0,r.bF)(F,{icon:"more_vert",direction:"up",color:"secondary"},{default:(0,r.k6)(function(){return[n.permiso?((0,r.uX)(),(0,r.Wv)(E,{key:0,color:"secondary",icon:"add",onClick:n.abrirModal},{default:(0,r.k6)(function(){return[(0,r.bF)(b,{anchor:"center left",self:"center right"},{default:(0,r.k6)(function(){return t()(o[13]||(o[13]=[(0,r.eW)("Agregar Turno de Inscripción",-1)]))}),_:1})]}),_:1},8,["onClick"])):(0,r.Q3)("v-if",!0),n.showEditarEnBloque?((0,r.uX)(),(0,r.Wv)(E,{key:1,color:"secondary",icon:"edit",onClick:n.abrirEditarEnBloqueModal},{default:(0,r.k6)(function(){return[(0,r.bF)(b,{anchor:"center left",self:"center right"},{default:(0,r.k6)(function(){return t()(o[14]||(o[14]=[(0,r.eW)("Editar en bloque",-1)]))}),_:1})]}),_:1},8,["onClick"])):(0,r.Q3)("v-if",!0),n.permiso?((0,r.uX)(),(0,r.Wv)(E,{key:2,color:"secondary",icon:"delete",onClick:n.borrarTodos},{default:(0,r.k6)(function(){return[(0,r.bF)(b,{anchor:"center left",self:"center right"},{default:(0,r.k6)(function(){return t()(o[15]||(o[15]=[(0,r.eW)("Borrar Todos",-1)]))}),_:1})]}),_:1},8,["onClick"])):(0,r.Q3)("v-if",!0)]}),_:1})]}),_:1}),(0,r.bF)(R,{modelValue:n.modalTurno,"onUpdate:modelValue":o[9]||(o[9]=function(o){return n.modalTurno=o}),title:"Agregar Turno de Inscripción",onSubmit:n.agregarTurno,css:{minWidth:"800px",maxWidth:"950px"}},{default:(0,r.k6)(function(){return[(0,r.Lk)("div",i,[o[16]||(o[16]=(0,r.Lk)("div",{class:"col-xs-12"},null,-1)),(0,r.Lk)("div",u,[(0,r.Lk)("div",l,[(0,r.bF)(N,{class:"col",icon:"calendar"},{default:(0,r.k6)(function(){return[(0,r.bF)(D,{class:"q-if-outlined col",modelValue:n.form.FECINI,"onUpdate:modelValue":o[7]||(o[7]=function(o){return n.form.FECINI=o}),type:"datetime",format:"DD/MM/YYYY hh:mm A","ok-label":"","float-label":"Fecha Inicio",onBlur:n.cambiaFechaInicio},null,8,["modelValue","onBlur"])]}),_:1})]),(0,r.Lk)("div",c,[(0,r.bF)(N,{class:"col",icon:"calendar"},{default:(0,r.k6)(function(){return[(0,r.bF)(D,{class:"q-if-outlined col",modelValue:n.form.FECFIN,"onUpdate:modelValue":o[8]||(o[8]=function(o){return n.form.FECFIN=o}),type:"datetime",format:"DD/MM/YYYY hh:mm A","float-label":"Fecha Fin",onBlur:n.cambiaFechaFin},null,8,["modelValue","onBlur"])]}),_:1})])])]),(0,r.bF)(I,{ref:"tablaSalon","show-search":!0,selection:"multiple",data:n.dataTurnoAdd,columns:n.columnsAddTurno,onRowSelected:n.seleccionarFila,onRowContext:n.seleccionarFila,onOnload:n.onloadTablaSalon,onCheckAll:n.seleccionarTodos,initChecked:!0,context:e,config:n.configSalones,css:"height: calc(70vh - 200px)"},null,8,["data","columns","onRowSelected","onRowContext","onOnload","onCheckAll","config"]),o[17]||(o[17]=(0,r.Lk)("div",{class:"row q-pa-md text-primary"},"Para evitar saturación por concurrencia se ha establecido un limite de 500 estudiantes a matricularse en la misma hora.",-1))]}),_:1},8,["modelValue","onSubmit"]),(0,r.bF)(R,{modelValue:n.modalEditarEnBloque,"onUpdate:modelValue":o[12]||(o[12]=function(o){return n.modalEditarEnBloque=o}),title:"Editar en bloque",css:{minWidth:"800px",maxWidth:"950px"},ok:!1,footer:!1},{default:(0,r.k6)(function(){return[(0,r.Lk)("div",s,[(0,r.Lk)("div",d,[(0,r.bF)(N,{class:"col",icon:"calendar"},{default:(0,r.k6)(function(){return[(0,r.bF)(D,{class:"q-if-outlined col",modelValue:n.formEditarEnBloque.FECINI,"onUpdate:modelValue":o[10]||(o[10]=function(o){return n.formEditarEnBloque.FECINI=o}),type:"datetime",format:"DD/MM/YYYY hh:mm A","ok-label":"","float-label":"Fecha Inicio",onBlur:n.cambiaFechaInicioEnBloque},null,8,["modelValue","onBlur"])]}),_:1})]),(0,r.Lk)("div",f,[(0,r.bF)(N,{class:"col",icon:"calendar"},{default:(0,r.k6)(function(){return[(0,r.bF)(D,{class:"q-if-outlined col",modelValue:n.formEditarEnBloque.FECFIN,"onUpdate:modelValue":o[11]||(o[11]=function(o){return n.formEditarEnBloque.FECFIN=o}),type:"datetime",format:"DD/MM/YYYY hh:mm A","float-label":"Fecha Fin",onBlur:n.cambiaFechaFinEnBloque},null,8,["modelValue","onBlur"])]}),_:1})])])]}),_:1},8,["modelValue"])]}),_:1})}var h=e(76080),I=e.n(h),T=e(45254),C=e.n(T),p=e(57008),O=e.n(p),b=(e(30683),e(71225),e(74260),e(39866),e(52133),e(10239),e(50310),e(5962),e(32203),e(6724),e(70199),e(11777),e(83190),e(62692),e(88567)),E=e(95718),F=e(53380),g=e(16648),D=e(92173),N=e(93616),R=e(80660),v=e(75053),P=e(30640),A=e(36408),S=e(27560),w=e(96330),_=e(6123),k=e(57668),U=e(81288),V=e(14667),q=e(2819),L={components:{QSeparator:F.A,QFab:_.l6,QFabAction:_.B$,QCard:b.A,QCardSection:E.A,sieEstudiantes:D.Ay,sieSelect:N.A,sieModal:P.A,QTabs:_.uw,QTab:_.zu,QSelect:g.S,QDialog:_.OQ,QTabPane:_.dg,QDatetime:_.T5,QTable:_.kH,QList:_.Mb,QListHeader:_.XR,QItem:_.H0,QItemMain:_.mF,QItemSeparator:_.CL,QItemSide:_.n1,QItemTile:_.lp,QTr:_.qh,QTh:_.EJ,QTd:_.Ef,QBtn:_.Il,QCheckbox:_.vZ,QTableColumns:_.$s,QPageSticky:_._U,sieGrid:A.A,headerGrid:w.A,footerGrid:S.A,sieModalTesoreria:v.A,QPage:_.Tu,QCardMain:_.d1,QTooltip:_.nC,QField:_.Om},mixins:[V.A],data:function(){var n=this;return{buttons:[{label:"Reporte",icon:"file_excel",permiso:"===3",click:this.printxls}],objCursos:{},dataTurno:[],optPeriodo:[],loadSelection:{key:"ID_CURSO_PERIODO",values:["35A0"]},loadDisable:{key:"ID_CURSO_PERIODO",values:["37A0"]},dataTurnoAdd:[],modalTurno:!1,modalEditarEnBloque:!1,formEditarEnBloque:{FECINI:null,FECFIN:null},duracod:null,sie:(0,k["default"])(),salones:[],clonData:{NGS:[],NEMO:[],ID_CURSO_PERIODO:[]},isFamAlu:(0,k["default"])().esFamilia||(0,k["default"])().esFamiliaAdmision||(0,k["default"])().esEstudiante||["E01","E02"].includes((0,k["default"])().tipcod),permiso:3,showEditarEnBloque:["001"].includes((0,k["default"])().tipcod),tabModel:"0",optionTipo:[{ID_TURNOTIPO:1,TIPO:"NGS",NOMBRETIPO:"Nivel Grado y Sección",TIPODES:"NEMODES"},{ID_TURNOTIPO:2,TIPO:"ID_CURSO_PERIODO",NOMBRETIPO:"Curso",TIPODES:"CURSONOM"}],configTurno:{FECINI:{component:"datetime",input:function(n,o,e,a){var t={id_turnotipo:n.ID_TURNOTIPO,valor:n.VALOR,ano:n.ANO,periodo:n.PERIODO};this.actualizarTurno(n,t)},cellStyle:function(n){if(new Date(n.FECINI)<new Date)return{background:"#efd2d4"}}},FECFIN:{component:"datetime",input:function(n,o,e){var a={id_turnotipo:n.ID_TURNOTIPO,valor:n.VALOR};this.actualizarTurno(n,a)}},VALOR:{component:"select",options:[],optionValue:"NGS",optionLabel:"NEMODES",input:function(n,o,e,a){var t={id_turnotipo:n.ID_TURNOTIPO,valor:e};this.actualizarTurno(n,t)},edit:!0},COLOR:{renderHtml:function(n,o,e,a){new Date(n.FECINI),new Date}},ACCION:{component:"button",icon:["delete as eliminar"],tooltip:{ver:"Ver",editar:"Editar",eliminar:"Eliminar"},eliminar:function(o,e,a){n.eliminarTurno(o.ID_TURNOTIPO,o.VALOR)},flat:!0,dense:!0}},configSalones:{FECINI:{component:"datetime",prevent:!0},FECFIN:{component:"datetime",prevent:!0}},columnsAddTurno:[],columns:{NGS:[{name:"NEMO",label:"Código",align:"left",field:"NEMO",sortable:!1,hidden:!0},{name:"NGS",label:"NGS",align:"left",field:"NGS",sortable:!0},{name:"ALUMNOS",label:"Alumnos Potenciales",align:"left",field:"ALUMNOS",sortable:!0}],ID_CURSO_PERIODO:[{name:"ID_CURSO_PERIODO",label:"Código",align:"left",field:"ID_CURSO_PERIODO",sortable:!1,hidden:!0},{name:"CURSODES",label:"Curso",align:"left",field:"CURSODES",sortable:!0}]},turnosConfigurados:{NGS:[],ID_CURSO_PERIODO:[]},descripcionTurnos:{NGS:{},ID_CURSO_PERIODO:{}},form:{ID_TURNOTIPO:1},cantidadPosiblePorCurso:{},limiteAlumnosPorCurso:500,horaFinInscripcion:20,horaInicioInscripcion:8,diasComienzo:7,countAlumnos:0,fechaTurno:new Date,fechaTurnoFin:new Date,usuarioCambiaFechaFin:!1}},computed:{columnsTurno:function(){var n=[{name:"FECINI",label:"Fecha Inicio",align:"left",field:"FECINI",sortable:!0},{name:"FECFIN",label:"Fecha fin",align:"left",field:"FECFIN",sortable:!0},{name:"VALOR",label:1==this.tabModel?"Salon":"Curso",align:"left",field:"VALOR",sortable:!0,wrap:!0},{name:"CURSO",align:"left",field:"CURSO",vIf:!1},{name:"VACANTES",label:"Vacantes",align:"left",field:"VACANTES",sortable:!0,wrap:!0,vIf:2==this.tabModel},{name:"DISPONIBLES",label:"Disponibles",align:"left",field:"DISPONIBLES",sortable:!0,wrap:!0,vIf:2==this.tabModel},{name:"ACCION",label:"",align:"left",field:"ACCION",sortable:!1},{name:"COLOR",label:"",align:"left",field:"COLOR",sortable:!1,vIf:!1}];return n},isLess:function(){return(0,U.isLess)()},tipo:function(){var n=this,o=this.optionTipo.find(function(o){return o.ID_TURNOTIPO===n.form.ID_TURNOTIPO});return o}},methods:{printxls:function(){var n=(0,k["default"])(),o={ano:n.ano,periodo:this.duracod,id_turnotipo:this.tabModel},e="".concat(n.host,"/api/CtCursoPeriodoController/exportarCronograma?params=").concat(JSON.stringify(o));(0,q.open)({action:e})},cambiaFechaFin:function(n){this.usuarioCambiaFechaFin=!0;for(var o=O()({},this.form),e=0;e<this.dataTurnoAdd.length;e++)this.dataTurnoAdd[e].FECFIN=o.FECFIN;this.fechaTurnoFin=o.FECFIN},seleccionarTodos:function(n){n?this.calcularTurnosDeInscripcion():(this.limpiarVariablesCalculoFecha(),this.dataTurnoAdd=this.dataTurnoAdd.map(function(n){return n.FECINI=null,n.FECFIN=null,n}))},seleccionarFila:function(n,o,e){if(!o[this.tipo.TIPO])return this.$notify("Falta el identificador de:"+o[this.tipo.TIPODES]+"No se asignara su turno","info");o.FECINI||this.calculaTurnoDeInscripcion(o)},limpiarVariablesCalculoFecha:function(){var n=O()({},this.form);n.FECINI&&(this.fechaTurno=new Date(n.FECINI))},calculaTurnoDeInscripcion:function(n){var o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!o&&this.countAlumnos>this.limiteAlumnosPorCurso){var e=this.fechaTurno.getHours()+1;e>this.horaFinInscripcion&&(e=this.horaInicioInscripcion,this.fechaTurno.setDate(this.fechaTurno.getDate()+1)),this.fechaTurno.setHours(e),this.countAlumnos=0}return this.countAlumnos+=n.ALUMNOS,n.FECINI=this.fechaTurno.toISOString(),n.FECFIN=this.fechaTurnoFin,n},calcularTurnosDeInscripcion:function(){var n=O()({},this.form);this.limpiarVariablesCalculoFecha(),this.countAlumnos<=this.limiteAlumnosPorCurso&&(this.countAlumnos=0);for(var o=0;o<this.dataTurnoAdd.length;o++){var e=this.dataTurnoAdd[o];this.dataTurnoAdd[o]=this.calculaTurnoDeInscripcion(e,0===o)}n.FECFIN=this.fechaTurnoFin,this.form=n},cambiaFechaInicio:function(){if(!this.form.FECINI)return!1;this.calcularTurnosDeInscripcion()},cambiaFechaInicioEnBloque:function(){var n=this;return C()(I()().m(function o(){var e,a,t;return I()().w(function(o){while(1)switch(o.n){case 0:if(n.formEditarEnBloque.FECINI){o.n=1;break}return o.a(2);case 1:return o.n=2,n.$confirmar("¿Está seguro que desea actualizar la fecha de inicio para todos los registros?");case 2:if(e=o.v,!e){o.n=5;break}return a={FECINI:n.formEditarEnBloque.FECINI},t={data:n.dataTurno},o.n=3,R.$http.post("api/CtTurnoController/updateCtTurnoEnBloque",{data:a,params:t});case 3:return o.n=4,n.getCtTurno();case 4:n.cargarTurno(),n.$notify("Se actualizó la fecha inicio de todos los registros satisfactoriamente","success"),n.formEditarEnBloque.FECINI=null,n.modalEditarEnBloque=!1;case 5:return o.a(2)}},o)}))()},cambiaFechaFinEnBloque:function(){var n=this;return C()(I()().m(function o(){var e,a,t;return I()().w(function(o){while(1)switch(o.n){case 0:if(n.formEditarEnBloque.FECFIN){o.n=1;break}return o.a(2);case 1:return o.n=2,n.$confirmar("¿Está seguro que desea actualizar la fecha fin para todos los registros?");case 2:if(e=o.v,!e){o.n=5;break}return a={FECFIN:n.formEditarEnBloque.FECFIN},t={data:n.dataTurno},o.n=3,R.$http.post("api/CtTurnoController/updateCtTurnoEnBloque",{data:a,params:t});case 3:return o.n=4,n.getCtTurno();case 4:n.cargarTurno(),n.$notify("Se actualizó la fecha fin de todos los registros satisfactoriamente","success"),n.formEditarEnBloque.FECFIN=null,n.modalEditarEnBloque=!1;case 5:return o.a(2)}},o)}))()},getPrimerCursoDisponible:function(){var n=this;this.$http.get("api/CtCursoPeriodoController/getPrimerCursoDisponible").then(function(o){var e=O()({},n.form);if(o&&o.FECINI){var a=new Date(o.FECINI),t=new Date(a.getTime()-864e5*n.diasComienzo),r=new Date(a.getTime()+2592e6);new Date>t&&(t=new Date),t.setHours(n.horaInicioInscripcion),e.FECINI=t.toISOString(),e.FECFIN=r,n.form=e,n.fechaTurnoFin=r}else n.fechaTurnoFin=new Date(n.fechaTurno.getTime()+2592e6)})},onloadTablaSalon:function(){this.$refs.tablaSalon.reset=!1,this.cambiaFechaInicio()},cambiarPeriodo:function(){var n=this;return C()(I()().m(function o(){return I()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,n.init();case 1:return o.a(2)}},o)}))()},abrirModal:function(){var n=this;return C()(I()().m(function o(){return I()().w(function(o){while(1)switch(o.n){case 0:n.modalTurno=!0;case 1:return o.a(2)}},o)}))()},abrirEditarEnBloqueModal:function(){var n=this;return C()(I()().m(function o(){return I()().w(function(o){while(1)switch(o.n){case 0:n.modalEditarEnBloque=!0;case 1:return o.a(2)}},o)}))()},borrarTodos:function(){var n=this;this.$confirm("¿Está seguro(a) de borrar todo el cronograma de este periodo? (Este proceso es irreversible). ","warning").onOk(C()(I()().m(function o(){return I()().w(function(o){while(1)switch(o.n){case 0:n.$http.post("api/InscripcionController/borrarCronograma",{duracod:n.duracod,idTurnoTipo:n.tabModel}).then(function(){var o=C()(I()().m(function o(e){return I()().w(function(o){while(1)switch(o.n){case 0:return n.$notify(e.message,"success"),o.n=1,n.getCtTurno();case 1:n.cargarTurno(),n.filtrarDataAdd();case 2:return o.a(2)}},o)}));return function(n){return o.apply(this,arguments)}}()).catch(function(o){n.$notify("No se realizó la anulación","warning")});case 1:return o.a(2)}},o)})))},getDuracodActivo:function(){var n=this;return this.$http.get("api/InscripcionController/getPeriodo",{params:{activo:0}}).then(function(o){n.optPeriodo=o;var e=o.find(function(n){return"S"===n.VIGENTE});n.duracod=e.DURACOD,n.durades=e.DURADES})},filtrarDataAdd:function(){var n=this,o=this.optionTipo.find(function(o){return o.ID_TURNOTIPO===n.form.ID_TURNOTIPO}),e=this.clonData[o.TIPO].filter(function(e){return!n.turnosConfigurados[o.TIPO].includes(e[o.TIPO])});this.dataTurnoAdd=t()(e)},getSalones:function(){var n=this;return R.$http.get("api/salonController/getSalones",{params:{anio:this.sie.ano}}).then(function(o){n.clonData.NGS=t()(o),n.clonData.NEMO=t()(o),n.configTurno.VALOR.options=o})},getPosiblesInscritosPorNG:function(){var n=this,o={ano:this.sie.ano,duracod:this.duracod};return R.$http.get("api/CtCursoPeriodoController/getPosiblesInscritosPorNG",{params:{params:o}}).then(function(o){var e={};o.map(function(n){e[n.ID_CURSO_PERIODO]=n.TOTAL}),n.cantidadPosiblePorCurso=e})},getCtTurno:function(){var n=this,o={columnas:["ID_TURNOTIPO","VALOR","FECINI","FECFIN","ANO","PERIODO","NOMBRETIPO","TIPO"],where:{periodo:this.duracod,"t1.id_turnotipo":this.tabModel,ano:this.sie.ano},order:{sidx:"FECINI",sord:"asc"}};return R.$http.get("api/CtTurnoController/getCtTurno",{params:{params:o}}).then(function(o){var e={NGS:[],ID_CURSO_PERIODO:[]},a=null;return n.CtTurno=o.map(function(o){var t,r;return o.CURSO="".concat((null===(t=n.objCursos[o.VALOR])||void 0===t?void 0:t.CURSOCOD)||""," - ").concat((null===(r=n.objCursos[o.VALOR])||void 0===r?void 0:r.CURSODES)||""),Object.hasOwnProperty.call(e,o.TIPO)||(e[o.TIPO]=[]),o.VALOR="ID_CURSO_PERIODO"===o.TIPO?Number(o.VALOR):o.VALOR,e[o.TIPO].push(o.VALOR),a=new Date(o.FECFIN),a>n.fechaTurno&&(n.fechaTurno=a),"ID_CURSO_PERIODO"===o.TIPO&&n.objCursos[o.VALOR]&&(o.DISPONIBLES=n.objCursos[o.VALOR].DISPONIBLES,o.VACANTES=n.objCursos[o.VALOR].VACANTES),o}),a&&(n.form.FECINI=a.toISOString(),n.limpiarVariablesCalculoFecha()),n.turnosConfigurados=e,1})},cargarTurno:function(){var n=this,o=this.optionTipo.find(function(o){return o.ID_TURNOTIPO===n.form.ID_TURNOTIPO}),e=this.CtTurno.filter(function(n){return n.ID_TURNOTIPO===o.ID_TURNOTIPO});this.dataTurno=e},cambiarTipo:function(n){},actualizarTurno:function(n,o){var e=this;if(n.FECINI&&(n.FECINI=new Date(n.FECINI)),n.FECFIN&&(n.FECFIN=new Date(n.FECFIN)),n.FECINI>=n.FECFIN)return this.$notify("La fecha de inicio no puede ser menor a igual a la fecha fin","warning");R.$http.post("api/CtTurnoController/updateCtTurno",{data:n,id:o}).then(function(n){e.modalTurno=!1,e.$notify(n.message,"success"),e.cargarTurno(),e.filtrarDataAdd()}).catch(function(n){e.$notify(n.message,"warning")})},eliminarTurno:function(n,o){var e=this,a={id_turnotipo:n,valor:o};R.$http.delete("api/CtTurnoController/deleteCtTurno",{params:{id:a}}).then(function(){var n=C()(I()().m(function n(o){return I()().w(function(n){while(1)switch(n.n){case 0:return e.modalTurno=!1,e.$notify(o.message,"success"),n.n=1,e.getCtTurno();case 1:e.cargarTurno(),e.filtrarDataAdd();case 2:return n.a(2)}},n)}));return function(o){return n.apply(this,arguments)}}()).catch(function(n){e.$notify(n.message,"warning")})},agregarTurno:function(n){var o=this;return C()(I()().m(function n(){var e,a,r,i;return I()().w(function(n){while(1)switch(n.n){case 0:if(e=t()(o.$refs.tablaSalon.rowsSelected()),a=o.optionTipo.find(function(n){return n.ID_TURNOTIPO===o.form.ID_TURNOTIPO}),a){n.n=1;break}return n.a(2,o.$notify("No se encuentra la configuracion del tipo de cronograma","warning"));case 1:if(r=!1,i=e.map(function(n){return new Date(n.FECINI)>=new Date(n.FECFIN)&&(r=!0),{ID_TURNOTIPO:o.form.ID_TURNOTIPO,VALOR:n[a.TIPO],FECINI:new Date(n.FECINI),FECFIN:new Date(n.FECFIN),ANO:o.sie.ano,PERIODO:o.duracod,USUCOD:o.sie.usucod}}).filter(function(n){return n.VALOR}),i.length){n.n=2;break}return n.a(2,o.$notify("Marque el horario a guardar","info"));case 2:if(!r){n.n=3;break}return n.a(2,o.$notify("La fecha de inicio no puede ser menor a igual a la fecha fin","warning"));case 3:R.$http.post("api/CtTurnoController/addCtTurno",{data:i}).then(function(){var n=C()(I()().m(function n(e){return I()().w(function(n){while(1)switch(n.n){case 0:return o.modalTurno=!1,o.$notify(e.message,"success"),n.n=1,o.getCtTurno();case 1:o.cargarTurno(),o.filtrarDataAdd();case 2:return n.a(2)}},n)}));return function(o){return n.apply(this,arguments)}}()).catch(function(n){o.$notify(n.message,"warning")});case 4:return n.a(2)}},n)}))()},onGridReady:function(n){this.api=n.api},cargarColumns:function(n){this.columnsAddTurno=t()(this.columns[n])},cargarCursos:function(){var n=this;return C()(I()().m(function o(){var e,a,r;return I()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,n.getCursoPeriodo();case 1:return e=o.v,a={},r=[],e=e.map(function(o){return a[o.ID_CURSO_PERIODO]=o,o.ALUMNOS=n.cantidadPosiblePorCurso[o.ID_CURSO_PERIODO]||0,o}).filter(function(n){if(!r.includes(n.ID_CURSO_PERIODO))return r.push(n.ID_CURSO_PERIODO)}),n.objCursos=a,n.clonData.ID_CURSO_PERIODO=t()(e),n.configTurno.VALOR.options=e,o.a(2,1)}},o)}))()},cargarCombos:function(n){var o=this;return C()(I()().m(function e(){var a,r,i;return I()().w(function(e){while(1)switch(e.n){case 0:return a=n.TIPO,r=n.TIPODES,i=o.clonData[a],o.configTurno.VALOR.optionLabel=r,o.configTurno.VALOR.optionValue=a,o.configTurno.VALOR.options=t()(i),e.a(2,1)}},e)}))()},cambiarTab:function(n){var o=this;return C()(I()().m(function e(){var a;return I()().w(function(e){while(1)switch(e.n){case 0:return e.n=1,o.cambiarPeriodo();case 1:o.form.ID_TURNOTIPO=n,a=o.optionTipo.find(function(o){return o.ID_TURNOTIPO===n}),o.cargarColumns(a.TIPO),o.cargarCombos(a),o.cargarTurno(n),o.filtrarDataAdd();case 2:return e.a(2)}},e)}))()},pase:function(){document.getElementById("tab-page").click()},init:function(){var n=this;return C()(I()().m(function o(){return I()().w(function(o){while(1)switch(o.n){case 0:if(1!==n.tabModel){o.n=1;break}o.n=2;break;case 1:return o.n=2,n.cargarCursos();case 2:return o.n=3,n.getCtTurno();case 3:return o.a(2)}},o)}))()}},created:function(){var n=this;return C()(I()().m(function o(){return I()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,n.getDuracodActivo();case 1:return o.n=2,n.getSalones();case 2:n.cambiarTab(n.form.ID_TURNOTIPO),n.dataTurno.length;case 3:return o.a(2)}},o)}))()}},y=e(12807);const B=(0,y.A)(L,[["render",m]]);var M=B}}]);