"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[6924],{6924:function(e,n,o){o.r(n),o.d(n,{default:function(){return j}});var t=o(8445),a=o.n(t),i=(o(56285),o(61758)),l=o(58790),s={class:"row q-ma-sm"},r={class:"row col q-col-gutter-sm"},u={class:"q-card"},c={class:"row"},d={class:"row q-mx-sm"},f={class:"row q-pa-xs q-mx-sm",style:{border:"1px solid black !important","border-radius":"3px"}},m={style:{"font-size":"0.8rem"}},p={class:"row"},h={class:"row q-ma-sm"},g={class:"q-card"},b={key:0},v={key:0,class:"row justify-center"},O={class:"column justify-center"},S={class:"text-bold",style:{"font-size":"12px"}},E={class:"text-bold",style:{"font-size":"12px"}},D={style:{"font-size":"12px"}},A={class:"row"},T={class:"row"};function C(e,n){var o=this,t=(0,i.g2)("header-btn"),C=(0,i.g2)("q-input"),k=(0,i.g2)("sie-salones"),F=(0,i.g2)("sie-table"),I=(0,i.g2)("sie-modal"),w=(0,i.g2)("q-select"),y=(0,i.g2)("q-checkbox"),N=(0,i.g2)("q-search"),L=(0,i.g2)("q-datetime"),V=(0,i.g2)("q-th"),_=(0,i.g2)("q-icon"),q=(0,i.g2)("q-tr"),M=(0,i.g2)("q-td"),R=(0,i.g2)("q-tooltip"),H=(0,i.g2)("q-btn"),x=(0,i.g2)("q-item-separator"),U=(0,i.g2)("q-popup-edit"),Q=(0,i.g2)("q-table"),G=(0,i.g2)("q-page");return(0,i.uX)(),(0,i.Wv)(G,null,{default:(0,i.k6)(function(){return[(0,i.bF)(t,{name:"Consulta de Asistencias",buttons:e.buttons},null,8,["buttons"]),(0,i.bF)(I,{modelValue:e.modalSeguimiento,"onUpdate:modelValue":n[3]||(n[3]=function(n){return e.modalSeguimiento=n}),title:"Seguimiento de envios"},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",s,[(0,i.Lk)("div",r,[(0,i.bF)(C,{class:"col",modelValue:e.paramsSeguimiento.fecIni,"onUpdate:modelValue":n[0]||(n[0]=function(n){return e.paramsSeguimiento.fecIni=n}),label:"Desde",type:"date",onInput:e.listarSeguimiento},null,8,["modelValue","onInput"]),(0,i.bF)(C,{class:"col",modelValue:e.paramsSeguimiento.fecFin,"onUpdate:modelValue":n[1]||(n[1]=function(n){return e.paramsSeguimiento.fecFin=n}),label:"Hasta",type:"date",onInput:e.listarSeguimiento},null,8,["modelValue","onInput"])])]),(0,i.bF)(k,{class:"col no-border",modelValue:e.nemoFiltro,"onUpdate:modelValue":n[2]||(n[2]=function(n){return e.nemoFiltro=n}),todos:!0,campos:["NEMO","NEMODES","INSTRUCOD","GRADOCOD","SECCIONCOD"],onSeleccionar:e.filtrarData},null,8,["modelValue","onSeleccionar"]),(0,i.bF)(F,{class:"q-card q-ma-sm col",ref:"tablaNotificacionesSeguimiento",context:o,dense:"",flat:"",bordered:"","wrap-cells":"",menu:!1,css:"height: calc(100vh - 400px); width: 100%; margin: 0;",columns:e.columnsSeguimiento,data:e.infoSeguimiento,"show-refresh":!0,onRefresh:e.listarSeguimiento,config:e.configSeguimiento},null,8,["columns","data","onRefresh","config"])]}),_:1},8,["modelValue"]),(0,i.Lk)("div",u,[(0,i.Lk)("div",c,[(0,i.bF)(k,{class:"col no-border",modelValue:e.nemo,"onUpdate:modelValue":n[4]||(n[4]=function(n){return e.nemo=n}),onSeleccionar:e.loadEstudiantes,label:e.$t("salon"),campos:["NEMO","NEMODES","INSTRUCOD","GRADOCOD","SECCIONCOD"],todos:!1},null,8,["modelValue","onSeleccionar","label"])]),(0,i.Lk)("div",d,[(0,i.bF)(w,{class:"q-if-outlined col",options:e.niveles,modelValue:e.instrucod,"onUpdate:modelValue":n[5]||(n[5]=function(n){return e.instrucod=n}),"float-label":"Nivel",onInput:n[6]||(n[6]=function(n){return e.tipBusqueda(2)})},null,8,["options","modelValue"]),(0,i.bF)(w,{class:"q-if-outlined col",options:e.grados,modelValue:e.gradocod,"onUpdate:modelValue":n[7]||(n[7]=function(n){return e.gradocod=n}),"float-label":"Grado",onInput:n[8]||(n[8]=function(n){return e.tipBusqueda(2)})},null,8,["options","modelValue"]),(0,i.bF)(w,{class:"q-if-outlined col",options:e.secciones,modelValue:e.seccioncod,"onUpdate:modelValue":n[9]||(n[9]=function(n){return e.seccioncod=n}),"float-label":"Sección",onInput:e.filtrar},null,8,["options","modelValue","onInput"])]),(0,i.Lk)("fieldset",f,[(0,i.Lk)("legend",m,[(0,i.Lk)("span",null,(0,l.v_)(e.$t("Estados"))+" :",1)]),(0,i.Lk)("div",p,[(0,i.bF)(y,{class:"q-px-xs q-mx-xs",modelValue:e.todos,"onUpdate:modelValue":n[10]||(n[10]=function(n){return e.todos=n}),label:e.$t("todos"),color:"secondary",onInput:e.marcarTodosFiltro,style:{border:"1px solid black !important","border-radius":"3px"}},null,8,["modelValue","label","onInput"])]),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.estados,function(o){return(0,i.uX)(),(0,i.CE)(i.FK,null,["NULO"!==o.ESTADOCOD?((0,i.uX)(),(0,i.Wv)(y,{key:0,class:"q-px-xs q-mx-xs",label:o.ESTADOETI,modelValue:e.estadoSelect,"onUpdate:modelValue":n[11]||(n[11]=function(n){return e.estadoSelect=n}),val:o.ESTADOCOD,color:"secondary",style:(0,l.Tr)([{border:"1px solid black !important","border-radius":"3px"},{color:o.COLORHEXT,"background-color":o.COLORHEXF}]),onInput:e.cargaInicial},null,8,["label","modelValue","val","style","onInput"])):(0,i.Q3)("v-if",!0)],64)}),256))]),(0,i.Lk)("div",h,[(0,i.bF)(N,{class:"q-if-outlined col-12 col-sm",modelValue:e.filtro,"onUpdate:modelValue":n[12]||(n[12]=function(n){return e.filtro=n}),"float-label":"Alumno"},null,8,["modelValue"]),(0,i.bF)(L,{class:"q-if-outlined",modelValue:e.fecIni,"onUpdate:modelValue":n[13]||(n[13]=function(n){return e.fecIni=n}),type:"date",format:"DD/MM/YYYY","float-label":e.$t("fechainicio"),onInput:e.cargaInicial},null,8,["modelValue","float-label","onInput"]),(0,i.bF)(L,{class:"q-if-outlined",modelValue:e.fecFin,"onUpdate:modelValue":n[14]||(n[14]=function(n){return e.fecFin=n}),type:"date",format:"DD/MM/YYYY","float-label":e.$t("fechafin"),onInput:e.cargaInicial},null,8,["modelValue","float-label","onInput"])])]),(0,i.Lk)("div",g,[(0,i.bF)(Q,{data:e.dataAsistencias,columns:e.columns,"row-key":"ID_CONTROL",filter:e.filtro,style:(0,l.Tr)({"max-height":e.alto}),selected:e.seleccionados,"onUpdate:selected":n[15]||(n[15]=function(n){return e.seleccionados=n}),selection:"multiple"},{header:(0,i.k6)(function(e){return[(0,i.bF)(q,{props:e},{default:(0,i.k6)(function(){return[(0,i.bF)(V,null,{default:(0,i.k6)(function(){return[e.multipleSelect?((0,i.uX)(),(0,i.Wv)(y,{key:0,modelValue:e.selected,"onUpdate:modelValue":function(n){return e.selected=n},"indeterminate-value":"some"},null,8,["modelValue","onUpdate:modelValue"])):(0,i.Q3)("v-if",!0)]}),_:2},1024),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.cols,function(o){return(0,i.uX)(),(0,i.Wv)(V,{key:o.name,props:e},{default:(0,i.k6)(function(){return[o.coment?((0,i.uX)(),(0,i.Wv)(_,{key:1,name:"comment "},{default:(0,i.k6)(function(){return a()(n[16]||(n[16]=[(0,i.eW)("otro",-1)]))}),_:1})):((0,i.uX)(),(0,i.CE)("span",b,(0,l.v_)(o.label),1))]}),_:2},1032,["props"])}),128))]}),_:2},1032,["props"])]}),"body-cell-FH_INGRESO":(0,i.k6)(function(n){return[(0,i.bF)(M,{props:n},{default:(0,i.k6)(function(){return[(0,i.eW)((0,l.v_)(e.date(n.row.FH_INGRESO,"hh:mm A")),1)]}),_:2},1032,["props"])]}),"body-cell-FH_SALIDA":(0,i.k6)(function(o){return[(0,i.bF)(M,{props:o},{default:(0,i.k6)(function(){return[o.row.FH_SALIDA?((0,i.uX)(),(0,i.CE)("div",v,[(0,i.Lk)("div",O,[(0,i.Lk)("span",null,(0,l.v_)(e.date(o.row.FH_SALIDA,"hh:mm A")),1)]),e.nivel?((0,i.uX)(),(0,i.Wv)(H,{key:0,icon:"delete",flat:"",dense:"",round:"",onClick:function(n){return e.eliminarSalida(o.row)}},{default:(0,i.k6)(function(){return[(0,i.bF)(R,null,{default:(0,i.k6)(function(){return a()(n[17]||(n[17]=[(0,i.Lk)("span",null,"Eliminar salida",-1)]))}),_:1})]}),_:1},8,["onClick"])):(0,i.Q3)("v-if",!0)])):(0,i.Q3)("v-if",!0)]}),_:2},1032,["props"])]}),"body-cell-FECHA":(0,i.k6)(function(n){return[(0,i.bF)(M,{props:n},{default:(0,i.k6)(function(){return[(0,i.eW)((0,l.v_)(e.date(n.row.FECHA,"DD/MM/YYYY")),1)]}),_:2},1032,["props"])]}),"body-cell-SEND":(0,i.k6)(function(n){return[(0,i.bF)(M,{props:n},{default:(0,i.k6)(function(){return[0===e.seleccionados.length||1===e.seleccionados.length&&e.seleccionados[0]===n.row?((0,i.uX)(),(0,i.Wv)(H,{key:0,flat:"",dense:"",round:"",icon:"send",onClick:function(o){return e.enviarUnico(n.row)}},null,8,["onClick"])):(0,i.Q3)("v-if",!0)]}),_:2},1032,["props"])]}),"body-cell-ESTADO":(0,i.k6)(function(e){return[(0,i.bF)(M,{props:e,style:(0,l.Tr)({"background-color":e.row.COLORHEXF,color:e.row.COLORHEXT})},{default:(0,i.k6)(function(){return[(0,i.Lk)("span",null,(0,l.v_)(e.row.ESTADODES),1)]}),_:2},1032,["props","style"])]}),"body-cell-COMENTARIO":(0,i.k6)(function(o){return[(0,i.bF)(M,{props:o},{default:(0,i.k6)(function(){return[(0,i.bF)(_,{name:"comment",color:o.row.TEXTO&&o.row.TEXTO.length>0?"secondary":"light",style:{"font-size":"15px"}},{default:(0,i.k6)(function(){return[o.row.TEXTO&&o.row.TEXTO.length>0?((0,i.uX)(),(0,i.Wv)(U,{key:0,modelValue:o.row.TEXTO,"onUpdate:modelValue":function(e){return o.row.TEXTO=e}},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",S,(0,l.v_)(o.row.NOMCOMP),1),(0,i.Lk)("div",E,(0,l.v_)(e.date(o.row.FECHA,"DD/MM")),1),(0,i.bF)(x),n[18]||(n[18]=(0,i.Lk)("div",{class:"text-bold",style:{"font-size":"12px"}},"Comentario:",-1)),(0,i.Lk)("span",D,(0,l.v_)(o.row.TEXTO),1)]}),_:2},1032,["modelValue","onUpdate:modelValue"])):(0,i.Q3)("v-if",!0)]}),_:2},1032,["color"])]}),_:2},1032,["props"])]}),"body-cell-INFO":(0,i.k6)(function(o){return[(0,i.bF)(M,{props:o},{default:(0,i.k6)(function(){return[(0,i.bF)(_,{class:"text-bold",name:"info_outline"}),(0,i.bF)(R,{class:"column"},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",A,[n[19]||(n[19]=(0,i.Lk)("span",{class:"text-bold"},"Usuario:  ",-1)),(0,i.Lk)("span",null,(0,l.v_)(o.row.USUNOM),1)]),(0,i.Lk)("div",T,[n[20]||(n[20]=(0,i.Lk)("span",{class:"text-bold"},"F. Registro:  ",-1)),(0,i.Lk)("span",null,(0,l.v_)(e.date(o.row.FECREG,"DD/MM/YYYY hh:mm A")),1)])]}),_:2},1024)]}),_:2},1032,["props"])]}),_:1},8,["data","columns","filter","style","selected"])])]}),_:1})}var k=o(76080),F=o.n(k),I=o(45254),w=o.n(I),y=(o(30683),o(23825),o(10239),o(50310),o(90095),o(83190),o(27153),o(66307),o(13715),o(24066),o(6123)),N=o(30545),L=o(80660),V=o(57668),_=o(80340),q=o(88275),M=o(9736),R=o(33001),H=o(33777),x=o(69027),U=o(30640),Q=o(93616),G=o(24974),X=o(18105),$=o(982),Y=o(13813),B={components:{QSelect:y.Si,sieUsuario:G.A,sieModal:U.A,sieVacio:_.A,QToggle:y.c5,QCheckbox:y.vZ,QBtnToggle:y.QL,sieSelect:Q.A,QRadio:y.$,QTabs:y.uw,QTab:y.zu,QTabPane:y.dg,sieSalones:q.Ay,QDatetime:y.T5,QTable:N.A,QTh:y.EJ,QTr:y.qh,QTd:y.Ef,QPageSticky:y._U,QFab:y.l6,QFabAction:y.B$,QPopupEdit:y.GT,QInput:M.A,SieTable:H.A,QPage:y.Tu,QSearch:y.Ks,QIcon:y.bP,QBtn:y.Il,QTooltip:y.nC,QItemSeparator:y.CL},data:function(){return{now:new Date,fecIni:new Date,fecFin:new Date,sie:(0,V["default"])(),nivel:3===(0,V["default"])().ruta.nivel,estados:[],estadoSelect:[],cargando:!1,nemo:null,baseGrados:{},modoBusqueda:2,instrucod:"T",gradocod:"T",seccioncod:"T",todos:!1,filtro:null,dataAsistenciasBase:[],dataAsistencias:[],modalSeguimiento:!1,paramsSeguimiento:{fecIni:null,fecFin:null,ID:0},alto:0,nemoFiltro:"T",seleccionados:[],infoSeguimientoBase:[],infoSeguimiento:[],configSeguimiento:{DETALLE:{renderHtml:function(e){var n="";return e.DETALLE.forEach(function(e){n="".concat(n,' <div style="color:').concat(e.COLORHEXT,";background-color:").concat(e.COLORHEXF,';width: 100%;margin: 2px 0px;border-radius: 10px;border-style: solid;border-width: 1px;"><span>').concat((0,X.Ay)(e.FECHA,"DD/MM"),"</span></div>")}),n}},ACCION:{flat:!0,round:!0,component:"button",icon:["send as reenviar"],reenviar:function(e){var n=this;return w()(F()().m(function o(){var t;return F()().w(function(o){while(1)switch(o.p=o.n){case 0:return o.n=1,n.$confirmar("¿Está seguro de reenviar este mensaje?");case 1:if(t=o.v,!t){o.n=5;break}return o.p=2,o.n=3,n.$http.post("api/AsistenciaNotificacionController/reenviarMensaje",{params:e});case 3:n.listarSeguimiento(),o.n=5;break;case 4:o.p=4,o.v,n.$notify("No se pudo enviar el mensaje","error");case 5:return o.a(2)}},o,null,[[2,4]])}))()}}},columnsSeguimiento:[{name:"FH_REGISTRO",field:"FH_REGISTRO",align:"left",label:"Enviado"},{name:"NOMCOMP",field:"NOMCOMP",align:"left",label:"Alumno"},{name:"NEMODES",field:"NEMODES",align:"left",label:"Aula"},{name:"DETALLE",field:"DETALLE",align:"center",label:"Fechas"},{name:"ASUNTO",field:"ASUNTO",align:"center",label:"Asunto"},{name:"ACCION",field:"ACCION",align:"center"}],columns:[{name:"NOMCOMP",field:"NOMCOMP",align:"left",label:this.$t("estudiante")},{name:"FECHA",field:"FECHA",align:"left",label:this.$t("fecha")},{name:"NEMODES",field:"NEMODES",align:"left",label:this.$t("aula")},{name:"COMENTARIO",field:"COMENTARIO",align:"center",coment:!0},{name:"ESTADO",field:"ESTADO",align:"center",label:this.$t("estado")}]}},methods:{date:X.Ay,filtrarData:function(){var e=a()(this.infoSeguimientoBase);"T"!==this.nemoFiltro&&(e=(0,R.filterArray)(this.nemoFiltro,{field:"NEMO",list:e})||[]),this.infoSeguimiento=e},handleResize:function(){var e=300;this.alto=window.innerHeight-e+"px"},sendAlertas:function(){var e=this;this.seleccionados.length>0?(0,x.dialogConfirm)({title:"Atención",message:"¿Desea enviar la(s) alerta(s) seleccionada(s)",cancel:"No",confirm:"Si"}).then(function(n){if(n){var o=(0,Y["default"])(e.seleccionados,function(e){var n=e.ALUCOD,o=e.FECHA;return{alucods:[n],fecha:o,reenvio:"S"}});L.$http.post("api/HyoHorasis/sendAlertasMultiples",{datos:o}).then(function(n){var o=n.json;(0,$["default"])(o.message,o.type),o.type||(e.seleccionados=[])})}}):(0,$["default"])("Debe seleccionar mas de un estudiante")},loadEstudiantes:function(e){var n=e.INSTRUCOD,o=e.GRADOCOD,t=e.SECCIONCOD;this.modoBusqueda=1,this.instrucod=n,this.gradocod=o,this.seccioncod=t,this.filtrar()},tipBusqueda:function(e){this.modoBusqueda=e},filtrar:function(){var e=this;this.dataAsistencias=[],this.dataAsistenciasBase.forEach(function(n){var o=!0;1===e.modoBusqueda?n.NEMO!==e.nemo&&(o=!1):"T"!==e.instrucod&&(n.INSTRUCOD!==e.instrucod||"T"!==e.gradocod&&(n.GRADOCOD!==e.gradocod||"T"!==e.seccioncod&&n.SECCIONCOD!==e.seccioncod))&&(o=!1),o&&e.dataAsistencias.push(n)})},cargaInicial:function(){var e=this,n={fecIni:this.fecIni,fecFin:this.fecFin,estados:this.estadoSelect};L.$http.get("api/HyoHorasis/obtInfoAsistencia",{params:n}).then(function(n){var o=n.json;e.dataAsistenciasBase=o,e.filtrar()})},marcarTodosFiltro:function(e){var n=this;this.todos=e,e?this.estados.forEach(function(e){n.estadoSelect.indexOf(e.ESTADOCOD)<0&&n.estadoSelect.push(e.ESTADOCOD)}):this.estadoSelect=[]},eliminarSalida:function(e){var n=this;return w()(F()().m(function o(){var t;return F()().w(function(o){while(1)switch(o.p=o.n){case 0:return o.n=1,n.$confirmar("¿Está seguro de eliminar la salida del estudiante?");case 1:if(t=o.v,!t){o.n=5;break}return o.p=2,o.n=3,n.$http.post("api/HorasisController/eliminarSalida",{params:e});case 3:n.cargaInicial(),n.$notify("Eliminado correctamente"),o.n=5;break;case 4:o.p=4,o.v,n.$notify("No se pudo eliminar la salida, intente nuevamente.","error");case 5:return o.a(2)}},o,null,[[2,4]])}))()},showSeguimiento:function(){var e=this;return w()(F()().m(function n(){return F()().w(function(n){while(1)switch(n.n){case 0:e.paramsSeguimiento.fecIni=(0,X.Ay)(e.fecIni,"YYYY-MM-DD"),e.paramsSeguimiento.fecFin=(0,X.Ay)(e.fecFin,"YYYY-MM-DD"),e.listarSeguimiento(),e.modalSeguimiento=!0;case 1:return n.a(2)}},n)}))()},listarSeguimiento:function(){var e=this;return w()(F()().m(function n(){return F()().w(function(n){while(1)switch(n.n){case 0:return n.n=1,e.$http.get("api/AsistenciaNotificacionController/getSeguimiento",{params:{params:e.paramsSeguimiento}});case 1:e.infoSeguimientoBase=n.v,e.filtrarData();case 2:return n.a(2)}},n)}))()}},unmounted:function(){window.removeEventListener("resize",this.handleResize)},computed:{buttons:function(){var e=[{label:"Seguimiento",icon:"remove_red_eye",click:this.showSeguimiento}];return this.seleccionados.length>0&&e.push({label:"Enviar",icon:"send",click:this.sendAlertas}),e},niveles:function(){var e=[{label:"Todos",value:"T"}];return this.baseGrados.niveles&&this.baseGrados.niveles.length>0&&this.baseGrados.niveles.forEach(function(n){e.push({value:n.INSTRUCOD,label:n.INSTRUDES})}),e},grados:function(){var e=[{label:"Todos",value:"T"}];return"T"!==this.instrucod&&this.baseGrados.grados&&this.baseGrados.grados[this.instrucod].length>0&&this.baseGrados.grados[this.instrucod].forEach(function(n){e.push({value:n.GRADOCOD,label:n.GRADODES})}),e},secciones:function(){var e=[{label:"Todos",value:"T"}];return"T"===this.gradocod&&(this.seccioncod="T"),"T"!==this.instrucod&&"T"!==this.gradocod&&this.baseGrados.secciones&&this.baseGrados.secciones[this.instrucod+this.gradocod].length>0&&this.baseGrados.secciones[this.instrucod+this.gradocod].forEach(function(n){e.push({value:n.SECCIONCOD,label:n.SECCIONCOD})}),this.filtrar(),e}},watch:{},created:function(){var e=this;window.addEventListener("resize",this.handleResize),console.log((0,V["default"])()),this.handleResize(),Promise.all([L.$http.get("api/HyoConfigurajustificaciones/getJustificaciones",{params:{agrupado:!0}}),L.$http.get("api/HyoHorasis/isSalida")]).then(function(n){n[0]["VER_AUDITORIA"]&&(n[1].json&&(e.columns.push({name:"FH_INGRESO",field:"FH_INGRESO",align:"center",label:"Ingreso"}),e.columns.push({name:"FH_SALIDA",field:"FH_SALIDA",align:"center",label:"Salida"})),e.columns.push({name:"INFO",field:"INFO",align:"center"})),console.log()}),L.$http.get("api/HyoConfigurajustificaciones/getJustificaciones",{params:{agrupado:!0}}).then(function(e){}),L.$http.get("api/HyoHorasisEstado/listarHorasisEstado",{params:{momento:1}}).then(function(n){var o=n.json;e.estados=o,o.forEach(function(n){"P"!==n.ESTADOCOD&&e.estadoSelect.push(n.ESTADOCOD)}),e.cargaInicial()}),L.$http.get("api/HyoInstrus/obtGradosAsignadosTutor").then(function(n){e.baseGrados=n})}},z=o(12807);const P=(0,z.A)(B,[["render",C]]);var j=P}}]);