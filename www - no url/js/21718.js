"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[21718],{21718:function(e,o,r){r.r(o),r.d(o,{default:function(){return N}});var n=r(61758),a=r(29104),t={class:"row q-col-gutter-sm"},l={class:"col-xs-12 col-sm-6 col-md-4 col-lg-3 col-xl-2"},i={class:"col-xs-12 col-sm-6 col-md-4 col-lg-3 col-xl-2"},c={class:"col-xs-12 col-sm-6 col-md-4 col-lg-3 col-xl-2"},s={class:"col-xs-12 col-sm-6 col-md-4 col-lg-3 col-xl-2"},u={class:"col-xs-12 col-sm-6 col-md-4 col-lg-3 col-xl-2"},d={class:"col-xs-12 sie-flat"};function p(e,o){var r=this,p=(0,n.g2)("header-btn"),m=(0,n.g2)("sie-select"),f=(0,n.g2)("q-spinner-facebook"),v=(0,n.g2)("q-card-section"),b=(0,n.g2)("q-card"),h=(0,n.g2)("sie-table"),g=(0,n.g2)("sie-upload"),P=(0,n.g2)("sie-modal"),w=(0,n.g2)("q-page");return(0,n.uX)(),(0,n.Wv)(w,{class:"talleres--inscripcion-bloque sie-flat bg-white q-pa-sm"},{default:(0,n.k6)(function(){return[(0,n.bF)(b,{class:"layout-v1 my-card",flat:"",bordered:""},{default:(0,n.k6)(function(){return[(0,n.bF)(p,{name:"Inscripción en bloque",buttons:e.buttons},null,8,["buttons"]),(0,n.bF)(v,null,{default:(0,n.k6)(function(){return[(0,n.Lk)("div",t,[(0,n.Lk)("div",l,[(0,n.bF)(m,{type:"outlined",modelValue:e.duracod,"onUpdate:modelValue":o[0]||(o[0]=function(o){return e.duracod=o}),val:"DURACOD",label:"DURADES",options:e.optPeriodo,readonly:!1,placeholder:"Periodo",onInput:o[1]||(o[1]=function(o){return e.cambiarPeriodo(1)})},null,8,["modelValue","options"])]),(0,n.Lk)("div",i,[(0,n.bF)(m,{type:"outlined",modelValue:e.idPrograma,"onUpdate:modelValue":o[2]||(o[2]=function(o){return e.idPrograma=o}),val:"TIPOCOD",label:"TIPODES",options:e.optPrograma,readonly:!1,placeholder:"Programa",onSelected:e.cambiarPrograma},null,8,["modelValue","options","onSelected"])]),(0,n.Lk)("div",c,[(0,n.bF)(m,{type:"outlined",modelValue:e.gruvacod,"onUpdate:modelValue":o[3]||(o[3]=function(o){return e.gruvacod=o}),val:"GRUVACOD",label:"GRUVADES",options:e.optGrupos,readonly:!1,placeholder:"Grupo",onSelected:e.cambiarGrupo},null,8,["modelValue","options","onSelected"])]),(0,n.Lk)("div",s,[(0,n.bF)(m,{type:"outlined",modelValue:e.idCursoPeriodo,"onUpdate:modelValue":o[4]||(o[4]=function(o){return e.idCursoPeriodo=o}),val:"ID_CURSO_PERIODO",label:"CURSODES",options:e.talleres,readonly:!1,placeholder:"Taller",onInput:e.getTurno},null,8,["modelValue","options","onInput"])]),(0,n.Lk)("div",u,[(0,n.bF)(m,{type:"outlined",modelValue:e.turno,"onUpdate:modelValue":o[5]||(o[5]=function(o){return e.turno=o}),val:"TURNO",label:"TURNO",options:e.turnos,readonly:!1,placeholder:"Turno"},null,8,["modelValue","options"])]),(0,n.Lk)("div",d,[(0,n.bo)((0,n.bF)(b,{class:"center my-card",flat:"",bordered:""},{default:(0,n.k6)(function(){return[(0,n.bF)(v,null,{default:(0,n.k6)(function(){return[(0,n.bF)(f,{color:"primary",size:"xl",thickness:5})]}),_:1})]}),_:1},512),[[a.aG,e.innerLoading]]),e.data.length&&!e.innerLoading?((0,n.uX)(),(0,n.Wv)(h,{key:0,class:"q-mt-xs",ref:"refTableInscripcionEnbloque",context:r,config:e.config,columns:e.fields,data:e.data,"show-search":!0,dense:"",flat:"",bordered:"","wrap-cells":"","load-selection":e.loadSelection,"load-disabled":e.loadDisable,selection:"multiple",css:"height: calc(100vh - 190px)"},null,8,["config","columns","data","load-selection","load-disabled"])):(0,n.Q3)("v-if",!0)])])]}),_:1})]}),_:1}),(0,n.bF)(P,{modelValue:e.modalImportarArchivo,"onUpdate:modelValue":o[6]||(o[6]=function(o){return e.modalImportarArchivo=o}),title:"Importar archivo",css:{"max-width":"800px"},ok:!1,footer:!1},{default:(0,n.k6)(function(){return[(0,n.bo)((0,n.bF)(g,{allow:["xlsx","xls"],onUpload:e.uploadExcel,ref:"upload"},null,8,["onUpload"]),[[a.aG,!0]])]}),_:1},8,["modelValue"]),(0,n.bF)(P,{modelValue:e.modalObservaciones,"onUpdate:modelValue":o[7]||(o[7]=function(o){return e.modalObservaciones=o}),title:"Observaciones",css:{"max-width":"800px"},ok:!1,footer:!1},{default:(0,n.k6)(function(){return[(0,n.bF)(h,{class:"q-ma-sm",ref:"refTableObservaciones",context:r,config:e.configObservaciones,columns:e.fieldsObservaciones,data:e.observaciones,"show-search":!0,"show-index":!0,dense:"",flat:"",bordered:"","wrap-cells":"",selection:"none",css:"height: calc(100vh - 160px)"},null,8,["config","columns","data"])]}),_:1},8,["modelValue"])]}),_:1})}var m=r(41562),f=r.n(m),v=r(76080),b=r.n(v),h=r(45254),g=r.n(h),P=(r(12563),r(30683),r(74260),r(39866),r(23825),r(52133),r(25751),r(50310),r(32203),r(6724),r(83190),r(62692),r(24066),r(93616)),w=r(59089),O=r(41482),C=r(6123),I=r(33950),D=r(57668),k=r(14667),S={data:function(){return{config:{ID_PERSONA:{renderHtml:function(e,o,r,n){return this.loadDisable.values.map(function(e){return e.ID_PERSONA}).includes(e.ID_PERSONA)?n["$$background"]="grey-4":n["$$background"]="white",o("span",{},e.ID_PERSONA)}}},data:[],fields:[{name:"ID_PERSONA",label:"ID",field:"ID_PERSONA",align:"center"},{name:"NOMCOMP",label:"Nombre completo",field:"NOMCOMP",align:"left",sortable:!0},{name:"TIPODOC",label:"Tipo documento",field:"TIPODOC",align:"left",sortable:!0},{name:"NUMDOC",label:"Número docuemento",field:"NUMDOC",align:"left",sortable:!0},{name:"CORREO",label:"Correo",field:"CORREO",align:"left",sortable:!0}],openModalCambiarHorario:!1,openModalCambiarHorarioFrec:!1,cursoCambioHorario:null,cursosCambioHorario:[]}},methods:{}},E={data:function(){return{configObservaciones:{},modalObservaciones:!1,observaciones:[],fieldsObservaciones:[{name:"NOMCOMP",label:"Nombre completo",field:"NOMCOMP",align:"left",wrap:!0,sortable:!0},{name:"MENSAJE",label:"Mensaje",field:"MENSAJE",align:"left",wrap:!0,sortable:!0}],openModalCambiarHorario:!1,openModalCambiarHorarioFrec:!1,cursoCambioHorario:null,cursosCambioHorario:[]}},methods:{}},x=r(37323),A={components:{sieSelect:P.A,SieUpload:w.A,QSpinner:O.A,QSpinnerOval:C.VA,QSpinnerGears:C.hV,QSpinnerFacebook:C.Pv,QPage:C.Tu,QCard:C.C$},mixins:[k.A,S,E],data:function(){var e=this;return{buttons:[{icon:"remove_red_eye",label:"Ver Observaciones",tooltip:"Ver Observaciones",permiso:">= 2",click:function(){e.openModalVerObservaciones()}},{icon:"cogs",label:"Procesar",tooltip:"Procesar Informacion",permiso:">= 2",click:function(){e.procesarInfo()}},{icon:"file_import",label:"Imp. Archivo",tooltip:"Importar Archivo",permiso:">= 2",click:function(){e.importFile()}},{icon:"import_export_excel",label:"Desc. Plantilla",tooltip:"Descargar Plantilla",permiso:">= 2",click:function(){e.exportarPlantilla()}}],sie:(0,D["default"])(),innerLoading:!1,optPeriodo:[],duracod:null,optPrograma:[],idPrograma:null,optGrupos:[],gruvacod:null,talleres:[],idCursoPeriodo:null,turnos:[],turno:null,modalImportarArchivo:!1,loadSelection:{key:"ID_PERSONA",values:[]},loadDisable:{key:"ID_PERSONA",values:[]},inscritos:[]}},methods:{uploadExcel:function(e){var o=this;return g()(b()().m(function r(){var n,a,t,l,i,c;return b()().w(function(r){while(1)switch(r.p=r.n){case 0:return n=e[0],r.p=1,o.modalImportarArchivo=!1,o.innerLoading=!0,o.data=[],r.n=2,(0,I.Upload)({url:"api/HyoArchivo/tmp/upload",file:n});case 2:return a=r.v,r.n=3,o.$http.post("api/InscripcionController/preImport",{pathFile:a});case 3:t=r.v,l=t.observaciones,i=t.data,o.data=i,o.observaciones=l,o.observaciones.length?o.modalObservaciones=!0:o.$notify("Se importaron los datos del archivo satisfactoriamente","success"),o.innerLoading=!1,r.n=5;break;case 4:r.p=4,c=r.v,console.log(c),o.innerLoading=!1;case 5:return r.a(2)}},r,null,[[1,4]])}))()},openModalVerObservaciones:function(){this.modalObservaciones=!0},inscripcionEnBloque:function(){var e=this;return g()(b()().m(function o(){var r,n,a,t,l;return b()().w(function(o){while(1)switch(o.p=o.n){case 0:return o.p=0,o.n=1,e.$http.post("api/InscripcionController/inscripcionEnBloque",{params:{data:e.loadSelection.values,idCursoPeriodo:e.idCursoPeriodo,turno:e.turno}});case 1:r=o.v,n=f()(r.observaciones);try{for(n.s();!(a=n.n()).done;)t=a.value,e.observaciones.map(function(e){return e.NUMDOC}).includes(t.NUMDOC)||(e.observaciones=e.observaciones.concat(r.observaciones))}catch(e){n.e(e)}finally{n.f()}return r.observaciones.length&&(e.loadDisable.values=r.observaciones,e.loadSelection.values=[],e.modalObservaciones=!0),e.inscritos=r.inscritos,e.inscritos.length&&(e.$notify("Proceso realizado satisfactoriamente","success"),e.data=[],e.observaciones=[]),o.a(2,r);case 2:o.p=2,l=o.v,e.$notify(l.message,"warning");case 3:return o.a(2)}},o,null,[[0,2]])}))()},procesarInfo:function(){var e=this;return g()(b()().m(function o(){var r;return b()().w(function(o){while(1)switch(o.p=o.n){case 0:if(o.p=0,e.loadSelection.values=e.$refs.refTableInscripcionEnbloque?e.$refs.refTableInscripcionEnbloque.selected:[],e.loadSelection.values.length){o.n=1;break}throw new Error("Por favor seleccione mínimo un registro para procesar la inscripción");case 1:if(e.idCursoPeriodo){o.n=2;break}throw new Error("Por favor seleccione un taller");case 2:if(e.turno){o.n=3;break}throw new Error("Por favor seleccione un turno");case 3:return o.n=4,e.inscripcionEnBloque();case 4:o.n=6;break;case 5:o.p=5,r=o.v,e.$notify(r.message,"warning");case 6:return o.a(2)}},o,null,[[0,5]])}))()},importFile:function(){this.modalImportarArchivo=!0},exportarPlantilla:function(){var e=this;return g()(b()().m(function o(){return b()().w(function(o){while(1)switch(o.n){case 0:(0,x.Fe)("".concat(e.sie.api,"/InscripcionController/getDescargarPlantillaInscripcionEnBloque?sie-token=").concat(e.sie.token));case 1:return o.a(2)}},o)}))()},getPeriodo:function(){var e=this;return g()(b()().m(function o(){var r,n;return b()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,e.$http.get("api/InscripcionController/getPeriodo",{params:{activo:0}});case 1:r=o.v,e.optPeriodo=r,n=r.find(function(e){return"S"===e.VIGENTE}),e.duracod=n&&n.DURACOD?n.DURACOD:null,e.idPrograma=null,e.gruvacod=null,e.idCursoPeriodo=null,e.turno=null;case 2:return o.a(2)}},o)}))()},getPrograma:function(){var e=this;return g()(b()().m(function o(){var r;return b()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,e.$http.get("api/InscripcionController/getTipoGrupoVac",{params:{parametros:{enUso:1,duracod:e.duracod,ano:e.sie.ano}}});case 1:r=o.v,e.optPrograma=r,e.idPrograma=null,e.gruvacod=null,e.idCursoPeriodo=null,e.turno=null;case 2:return o.a(2)}},o)}))()},getGrupovac:function(){var e=this;return g()(b()().m(function o(){var r,n;return b()().w(function(o){while(1)switch(o.n){case 0:return r={where:{tipocod:e.idPrograma}},o.n=1,e.$http.get("api/GrupovacController/getGrupovac",{params:{parametros:r}});case 1:n=o.v,e.optGrupos=n,e.gruvacod=null,e.idCursoPeriodo=null,e.turno=null;case 2:return o.a(2)}},o)}))()},getTaller:function(){var e=this;return g()(b()().m(function o(){var r;return b()().w(function(o){while(1)switch(o.n){case 0:return r={ano:e.sie.ANO,duracod:e.duracod,tipocod:e.idPrograma,gruvacod:e.gruvacod},o.n=1,e.getListaCursos(r);case 1:e.talleres=o.v,e.idCursoPeriodo=null,e.taller=null,e.turno=null;case 2:return o.a(2)}},o)}))()},getTurno:function(){var e=this;return g()(b()().m(function o(){var r;return b()().w(function(o){while(1)switch(o.n){case 0:return e.loadDisable.values=[],o.n=1,e.$http.get("api/CtCursoPeriodoController/getTurnos",{params:{params:{where:{ID_CURSO_PERIODO:e.idCursoPeriodo}}}});case 1:r=o.v,e.turnos=r,e.turnos=e.turnos.sort(function(e,o){return e.TURNO-o.TURNO});case 2:return o.a(2)}},o)}))()},cambiarPeriodo:function(){var e=this;return g()(b()().m(function o(){return b()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,e.getPrograma();case 1:return o.n=2,e.getGrupovac();case 2:return o.n=3,e.getTaller();case 3:return o.a(2)}},o)}))()},cambiarPrograma:function(){var e=this;return g()(b()().m(function o(){return b()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,e.getGrupovac();case 1:return o.n=2,e.getTaller();case 2:return o.a(2)}},o)}))()},cambiarGrupo:function(){var e=this;return g()(b()().m(function o(){return b()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,e.getTaller();case 1:return o.a(2)}},o)}))()},init:function(){var e=this;return g()(b()().m(function o(){return b()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,e.getPeriodo();case 1:return o.n=2,e.getPrograma();case 2:return o.n=3,e.getGrupovac();case 3:return o.n=4,e.getTaller();case 4:return o.a(2)}},o)}))()}},created:function(){var e=this;return g()(b()().m(function o(){return b()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,e.init();case 1:return o.a(2)}},o)}))()},watch:{idPrograma:{immediate:!0,handler:function(e){e||(this.talleres=[],this.turnos=[])}},gruvacod:{immediate:!0,handler:function(e){e||(this.talleres=[],this.turnos=[])}},idCursoPeriodo:{immediate:!0,handler:function(e){e||(this.turnos=[])}}}},V=r(12807);const U=(0,V.A)(A,[["render",p]]);var N=U}}]);