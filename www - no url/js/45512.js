"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[45512],{45512:function(e,t,a){a.r(t),a.d(t,{default:function(){return ie}});var n=a(8445),o=a.n(n),r=a(61758),i=a(58790),l={class:"row items-center no-wrap"},s={class:"row q-ma-xs q-col-gutter-sm"},c={class:"col-xs-12 col-sm-4"},u={class:"col-xs-12 col-sm-4"},d={class:"col-xs-12 col-sm-2"},m={class:"col-xs-12 col-sm-2"},f={class:"col-xs-12 col-sm-4"},h={class:"col-xs-12 col-sm-4"},p={class:"row q-ma-xs q-col-gutter-sm"},E={class:"col-xs-12"},g={class:"text-h6"},v={class:"col-xs-12 col-sm-12"},D={class:"row q-ma-xs q-col-gutter-sm"},w={class:"col-xs-12 col-sm-12"},A={class:"col-xs-12 col-sm-6"},b={class:"col-xs-12 col-sm-4"},C={class:"text-h6"};function R(e,t){var a=(0,r.g2)("crearBotones"),n=(0,r.g2)("q-card-section"),R=(0,r.g2)("q-separator"),M=(0,r.g2)("q-select"),O=(0,r.g2)("q-date"),N=(0,r.g2)("q-popup-proxy"),k=(0,r.g2)("q-icon"),I=(0,r.g2)("q-input"),S=(0,r.g2)("sie-grid"),T=(0,r.g2)("footer-grid"),_=(0,r.g2)("sie-modal"),Y=(0,r.g2)("q-tab"),F=(0,r.g2)("q-tabs"),B=(0,r.g2)("q-card");return e.modal?(0,r.Q3)("v-if",!0):((0,r.uX)(),(0,r.Wv)(B,{key:0,class:"layout-v1 my-card",flat:"",bordered:""},{default:(0,r.k6)(function(){return[(0,r.bF)(n,null,{default:(0,r.k6)(function(){return[(0,r.Lk)("div",l,[t[21]||(t[21]=(0,r.Lk)("div",{class:"col"},[(0,r.Lk)("div",{class:"text-h6"},"Comunicación de Baja")],-1)),(0,r.bF)(a,{buttons:e.botones,nivelAcceso:e.nivelAcceso,opcion:e.nameComponente,dropdown:!0},null,8,["buttons","nivelAcceso","opcion"])])]}),_:1}),(0,r.bF)(R),(0,r.bF)(n,null,{default:(0,r.k6)(function(){return[(0,r.Lk)("div",s,[(0,r.Lk)("div",c,[(0,r.bF)(M,{label:"Año",placeholder:"Seleccione Año",options:e.anios,"option-label":"label","option-value":"value",modelValue:e.selectAnio,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.selectAnio=t}),onInput:e.asignarFechas},null,8,["options","modelValue","onInput"])]),(0,r.Lk)("div",u,[(0,r.bF)(M,{label:"Mes",placeholder:"Seleccione Mes",options:e.meses,"option-label":"label","option-value":"value",modelValue:e.mescob,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.mescob=t}),onInput:e.asignarFechas},null,8,["options","modelValue","onInput"])]),(0,r.Lk)("div",d,[(0,r.bF)(I,{label:"Fecha Inicio",debounce:"500",maxlength:"10",format:"##/##/####",modelValue:e.fechaInicio,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.fechaInicio=t}),mask:"##/##/####",readonly:""},{append:(0,r.k6)(function(){return[(0,r.bF)(k,{class:"cursor-pointer",name:"date_range"},{default:(0,r.k6)(function(){return[(0,r.bF)(N,{ref:"qDateProxy1","transition-show":"scale","transition-hide":"scale"},{default:(0,r.k6)(function(){return[(0,r.bF)(O,{mask:"DD/MM/YYYY",modelValue:e.fechaInicio,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.fechaInicio=t}),onInput:t[3]||(t[3]=function(t){return e.closeModalInicio("qDateProxy1")})},null,8,["modelValue"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])]),(0,r.Lk)("div",m,[(0,r.bF)(I,{label:"Fecha Fin",debounce:"500",maxlength:"10",format:"##/##/####",modelValue:e.fechaFin,"onUpdate:modelValue":t[7]||(t[7]=function(t){return e.fechaFin=t}),mask:"##/##/####",readonly:""},{append:(0,r.k6)(function(){return[(0,r.bF)(k,{class:"cursor-pointer",name:"date_range"},{default:(0,r.k6)(function(){return[(0,r.bF)(N,{ref:"qDateProxy2","transition-show":"scale","transition-hide":"scale"},{default:(0,r.k6)(function(){return[(0,r.bF)(O,{mask:"DD/MM/YYYY",modelValue:e.fechaFin,"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.fechaFin=t}),onInput:t[6]||(t[6]=function(t){return e.closeModalFin("qDateProxy2")})},null,8,["modelValue"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])]),(0,r.Lk)("div",f,[(0,r.bF)(M,{modelValue:e.selectTalon,"onUpdate:modelValue":t[8]||(t[8]=function(t){return e.selectTalon=t}),label:"Serie",options:e.talonarios,placeholder:"Todos","option-value":"value","option-label":"label",onInput:e.getBajas},null,8,["modelValue","options","onInput"])]),(0,r.Lk)("div",h,[(0,r.bF)(M,{modelValue:e.selectEstado,"onUpdate:modelValue":t[9]||(t[9]=function(t){return e.selectEstado=t}),label:"Estado",options:e.estadosSunat,placeholder:"Todos","option-value":"value","option-label":"label",onInput:e.getBajas},null,8,["modelValue","options","onInput"])])]),(0,r.Lk)("div",null,[(0,r.bF)(S,{class:"q-mt-xs ag-theme-balham",columnDefs:e.columnDefs,rowData:e.rowData,rowSelection:"multiple",frameworkComponents:e.frameworkComponents,onGridReady:e.onGridReady,style:{width:"100wv",height:"calc(100vh - 300px)"}},null,8,["columnDefs","rowData","frameworkComponents","onGridReady"]),(0,r.bF)(T,{modelValue:e.pagina,"onUpdate:modelValue":t[10]||(t[10]=function(t){return e.pagina=t}),max:e.pages,onLoad:e.getBajas,rows:e.rowData},null,8,["modelValue","max","onLoad","rows"])])]}),_:1}),(0,r.bF)(_,{modelValue:e.modalEditarEstado,"onUpdate:modelValue":t[12]||(t[12]=function(t){return e.modalEditarEstado=t}),labelButtonOk:"Cambiar",onSubmit:e.actualizarBaja},{default:(0,r.k6)(function(){return[(0,r.Lk)("div",p,[(0,r.Lk)("div",E,[(0,r.Lk)("div",g,"Comunicación de Baja: "+(0,i.v_)(e.nombreResumen),1)]),(0,r.Lk)("div",v,[(0,r.bF)(M,{modelValue:e.selectEstados,"onUpdate:modelValue":t[11]||(t[11]=function(t){return e.selectEstados=t}),"option-label":"DESCRIPCION","option-value":"VALOR",options:e.estados,label:"Estado SUNAT"},null,8,["modelValue","options"])])])]}),_:1},8,["modelValue","onSubmit"]),(0,r.bF)(_,{modelValue:e.openModalBajas,"onUpdate:modelValue":t[18]||(t[18]=function(t){return e.openModalBajas=t}),onSubmit:e.guardarBajas,labelButtonOk:"Aceptar"},{default:(0,r.k6)(function(){return[t[22]||(t[22]=(0,r.Lk)("div",{class:"text-h6"},"Agregar Comunicación de Baja",-1)),(0,r.bF)(R),(0,r.bF)(n,null,{default:(0,r.k6)(function(){return[(0,r.Lk)("div",D,[(0,r.Lk)("div",w,[(0,r.bF)(M,{modelValue:e.selectTalonAgregar,"onUpdate:modelValue":t[13]||(t[13]=function(t){return e.selectTalonAgregar=t}),label:"Serie",options:e.talonariosAgregar,placeholder:"Todos","option-value":"value","option-label":"label",onInput:e.listarData},null,8,["modelValue","options","onInput"])]),(0,r.Lk)("div",A,[(0,r.bF)(I,{label:"Fecha Emisión",debounce:"500",maxlength:"10",format:"##/##/####",modelValue:e.fechaEmision,"onUpdate:modelValue":t[16]||(t[16]=function(t){return e.fechaEmision=t}),mask:"##/##/####",readonly:""},{append:(0,r.k6)(function(){return[(0,r.bF)(k,{class:"cursor-pointer",name:"date_range"},{default:(0,r.k6)(function(){return[(0,r.bF)(N,{ref:"qDateProxy3","transition-show":"scale","transition-hide":"scale"},{default:(0,r.k6)(function(){return[(0,r.bF)(O,{mask:"DD/MM/YYYY",modelValue:e.fechaEmision,"onUpdate:modelValue":t[14]||(t[14]=function(t){return e.fechaEmision=t}),onInput:t[15]||(t[15]=function(t){return e.closeModalEmision("qDateProxy3")})},null,8,["modelValue"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])]),(0,r.Lk)("div",b,[(0,r.bF)(I,{maxlength:"3",modelValue:e.nroEnvio,"onUpdate:modelValue":t[17]||(t[17]=function(t){return e.nroEnvio=t}),label:"Número de Envio"},null,8,["modelValue"])])]),(0,r.Lk)("div",null,[(0,r.bF)(S,{class:"q-mt-sm ag-theme-balham",style:{width:"500wv",height:"calc(100vh - 500px)"},columnDefs:e.columnDefsDB,rowData:e.rowDataDB,rowSelection:"multiple",onGridReady:e.onGridReadyDB,frameworkComponents:e.frameworkComponents},null,8,["columnDefs","rowData","onGridReady","frameworkComponents"])])]}),_:1})]}),_:1},8,["modelValue","onSubmit"]),(0,r.bF)(_,{modelValue:e.openModalDetalleBaja,"onUpdate:modelValue":t[20]||(t[20]=function(t){return e.openModalDetalleBaja=t}),labelButtonOk:"Aceptar",showButtonCancel:"false"},{default:(0,r.k6)(function(){return[(0,r.bF)(n,null,{default:(0,r.k6)(function(){return[(0,r.Lk)("div",C,"Comunicación de Baja: "+(0,i.v_)(e.nombreResumen),1),(0,r.bF)(F,{modelValue:e.tabActivo,"onUpdate:modelValue":t[19]||(t[19]=function(t){return e.tabActivo=t})},{default:(0,r.k6)(function(){return[(0,r.bF)(Y,{name:e.tabskeys.datos},{default:(0,r.k6)(function(){return o()(t[23]||(t[23]=[(0,r.eW)("Datos",-1)]))}),_:1},8,["name"]),(0,r.bF)(Y,{name:e.tabskeys.cdr},{default:(0,r.k6)(function(){return o()(t[24]||(t[24]=[(0,r.eW)("Cdr",-1)]))}),_:1},8,["name"])]}),_:1},8,["modelValue"]),(0,r.bF)(R),e.tabActivo===e.tabskeys.datos?((0,r.uX)(),(0,r.Wv)(n,{key:0},{default:(0,r.k6)(function(){return[(0,r.Lk)("div",null,"Estado: "+(0,i.v_)(e.estadoResumen),1),(0,r.Lk)("div",null,"Documentos: "+(0,i.v_)(e.documentosResumen),1),(0,r.Lk)("div",null,"Fecha Envio: "+(0,i.v_)(e.fechaEnvioBaja),1),(0,r.bF)(S,{class:"q-mt-sm ag-theme-balham",style:{width:"500wv",height:"calc(100vh - 500px)"},columnDefs:e.columnDefsDetalle,rowData:e.rowDataDetalle,rowSelection:"multiple",onGridReady:e.onGridReadyDetalle,frameworkComponents:e.frameworkComponents},null,8,["columnDefs","rowData","onGridReady","frameworkComponents"])]}),_:1})):(0,r.Q3)("v-if",!0),e.tabActivo===e.tabskeys.cdr?((0,r.uX)(),(0,r.Wv)(n,{key:1},{default:(0,r.k6)(function(){return[(0,r.Lk)("div",null,[t[25]||(t[25]=(0,r.Lk)("b",null,"Fecha Respuesta:",-1)),(0,r.Lk)("p",null,(0,i.v_)(e.fechaCreacion),1)]),t[27]||(t[27]=(0,r.Lk)("br",null,null,-1)),(0,r.Lk)("div",null,[t[26]||(t[26]=(0,r.Lk)("b",null,"Respuesta SUNAT/OSE:",-1)),(0,r.Lk)("p",null,(0,i.v_)(e.error),1)])]}),_:1})):(0,r.Q3)("v-if",!0)]}),_:1})]}),_:1},8,["modelValue"])]}),_:1}))}var M=a(99550),O=a.n(M),N=a(76080),k=a.n(N),I=a(41562),S=a.n(I),T=a(45254),_=a.n(T),Y=(a(30683),a(71587),a(52133),a(10239),a(50310),a(6724),a(83190),a(66307),a(68017),a(88567)),F=a(95718),B=a(95051),V=a(53380),U=a(64208),y=a(12143),L=a(18105),x=a(95477),j=a(80660),P=a(6123),$=a(54267),q=a(36408),G=a(12533),H=a(78840),Q=a(57668),X=a(42037),W=a(56945),z=a(27560),K=a(54489),J=a(75053),Z=a(41615),ee=a(64303),te=a(26697),ae=a(53093),ne={props:{modal:{type:Boolean,default:!1},numtal:{type:String},numpag:{type:String}},components:{sieModal:J.A,QChip:B.A,QDate:y.A,QPopupProxy:x.A,QCard:Y.A,QCardSection:F.A,QSelect:K.S,QOptionGroup:P.EX,QSeparator:V.A,sieGrid:q.A,QInput:U.A,footerGrid:z.A,QBtnDropdown:P.B4,sieInfo:(0,Q["default"])(),crearBotones:ee.A,QTabs:te.A,QTab:ae.A,QIcon:P.bP},mixins:[W.A],data:function(){return{nivelAcceso:(0,Q["default"])().ruta.nivel,nameComponente:"Bajas",fechaInicio:(0,L.Ay)(new Date,"DD/MM/YYYY"),fechaFin:(0,L.Ay)(new Date,"DD/MM/YYYY"),fechaEmision:(0,L.Ay)(new Date,"DD/MM/YYYY"),selectTalon:"T",talonarios:[],selectTalonAgregar:"",talonariosAgregar:[],columnDefs:[],rowData:[],columnDefsDB:[],rowDataDB:[],columnDefsDetalle:[],rowDataDetalle:[],resumenSeleccionado:{},openModalBajas:!1,openModalDetalleBaja:!1,frameworkComponents:null,pagina:1,pages:1,modalEditarEstado:!1,titleModal:"SIEWEB: Tesorería",selectEstados:"",nombreResumen:"",tipoResumen:"RA",estadoResumen:"Pendiente",documentosResumen:0,estados:[{VALOR:0,DESCRIPCION:"Pendiente"},{VALOR:1,DESCRIPCION:"Aceptado"},{VALOR:2,DESCRIPCION:"Rechazado"}],botones:[],nroEnvio:"001",repetirResumen:1,anios:[],meses:[],selectAnio:String(Z["default"].CURRENT_YEAR),mescob:Z["default"].CURRENT_MONTH,fechaEnvio:"",estadosSunat:[],selectEstado:Z["default"].TODOS,tabsActive:{generales:!0,cdr:!1},error:"",fechaCreacion:"",fechaEnvioBaja:"",tabActivo:"tabsDatos",tabskeys:{datos:"tabsDatos",cdr:"tabCdr"}}},methods:{gatActiveTabs:function(e){var t=e.target.parentElement.children;if(t.length>0&&e.target.attributes.tabsItem){var a=e.target.attributes.tabsItem.textContent.trim();for(var n in this.tabsActive)this.tabsActive[n]=n===a;Array.from(t).map(function(e){e.attributes.tabsItem.textContent.trim()===a?e.attributes.active.textContent="active":e.attributes.active.textContent=""})}},getStatusAll:function(){var e=this,t=this.api.getSelectedRows();if(0===t.length)return this.$alert("No selecciono ningun registro","warning");this.$confirm("¿Esta seguro de ejecutar el proceso?").onOk(_()(k()().m(function a(){var n,r,i,l,s,c,u,d,m,f,h,p;return k()().w(function(a){while(1)switch(a.p=a.n){case 0:n={correctamente:[],errores:[]},e.$q.loading.show(),r=S()(t),a.p=1,r.s();case 2:if((i=r.n()).done){a.n=7;break}return l=i.value,a.p=3,s={numtal:l.NUMTAL,tipo_resumen:l.TIPO_RESUMEN,empcod:l.EMPCOD,fecha_emision:(0,L.Ay)((0,$.convertToYMD)(l.FECHA_EMISION),"YYYY-MM-DD"),ticket:l.TICKET,numero_envio:l.NUMERO_ENVIO,ruc:l.RUC},e.$q.loading.show(),a.n=4,j.$http.get("api/ResumenElectronicoController/getStatus",{params:{datos:s}});case 4:c=a.v,n.correctamente.push(c),a.n=6;break;case 5:a.p=5,h=a.v,n.errores.push(h);case 6:a.n=2;break;case 7:a.n=9;break;case 8:a.p=8,p=a.v,r.e(p);case 9:return a.p=9,r.f(),a.f(9);case 10:return u="",d="",n.correctamente.length>0&&(u+="(".concat(n.correctamente.length,") Status Obtenidos Satisfactoriamente."),d="success"),n.errores.length>0&&(u+="(".concat(n.errores.length,") Status No Obtenidos")),0===n.correctamente.length&&(d="warning",1===n.errores.length&&(m=o()(n.errores),f=m[0],u=f.error.message)),a.n=11,e.getBajas();case 11:e.$alert(u,d),e.$q.loading.hide();case 12:return a.a(2)}},a,null,[[3,5],[1,8,9,10]])})))},getEstadosSunat:function(){var e=this;return _()(k()().m(function t(){return k()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,Z["default"].API_ESTADO_COMPROBANTE_ELECTRONICO();case 1:e.estadosSunat=t.v;case 2:return t.a(2)}},t)}))()},getAnios:function(){var e=this;return _()(k()().m(function t(){return k()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,Z["default"].API_ANIOS();case 1:e.anios=t.v;case 2:return t.a(2)}},t)}))()},getMeses:function(){var e=this;return _()(k()().m(function t(){return k()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,Z["default"].MESES();case 1:e.meses=t.v;case 2:return t.a(2)}},t)}))()},asignarFechas:function(){var e=this;return _()(k()().m(function t(){var a;return k()().w(function(t){while(1)switch(t.n){case 0:if(!e.selectAnio||!e.mescob){t.n=1;break}return a=new Date(e.selectAnio,e.mescob,0).getDate(),e.fechaInicio="01/".concat(e.mescob,"/").concat(e.selectAnio),e.fechaFin="".concat(a,"/").concat(e.mescob,"/").concat(e.selectAnio),t.n=1,e.getBajas();case 1:return t.a(2)}},t)}))()},crearBotones:function(){this.botones=[{label:"Consultar Status",icon:"cloud_download",click:this.getStatusAll,minAcceso:Z["default"].LECTURA_ESCRITURA},{label:"Agregar Baja",icon:"plus_square",click:this.nuevaBaja,minAcceso:Z["default"].LECTURA_ESCRITURA},{label:"Eliminar Baja",icon:"delete",click:this.eliminarBajas,minAcceso:Z["default"].ACCESO_TOTAL}]},obtenerNumeroEnvio:function(){var e=this;return _()(k()().m(function t(){var a,n,o;return k()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,j.$http.get("api/ResumenElectronicoController/getNroEnvio",{params:{datos:{fecemi:(0,L.Ay)((0,$.convertToYMD)(e.fechaEmision),"YYYY-MM-DD")}}});case 1:a=t.v,n=O()(a,1),o=n[0],e.nroEnvio=o.NUMERO_ENVIO;case 2:return t.a(2)}},t)}))()},getBajas:function(){var e=this;return _()(k()().m(function t(){return k()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,j.$http.get("api/ResumenElectronicoController/getListarResumenElectronico",{params:{datos:{fecini:(0,L.Ay)((0,$.convertToYMD)(e.fechaInicio),"YYYY-MM-DD"),fecfin:(0,L.Ay)((0,$.convertToYMD)(e.fechaFin),"YYYY-MM-DD"),numtal:e.selectTalon,tipoResumen:e.tipoResumen,anio:""===e.selectAnio.length?Z["default"].TODOS:e.selectAnio,mescob:e.mescob,estado:e.selectEstado}}}).then(function(t){e.rowData=t});case 1:return t.a(2)}},t)}))()},listarData:function(){var e=this;return _()(k()().m(function t(){return k()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,j.$http.get("api/ResumenElectronicoController/getDataParaBajas",{params:{datos:{numtal:e.selectTalonAgregar,fecemi:(0,L.Ay)((0,$.convertToYMD)(e.fechaEmision),"YYYY-MM-DD")}}}).then(function(t){e.rowDataDB=t});case 1:return t.a(2)}},t)}))()},getStatus:function(e){var t=this;return _()(k()().m(function a(){var n;return k()().w(function(a){while(1)switch(a.n){case 0:if(0!==e.TICKET.length){a.n=1;break}t.$alert("La comunicación de baja debe tener TICKET","warning"),a.n=2;break;case 1:if(e.ESTADO!==Z["default"].ESTADO_COMPROBANTE_ELECTRONICO.PENDIENTE){a.n=2;break}return n={numtal:e.NUMTAL,tipo_resumen:e.TIPO_RESUMEN,empcod:e.EMPCOD,fecha_emision:(0,L.Ay)((0,$.convertToYMD)(e.FECHA_EMISION),"YYYY-MM-DD"),ticket:e.TICKET,numero_envio:e.NUMERO_ENVIO,ruc:e.RUC},t.$q.loading.show(),a.n=2,j.$http.get("api/ResumenElectronicoController/getStatus",{params:{datos:n}}).then(function(){var e=_()(k()().m(function e(a){return k()().w(function(e){while(1)switch(e.n){case 0:t.$q.loading.hide(),t.getBajas(),t.$alert(a.message,"success");case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){t.$q.loading.hide(),t.$alert(e.error.message,"warning")});case 2:return a.a(2)}},a)}))()},nuevaBaja:function(){var e=this;return _()(k()().m(function t(){return k()().w(function(t){while(1)switch(t.n){case 0:e.listarData(),e.openModalBajas=!0,e.frameworkComponents={agDate:G.A},e.rowDataDB=[],e.columnDefsDB=[{headerName:"Nro. Documento",field:"NRO_DOCUMENTO",width:140},{headerName:"Apellido y Nombres",field:"NOMBRE",width:280},{headerName:"",field:"MONSIG",cellClass:"text-center",width:40},{headerName:"Importe",field:"MONTOTPAG",cellClass:"text-right",valueFormatter:X.toFixed,width:80}];case 1:return t.a(2)}},t)}))()},obtenerCdr:function(e){var t=this;return _()(k()().m(function a(){var n,r,i,l,s,c;return k()().w(function(a){while(1)switch(a.n){case 0:return n={fecemi:(0,L.Ay)((0,$.convertToYMD)(e.FECHA_EMISION),"YYYY-MM-DD"),envio:e.NUMERO_ENVIO,empcod:e.EMPCOD},a.n=1,j.$http.get("api/ComprobanteElectronicoController/getRespuestaCdr",{params:{params:n}});case 1:r=a.v,i="",l="",r.length>0&&(s=o()(r),c=s[0],i=c.XML,l=(0,$.formatearFechaHora)(new Date(c.FECHA_CREACION))),t.error=i,t.fechaCreacion=l;case 2:return a.a(2)}},a)}))()},detalleBaja:function(e){var t=this;return _()(k()().m(function a(){var n,r,i;return k()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,j.$http.get("api/ResumenElectronicoController/getDataResumenDetalle",{params:{datos:{fecemi:(0,L.Ay)(e.FECHA_EMISION,"YYYY-MM-DD"),empcod:e.EMPCOD,documento:t.tipoResumen,envio:e.NUMERO_ENVIO}}});case 1:if(n=a.v,t.rowDataDetalle=n,!(n.length>0)){a.n=3;break}return a.n=2,t.obtenerCdr(e);case 2:r=o()(n),i=r[0],t.estadoResumen=i.ESTADO_DESC,t.documentosResumen=n.length,t.fechaEnvioBaja=(0,$.formatearFechaHora)(new Date(i.FECHA_SUNAT));case 3:t.columnDefsDetalle=[{headerName:"Tipo",field:"CODSUNAT",width:50},{headerName:"Nro. Documento",field:"NRODOC",width:120},{headerName:"Apellidos y Nombres",field:"NOMBRE",width:180},{headerName:"",field:"MONSIG",cellClass:"text-center",width:40},{headerName:"Imp.",field:"MONTOTPAG",cellClass:"text-right",valueFormatter:X.toFixed,width:60},{headerName:"Estado",field:"CODIGO_ESTADO_DOC",cellClass:"text-center",width:90}];case 4:return a.a(2)}},a)}))()},guardarBajas:function(){var e=this,t=this.apiDB.getSelectedRows();if(t.length>0){var a=o()(t),n=a[0];this.$confirm("¿Está seguro de registrar la comunicación de Baja?","info").onOk(_()(k()().m(function a(){return k()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,j.$http.post("api/ResumenElectronicoController/postComunicacionBaja",{datos:{comprobantes:t,numtal:e.selectTalonAgregar,fecemi:(0,L.Ay)(n.FECEMI,"YYYY-MM-DD"),fechaResumen:(0,L.Ay)(n.FECEMI,"YYYYMMDD"),nroEnvio:e.nroEnvio}}).then(function(t){e.$alert(t.message,"success"),e.openModalBajas=!1,e.getBajas()}).catch(function(t){e.$alert(t.error.message,"warning")});case 1:return a.a(2)}},a)})))}},actualizarBaja:function(){var e=this;return _()(k()().m(function t(){var a;return k()().w(function(t){while(1)switch(t.n){case 0:a={EMPCOD:e.resumenSeleccionado.EMPCOD,NUMERO_ENVIO:e.resumenSeleccionado.NUMERO_ENVIO,FECHA_EMISION:(0,L.Ay)(e.resumenSeleccionado.FECHA_EMISION,"YYYY-MM-DD"),TIPO_RESUMEN:e.resumenSeleccionado.TIPO_RESUMEN,ESTADO:e.selectEstados},e.$confirm("¿Está seguro de actualizar este registro?","info").onOk(_()(k()().m(function t(){return k()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,j.$http.put("api/ResumenElectronicoController/putResumenElectronico",{data:a}).then(function(t){e.$alert("Registro actualizado satisfactoriamente","success"),e.modalEditarEstado=!1,e.getBajas()}).catch(function(t){e.$alert(t.error.message,"warning")});case 1:return t.a(2)}},t)})));case 1:return t.a(2)}},t)}))()},eliminarBajas:function(){var e=this,t=this.api.getSelectedRows(),a="",n="";console.log(t),t.length>0?this.$confirm("¿Está seguro de eliminar las bajas seleccionadas?","info").onOk(_()(k()().m(function o(){var r;return k()().w(function(o){while(1)switch(o.n){case 0:r=0;case 1:if(!(r<t.length)){o.n=3;break}return o.n=2,j.$http.delete("api/ResumenElectronicoController/deleteResumenElectronico",{params:{data:{empcod:t[r].EMPCOD,numero_envio:t[r].NUMERO_ENVIO,fecha_emision:(0,L.Ay)(t[r].FECHA_EMISION,"YYYY-MM-DD"),ruc:t[r].RUC}}}).then(function(e){a=e.message,n="success"}).catch(function(e){a=e.error.message,n="warning"});case 2:r++,o.n=1;break;case 3:e.$alert(a,n),e.getBajas();case 4:return o.a(2)}},o)}))):this.$alert("Debe de seleccionar almenos un registro","warning")},generarXml:function(e){var t=this;return _()(k()().m(function a(){return k()().w(function(a){while(1)switch(a.n){case 0:return e.TIPORESUMEN=t.tipoResumen,e.TIPODOCUMENTO="XML",a.n=1,j.$http.get("api/ResumenElectronicoController/getResumenElectronico",{params:{datos:e}}).then(function(){var e=_()(k()().m(function e(a){return k()().w(function(e){while(1)switch(e.n){case 0:return e.n=1,Z["default"].DESCARGAR_ARCHIVO(a.paramsDescarga);case 1:t.$alert("Archivo XML generado satisfactoriamente","success");case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}());case 1:return a.a(2)}},a)}))()},generarCdr:function(e){var t=this;return _()(k()().m(function a(){return k()().w(function(a){while(1)switch(a.n){case 0:return e.TIPORESUMEN=t.tipoResumen,e.TIPODOCUMENTO="CDR",a.n=1,j.$http.get("api/ResumenElectronicoController/getResumenElectronico",{params:{datos:e}}).then(function(){var e=_()(k()().m(function e(a){return k()().w(function(e){while(1)switch(e.n){case 0:return e.n=1,Z["default"].DESCARGAR_ARCHIVO(a.paramsDescarga);case 1:t.$alert("Archivo CDR generado satisfactoriamente","success");case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}());case 1:return a.a(2)}},a)}))()},onGridReady:function(e){this.api=e.api},onGridReadyDB:function(e){this.apiDB=e.api},onGridReadyDetalle:function(e){this.apiDetalle=e.api},getTalones:function(){var e=this;return _()(k()().m(function t(){var a,n,o,r,i;return k()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,j.$http.get("api/talonarioController/getTalonariosElectronicos",{params:{params:{CODSUNAT:Z["default"].CODSUNAT.FACTURA}}});case 1:a=t.v,n=S()(a);try{for(n.s();!(o=n.n()).done;)r=o.value,i="".concat(r.NUMTAL," | ").concat(r.SERIE," | ").concat(r.NUMERO," | ").concat(r.TALONARIO),e.talonarios.push({value:r.NUMTAL,label:i}),e.talonariosAgregar.push({value:r.NUMTAL,label:i})}catch(e){n.e(e)}finally{n.f()}case 2:return t.a(2)}},t)}))()},closeModalInicio:function(e){this.$refs[e].hide(),this.cambiarAnioMesInicio()},closeModalFin:function(e){this.$refs[e].hide(),this.cambiarAnioMesFin()},closeModalEmision:function(e){this.$refs[e].hide(),this.cambiarAnioMesEmision()},cambiarAnioMesInicio:function(){var e=this.fechaInicio.split("/");if(3===e.length){var t=[];this.api.getModel().forEachNode(function(a){var n=String(e[2]),o=String(e[1]);a.data.anio=n,a.data.mes=o,t.push(a.data)}),this.api.updateRowData({update:t})}this.getBajas()},cambiarAnioMesFin:function(){var e=this.fechaFin.split("/");if(3===e.length){var t=[];this.api.getModel().forEachNode(function(a){var n=String(e[2]),o=String(e[1]);a.data.anio=n,a.data.mes=o,t.push(a.data)}),this.api.updateRowData({update:t})}this.getBajas()},cambiarAnioMesEmision:function(){var e=this;return _()(k()().m(function t(){var a,n;return k()().w(function(t){while(1)switch(t.n){case 0:return a=e.fechaEmision.split("/"),3===a.length&&(n=[],e.api.getModel().forEachNode(function(e){var t=String(a[2]),o=String(a[1]);e.data.anio=t,e.data.mes=o,n.push(e.data)}),e.api.updateRowData({update:n})),e.listarData(),t.n=1,e.obtenerNumeroEnvio();case 1:return t.a(2)}},t)}))()}},mounted:function(){this.selectTalon=this.numpag,this.getTalones()},created:function(){},beforeMount:function(){var e=this;return _()(k()().m(function t(){var a;return k()().w(function(t){while(1)switch(t.n){case 0:return e.getAnios(),e.getMeses(),e.getEstadosSunat(),e.crearBotones(),e.frameworkComponents={agDate:G.A,actionButton:H.A},a=e,e.columnDefs=[{headerName:"F. Emisión",field:"FECHA_EMISION",width:100,valueFormatter:function(e){return(0,L.Ay)(e.value,"DD/MM/YYYY")},cellClass:"text-center"},{headerName:"Nro. Envío",field:"NUMERO_ENVIO",width:100,cellClass:"text-center"},{headerName:"Serie",field:"SERIE_ELECTRONICO",width:80,cellClass:"text-center"},{headerName:"Cant.",field:"CANTIDAD",width:70,cellClass:"text-center"},{headerName:"Estado SUNAT",field:"ESTADO_DESC",width:120,cellClass:"text-center"},{headerName:"Ticket",field:"TICKET",width:180,cellClass:"text-center"},{headerName:"",cellRenderer:H.A,cellRendererParams:{icon:"file_xml",title:"XML",onClick:function(e){var t=[e.data][0];a.generarXml(t)}},hide:e.nivelAcceso<Z["default"].SOLO_LECTURA,width:40},{headerName:"",cellRenderer:H.A,cellRendererParams:{icon:"document_list",title:"Descargar CDR",onClick:function(e){var t=[e.data][0];a.generarCdr(t)}},hide:e.nivelAcceso<Z["default"].SOLO_LECTURA,width:40},{headerName:"",cellRenderer:H.A,cellRendererParams:{icon:"remove_red_eye",title:"Ver detalles",onClick:function(e){var t=[e.data][0];a.rowDataDetalle=null,a.resumenSeleccionado=t,a.nombreResumen=a.tipoResumen+"-"+(0,L.Ay)(t.FECHA_EMISION,"YYYYMMDD")+"-"+t.NUMERO_ENVIO,a.detalleBaja(t),a.openModalDetalleBaja=!0}},hide:e.nivelAcceso<Z["default"].SOLO_LECTURA,width:40},{headerName:"",cellRenderer:H.A,cellRendererParams:{icon:"edit",title:"Editar",onClick:function(e){var t=[e.data][0];a.resumenSeleccionado=t,a.nombreResumen=a.tipoResumen+"-"+(0,L.Ay)(t.FECHA_EMISION,"YYYYMMDD")+"-"+t.NUMERO_ENVIO,a.selectEstados=t.ESTADO,a.modalEditarEstado=!0}},hide:e.nivelAcceso<Z["default"].LECTURA_ESCRITURA,width:40},{headerName:"",cellRenderer:H.A,cellRendererParams:{icon:"cloud_download",title:"Status",onClick:function(e){a.getStatus(e.data)}},hide:e.nivelAcceso<Z["default"].SOLO_LECTURA,width:40,cellClass:"text-center"}],e.getBajas(),t.n=1,e.obtenerNumeroEnvio();case 1:return t.a(2)}},t)}))()}},oe=a(12807);const re=(0,oe.A)(ne,[["render",R]]);var ie=re}}]);