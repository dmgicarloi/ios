"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[74668],{74668:function(e,t,o){o.r(t),o.d(t,{default:function(){return ce}});var n=o(8445),a=o.n(n),r=(o(515),o(61758)),l=o(58790),i={class:"row items-center no-wrap"},s={class:"col-auto"},c={class:"row q-ma-xs q-col-gutter-sm"},u={class:"col-xs-3"},d={class:"col-xs-3"},m={class:"col-xs-3"},p={class:"col-xs-3"},f={class:"col-xs-3"},h={class:"col-xs-3"},C={class:"col-xs-3"},b={class:"row q-ma-xs q-col-gutter-sm"},g={class:"col-xs-11"},v={class:"col-xs-1"},O={class:"col-xs-3"},F={class:"col-xs-3"},E={key:0,class:"col-xs-3"},w={key:1,class:"col-xs-3"},A={class:"col-xs-6"},S={class:"row q-ma-xs q-col-gutter-sm"},N={class:"col-xs-12"},T={class:"text-no-wrap"};function M(e,t){var o=this,n=(0,r.g2)("crearBotones"),M=(0,r.g2)("q-card-section"),D=(0,r.g2)("q-separator"),V=(0,r.g2)("q-select"),I=(0,r.g2)("q-input"),k=(0,r.g2)("q-checkbox"),_=(0,r.g2)("q-date"),L=(0,r.g2)("q-popup-proxy"),R=(0,r.g2)("q-icon"),P=(0,r.g2)("sie-grid"),U=(0,r.g2)("footer-grid"),x=(0,r.g2)("q-item-main"),y=(0,r.g2)("q-item-tile"),G=(0,r.g2)("q-item"),B=(0,r.g2)("q-list"),$=(0,r.g2)("q-dialog"),q=(0,r.g2)("cuotasFactura"),Q=(0,r.g2)("imprimir-lote"),Y=(0,r.g2)("tesoreriaLoading"),j=(0,r.g2)("q-card");return(0,r.uX)(),(0,r.Wv)(j,{class:"layout-v1 my-card",flat:"",bordered:""},{default:(0,r.k6)(function(){return[(0,r.bF)(M,null,{default:(0,r.k6)(function(){return[(0,r.Lk)("div",i,[t[22]||(t[22]=(0,r.Lk)("div",{class:"col"},[(0,r.Lk)("div",{class:"text-h6"},"Emisión de Comprobantes en Lote")],-1)),(0,r.Lk)("div",s,[(0,r.bF)(n,{buttons:e.botones,option:e.nameComponent,nivelAcceso:e.nivelAcceso},null,8,["buttons","option","nivelAcceso"])])])]}),_:1}),(0,r.bF)(D),(0,r.bF)(M,null,{default:(0,r.k6)(function(){return[(0,r.Lk)("div",c,[(0,r.Lk)("div",u,[(0,r.bF)(V,{class:"truncate-label",label:"Mostrar",modelValue:e.selectMostrar,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.selectMostrar=t}),options:e.mostrar,onInput:e.buscarComprobantesSinEmitir},null,8,["modelValue","options","onInput"])]),(0,r.Lk)("div",d,[(0,r.bF)(V,{class:"truncate-label",modelValue:e.selectNivel,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.selectNivel=t}),"option-value":"INSTRUCOD","option-label":"INSTRUDES",options:e.nivel,label:"Nivel",onInput:t[2]||(t[2]=function(t){return e.getGrado(!0)})},null,8,["modelValue","options"])]),(0,r.Lk)("div",m,[(0,r.bF)(V,{class:"truncate-label",modelValue:e.selectGrado,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.selectGrado=t}),"option-value":"GRADOCOD","option-label":"GRADODES",options:e.grado,label:"Grado",onInput:t[4]||(t[4]=function(t){return e.getSecciones(!0)})},null,8,["modelValue","options"])]),(0,r.Lk)("div",p,[(0,r.bF)(V,{class:"truncate-label",modelValue:e.selectSeccion,"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.selectSeccion=t}),"option-value":"SECCIONCOD","option-label":"SECCIONDES",options:e.seccion,label:"Sección",onInput:e.buscarComprobantesSinEmitir},null,8,["modelValue","options","onInput"])]),(0,r.Lk)("div",f,[(0,r.bF)(V,{class:"truncate-label",label:"Orden",modelValue:e.selectOrden,"onUpdate:modelValue":t[6]||(t[6]=function(t){return e.selectOrden=t}),options:e.orden,onInput:e.buscarComprobantesSinEmitir},null,8,["modelValue","options","onInput"])]),(0,r.Lk)("div",h,[(0,r.bF)(V,{class:"truncate-label",modelValue:e.selectTalon,"onUpdate:modelValue":t[7]||(t[7]=function(t){return e.selectTalon=t}),"option-value":"NUMTAL","option-label":"TALDES",options:e.talon,label:"Talonario",onInput:t[8]||(t[8]=function(t){return e.getCorrelativo(!0)})},null,8,["modelValue","options"])]),(0,r.Lk)("div",C,[(0,r.Lk)("div",b,[(0,r.Lk)("div",g,[(0,r.bF)(I,{modelValue:e.correlativo,"onUpdate:modelValue":t[9]||(t[9]=function(t){return e.correlativo=t}),label:"Correlativo",readonly:!e.activeCorrelativo},null,8,["modelValue","readonly"])]),(0,r.Lk)("div",v,[(0,r.bF)(k,{dense:"",modelValue:e.activeCorrelativo,"onUpdate:modelValue":t[10]||(t[10]=function(t){return e.activeCorrelativo=t})},null,8,["modelValue"])])])]),(0,r.Lk)("div",O,[(0,r.bF)(I,{"reverse-fill-mask":"",modelValue:e.fecEmi,"onUpdate:modelValue":t[13]||(t[13]=function(t){return e.fecEmi=t}),maxlength:"10",mask:"##/##/####",label:"Fecha de Emisión"},{append:(0,r.k6)(function(){return[(0,r.bF)(R,{class:"cursor-pointer",name:"date_range"},{default:(0,r.k6)(function(){return[(0,r.bF)(L,{ref:"qDateProxy","transition-show":"scale","transition-hide":"scale"},{default:(0,r.k6)(function(){return[(0,r.bF)(_,{mask:"DD/MM/YYYY",modelValue:e.fecEmi,"onUpdate:modelValue":t[11]||(t[11]=function(t){return e.fecEmi=t}),onInput:t[12]||(t[12]=function(t){return e.$refs.qDateProxy.hide()})},null,8,["modelValue"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])]),(0,r.Lk)("div",F,[(0,r.bF)(V,{class:"truncate-label",modelValue:e.selectFiltro,"onUpdate:modelValue":t[14]||(t[14]=function(t){return e.selectFiltro=t}),"option-value":"value","option-label":"label",options:e.filtroBusquedaDeuda,label:"Tipo de Filtro",onInput:e.buscarComprobantesSinEmitir},null,8,["modelValue","options","onInput"])]),1===o.selectFiltro?((0,r.uX)(),(0,r.CE)("div",E,[(0,r.bF)(V,{class:"truncate-label",modelValue:e.selectFecVen,"onUpdate:modelValue":t[15]||(t[15]=function(t){return e.selectFecVen=t}),"option-value":"value","option-label":"label",options:e.fechaVen,label:"Fecha de Vencimiento",onInput:e.buscarComprobantesSinEmitir},null,8,["modelValue","options","onInput"])])):(0,r.Q3)("v-if",!0),2===o.selectFiltro?((0,r.uX)(),(0,r.CE)("div",w,[(0,r.bF)(V,{class:"truncate-label",modelValue:e.selectMescob,"onUpdate:modelValue":t[16]||(t[16]=function(t){return e.selectMescob=t}),"option-value":"value","option-label":"label",options:e.meses,label:"Meses",onInput:e.buscarComprobantesSinEmitir},null,8,["modelValue","options","onInput"])])):(0,r.Q3)("v-if",!0),(0,r.Lk)("div",A,[(0,r.bF)(V,{class:"truncate-label",modelValue:e.selectConcepto,"onUpdate:modelValue":t[17]||(t[17]=function(t){return e.selectConcepto=t}),"option-value":"CONCOB","option-label":"CONDES",options:e.concepto,label:"Concepto",onInput:e.buscarComprobantesSinEmitir},null,8,["modelValue","options","onInput"])])])]}),_:1}),(0,r.bF)(M,null,{default:(0,r.k6)(function(){return[(0,r.Lk)("div",S,[(0,r.Lk)("div",N,[(0,r.bF)(P,{class:"ag-theme-balham",columnDefs:e.columnDefs,rowData:e.rowData,onGridReady:e.onGridReady,rowSelection:"multiple",style:{width:"100%",height:"calc(100vh - 400px)"},floatingFilter:!0,enableCellTextSelection:!0,defaultColDef:e.defaultColDef,onFilterChanged:e.onFilterChanged},null,8,["columnDefs","rowData","onGridReady","defaultColDef","onFilterChanged"]),(0,r.bF)(U,{modelValue:e.pagina,"onUpdate:modelValue":t[18]||(t[18]=function(t){return e.pagina=t}),max:e.pages,onLoad:e.getEmisionBoleta,rows:e.contador},null,8,["modelValue","max","onLoad","rows"])])])]}),_:1}),(0,r.bF)($,{modelValue:e.modalInactivos.show,"onUpdate:modelValue":t[19]||(t[19]=function(t){return e.modalInactivos.show=t}),"stack-buttons":""},{title:(0,r.k6)(function(){return a()(t[23]||(t[23]=[(0,r.Lk)("span",null,"Alumnos Inactivos",-1)]))}),body:(0,r.k6)(function(){return[(0,r.Lk)("div",null,[(0,r.bF)(B,{class:"no-border"},{default:(0,r.k6)(function(){return[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(Object.keys(e.dataInactivos),function(t){return(0,r.uX)(),(0,r.Wv)(G,{key:e.concepto.CONDES},{default:(0,r.k6)(function(){return[(0,r.bF)(x,{class:"label",style:{width:"350px"}},{default:(0,r.k6)(function(){return[(0,r.eW)((0,l.v_)(t),1)]}),_:2},1024),(0,r.bF)(y,{class:"label text-right",style:{width:"150px"}},{default:(0,r.k6)(function(){return[(0,r.Lk)("span",T,(0,l.v_)(e.dataInactivos[t]),1)]}),_:2},1024)]}),_:2},1024)}),128))]}),_:1})])]}),_:1},8,["modelValue"]),(0,r.bF)(q,{modelValue:e.openModal,"onUpdate:modelValue":t[20]||(t[20]=function(t){return e.openModal=t}),cliente:e.nomCliente,title:e.title,moneda:e.monsig,total:e.montoCob,onSubmit:e.procesoFacturas},null,8,["modelValue","cliente","title","moneda","total","onSubmit"]),(0,r.bF)(Q,{modelValue:e.openImprimirLote,"onUpdate:modelValue":t[21]||(t[21]=function(t){return e.openImprimirLote=t}),onSubmit:e.imprimir},null,8,["modelValue","onSubmit"]),(0,r.bF)(Y,{modelValue:e.loading.show,total:e.loading.total,procesados:e.loading.procesados},null,8,["modelValue","total","procesados"])]}),_:1})}var D=o(99550),V=o.n(D),I=o(76080),k=o.n(I),_=o(45254),L=o.n(_),R=(o(30683),o(71225),o(71587),o(39866),o(23825),o(10239),o(50310),o(5962),o(92802),o(11777),o(15547),o(83190),o(27153),o(62540),o(62692),o(66307),o(68017),o(24066),o(88567)),P=o(95718),U=o(54489),x=o(64208),y=o(80660),G=o(6123),B=o(36408),$=o(96330),q=o(57668),Q=o(18105),Y=o(12533),j=o(42037),X=o(54267),H=o(27560),z=o(12143),W=o(95477),K=o(53380),J=(o(7807),o(75053)),Z=o(3112),ee=o(30283),te=o(99637),oe=o(41615),ne=o(64303),ae=o(17915),re=o(26232),le={components:{QCard:R.A,QCardSection:P.A,QSelect:U.S,QOptionGroup:G.EX,sieGrid:B.A,footerGrid:H.A,QInput:x.A,QDate:z.A,QPopupProxy:W.A,QSeparator:K.A,sieModal:J.A,QCheckbox:Z.A,imprimirLote:ee.A,headerGrid:$.A,crearBotones:ne.A,tesoreriaLoading:ae.A,cuotasFactura:re.A,QDialog:G.OQ,QIcon:G.bP,QList:G.Mb,QItem:G.H0,QItemMain:G.mF,QItemTile:G.lp},data:function(){return{nameComponent:"EmisionComprobante",nivelAcceso:(0,q["default"])().ruta.nivel,columnDefs:null,rowData:null,columnDefsCF:null,rowDataCF:[],api:null,apiCF:null,P_FACTURA_FORMA_PAGO:!0,ABR_FACTURA:"FAC",SOLO_DEUDAS:1,TOTAL_DEUDAS:2,SOLO_FACTURAS:3,DESC_PLANILLA:4,mostrar:oe["default"].EMISION_DEFAULT,selectMostrar:2,orden:[{label:"Salón",value:1},{label:"Nombre",value:2}],DESCUENTO_POR_PLANILLA:4,controladorEmision:"EMISION-LOTE",openModal:!1,title:"",selectPerfil:1,selectOrden:1,nivel:[],selectNivel:"T",grado:[],selectGrado:"T",talon:[],selectTalon:"",seccion:[],selectSeccion:"T",selectMescob:oe["default"].CURRENT_MONTH,selectFiltro:1,FILTRO_FECVEN:1,FILTRO_MESCOB:2,filtroBusquedaDeuda:[{label:"Fec. Venc.",value:1},{label:"Meses",value:2}],concepto:[],meses:[],selectConcepto:"01",activeCorrelativo:!1,correlativo:"",fecEmi:(0,Q.Ay)(new Date,"DD/MM/YYYY"),fechaVen:[],selectFecVen:(0,Q.Ay)(new Date,"YYYY-MM-DD"),deudaSinEmitir:[],selectDeudaSinEmitir:"",nombre:"",pagina:1,pages:1,openImprimirLote:!1,BOLETA:3,FACTURA:1,frameworkComponents:null,nroCuota:0,montoCuotas:0,sinMontoCuotas:0,cantFecven:0,montoCob:0,botones:[],dataInitial:[],loading:{show:!1,procesados:0,total:100},monsig:"S/",nomCliente:"",defaultColDef:{suppressHeaderMenuButton:!0,filter:!0,floatingFilterComponentParams:{suppressFilterButton:!0},resizable:!0,sortable:!0,suppressDragLeaveHidesColumns:!0},contador:0,dataInactivos:[],modalInactivos:{show:!1},filterModel:null}},methods:{onFilterChanged:function(e){this.contador=Array.from({length:e.api.getDisplayedRowCount()}),this.filterModel=e.api.getFilterModel()},restoreFilterState:function(){this.filterModel&&this.api.setFilterModel(this.filterModel)},validarEstado:function(e){return 0===Number(e.data.ACTIVO)?{backgroundColor:"#FDD4CB",color:"#000"}:{}},columns:function(){this.columnDefs=[{headerName:"Apellidos y Nombres",field:"NOMBRE",sortable:!0,width:440,cellStyle:this.validarEstado},{headerName:"Estado Alumno",field:"ESTADO",width:120,cellStyle:this.validarEstado},{headerName:"NGS",field:"NGS",width:65,cellStyle:this.validarEstado},{headerName:"Beca",field:"BECA",width:180,cellStyle:this.validarEstado},{headerName:"Doc.",field:Number(this.selectMostrar)===Number(this.DESCUENTO_POR_PLANILLA)?"COMPROBANTE":"DOC",width:80,cellStyle:this.validarEstado},{headerName:"Mon.",field:"MONSIG",width:60,cellClass:"text-right",cellStyle:this.validarEstado},{headerName:"Monto",field:"MONTOPEN",cellClass:"text-right",valueFormatter:j.toFixed,width:90,cellStyle:this.validarEstado}]},filterByName:function(){var e=this;if(0!==!this.rowData.length){var t=a()(this.dataInitial);this.nombre&&this.nombre.trim().length>0&&(t=t.filter(function(t){return String(t.NOMBRE).toLowerCase().includes(e.nombre.toLowerCase())})),this.rowData=t}},imprirmirLote:function(){this.openImprimirLote=!0},crearBotones:function(){this.botones=[{label:"Imprimir",icon:"print",click:this.imprirmirLote,minAcceso:oe["default"].SOLO_LECTURA},{label:"Procesar",icon:"settings",click:this.ejecutarProceso,minAcceso:oe["default"].LECTURA_ESCRITURA}]},imprimir:function(e){var t=e.talon,o=e.nroInicio,n=e.nroFin;if(!t)return this.$alert("Debe elegir un Talonario","warning"),!1;if(!o||!n)return this.$alert("No hay talonarios disponibles para el rango de fechas selecionadas"),!1;o.length>7&&(o=o.substring(1,8)),n.length>7&&(n=n.substring(1,8));var a=(0,q["default"])().origin,r="".concat(a,"/webservice/servicios-tesoreria/reporte?numtal=").concat(t,"&numini=").concat(o,"&numfin=").concat(n);window.open(r,"_blank")},getConstanteSistema:function(){var e=this;return L()(k()().m(function t(){var o,n;return k()().w(function(t){while(1)switch(t.n){case 0:return o={ID_CONSTANTE:[oe["default"].CONSTANTES_SISTEMA.P_FACTURA_FORMA_PAGO]},t.n=1,oe["default"].API_CONSTANTES_SISTEMAS(o);case 1:n=t.v,Object.keys(n).includes("P_FACTURA_FORMA_PAGO")&&(e.P_FACTURA_FORMA_PAGO=n.P_FACTURA_FORMA_PAGO);case 2:return t.a(2)}},t)}))()},ejecutarProceso:function(){var e=this;return L()(k()().m(function t(){var o,n,r,l,i,s,c;return k()().w(function(t){while(1)switch(t.n){case 0:if(o=e.api.getSelectedRows(),e.selectTalon&&""!==e.selectTalon){t.n=1;break}return t.a(2,e.$alert("No ha seleccionado un talonario.","info"));case 1:if(0!==o.length){t.n=2;break}return t.a(2,e.$alert("No ha seleccionado registros a procesar.","info"));case 2:if(n=a()(o),r=n[0],l=e.selectMostrar===e.SOLO_FACTURAS||o[0].DOC===e.ABR_FACTURA,!(l&&!0===e.P_FACTURA_FORMA_PAGO&&r.MONTOPEN>0)){t.n=6;break}if(!(o.length>1)){t.n=3;break}return t.a(2,e.$alert("Solo puede emitir 1 factura a la vez para registrar las cuotas al crédito","info"));case 3:if(0!==o.length){t.n=4;break}return t.a(2,e.$alert("Debe seleccionar un registro.","info"));case 4:e.openModal=!0,e.generarcuotasFactura();case 5:t.n=8;break;case 6:if(i={items:[],monto:0},e.P_FACTURA_FORMA_PAGO)for(s=0;s<o.length;s++)c=o[s],c.DOC===e.ABR_FACTURA&&c.MONTOPEN>0&&i.items.push(c);if(!(i.items>0)){t.n=7;break}return t.a(2,e.$alert("No se puede emitir una factura en lote.","info"));case 7:e.$confirm("¿Esta seguro de ejecutar este proceso?","info").onOk(L()(k()().m(function t(){var n,a,r;return k()().w(function(t){while(1)switch(t.n){case 0:if(!(o.length>0)){t.n=4;break}e.loading.show=!0,e.loading.total=o.length,e.loading.procesados=0,n={procesados:0,noProcesados:0,error:""},a=0;case 1:if(!(a<o.length)){t.n=3;break}return r={numtal:e.selectTalon,numpag:e.correlativo,fecemi:new Date((0,X.convertToYMD)(e.fecEmi)),fecven:e.selectFecVen,concob:e.selectConcepto,id_perfil:e.selectPerfil,id_persona:o[a].ID_PERSONA,controlador:e.controladorEmision,edit_numpag:!0===e.activeCorrelativo,proceso:e.selectMostrar},e.selectFiltro===e.FILTRO_MESCOB&&(r.mescob=e.selectMescob,r.anocob=(0,q["default"])().ano),t.n=2,y.$http.post("api/PagoController/postPagoPendiente",{params:r}).then(function(e){n.procesados++}).catch(function(e){n.error=e.error.message,n.noProcesados++}).finally(function(){e.loading.procesados++});case 2:a++,t.n=1;break;case 3:n.procesados>0?e.$alert("Proceso Finalizado:\n ("+n.procesados+") Documentos Emitidos","success"):n.noProcesados>0&&1===o.length?e.$alert(n.error,"warning"):e.$alert("Existe (".concat(n.noProcesados,") errores en el proceso de emisión"),"warning"),t.n=5;break;case 4:e.$alert("Debe seleccionar al menos un registro","warning");case 5:e.loading.show=!1,e.loading.procesado=0,e.getCorrelativo(),e.getEmisionBoleta();case 6:return t.a(2)}},t)})));case 8:return t.a(2)}},t)}))()},obtenerTalonarioEmision:function(){var e=this;return L()(k()().m(function t(){return k()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,y.$http.get("api/talonarioController/getTalonarioEmision").then(function(t){Object.keys(t).includes("numtal")&&(e.selectTalon=t.numtal),Object.keys(t).includes("emision_defecto")&&(e.selectMostrar=t.emision_defecto)});case 1:return t.a(2)}},t)}))()},generarcuotasFactura:function(){var e=this;return L()(k()().m(function t(){var o;return k()().w(function(t){while(1)switch(t.n){case 0:e.frameworkComponents={agDate:Y.A},e.nroCuota=0,e.montoCuotas=0,e.sinMontoCuotas=0,e.cantFecven=0,o=e.api.getSelectedRows(),e.montoCob=o[0].MONTOCOB,e.monsig=o[0].MONSIG,e.nomCliente=o[0].NOMBRE,e.title="Cliente: "+o[0].NOMBRE+" / Importe: "+o[0].MONSIG+" "+o[0].MONTOCOB.toFixed(2),e.columnDefsCF=[{headerName:"Nro. Cuota",field:"NROCUOTA",editable:!1,width:100},{headerName:"Monto",field:"MONTO",cellClass:"text-right",valueFormatter:j.toFixed,editable:!0,width:160},{headerName:"Fecha Ven.",field:"FECVEN",cellRenderer:Y.A,valueFormatter:function(e){return(0,Q.Ay)(e.value,"DD/MM/YYYY")},width:160}];case 1:return t.a(2)}},t)}))()},addRow:function(){this.montoCuotas=0,this.sinMontoCuotas=0,this.cantFecven=0,this.nroCuota=this.nroCuota+1;var e={NROCUOTA:this.nroCuota,MONTO:0,FECVEN:new Date};this.apiCF.updateRowData({add:[e]})},deleteRows:function(){this.montoCuotas=0,this.sinMontoCuotas=0,this.cantFecven=0;var e=this.apiCF.getSelectedRows();e.length>0&&this.apiCF.updateRowData({remove:e})},procesoFacturas:function(e){var t=this;return L()(k()().m(function o(){var n,a,r;return k()().w(function(o){while(1)switch(o.n){case 0:n=t.api.getSelectedRows(),t.montoCuotas=0,t.sinMontoCuotas=0,t.cantFecven=0,a=[],r=[],e.forEachNode(function(e){return a.push(e.data)}),(0,te["default"])(a,function(e){t.montoCuotas=t.montoCuotas+Number(e.MONTO),0===e.MONTO&&(t.sinMontoCuotas=t.sinMontoCuotas+1),e.FECVEN<new Date&&(t.cantFecven=t.cantFecven+1),r.push({NROCUOTA:e.NROCUOTA,MONTO:e.MONTO,FECVEN:e.FECVEN})}),t.cantFecven>0?t.$alert("Existen fechas de vencimiento que son previas a la fecha a actual.","info"):t.sinMontoCuotas>0?t.$alert("Existen Cuotas sin Monto.","info"):t.montoCuotas>t.montoCob?t.$alert("El importe de las cuotas ("+t.montoCuotas+") es mayor del monto de la Factura ("+t.montoCob+").","info"):t.montoCuotas<t.montoCob?t.$alert("El importe de las cuotas ("+t.montoCuotas+") es menor del monto de la Factura ("+t.montoCob+").","info"):t.$confirm("¿Esta seguro de ejecutar este proceso?","info").onOk(L()(k()().m(function e(){var o;return k()().w(function(e){while(1)switch(e.n){case 0:return o={numtal:t.selectTalon,numpag:t.correlativo,fecemi:new Date((0,X.convertToYMD)(t.fecEmi)),fecven:t.selectFecVen,concob:t.selectConcepto,id_perfil:t.selectPerfil,id_persona:n[0].ID_PERSONA,controlador:t.controladorEmision,formaPagoCredito:1,cuotas:r},t.selectFiltro===t.FILTRO_MESCOB&&(o.mescob=t.selectMescob,o.anocob=(0,q["default"])().ano),e.n=1,y.$http.post("api/PagoController/postPagoPendiente",{params:o}).then(function(e){t.$alert(e.message,"success"),t.openModal=!1,t.getCorrelativo(),t.getEmisionBoleta()}).catch(function(e){t.$alert(e.error.message,"warning")});case 1:return e.a(2)}},e)})));case 1:return o.a(2)}},o)}))()},getNivel:function(){return L()(k()().m(function e(){return k()().w(function(e){while(1)switch(e.n){case 0:return e.a(2,y.$http.get("api/gradoController/getNivelGradoSeccion",{params:{parametros:{response:"combo",anio:(0,q["default"])().ano,emisionLote:1,nivel:1}}}))}},e)}))()},getGrado:function(e){var t=this;return L()(k()().m(function o(){return k()().w(function(o){while(1)switch(o.n){case 0:if(!e){o.n=1;break}t.getGrado().then(function(e){t.grado=e,t.buscarComprobantesSinEmitir()}),o.n=2;break;case 1:return o.a(2,y.$http.get("api/gradoController/getGrados",{params:{parametros:{instrucod:t.selectNivel,response:"combo",emisionLote:1}}}));case 2:return o.a(2)}},o)}))()},getSecciones:function(e){var t=this;return L()(k()().m(function o(){return k()().w(function(o){while(1)switch(o.n){case 0:if(!e){o.n=1;break}t.getSecciones().then(function(e){t.seccion=e,t.buscarComprobantesSinEmitir()}),o.n=2;break;case 1:return o.a(2,y.$http.get("api/gradoController/getNivelGradoSeccion",{params:{parametros:{instrucod:t.selectNivel,gradocod:t.selectGrado,seccion:1,anio:(0,q["default"])().ano}}}));case 2:return o.a(2)}},o)}))()},getTalon:function(){return L()(k()().m(function e(){return k()().w(function(e){while(1)switch(e.n){case 0:return e.a(2,y.$http.get("api/talonarioController/getTalonariosUsuario",{params:{parametros:{response:"combo"}}}))}},e)}))()},getCorrelativo:function(){var e=this;return L()(k()().m(function t(){return k()().w(function(t){while(1)switch(t.n){case 0:return t.a(2,y.$http.get("api/talonarioController/getCorrelativo",{params:{parametros:{response:"combo",numtal:e.selectTalon}}}).then(function(t){e.correlativo=t[0].NUMPAG}))}},t)}))()},getFechaVencimiento:function(){return L()(k()().m(function e(){return k()().w(function(e){while(1)switch(e.n){case 0:return e.a(2,y.$http.get("api/cobroController/getFechaVencimiento",{params:{parametros:{response:"combo",anocob:(0,q["default"])().ano}}}))}},e)}))()},getConceptos:function(){return L()(k()().m(function e(){return k()().w(function(e){while(1)switch(e.n){case 0:return e.a(2,y.$http.get("api/concobroController/getConceptos",{params:{parametros:{response:"combo"}}}))}},e)}))()},buscarComprobantesSinEmitir:function(){var e=this;return L()(k()().m(function t(){return k()().w(function(t){while(1)switch(t.n){case 0:e.getEmisionBoleta(!0);case 1:return t.a(2)}},t)}))()},processFecVen:function(){var e=this;return L()(k()().m(function t(){return k()().w(function(t){while(1)switch(t.n){case 0:e.getEmisionBoleta();case 1:return t.a(2)}},t)}))()},getEmisionBoleta:function(){var e=arguments,t=this;return L()(k()().m(function o(){var n,a,r,l,i,s,c;return k()().w(function(o){while(1)switch(o.n){case 0:return n=e.length>0&&void 0!==e[0]&&e[0],a={anocob:(0,q["default"])().ano,id_perfil:t.selectPerfil,fecven:t.selectFecVen,concob:t.selectConcepto,orden:t.selectOrden,mostrar:t.selectMostrar,vjson:1,pagina:t.pagina},t.selectFiltro===t.FILTRO_MESCOB&&(a.mescob=t.selectMescob),t.selectNivel&&t.selectNivel!==oe["default"].TODOS&&(a.instrucod=t.selectNivel,t.selectGrado&&t.selectGrado!==oe["default"].TODOS&&(a.gradocod=t.selectGrado,t.selectSeccion&&t.selectSeccion!==oe["default"].TODOS&&(a.seccioncod=t.selectSeccion))),r=t.selectMostrar===t.DESCUENTO_POR_PLANILLA?"api/cobroController/getBecasPorEmitir":"api/cobroController/getDeudasSinEmitir",o.n=1,y.$http.get(r,{params:{parametros:a}});case 1:l=o.v,t.rowData=l,t.dataInitial=l,t.contador=l.length,l&&l.length>0&&n&&(i=l.reduce(function(e,t){return e[t.ACTIVO]||(e[t.ACTIVO]=[]),e[t.ACTIVO].push(t),e},{}),s=i[0],s&&s.length>0&&(c=s.reduce(function(e,t){return e[t.ESTADO]||(e[t.ESTADO]=0),e[t.ESTADO]+=1,e},{}),t.dataInactivos=c,t.modalInactivos.show=!0)),t.filterByName(),t.$nextTick(function(){t.restoreFilterState()});case 2:return o.a(2)}},o)}))()},onGridReady:function(e){this.api=e.api},onGridReadyCF:function(e){this.apiCF=e.api}},beforeMount:function(){var e=this;return L()(k()().m(function t(){var o,n,a,r,l,i,s;return k()().w(function(t){while(1)switch(t.n){case 0:return e.crearBotones(),t.n=1,e.getNivel();case 1:return o=t.v,t.n=2,e.getGrado();case 2:return n=t.v,t.n=3,e.getTalon();case 3:return a=t.v,t.n=4,e.getCorrelativo();case 4:return r=t.v,t.n=5,e.getFechaVencimiento();case 5:return l=t.v,t.n=6,e.getSecciones();case 6:return i=t.v,t.n=7,e.getConceptos();case 7:return s=t.v,t.n=8,oe["default"].MESES();case 8:e.meses=t.v,Promise.all([o,n,a,r,l,i,s]).then(function(t){var o=V()(t,7),n=o[0],a=o[1],r=o[2],l=(o[3],o[4]),i=o[5],s=o[6];e.columns(),n.push({INSTRUCOD:"T",INSTRUDES:"Todos"}),i.push({SECCIONCOD:"T",SECCIONDES:"Todos"}),e.nivel=n,e.grado=a,e.talon=r,l.length>0&&(e.selectFecVen=l[0].value),e.fechaVen=l,e.seccion=i,s.push({CONCOB:"T",CONDES:"Todos"}),e.concepto=s,e.getEmisionBoleta()});case 9:return t.a(2)}},t)}))()},mounted:function(){this.getConstanteSistema(),this.obtenerTalonarioEmision()}},ie=o(12807);const se=(0,ie.A)(le,[["render",M]]);var ce=se}}]);