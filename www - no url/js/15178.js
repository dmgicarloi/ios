"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[15178],{15178:function(e,o,r){r.r(o),r.d(o,{default:function(){return se}});var n=r(61758),t=r(58790),a={class:"row items-center no-wrap"},i={class:"col row"},c={class:"row"},l={class:"col-xs-12 col-sm-6 col-md-4"},s={class:"row q-mt-sm"},u={class:"col-xs-12 col-sm-6 col-md-8 q-pl-xs",ref:"vGrid"},d={class:"row q-mt-sm"},f={class:"row q-ma-xs q-col-gutter-sm"},m={class:"text-h6"},p={class:"row q-ma-xs q-col-gutter-sm"},g={key:0,class:"col-xs-12",style:{margin:"2rem"}},C={key:0,class:"row q-ma-xs q-col-gutter-sm"},h={key:1,class:"row q-ma-xs q-col-gutter-sm"},_={class:"col-xs-12",style:{margin:"2rem"}},v={key:2,class:"row q-ma-xs q-col-gutter-sm"},D={class:"col-12"},w=["src"],A={class:"text-h6"},O={class:"row q-ma-xs q-col-gutter-sm"},b={class:"col-xs-12"},T={class:"col-xs-12"};function k(e,o){var r=(0,n.g2)("q-icon"),k=(0,n.g2)("crearBotones"),E=(0,n.g2)("q-card-section"),I=(0,n.g2)("q-separator"),R=(0,n.g2)("sie-grid"),N=(0,n.g2)("q-date"),F=(0,n.g2)("q-popup-proxy"),x=(0,n.g2)("q-input"),y=(0,n.g2)("sie-upload"),L=(0,n.g2)("q-checkbox"),P=(0,n.g2)("sie-modal"),S=(0,n.g2)("q-card");return(0,n.uX)(),(0,n.Wv)(S,{class:"layout-v1 my-card",flat:"",bordered:""},{default:(0,n.k6)(function(){return[(0,n.bF)(E,null,{default:(0,n.k6)(function(){return[(0,n.Lk)("div",a,[(0,n.Lk)("div",i,[(0,n.bF)(r,{class:"cursor-pointer back",name:"arrow_back",onClick:e.volver},null,8,["onClick"]),o[7]||(o[7]=(0,n.Lk)("div",{class:"text-h6"},"Configuraciones de Comprobantes Electrónicos",-1))]),(0,n.bF)(k,{buttons:e.botones,nivelAcceso:e.nivelAcceso,opcion:e.nameComponente},null,8,["buttons","nivelAcceso","opcion"])])]}),_:1}),(0,n.bF)(I),(0,n.bF)(E,null,{default:(0,n.k6)(function(){return[(0,n.Lk)("div",c,[(0,n.Lk)("div",l,[(0,n.Lk)("div",s,[(0,n.bF)(R,{class:"ag-theme-balham",columnDefs:e.columnDefs,rowData:e.rowData,frameworkComponents:e.frameworkComponents,onGridReady:e.onGridReady,onRowClicked:e.form,style:{width:"100vh",height:"80vh"}},null,8,["columnDefs","rowData","frameworkComponents","onGridReady","onRowClicked"])])]),(0,n.Lk)("div",u,[(0,n.Lk)("div",null,[(0,n.Lk)("div",d,[(0,n.Lk)("div",f,[(0,n.Lk)("div",m,(0,t.v_)(e.titleForm),1)]),(0,n.Lk)("div",p,[e.renderFecha?((0,n.uX)(),(0,n.CE)("div",g,[(0,n.bF)(x,{"reverse-fill-mask":"",modelValue:e.selectDato,"onUpdate:modelValue":o[2]||(o[2]=function(o){return e.selectDato=o}),maxlength:"10",mask:"##/##/####",label:"Fecha Inicio Comprobantes"},{append:(0,n.k6)(function(){return[(0,n.bF)(r,{class:"cursor-pointer",name:"date_range"},{default:(0,n.k6)(function(){return[(0,n.bF)(F,{ref:"qDateProxy","transition-show":"scale","transition-hide":"scale"},{default:(0,n.k6)(function(){return[(0,n.bF)(N,{mask:"DD/MM/YYYY",modelValue:e.selectDato,"onUpdate:modelValue":o[0]||(o[0]=function(o){return e.selectDato=o}),onInput:o[1]||(o[1]=function(o){return e.closeDate("qDateProxy")})},null,8,["modelValue"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])])):(0,n.Q3)("v-if",!0)]),e.renderCorreo?((0,n.uX)(),(0,n.CE)("div",C,[(0,n.bF)(R,{class:"ag-theme-balham",columnDefs:e.columnDefsCorreo,rowData:e.rowDataCorreo,onRowSelected:e.rowSelectedCorreo,onGridReady:e.onGridReadyCorreo,frameworkComponents:e.frameworkComponents,style:{width:"100vh",height:"80vh"}},null,8,["columnDefs","rowData","onRowSelected","onGridReady","frameworkComponents"])])):(0,n.Q3)("v-if",!0),e.renderConfiguracion?((0,n.uX)(),(0,n.CE)("div",h,[(0,n.Lk)("div",_,[(0,n.bF)(x,{modelValue:e.selectDato,"onUpdate:modelValue":o[3]||(o[3]=function(o){return e.selectDato=o}),type:e.typeConfig,label:"Ingrese el dato"},null,8,["modelValue","type"])])])):(0,n.Q3)("v-if",!0),e.renderImage?((0,n.uX)(),(0,n.CE)("div",v,[(0,n.Lk)("div",D,[(0,n.bF)(y,{"only-button":!0,preview:!1,onUpload:e.cargarFoto,allow:["jpg","jpeg","png"]},null,8,["onUpload"]),(0,n.Lk)("img",{src:e.selectDato,"spinner-color":"white",style:{height:"140px","max-width":"150px"}},null,8,w)])])):(0,n.Q3)("v-if",!0)]),(0,n.bF)(P,{modelValue:e.openModal,"onUpdate:modelValue":o[6]||(o[6]=function(o){return e.openModal=o}),onSubmit:e.submit},{default:(0,n.k6)(function(){return[(0,n.bF)(E,null,{default:(0,n.k6)(function(){return[(0,n.Lk)("div",A,(0,t.v_)(e.titleModal),1)]}),_:1}),(0,n.bF)(I),(0,n.bF)(E,null,{default:(0,n.k6)(function(){return[(0,n.Lk)("div",O,[(0,n.Lk)("div",b,[(0,n.bF)(x,{type:"Correo",placeholder:"Ingresar Correo",modelValue:e.selectDato,"onUpdate:modelValue":o[4]||(o[4]=function(o){return e.selectDato=o}),label:"Correo"},null,8,["modelValue"])]),(0,n.Lk)("div",T,[(0,n.bF)(L,{modelValue:e.repetir,"onUpdate:modelValue":o[5]||(o[5]=function(o){return e.repetir=o}),"true-value":1,"false-value":0,"left-label":"",label:"Continuar Registrando"},null,8,["modelValue"])])])]}),_:1})]}),_:1},8,["modelValue","onSubmit"])])],512)])]}),_:1})]}),_:1})}var E=r(76080),I=r.n(E),R=r(99550),N=r.n(R),F=r(45254),x=r.n(F),y=(r(39866),r(10239),r(11777),r(52776),r(84433),r(88567)),L=r(95718),P=r(95051),S=r(53380),U=r(64208),M=r(12143),V=r(95477),q=r(80660),G=r(6123),$=r(36408),Q=r(56945),Y=r(27560),X=r(54489),B=r(75053),j=r(3112),H=r(41615),z=["checked"];function W(e,o){return(0,n.uX)(),(0,n.CE)("input",{type:"checkbox",onClick:o[0]||(o[0]=function(o){return e.checkedHandler(o,e.params)}),checked:e.params.value},null,8,z)}var Z={name:"checkboxRender",props:{},methods:{checkedHandler:function(e,o){return x()(I()().m(function r(){var n,t;return I()().w(function(r){while(1)switch(r.n){case 0:return n={ESTADO:Number(e.target.checked),ID_CONFIG:o.data.ID_CONFIG},r.n=1,q.$http.put("api/ResumenElectronicoController/putConfiguracionElectronicos",{datos:n});case 1:return t=r.v,r.a(2,t)}},r)}))()}}},J=r(12807);const K=(0,J.A)(Z,[["render",W]]);var ee=K,oe=r(78840),re=r(64303),ne=r(18105),te=r(54267),ae=r(33950),ie=r(59089),ce={props:{modal:{type:Boolean,default:!1},numtal:{type:String},numpag:{type:String},nivelAcceso:{type:Number,default:3}},components:{Upload:ae["default"],sieUpload:ie.A,sieModal:B.A,QChip:P.A,QDate:M.A,QPopupProxy:V.A,QCard:y.A,QCardSection:L.A,QSelect:X.S,QOptionGroup:G.EX,QSeparator:S.A,sieGrid:$.A,QInput:U.A,footerGrid:Y.A,QBtnDropdown:G.B4,QCheckbox:j.A,crearBotones:re.A,QIcon:G.bP},mixins:[Q.A],data:function(){return{nameComponente:"ConfigElectronicos",botones:[],columnDefs:[],rowData:[],frameworkComponents:{},configuraciones:[],detallesConfiguraciones:[],selectConfiguracion:"",selectDato:"",openModal:!1,titleModal:"",renderCorreo:!1,renderConfiguracion:!1,renderFecha:!1,renderImage:!1,correosAgregar:[],totalCorreos:0,repetir:0,correoInsertar:"",regexEmail:/^[^@]+@[^@]+\.[a-zA-Z]{2,}$/,labelTexto:"",estado:"",titleForm:"",columnDefsCorreo:{},rowDataCorreo:[],apiCorreo:null,labelConfig:"",typeConfig:"text",formConfiguracion:{},tipoConfiguracion:"",id_config_det:"",id_config:"",cargarFotoShow:!1,url:"https://futuraschools.sieweb.com.pe/".concat(q.API_LMS,"/api/HyoEscudo/imagen/escudo/futuraschools")}},methods:{cargarFoto:function(e){var o=this;return x()(I()().m(function r(){var n,t,a,i,c;return I()().w(function(r){while(1)switch(r.p=r.n){case 0:return r.p=0,n=N()(e,1),t=n[0],r.n=1,(0,ae["default"])({file:t});case 1:return a=r.v,r.n=2,q.$http.post("api/ComprobanteElectronicoController/postLogoElectronicos",{parametros:{archivo:a}});case 2:i=r.v,o.url=i.url,o.$alert(i.message,"success"),r.n=4;break;case 3:return r.p=3,c=r.v,r.a(2,o.$alert(c.error?c.error.message:c.message,"warning"));case 4:return r.a(2)}},r,null,[[0,3]])}))()},crearNuevoCorreo:function(){this.id_config_det=null,this.selectDato="",this.openModal=!0},settearCorreo:function(e){this.id_config_det=e.data.ID_CONFIG_DET,this.selectDato=e.data.VALOR_TEXTO,this.openModal=!0},eliminarCorreo:function(e){var o=this;this.$confirm("¿Seguro de eliminar el correo?").onOk(x()(I()().m(function r(){var n,t,a;return I()().w(function(r){while(1)switch(r.p=r.n){case 0:return r.p=0,n={id_config:e.data.ID_CONFIG,id_config_det:e.data.ID_CONFIG_DET},r.n=1,q.$http.delete("api/ResumenElectronicoController/deleteConfiguracionDetalle",{params:{configuracion:n}});case 1:return t=r.v,r.n=2,o.getDetalleConfigElectronico();case 2:return r.a(2,o.$alert(t.message,"success"));case 3:return r.p=3,a=r.v,r.a(2,o.$alert(a.error.message,"warning"))}},r,null,[[0,3]])})))},rowSelectedCorreo:function(){},onGridReadyCorreo:function(e){this.apiCorreo=e.api},volver:function(){window.history.go(-1)},editarMensaje:function(){this.$router.push({name:"tesoreria.visorMensaje",params:{codigo:H["default"].TIPO_ALERTA.ELECTRONICO,componente:"avisoDeudas"}})},limpiarConfiguracion:function(){var e=this;if(!this.id_config_det)return this.$alert("Error: No existe ninguna configuración");this.$confirm("¿Desea ejecutar el proceso?","info").onOk(x()(I()().m(function o(){var r,n,t;return I()().w(function(o){while(1)switch(o.p=o.n){case 0:return o.p=0,r={id_config:e.selectConfiguracion,tipo_dato:e.tipoConfiguracion,valor_numerico:0,id_config_det:e.id_config_det,valor_texto:"",valor_fecha:""},o.n=1,q.$http.post("api/ResumenElectronicoController/postActualizarConfiguracionElectronicos",{datos:r});case 1:return n=o.v,e.openModal=Boolean(Number(e.repetir)),e.$alert(n.message,"success"),o.n=2,e.getDetalleConfigElectronico();case 2:o.n=4;break;case 3:o.p=3,t=o.v,e.$alert(t.error,"warning");case 4:return o.a(2)}},o,null,[[0,3]])})))},crearBotones:function(){this.botones=[{label:"Mensaje",icon:"settings",click:this.editarMensaje,minAcceso:H["default"].LECTURA_ESCRITURA}],this.tipoConfiguracion&&![H["default"].TIPO_DATO.CORREOS].includes(Number(this.tipoConfiguracion))&&this.botones.push({label:"Guardar",icon:"save",click:this.submit,minAcceso:H["default"].LECTURA_ESCRITURA},{label:"Limpiar",icon:"clear",click:this.limpiarConfiguracion,minAcceso:H["default"].LECTURA_ESCRITURA}),[H["default"].TIPO_DATO.CORREOS].includes(Number(this.tipoConfiguracion))&&this.botones.push({label:"Agregar",icon:"plus",click:this.crearNuevoCorreo,minAcceso:H["default"].LECTURA_ESCRITURA})},onGridReady:function(){},form:function(e){var o=this;return x()(I()().m(function r(){return I()().w(function(r){while(1)switch(r.n){case 0:return o.tipoConfiguracion=Number(e.data.TIPO_DATO),o.selectConfiguracion=Number(e.data.ID_CONFIG),o.renderCorreo=[H["default"].TIPO_DATO.CORREOS].includes(Number(o.tipoConfiguracion)),o.renderConfiguracion=![H["default"].TIPO_DATO.CORREOS,H["default"].TIPO_DATO.INPUT_FECHA,H["default"].TIPO_DATO.IMAGE].includes(Number(o.tipoConfiguracion)),o.renderFecha=[H["default"].TIPO_DATO.INPUT_FECHA].includes(Number(o.tipoConfiguracion)),o.renderImage=[H["default"].TIPO_DATO.IMAGE].includes(Number(o.tipoConfiguracion)),o.render=!1,o.repetir=!1,o.openModal=!1,o.renderConfiguracion&&(o.typeConfig=e.data.TIPO_DATO===H["default"].TIPO_DATO.INPUT_NUMERO?"number":"text"),r.n=1,o.crearBotones();case 1:o.getDetalleConfigElectronico();case 2:return r.a(2)}},r)}))()},closeDate:function(e){this.$refs[e].hide()},submit:function(){var e=this;return x()(I()().m(function o(){return I()().w(function(o){while(1)switch(o.n){case 0:e.$confirm("¿Desea ejecutar el proceso?","info").onOk(x()(I()().m(function o(){var r,n,t;return I()().w(function(o){while(1)switch(o.p=o.n){case 0:if(o.p=0,r={id_config:e.selectConfiguracion,tipo_dato:e.tipoConfiguracion},e.id_config_det&&(r.id_config_det=e.id_config_det),e.tipoConfiguracion===H["default"].TIPO_DATO.INPUT_FECHA&&(r.valor_fecha=(0,ne.Ay)((0,te.convertToYMD)(e.selectDato),"YYYY-MM-DD")),e.tipoConfiguracion===H["default"].TIPO_DATO.INPUT_NUMERO&&(r.valor_numerico=Number(e.selectDato)),H["default"].TIPO_DATO.CORREOS!==e.tipoConfiguracion){o.n=2;break}if(e.regexEmail.test(e.selectDato)){o.n=1;break}return o.a(2,e.$alert("Error: Correo Inválido","warning"));case 1:r.valor_texto=String(e.selectDato);case 2:return H["default"].TIPO_DATO.INPUT_TEXTO===e.tipoConfiguracion&&(r.valor_texto=String(e.selectDato)),o.n=3,q.$http.post("api/ResumenElectronicoController/postActualizarConfiguracionElectronicos",{datos:r});case 3:return n=o.v,e.openModal=Boolean(Number(e.repetir)),e.$alert(n.message,"success"),o.n=4,e.getDetalleConfigElectronico();case 4:o.n=6;break;case 5:o.p=5,t=o.v,e.$alert(t.error,"warning");case 6:return o.a(2)}},o,null,[[0,5]])})));case 1:return o.a(2)}},o)}))()},getConfigElectronico:function(){var e=this;return x()(I()().m(function o(){return I()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,q.$http.get("api/ResumenElectronicoController/getConfiguracionesElectronicos",{params:{datos:{}}});case 1:e.rowData=o.v;case 2:return o.a(2)}},o)}))()},settearValor:function(e){return[H["default"].TIPO_DATO.INPUT_FECHA].includes(this.tipoConfiguracion)?(0,ne.Ay)((0,te.convertToYMD)(e.VALOR_FECHA),"DD-MM-YYYY"):[H["default"].TIPO_DATO.IMAGE].includes(this.tipoConfiguracion)?e.VALOR_TEXTO:H["default"].TIPO_DATO.INPUT_NUMERO===this.tipoConfiguracion?Number(e.VALOR_NUMERICO):String(e.VALOR_TEXTO)},getDetalleConfigElectronico:function(){var e=this;return x()(I()().m(function o(){var r,n,t;return I()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,q.$http.get("api/ResumenElectronicoController/getDetalleConfiguracionElectronicos",{params:{datos:{where:{ID_CONFIG:e.selectConfiguracion}}}});case 1:r=o.v,0===r.length?(e.id_config_det=null,e.selectDato=""):(e.renderConfiguracion||e.renderFecha||e.renderImage)&&(n=N()(r,1),t=n[0],e.selectDato=e.settearValor(t),e.id_config_det=t.ID_CONFIG_DET),e.renderCorreo&&(e.rowDataCorreo=r);case 2:return o.a(2)}},o)}))()},columnsCorreo:function(){this.columnDefsCorreo=[{headerName:"ID",field:"ID_CONFIG_DET",width:40},{headerName:"Correo",field:"VALOR_TEXTO",width:200},{cellRenderer:oe.A,width:40,cellRendererParams:{icon:"edit",title:"Actualizar",onClick:this.settearCorreo},hide:this.nivelAcceso<H["default"].LECTURA_ESCRITURA},{cellRenderer:oe.A,width:40,cellRendererParams:{icon:"delete",onClick:this.eliminarCorreo},hide:this.nivelAcceso<H["default"].ACCESO_TOTAL}]},guardar:function(){}},mounted:function(){},created:function(){var e=this;return x()(I()().m(function o(){var r;return I()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,H["default"].VERIFICAR_USUARIO_ADMINISTRADOR();case 1:r=o.v,r||e.$router.push({name:"tesoreria.home"});case 2:return o.a(2)}},o)}))()},beforeMount:function(){this.crearBotones(),this.columnsCorreo(),this.frameworkComponents={checkboxRender:ee,actionButton:oe.A},this.columnDefs=[{headerName:"Configuración",field:"DESCRIPCION",width:300},{headerName:"",field:"ESTADO",cellRenderer:ee,width:50}],this.getConfigElectronico()}};const le=(0,J.A)(ce,[["render",k]]);var se=le}}]);