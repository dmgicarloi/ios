"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[13906],{13906:function(e,n,a){a.r(n),a.d(n,{default:function(){return A}});var t=a(61758),r={class:"q-ma-xs column"},o={class:"q-gutter-sm"},i={class:"row col q-mt-xs"},l={class:"column col q-ml-xs"},c={key:0,class:"q-card"};function s(e,n){var a=this,s=(0,t.g2)("header-btn"),u=(0,t.g2)("q-input"),d=(0,t.g2)("sie-modal"),S=(0,t.g2)("sie-table"),f=(0,t.g2)("q-page");return(0,t.uX)(),(0,t.Wv)(f,{class:"intranet--horario q-pa-sm"},{default:(0,t.k6)(function(){return[(0,t.bF)(s,{name:"Banco de Datos",buttons:e.buttons},null,8,["buttons"]),(0,t.Q3)("span {{areas}}"),(0,t.bF)(d,{modelValue:e.modalAdd,"onUpdate:modelValue":n[2]||(n[2]=function(n){return e.modalAdd=n}),title:"Nuevo registro en Banco de datos",onSubmit:e.saveSecudes},{default:(0,t.k6)(function(){return[(0,t.Lk)("div",r,[(0,t.Lk)("div",o,[(0,t.bF)(u,{modelValue:e.dataAdd.SECUCOD,"onUpdate:modelValue":n[0]||(n[0]=function(n){return e.dataAdd.SECUCOD=n}),disable:"",label:"Código"},null,8,["modelValue"]),(0,t.bF)(u,{modelValue:e.dataAdd.SECUDES,"onUpdate:modelValue":n[1]||(n[1]=function(n){return e.dataAdd.SECUDES=n}),label:"Detalle",rules:[function(e){return!!e||"Este campo es obligatorio"}],maxlength:"200"},null,8,["modelValue","rules"])])])]}),_:1},8,["modelValue","onSubmit"]),(0,t.Lk)("div",i,[(0,t.bF)(S,{class:"col-4 q-card",columns:e.columnsPrincipal,data:e.principales,search:"Buscar",onRowSelected:e.click,config:e.configPrincipal,css:"height: calc(100vh - 105px)","hide-bottom":!0,context:a},null,8,["columns","data","onRowSelected","config"]),(0,t.Lk)("div",l,[e.prinSelect?((0,t.uX)(),(0,t.CE)("div",c,[(0,t.bF)(S,{columns:e.columnsDetalle,data:e.secundarios,search:"Buscar",css:"height: calc(100vh - 125px)","hide-bottom":!0,context:a,config:e.configSecundario,"show-refresh":!0,onRefresh:e.getSecundarios},{default:(0,t.k6)(function(){return[(0,t.Q3)('template(   slot="header" v-if="prinSelect===\'I02\'")q-select(\n    v-model="valSecundario"\n    label="Área"\n    option-value="SECUCOD"\n    option-label="SECUDES"\n    :options="areas"\n    )')]}),_:1},8,["columns","data","config","onRefresh"]),(0,t.Q3)('.row.col\n    q-btn(flat dense round icon="add" size="sm" @click="openModalAdd" v-if="acceso")\n    q-btn(flat dense round icon="cached" size="sm" @click="getSecundarios")')])):(0,t.Q3)("v-if",!0)])])]}),_:1})}var u=a(8445),d=a.n(u),S=a(76080),f=a.n(S),p=a(45254),m=a.n(p),h=(a(52133),a(10239),a(50310),a(90095),a(6724),a(83190),a(44264),a(2369),a(13715),a(6123)),E=a(33777),g=a(30640),C=a(9736),b=a(16648),v=a(57668),U={components:{SieTable:E.A,sieModal:g.A,QInput:C.A,QSelect:b.A,sieInfo:v["default"],QPage:h.Tu},data:function(){return{principales:[],secundarios:[],prinSelect:null,modalAdd:!1,valSecundario:null,acceso:(0,v["default"])().ruta.nivel>2,areas:[],dataAdd:{PRINCOD:null,SECUCOD:null,SECUDES:null,SECUEQU:null},columnsPrincipal:[{name:"PRINDES",label:"Tipo",align:"left",field:"PRINDES"}],columnsDetalle:[{name:"SECUCOD",label:"Código",align:"left",field:"SECUCOD"},{name:"SECUDES",label:"Detalle",align:"left",field:"SECUDES"},{name:"SECUEQU",label:"Activo",align:"center",field:"SECUEQU"}],showSubAreas:!1,areaSelect:null,configPrincipal:{},configSecundario:{SECUDES:{component:"input",input:function(e){this.saveEdit(e)}},SECUEQU:{renderHtml:function(e,n,a){return a.icon({name:"".concat("S"===e.SECUEQU?"toggle_on":"toggle_off")})},renderAction:function(e,n){"S"===e.SECUEQU?e.SECUEQU="N":e.SECUEQU="S",this.saveEdit(e)}}}}},methods:{click:function(e){var n=this;return m()(f()().m(function a(){return f()().w(function(a){while(1)switch(a.n){case 0:n.prinSelect=e.PRINCOD,n.getSecundarios();case 1:return a.a(2)}},a)}))()},saveEdit:function(e){var n=this;return m()(f()().m(function a(){var t,r,o;return f()().w(function(a){while(1)switch(a.p=a.n){case 0:return t=e,a.p=1,a.n=2,n.$http.post("api/TablaSeController/updateTablaSe",{params:t});case 2:r=a.v,n.getSecundarios(),n.$notify(r.message),a.n=4;break;case 3:a.p=3,o=a.v,n.$notify(o.message,"error");case 4:return a.a(2)}},a,null,[[1,3]])}))()},getSecundarios:function(){var e=this;return m()(f()().m(function n(){return f()().w(function(n){while(1)switch(n.n){case 0:return e.secundarios=[],n.n=1,e.$http.get("api/TablaSeController/getTablaSe",{params:{params:{where:{princod:e.prinSelect}}}});case 1:e.secundarios=n.v,e.secundarios.forEach(function(e){e.SECUEQU||(e.SECUEQU="S")});case 2:return n.a(2)}},n)}))()},getAreas:function(){var e=this;return m()(f()().m(function n(){return f()().w(function(n){while(1)switch(n.n){case 0:return n.n=1,e.$http.get("api/TablaSeController/getTablaSe",{params:{params:{where:{princod:"I01"}}}});case 1:e.areas=n.v;case 2:return n.a(2)}},n)}))()},openModalAdd:function(){var e="0001";if(this.secundarios.length>0){var n=Math.max.apply(Math,d()(this.secundarios.map(function(e){return parseInt(e.SECUCOD,10)})));e=(n+1).toString().padStart(4,"0")}this.dataAdd={PRINCOD:this.prinSelect,SECUCOD:e,SECUDES:null,SECUEQU:"S"},this.modalAdd=!0},saveSecudes:function(){var e=this;return m()(f()().m(function n(){var a,t,r,o;return f()().w(function(n){while(1)switch(n.p=n.n){case 0:if(!(e.dataAdd.SECUDES&&e.dataAdd.SECUDES.length>0)){n.n=5;break}return n.n=1,e.$confirmar("¿Está seguro de guardar su información?");case 1:if(a=n.v,!a){n.n=5;break}return t=e.dataAdd,t.id=e.dataAdd.SECUCOD,n.p=2,n.n=3,e.$http.post("api/TablaSeController/addTablaSe",{data:t});case 3:r=n.v,e.$notify(r.message),e.getSecundarios(),e.getAreas(),e.modalAdd=!1,n.n=5;break;case 4:n.p=4,o=n.v,e.$notify(o.message,"error");case 5:return n.a(2)}},n,null,[[2,4]])}))()}},computed:{buttons:function(){var e=[];return this.acceso&&this.prinSelect&&e.push({label:"Agregar",icon:"add",click:this.openModalAdd}),e}},watch:{prinSelect:function(e){this.configPrincipal={PRINDES:{renderHtml:function(n,a,t,r){n.PRINCOD===e?r["$$background"]="secondary":r["$$background"]="white"}}}}},created:function(){var e=this;return m()(f()().m(function n(){return f()().w(function(n){while(1)switch(n.n){case 0:return e.getAreas(),n.n=1,e.$http.get("api/HyoTablapr/obtRegistros",{params:{info:{princod:["I01","I02","I03","I04","I05","I06","I07","I08","I09","I10","I11","I12"]}}});case 1:e.principales=n.v;case 2:return n.a(2)}},n)}))()}},D=a(12807);const w=(0,D.A)(U,[["render",s]]);var A=w}}]);