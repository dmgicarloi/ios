"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[4336],{4336:function(e,a,o){o.r(a),o.d(a,{default:function(){return P}});var t=o(8445),l=o.n(t),n=o(61758),s=o(58790),i={class:"column",style:{display:"grid"}},r={class:"row"},d={class:"row justify-end"},c={class:"q-ma-sm"},u={key:0,class:"row"},A={class:"q-ma-sm"},I={class:"col q-card"},p={class:"row justify-around"};function D(e,a){var o=(0,n.g2)("header-btn"),t=(0,n.g2)("q-btn"),D=(0,n.g2)("q-input"),m=(0,n.g2)("q-field"),C=(0,n.g2)("q-checkbox"),f=(0,n.g2)("q-datetime"),N=(0,n.g2)("q-select"),M=(0,n.g2)("sie-modal"),v=(0,n.g2)("q-search"),b=(0,n.g2)("q-td"),h=(0,n.g2)("q-table");return(0,n.uX)(),(0,n.CE)("div",i,[(0,n.bF)(o,{name:"Tipos de Reservas",buttons:e.buttons},null,8,["buttons"]),(0,n.bF)(M,{modelValue:e.estadoModal,"onUpdate:modelValue":a[6]||(a[6]=function(a){return e.estadoModal=a}),title:"Agregar Tipo de Reserva",ok:!1,noClose:!0,escClick:!0,esc:!0},{footerMobile:(0,n.k6)(function(){return[(0,n.Lk)("div",r,[(0,n.bF)(t,{class:"q-ma-xs",dense:"",round:"",flat:"",icon:"close",onClick:e.cancelarAgregacion},null,8,["onClick"]),(0,n.bF)(t,{class:"q-ma-xs",dense:"",round:"",flat:"",icon:"save",onClick:e.ejecutarAccion},null,8,["onClick"])])]}),footer:(0,n.k6)(function(){return[(0,n.Lk)("div",d,[(0,n.bF)(t,{class:"q-ma-xs style-button",dense:"",color:"secondary",onClick:e.cancelarAgregacion},{default:(0,n.k6)(function(){return l()(a[8]||(a[8]=[(0,n.eW)("Cancelar",-1)]))}),_:1},8,["onClick"]),(0,n.bF)(t,{class:"q-ma-xs style-button",dense:"",color:"primary",onClick:e.ejecutarAccion},{default:(0,n.k6)(function(){return[(0,n.eW)((0,s.v_)(e.lbAccion),1)]}),_:1},8,["onClick"])])]}),default:(0,n.k6)(function(){return[(0,n.Lk)("div",c,[(0,n.bF)(m,{class:"col",error:e.v$.datosModal.NOMBRE.$error,"error-label":e.$t("validaciones.requerido")},{default:(0,n.k6)(function(){return[(0,n.bF)(D,{class:"q-if-outlined",modelValue:e.v$.datosModal.NOMBRE.$model,"onUpdate:modelValue":a[0]||(a[0]=function(a){return e.v$.datosModal.NOMBRE.$model=a}),"float-label":"Nombre",maxlength:"50",placeholder:"Escriba un nuevo nombre..."},null,8,["modelValue"])]}),_:1},8,["error","error-label"]),(0,n.bF)(C,{modelValue:e.datosModal.isAnticipo,"onUpdate:modelValue":a[1]||(a[1]=function(a){return e.datosModal.isAnticipo=a})},{default:(0,n.k6)(function(){return l()(a[9]||(a[9]=[(0,n.eW)("Configurar Anticipación",-1)]))}),_:1},8,["modelValue"]),e.datosModal.isAnticipo?((0,n.uX)(),(0,n.CE)("div",u,[4!==e.datosModal.UNIDAD_ANTICIPO?((0,n.uX)(),(0,n.Wv)(D,{key:0,class:"q-if-outlined col",type:"number",min:"1",max:e.maximoAnticipo[e.datosModal.UNIDAD_ANTICIPO],"float-label":"Cantidad",modelValue:e.datosModal.CANTIDAD,"onUpdate:modelValue":a[2]||(a[2]=function(a){return e.datosModal.CANTIDAD=a})},null,8,["max","modelValue"])):((0,n.uX)(),(0,n.Wv)(f,{key:1,class:"q-if-outlined col",modelValue:e.datosModal.HORARIO,"onUpdate:modelValue":a[3]||(a[3]=function(a){return e.datosModal.HORARIO=a}),type:"time","float-label":"Cantidad"},null,8,["modelValue"])),(0,n.bF)(N,{class:"q-if-outlined col",modelValue:e.datosModal.UNIDAD_ANTICIPO,"onUpdate:modelValue":a[4]||(a[4]=function(a){return e.datosModal.UNIDAD_ANTICIPO=a}),options:e.unidadesAnticipacion,"float-label":"Tipo"},null,8,["modelValue","options"])])):(0,n.Q3)("v-if",!0),(0,n.bF)(m,{class:"col"},{default:(0,n.k6)(function(){return[(0,n.bF)(D,{class:"q-if-outlined",modelValue:e.datosModal.DESCRIPCION,"onUpdate:modelValue":a[5]||(a[5]=function(a){return e.datosModal.DESCRIPCION=a}),"float-label":"Descripción",placeholder:"Escriba una descripción...",type:"textarea",maxlength:"200",rows:"5"},null,8,["modelValue"])]}),_:1})])]}),_:1},8,["modelValue"]),(0,n.Lk)("div",A,[(0,n.Lk)("div",I,[(0,n.bF)(h,{data:e.tiposReservas,columns:e.columns,filter:e.filtro,style:(0,s.Tr)({width:e.size})},{"top-right":(0,n.k6)(function(){return[(0,n.bF)(v,{class:"q-if-outlined",modelValue:e.filtro,"onUpdate:modelValue":a[7]||(a[7]=function(a){return e.filtro=a})},null,8,["modelValue"])]}),"body-cell-ACCIONES":(0,n.k6)(function(a){return[(0,n.bF)(b,{props:a},{default:(0,n.k6)(function(){return[(0,n.Lk)("div",p,[(0,n.bF)(t,{color:"blue",icon:"edit",flat:"",dense:"",round:"",onClick:function(o){return e.mostrarModal(a.row)}},null,8,["onClick"]),0===a.row.SISTEMA?((0,n.uX)(),(0,n.Wv)(t,{key:0,color:"red",icon:"delete",flat:"",dense:"",round:"",onClick:function(o){return e.eliminarTipo(a.row)}},null,8,["onClick"])):(0,n.Q3)("v-if",!0)])]}),_:2},1032,["props"])]}),_:1},8,["data","columns","filter","style"])])])])}var m=o(76080),C=o.n(m),f=o(45254),N=o.n(f),M=(o(30683),o(52133),o(10239),o(50310),o(6724),o(48426),o(83190),o(68017),o(83972)),v=o(6123),b=o(93616),h=o(88275),R=o(30640),T=o(30545),O=o(82640),k=o(57668),g={setup:function(){var e=(0,M.fG)();return{v$:e}},components:{QSelect:v.Si,QTable:T.A,QTd:v.Ef,sieModal:R.A,QDatetime:v.T5,sieSelect:b.A,sieSalones:h.Ay,QToolbar:v.ZV,QCheckbox:v.vZ,QBtn:v.Il,QField:v.Om,QInput:v.ie,QSearch:v.Ks},data:function(){return{size:"100%",permiso:(0,k["default"])().ruta.nivel,lbAccion:"",filtro:"",estadoModal:!1,unidadesAnticipacion:[{label:"Minutos",value:1},{label:"Horas",value:2},{label:"Dias",value:3},{label:"Del dia anterior",value:4}],datosModal:{ID:null,NOMBRE:null,DESCRIPCION:null,CANTIDAD:null,UNIDAD_ANTICIPO:null,isAnticipo:!1,HORARIO:new Date((new Date).setMinutes(0))},maximoAnticipo:{1:60,2:24,3:7},tiposReservas:[],columns:[{name:"ID",label:"Id",field:"ID",align:"center",sortable:!0},{name:"NOMBRE",label:"Nombre",field:"NOMBRE",align:"column-style"},{name:"DESCRIPCION",label:"Descripción",field:"DESCRIPCION",align:"column-style"},{name:"ANTICIPACION",label:"Anticipación",field:"ANTICIPACION",align:"column-style"}]}},mounted:function(){this.obtenerTiposReservas(),3===this.permiso&&this.columns.push({name:"ACCIONES",label:"Acciones",field:"ACCIONES",align:"center",style:"width: 90px"});var e=window.innerWidth;e<500&&(this.size=e-16+"px"),window.addEventListener("resize",this.onResize)},validations:function(){var e={NOMBRE:{required:O.mw}};return{datosModal:e}},computed:{buttons:function(){var e=[];return this.permiso>=2&&e.push({label:"Agregar Reserva",icon:"add",click:this.mostrarModal}),e}},methods:{mostrarModal:function(e){e.ID?(this.lbAccion="Actualizar",this.datosModal=Object.assign({},e)):(this.limpiarCampos(),this.lbAccion="Agregar"),this.estadoModal=!0},ejecutarAccion:function(){var e=!this.datosModal.isAnticipo||this.datosModal.CANTIDAD&&this.datosModal.UNIDAD_ANTICIPO;null!==this.datosModal.NOMBRE&&e&&this.datosModal.NOMBRE.trim()?(this.datosModal.ID?this.actualizarTipo():this.agregarTipoReserva(),this.estadoModal=!1,this.limpiarCampos()):this.v$.$touch()},agregarTipoReserva:function(){var e=this;return N()(C()().m(function a(){var o,t,l;return C()().w(function(a){while(1)switch(a.p=a.n){case 0:return a.p=0,o={NOMBRE:e.datosModal.NOMBRE.trim(),DESCRIPCION:null===e.datosModal.DESCRIPCION?e.datosModal.DESCRIPCION:e.datosModal.DESCRIPCION.trim(),CANTIDAD:e.datosModal.isAnticipo?e.datosModal.CANTIDAD:null,UNIDAD_ANTICIPO:e.datosModal.isAnticipo?e.datosModal.UNIDAD_ANTICIPO:null},4===o.UNIDAD_ANTICIPO&&(o.CANTIDAD=e.datosModal.HORARIO),a.n=1,e.$http.post("api/RsTipoReservaController/addRsTipoReserva",{data:o});case 1:t=a.v,1===t.code&&(e.obtenerTiposReservas(),e.$notify("Agregado","success")),a.n=3;break;case 2:a.p=2,l=a.v,e.$notify(l.error.message,"error");case 3:return a.a(2)}},a,null,[[0,2]])}))()},actualizarTipo:function(){var e=this;return N()(C()().m(function a(){var o,t,l;return C()().w(function(a){while(1)switch(a.p=a.n){case 0:return a.p=0,o={NOMBRE:e.datosModal.NOMBRE.trim(),DESCRIPCION:null===e.datosModal.DESCRIPCION?e.datosModal.DESCRIPCION:e.datosModal.DESCRIPCION.trim(),CANTIDAD:e.datosModal.isAnticipo?e.datosModal.CANTIDAD:null,UNIDAD_ANTICIPO:e.datosModal.isAnticipo?e.datosModal.UNIDAD_ANTICIPO:null},4===o.UNIDAD_ANTICIPO&&(o.CANTIDAD=e.datosModal.HORARIO),a.n=1,e.$http.post("api/RsTipoReservaController/updateRsTipoReserva",{id:e.datosModal.ID,params:o});case 1:t=a.v,1===t.code&&(e.obtenerTiposReservas(),e.$notify("Actualizado","success")),a.n=3;break;case 2:a.p=2,l=a.v,e.$notify(l.error.message,"error");case 3:return a.a(2)}},a,null,[[0,2]])}))()},eliminarTipo:function(e){var a=this;return N()(C()().m(function o(){var t,l,n;return C()().w(function(o){while(1)switch(o.p=o.n){case 0:return o.n=1,a.$confirmar("¿Esta Ud. Seguro de Eliminar el Tipo?","warning",!0);case 1:if(t=o.v,!t){o.n=5;break}return o.p=2,e={id:e.ID},o.n=3,a.$http.delete("api/RsTipoReservaController/deleteRsTipoReserva",{data:e});case 3:l=o.v,1===l.code?(a.obtenerTiposReservas(),a.$notify("Eliminado","success")):a.$notify(l.message,"error"),o.n=5;break;case 4:o.p=4,n=o.v,a.$notify(n.error.message,"error");case 5:return o.a(2)}},o,null,[[2,4]])}))()},obtenerTiposReservas:function(){var e=this;return N()(C()().m(function a(){var o,t;return C()().w(function(a){while(1)switch(a.p=a.n){case 0:return a.p=0,a.n=1,e.$http.get("api/RsTipoReservaController/getRsTipoReserva",{params:{directo:!0}});case 1:o=a.v,e.tiposReservas=o.map(function(e){if(e.isAnticipo=!!(e.CANTIDAD&&e.UNIDAD_ANTICIPO>0),e.CANTIDAD&&e.UNIDAD_ANTICIPO>0){var a=" Horas";switch(e.CANTIDADDES=e.CANTIDAD,e.UNIDAD_ANTICIPO){case 1:a="Minutos";break;case 2:a="Horas";break;case 3:a="Días";break;case 4:a="del Día Anterior";var o=e.CANTIDAD.split(":"),t=o[0],l=o[1],n=(new Date).setHours(t,l);e.HORARIO=new Date(n);break}e.ANTICIPACION="".concat(e.CANTIDADDES," ").concat(a)}return e}),a.n=3;break;case 2:a.p=2,t=a.v,e.$notify(t.error.message,"error");case 3:return a.a(2)}},a,null,[[0,2]])}))()},cancelarAgregacion:function(){this.limpiarCampos(),this.estadoModal=!1},limpiarCampos:function(){this.datosModal={ID:null,NOMBRE:null,DESCRIPCION:null,CANTIDAD:null,UNIDAD_ANTICIPO:null,HORARIO:new Date((new Date).setMinutes(0)),isAnticipo:!1},this.v$.$reset()},onResize:function(){var e=window.innerWidth;this.size=e<500?e-16+"px":"100%"}},watch:{"datosModal.UNIDAD_ANTICIPO":function(e){switch(e){case 2:this.datosModal.CANTIDAD>24&&(this.datosModal.CANTIDAD=24);break;case 3:this.datosModal.CANTIDAD>7&&(this.datosModal.CANTIDAD=7);break;case 4:this.datosModal.CANTIDAD=new Date((new Date).setHours(this.datosModal.CANTIDAD,0));break}}}},w=o(12807);const E=(0,w.A)(g,[["render",D]]);var P=E}}]);