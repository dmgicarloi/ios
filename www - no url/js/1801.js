"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[1801],{1801:function(n,e,a){a.r(e),a.d(e,{default:function(){return bn}});var t=a(8445),r=a.n(t),o=(a(12982),a(3110),a(515),a(52776),a(53113),a(61758)),i=a(58790),u={class:"row"},l={class:"col-12"},c={class:"col column"},s={class:"row q-col-gutter-sm"},d={key:0,class:"col-12"},f={key:1,class:"col-12"},b={key:2,class:"col-4"},m={class:"col-12"},p={class:"col-md-3 col-xs-6"},g={class:"col-md-3 col-xs-6"},h={class:"col-md-3 col-xs-6"},v={class:"col-md-3 col-xs-6"},F={class:"col-12"},k={class:"q-pa-md"},_={key:0,class:"row items-center"},w={class:"col q-subheading"},V={class:"col"},I={key:1,class:"row items-center"},B={class:"col q-subheading"},C={class:"col"};function O(n,e){var a=(0,o.g2)("header-btn"),t=(0,o.g2)("q-icon"),O=(0,o.g2)("q-input"),y=(0,o.g2)("sie-vacio"),A=(0,o.g2)("q-item-label"),S=(0,o.g2)("q-item-section"),D=(0,o.g2)("q-item"),j=(0,o.g2)("q-list"),E=(0,o.g2)("q-popover"),N=(0,o.g2)("q-separator"),q=(0,o.g2)("q-scroll-area"),L=(0,o.g2)("q-card-section"),Q=(0,o.g2)("q-card"),T=(0,o.g2)("q-tab"),U=(0,o.g2)("q-tabs"),H=(0,o.g2)("q-select"),M=(0,o.g2)("q-datetime"),X=(0,o.g2)("sie-editor"),$=(0,o.g2)("q-tab-panel"),W=(0,o.g2)("sie-tree"),Y=(0,o.g2)("q-tab-panels"),P=(0,o.g2)("q-form"),R=(0,o.g2)("sie-modal"),x=(0,o.g2)("q-checkbox"),z=(0,o.g2)("q-page"),G=(0,o.gN)("close-overlay");return(0,o.uX)(),(0,o.Wv)(z,{class:"banner q-pa-sm"},{default:(0,o.k6)(function(){return[(0,o.bF)(Q,{class:"col column",dense:"",bordered:"",flat:""},{default:(0,o.k6)(function(){return[(0,o.bF)(a,{name:"Banners",buttons:n.buttons},null,8,["buttons"]),(0,o.bF)(L,{class:"col column q-gutter-sm"},{default:(0,o.k6)(function(){return[(0,o.Lk)("div",u,[(0,o.Lk)("div",l,[(0,o.bF)(O,{modelValue:n.search,"onUpdate:modelValue":e[0]||(e[0]=function(e){return n.search=e}),type:"search",label:"Buscar",clearable:"",debounce:600,onInput:n.filtrar},{append:(0,o.k6)(function(){return[(0,o.bF)(t,{name:"search"})]}),_:1},8,["modelValue","onInput"])])]),(0,o.Lk)("div",c,[n.listaBanners.length?((0,o.uX)(),(0,o.Wv)(j,{key:1,class:"col column no-padding",dense:""},{default:(0,o.k6)(function(){return[(0,o.bF)(q,{class:"col"},{default:(0,o.k6)(function(){return[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.listaBanners,function(a,u){return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.bF)(D,null,{default:(0,o.k6)(function(){return[(0,o.bF)(S,null,{default:(0,o.k6)(function(){return[(0,o.bF)(A,null,{default:(0,o.k6)(function(){return[(0,o.eW)((0,i.v_)(a.TITULO),1)]}),_:2},1024),(0,o.bF)(A,{caption:""},{default:(0,o.k6)(function(){return[(0,o.eW)((0,i.v_)(n.getFecha(a.FH_INICIO))+" - "+(0,i.v_)(n.getFecha(a.FH_FIN)),1)]}),_:2},1024),n.sie.esAdministrador?((0,o.uX)(),(0,o.Wv)(A,{key:0,caption:""},{default:(0,o.k6)(function(){return[(0,o.eW)("Creado por: "+(0,i.v_)(a.USUNOM),1)]}),_:2},1024)):(0,o.Q3)("v-if",!0)]}),_:2},1024),n.permisoLE?((0,o.uX)(),(0,o.Wv)(S,{key:0,side:""},{default:(0,o.k6)(function(){return[(0,o.bF)(t,{name:"more_vert"},{default:(0,o.k6)(function(){return[(0,o.bF)(E,null,{default:(0,o.k6)(function(){return[(0,o.bF)(j,{class:"no-padding",dense:""},{default:(0,o.k6)(function(){return[(0,o.bo)(((0,o.uX)(),(0,o.Wv)(D,{onClick:function(e){return n.actualizarBanner(a.ID_BANNER)},clickable:""},{default:(0,o.k6)(function(){return[(0,o.bF)(S,{avatar:""},{default:(0,o.k6)(function(){return[(0,o.bF)(t,{name:"edit"})]}),_:1}),(0,o.bF)(S,null,{default:(0,o.k6)(function(){return r()(e[16]||(e[16]=[(0,o.eW)("Editar",-1)]))}),_:1})]}),_:1},8,["onClick"])),[[G]]),n.permisoT&&n.sie.usucod===a.USUCOD?(0,o.bo)(((0,o.uX)(),(0,o.Wv)(D,{key:0,onClick:function(e){return n.eliminarBanner(a.ID_BANNER)},clickable:""},{default:(0,o.k6)(function(){return[(0,o.bF)(S,{avatar:""},{default:(0,o.k6)(function(){return[(0,o.bF)(t,{name:"delete"})]}),_:1}),(0,o.bF)(S,null,{default:(0,o.k6)(function(){return r()(e[17]||(e[17]=[(0,o.eW)("Eliminar",-1)]))}),_:1})]}),_:1},8,["onClick"])),[[G]]):(0,o.Q3)("v-if",!0)]}),_:2},1024)]}),_:2},1024)]}),_:2},1024)]}),_:2},1024)):(0,o.Q3)("v-if",!0)]}),_:2},1024),(0,o.bF)(N)],64)}),256))]}),_:1})]}),_:1})):((0,o.uX)(),(0,o.Wv)(y,{key:0}))])]}),_:1})]}),_:1}),(0,o.bF)(R,{class:"banners_modal-crear",modelValue:n.open,"onUpdate:modelValue":e[14]||(e[14]=function(e){return n.open=e}),header:!0,title:n.dataObj.titleModal,loading:n.loadingBanner,onSubmit:n.grabarBanner},{default:(0,o.k6)(function(){return[(0,o.bF)(P,{ref:"form"},{default:(0,o.k6)(function(){return[(0,o.bF)(U,{class:"q-caption",modelValue:n.tab,"onUpdate:modelValue":e[1]||(e[1]=function(e){return n.tab=e}),dense:"",align:"left"},{default:(0,o.k6)(function(){return[(0,o.bF)(T,{name:"tab-1",label:"Datos del banner"}),(0,o.bF)(T,{name:"tab-2",label:"Dirigido a"})]}),_:1},8,["modelValue"]),(0,o.bF)(N),(0,o.bF)(Y,{modelValue:n.tab,"onUpdate:modelValue":e[13]||(e[13]=function(e){return n.tab=e})},{default:(0,o.k6)(function(){return[(0,o.bF)($,{name:"tab-1"},{default:(0,o.k6)(function(){return[(0,o.Lk)("div",s,[n.isForm?((0,o.uX)(),(0,o.CE)("div",d,[(0,o.bF)(H,{modelValue:n.dataObj.idForm,"onUpdate:modelValue":e[2]||(e[2]=function(e){return n.dataObj.idForm=e}),options:n.encuestas,label:"Asociar una encuesta"},null,8,["modelValue","options"])])):(0,o.Q3)("v-if",!0),n.seHabilitaComboTipos?((0,o.uX)(),(0,o.CE)("div",f,[(0,o.bF)(H,{modelValue:n.dataObj.id_banner_tipo,"onUpdate:modelValue":e[3]||(e[3]=function(e){return n.dataObj.id_banner_tipo=e}),options:n.tipos,label:"Seleccione tipo de banner","option-label":"DESCRIPCION","option-value":"ID_BANNER_TIPO"},null,8,["modelValue","options"])])):(0,o.Q3)("v-if",!0),(0,o.Lk)("div",{class:(0,i.C4)({"col-8":!n.encuestaSeleccionada||!n.noGrabaVistas,"col-12":n.encuestaSeleccionada||n.noGrabaVistas})},[(0,o.bF)(O,{modelValue:n.dataObj.titulo,"onUpdate:modelValue":e[4]||(e[4]=function(e){return n.dataObj.titulo=e}),label:"Título",rules:[function(n){return!!n||"Ingrese un título"}]},null,8,["modelValue","rules"])],2),n.encuestaSeleccionada||n.noGrabaVistas?(0,o.Q3)("v-if",!0):((0,o.uX)(),(0,o.CE)("div",b,[(0,o.bF)(O,{modelValue:n.dataObj.cantidad,"onUpdate:modelValue":e[5]||(e[5]=function(e){return n.dataObj.cantidad=e}),type:"number",label:"Cantidad",rules:[function(n){return!!n||"Ingrese la cantidad de veces que se mostrará el banner"}]},null,8,["modelValue","rules"])])),(0,o.Lk)("div",m,[(0,o.bF)(O,{modelValue:n.dataObj.orden,"onUpdate:modelValue":e[6]||(e[6]=function(e){return n.dataObj.orden=e}),type:"number",label:"Orden",rules:[function(n){return!!n||"Ingrese un orden"}]},null,8,["modelValue","rules"])]),(0,o.Lk)("div",p,[(0,o.bF)(M,{modelValue:n.dataObj.fechaInicio,"onUpdate:modelValue":e[7]||(e[7]=function(e){return n.dataObj.fechaInicio=e}),type:"date",label:"Fecha de inicio",rules:[function(n){return!!n||"Seleccione la fecha desde cuando se mostrará el banner"}]},null,8,["modelValue","rules"])]),(0,o.Lk)("div",g,[(0,o.bF)(M,{modelValue:n.dataObj.horaInicio,"onUpdate:modelValue":e[8]||(e[8]=function(e){return n.dataObj.horaInicio=e}),type:"time",label:"Hora de inicio",rules:[function(n){return!!n||"Seleccione la hora desde cuando se mostrará el banner"}]},null,8,["modelValue","rules"])]),(0,o.Lk)("div",h,[(0,o.bF)(M,{modelValue:n.dataObj.fechaFin,"onUpdate:modelValue":e[9]||(e[9]=function(e){return n.dataObj.fechaFin=e}),type:"date",label:"Fecha de fin",rules:[function(n){return!!n||"Seleccione la fecha hasta cuando se mostrará el banner"}]},null,8,["modelValue","rules"])]),(0,o.Lk)("div",v,[(0,o.bF)(M,{modelValue:n.dataObj.horaFin,"onUpdate:modelValue":e[10]||(e[10]=function(e){return n.dataObj.horaFin=e}),type:"time",label:"Hora de fin",rules:[function(n){return!!n||"Seleccione la hora hasta cuando se mostrará el banner"}]},null,8,["modelValue","rules"])]),(0,o.Lk)("div",F,[(0,o.bF)(X,{modelValue:n.dataObj.contenido,"onUpdate:modelValue":e[11]||(e[11]=function(e){return n.dataObj.contenido=e})},null,8,["modelValue"])])])]}),_:1}),(0,o.bF)($,{name:"tab-2"},{default:(0,o.k6)(function(){return[(0,o.bF)(W,{modelValue:n.ticked,"onUpdate:modelValue":e[12]||(e[12]=function(e){return n.ticked=e})},null,8,["modelValue"])]}),_:1})]}),_:1},8,["modelValue"])]}),_:1},512)]}),_:1},8,["modelValue","title","loading","onSubmit"]),(0,o.bF)(R,{class:"banners_modal-configuracion",modelValue:n.modalConfig,"onUpdate:modelValue":e[15]||(e[15]=function(e){return n.modalConfig=e}),header:!0,title:"Configuración",loading:n.loadingConfig,onSubmit:n.saveConfig},{default:(0,o.k6)(function(){return[(0,o.Lk)("div",k,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(Object.keys(n.config),function(e){return(0,o.uX)(),(0,o.CE)(o.FK,null,["number"===n.config[e].type?((0,o.uX)(),(0,o.CE)("div",_,[(0,o.bF)(t,{name:n.config[e].icon,size:"md"},null,8,["name"]),(0,o.Lk)("div",w,(0,i.v_)(n.config[e].description),1),(0,o.Lk)("div",V,[(0,o.bF)(O,{class:"q-if-outlined",type:n.config[e].type,modelValue:n.config[e].value,"onUpdate:modelValue":function(a){return n.config[e].value=a}},null,8,["type","modelValue","onUpdate:modelValue"])])])):(0,o.Q3)("v-if",!0),"boolean"===n.config[e].type?((0,o.uX)(),(0,o.CE)("div",I,[(0,o.bF)(t,{name:n.config[e].icon,size:"md"},null,8,["name"]),(0,o.Lk)("div",B,(0,i.v_)(n.config[e].description),1),(0,o.Lk)("div",C,[(0,o.bF)(x,{modelValue:n.config[e].value,"onUpdate:modelValue":function(a){return n.config[e].value=a}},null,8,["modelValue","onUpdate:modelValue"])])])):(0,o.Q3)("v-if",!0)],64)}),256))])]}),_:1},8,["modelValue","loading","onSubmit"])]}),_:1})}var y=a(76080),A=a.n(y),S=a(45254),D=a.n(S),j=(a(52133),a(10239),a(50310),a(6724),a(83190),a(7346),a(6123)),E=a(88567),N=a(95718),q=a(2739),L=a(9736),Q=a(16648),T=a(3112),U=a(34262),H=a(65673),M=a(82327),X=a(88865),$=a(66824),W=a(12205),Y=a(53380),P=a(26697),R=a(53093),x=a(53811),z=a(43346),G=a(80340),K=a(30640),J=a(6083),Z=a(59043),nn=a(50304),en=a(57668),an=a(69027),tn=a(99637),rn=a(78786),on=(a(70199),a(80660)),un={config:function(){return D()(A()().m(function n(){var e;return A()().w(function(n){while(1)switch(n.n){case 0:return n.n=1,on.$http.get("api/HyoBanner/obtConfig");case 1:return e=n.v,n.a(2,e)}},n)}))()},grabarConfig:function(n){return D()(A()().m(function e(){return A()().w(function(e){while(1)switch(e.n){case 0:return e.a(2,on.$http.post("api/HyoBanner/saveConfig",n))}},e)}))()},obtBanners:function(n){return D()(A()().m(function e(){var a,t;return A()().w(function(e){while(1)switch(e.n){case 0:return e.n=1,on.$http.get("api/HyoBanner/obtBanners",{params:n});case 1:return a=e.v,t=a.json,e.a(2,t)}},e)}))()},obtBanner:function(n){return D()(A()().m(function e(){var a,t,r,o,i,u;return A()().w(function(e){while(1)switch(e.n){case 0:if(a={titleModal:"Nuevo Banner",titulo:"",cantidad:"",fechaInicio:new Date,horaInicio:new Date,fechaFin:new Date,horaFin:new Date,contenido:"",editar:"no",orden:"",id_banner_tipo:1},t=[],!n.idBanner){e.n=2;break}return e.n=1,on.$http.get("api/HyoBanner/obtDatosBannerID",{params:n});case 1:r=e.v,o=r.json,i=o.nemos,u=o.datos,a={titleModal:"Editar Banner",titulo:u.TITULO,cantidad:u.CANTIDAD,orden:u.ORDEN,fechaInicio:u.FH_INICIO,horaInicio:u.FH_INICIO,fechaFin:u.FH_FIN,horaFin:u.FH_FIN,contenido:u.CONTENIDO,idbanner:u.ID_BANNER,idForm:u.ID_FORMULARIO,id_banner_tipo:u.ID_BANNER_TIPO,editar:"si"},t=i.map(function(n){return JSON.stringify(n)});case 2:return e.a(2,{data:a,salones:t})}},e)}))()},grabar:function(n){return D()(A()().m(function e(){return A()().w(function(e){while(1)switch(e.n){case 0:return e.a(2,on.$http.post("api/HyoBanner/guardarBanner",n))}},e)}))()},eliminar:function(n){return D()(A()().m(function e(){return A()().w(function(e){while(1)switch(e.n){case 0:return e.a(2,on.$http.delete("api/HyoBanner/eliminarBanner",{params:n}))}},e)}))()},encuenstas:function(){return D()(A()().m(function n(){return A()().w(function(n){while(1)switch(n.n){case 0:return n.a(2,on.$http.get("api/frmhistoriaformulario/getSelectEncuestas"))}},n)}))()},obtTiposBanner:function(){return D()(A()().m(function n(){return A()().w(function(n){while(1)switch(n.n){case 0:return n.a(2,on.$http.get("api/HyoBanner/obtTiposBanner"))}},n)}))()}},ln=a(81288);function cn(n){return j.p6.formatDate(n,"YYYY-MM-DDTHH:mm:ss")}var sn={components:{QPopover:j.VM,QCard:E.A,QCardSection:N.A,QForm:q.A,QInput:L.A,QSelect:Q.A,QCheckbox:T.A,QIcon:U.A,QList:H.A,QItem:M.A,QItemSection:X.A,QItemLabel:$.A,QScrollArea:W.A,QSeparator:Y.A,QTabs:P.A,QTab:R.A,QTabPanels:x.A,QTabPanel:z.A,SieVacio:G.A,SieModal:K.A,SieEditor:J.A,SieTree:Z.A,QDatetime:nn.A,QPage:j.Tu},data:function(){return{sie:(0,en["default"])(),listaBanners:[],config:{},dataObj:{titleModal:"Nuevo Banner",titulo:"",cantidad:"",fechaInicio:new Date,horaInicio:new Date,fechaFin:new Date,horaFin:new Date,contenido:"",editar:"no",idForm:null,orden:"",id_banner_tipo:1},tab:"tab-1",search:"",open:!1,ticked:[],minFecha:j.p6.formatDate(new Date,"MM/DD/YYYY"),loadingBanner:!1,visible_list:!1,modalConfig:!1,loadingConfig:!1,encuestas:[],tipos:[]}},computed:{isLess:function(){return(0,ln.isLess)()},isForm:function(){return Object.prototype.hasOwnProperty.call(this.config,"encuesta")&&this.config.encuesta.value},seHabilitaComboTipos:function(){return Object.prototype.hasOwnProperty.call(this.config,"tipos")&&this.config.tipos.value},permisoLE:function(){return this.sie.ruta.nivel>=2},permisoT:function(){return 3===this.sie.ruta.nivel},buttons:function(){var n=this,e=[{icon:"plus",label:"Nuevo",permiso:"===3",click:function(){n.actualizarBanner()}},{icon:"cogs",label:"Configuración",permiso:"===3",click:function(){n.openConfig()}}];return e},encuestaSeleccionada:function(){return this.dataObj.idForm},noGrabaVistas:function(){var n=(0,rn["default"])(this.tipos,this.dataObj.id_banner_tipo,{key:"ID_BANNER_TIPO"});return-1!==n&&0===this.tipos[n].GRABA_VISTAS}},methods:{filtrar:function(){var n=this;return D()(A()().m(function e(){var a;return A()().w(function(e){while(1)switch(e.n){case 0:return a={propia:"",texto:n.search},e.n=1,un.obtBanners(a);case 1:n.listaBanners=e.v;case 2:return e.a(2)}},e)}))()},eliminarBanner:function(n){var e=this;return D()(A()().m(function a(){var t,r,o,i,u;return A()().w(function(a){while(1)switch(a.p=a.n){case 0:return event.stopPropagation(),a.n=1,(0,an.confirmacion)("Se eliminará el banner","¿Está seguro de realizar esta acción?");case 1:if(t=a.v,!t){a.n=6;break}return a.p=2,r={idBanner:n},a.n=3,un.eliminar(r);case 3:return o=a.v,a.n=4,un.obtBanners({propia:e.permisoLE?"S":""});case 4:e.listaBanners=a.v,e.$notify(o,"success"),a.n=6;break;case 5:a.p=5,u=a.v,i=u.error,e.$notify(i.message,"warning");case 6:return a.a(2)}},a,null,[[2,5]])}))()},actualizarBanner:function(n){var e=this;return D()(A()().m(function a(){var t,r,o;return A()().w(function(a){while(1)switch(a.p=a.n){case 0:return a.p=0,e.tab="tab-1",a.n=1,un.obtBanner({idBanner:n});case 1:t=a.v,r=t.data,o=t.salones,e.ticked=o,e.dataObj=r,e.getSelectEncuestas(),e.open=!0,a.n=3;break;case 2:a.p=2,a.v;case 3:return a.a(2)}},a,null,[[0,2]])}))()},grabarBanner:function(){var n=this;return D()(A()().m(function e(){var a,t,r,o,i,u,l,c;return A()().w(function(e){while(1)switch(e.p=e.n){case 0:return e.n=1,n.$refs.form.validate();case 1:if(a=e.v,t=n.ticked,t=t.map(function(n){return JSON.parse(n)}),r=[],(0,tn["default"])(t,function(n){-1===r.indexOf(n.tipcod)&&r.push(n.tipcod)}),n.tab=a?"tab-2":"tab-1",!(t.length>0&&a)){e.n=7;break}return o=n.dataObj,n.loadingBanner=!0,i={titulo:o.titulo,cantidad:o.cantidad,contenido:o.contenido,editar:o.editar,fh_fin:cn((0,ln.fechaTiempo)(o.fechaFin,o.horaFin)),fh_inicio:cn((0,ln.fechaTiempo)(o.fechaInicio,o.horaInicio)),nemos:t,tipcod:r,orden:o.orden,id_banner_tipo:1},o.idForm&&(i.id_form=o.idForm,i.cantidad=1),"si"===o.editar&&(i["idbanner"]=o.idbanner),n.seHabilitaComboTipos&&(i.id_banner_tipo=o.id_banner_tipo,n.noGrabaVistas&&(i.cantidad=1)),u={adjuntos:[],params:i},e.p=2,e.n=3,un.grabar(u);case 3:return e.n=4,un.obtBanners({propia:n.permisoLE?"S":""});case 4:n.listaBanners=e.v,n.$notify("Se grabó correctamente","success"),n.open=!1,e.n=6;break;case 5:e.p=5,c=e.v,l=c.error,n.$notify(l.message,"warning");case 6:n.loadingBanner=!1;case 7:return e.a(2)}},e,null,[[2,5]])}))()},openConfig:function(){var n=this;return D()(A()().m(function e(){return A()().w(function(e){while(1)switch(e.n){case 0:n.modalConfig=!0,n._config();case 1:return e.a(2)}},e)}))()},saveConfig:function(){var n=this;return D()(A()().m(function e(){var a,t,r,o,i;return A()().w(function(e){while(1)switch(e.p=e.n){case 0:return a=n.config,n.loadingConfig=!0,e.p=1,e.n=2,un.grabarConfig({data:a});case 2:t=e.v,r=t.message,n.modalConfig=!1,n.$notify(r,"success"),e.n=4;break;case 3:e.p=3,i=e.v,o=i.error,n.$notify(o.message,"error");case 4:n.loadingConfig=!1;case 5:return e.a(2)}},e,null,[[1,3]])}))()},getSelectEncuestas:function(){var n=this;return D()(A()().m(function e(){return A()().w(function(e){while(1)switch(e.n){case 0:return e.n=1,un.encuenstas();case 1:n.encuestas=e.v;case 2:return e.a(2)}},e)}))()},_config:function(){var n=this;return D()(A()().m(function e(){return A()().w(function(e){while(1)switch(e.n){case 0:return e.n=1,un.config();case 1:return n.config=e.v,e.n=2,un.obtTiposBanner();case 2:n.tipos=e.v;case 3:return e.a(2)}},e)}))()},getFecha:function(n){var e=new Date(n);return e=j.p6.formatDate(e,"D, MMMM YYYY"),e}},created:function(){var n=this;return D()(A()().m(function e(){var a;return A()().w(function(e){while(1)switch(e.n){case 0:return a={propia:n.permisoLE?"S":""},e.n=1,un.obtBanners(a);case 1:n.listaBanners=e.v,n._config();case 2:return e.a(2)}},e)}))()}},dn=a(12807);const fn=(0,dn.A)(sn,[["render",O]]);var bn=fn}}]);