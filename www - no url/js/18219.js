"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[18219],{18219:function(o,e,r){r.r(e),r.d(e,{default:function(){return k}});var a=r(61758),t=r(58790),n={class:"row"},i={class:"col-xs-12 col-sm-6 row"},s={class:"text-h6"},l={class:"col-xs-12 col-sm-6 column"},c={class:"col"},m={class:"col-12 column items-end justify-center"};function u(o,e){var r=(0,a.g2)("q-icon"),u=(0,a.g2)("q-btn"),d=(0,a.g2)("q-card-section"),f=(0,a.g2)("q-separator"),h=(0,a.g2)("formulario"),g=(0,a.g2)("sie-grid"),I=(0,a.g2)("q-card");return(0,a.uX)(),(0,a.Wv)(I,{class:"layout-v1 my-card",flat:"",bordered:""},{default:(0,a.k6)(function(){return[(0,a.bF)(d,null,{default:(0,a.k6)(function(){return[(0,a.Lk)("div",n,[(0,a.Lk)("div",i,[(0,a.bF)(r,{class:"cursor-pointer back",name:"arrow_back",onClick:o.volver},null,8,["onClick"]),(0,a.Lk)("div",s,(0,t.v_)(o.titleForm),1)]),(0,a.Lk)("div",l,[(0,a.Lk)("div",c,[(0,a.Lk)("div",m,[(0,a.Lk)("div",null,[(0,a.bF)(u,{class:"q-mb-xs q-mr-sm",size:"sm",icon:"save",label:"Guardar",color:"primary",onClick:o.submit},null,8,["onClick"])])]),e[0]||(e[0]=(0,a.Lk)("div",{class:"col-12 column items-end justify-center"},null,-1))])])])]}),_:1}),(0,a.bF)(f),(0,a.bF)(d,null,{default:(0,a.k6)(function(){return[(0,a.bF)(h,{ref:"form",schema:o.schema,methods:o.methods,load:o.load},null,8,["schema","methods","load"]),(0,a.Lk)("div",null,[(0,a.bF)(g,{class:"fix-tab-height ag-theme-balham",columnDefs:o.columnDefs,rowData:o.rowData,frameworkComponents:o.frameworkComponents,onGridReady:o.onGridReady,rowSelection:"multiple"},null,8,["columnDefs","rowData","frameworkComponents","onGridReady"])])]}),_:1})]}),_:1})}r(52133),r(10239),r(50310),r(6724),r(11777),r(83190);var d=r(6123),f=r(80660),h=r(10213),g=r(88567),I=r(95718),A=r(20456),p=r(53380),_=r(3112),C=r(19852),D=r(36408),v=r(27560),R=r(96330),b={components:{QCheckbox:_.A,QCard:g.A,QCardSection:I.A,QCardActions:A.A,QSeparator:p.A,formulario:C.A,sieGrid:D.A,footerGrid:v.A,headerGrid:R.A,QIcon:d.bP,QBtn:d.Il},props:{id:[Number,String]},data:function(){var o=this;return{frameworkComponents:null,columnDefs:[],rowData:[],schema:null,repetir:!1,title:"",titleForm:"Asignar Categor√≠a",methods:{ID_CATEGORIA_ANO:function(e){var r=e.ID_CATEGORIA_ANO,a=e.ID_PERFIL;r&&a&&o.getPersonas({ID_CATEGORIA_ANO:r,ID_PERFIL:a})},ID_PERFIL:function(e){var r=e.ID_CATEGORIA_ANO,a=e.ID_PERFIL;r&&a&&o.getPersonas({ID_CATEGORIA_ANO:r,ID_PERFIL:a})}},load:function(o){}}},methods:{volver:function(){this.$router.push({name:"tesoreria.asignacionCategoriaPagoPerfil.listar"})},onGridReady:function(o){this.api=o.api},nuevoCalendario:function(){var o=this,e=this.$refs.form.getForm();e.then(function(e){e.success&&delete e.form.ID_CATEGORIA_PERSONA,o.$refs.form.clear()}),this.$router.push({name:"tesoreria.asignacionCategoriaPagoPerfil.form"})},submit:function(){var o=this;if(this.id){var e=this.$refs.form.getForm();e.then(function(e){e.success&&(o.$q.loading.show(),e.form.ID_CATEGORIA_PERSONA=o.id,f.$http.post("api/cobroController/updateCategoriaPersona",{data:e.form}).then(function(e){(0,h.alert)(e.message,"success"),o.$q.loading.hide()}))})}else{var r=this.$refs.form.getForm();r.then(function(e){if(e.success){var r=o.api.getSelectedRows(),a=[];r.map(function(o){a.push({ID_CATEGORIA_ANO:e.form.ID_CATEGORIA_ANO,ID_PERFIL:e.form.ID_PERFIL,ID_PERSONA:o.ID_PERSONA,MESINI:e.form.MESINI,MESFIN:e.form.MESFIN})}),o.$q.loading.show(),f.$http.post("api/cobroController/addCategoriaPersona",{data:a}).then(function(e){(0,h.alert)(e.message,"success"),o.rowData=[],o.$refs.form.clear(),o.repetir||o.$router.push({name:"tesoreria.asignacionCategoriaPagoPerfil.form",params:{id:e.data.ID_CATEGORIA_PERSONA}}),o.$q.loading.hide()}).catch(function(e){var r=e.error;(0,h.alert)(r.message,"warning"),o.$q.loading.hide()})}})}},getPersonas:function(o){var e=this,r=o.ID_CATEGORIA_ANO,a=o.ID_PERFIL,t={id_categoria_ano:r,id_perfil:a};f.$http.get("api/cobroController/getPersonasXCategoria",{params:{params:t}}).then(function(o){e.rowData=o,console.log(o)})}},mounted:function(){var o=this;this.columnDefs=[{headerName:"ID",field:"ID_PERSONA",sortable:!0,hide:!0,width:50},{headerName:"Nombre",field:"NOMBRE",sortable:!0,width:850}],f.$http.get("api/formularioController/getFormulario",{params:{id:96}}).then(function(e){o.title=e.nombre,o.schema=e.data,o.id&&f.$http.get("api/cobroController/getCategoriaPersona",{params:{params:{id_categoria_persona:o.id}}}).then(function(e){o.$refs.form.loadModel(e)})})}},E=r(12807);const P=(0,E.A)(b,[["render",u]]);var k=P}}]);