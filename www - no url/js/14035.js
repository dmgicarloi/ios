"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[14035],{14035:function(e,t,o){o.r(t),o.d(t,{default:function(){return be}});var i=o(61758),r=o(29104),a={class:"column col"},n={class:"row _filtros"},l={class:"col-12"},s={class:"row q-pa-sm q-col-gutter-sm"},c={class:"col-xs-12 col-md-2"},u={key:0,class:"col-xs-12 col-md-2"},d={key:0,class:"row q-pl-sm q-pr-sm q-pb-sm"},p={class:"col-xs-12 col-md-2"},f={key:0,class:"col-xs-12 col-md-2"},v={key:1,class:"col-xs-12 col-md-2"},h={key:1,class:"row q-gutter-sm q-pl-sm q-pr-sm q-pb-sm"},m={key:0,class:"col-xs-12 col-md-2"},O={class:"row col"};function g(e,t){var o=(0,i.g2)("q-select"),g=(0,i.g2)("sie-vacio"),S=(0,i.g2)("graficos"),b=(0,i.g2)("q-page");return(0,i.uX)(),(0,i.Wv)(b,{class:"estadistica-red"},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",a,[(0,i.Lk)("div",n,[(0,i.Lk)("div",l,[(0,i.Lk)("div",s,[(0,i.Lk)("div",c,[(0,i.bF)(o,{modelValue:e.tipoReporte,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.tipoReporte=t}),options:e.optTipoReporte,preSelect:e.preSelected,label:"Enfoque",onSelected:e.seleccionarEnfoque},null,8,["modelValue","options","preSelect","onSelected"])]),e.isPorPeriodo&&e.tipoReporte?((0,i.uX)(),(0,i.CE)("div",u,[(0,i.bF)(o,{modelValue:e.periodo,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.periodo=t}),options:e.periodos,preSelect:e.preSelected,label:"Periodo",onSelected:e.seleccionarPeriodo},null,8,["modelValue","options","preSelect","onSelected"])])):(0,i.Q3)("v-if",!0)]),e.isSeleccionValida&&"porCompetencia"===e.tipoReporte?((0,i.uX)(),(0,i.CE)("div",d,[(0,i.Lk)("div",p,[(0,i.bF)(o,{modelValue:e.filtroNGS.instrucod,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.filtroNGS.instrucod=t}),options:e.niveles,label:e.$t("ngs.nivel"),preSelect:e.preSelected,onSelected:t[3]||(t[3]=function(t){return e.seleccionarNGS("n")})},null,8,["modelValue","options","label","preSelect"])]),e.filtroNGS.instrucod?((0,i.uX)(),(0,i.CE)("div",f,[(0,i.bF)(o,{modelValue:e.filtroNGS.gradocod,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.filtroNGS.gradocod=t}),options:e.grados,label:e.$t("ngs.grado"),preSelect:e.preSelected,onSelected:t[5]||(t[5]=function(t){return e.seleccionarNGS("g")})},null,8,["modelValue","options","label","preSelect"])])):(0,i.Q3)("v-if",!0),e.filtroNGS.gradocod?((0,i.uX)(),(0,i.CE)("div",v,[(0,i.bF)(o,{modelValue:e.filtroNGS.id_ambito,"onUpdate:modelValue":t[6]||(t[6]=function(t){return e.filtroNGS.id_ambito=t}),options:e.ambitos,label:e.$t("ambito"),preSelect:e.preSelected,onSelected:t[7]||(t[7]=function(t){return e.seleccionarNGS("s")})},null,8,["modelValue","options","label","preSelect"])])):(0,i.Q3)("v-if",!0)])):(0,i.Q3)("v-if",!0),e.isSeleccionValida?((0,i.uX)(),(0,i.CE)("div",h,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.FILTROS,function(t,r){return(0,i.uX)(),(0,i.CE)(i.FK,null,[t.visible?((0,i.uX)(),(0,i.CE)("div",m,[(0,i.bF)(o,{modelValue:t.idOption,"onUpdate:modelValue":function(e){return t.idOption=e},options:t.dataOption,preSelect:e.preSelected,onSelected:function(o){return e.seleccionarFiltro(t,r)},label:t.label},null,8,["modelValue","onUpdate:modelValue","options","preSelect","onSelected","label"])])):(0,i.Q3)("v-if",!0)],64)}),256))])):(0,i.Q3)("v-if",!0)])]),(0,i.Lk)("div",O,[e.mostrarAviso?(0,i.bo)(((0,i.uX)(),(0,i.Wv)(g,{key:0,class:"col"},null,512)),[[r.aG,e.mostrarAviso]]):e.isSeleccionValida&&e.loadGrafico?((0,i.uX)(),(0,i.Wv)(S,{key:1,class:"q-mt-lg-xs q-mt-md-xs",ref:"refGraficos",tituloReporte:e.tituloReporte,tipoGrafica:e.tipoGrafica,tipoReporte:e.tipoReporte,periodo:e.periodo,maxPeriodo:e.maxPeriodo,keyFiltro:e.keyFiltro,filtroNGS:e.filtroNGS,FILTROS:e.FILTROS,FILTROS_INDEX:e.FILTROS_INDEX,onVolver:e._volver,onDetalleGrafico:e._detalleGrafico,onSetOptions:e._setOptions,onFinishLoadApi:e._finishLoadApi},null,8,["tituloReporte","tipoGrafica","tipoReporte","periodo","maxPeriodo","keyFiltro","filtroNGS","FILTROS","FILTROS_INDEX","onVolver","onDetalleGrafico","onSetOptions","onFinishLoadApi"])):(0,i.Q3)("v-if",!0)])])]}),_:1})}var S=o(76080),b=o.n(S),k=o(45254),y=o.n(k),F=(o(12563),o(74260),o(39866),o(77507),o(10239),o(50310),o(32203),o(90095),o(9240),o(83190),o(27153),o(13715),o(6123)),P=o(16648),G=o(58790),E={class:"bg-white col graficos q-pa-sm relative-position scroll-y full-height"},I=["id"],L={class:"row justify-end"},T={class:"col-md-12 col-12 text-center self-center"},R={class:"q-subheading"},C={class:"q-title q-mt-md-sm"},N={class:"q-title q-mt-md-sm"},_={class:"q-title"},w={class:"q-subheading q-mt-md-sm"},q={class:"q-subheading q-mt-md-sm"},x={class:"row justify-center q-mt-lg-sm",id:"graficoPadre"},A={class:"row q-mb-md-sm"},D={key:0},X={class:"q-pa-lg-md q-pa-xs"},V={class:"q-pa-md-sm q-pl-lg-md q-pr-lg-md text-footer-profe"},Q={class:"float-right"},$={class:"col text-center"},j={class:"row q-mt-lg-sm",id:"graficoHijos"},B={class:"q-pa-xs q-pl-lg-md q-pr-lg-md"},K={class:"q-pa-md-sm q-pl-lg-md q-pr-lg-md text-footer-profe"},U={class:"float-right"},M={class:"col text-center"};function W(e,t){var o=(0,i.g2)("q-spinner-oval"),a=(0,i.g2)("q-inner-loading"),n=(0,i.g2)("sie-vacio"),l=(0,i.g2)("q-tooltip"),s=(0,i.g2)("q-btn"),c=(0,i.g2)("sie-chart"),u=(0,i.g2)("q-card-separator"),d=(0,i.g2)("q-card-actions"),p=(0,i.g2)("q-card");return(0,i.uX)(),(0,i.CE)("div",E,[(0,i.bF)(a,{class:"q-ma-md-sm bg-white",visible:e.loadingApi},{default:(0,i.k6)(function(){return[(0,i.bF)(o,{size:"50px",color:"primary"})]}),_:1},8,["visible"]),e.chartGeneral.chart?((0,i.uX)(),(0,i.CE)("div",{key:1,id:e.idGrafico},[(0,i.Lk)("div",L,[(0,i.Lk)("div",T,[e.tituloReporte.titulo1?((0,i.uX)(),(0,i.CE)(i.FK,{key:0},[(0,i.Lk)("div",R,(0,G.v_)(e.tituloReporte.titulo),1),(0,i.Lk)("div",C,(0,G.v_)(e.tituloReporte.titulo1),1),(0,i.Lk)("div",N,(0,G.v_)(e.tituloReporte.titulo2),1)],64)):((0,i.uX)(),(0,i.CE)(i.FK,{key:1},[(0,i.Lk)("div",_,(0,G.v_)(e.tituloReporte.titulo),1),(0,i.Lk)("div",w,(0,G.v_)(e.tituloReporte.titulo1),1),(0,i.Lk)("div",q,(0,G.v_)(e.tituloReporte.titulo2),1)],64))])]),(0,i.Lk)("div",x,[(0,i.Lk)("div",{class:(0,G.C4)(["col-xs-12 q-pa-xs",{"col-md-6":e.isPorPeriodo}])},[(0,i.Lk)("div",A,[e.optTipoGrafica.length>1?((0,i.uX)(),(0,i.CE)("div",D,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.optTipoGrafica,function(t){return(0,i.uX)(),(0,i.Wv)(s,{key:t.value,class:"q-ml-md-md",icon:t.icon,color:"primary",onClick:function(o){return e.cambiarTipoGrafica(t.value)}},{default:(0,i.k6)(function(){return[(0,i.bF)(l,null,{default:(0,i.k6)(function(){return[(0,i.eW)((0,G.v_)(t.label),1)]}),_:2},1024)]}),_:2},1032,["icon","onClick"])}),128))])):(0,i.Q3)("v-if",!0)]),(0,i.bF)(p,null,{default:(0,i.k6)(function(){return[(0,i.Lk)("div",X,[(0,i.bF)(c,{style:{height:"220px"},options:e.chartGeneral.chart.chartOptions,data:e.chartGeneral.chart.data,series:e.chartGeneral.chart.series,categories:e.chartGeneral.chart.categories,type:e.typeChart,colors:e.chartGeneral.chart.colors},null,8,["options","data","series","categories","type","colors"])]),e.chartGeneral.profesor?((0,i.uX)(),(0,i.CE)(i.FK,{key:0},[(0,i.bF)(u),(0,i.Lk)("div",V,[t[1]||(t[1]=(0,i.Lk)("span",{class:"text-bold"},"Profesor",-1)),(0,i.Lk)("span",Q,(0,G.v_)(e.chartGeneral.profesor),1)])],64)):(0,i.Q3)("v-if",!0),e.showBtnVolver?((0,i.uX)(),(0,i.CE)(i.FK,{key:1},[(0,i.bF)(u),(0,i.bF)(d,null,{default:(0,i.k6)(function(){return[(0,i.Lk)("div",$,[(0,i.bF)(s,{size:"md",label:e.$t("botones.volver"),color:"primary",onClick:t[0]||(t[0]=function(t){return e.volver()})},null,8,["label"])])]}),_:1})],64)):(0,i.Q3)("v-if",!0)]}),_:1})],2)]),(0,i.Lk)("div",j,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.graficas,function(o,r){var a=o.chart,n=o.idOption,l=o.keyFiltroDet,f=(o.totalSN,o.totalSEQ,o.totalVacio,o.profesor);return(0,i.uX)(),(0,i.CE)("div",{key:r,class:(0,G.C4)(["col-xs-12 q-pa-xs",{"col-md-4":e.isPorPeriodo}])},[(0,i.bF)(p,null,{default:(0,i.k6)(function(){return[(0,i.Lk)("div",B,[(0,i.bF)(c,{style:{height:"220px"},options:a.chartOptions,data:a.data,series:a.series,categories:a.categories,type:e.typeChart,colors:a.colors},null,8,["options","data","series","categories","type","colors"])]),f?((0,i.uX)(),(0,i.CE)(i.FK,{key:0},[(0,i.bF)(u),(0,i.Lk)("div",K,[t[2]||(t[2]=(0,i.Lk)("span",{class:"text-bold"},"Profesor",-1)),(0,i.Lk)("span",U,(0,G.v_)(f),1)])],64)):(0,i.Q3)("v-if",!0),(0,i.bF)(u),e.showBtnDetalle?((0,i.uX)(),(0,i.Wv)(d,{key:1},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",M,[(0,i.bF)(s,{size:"md",label:e.$t("botones.detalle"),color:"primary",onClick:function(t){return e.detalleGrafico(l,n)}},null,8,["label","onClick"])])]}),_:2},1024)):(0,i.Q3)("v-if",!0)]}),_:2},1024)],2)}),128))])],8,I)):(0,i.bo)(((0,i.uX)(),(0,i.Wv)(n,{key:0,class:"col"},null,512)),[[r.aG,!e.chartGeneral.chart]])])}o(52133),o(25751),o(6724),o(62692);var z=o(10270),H=o(80340),J=(o(68017),o(49405));function Z(e){return!isNaN(e-parseFloat(e))}var Y="INC";function ee(){var e={AD:{orden:-10,color:"#18b1a3"},A:{orden:-9,color:"#40e3c2"},B:{orden:-8,color:"#ffbc47"},C:{orden:-7,color:"#f65e5d"},"":{orden:-6,color:"#e7e4e4"},SN:{orden:-5,color:"#b4e4ea"},SEQ:{orden:-4,color:"#b4e4ea"}};return e}var te=function(e,t,o,i){var r=!1,a=!0;t&&(r=!1,a=!1,o=!0);var n={layout:{padding:{bottom:r?0:18}},responsive:!0,maintainAspectRatio:!1,legend:{onClick:function(e,o){var r=o.text;t&&(r=String(r.split("-")[0]).trim());var a=r===Y?"":r;i(a)},display:o,position:"right",labels:{fontColor:"#000",fontStyle:"normal"}},scales:{yAxes:[{display:a,ticks:{stepSize:20,suggestedMin:0,suggestedMax:100,callback:function(e,t,o){return e>100?" ":e}}}],xAxes:[{display:r,ticks:{padding:10}}]},title:{display:!0,text:e,fontColor:"#414141"},tooltips:{enabled:t,callbacks:{label:function(e,t){return t.datasets[e.datasetIndex].data[e.index]+"%"}}},animation:{duration:500,onComplete:function(){if(!t){var e=this.chart,o=e.ctx;o.textAlign="center",o.textBaseline="bottom",o.fillStyle="#666",this.data.datasets.forEach(function(t,i){var r=e.controller.getDatasetMeta(i);r.data.forEach(function(e,i){var r=t.data[i]+"%";o.fillText(r,e._model.x,e._model.y-4),o.fillText(e._model.datasetLabel,e._model.x,e._model.base+18)})})}}}};return n},oe=function(e,t){var o=[],i=e.split(" ");if(e.length>65&&i.length>0){var r="";i.forEach(function(e){r.length>0&&r.length+e.length>65&&(o.push(r),r=""),r=r.length>0?r+" "+e:e}),o.push(r)}else o.push(e);return o.push(""),o},ie=function(e){var t=ee(),o=e.map(function(e){var o=999;return Z(e)?o=parseInt(e,10):t.hasOwnProperty(e)&&(o=t[e].orden),{orden:o,nota:e}});return o.sort(function(e,t){return e.orden-t.orden}),o.map(function(e){return{nota:e.nota}})},re=function(e){var t=[];for(var o in e){var i=0;for(var r in e[o]){var a=e[o][r];i+=a}t.push({periodo:o,totalPeriodo:i,label:"Periodo "+o})}return t},ae=function(e,t,o,i,r,a,n){var l="pie"===e||"doughnut"===e,s=ee(),c=[],u=[],d=[],p=0,f=0,v=0,h=0,m=0,O=re(o.categorias),g=ie(t);g.forEach(function(e){var t=e.nota,i=["AD","A","B","C"].includes(t),r=[];if(O.forEach(function(e){var i=e.periodo,a=e.totalPeriodo,n=o.categorias[i];if(n.hasOwnProperty(t)){var l=n[t],s=100*l/a,c=(0,J.toFixed)(s,s<1?2:1);s<1&&"0.00"===c&&(c="0.01"),"B"===t||"C"===t?p+=parseFloat(c):"AD"!==t&&"A"!==t||(f+=parseFloat(c)),"SN"===t?v+=l:"SEQ"===t?h+=l:""===t&&(m+=l),r.push(c)}else r.push(null)}),i){if(o.series.includes(t)){var a=""===t?Y:t,n=s.hasOwnProperty(t)?s[t].color:"";l?c.push(a+" - "+r.join(" ; ")+" %"):c.push(a),u.push(n)}else c.push(""),u.push("#ffffff");d.push(r)}});var S=oe(i,r);return{chart:{chartOptions:te(S,l,a,n),data:d,series:c,categories:O.map(function(e){return e.label}),colors:u},porcentajeBC:p,porcentajeAD:f,profesor:r,totalSN:v,totalSEQ:h,totalVacio:m}},ne=ae,le=(o(70199),o(515),o(7346),o(30276)),se={COLEGIO:"colegio",PROFESOR:"profesor",NIVEL:"nivel",GRADO:"grado",AMBITO:"ambito",CLASE:"clase",CURSO:"curso",RECURSO:"recurso",COMPETENCIA:"competencia"},ce={colegio:{label:"colegio",dataOption:[{value:1,label:"Toda la Institución Educativa"}],idOption:1,keyParam:"colegio"},profesor:{label:"Profesor",dataOption:[],idOption:null,keyParam:"profcod"},nivel:{label:(0,le.$t)("ngs.nivel"),dataOption:[],idOption:null,keyParam:"instrucod"},grado:{label:(0,le.$t)("ngs.grado"),dataOption:[],idOption:null,keyParam:"gradocod"},ambito:{label:(0,le.$t)("ambito"),dataOption:[],idOption:null,keyParam:"id_ambito"},clase:{label:(0,le.$t)("curso"),dataOption:[],idOption:null,keyParam:"id_clase"},curso:{label:(0,le.$t)("curso"),dataOption:[],idOption:null,keyParam:"cursocod"},recurso:{label:"Recurso",dataOption:[],idOption:null,keyParam:"id_recurso"},competencia:{label:"Competencia",dataOption:[],idOption:null,keyParam:"id_compecod"}},ue=function(){var e=y()(b()().m(function e(t){var o,i,r,a,n;return b()().w(function(e){while(1)switch(e.n){case 0:return o=JSON.parse(JSON.stringify(ce)),i=[],r=[],"porNivel"===t?(i=["colegio","nivel","grado","ambito","clase","recurso","competencia"],r=["clase","recurso","competencia"]):"porCurso"===t?(i=["colegio","curso","nivel","grado","ambito","recurso","competencia"],r=["ambito","recurso","competencia"]):"porCompetencia"===t?(i=["colegio","curso","recurso","competencia"],r=["curso","recurso","competencia"]):"porProfesor"===t&&(i=["colegio","nivel","profesor","curso","ambito","recurso","competencia"],r=[]),a={},n=i.map(function(e,t){var i=o[e];return i.visible=!0,i.key=e,i.addProfeGeneral=r.includes(e),i.showRN=!!i.isNivelEva,i.isNivelEva=!!i.isNivelEva,i.nivelEva=i.nivelEva?i.nivelEva:null,a[e]=t,i}),e.a(2,{FILTROS:n,FILTROS_INDEX:a})}},e)}));return function(t){return e.apply(this,arguments)}}(),de={options:function(e){return y()(b()().m(function t(){var o;return b()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,ue(e);case 1:return o=t.v,t.a(2,o)}},t)}))()},getTextPrimerNivel:function(){return y()(b()().m(function e(){var t;return b()().w(function(e){while(1)switch(e.n){case 0:return t="competencia",e.a(2,t)}},e)}))()},TIPO:se},pe=o(80660),fe={getOptSalones:function(){return y()(b()().m(function e(){var t,o,i,r;return b()().w(function(e){while(1)switch(e.p=e.n){case 0:return e.p=0,t={},e.n=1,pe.$http.get("api/HyoEstadistica/optNGS",{params:{datos:t}});case 1:return o=e.v,i=o.json,e.a(2,i);case 2:return e.p=2,r=e.v,e.a(2,r)}},e,null,[[0,2]])}))()},maxPerinum:function(){return y()(b()().m(function e(){var t,o,i,r;return b()().w(function(e){while(1)switch(e.n){case 0:return e.n=1,pe.$http.get("api/HyoAmbito/maxPerinum");case 1:if(t=e.v,o=t.json,i=[{value:null,label:"Seleccione"}],1===o.estado)for(r=1;r<=o.perinum;r++)i.push({label:"Periodo "+r,value:r});return e.a(2,i)}},e)}))()},getEstadisticas:function(e){return y()(b()().m(function t(){return b()().w(function(t){while(1)switch(t.n){case 0:return t.a(2,pe.$http.post("api/krismar/getEstadisticas",{datos:e}))}},t)}))()}},ve={emits:["finishLoadApi","detalleGrafico","volver","setOptions"],components:{QInnerLoading:F.SQ,QSpinnerOval:F.VA,SieChart:z.A,SieVacio:H.A,QBtn:F.Il,QTooltip:F.nC,QCard:F.C$,QCardSeparator:F.d6,QCardActions:F.zZ},props:{ordenCalificacion:{required:!1,type:String,default:"BC"},tipoGrafica:{required:!0,type:String,default:"bar"},tipoReporte:{required:!0,type:String},periodo:{required:!0},maxPeriodo:{required:!0},keyFiltro:{required:!0,type:String},tituloReporte:{required:!0,type:Object},filtroNGS:{required:!0,type:Object},FILTROS:{required:!0,type:Array},FILTROS_INDEX:{required:!0,type:Object}},data:function(){return{idGrafico:"grafico_"+(new Date).getTime(),TIPO:de.TIPO,typeChart:this.tipoGrafica,DATA_REPORTE:[],ordenTipo:this.ordenCalificacion,optOrden:[{value:"BC",label:"Ordenar por menor número satisfactorios"},{value:"AD",label:"Ordenar por mayor número satisfactorios"}],loadingApi:!1,graficas:[],chartGeneral:{}}},computed:{optTipoGrafica:function(){return this.isPorPeriodo?[{value:"bar",label:"Barras",icon:"insert_chart"},{value:"pie",label:"Circular",icon:"pie_chart"}]:[{value:"bar",label:"Barras",icon:"insert_chart"}]},showBtnVolver:function(){return this.keyFiltro!==this.TIPO.COLEGIO},showBtnDetalle:function(){var e=this.FILTROS_INDEX[this.keyFiltro];return e!==this.FILTROS.length-2||null===this.FILTROS[e].idOption},isPorPeriodo:function(){return!0}},methods:{paramsApi:function(e){var t=this.FILTROS,o={tipoReporte:this.tipoReporte,tipoDetalle:e,periodo:this.periodo,maxPeriodo:this.maxPeriodo,ngs:{instrucod:this.filtroNGS.instrucod,gradocod:this.filtroNGS.gradocod,id_ambito:this.filtroNGS.id_ambito}};return t.forEach(function(e){o[e.keyParam]=e.idOption}),o},getEstadistica:function(e){var t=this;return y()(b()().m(function o(){var i,r,a;return b()().w(function(o){while(1)switch(o.p=o.n){case 0:return t.loadingApi=!0,o.p=1,i=t.paramsApi(e),o.n=2,fe.getEstadisticas(i);case 2:return r=o.v,t.loadingApi=!1,o.a(2,r);case 3:return o.p=3,a=o.v,console.error(a),t.$notify("Ha ocurrido un problema de conexión vuelve a intentarlo","warning"),t.loadingApi=!1,o.a(2,{})}},o,null,[[1,3]])}))()},mostrarEstadistica:function(){var e=this;return y()(b()().m(function t(){var o,i;return b()().w(function(t){while(1)switch(t.n){case 0:return o=e.keyFiltro,i=e.FILTROS[e.FILTROS_INDEX[o]+1].key,t.n=1,e.getEstadistica(i);case 1:e.DATA_REPORTE=t.v,e.$emit("finishLoadApi",!0),e.setGraficas(o,i,e.typeChart),e.setOptions(i);case 2:return t.a(2)}},t)}))()},ordenar:function(){this.cambiarTipoGrafica(this.typeChart)},cambiarTipoGrafica:function(e){this.typeChart=e;var t=this.FILTROS[this.FILTROS_INDEX[this.keyFiltro]+1].key;this.setGraficas(this.keyFiltro,t,e)},detalleGrafico:function(e,t){this.$emit("detalleGrafico",e,t)},volver:function(){this.$emit("volver")},setOptions:function(e){var t=this.graficas.map(function(e){return{value:e.idOption,label:e.titleChart,orden:e.ordenOption}});t.sort(function(e,t){return e.orden-t.orden}),t.unshift({value:null,label:"Todos"}),this.$emit("setOptions",e,t)},setGraficas:function(e,t,o){for(var i=this.DATA_REPORTE,r={},a={},n="",l=0,s=0;s<i.length;s++){var c=i[s],u=c.ID_OPCION,d=c.PERIODO,p=c.NOTA;r.hasOwnProperty(u)||(l++,r[u]={orden:l,idOption:u,keyFiltroDet:t,titleChart:c.LABEL,rowData:c,series:[],categorias:{}},n=c.PROFESOR),r[u].series.includes(p)||r[u].series.push(p),r[u].categorias.hasOwnProperty(d)||(r[u].categorias[d]={}),r[u].categorias[d][p]=c.TOTAL,a.hasOwnProperty(d)||(a[d]={}),a[d].hasOwnProperty(p)||(a[d][p]=0),a[d][p]+=c.TOTAL}var f=[];for(var v in a)for(var h in a[v])f.includes(h)||f.push(h);var m={series:f,categorias:a},O=this.FILTROS[this.FILTROS_INDEX[e]],g=O.dataOption.find(function(e){return e.value===O.idOption}).label,S=this.isPorPeriodo&&O.addProfeGeneral?n:"";this.chartGeneral=ne(o,f,m,g,S);var b=[];for(var k in r){var y=r[k],F=ne(o,f,y,y.titleChart,y.rowData.PROFESOR);F.idOption=y.idOption,F.titleChart=y.titleChart,F.keyFiltroDet=y.keyFiltroDet,F.ordenOption=y.orden,F.ordenPorcentaje="BC"===this.ordenTipo?F.porcentajeBC:F.porcentajeAD,b.push(F)}b.sort(function(e,t){return e.ordenPorcentaje-t.ordenPorcentaje}).reverse(),this.graficas=b}},created:function(){this.mostrarEstadistica()}},he=o(12807);const me=(0,he.A)(ve,[["render",W]]);var Oe=me,ge={components:{QSelect:P.S,Graficos:Oe,SieVacio:H.A,QPage:F.Tu},data:function(){return{mostrarAviso:!1,loadingGrafico:!1,loadGrafico:!1,tipoGrafica:"bar",TIPO:de.TIPO,FILTROS:[],FILTROS_INDEX:{},filtroNGS:{instrucod:null,gradocod:null,id_ambito:null},keyFiltro:null,maxPeriodo:null,periodo:null,periodos:[],tipoReporte:null,optTipoReporte:[{value:null,label:"Seleccione"},{value:"porNivel",label:"Por nivel"},{value:"porCurso",label:"Por curso"},{value:"porCompetencia",label:"Por curso - competencia"},{value:"porProfesor",label:"Por profesor"}],optNGS:[],textLabePrimerNivel:"competencia"}},computed:{isSeleccionValida:function(){var e=!!this.tipoReporte;return this.isPorPeriodo&&e&&(e=!!this.periodo),e},isPorPeriodo:function(){return!0},niveles:function(){var e=[{value:null,label:"Todos"}];for(var t in this.optNGS)e.push({value:this.optNGS[t].id,label:this.optNGS[t].label});return e},grados:function(){var e=[{value:null,label:"Todos"}];if(null!==this.filtroNGS.instrucod){var t=this.optNGS[this.filtroNGS.instrucod].grados;for(var o in t)e.push({value:t[o].id,label:t[o].label})}return e},ambitos:function(){var e=[{value:null,label:"Todos"}];if(null!==this.filtroNGS.gradocod){var t=this.optNGS[this.filtroNGS.instrucod].grados[this.filtroNGS.gradocod].ambitos;for(var o in t)e.push({value:t[o].id,label:t[o].label})}return e},tituloReporte:function(){var e=this;if(this.FILTROS.length){for(var t=[],o=[],i=this.FILTROS.some(function(t){return t.key===e.TIPO.AMBITO&&t.idOption}),r=!1,a=function(){var a=e.FILTROS[n];if(a.idOption&&a.key!==e.TIPO.COLEGIO){var l=a.dataOption.find(function(e){return e.value===a.idOption});if([e.TIPO.NIVEL,e.TIPO.GRADO].includes(a.key)&&i)return 1;a.idOption&&a.key===e.TIPO.COMPETENCIA&&(r=!0),r?o.push(l.label):t.push(l.label)}},n=0;n<this.FILTROS.length;n++)a();this.tituloNgs&&t.push(this.tituloNgs);var l="Porcentaje de logro por "+this.textLabePrimerNivel+(this.isComparativo?"":" - Periodo "+this.periodo);return{titulo:l,titulo1:t.join(" / "),titulo2:o.join(" / ")}}return{titulo:"",titulo1:"",titulo2:""}}},methods:{init:function(e){var t=this;return y()(b()().m(function o(){var i;return b()().w(function(o){while(1)switch(o.n){case 0:if(e&&(t.periodo=null),t.loadGrafico=!1,t.tipoGrafica="bar",t.filtroNGS={instrucod:null,gradocod:null,id_ambito:null},!t.isSeleccionValida){o.n=2;break}return o.n=1,de.options(t.tipoReporte);case 1:i=o.v,t.FILTROS=i.FILTROS,t.FILTROS_INDEX=i.FILTROS_INDEX,t.mostrarEstadistica(t.FILTROS[0].key,!0);case 2:return o.a(2)}},o)}))()},seleccionarEnfoque:function(){this.init(!1,!0)},seleccionarPeriodo:function(){this.init(!1,!1)},seleccionarFiltro:function(e,t){var o=e.key;null===e.idOption&&(o=this.FILTROS[t-1].key),this.mostrarEstadistica(o)},seleccionarNGS:function(e){"n"===e?(this.filtroNGS.gradocod=null,this.filtroNGS.id_ambito=null):"g"===e&&(this.filtroNGS.id_ambito=null),this.mostrarEstadistica(this.keyFiltro)},mostrarEstadistica:function(e){var t=this;return y()(b()().m(function o(){var i;return b()().w(function(o){while(1)switch(o.n){case 0:if("porCompetencia"!==t.tipoReporte){o.n=1;break}if(i=t.FILTROS[t.FILTROS_INDEX["curso"]].idOption,!i||t.filtroNGS.gradocod){o.n=1;break}return t.$notify("Debe seleccionar un nivel y grado","error"),t.mostrarAviso=!0,o.a(2,!1);case 1:return t.mostrarAviso=!1,t.loadingGrafico=!0,t.keyFiltro=e,t.resetearDataFiltro(e),o.n=2,t.reinicarComponente();case 2:return o.a(2)}},o)}))()},resetearDataFiltro:function(e){var t=this,o=this.FILTROS_INDEX[e];this.FILTROS.forEach(function(e,i){e.visible=e.key!==t.TIPO.COLEGIO&&i<=o+1&&i<t.FILTROS.length-1,i>o&&(e.idOption=null,e.dataOption=[])})},reinicarComponente:function(){var e=this;return y()(b()().m(function t(){return b()().w(function(t){while(1)switch(t.n){case 0:return e.loadGrafico=!1,t.n=1,e.$nextTick();case 1:e.loadGrafico=!0;case 2:return t.a(2)}},t)}))()},preSelected:function(){return this.loadingGrafico?(this.$notify("Por favor espere que cargue la información anterior","warning"),Promise.reject(new Error("error"))):Promise.resolve(!0)},_finishLoadApi:function(){this.loadingGrafico=!1},_detalleGrafico:function(e,t){this.FILTROS[this.FILTROS_INDEX[e]].idOption=t,this.mostrarEstadistica(e)},_volver:function(){var e=this.FILTROS[this.FILTROS_INDEX[this.keyFiltro]-1].key;this.mostrarEstadistica(e)},_setOptions:function(e,t){this.FILTROS[this.FILTROS_INDEX[e]].dataOption=t}},created:function(){var e=this;return y()(b()().m(function t(){return b()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,fe.getOptSalones();case 1:return e.optNGS=t.v,t.n=2,fe.maxPerinum();case 2:return e.periodos=t.v,e.maxPeriodo=e.periodos[e.periodos.length-1].value,t.n=3,de.getTextPrimerNivel();case 3:e.textLabePrimerNivel=t.v,e.init();case 4:return t.a(2)}},t)}))()}};const Se=(0,he.A)(ge,[["render",g]]);var be=Se}}]);