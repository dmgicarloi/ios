"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[66610],{66610:function(e,t,n){n.r(t),n.d(t,{default:function(){return M}});var i=n(8445),a=n.n(i),o=(n(71225),n(50310),n(5962),n(83190),n(61758)),l=n(58790),s={class:"text-bold"},u={class:"q-card q-mt-xs"},r={class:"row q-ma-xs"},d={class:"row"},c={class:"row text-bold q-item-label"},f={class:"row q-item-label"},m={class:"row q-item-sublabel"},v={key:0,class:"text-bold"},h={key:0,class:"row q-item-sublabel"},p={class:"row"},b={key:0,class:"row q-item-sublabel justify-end"},E={class:"row q-item-sublabel justify-end"};function g(e,t){var n=(0,o.g2)("q-item-tile"),i=(0,o.g2)("q-item-main"),g=(0,o.g2)("q-item"),k=(0,o.g2)("q-list"),R=(0,o.g2)("sie-modal"),S=(0,o.g2)("header-btn"),_=(0,o.g2)("q-search"),F=(0,o.g2)("q-datetime"),Q=(0,o.g2)("q-toggle"),C=(0,o.g2)("q-icon"),D=(0,o.g2)("q-btn"),I=(0,o.g2)("q-item-side"),w=(0,o.g2)("q-page");return(0,o.uX)(),(0,o.Wv)(w,{class:"column q-pa-md"},{default:(0,o.k6)(function(){return[(0,o.bF)(R,{modelValue:e.modalDetalle,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.modalDetalle=t}),title:"Detalle de estudiantes",footer:!1},{default:(0,o.k6)(function(){return[(0,o.bF)(k,{style:{"max-width":"70vh"}},{default:(0,o.k6)(function(){return[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.infoEstudiantes,function(e){return(0,o.uX)(),(0,o.Wv)(g,null,{default:(0,o.k6)(function(){return[(0,o.bF)(i,null,{default:(0,o.k6)(function(){return[(0,o.bF)(n,{label:""},{default:(0,o.k6)(function(){return[(0,o.Lk)("div",s,(0,l.v_)(e.NOMCOMP),1)]}),_:2},1024),(0,o.bF)(n,{sublabel:""},{default:(0,o.k6)(function(){return[(0,o.Lk)("span",null,(0,l.v_)(e.NEMODES),1)]}),_:2},1024)]}),_:2},1024)]}),_:2},1024)}),256))]}),_:1})]}),_:1},8,["modelValue"]),(0,o.bF)(S,{name:"Control de Permisos"}),(0,o.Lk)("div",u,[(0,o.Lk)("div",r,[(0,o.bF)(_,{class:"q-if-outlined col",modelValue:e.filter,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.filter=t}),onInput:e.filtrarData},null,8,["modelValue","onInput"]),(0,o.bF)(F,{class:"q-if-outlined",modelValue:e.fecIni,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.fecIni=t}),type:"date",format:"DD/MM/YYYY","float-label":"Desde",onInput:e.init},null,8,["modelValue","onInput"]),(0,o.bF)(F,{class:"q-if-outlined",modelValue:e.fecFin,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.fecFin=t}),type:"date",format:"DD/MM/YYYY","float-label":"Hasta",onInput:e.init},null,8,["modelValue","onInput"]),(0,o.bF)(Q,{modelValue:e.showRechazados,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.showRechazados=t}),onInput:e.init},{default:(0,o.k6)(function(){return a()(t[5]||(t[5]=[(0,o.eW)("Ver Rechazados",-1)]))}),_:1},8,["modelValue","onInput"])])]),(0,o.bF)(k,{class:"q-card",separator:"",style:(0,l.Tr)({"max-height":e.alto+"px","overflow-y":"auto"})},{default:(0,o.k6)(function(){return[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.infoSeguimiento,function(n){return(0,o.uX)(),(0,o.CE)(o.FK,null,[1===n.SHOW?((0,o.uX)(),(0,o.Wv)(g,{key:0},{default:(0,o.k6)(function(){return[(0,o.bF)(i,{class:"column"},{default:(0,o.k6)(function(){return[(0,o.Lk)("div",d,[1===n.ES_EMERGENCIA?((0,o.uX)(),(0,o.Wv)(C,{key:0,name:"error",color:"red-14"})):(0,o.Q3)("v-if",!0),(0,o.Lk)("span",c,(0,l.v_)(n.NOMCOMP),1),(0,o.Lk)("span",f,"("+(0,l.v_)(n.NEMODES)+")",1),1===n.ES_GRUPAL?((0,o.uX)(),(0,o.Wv)(C,{key:1,class:"q-ml-xs",name:"remove_red_eye",onClick:function(t){return e.showEstudiantes(n)}},null,8,["onClick"])):(0,o.Q3)("v-if",!0)]),(0,o.Lk)("div",m,[t[6]||(t[6]=(0,o.Lk)("div",{class:"text-bold"},"Fecha Salida:  ",-1)),(0,o.Lk)("span",null,(0,l.v_)(n.FH_SALIDA_PROP_FORMAT),1),3===n.ESTADO&&2!==n.RETORNA?((0,o.uX)(),(0,o.CE)("div",v,"    Salida Efectuada:   "+(0,l.v_)(n.FH_SALIDA_EFECTIVA_FORMAT),1)):(0,o.Q3)("v-if",!0)]),2!==n.RETORNA?((0,o.uX)(),(0,o.CE)("div",h,[t[7]||(t[7]=(0,o.Lk)("div",{class:"text-bold"},"Fecha Retorno:  ",-1)),(0,o.Lk)("span",null,(0,l.v_)(n.FH_RETORNO_PROP_FORMAT),1)])):(0,o.Q3)("v-if",!0)]}),_:2},1024),(0,o.bF)(I,{class:"column",right:""},{default:(0,o.k6)(function(){return[(0,o.Lk)("div",p,[1===n.ESTADO&&e.isEdit?((0,o.uX)(),(0,o.Wv)(D,{key:0,dense:"",color:"secondary",onClick:function(t){return e.registrarEvento(n,3)}},{default:(0,o.k6)(function(){return a()(t[8]||(t[8]=[(0,o.eW)("Registrar Salida",-1)]))}),_:1},8,["onClick"])):(0,o.Q3)("v-if",!0),3===n.ESTADO&&2!==n.RETORNA&&e.isEdit?((0,o.uX)(),(0,o.Wv)(D,{key:1,dense:"",color:"secondary",onClick:function(t){return e.registrarEvento(n,4)}},{default:(0,o.k6)(function(){return a()(t[9]||(t[9]=[(0,o.eW)("Registrar Retorno",-1)]))}),_:1},8,["onClick"])):(0,o.Q3)("v-if",!0)]),e.estadosAprobacion[n.ESTADO]?((0,o.uX)(),(0,o.CE)("div",b,[t[10]||(t[10]=(0,o.Lk)("div",{class:"text-bold"}," Estado:  ",-1)),(0,o.Lk)("span",null,(0,l.v_)(e.estadosAprobacion[n.ESTADO].label),1)])):(0,o.Q3)("v-if",!0),(0,o.Lk)("div",E,[t[11]||(t[11]=(0,o.Lk)("div",{class:"text-bold"}," Motivo:  ",-1)),(0,o.Lk)("span",null,(0,l.v_)(n.DESCRIPCION),1)])]}),_:2},1024)]}),_:2},1024)):(0,o.Q3)("v-if",!0)],64)}),256))]}),_:1},8,["style"])]}),_:1})}var k=n(99550),R=n.n(k),S=(n(23825),n(10239),n(90095),n(27153),n(66307),n(13715),n(24066),n(83972)),_=n(6123),F=n(93616),Q=n(30545),C=n(18105),D=n(57668),I=n(80660),w=n(92173),A=n(69027),T=n(982),y=n(30640),O={setup:function(){var e=(0,S.fG)();return{v$:e}},components:{date:C.Ay,QSelect:_.Si,QToggle:_.c5,QCheckbox:_.vZ,QBtnToggle:_.QL,QRadio:_.$,QTable:Q.A,QTh:_.EJ,QTr:_.qh,QTd:_.Ef,QTableColumns:_.$s,QPopupEdit:_.GT,QChip:_.wQ,QFabAction:_.B$,QPageSticky:_._U,QFab:_.l6,QDatetime:_.T5,QTab:_.zu,QTabs:_.uw,sieEstudiantes:w.Ay,sieSelect:F.A,QCollapsible:_.eS,sieModal:y.A,QPage:_.Tu,QList:_.Mb,QItem:_.H0,QItemMain:_.mF,QItemTile:_.lp,QSearch:_.Ks,QIcon:_.bP,QItemSide:_.n1,QBtn:_.Il},data:function(){return{sie:(0,D["default"])(),isEdit:(0,D["default"])().ruta.nivel>2,infoSeguimiento:[],infoSeguimientoBase:[],modalDetalle:!1,infoEstudiantes:[],alto:0,filter:"",fecIni:new Date,fecFin:new Date,objParent:{},showRechazados:!1,listaEstudiantes:{},estadosAprobacion:[{value:0,label:"Pendiente"},{value:1,label:"Aprobado"},{value:2,label:"Rechazado"},{value:3,label:"Salida"},{value:4,label:"Retorno"}]}},methods:{handleResize:function(){this.alto=window.innerHeight-200},init:function(){var e=this;Promise.all([I.$http.get("api/HyoRpregistro/obtRegistrosSeguimiento",{params:{info:{fecIni:this.fecIni,fecFin:this.fecFin,verRechazados:this.showRechazados}}}),I.$http.get("api/HyoRpregistrogrupo/obtEstudiantes",{params:{info:{FECINI:this.fecIni,FECFIN:this.fecFin}}})]).then(function(t){var n=R()(t,2),i=n[0],a=n[1];e.infoSeguimientoBase=i.json,e.listaEstudiantes=a.json,e.filtrarData()})},showEstudiantes:function(e){var t=e.ID;this.modalDetalle=!0,this.infoEstudiantes=this.listaEstudiantes[t]},filtrarData:function(){var e=this;this.infoSeguimiento=[],this.infoSeguimientoBase.forEach(function(t){var n=0;0===n&&e.filter.length>0&&t.NOMCOMP.toUpperCase().indexOf(e.filter.toUpperCase())<0&&(n=1),0===n&&e.infoSeguimiento.push(t)})},registrarEvento:function(e,t){var n=this;(0,A.dialogConfirm)({message:this.$t("confirmar")}).then(function(i){i&&I.$http.post("api/HyoRpregistro/editarRegistro",{info:e,estado:t}).then(function(e){var t=e.json;(0,T["default"])(n.$t("mensajes."+t.msg),t.type),t.type||n.init()})})}},computed:{fechaMaxima:function(){var e=new Date;return new Date(e.getTime()+6e4*this.minDiff)},minRetorno:function(){var e=this.FH_SALIDA_PROP;return new Date(e.getTime()+6e5)},maxLista:function(){var e=this.alto-200;return e/20},buttons:function(){var e=[];return e.unshift({label:"Grabar",icon:"save",click:this.grabar}),e}},unmounted:function(){window.removeEventListener("resize",this.handleResize)},watch:{ES_EMERGENCIA:function(){var e=1===this.ES_EMERGENCIA?this.minDiffEmer:this.minDiffReg;this.calcularTolerancia(e)}},created:function(){var e=this;window.addEventListener("resize",this.handleResize),this.handleResize(),this.init();var t={activos:1};this.sie.esFamilia&&(t.familia=1),this.sie.esOtros&&(t.personal=1),I.$http.get("api/HyoRpmotivos/getMotivos",{params:t}).then(function(t){var n=t.json;e.motivos=n}),I.$http.get("api/HyoTablaSe/datosSe",{params:{princod:"009"}}).then(function(t){var n=t.listar;e.listParent=[],n.forEach(function(t){var n=t.SECUEQU,i=t.SECUDES,a=t.SECUCOD;n&&(e.objParent[a]=n),e.listParent.push({value:a,label:i})})})}},q=n(12807);const L=(0,q.A)(O,[["render",g]]);var M=L}}]);