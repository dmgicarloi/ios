"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[15188],{15188:function(e,r,o){o.r(r),o.d(r,{default:function(){return J}});var a=o(8445),t=o.n(a),l=o(61758),n=o(29104),c=o(58790),i={class:"col-xs-12 col-sm-4 q-pr-xs"},s={class:"col-xs-12 row justify-center"},u=["action"],f={class:"row col-xs-12 justify-between"},d={class:"q-pa-xs"},m={key:0,class:"q-pa-xs q-pr-sm"},p={key:1,class:"q-pa-xs"},h={key:2,class:"col-xs-12"},b=["src"],g={key:1,class:"col-12 column no-wrap"},v={class:"column col",style:{height:"calc(100vh - 200px)"}};function y(e,r){var o=(0,l.g2)("q-card-section"),a=(0,l.g2)("q-separator"),y=(0,l.g2)("sie-select"),k=(0,l.g2)("formulario"),x=(0,l.g2)("q-checkbox"),A=(0,l.g2)("q-btn"),C=(0,l.g2)("q-card-main"),F=(0,l.g2)("q-card"),q=(0,l.g2)("q-radio"),R=(0,l.g2)("chart"),V=(0,l.g2)("sie-vacio"),T=(0,l.g2)("q-page");return(0,l.uX)(),(0,l.Wv)(T,null,{default:(0,l.k6)(function(){return[(0,l.bF)(F,{class:"layout-v1 col my-card",flat:"",bordered:""},{default:(0,l.k6)(function(){return[(0,l.bF)(o,null,{default:(0,l.k6)(function(){return t()(r[11]||(r[11]=[(0,l.Lk)("div",{class:"row items-center no-wrap"},[(0,l.Lk)("div",{class:"col"},[(0,l.Lk)("div",{class:"text-h6"},"Formatos/Reportes")]),(0,l.Lk)("div",{class:"col-auto"})],-1)]))}),_:1}),(0,l.bF)(a),(0,l.bF)(o,{class:"row"},{default:(0,l.k6)(function(){return[(0,l.Lk)("div",i,[(0,l.bF)(y,{class:"q-mb-sm",modelValue:e.reporte,"onUpdate:modelValue":r[0]||(r[0]=function(r){return e.reporte=r}),type:"outlined",options:e.reportes,label:"NOMBRE",val:"ID_FORMULARIO",onInput:e.filtrar,placeholder:"Seleccionar Reporte","no-bottom":""},null,8,["modelValue","options","onInput"]),e.reporte?((0,l.uX)(),(0,l.Wv)(F,{key:0,class:"q-card-legend",title:"Parametros",style:{color:"rgba(0, 0, 0, 0.92)"}},{default:(0,l.k6)(function(){return[(0,l.bF)(C,null,{default:(0,l.k6)(function(){return[((0,l.uX)(),(0,l.Wv)(k,{class:"col-xs-12 col-sm-12",ref:"form",schema:e.schema,methods:e.methods,load:e.load,key:e.reporte},null,8,["schema","methods","load"])),(0,l.bF)(x,{modelValue:e.grafico,"onUpdate:modelValue":r[1]||(r[1]=function(r){return e.grafico=r}),label:"Gráfico",onInput:e.cambiaGrafico},null,8,["modelValue","onInput"]),(0,l.Lk)("div",s,[(0,l.bF)(A,{ripple:!1,color:"primary",label:"Aceptar",type:"submit","no-caps":"",onClick:e.cargarReporte},null,8,["onClick"]),(0,l.Lk)("form",{ref:"formParametros",onSubmit:r[2]||(r[2]=(0,n.D$)(function(){return e.onSubmit&&e.onSubmit.apply(e,arguments)},["prevent"])),action:e.urlreporte,method:"post",target:"my_iframe"},null,40,u)])]}),_:1})]}),_:1})):(0,l.Q3)("v-if",!0),r[12]||(r[12]=(0,l.Lk)("div",{class:"col-xs-12 row justify-center"},null,-1))]),(0,l.Lk)("div",{class:"col-xs-12 col-sm-8 row",ref:"divfullscreen",style:(0,c.Tr)(e.grafico?"background: #fff":"")},[(0,l.Lk)("div",f,[e.reporteActivo?((0,l.uX)(),(0,l.CE)(l.FK,{key:0},[(0,l.Lk)("div",d,[(0,l.bF)(A,{size:"sm",color:"primary",onClick:e.toggle,icon:e.$q.fullscreen.isActive?"fullscreen_exit":"fullscreen",label:e.$q.fullscreen.isActive?"Salir":"Pantalla Completa"},null,8,["onClick","icon","label"]),e.$q.fullscreen.isActive?((0,l.uX)(),(0,l.Wv)(x,{key:0,modelValue:e.grafico,"onUpdate:modelValue":r[3]||(r[3]=function(r){return e.grafico=r}),label:"Gráfico",onInput:e.cambiaGrafico,class:(0,c.C4)(e.grafico?"":"negative")},null,8,["modelValue","onInput","class"])):(0,l.Q3)("v-if",!0)]),e.grafico?((0,l.uX)(),(0,l.CE)("div",m,[(0,l.bF)(q,{modelValue:e.charType,"onUpdate:modelValue":r[4]||(r[4]=function(r){return e.charType=r}),val:"line",label:"Linea"},null,8,["modelValue"]),(0,l.bF)(q,{modelValue:e.charType,"onUpdate:modelValue":r[5]||(r[5]=function(r){return e.charType=r}),val:"bar",label:"Barra"},null,8,["modelValue"]),(0,l.bF)(q,{modelValue:e.charType,"onUpdate:modelValue":r[6]||(r[6]=function(r){return e.charType=r}),val:"pie",label:"Circular"},null,8,["modelValue"]),(0,l.bF)(q,{modelValue:e.charType,"onUpdate:modelValue":r[7]||(r[7]=function(r){return e.charType=r}),val:"radar",label:"Radar"},null,8,["modelValue"]),(0,l.bF)(A,{class:"q-mx-xs q-ml-md",size:"sm",color:"cyan-6",icon:"file_download",label:"Descargar",onClick:e.download},null,8,["onClick"])])):((0,l.uX)(),(0,l.CE)("div",p,[(0,l.bF)(A,{class:"q-mx-xs",size:"sm",color:"red-10",icon:"file_pdf",label:"Pdf",onClick:r[8]||(r[8]=function(r){return e.exportar("pdf")})}),(0,l.bF)(A,{class:"q-mx-xs",size:"sm",color:"green",icon:"file_excel",label:"Excel",onClick:r[9]||(r[9]=function(r){return e.exportar("xls")})}),(0,l.bF)(A,{class:"q-mx-xs",size:"sm",color:"cyan-6",icon:"file_document",label:"Txt",onClick:r[10]||(r[10]=function(r){return e.exportar("txt")})})])),e.grafico?((0,l.uX)(),(0,l.CE)("div",h,[((0,l.uX)(),(0,l.Wv)(R,{type:e.charType,key:e.charType,conf:e.charConfig,datos:e.charDatos,ref:"myChart"},null,8,["type","conf","datos"]))])):((0,l.uX)(),(0,l.CE)("iframe",{key:3,class:"col-xs-12",name:"my_iframe",src:e.urlreporte,style:(0,c.Tr)(e.iframestyle)},null,12,b))],64)):((0,l.uX)(),(0,l.CE)("div",g,[(0,l.Lk)("div",v,[(0,l.bF)(V,{icon:"file_pdf_o",title:"Archivo no disponible",subtitle:"",style:{background:"rgba(0, 0, 0, 0.05)",height:"100%","border-radius":"5px",border:"1px solid #0000005c"}})])]))])],4)]}),_:1})]}),_:1})]}),_:1})}var k=o(99550),x=o.n(k),A=(o(71225),o(39866),o(52133),o(10239),o(23513),o(56285),o(50310),o(5962),o(90095),o(515),o(83190),o(52776),o(81813),o(13715),o(80660)),C=o(78131),F=o(44081),q=o(57668),R=o(19852),V=o(7729),T=o(30640),w=o(26697),Q=o(53093),_=o(2739),L=o(43346),I=o(53811),E=o(88567),P=o(95718),$=o(53380),M=o(99515),O=o(3112),S=o(982),U=o(84603),X=o(93616),D=o(16648),z=o(80340),G=o(6123),W=(o(10213),o(42037),o(18105),{components:{sieVacio:z.A,sieSelect:X.A,chart:F.A,QRadio:M.A,siePdf:U.A,QForm:_.A,QCheckbox:O.A,createGrid:V.A,formulario:R.A,QCard:E.A,QCardSection:P.A,QSeparator:$.A,QTabs:w.A,QTab:Q.A,QTabPanels:I.A,QTabPanel:L.A,QPagination:G.ao,sieModal:T.A,QSearch:G.Ks,QSelect:D.A,QPage:G.Tu,QCardMain:G.d1,QBtn:G.Il},data:function(){return{urlreporte:null,sie:(0,q["default"])(),title:"",nivelAcceso:(0,q["default"])().ruta.nivel,schema:[],methods:{},reportes:[],reporte:null,id:29,grafico:!1,url:"",apiChar:null,chartOptions:{maintainAspectRatio:!1},charDatos:[],charConfig:{},charType:"line",reporteActivo:!1}},computed:{iframestyle:function(){var e="border: none; height: ";return this.$q.fullscreen.isActive?e+"100vh":e+"calc(100vh - 200px);"}},methods:{exportar:function(e){var r=this.urlreporte.slice(0,-3)+e,o=r.replace(/[\w.:]*\//g,"");(0,C["default"])(r,o)},download:function(){this.$refs.myChart.download()},getRandom:function(e,r){return Math.floor(Math.random()*(r-e))+e},getChartReportes:function(){var e=this,r=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Setiembre","Octubre","Noviembre","Diciembre"],o=["Matrícula","Cuota de ingreso","Pensión"],a=[];r.map(function(r){o.map(function(o){a.push({mes:r,concepto:o,monto:e.getRandom(0,1e3)})})});var t={valor:"monto",categoria:"concepto",label:"mes"},l=[],n={};return a.map(function(e){l.includes(e[t.label])||l.push(e[t.label]),n.hasOwnProperty(e[t.categoria])||(n[e[t.categoria]]={}),n[e[t.categoria]][e[t.label]]=e[t.valor]}),this.charConfig=t,this.charDatos=a,{conf:t,datos:a}},toggle:function(e){var r=this.$refs.divfullscreen;this.$q.fullscreen.toggle(r)},cargarReporte:function(e){var r=this,o=this.$refs.formParametros;this.$refs.form.getForm().then(function(e){var a=e.success,t=e.form;a&&(Object.keys(t).forEach(function(e){o.appendChild(r.createInput(e,t[e]))}),r.reporteActivo=!0,r.grafico,r.urlreporte=r.sie.url+"/"+r.url)})},createInput:function(e,r){var o=document.createElement("input");return o.type="hidden",o.value=r,o.name=e,o},cambiaGrafico:function(){},load:function(){},filtrar:function(e){this.reporteActivo=!1,this.id=e;var r=this.reportes.filter(function(r){return r.ID_FORMULARIO===e}),o=x()(r,1),a=o[0];this.url=a.URL,this.loadForm(a.ID_FORMULARIO)},getReportes:function(){var e=this;return A.$http.get("api/formularioController/getReportes").then(function(r){e.reportes=r})},loadForm:function(e){var r=this;return A.$http.get("api/formularioController/getFormulario",{params:{id:e}}).then(function(e){var o=e.nombre,a=e.data;return r.title=o,r.schema=a,a}).catch(function(e){console.error(e),(0,S["default"])("Error al traer formulario","warning")})}},created:function(){this.getChartReportes(),this.getReportes()},mounted:function(){}}),j=o(12807);const B=(0,j.A)(W,[["render",y]]);var J=B}}]);