"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[82469],{82469:function(e,o,t){t.r(o),t.d(o,{default:function(){return j}});var s=t(8445),n=t.n(s),i=t(61758),c=t(58790),a={key:0,class:"row"},r={class:"col column"},u={key:0,class:"col scroll-y"},l={class:"row"},d={class:"text-h6"};function m(e,o){var t=(0,i.g2)("sie-salones"),s=(0,i.g2)("sie-estudiantes"),m=(0,i.g2)("sie-select"),h=(0,i.g2)("sie-ano"),p=(0,i.g2)("q-toolbar-title"),f=(0,i.g2)("q-btn"),C=(0,i.g2)("q-toolbar"),g=(0,i.g2)("q-card-section"),O=(0,i.g2)("q-card"),v=(0,i.g2)("q-infinite-scroll"),S=(0,i.g2)("q-page");return(0,i.uX)(),(0,i.Wv)(S,null,{default:(0,i.k6)(function(){return[e.ano?((0,i.uX)(),(0,i.CE)("div",a,[-1===["004","005"].indexOf(e.sie.tipcod)?((0,i.uX)(),(0,i.Wv)(t,{key:0,class:"col-xs-12 col-sm-6",modelValue:e.nemo,"onUpdate:modelValue":o[0]||(o[0]=function(o){return e.nemo=o}),onLoad:e.loadSalon,gradonivel:!0,onSeleccionar:e.seleccionarSalon,campos:["NEMO","NEMODES","INSTRUCOD","GRADOCOD","TIPCAL"],ano:e.ano,recuperacion:!0,todos:!1},null,8,["modelValue","onLoad","onSeleccionar","ano"])):((0,i.uX)(),(0,i.Wv)(s,{key:1,class:"col-xs-12 col-sm-6",ref:"sieEstudiante",modelValue:e.alucod,"onUpdate:modelValue":o[1]||(o[1]=function(o){return e.alucod=o}),onSelected:e.seleccionarAlumno,params:{ano:e.anoRecuperacion,recuperacion:1}},null,8,["modelValue","onSelected","params"])),(0,i.bF)(m,{class:"col-xs-8 col-sm-4 q-pa-sm cr-curso",type:"outlined",modelValue:e.curso,"onUpdate:modelValue":o[2]||(o[2]=function(o){return e.curso=o}),options:e.cursos,label:"CURSONOM",val:"CURSOCOD",placeholder:"Curso",onInput:e.cambiarCurso},null,8,["modelValue","options","onInput"]),(0,i.bF)(h,{class:"col-xs-4 col-sm-2 q-pt-sm q-pr-sm bg-white cr-curso",modelValue:e.ano,"onUpdate:modelValue":o[3]||(o[3]=function(o){return e.ano=o}),onSeleccionar:e.cambiaAnio},{default:(0,i.k6)(function(){return[(0,i.eW)("- "+(0,c.v_)(e.ano),1)]}),_:1},8,["modelValue","onSeleccionar"])])):(0,i.Q3)("v-if",!0),(0,i.Lk)("div",r,[(0,i.bF)(C,{class:"shadow-2 z-fab",inverted:""},{default:(0,i.k6)(function(){return[(0,i.bF)(p,{class:"q-pa-none"},{default:(0,i.k6)(function(){return n()(o[4]||(o[4]=[(0,i.eW)("Competencias",-1)]))}),_:1}),e.hasReporte?((0,i.uX)(),(0,i.Wv)(f,{key:0,flat:"",round:"",icon:"print",onClick:e.goReportes},null,8,["onClick"])):(0,i.Q3)("v-if",!0),e.hasInforme?((0,i.uX)(),(0,i.Wv)(f,{key:1,flat:"",round:"",icon:"insert_chart",onClick:e.goInformes},null,8,["onClick"])):(0,i.Q3)("v-if",!0)]}),_:1}),e.cursos.length>0?((0,i.uX)(),(0,i.CE)("div",u,[(0,i.bF)(v,{handler:e.cargarContenido,ref:"infiniteScroll"},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",l,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.competencias,function(o){return(0,i.uX)(),(0,i.Wv)(O,{key:o.COMPETENCIA,class:"sie-curso q-ma-sm col-xs-12 col-sm-6 col-md-4 col-lg-3",onClick:function(t){return e.detalleCurso(o)}},{default:(0,i.k6)(function(){return[(0,i.bF)(g,null,{default:(0,i.k6)(function(){return[(0,i.Lk)("div",d,(0,c.v_)(o.DESCRIPCION),1)]}),_:2},1024)]}),_:2},1032,["onClick"])}),128))])]}),_:1},8,["handler"])])):(0,i.Q3)("v-if",!0)])]}),_:1})}var h=t(76080),p=t.n(h),f=t(45254),C=t.n(f),g=t(57008),O=t.n(g),v=(t(30683),t(71225),t(39866),t(52133),t(10239),t(56285),t(50310),t(5962),t(6724),t(11777),t(83190),t(52776),t(81813),t(83972)),S=t(6123),A=t(36153),R=t(82640),I=t(88275),$=t(92173),k=t(80340),D=t(57668),P=t(51073),E=t(36980),U=t(30640),N=t(59089),y=t(33950),b=t(982),w=t(80660),M=t(84569),q=t(93616),T=t(29706),V=t(88567),Q=t(95718),G=t(16648),x=t(72453),L=t(69027),_="intranet.informes",X="intranet.reportesInstrumento",F={setup:function(){var e=(0,v.fG)();return{v$:e}},props:{recuperacion:{type:Number,default:0}},components:{sieAno:x.A,QCardSection:Q.A,QSelect:G.S,sieSelect:q.A,sieUpload:N.A,sieModal:U.A,sieEstudiantes:$.Ay,QInfiniteScroll:S.nN,QCard:V.A,QSearch:S.Ks,sieSalones:I.Ay,sieVacio:k.A,QPopover:S.VM,Loading:A.A,sieCurso:T.A,QPage:S.Tu,QToolbar:S.ZV,QToolbarTitle:S.r_,QBtn:S.Il},data:function(){return{$upload:null,tipcal:null,file$:null,dataImagen:{},sie:(0,D["default"])(),ano:null,descripcion:"",imagen:"",stopScroll:!1,modalEditarCurso:!1,datos:{},itemSeleccionado:"todos",keyPeriodos:[],keyCursos:[],dataCursos:[],instrucod:"",gradocod:"",curso:"",competencias:[]}},computed:O()(O()({},(0,E.aH)("clase",["cursocodr","cursos","periodos","anoRecuperacion","cursonom","peticiones","limitCursos","alucod","usucodAlumno"])),{},{nemo:{get:function(){return this.$store.state.clase.nemo},set:function(e){this.$store.commit("clase/setNemo",e)}},cursosSelect:function(){return this.cursos.map(function(e){return e.ID=e.CURSOCOD+"|"+e.GRUPOCOD,e})},alucod:{get:function(){return this.$store.state.clase.alucod},set:function(e){this.$store.commit("clase/setAlucod",e)}},accesoTotal:function(){return this.sie.esOtros&&3===this.sie.ruta.nivel&&-1===["0090"].indexOf(this.sie.colcod)},hasReporte:function(){return!0===this.sie.esOtros&&(0,M.yy)(X)},hasInforme:function(){return!0===this.sie.esOtros&&(0,M.yy)(_)}}),methods:{loadSalon:function(e){e&&0!==e.length||(0,L.swal)("Asigación de profesor","Este profesor no tiene salones asignados en Carpeta recuperación","warning")},cambiaAnio:function(e){this.getCompetencias(),this.$store.commit("clase/setAnoRecuperacion",e.ANO)},added:function(e){this.file$=e[0]},editarImagen:function(){var e=this;return C()(p()().m(function o(){var t,s,i,c,a,r,u,l;return p()().w(function(o){while(1)switch(o.p=o.n){case 0:if(e.v$.$touch(),!e.v$.$error){o.n=1;break}return o.a(2,!1);case 1:return t=e.dataImagen,s=e,i=e.file$,c={cursocod:t.CURSOCOD,descripcion:s.descripcion,flEliminar:0,grupocod:t.GRUPOCOD,nemo:s.nemo},o.p=2,o.n=3,(0,y.Basic)({url:"api/HyoArchivo/tmp/upload",file:i,onProgress:function(e,o){}});case 3:a=o.v,r=a.result.files.file,c.imagen=r[0].originalFilename,c.imagenTemp=r[0].name,c.flEliminar=1,o.n=5;break;case 4:o.p=4,o.v;case 5:return o.p=5,o.n=6,w.$http.post("api/HyoCursoGrupo/registraDatos",c);case 6:u=n()(s.cursos),u.map(function(e){return e.KEY===t.KEY&&(e.IMG=e.IMG+"&datetime=".concat((new Date).getTime())),e}),s.$store.commit("clase/setCursos",u),(0,b["default"])("actualizado"),e.modalEditarCurso=!1,o.n=8;break;case 7:o.p=7,l=o.v,console.error(l),(0,b["default"])("No pudo actualizar completamente","error");case 8:return o.a(2)}},o,null,[[5,7],[2,4]])}))()},editarCurso:function(e){this.dataImagen=e,this.descripcion=e.DESCRIPCION,this.imagen=e.IMG,this.modalEditarCurso=!0},cargarContenido:function(e,o,t){this.peticiones[this.nemo]&&!this.peticiones[this.nemo].ajax.isPending()&&this.getCursos({nemo:this.nemo},o)},seleccionarAlumno:function(e){if(this.$store.commit("clase/setUsucodAlumno",e.USUCOD),e.NEMO){var o=e.NEMO,t=e.ALUCOD,s=e.TIPCAL;this.alucod=t,this.tipcal=s,this.nemo=o,this.seleccionarSalon(e)}},seleccionarSalon:function(e){this.instrucod=e.INSTRUCOD,this.gradocod=e.GRADOCOD,this.tipcal=e.TIPCAL,this.peticiones.hasOwnProperty(this.nemo)||this.$store.commit("clase/setInitPeticiones",this.nemo),this.stopScroll&&this.$refs.infiniteScroll.resume(),A.A.show(),this.cargarContenido(),this.getCompetencias()},getCompetencias:function(){var e=this;if(this.instrucod&&this.gradocod&&this.curso&&this.ano){var o={instrucod:this.instrucod,tipcal:this.tipcal,gradocod:this.gradocod,cursocod:this.curso,anio:this.ano};w.$http.get("api/carpetarecuperacion/getCompetencias",{params:o}).then(function(o){e.competencias=o}).catch(function(o){var t=501===o.code?o.message:"Ocurrio un error al traer las competencias";(0,b["default"])(t,"warning"),e.competencias=[]})}},cambiarCurso:function(e){this.getCompetencias()},detalleCurso:function(e){var o=this,t=this.cursosSelect.filter(function(e){return e.CURSOCOD===o.curso});t=t.length>0?t[0]:{};var s=this.nemo,n=t,i=n.CURSOCOD,c=n.GRUPOCOD,a=n.CURSONOM,r=n.NOMCOMP;this.$router.push({name:"intranet.clase.contenido",params:{nemo:s,cursocod:i,grupocod:c,indice:e.INDICE}}),this.$store.commit("clase/setCursonom",a),this.$store.commit("clase/setProfesor",r)},getCursos:function(e,o){var t=this,s=e.nemo,n=this.$store;if(this.datos.hasOwnProperty(s)||(this.$store.commit("clase/setInitPeticiones",s),this.datos[s]={cursos:[]}),this.peticiones[s].lastAjaxLength<this.limitCursos&&(this.stopScroll=!0,"function"===typeof o))return o(!0);this.alucod&&(e.alucod=this.alucod),e.recuperacion=1,e.ano=this.ano;var i=n.dispatch("clase/getCursosPeriodos",e);n.commit("clase/setPeticiones",{nemo:s,ajax:i}),i.then(function(e){var n=[];e=e.filter(function(e){return n.includes(e.CURSOCOD)||"001"===e.GRUPOCOD||(n.push(e.CURSOCOD),e.GRUPOCOD="001",e.CURSONOM=e.CURSONOM?e.CURSONOM.replace(/\([\wáéíóú\s]+\)/gi,"").replace(/\([\wáéíóú\s]+\)/gi,""):e.CURSONOM,e.DESCRIPCION=e.DESCRIPCION?e.DESCRIPCION.replace(/\([\wáéíóú\s]+\)/gi,"").replace(/\([\wáéíóú\s]+\)/gi,""):e.DESCRIPCION),"001"===e.GRUPOCOD}),A.A.hide(),t.datos[s]["cursos"]=t.datos[s]["cursos"].concat(e),t.$store.commit("clase/setCursos",t.datos[s]["cursos"]),"function"===typeof o&&o()}).catch(function(e){A.A.hide(),console.error(e.message)})},goReportes:function(){this.$router.push({name:X,query:{nemo:this.nemo}})},goInformes:function(){this.$router.push({name:_,query:{nemo:this.nemo}})}},validations:{descripcion:{required:R.mw}},created:function(){var e=this;this.anoRecuperacion?this.ano=this.anoRecuperacion:w.$http.get("api/carpetarecuperacion/getPgEtapaActivo").then(function(o){var t=o.ANO||e.sie.ano;e.ano=String(t),e.$store.commit("clase/setAnoRecuperacion",e.ano),e.$store.commit("clase/setBimecodR",o.ETAPA)}),this.$store.hasModule("clase")||this.$store.registerModule("clase",P.A),this.cursocodr&&(this.curso=this.cursocodr),this.getCompetencias()},watch:{curso:function(e){},anoRecuperacion:function(e){var o=this;this.$nextTick(function(){["004","005"].includes(o.sie.tipcod)&&o.$refs.sieEstudiante.get()})}}},W=t(12807);const K=(0,W.A)(F,[["render",m]]);var j=K}}]);