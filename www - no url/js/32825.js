"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[32825],{32825:function(e,o,a){a.r(o),a.d(o,{default:function(){return oe}});var l=a(8445),n=a.n(l),r=a(61758),s=a(58790),t={class:"row items-center no-wrap"},u={class:"col row"},i={class:"text-h6"},d={class:"div",style:{display:"flex"}},c={class:"row q-ma-xs q-col-gutter-sm"},p={class:"col-xs-4"},q={class:"col-xs-4"},m={style:{display:"grid","align-content":"center","align-items":"center"}},f={class:"q-pa-md"},b={class:"q-pa-md"},h={class:"row q-ma-xs q-col-gutter-sm"},B={class:"col-xs-4"},g={class:"col-xs-4"},w={class:"col-xs-6"},v={class:"q-pa-sm"},k={class:"col-xs-6"},N={class:"q-pa-sm"},C={key:0,class:"q-pa-sm texthelper"},D={key:1,class:"q-pa-sm texthelper"};function S(e,o){var a=(0,r.g2)("q-icon"),l=(0,r.g2)("q-card-section"),S=(0,r.g2)("q-separator"),y=(0,r.g2)("q-input"),M=(0,r.g2)("header-grid"),L=(0,r.g2)("sie-grid"),x=(0,r.g2)("footer-grid"),V=(0,r.g2)("q-btn"),I=(0,r.g2)("q-option-group"),P=(0,r.g2)("sie-modal"),A=(0,r.g2)("q-card");return(0,r.uX)(),(0,r.Wv)(A,{class:"layout-v1 my-card"},{default:(0,r.k6)(function(){return[(0,r.bF)(l,null,{default:(0,r.k6)(function(){return[(0,r.Lk)("div",t,[(0,r.Lk)("div",u,[(0,r.bF)(a,{class:"cursor-pointer back",name:"arrow_back",onClick:e.volver},null,8,["onClick"]),(0,r.Lk)("div",i,"Bloquear personas de envío a banco: "+(0,s.v_)(e.numcta)+" - "+(0,s.v_)(e.nomServicio),1)])])]}),_:1}),(0,r.bF)(S),(0,r.Lk)("div",d,[(0,r.bF)(l,{style:{width:"50%"}},{default:(0,r.k6)(function(){return[(0,r.Lk)("div",c,[(0,r.Lk)("div",p,[(0,r.bF)(y,{placeholder:"Ingrese el código de la persona",modelValue:e.filtroNoBloqueado.codigo,"onUpdate:modelValue":o[0]||(o[0]=function(o){return e.filtroNoBloqueado.codigo=o}),maxlength:20,label:"Código",onInput:e.filtroNoBloqueados},null,8,["modelValue","onInput"])]),(0,r.Lk)("div",q,[(0,r.bF)(y,{placeholder:"Ingrese el nombre de la persona",modelValue:e.filtroNoBloqueado.nombres,"onUpdate:modelValue":o[1]||(o[1]=function(o){return e.filtroNoBloqueado.nombres=o}),maxlength:120,label:"Nombres",onInput:e.filtroNoBloqueados},null,8,["modelValue","onInput"])])]),(0,r.Lk)("div",null,[(0,r.bF)(M,null,{default:(0,r.k6)(function(){return n()(o[9]||(o[9]=[(0,r.Lk)("div",{class:"text-h5"},"No Bloqueados",-1)]))}),_:1}),(0,r.bF)(L,{class:"fix-table-global ag-theme-balham",columnDefs:e.columnDefsNoBloqueados,rowData:e.rowDataNoBloqueados,frameworkComponents:e.frameworkComponentsNoBloqueados,rowSelection:"multiple",onGridReady:e.onGridReadyNoBloqueados,rowMultiSelectWithClick:!0,onSelectionChanged:e.onSelectionChangedNoBloqueados},null,8,["columnDefs","rowData","frameworkComponents","onGridReady","onSelectionChanged"]),(0,r.bF)(x,{modelValue:e.pagina,"onUpdate:modelValue":o[2]||(o[2]=function(o){return e.pagina=o}),max:e.pages,onLoad:e.getNoBloqueados,rows:e.rowDataNoBloqueados},null,8,["modelValue","max","onLoad","rows"])])]}),_:1}),(0,r.Lk)("div",m,[(0,r.Lk)("div",f,[(0,r.bF)(V,{icon:"arrow_forward",onClick:e.openBloquearPersonasModal,disable:e.disableBloquear,color:e.disableBloquear?"faded":"primary"},null,8,["onClick","disable","color"])]),(0,r.Lk)("div",b,[(0,r.bF)(V,{icon:"arrow_back",onClick:e.openDesbloquearPersonasModal,disable:e.disableDesbloquear,color:e.disableDesbloquear?"faded":"primary"},null,8,["onClick","disable","color"])])]),(0,r.bF)(l,{style:{width:"50%"}},{default:(0,r.k6)(function(){return[(0,r.Lk)("div",h,[(0,r.Lk)("div",B,[(0,r.bF)(y,{placeholder:"Ingrese el código de la persona",modelValue:e.filtroBloqueado.codigo,"onUpdate:modelValue":o[3]||(o[3]=function(o){return e.filtroBloqueado.codigo=o}),maxlength:20,label:"Código",onInput:e.filtroBloqueados},null,8,["modelValue","onInput"])]),(0,r.Lk)("div",g,[(0,r.bF)(y,{placeholder:"Ingrese el nombre de la persona",modelValue:e.filtroBloqueado.nombres,"onUpdate:modelValue":o[4]||(o[4]=function(o){return e.filtroBloqueado.nombres=o}),maxlength:120,label:"Nombres",onInput:e.filtroBloqueados},null,8,["modelValue","onInput"])])]),(0,r.Lk)("div",null,[(0,r.bF)(M,null,{default:(0,r.k6)(function(){return n()(o[10]||(o[10]=[(0,r.Lk)("div",{class:"text-h5"},"Bloqueados",-1)]))}),_:1}),(0,r.bF)(L,{class:"fix-table-global ag-theme-balham",columnDefs:e.columnDefsBloqueados,rowData:e.rowDataBloqueados,frameworkComponents:e.frameworkComponentsBloqueados,rowSelection:"multiple",onGridReady:e.onGridReadyBloqueados,rowMultiSelectWithClick:!0,onSelectionChanged:e.onSelectionChangedBloqueados},null,8,["columnDefs","rowData","frameworkComponents","onGridReady","onSelectionChanged"]),(0,r.bF)(x,{modelValue:e.pagina,"onUpdate:modelValue":o[5]||(o[5]=function(o){return e.pagina=o}),max:e.pages,onLoad:e.getBloqueados,rows:e.rowDataBloqueados},null,8,["modelValue","max","onLoad","rows"])])]}),_:1})]),(0,r.bF)(P,{modelValue:e.openModalBloquear,"onUpdate:modelValue":o[7]||(o[7]=function(o){return e.openModalBloquear=o}),onSubmit:e.bloquearSeleccionados,labelButtonOk:"Aceptar"},{default:(0,r.k6)(function(){return[(0,r.Lk)("div",w,[(0,r.Lk)("div",v,[o[11]||(o[11]=(0,r.eW)("Bloquear para:",-1)),(0,r.bF)(I,{color:"purple",options:e.optionsBloqueo,modelValue:e.tipoBloqueo,"onUpdate:modelValue":o[6]||(o[6]=function(o){return e.tipoBloqueo=o})},null,8,["options","modelValue"])])])]}),_:1},8,["modelValue","onSubmit"]),(0,r.bF)(P,{modelValue:e.openModalDesbloquear,"onUpdate:modelValue":o[8]||(o[8]=function(o){return e.openModalDesbloquear=o}),onSubmit:e.desbloquearSeleccionados,labelButtonOk:"Aceptar"},{default:(0,r.k6)(function(){return[(0,r.Lk)("div",k,[(0,r.Lk)("div",N,"Usted ha seleccionado "+(0,s.v_)(e.perBloqueoTotalSelected)+" persona(s) con un bloqueo total.",1),o[12]||(o[12]=(0,r.Lk)("div",{class:"q-pa-sm",style:{"font-weight":"bold"}},"¿Desea desbloquearla(s) para todas las cuentas?",-1)),1===e.perBloqueoPersonalizadoSelected?((0,r.uX)(),(0,r.CE)("div",C,"(*) La persona con bloqueo personalizado que seleccionó se desbloqueará solo para esta cuenta.")):(0,r.Q3)("v-if",!0),e.perBloqueoPersonalizadoSelected>1?((0,r.uX)(),(0,r.CE)("div",D,"(*) Las "+(0,s.v_)(e.perBloqueoPersonalizadoSelected)+" personas con bloqueos personalizados se desbloquearán solo para esta cuenta.",1)):(0,r.Q3)("v-if",!0)])]}),_:1},8,["modelValue","onSubmit"])]}),_:1})}var y=a(41562),M=a.n(y),L=a(76080),x=a.n(L),V=a(45254),I=a.n(V),P=(a(30683),a(10239),a(17136)),A=a(57668),O=a(80660),F=a(54489),$=a(64208),G=a(88567),_=a(53380),R=a(95718),T=a(75053),z=a(36408),U=a(21063),Q=a(75177),E=a(6557),W=a(64303),X=a(40155),j=a(11654),H=a(27560),J=a(6123),K=a(96330),Y={props:["numcta","bancoCod","bancoNombre","nombreServicio"],components:{QCard:G.A,QCardSection:R.A,QSelect:F.S,templateBanco:P.A,QOptionGroup:J.EX,QSeparator:_.A,sieModal:T.A,sieGrid:z.A,QInput:$.A,crearBotones:W.A,QCheckbox:X.A,QBtn:j.A,checkbox:U.A,footerGrid:H.A,headerGrid:K.A,QIcon:J.bP},mixins:[Q.A],data:function(){return{nameComponente:"bloquear",sie:(0,A["default"])(),nivelAcceso:(0,A["default"])().ruta.nivel,data:[],botones:[],pagina:1,pages:1,columnDefsNoBloqueados:[],rowDataNoBloqueados:[],apiNoBloqueados:{},frameworkComponentsNoBloqueados:null,columnDefsBloqueados:[],rowDataBloqueados:[],apiBloqueados:{},frameworkComponentsBloqueados:null,codBanco:this.$route.query.bancoCod,numCuenta:this.$route.query.numcta,nomBanco:this.$route.query.bancoNombre,nomServicio:this.$route.query.nombreServicio,disableBloquear:!0,disableDesbloquear:!0,filtroNoBloqueado:{codigo:"",nombres:""},filtroBloqueado:{codigo:"",nombres:""},rowDataBloqueadosIni:[],rowDataNoBloqueadosIni:[],openModalBloquear:!1,openModalDesbloquear:!1,tipoBloqueo:this.$route.query.numcta,optionsBloqueo:[{label:"Esta cuenta: ".concat(this.$route.query.numcta," - ").concat(this.$route.query.nombreServicio),value:this.$route.query.numcta},{label:"Todas las cuentas",value:"T"}],perBloqueoTotalSelected:0,perBloqueoPersonalizadoSelected:0}},methods:{filtroNoBloqueados:function(){var e=this;return I()(x()().m(function o(){var a,l,r;return x()().w(function(o){while(1)switch(o.n){case 0:if(a=[],l=n()(e.rowDataNoBloqueadosIni),r={CODIGO:e.filtroNoBloqueado.codigo,NOMCOMP:e.filtroNoBloqueado.nombres},!(l.length>0)){o.n=2;break}return o.n=1,(0,E.A)({keys:r,data:l});case 1:a=o.v;case 2:e.rowDataNoBloqueados=a;case 3:return o.a(2)}},o)}))()},getNoBloqueados:function(){var e=this;return I()(x()().m(function o(){var a,l;return x()().w(function(o){while(1)switch(o.p=o.n){case 0:return e.disableBloquear=!0,o.p=1,o.n=2,O.$http.get("api/bancoController/getPersonasNoBloqueadas",{params:{params:{numcta:e.numCuenta}}});case 2:a=o.v,e.rowDataNoBloqueados=a,e.rowDataNoBloqueadosIni=n()(e.rowDataNoBloqueados),e.filtroNoBloqueados(),o.n=4;break;case 3:o.p=3,l=o.v,e.$alert(l.error?l.error.message:l.message);case 4:return o.a(2)}},o,null,[[1,3]])}))()},filtroBloqueados:function(){var e=this;return I()(x()().m(function o(){var a,l,r;return x()().w(function(o){while(1)switch(o.n){case 0:if(a=[],l=n()(e.rowDataBloqueadosIni),r={CODIGO:e.filtroBloqueado.codigo,NOMCOMP:e.filtroBloqueado.nombres},!(l.length>0)){o.n=2;break}return o.n=1,(0,E.A)({keys:r,data:l});case 1:a=o.v;case 2:e.rowDataBloqueados=a;case 3:return o.a(2)}},o)}))()},getBloqueados:function(){var e=this;return I()(x()().m(function o(){var a,l;return x()().w(function(o){while(1)switch(o.p=o.n){case 0:return e.disableDesbloquear=!0,o.p=1,o.n=2,O.$http.get("api/bancoController/getPersonasBloqueadas",{params:{params:{numcta:e.numCuenta}}});case 2:a=o.v,e.rowDataBloqueados=a,e.rowDataBloqueadosIni=n()(e.rowDataBloqueados),e.filtroBloqueados(),o.n=4;break;case 3:o.p=3,l=o.v,e.$alert(l.error?l.error.message:l.message);case 4:return o.a(2)}},o,null,[[1,3]])}))()},onSelectionChangedNoBloqueados:function(){var e=this.apiNoBloqueados.getSelectedRows();e.length>0?this.disableBloquear=!1:this.disableBloquear=!0},onSelectionChangedBloqueados:function(){var e=this.apiBloqueados.getSelectedRows();e.length>0?this.disableDesbloquear=!1:this.disableDesbloquear=!0},refreshGrids:function(){this.disableDesbloquear=!0,this.disableBloquear=!0,this.getBloqueados(),this.getNoBloqueados()},onGridReadyNoBloqueados:function(e){this.apiNoBloqueados=e.api,this.columnsNoBloqueados()},onGridReadyBloqueados:function(e){this.apiBloqueados=e.api,this.columnsBloqueados()},openDesbloquearPersonasModal:function(){var e=this;return I()(x()().m(function o(){var a,l,n,r;return x()().w(function(o){while(1)switch(o.n){case 0:a=e.apiBloqueados.getSelectedRows(),e.perBloqueoTotalSelected=0,e.perBloqueoPersonalizadoSelected=0,l=M()(a);try{for(l.s();!(n=l.n()).done;)r=n.value,"T"===r.NUMCTA&&(e.openModalDesbloquear=!0,e.perBloqueoTotalSelected++)}catch(e){l.e(e)}finally{l.f()}if(e.perBloqueoPersonalizadoSelected=a.length-e.perBloqueoTotalSelected,!(e.perBloqueoTotalSelected>0)){o.n=1;break}return o.a(2);case 1:e.desbloquearSeleccionados();case 2:return o.a(2)}},o)}))()},openBloquearPersonasModal:function(){var e=this;return I()(x()().m(function o(){return x()().w(function(o){while(1)switch(o.n){case 0:e.openModalBloquear=!0;case 1:return o.a(2)}},o)}))()},bloquearSeleccionados:function(){var e=this;return I()(x()().m(function o(){var a,l,n,r,s,t,u,i,d;return x()().w(function(o){while(1)switch(o.p=o.n){case 0:e.openModalBloquear=!1,a=e.apiNoBloqueados.getSelectedRows(),l={procesados:[],errores:[]},e.$q.loading.show(),n=M()(a),o.p=1,n.s();case 2:if((r=n.n()).done){o.n=7;break}return s=r.value,t={idPersona:s.ID_PERSONA,numCuenta:e.tipoBloqueo,motivo:2},o.p=3,o.n=4,O.$http.post("api/bancoController/postBloquearPersona",{params:t});case 4:u=o.v,l.procesados.push(u),o.n=6;break;case 5:o.p=5,i=o.v,l.errores.push(i);case 6:o.n=2;break;case 7:o.n=9;break;case 8:o.p=8,d=o.v,n.e(d);case 9:return o.p=9,n.f(),o.f(9);case 10:e.refreshGrids(),e.$q.loading.hide(),e.mostrarMensaje(l,"Persona","bloqueada");case 11:return o.a(2)}},o,null,[[3,5],[1,8,9,10]])}))()},mostrarMensaje:function(e,o,a){var l="",n="success";e.procesados.length>1?l+="(".concat(e.procesados.length,") ").concat(o,"s ").concat(a,"s "):1===e.procesados.length&&(l+="(".concat(e.procesados.length,") ").concat(o," ").concat(a," ")),e.errores.length>1?(l+="(".concat(e.errores.length,") ").concat(o,"s NO ").concat(a,"s "),n="warning"):1===e.errores.length?(l+="(".concat(e.errores.length,") ").concat(o," NO ").concat(a," "),n="warning"):0===e.errores.length&&(l+="satisfactoriamente."),this.$alert(l,n)},desbloquearSeleccionados:function(){var e=this;return I()(x()().m(function o(){var a,l,n,r,s,t,u,i,d;return x()().w(function(o){while(1)switch(o.p=o.n){case 0:e.openModalDesbloquear=!1,a=e.apiBloqueados.getSelectedRows(),l={procesados:[],errores:[]},e.$q.loading.show(),n=M()(a),o.p=1,n.s();case 2:if((r=n.n()).done){o.n=7;break}return s=r.value,t={idPersona:s.ID_PERSONA,numCuenta:s.NUMCTA,motivo:2},o.p=3,o.n=4,O.$http.post("api/bancoController/postDesbloquearPersona",{params:t});case 4:u=o.v,l.procesados.push(u),o.n=6;break;case 5:o.p=5,i=o.v,l.errores.push(i);case 6:o.n=2;break;case 7:o.n=9;break;case 8:o.p=8,d=o.v,n.e(d);case 9:return o.p=9,n.f(),o.f(9);case 10:e.refreshGrids(),e.$q.loading.hide(),e.mostrarMensaje(l,"Persona","desbloqueada");case 11:return o.a(2)}},o,null,[[3,5],[1,8,9,10]])}))()},columnsNoBloqueados:function(){this.columnDefsNoBloqueados=[{headerName:"Código",sortable:!0,field:"CODIGO",width:90},{headerName:"Nombre",sortable:!0,width:350,field:"NOMCOMP",resizable:!0}]},columnsBloqueados:function(){this.columnDefsBloqueados=[{headerName:"Código",sortable:!0,field:"CODIGO",width:90},{headerName:"Nombre",sortable:!0,width:320,field:"NOMCOMP",resizable:!0},{headerName:"Tipo de Bloqueo",sortable:!0,width:120,field:"tipoBloqueo",resizable:!0}]},volver:function(){window.history.go(-1)}},computed:{display:function(){var e=this.$q.platform.is.mobile;return e&&this.api&&this.api.sizeColumnsToFit(),e}},beforeMount:function(){var e=this;return I()(x()().m(function o(){return x()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,e.getNoBloqueados();case 1:return o.n=2,e.getBloqueados();case 2:e.numCuenta||e.volver();case 3:return o.a(2)}},o)}))()},mounted:function(){return I()(x()().m(function e(){return x()().w(function(e){while(1)switch(e.n){case 0:return e.a(2)}},e)}))()}},Z=a(12807);const ee=(0,Z.A)(Y,[["render",S]]);var oe=ee}}]);