"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[63515],{63515:function(e,t,o){o.r(t),o.d(t,{default:function(){return b}});var a=o(8445),n=o.n(a),r=o(61758);function i(e,t){var o=(0,r.g2)("q-tooltip"),a=(0,r.g2)("q-fab-action"),i=(0,r.g2)("importar"),l=(0,r.g2)("q-table"),c=(0,r.g2)("sie-modal");return(0,r.uX)(),(0,r.CE)("div",null,[(0,r.bF)(i,{url:e.url,onImport:e.loadTemplate,onProcess:e.procesar},{helptext:(0,r.k6)(function(){return n()(t[4]||(t[4]=[(0,r.Lk)("dd",null,"- Primero exportar la plantilla",-1),(0,r.Lk)("dd",null,"- No modificar el archivo generado por el sistema",-1),(0,r.Lk)("dd",null,"- No insertar columnas ni filas",-1),(0,r.Lk)("dd",null,"- Solo llenar la información solicitada",-1)]))}),buttons:(0,r.k6)(function(){return[(0,r.bF)(a,{color:"secondary",icon:"file_excel",onClick:t[0]||(t[0]=function(t){return e.openModalFields=!0})},{default:(0,r.k6)(function(){return[(0,r.bF)(o,{anchor:"center left",self:"center right"},{default:(0,r.k6)(function(){return n()(t[5]||(t[5]=[(0,r.eW)("Exportar plantilla",-1)]))}),_:1})]}),_:1}),(0,r.bF)(a,{color:"secondary",icon:"history",onClick:e.revertir},{default:(0,r.k6)(function(){return[(0,r.bF)(o,{anchor:"center left",self:"center right"},{default:(0,r.k6)(function(){return n()(t[6]||(t[6]=[(0,r.eW)("Revertir importación",-1)]))}),_:1})]}),_:1},8,["onClick"])]}),_:1},8,["url","onImport","onProcess"]),(0,r.bF)(c,{modelValue:e.openModalFields,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.openModalFields=t}),title:"Seleccione los campos a exportar",css:{minWidth:"40vw"},onSubmit:e.exportar,ok:"Exportar"},{default:(0,r.k6)(function(){return[(0,r.bF)(l,{"table-class":"no-scroll",data:e.dataCampos,columns:e.columnsCampos,selected:e.dataSelected,"onUpdate:selected":t[1]||(t[1]=function(t){return e.dataSelected=t}),pagination:e.pagination,"onUpdate:pagination":t[2]||(t[2]=function(t){return e.pagination=t}),"hide-bottom":"","rows-per-page-options":[0],"row-key":"ID",selection:"multiple",color:"primary"},null,8,["data","columns","selected","pagination"])]}),_:1},8,["modelValue","onSubmit"])])}o(71225),o(50310),o(5962),o(70199),o(83190),o(68017);var l=o(6123),c=o(24729),s=o(57668),u=o(80340),d=o(30640),p=o(982),f=o(46267),m=o(80660),g={components:{QTable:l.kH,QFab:l.l6,QFabAction:l.B$,Dialog:c.A,sieVacio:u.A,sieModal:d.A,notify:p["default"],importar:f.A,QTooltip:l.nC},data:function(){return{url:"api/HyoExcel/cargaDataPersonal",openModalFields:!1,dataTemplate:[],dataCampos:[],dataSelected:[],urlExp:"/".concat(m.API_LMS,"/api/HyoExcel/exportPlantillaPersonal"),columnsCampos:[{name:"DESCRIPCION",label:"SELECCIONAR TODOS",field:"DESCRIPCION",align:"left"}],pagination:{sortBy:null,descending:!1,page:1,rowsPerPage:500}}},methods:{init:function(){this.obtenerCamposAExp()},obtenerCamposAExp:function(){var e=this;this.$http.get("api/HyoMCampos/obtCampos",{params:{tabla:["PROFE","PROFE_DO","PROFE_NAC"]}}).then(function(t){var o=t.json;e.dataCampos=o,e.dataSelected=o.filter(function(e){return"S"===e.OBLIGATORIO.trim()})}).catch(function(e){console.log(e)})},loadTemplate:function(e){this.dataTemplate=e.json,this.dataTemplate.length&&this.procesar()},exportar:function(){location.href=this.urlExp+"?sie-token="+(0,s["default"])().token+"&data="+JSON.stringify(this.dataSelected)},revertir:function(){var e=this;this.$q.dialog({title:"¿Esta seguro de revertir el proceso de importación?",ok:"SI",cancel:"NO"}).onOk(function(){e.$http.post("api/HyoMigracion/rollbackMigrarPersonal").then(function(e){(0,p["default"])(e.json.message,"success")}).catch(function(e){console.log(e),(0,p["default"])(e.error.message,"error")})})},procesar:function(){var e=this;this.dataTemplate.length>0?this.$q.dialog({title:"¿Desea continuar con el proceso de importación?",ok:"SI",cancel:"NO"}).onOk(function(){e.$http.post("api/HyoMigracion/migrarPersonal",{data:e.dataTemplate}).then(function(e){(0,p["default"])(e.json.message,"success")}).catch(function(e){console.log(e),(0,p["default"])(e.error.message,"error")})}):this.$q.dialog({title:"Aviso",message:"No hay información para importar",ok:"Aceptar"})}},created:function(){this.init()}},h=o(12807);const k=(0,h.A)(g,[["render",i]]);var b=k}}]);