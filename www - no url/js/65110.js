"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[65110],{65110:function(o,e,t){t.r(e),t.d(e,{default:function(){return po}});var n=t(61758),i=t(29104),s={key:0,class:"row q-col-gutter-sm q-px-sm q-py-md"},a={class:"col"},r={class:"col"},l={key:1,class:"row q-col-gutter-sm q-px-sm q-py-md"},u={class:"col-md-2 col-xs-12"},c={class:"col-md-5 col-xs-12"},d={class:"col-md-5 col-xs-12"},p={key:2,class:"col column"},f={key:0,class:"col scroll-y"},m={class:"row"},h={class:"q-pa-sm"},C={class:"row q-col-gutter-sm"},O={class:"col-12"},v={class:"col-12"},b={class:"col-12"},g={class:"q-gutter-sm"},A={class:"q-gutter-sm"};function k(o,e){var t=(0,n.g2)("q-select"),k=(0,n.g2)("q-btn"),E=(0,n.g2)("q-toolbar-title"),M=(0,n.g2)("q-toolbar"),I=(0,n.g2)("sie-curso"),S=(0,n.g2)("q-infinite-scroll"),R=(0,n.g2)("sie-vacio"),w=(0,n.g2)("sie-modal"),D=(0,n.g2)("q-page");return(0,n.uX)(),(0,n.Wv)(D,{class:"column curso bg-white"},{default:(0,n.k6)(function(){return["004"===o.sie.tipcod||"005"===o.sie.tipcod?((0,n.uX)(),(0,n.CE)("div",s,[o.fAno?((0,n.uX)(),(0,n.Wv)(t,{key:0,modelValue:o.anio,"onUpdate:modelValue":e[0]||(e[0]=function(e){return o.anio=e}),options:o.anios,label:"Años",onInput:o.seleccionarAnio},null,8,["modelValue","options","onInput"])):(0,n.Q3)("v-if",!0),(0,n.Lk)("div",a,[(0,n.bF)(t,{modelValue:o.nemo,"onUpdate:modelValue":e[1]||(e[1]=function(e){return o.nemo=e}),options:o.salones,"option-value":"NEMO","option-label":"NEMODES",onInput:o.seleccionarSalon,label:"Aula"},null,8,["modelValue","options","onInput"])]),(0,n.Lk)("div",r,[(0,n.bF)(t,{modelValue:o.alucod,"onUpdate:modelValue":e[2]||(e[2]=function(e){return o.alucod=e}),options:o.estudiantes,"option-value":"ALUCOD","option-label":"NOMCOMP",onInput:o.seleccionarAlumno,label:"Estudiantes"},null,8,["modelValue","options","onInput"])])])):((0,n.uX)(),(0,n.CE)("div",l,[(0,n.Lk)("div",u,[(0,n.bF)(t,{modelValue:o.anio,"onUpdate:modelValue":e[3]||(e[3]=function(e){return o.anio=e}),options:o.anios,label:"Años",onInput:o.seleccionarAnio},null,8,["modelValue","options","onInput"])]),(0,n.Lk)("div",c,[(0,n.bF)(t,{modelValue:o.nemo,"onUpdate:modelValue":e[4]||(e[4]=function(e){return o.nemo=e}),options:o.salones,"option-value":"NEMO","option-label":"NEMODES",onInput:o.seleccionarSalon,label:"Aula"},null,8,["modelValue","options","onInput"])]),(0,n.Lk)("div",d,[(0,n.bF)(t,{modelValue:o.alucod,"onUpdate:modelValue":e[5]||(e[5]=function(e){return o.alucod=e}),options:o.estudiantes,"option-value":"ALUCOD","option-label":"NOMCOMP",onInput:o.seleccionarAlumno,label:"Estudiantes"},null,8,["modelValue","options","onInput"])])])),o.nemo?((0,n.uX)(),(0,n.CE)("div",p,[(0,n.bF)(M,{class:"shadow-2 z-fab",inverted:""},{default:(0,n.k6)(function(){return[(0,n.bF)(E,{class:"q-pa-none items-center justify-between row"},{default:(0,n.k6)(function(){return[e[15]||(e[15]=(0,n.Lk)("div",null,"Cursos",-1)),(0,n.bF)(k,{label:"Reportes",color:"primary",onClick:e[6]||(e[6]=function(e){return o.modalReportes=!0})})]}),_:1})]}),_:1}),o.cursos.length>0?((0,n.uX)(),(0,n.CE)("div",f,[(0,n.bF)(S,{handler:o.cargarContenido,ref:"infiniteScroll"},{default:(0,n.k6)(function(){return[(0,n.Lk)("div",m,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(o.cursos,function(e,t){return(0,n.uX)(),(0,n.Wv)(I,{key:e.KEY,class:"col-xs-12 col-sm-6 col-md-4 col-lg-3",onClick:function(t){return o.detalleCurso(e)},title:e.CURSONOM,author:e.NOMCOMP,src:e.IMG},{default:(0,n.k6)(function(){return[o.accesoTotal?((0,n.uX)(),(0,n.Wv)(k,{key:0,class:"absolute-top-right",flat:"",round:"",icon:"edit",color:"faded",onClick:(0,i.D$)(function(t){return o.editarCurso(e)},["stop"])},null,8,["onClick"])):(0,n.Q3)("v-if",!0)]}),_:2},1032,["onClick","title","author","src"])}),128))])]}),_:1},8,["handler"])])):((0,n.uX)(),(0,n.Wv)(R,{key:1,class:"col"}))])):(0,n.Q3)("v-if",!0),(0,n.bF)(w,{title:"Reporte",modelValue:o.modalReportes,"onUpdate:modelValue":e[14]||(e[14]=function(e){return o.modalReportes=e}),ok:!1},{footerMobile:(0,n.k6)(function(){return[(0,n.Lk)("div",g,[(0,n.bF)(k,{flat:"",round:"",dense:"",onClick:e[10]||(e[10]=function(e){return o.print("xls")}),icon:"file_excel"}),(0,n.bF)(k,{flat:"",round:"",dense:"",onClick:e[11]||(e[11]=function(e){return o.print("pdf")}),icon:"file_pdf"})])]}),postButtonFooter:(0,n.k6)(function(){return[(0,n.Lk)("div",A,[(0,n.bF)(k,{color:"primary",onClick:e[12]||(e[12]=function(e){return o.print("xls")}),label:"Generar EXCEL",icon:"file_excel"}),(0,n.bF)(k,{color:"primary",onClick:e[13]||(e[13]=function(e){return o.print("pdf")}),label:"Generar PDF",icon:"file_pdf"})])]}),default:(0,n.k6)(function(){return[(0,n.Lk)("div",h,[(0,n.Lk)("div",C,[(0,n.Lk)("div",O,[(0,n.bF)(t,{modelValue:o.filterReporte.nemo,"onUpdate:modelValue":e[7]||(e[7]=function(e){return o.filterReporte.nemo=e}),options:o.filterReporte.salones,"option-value":"NEMO","option-label":"NEMODES",label:"Aula",onInput:o.selectSalon},null,8,["modelValue","options","onInput"])]),(0,n.Lk)("div",v,[(0,n.bF)(t,{modelValue:o.filterReporte.cursocod,"onUpdate:modelValue":e[8]||(e[8]=function(e){return o.filterReporte.cursocod=e}),options:o.filterReporte.cursos,"option-value":"CURSOCOD","option-label":"CURSONOM",label:"Curso"},null,8,["modelValue","options"])]),(0,n.Lk)("div",b,[(0,n.bF)(t,{modelValue:o.filterReporte.bimecod,"onUpdate:modelValue":e[9]||(e[9]=function(e){return o.filterReporte.bimecod=e}),options:o.filterReporte.periodos,"option-value":"value","option-label":"label",label:"Periodo"},null,8,["modelValue","options"])])])])]}),_:1},8,["modelValue"])]}),_:1})}var E=t(62086),M=t.n(E),I=t(76080),S=t.n(I),R=t(8445),w=t.n(R),D=t(45254),U=t.n(D),N=t(57008),V=t.n(N),y=(t(30683),t(71225),t(52133),t(10239),t(56285),t(50310),t(5962),t(6724),t(83190),t(83972)),$=t(6123),F=t(36153),L=t(82640),P=t(88275),x=t(92173),q=t(80340),G=t(57668),Q=t(91134),T=t.n(Q),X={emits:["click","update:modelValue","input"],render:function(){var o=this;return(0,n.h)($.H0,{class:"bg-white",separator:!0,onClick:this.elegirItem},{default:function(){return[(0,n.h)("img",T()({class:"img-libro",src:o.data.IMG,loading:"lazy"},"src",o.data.IMG)),(0,n.h)($.mF,{},{default:function(){return[(0,n.h)($.lp,{class:"text-weight-bold text-weight-bold",label:!0},{default:function(){return o.data.CURSONOM}}),(0,n.h)($.lp,{sublabel:!0,upper:!0},{default:function(){return o.data.NOMCOMP}})]}})]}})},methods:{elegirItem:function(){this.$emit("click",this.data)},cambiarInput:function(){this.$emit("update:modelValue",this.modelValue),this.$emit("input",this.modelValue)}},data:function(){return{cinput:"fff"}},computed:{},props:["detalleCurso","data","value"]},_=t(39584),H=t(36980),j=t(30640),B=t(59089),K=t(33950),W=t(982),z=t(80660),Y=t(84569),Z=t(29706),J=t(72453),oo=t(16648),eo=t(78786),to=t(2819),no=t(6583),io=t(8261),so=["USUCODF","FAMILIA"],ao=["FAMILIA"],ro="intranet.informes",lo={setup:function(){var o=(0,y.fG)();return{v$:o}},components:{sieAno:J.A,sieUpload:B.A,sieModal:j.A,sieEstudiantes:x.Ay,QInfiniteScroll:$.nN,QCard:$.C$,QSearch:$.Ks,sieSalones:P.Ay,sieVacio:q.A,QPopover:$.VM,itemCurso:X,Loading:F.A,sieCurso:Z.A,QSelect:oo.A,QPage:$.Tu,QToolbar:$.ZV,QToolbarTitle:$.r_,QBtn:$.Il},data:function(){return{dataAnio:{},dataSalon:{},dataEstudiante:{},$upload:null,file$:null,dataImagen:{},sie:(0,G["default"])(),descripcion:"",imagen:"",stopScroll:!1,modalEditarCurso:!1,datos:{},itemSeleccionado:"todos",keyPeriodos:[],keyCursos:[],dataCursos:[],instrucod:"",gradocod:"",anios:[],salones:[],estudiantes:[],fAno:-1!==["0385"].indexOf((0,G["default"])().colcod),modalReportes:!1,filterReporte:{salones:[],cursos:[],periodos:[],nemo:null,bimecod:null,cursocod:null}}},computed:V()(V()({},(0,H.aH)("portafolio",["cursos","periodos","cursonom","peticiones","limitCursos","alucod","usucodAlumno"])),{},{nemo:{get:function(){return this.$store.state.portafolio.nemo},set:function(o){this.$store.commit("portafolio/setNemo",o)}},alucod:{get:function(){return this.$store.state.portafolio.alucod},set:function(o){this.$store.commit("portafolio/setAlucod",o)}},anio:{get:function(){return this.$store.state.portafolio.anio},set:function(o){this.$store.commit("portafolio/setAnio",o)}},accesoTotal:function(){return this.sie.esOtros&&3===this.sie.ruta.nivel&&-1===["0090"].indexOf(this.sie.colcod)},hasInforme:function(){return!0===this.sie.esOtros&&(0,Y.yy)(ro)}}),methods:{added:function(o){this.file$=o[0]},editarImagen:function(){var o=this;return U()(S()().m(function e(){var t,n,i,s,a,r,l;return S()().w(function(e){while(1)switch(e.p=e.n){case 0:return t=o.dataImagen,n=o,i=o.file$,s={cursocod:t.CURSOCOD,descripcion:n.descripcion,flEliminar:0,grupocod:t.GRUPOCOD,nemo:n.nemo},e.p=1,e.n=2,(0,K.Basic)({url:"api/HyoArchivo/tmp/upload",file:i,onProgress:function(o,e){}});case 2:a=e.v,r=a.result.files.file,s.imagen=r[0].originalFilename,s.imagenTemp=r[0].name,s.flEliminar=1,e.n=4;break;case 3:e.p=3,e.v;case 4:return e.p=4,e.n=5,z.$http.post("api/HyoCursoGrupo/registraDatos",s);case 5:l=w()(n.cursos),l.map(function(o){return o.KEY===t.KEY&&(o.IMG=o.IMG+"&datetime=".concat((new Date).getTime())),o}),n.$store.commit("portafolio/setCursos",l),(0,W["default"])("actualizado"),o.modalEditarCurso=!1,e.n=7;break;case 6:e.p=6,e.v,(0,W["default"])("No pudo actualizar completamente","error");case 7:return e.a(2)}},e,null,[[4,6],[1,3]])}))()},editarCurso:function(o){this.dataImagen=o,this.descripcion=o.DESCRIPCION,this.imagen=o.IMG,this.modalEditarCurso=!0},cargarContenido:function(o,e,t){var n="".concat(this.nemo).concat(this.alucod);this.peticiones[n]&&!this.peticiones[n].ajax.isPending()&&this.getCursos({nemo:this.nemo},e)},seleccionarAlumno:function(o){var e=(0,eo["default"])(this.estudiantes,o,{key:"ALUCOD"}),t=this.estudiantes[e];if(this.dataEstudiante=t,this.dataSalon.NEMO){if(this.$store.commit("portafolio/setUsucodAlumno",t.USUCOD),t.NEMO){var n=t.NEMO,i=t.ALUCOD;this.alucod=i,this.nemo=n,this.instrucod=t.INSTRUCOD,this.gradocod=t.GRADOCOD,this.peticiones.hasOwnProperty("".concat(this.nemo).concat(i))||this.$store.commit("portafolio/setInitPeticiones","".concat(this.nemo).concat(i)),this.stopScroll&&this.$refs.infiniteScroll.resume(),F.A.show(),this.cargarContenido()}}else(0,W["default"])("Debe seleccionar un salón.","warning")},seleccionarSalon:function(o){var e=this;return U()(S()().m(function t(){var n,i;return S()().w(function(t){while(1)switch(t.n){case 0:return n=(0,eo["default"])(e.salones,o,{key:"NEMO"}),i=e.salones[n],e.dataSalon=i,t.n=1,e.getEstudiantes(o);case 1:return t.a(2)}},t)}))()},detalleCurso:function(o){var e=o.CURSOCOD,t=o.GRUPOCOD,n=o.CURSONOM,i=o.NEMO,s=o.NOMCOMP;if(!this.alucod)return(0,W["default"])("Debe seleccionar un alumno.","info"),!1;var a=i||this.nemo,r=this.dataEstudiante.ALUCOD;this.$router.push({name:"intranet.portafolio.contenido",params:{idalumno:r,nemo:a,cursocod:e,grupocod:t}}),this.$store.commit("portafolio/setCursonom",n),this.$store.commit("portafolio/setProfesor",s),this.$store.commit("portafolio/setDatos",{nemodes:this.dataSalon.NEMODES,docentenom:s,cursonom:n,alunom:this.dataEstudiante.NOMCOMP})},seleccionarAnio:function(o){var e=this;return U()(S()().m(function t(){return S()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,e.getSalones(o);case 1:return t.a(2)}},t)}))()},getCursos:function(o,e){var t=this,n=o.nemo,i=this.$store,s="".concat(n).concat(this.alucod);if(this.datos.hasOwnProperty(s)||(this.$store.commit("portafolio/setInitPeticiones",s),this.datos[s]={cursos:[]}),this.peticiones[s].lastAjaxLength<this.limitCursos&&(this.stopScroll=!0,"function"===typeof e))return e(!0);this.alucod&&(o.alucod=this.alucod),o.ano=this.anio;var a=i.dispatch("portafolio/getCursosPeriodos",o);i.commit("portafolio/setPeticiones",{nemo:n,alucod:this.alucod,ajax:a}),a.then(function(o){["0032"].indexOf(t.sie.colcod)>=0&&"S"===t.instrucod&&["4","5"].indexOf(t.gradocod>=0)&&(o=o.filter(function(o){return"108"!==o.GRUPOCOD})),F.A.hide(),t.datos[s]["cursos"]=t.datos[s]["cursos"].concat(o),t.$store.commit("portafolio/setCursos",t.datos[s]["cursos"]),"function"===typeof e&&e()}).catch(function(o){F.A.hide()})},goInformes:function(){this.$router.push({name:ro,query:{nemo:this.nemo}})},getSalones:function(o){var e=this;return U()(S()().m(function t(){var n,i;return S()().w(function(t){while(1)switch(t.n){case 0:return n={columns:["NEMO","NEMODES","INSTRUCOD","GRADOCOD"],ano:o},t.n=1,z.$http.get("api/HyoSalones/getAll",{params:n});case 1:return i=t.v,e.salones=(0,io["default"])(i.map(function(o){o.USUCODF,o.FAMILIA;var e=M()(o,so);return e}),"NEMO"),e.nemo=i[0].NEMO,e.filterReporte.salones=i,e.filterReporte.salones.unshift({NEMO:null,NEMODES:"Todos"}),t.n=2,e.seleccionarSalon(e.nemo);case 2:return t.a(2)}},t)}))()},getEstudiantes:function(o){var e=this;return U()(S()().m(function t(){var n,i,s;return S()().w(function(t){while(1)switch(t.n){case 0:return n={parametros:{matriculado:"S",aula:o,ano:e.anio}},t.n=1,z.$http.get("api/HyoAlumnos/listarAlumnosHijos",{params:n});case 1:i=t.v,s=i.json,e.estudiantes=(0,io["default"])(s.map(function(o){o.FAMILIA;var e=M()(o,ao);return e}),"ALUCOD"),e.alucod=o?s[0].ALUCOD:null,o&&e.seleccionarAlumno(e.alucod);case 2:return t.a(2)}},t)}))()},selectSalon:function(){var o=this;return U()(S()().m(function e(){var t,n,i,s,a;return S()().w(function(e){while(1)switch(e.n){case 0:return t={nemo:o.filterReporte.nemo},e.n=1,z.$http.post("api/HyoAsignaprs/getCursosPeriodos",{parametros:t});case 1:n=e.v,i=n.json,s=i.cursos,a=i.periodos,s=(0,no["default"])(s),s.unshift({CURSOCOD:null,CURSONOM:"Todos"}),a=(0,no["default"])(a),a=a.map(function(o){return{label:"".concat(o.BIMECOD," ").concat(o.PERIDES),value:o.BIMECOD}}),a.unshift({label:"Anual",value:null}),o.filterReporte.cursos=s,o.filterReporte.periodos=a;case 2:return e.a(2)}},e)}))()},print:function(o){var e={repcod:"reportePortafolio",formato:o};this.filterReporte.nemo&&(e.nemo=this.filterReporte.nemo),this.filterReporte.cursocod&&(e.cursocod=this.filterReporte.cursocod),this.filterReporte.bimecod&&(e.bimecod=this.filterReporte.bimecod),(0,to.exportFilePhp)(e,"intranet/reporte-node/reporte",e.repcod)}},validations:{descripcion:{required:L.mw}},created:function(){var o=this;return U()(S()().m(function e(){var t,n;return S()().w(function(e){while(1)switch(e.n){case 0:return o.$store.hasModule("portafolio")||o.$store.registerModule("portafolio",_.A),e.n=1,z.$http.get("api/HyoAnos/obtAnos");case 1:return t=e.v,n=t.json,o.anios=n.map(function(o){return{label:o.ANO,value:o.ANO}}),e.n=2,o.seleccionarAnio(o.anio);case 2:return e.a(2)}},e)}))()}},uo=t(12807);const co=(0,uo.A)(lo,[["render",k]]);var po=co}}]);