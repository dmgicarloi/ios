"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[55743],{55743:function(e,a,o){o.r(a),o.d(a,{default:function(){return P}});var t=o(61758),l=o(58790),n={class:"row items-center no-wrap"},r={class:"col"},s={class:"text-h6"},c={class:"col-auto"},i={class:"row q-ma-xs q-col-gutter-sm"},u={class:"col-xs-12 col-sm-6 q-pa-xs"},d={class:"col-xs-12 col-sm-3 q-pa-xs"},O={class:"col-xs-12 col-sm-3 q-pa-xs"};function m(e,a){var o=(0,t.g2)("crearBotones"),m=(0,t.g2)("q-card-section"),p=(0,t.g2)("tesoreriaLoading"),D=(0,t.g2)("q-separator"),g=(0,t.g2)("q-select"),h=(0,t.g2)("q-input"),E=(0,t.g2)("sie-grid"),f=(0,t.g2)("footer-grid"),N=(0,t.g2)("q-card");return(0,t.uX)(),(0,t.Wv)(N,{class:"layout-v1 my-card",flat:"",bordered:""},{default:(0,t.k6)(function(){return[(0,t.bF)(m,null,{default:(0,t.k6)(function(){return[(0,t.Lk)("div",n,[(0,t.Lk)("div",r,[(0,t.Lk)("div",s,"Descuento Semestral ("+(0,l.v_)(e.selectAnio)+")",1)]),(0,t.Lk)("div",c,[(0,t.bF)(o,{buttons:e.botones,nivelAcceso:e.nivelAcceso,option:e.nameComponente},null,8,["buttons","nivelAcceso","option"])])])]}),_:1}),(0,t.bF)(p,{modelValue:e.loading.showLoading,total:e.loading.total,procesados:e.loading.procesados},null,8,["modelValue","total","procesados"]),(0,t.bF)(D),(0,t.bF)(m,null,{default:(0,t.k6)(function(){return[(0,t.Lk)("div",i,[(0,t.Lk)("div",u,[(0,t.bF)(g,{modelValue:e.selectAlumno,"onUpdate:modelValue":a[0]||(a[0]=function(a){return e.selectAlumno=a}),"option-value":"value","option-label":"label",options:e.alumnos,onInput:e.getDeudasDescuentoSemestral,label:"Alumno"},null,8,["modelValue","options","onInput"])]),(0,t.Lk)("div",d,[(0,t.bF)(g,{modelValue:e.selectMes,"onUpdate:modelValue":a[1]||(a[1]=function(a){return e.selectMes=a}),"option-value":"value","option-label":"label",options:e.meses,label:"Seleccione el Mes a Descontar"},null,8,["modelValue","options"])]),(0,t.Lk)("div",O,[(0,t.bF)(h,{modelValue:e.porDesc,"onUpdate:modelValue":a[2]||(a[2]=function(a){return e.porDesc=a}),maxlength:"10",label:"Porcentaje de Descuento",placeholder:"Ingrese el porcentaje a Descontar"},null,8,["modelValue"])])]),(0,t.bF)(E,{class:"q-mt-xs fix-tab-height ag-theme-balham",columnDefs:e.columnDefs,rowData:e.rowData,frameworkComponents:e.frameworkComponents,onGridReady:e.onGridReady,rowSelection:"multiple",style:(0,l.Tr)(e.styleGrilla)},null,8,["columnDefs","rowData","frameworkComponents","onGridReady","style"]),(0,t.bF)(f,{modelValue:e.pagina,"onUpdate:modelValue":a[3]||(a[3]=function(a){return e.pagina=a}),max:e.pages,rows:e.rowData,onLoad:e.getDeudasDescuentoSemestral},null,8,["modelValue","max","rows","onLoad"])]}),_:1})]}),_:1})}var p=o(41562),D=o.n(p),g=o(76080),h=o.n(g),E=o(45254),f=o.n(E),N=(o(30683),o(52133),o(10239),o(50310),o(6724),o(83190),o(88567)),M=o(95718),v=o(54489),S=o(53380),C=o(64208),b=o(80660),w=o(6123),T=o(36408),I=o(42037),A=o(57668),B=o(27560),_=o(41615),x=o(64303),U=o(17915),F=o(2652),R={components:{QPageHeader:F.A,QCard:N.A,QCardSection:M.A,QSelect:v.S,QSeparator:S.A,QOptionGroup:w.EX,sieGrid:T.A,QInput:C.A,footerGrid:B.A,crearBotones:x.A,tesoreriaLoading:U.A},data:function(){return{nameComponente:"DescuentoSemestral",nivelAcceso:(0,A["default"])().ruta.nivel,columnDefs:null,rowData:null,api:null,frameworkComponents:null,pagina:1,pages:1,anio:[],meses:[{label:"06 - Junio",value:"06"},{label:"07 - Julio",value:"07"},{label:"08 - Agosto",value:"08"},{label:"09 - Septiembre",value:"09"},{label:"10 - Octubre",value:"10"},{label:"11 - Noviembre",value:"11"},{label:"12 - Diciembre",value:"12"}],alumnos:[],selectAnio:String((0,A["default"])().ano),selectMes:"12",selectAlumno:"T",styleGrilla:"width: 100wv; height: calc(100vh - 352px)",porDesc:5,loading:{showLoading:!1,procesados:0,total:0}}},methods:{crearBotones:function(){var e=this;return f()(h()().m(function a(){return h()().w(function(a){while(1)switch(a.n){case 0:e.botones=[{label:"Procesar",icon:"settings",click:e.aplicarDescuentoSemestral,minAcceso:_["default"].ACCESO_TOTAL}];case 1:return a.a(2)}},a)}))()},getAnios:function(){var e=this;return f()(h()().m(function a(){var o;return h()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,b.$http.get("api/anioController/getAnios",{params:{parametros:{response:"combo"}}});case 1:o=a.v,o.map(function(a){e.anio.push({value:a.ID,label:a.ANO})});case 2:return a.a(2)}},a)}))()},onGridReady:function(e){this.api=e.api},getDeudasDescuentoSemestral:function(){var e=this;return f()(h()().m(function a(){var o,t,l,n;return h()().w(function(a){while(1)switch(a.n){case 0:return o={idPersona:e.selectAlumno,anocob:e.selectAnio},a.n=1,b.$http.get("api/cobroController/getDeudasDescuentoSemestral",{params:{params:o}});case 1:e.rowData=a.v,e.alumnos.push({label:"Todos",value:"T"}),t=D()(e.rowData);try{for(t.s();!(l=t.n()).done;)n=l.value,e.alumnos.push({value:n.ID_PERSONA,label:n.ALUCOD+" | "+n.NOMCOMP})}catch(e){t.e(e)}finally{t.f()}case 2:return a.a(2)}},a)}))()},aplicarDescuentoSemestral:function(){var e=this;return f()(h()().m(function a(){var o;return h()().w(function(a){while(1)switch(a.n){case 0:o=e.api.getSelectedRows(),0===o.length?e.$alert("Debe de seleccionar al menos un alumno","warning"):0===e.porDesc||e.porDesc<0?e.$alert("El porcentaje de descuento no puede ser 0","warning"):e.$confirm("¿Esta seguro de aplicar el descuento semestral a los alumnos seleccionados?","info").onOk(f()(h()().m(function a(){var t,l,n,r,s,c,i;return h()().w(function(a){while(1)switch(a.p=a.n){case 0:e.loading.showLoading=!0,e.loading.total=o.length,e.loading.procesados=0,e.$q.loading.hide(),t=[],l=D()(o),a.p=1,l.s();case 2:if((n=l.n()).done){a.n=7;break}return r=n.value,a.p=3,s={porcDescuento:e.porDesc,mescob:e.selectMes,registros:[{ID_DEUDA:r.ID_JUNIO,MESCOB:"06",MONTOCOB:r.JUNIO_MONTOCOB,MONTOPEN:r.JUNIO,MONTODES:r.JUNIO_MONTODES},{ID_DEUDA:r.ID_JULIO,MESCOB:"07",MONTOCOB:r.JULIO_MONTOCOB,MONTOPEN:r.JULIO,MONTODES:r.JULIO_MONTODES},{ID_DEUDA:r.ID_AGOSTO,MESCOB:"08",MONTOCOB:r.AGOSTO_MONTOCOB,MONTOPEN:r.AGOSTO,MONTODES:r.AGOSTO_MONTODES},{ID_DEUDA:r.ID_SEPTIEMBRE,MESCOB:"09",MONTOCOB:r.SEPTIEMBRE_MONTOCOB,MONTOPEN:r.SEPTIEMBRE,MONTODES:r.SEPTIEMBRE_MONTODES},{ID_DEUDA:r.ID_OCTUBRE,MESCOB:"10",MONTOCOB:r.OCTUBRE_MONTOCOB,MONTOPEN:r.OCTUBRE,MONTODES:r.OCTUBRE_MONTODES},{ID_DEUDA:r.ID_NOVIEMBRE,MESCOB:"11",MONTOCOB:r.NOVIEMBRE_MONTOCOB,MONTOPEN:r.NOVIEMBRE,MONTODES:r.NOVIEMBRE_MONTODES},{ID_DEUDA:r.ID_DICIEMBRE,MESCOB:"12",MONTOCOB:r.DICIEMBRE_MONTOCOB,MONTOPEN:r.DICIEMBRE,MONTODES:r.DICIEMBRE_MONTODES}]},a.n=4,b.$http.put("api/cobroController/putAplicarDescuentoSemestral",{params:s}).then(function(a){e.succes=a,e.loading.procesados++,1===o.length&&e.$alert("Proceso Finalizado Satisfactoriamente: Deudas procesadas 1 de 1","success")}).catch(function(a){e.error=a.error,1===o.length&&e.$alert(a.error.message,"error")});case 4:a.n=6;break;case 5:a.p=5,c=a.v,e.$q.loading.hide(),t.push(c.error?c.error.message:c.message);case 6:a.n=2;break;case 7:a.n=9;break;case 8:a.p=8,i=a.v,l.e(i);case 9:return a.p=9,l.f(),a.f(9);case 10:e.loading.showLoading=!1,e.getDeudasDescuentoSemestral(),o.length>1&&(0===e.loading.procesados?e.$alert("Proceso incompleto, procesado 0 de ".concat(e.loading.total," registros"),"error"):e.loading.procesados<e.loading.total?e.$alert("Proceso Finalizado: Se procesaron solo ".concat(e.loading.procesados," de ").concat(e.loading.total," registros."),"warning"):e.$alert("Proceso Finalizado Satisfactoriamente: Registros procesadas ".concat(e.loading.procesados," de ").concat(e.loading.total),"success"));case 11:return a.a(2)}},a,null,[[3,5],[1,8,9,10]])})));case 1:return a.a(2)}},a)}))()}},beforeMount:function(){var e=this;return f()(h()().m(function a(){return h()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,e.crearBotones();case 1:return a.n=2,e.getAnios();case 2:return a.n=3,e.getDeudasDescuentoSemestral();case 3:e.columnDefs=[{headerName:"Código",field:"ALUCOD",width:90},{headerName:"Nombres",field:"NOMCOMP",width:350},{headerName:"NGS",field:"NGS",width:50},{headerName:"Junio",field:"JUNIO",cellClass:"text-right",valueFormatter:I.toFixed,decimales:2,width:110},{headerName:"Julio",field:"JULIO",cellClass:"text-right",valueFormatter:I.toFixed,decimales:2,width:110},{headerName:"Agosto",field:"AGOSTO",cellClass:"text-right",valueFormatter:I.toFixed,decimales:2,width:110},{headerName:"Septiembre",field:"SEPTIEMBRE",cellClass:"text-right",valueFormatter:I.toFixed,decimales:2,width:110},{headerName:"Octubre",field:"OCTUBRE",cellClass:"text-right",valueFormatter:I.toFixed,decimales:2,width:110},{headerName:"Noviembre",field:"NOVIEMBRE",cellClass:"text-right",valueFormatter:I.toFixed,decimales:2,width:110},{headerName:"Diciembre",field:"DICIEMBRE",cellClass:"text-right",valueFormatter:I.toFixed,decimales:2,width:110}];case 4:return a.a(2)}},a)}))()}},k=o(12807);const L=(0,k.A)(R,[["render",m]]);var P=L}}]);