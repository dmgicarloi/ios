"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[1329],{1329:function(o,e,n){n.r(e),n.d(e,{default:function(){return D}});var r=n(61758),a={class:"row q-col-gutter-sm"},t={class:"col-xs-12 col-sm-4"},l={class:"col-xs-12 col-sm-8"},u={class:"col-xs-12 col-sm-4"},c={class:"col-xs-12 col-sm-8"},s={class:"row q-pa-sm q-col-gutter-sm"},i={class:"col-xs-12 sie-flat"};function d(o,e){var n=this,d=(0,r.g2)("header-btn"),m=(0,r.g2)("q-input"),f=(0,r.g2)("q-form"),p=(0,r.g2)("q-card-section"),g=(0,r.g2)("q-card"),h=(0,r.g2)("sie-table"),v=(0,r.g2)("sie-modal"),b=(0,r.g2)("q-page");return(0,r.uX)(),(0,r.Wv)(b,{class:"cambio-codigo-personal q-pa-sm"},{default:(0,r.k6)(function(){return[(0,r.bF)(g,null,{default:(0,r.k6)(function(){return[(0,r.bF)(d,{name:"Modificar Código de Personal",buttons:o.buttons},null,8,["buttons"]),(0,r.bF)(p,{style:{height:"calc(100vh - 115px)"}},{default:(0,r.k6)(function(){return[(0,r.bF)(f,{ref:"refForm"},{default:(0,r.k6)(function(){return[(0,r.Lk)("div",a,[(0,r.Lk)("div",t,[(0,r.bF)(m,{modelValue:o.codigo,"onUpdate:modelValue":e[0]||(e[0]=function(e){return o.codigo=e}),"float-label":"Código de personal",label:"Código de personal",rules:[o.campoRequerido],debounce:"500",onInput:o.buscarPersonal},null,8,["modelValue","rules","onInput"])]),(0,r.Lk)("div",l,[(0,r.bF)(m,{modelValue:o.nomcomp,"onUpdate:modelValue":e[1]||(e[1]=function(e){return o.nomcomp=e}),readonly:!0},null,8,["modelValue"])]),(0,r.Lk)("div",u,[(0,r.bF)(m,{modelValue:o.nuevoCodigo,"onUpdate:modelValue":e[2]||(e[2]=function(e){return o.nuevoCodigo=e}),"float-label":"Nuevo código de personal",label:"Nuevo código de personal",rules:[o.campoRequerido],debounce:"500",onInput:o.validarNuevoCodigo},null,8,["modelValue","rules","onInput"])]),(0,r.Lk)("div",c,[(0,r.bF)(m,{modelValue:o.nomcompNuevo,"onUpdate:modelValue":e[3]||(e[3]=function(e){return o.nomcompNuevo=e}),"float-label":"Personal",readonly:!0},null,8,["modelValue"])])])]}),_:1},512)]}),_:1})]}),_:1}),(0,r.bF)(v,{class:"modal-personal-filtro",modelValue:o.openModal,"onUpdate:modelValue":e[4]||(e[4]=function(e){return o.openModal=e}),title:"Buscar Personal"},{default:(0,r.k6)(function(){return[(0,r.Lk)("div",s,[(0,r.Lk)("div",i,[(0,r.bF)(h,{selection:"single",context:n,css:"height: 400px",search:"Buscar Personal",columns:o.columns,onRowSelected:o.rowSelected,data:o.rowsPersonal,config:o.config},null,8,["columns","onRowSelected","data","config"])])])]}),_:1},8,["modelValue"])]}),_:1})}var m=n(99550),f=n.n(m),p=n(76080),g=n.n(p),h=n(45254),v=n.n(h),b=(n(71225),n(50310),n(5962),n(83190),n(6123)),P=n(88567),w=n(95718),C=n(9736),O=n(2739),k={data:function(){return{config:{},rowsFamilias:[],columns:[{name:"PROFCOD",label:"Código",field:"PROFCOD",align:"center"},{name:"NOMCOMP",label:"Apellidos y Nombres",field:"NOMCOMP",align:"left"}]}}},F=n(30640),M=n(982),N=n(80660),V={cambiarCodigo:function(o,e){return N.$http.post("api/ProfeController/cambiarCodigoPersonal",{profcod:o,newprofcod:e})}},q={mixins:[k],components:{QCard:P.A,QCardSection:w.A,QInput:C.A,QForm:O.A,config:k,sieModal:F.A,QPage:b.Tu},data:function(){return{codigo:null,nuevoCodigo:null,nomcomp:null,nomcompNuevo:null,dataSinMatricula:[],rowsPersonal:[],openModal:!1,buttons:[{icon:"search",label:"Buscar",click:this.buscar},{icon:"cogs",label:"Procesar",permiso:"> 2",click:this.procesar}]}},methods:{buscar:function(){var o=this;return v()(g()().m(function e(){return g()().w(function(e){while(1)switch(e.n){case 0:o.openModal=!0;case 1:return e.a(2)}},e)}))()},campoRequerido:function(o){return!!o||"Campo requerido"},rowSelected:function(o){this.codigo=o.PROFCOD,this.nomcomp=o.NOMCOMP,this.openModal=!1},procesar:function(){var o=this;return v()(g()().m(function e(){var n;return g()().w(function(e){while(1)switch(e.n){case 0:return e.n=1,o.$refs.refForm.validate();case 1:if(n=e.v,n){e.n=2;break}return e.a(2);case 2:if(!o.nomcompNuevo){e.n=3;break}return(0,M["default"])("El nuevo código ingresado ya se encuentra registrado","warning"),e.a(2,!1);case 3:V.cambiarCodigo(o.codigo,o.nuevoCodigo).then(function(){var e=v()(g()().m(function e(n){return g()().w(function(e){while(1)switch(e.n){case 0:return(0,M["default"])("Proceso terminado","success"),e.n=1,o.getDatosPersonal();case 1:o.rowsPersonal=e.v,o.limpiar();case 2:return e.a(2)}},e)}));return function(o){return e.apply(this,arguments)}}()).catch(function(o){(0,M["default"])("Ocurrió un problema","warning")});case 4:return e.a(2)}},e)}))()},limpiar:function(){this.codigo=null,this.nuevoCodigo=null,this.nomcomp=null,this.nomcompNuevo=null,this.$refs.refForm.reset()},getDatosPersonal:function(){var o=this;return v()(g()().m(function e(){var n;return g()().w(function(e){while(1)switch(e.n){case 0:return n={},n.columnas=["PROFCOD","NOMCOMP"],n.order={sidx:"nomcomp",sord:"asc"},e.a(2,o.$http.get("api/ProfeController/getProfe",{params:{parametros:n}}))}},e)}))()},encontrarPersonal:function(o){var e=this.rowsPersonal.filter(function(e){return e.PROFCOD===o}),n=f()(e,1),r=n[0];return r?r.NOMCOMP:null},buscarPersonal:function(){this.nomcomp=this.encontrarPersonal(this.codigo)},validarNuevoCodigo:function(){this.nomcompNuevo=this.encontrarPersonal(this.nuevoCodigo),this.nomcompNuevo&&(0,M["default"])("El nuevo código ingresado ya se encuentra registrado","warning")}},created:function(){var o=this;return v()(g()().m(function e(){return g()().w(function(e){while(1)switch(e.n){case 0:return e.n=1,o.getDatosPersonal();case 1:o.rowsPersonal=e.v;case 2:return e.a(2)}},e)}))()}},x=n(12807);const R=(0,x.A)(q,[["render",d]]);var D=R}}]);