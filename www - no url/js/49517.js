"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[49517],{49517:function(n,e,a){a.r(e),a.d(e,{default:function(){return S}});var t=a(61758),i={class:"row q-pa-sm q-col-gutter-sm"},r={class:"col-12"};function o(n,e){var a=this,o=(0,t.g2)("header-btn"),s=(0,t.g2)("sie-table"),l=(0,t.g2)("q-card-section"),c=(0,t.g2)("q-card"),u=(0,t.g2)("treeUnidadOrganizativa"),d=(0,t.g2)("sie-modal"),g=(0,t.g2)("q-page");return(0,t.uX)(),(0,t.Wv)(g,{class:"q-pa-sm intranet-unidade-organizativa-personal sie-flat"},{default:(0,t.k6)(function(){return[(0,t.bF)(c,{flat:""},{default:(0,t.k6)(function(){return[(0,t.bF)(l,null,{default:(0,t.k6)(function(){return[!0===n.isLogged?((0,t.uX)(),(0,t.Wv)(o,{key:0,name:"Unidades Organizativas Por Salón","font-size":"15px",buttons:n.buttonsCerrarLogin,auto:!1},null,8,["buttons"])):((0,t.uX)(),(0,t.Wv)(o,{key:1,name:"Unidades Organizativas Por Salón","font-size":"15px",buttons:n.buttonsLogin,auto:!1},null,8,["buttons"])),(0,t.bF)(s,{"save-cells":"",data:n.rowsSalon,columns:n.fieldsSalon,config:n.configSalon,css:"height: calc(100vh - 150px)",context:a},null,8,["data","columns","config"])]}),_:1})]}),_:1}),(0,t.bF)(d,{modelValue:n.openModalUnidadOrganizativa,"onUpdate:modelValue":e[0]||(e[0]=function(e){return n.openModalUnidadOrganizativa=e}),title:"Unidad Organizativa",ok:!1},{default:(0,t.k6)(function(){return[(0,t.Lk)("div",i,[(0,t.Lk)("div",r,[(0,t.bF)(u,{ref:"unidadesOrganizativa",onSelected:n.selectUnidadOrganizativa},null,8,["onSelected"])])])]}),_:1},8,["modelValue"])]}),_:1})}var s=a(76080),l=a.n(s),c=a(45254),u=a.n(c),d=(a(10239),a(6123)),g=a(88567),f=a(95718),p=a(6583),v=a(30640),w={data:function(){return{configSalon:{ID_UNIDAD_ORGANIZATIVA:{multiRender:[{renderHtml:function(n,e,a){return n.ID_UNIDAD_ORGANIZATIVA?e("span",{},n.ID_UNIDAD_ORGANIZATIVA):e("div",{style:"width: 60px"},"-")},renderAction:function(n,e){var a=this;return u()(l()().m(function n(){return l()().w(function(n){while(1)switch(n.n){case 0:a.rowSalonSelected=e,a.openModalUnidadOrganizativa=!0;case 1:return n.a(2)}},n)}))()}},{renderHtml:function(n,e,a){return n.ID_UNIDAD_ORGANIZATIVA?e("div",{class:"row q-gutter-sm"},[a.icon({name:"broom"})]):e("span",{},"")},renderAction:function(n,e){var a=this;return u()(l()().m(function t(){return l()().w(function(t){while(1)switch(t.p=t.n){case 0:return t.p=0,t.n=1,a.$http.put("api/HyoSalones/updateSalonIdUnidadOrganizativa",{nemo:n.NEMO,idUnidadOrganizativa:null});case 1:return e.ID_UNIDAD_ORGANIZATIVA="",t.a(2,!0);case 2:return t.p=2,t.v,t.a(2,!1)}},t,null,[[0,2]])}))()}}]}},rowSalonSelected:null,rowsSalon:[],fieldsSalon:[{name:"NEMO",label:"Código",field:"NEMO",align:"center"},{name:"ANO",label:"Año",field:"ANO",align:"center"},{name:"NEMODES",label:"Descripción",field:"NEMODES",align:"left",sortable:!0},{name:"ID_UNIDAD_ORGANIZATIVA",label:"Unidad Organizativa",field:"ID_UNIDAD_ORGANIZATIVA",align:"center"}]}}},m=a(49723),A=a(95655),h=a(81288),I={components:{treeUnidadOrganizativa:m.A,sieModal:v.A,QCard:g.A,QCardSection:f.A,QPage:d.Tu},mixins:[w],data:function(){return{openModalUnidadOrganizativa:!1,isLogged:!1,buttonsCerrarLogin:[{label:"Cerrar Sesión",icon:"account_lock",click:this.cerrarSesionAdmin}],buttonsLogin:[{label:"Iniciar Sesión",icon:"vpn_key",click:this.login}]}},methods:{cerrarSesionAdmin:function(){var n=this;return u()(l()().m(function e(){var a,t,i;return l()().w(function(e){while(1)switch(e.p=e.n){case 0:return e.p=0,e.n=1,n.$http.post("api/HyoLoginGoogleAdmin/cerrarSesionAdmin");case 1:a=e.v,t=a.message,n.$notify(t,"success"),n.$router.push({name:"intranet.muro"}),n.isLogged=!1,e.n=3;break;case 2:e.p=2,i=e.v,n.$notify(i.message,"warning");case 3:return e.a(2)}},e,null,[[0,2]])}))()},selectUnidadOrganizativa:function(n){var e=this;return u()(l()().m(function a(){var t;return l()().w(function(a){while(1)switch(a.p=a.n){case 0:return t=n.orgUnitPath,a.p=1,a.n=2,e.$http.put("api/HyoSalones/updateSalonIdUnidadOrganizativa",{nemo:e.rowSalonSelected.NEMO,idUnidadOrganizativa:t});case 2:e.rowSalonSelected.ID_UNIDAD_ORGANIZATIVA=t,e.openModalUnidadOrganizativa=!1,a.n=4;break;case 3:a.p=3,a.v,e.$notify("No ha sido posible guardar la unidad organizativa","warning");case 4:return a.a(2)}},a,null,[[1,3]])}))()},readSalones:function(){var n=this;return u()(l()().m(function e(){var a,t;return l()().w(function(e){while(1)switch(e.n){case 0:return e.n=1,n.$http.post("api/HyoSalones/getSalones",{campos:["NEMO","ANO","NEMODES","ID_UNIDAD_ORGANIZATIVA"]});case 1:a=e.v,t=a.json,n.rowsSalon=(0,p["default"])(t);case 2:return e.a(2)}},e)}))()},login:function(){var n=this;return u()(l()().m(function e(){var a,t;return l()().w(function(e){while(1)switch(e.p=e.n){case 0:return e.p=0,delete window.localStorage._apiGoogle,n.isLogged=!1,e.n=1,n.$http.post("api/HyoLoginGoogleAdmin/login");case 1:a=e.v,"string"===typeof a?(0,A["default"])(a,"_system",500,500):n.isLogged=!0,e.n=3;break;case 2:e.p=2,t=e.v,console.log(t),n.$notify("Intentalo nuevamente.","warning");case 3:return e.a(2)}},e,null,[[0,2]])}))()}},created:function(){var n=this;return u()(l()().m(function e(){return l()().w(function(e){while(1)switch(e.n){case 0:return e.n=1,n.readSalones();case 1:return e.n=2,n.login();case 2:window.currentSieCloud=!1,(0,h.watchAuth2)(["_apiGoogle"],function(){var e=u()(l()().m(function e(a,t){var i,r,o,s;return l()().w(function(e){while(1)switch(e.p=e.n){case 0:o=t,e.n="_apiGoogle"===o?1:6;break;case 1:return n.$q.loading.show(),e.p=2,e.n=3,n.$http.post("api/HyoLoginGoogleAdmin/guardarCodigo",{codigo:a});case 3:i=e.v,n.isLogged=!0,n.$notify(i.message,"success"),e.n=5;break;case 4:e.p=4,s=e.v,r=s.error||{},n.$notify(r.msg||r.message||"No ha sido posible iniciar sesión.","warning");case 5:return n.$q.loading.hide(),e.a(3,6);case 6:return e.a(2)}},e,null,[[2,4]])}));return function(n,a){return e.apply(this,arguments)}}());case 3:return e.a(2)}},e)}))()},unmounted:function(){window.callback&&window.removeEventListener("storage",window.callback.cb)},beforeCreate:function(){window.callback&&window.removeEventListener("storage",window.callback.cb)}},b=a(12807);const O=(0,b.A)(I,[["render",o]]);var S=O}}]);