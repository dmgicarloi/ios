"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[92923],{92923:function(e,t,o){o.r(t),o.d(t,{default:function(){return rt}});var a=o(8445),n=o.n(a),r=(o(39866),o(61758)),l=o(29104),s={class:"row q-ma-xs q-col-gutter-sm"},i={class:"col-xs-12 col-lg-6"},c={class:"row q-ma-xs q-col-gutter-sm"},u={class:"col-xs-4"},d={class:"col-xs-8"},p={key:0,class:"col-xs-4"},f={key:1,class:"col-xs-4"},m={key:2,class:"col-xs-4"},v={class:"col-xs-4"},g={key:3,class:"col-xs-4"},h={key:4,class:"col-xs-4"},A={key:5,class:"col-xs-4"},b={class:"col-xs-4"},D={class:"col-xs-4"},C={class:"col-xs-4"},E={key:6,class:"col-xs-4"},w={key:7,class:"col-xs-4"},O={key:8,class:"col-xs-4"},I={class:"col-xs-12 col-lg-12"},k={class:"col-xs-12 col-lg-6"},N={class:"col-xs-12"},S={class:"row q-ma-xs q-col-gutter-sm"},P={class:"col-xs-12 col-sm-12 col-md-12 col-lg-12"},_={class:"row q-ma-xs q-col-gutter-sm"},M={class:"col-xs-6 col-lg-6"},V={class:"col-xs-6 col-lg-6"},R={class:"col-xs-12 col-sm-12 col-md-12 col-lg-12"},L={class:"row q-ma-xs q-col-gutter-sm"},y={class:"col-xs-12"},T={class:"col-auto"},U={class:"row q-ma-xs q-col-gutter-sm"},F={class:"col-auto"},x={class:"row q-ma-xs q-col-gutter-sm"},H={class:"row"},G={class:"col-12"};function q(e,t){var o=(0,r.g2)("pageHeader"),a=(0,r.g2)("q-separator"),q=(0,r.g2)("tesoreriaLoading"),Q=(0,r.g2)("q-select"),$=(0,r.g2)("q-date"),j=(0,r.g2)("q-popup-proxy"),B=(0,r.g2)("q-icon"),X=(0,r.g2)("q-input"),Y=(0,r.g2)("q-checkbox"),W=(0,r.g2)("q-chip-table"),K=(0,r.g2)("sie-grid"),z=(0,r.g2)("footer-grid"),J=(0,r.g2)("q-card-section"),Z=(0,r.g2)("q-option-group"),ee=(0,r.g2)("sie-modal"),te=(0,r.g2)("visorMensaje"),oe=(0,r.g2)("avisoAutomatico"),ae=(0,r.g2)("q-card");return(0,r.uX)(),(0,r.Wv)(ae,{class:"layout-v1 my-card",flat:"",bordered:""},{default:(0,r.k6)(function(){return[(0,r.bF)(o,{tabs:e.tabs,componente:e.pageHeader.componente,botones:e.pageHeader.botones,nivelAcceso:e.pageHeader.nivelAcceso,title:e.pageHeader.title,useTab:"",onActionTab:e.changeTab,cboTitle:e.pageHeader.cboTitle,dataCbo:e.optionsDeudas,onCboAction:e.changeOptions},null,8,["tabs","componente","botones","nivelAcceso","title","onActionTab","cboTitle","dataCbo","onCboAction"]),(0,r.bF)(a),(0,r.bF)(q,{modelValue:e.loading.showLoading,total:e.loading.total,procesados:e.loading.procesados,label:"Enviando"},null,8,["modelValue","total","procesados"]),(0,r.bo)((0,r.bF)(J,null,{default:(0,r.k6)(function(){return[(0,r.Lk)("div",s,[(0,r.Lk)("div",i,[(0,r.Lk)("div",c,[(0,r.Lk)("div",u,[(0,r.bF)(Q,{class:"truncate-label",label:"Perfil","option-label":"label","option-value":"value",options:e.perfiles,modelValue:e.selectPerfil,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.selectPerfil=t}),onInput:e.getPerPerfil},null,8,["options","modelValue","onInput"])]),(0,r.Lk)("div",d,[(0,r.bF)(Q,{class:"truncate-label",label:"Persona","option-label":"label","option-value":"value",options:e.personas,modelValue:e.selectPersona,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.selectPersona=t}),onInput:e.getDeudores},null,8,["options","modelValue","onInput"])]),e.selectPerfil===e.PERFIL_ALUMNO?((0,r.uX)(),(0,r.CE)("div",p,[(0,r.bF)(Q,{label:"Nivel",options:e.niveles,"option-label":"label","option-value":"value",modelValue:e.selectNivel,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.selectNivel=t}),onInput:e.getGrados},null,8,["options","modelValue","onInput"])])):(0,r.Q3)("v-if",!0),e.selectPerfil===e.PERFIL_ALUMNO?((0,r.uX)(),(0,r.CE)("div",f,[(0,r.bF)(Q,{label:"Grado","option-label":"label","option-value":"value",options:e.grados,modelValue:e.selectGrado,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.selectGrado=t}),onInput:e.getSecciones},null,8,["options","modelValue","onInput"])])):(0,r.Q3)("v-if",!0),e.selectPerfil===e.PERFIL_ALUMNO?((0,r.uX)(),(0,r.CE)("div",m,[(0,r.bF)(Q,{label:"Secciones","option-label":"label","option-value":"value",options:e.secciones,modelValue:e.selectSeccion,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.selectSeccion=t}),onInput:e.getDeudores},null,8,["options","modelValue","onInput"])])):(0,r.Q3)("v-if",!0),(0,r.Lk)("div",v,[(0,r.bF)(Q,{label:"Año",options:e.anios,"option-label":"label","option-value":"value",modelValue:e.selectAnio,"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.selectAnio=t}),onInput:e.getDeudores},null,8,["options","modelValue","onInput"])]),["0006","0026"].includes(e.selectOption)?((0,r.uX)(),(0,r.CE)("div",g,[(0,r.bF)(Q,{class:"truncate-label",placeholder:"Seleccion Filtrar Por",label:"Buscar por:",options:e.dataFiltrarPor,modelValue:e.selectFiltrarPor,"onUpdate:modelValue":t[6]||(t[6]=function(t){return e.selectFiltrarPor=t}),onInput:e.changeTipoFiltro,"option-label":"label","option-value":"value"},null,8,["options","modelValue","onInput"])])):(0,r.Q3)("v-if",!0),["0006","0026"].includes(e.selectOption)&&!e.filtroPorMes?((0,r.uX)(),(0,r.CE)("div",h,[(0,r.bF)(X,{"reverse-fill-mask":"",maxlength:"10",mask:"##/##/####",label:"Fecha Vencimiento",modelValue:e.selectDia,"onUpdate:modelValue":t[9]||(t[9]=function(t){return e.selectDia=t})},{append:(0,r.k6)(function(){return[(0,r.bF)(B,{class:"cursor-pointer",name:"date_range"},{default:(0,r.k6)(function(){return[(0,r.bF)(j,{ref:"qDateProxy1","transition-show":"scale","transition-hide":"scale"},{default:(0,r.k6)(function(){return[(0,r.bF)($,{mask:"DD/MM/YYYY",modelValue:e.selectDia,"onUpdate:modelValue":t[7]||(t[7]=function(t){return e.selectDia=t}),onInput:t[8]||(t[8]=function(t){return e.closeModalCalendar("qDateProxy1")})},null,8,["modelValue"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])])):(0,r.Q3)("v-if",!0),e.filtroPorMes?((0,r.uX)(),(0,r.CE)("div",A,[(0,r.bF)(Q,{placeholder:"seleccione mes",label:"Mes",options:e.dataMeses,modelValue:e.seleccionarMes,"onUpdate:modelValue":t[10]||(t[10]=function(t){return e.seleccionarMes=t}),onInput:e.getDeudores},null,8,["options","modelValue","onInput"])])):(0,r.Q3)("v-if",!0),(0,r.Lk)("div",b,[(0,r.bF)(Q,{class:"truncate-label",label:"Estado Persona",modelValue:e.selectEstadoPersona,"onUpdate:modelValue":t[11]||(t[11]=function(t){return e.selectEstadoPersona=t}),options:e.estadosPersona,onInput:e.getDeudores},null,8,["modelValue","options","onInput"])]),(0,r.Lk)("div",D,[(0,r.bF)(Q,{options:e.optionsOrden,modelValue:e.selectOrden,"onUpdate:modelValue":t[12]||(t[12]=function(t){return e.selectOrden=t}),label:"Filtrar Por:",onInput:e.getDeudores},null,8,["options","modelValue","onInput"])]),(0,r.Lk)("div",C,[(0,r.bF)(Q,{options:e.optionsDestino,modelValue:e.selectDestino,"onUpdate:modelValue":t[13]||(t[13]=function(t){return e.selectDestino=t}),label:"Enviar a:"},null,8,["options","modelValue"])]),e.P_COBRO_SEDE?((0,r.uX)(),(0,r.CE)("div",E,[(0,r.bF)(Q,{options:e.optionLocales,modelValue:e.selectLocal,"onUpdate:modelValue":t[14]||(t[14]=function(t){return e.selectLocal=t}),label:"Local:",onInput:e.getDeudores},null,8,["options","modelValue","onInput"])])):(0,r.Q3)("v-if",!0),e.filtroPorMes?(0,r.Q3)("v-if",!0):((0,r.uX)(),(0,r.CE)("div",w,[(0,r.bF)(Y,{modelValue:e.ckbNumMes,"onUpdate:modelValue":t[15]||(t[15]=function(t){return e.ckbNumMes=t}),label:"Nro. Deudas",onInput:e.getDeudores},null,8,["modelValue","onInput"])])),e.ckbNumMes&&!e.filtroPorMes?((0,r.uX)(),(0,r.CE)("div",O,[(0,r.bF)(X,{label:"Cantidad Deudas",modelValue:e.nroDeudas,"onUpdate:modelValue":t[16]||(t[16]=function(t){return e.nroDeudas=t}),type:"number",onInput:e.getDeudores},null,8,["modelValue","onInput"])])):(0,r.Q3)("v-if",!0),(0,r.Lk)("div",I,[(0,r.bF)(W,{items:e.dataConceptos,title:"Conceptos de Cobro",modelValue:e.conceptosSelect,"onUpdate:modelValue":t[17]||(t[17]=function(t){return e.conceptosSelect=t}),onInput:e.obtenerConceptos,textValue:"Código",textLabel:"Concepto"},null,8,["items","modelValue","onInput"])])])]),(0,r.Lk)("div",k,[(0,r.bo)((0,r.bF)(J,null,{default:(0,r.k6)(function(){return[(0,r.Lk)("div",N,[(0,r.bF)(K,{class:"ag-theme-balham",frameworkComponents:e.frameworkComponents,columnDefs:e.columnDefs,rowData:e.rowData,rowSelection:"multiple",onRowSelected:e.rowSelected,onGridReady:e.onGridReady,style:{width:"100%",height:"calc(100vh - 300px)"},defaultColDef:e.defaultColDef,enableCellTextSelection:""},null,8,["frameworkComponents","columnDefs","rowData","onRowSelected","onGridReady","defaultColDef"]),(0,r.bF)(z,{modelValue:e.pagina,"onUpdate:modelValue":t[18]||(t[18]=function(t){return e.pagina=t}),max:e.pages,onLoad:e.getDeudores,rows:e.rowData,contador:e.totalSeleccionados,showContador:""},null,8,["modelValue","max","onLoad","rows","contador"])])]}),_:1},512),[[l.aG,e.tabskey.enviar===e.tabActive]])])])]}),_:1},512),[[l.aG,e.tabskey.enviar===e.tabActive]]),e.tabskey.reporte===e.tabActive?((0,r.uX)(),(0,r.Wv)(J,{key:0},{default:(0,r.k6)(function(){return[(0,r.Lk)("div",S,[(0,r.Lk)("div",P,[(0,r.Lk)("div",_,[(0,r.Lk)("div",M,[(0,r.bF)(Q,{placeholder:"Seleccionar Año",label:"Año",options:e.anios,modelValue:e.filtroHistorial.anio,"onUpdate:modelValue":t[19]||(t[19]=function(t){return e.filtroHistorial.anio=t}),onInput:e.getHistorialCorreos},null,8,["options","modelValue","onInput"])]),(0,r.Lk)("div",V,[(0,r.bF)(Q,{placeholder:"Seleccione Mes",label:"Mes",options:e.meses,modelValue:e.filtroHistorial.mes,"onUpdate:modelValue":t[20]||(t[20]=function(t){return e.filtroHistorial.mes=t}),onInput:e.getHistorialCorreos},null,8,["options","modelValue","onInput"])])])]),(0,r.Lk)("div",R,[(0,r.Lk)("div",L,[(0,r.Lk)("div",y,[(0,r.bF)(K,{class:"fix-tab-height ag-theme-balham",onGridReady:e.onGridReadyHistorial,style:{height:"calc(100vh - 320px)"},columnDefs:e.gridHistorial.columnDefs,rowData:e.gridHistorial.rowData,frameworkComponents:e.gridHistorial.frameworkComponents,defaultColDef:e.gridHistorial.defaultColDef,floatingFilter:"",enableCellTextSelection:""},null,8,["onGridReady","columnDefs","rowData","frameworkComponents","defaultColDef"]),(0,r.bF)(z,{modelValue:e.gridHistorial.pagina,"onUpdate:modelValue":t[21]||(t[21]=function(t){return e.gridHistorial.pagina=t}),max:e.gridHistorial.pages,onLoad:e.getHistorialCorreos,rows:e.gridHistorial.rowData},null,8,["modelValue","max","onLoad","rows"])])])])])]}),_:1})):(0,r.Q3)("v-if",!0),t[32]||(t[32]=(0,r.Lk)("form",{class:"form",id:"form"},null,-1)),(0,r.bF)(ee,{modelValue:e.openModalTipoReporte,"onUpdate:modelValue":t[24]||(t[24]=function(t){return e.openModalTipoReporte=t}),onSubmit:e.generarReporteAlertas,labelButtonOk:"Aceptar"},{default:(0,r.k6)(function(){return[(0,r.bF)(J,null,{default:(0,r.k6)(function(){return n()(t[28]||(t[28]=[(0,r.Lk)("div",{class:"row q-ma-xs q-col-gutter-sm"},[(0,r.Lk)("div",{class:"text-h7"},"Reporte de Alertas:")],-1)]))}),_:1}),(0,r.bF)(a),(0,r.bF)(J,null,{default:(0,r.k6)(function(){return[t[29]||(t[29]=(0,r.Lk)("div",{class:"row items-center no-wrap"},[(0,r.Lk)("div",{class:"col"},[(0,r.Lk)("div",{class:"text-h4",style:{"text-align":"center","font-weight":"bolder"}},"Orden")])],-1)),(0,r.Lk)("div",T,[(0,r.Lk)("div",U,[(0,r.bF)(Z,{color:"primary",type:"radio",modelValue:e.formReporte.seleccionOrden,"onUpdate:modelValue":t[22]||(t[22]=function(t){return e.formReporte.seleccionOrden=t}),options:e.formReporte.orden},null,8,["modelValue","options"])])])]}),_:1}),(0,r.bF)(J,null,{default:(0,r.k6)(function(){return[t[30]||(t[30]=(0,r.Lk)("div",{class:"row items-center no-wrap"},[(0,r.Lk)("div",{class:"col"},[(0,r.Lk)("div",{class:"text-h4",style:{"text-align":"center","font-weight":"bolder"}},"Formato")])],-1)),(0,r.Lk)("div",F,[(0,r.Lk)("div",x,[(0,r.bF)(Z,{class:"q-pa-none",inline:"",color:"primary",type:"radio",modelValue:e.formReporte.formato,"onUpdate:modelValue":t[23]||(t[23]=function(t){return e.formReporte.formato=t}),options:e.formReporte.botonesReportes},null,8,["modelValue","options"])])])]}),_:1})]}),_:1},8,["modelValue","onSubmit"]),(0,r.bo)((0,r.bF)(te,{ref:e.tabskey.mensaje,codigo:e.codigo,componente:e.componente,tab:!0},null,8,["codigo","componente"]),[[l.aG,e.tabskey.mensaje===e.tabActive]]),e.P_ENVIAR_ALERTA_AUTO?(0,r.bo)(((0,r.uX)(),(0,r.Wv)(oe,{key:1,ref:e.tabskey.automatico,codigo:e.codigo},null,8,["codigo"])),[[l.aG,e.tabskey.automatico===e.tabActive]]):(0,r.Q3)("v-if",!0),(0,r.bF)(ee,{modelValue:e.modalCambiar,"onUpdate:modelValue":t[26]||(t[26]=function(t){return e.modalCambiar=t}),onSubmit:e.changeOptions,labelButtonOk:"cambiar",iconButtonOk:"sync"},{default:(0,r.k6)(function(){return[(0,r.bF)(J,null,{default:(0,r.k6)(function(){return n()(t[31]||(t[31]=[(0,r.Lk)("div",{class:"row item-center no-wrap"},[(0,r.Lk)("div",{class:"col"},[(0,r.Lk)("div",{class:"text-h6"},"Tipos de Alertas")])],-1)]))}),_:1}),(0,r.bF)(J,null,{default:(0,r.k6)(function(){return[(0,r.Lk)("div",H,[(0,r.Lk)("div",G,[(0,r.bF)(Z,{options:e.optionsDeudas,modelValue:e.selectOption,"onUpdate:modelValue":t[25]||(t[25]=function(t){return e.selectOption=t}),type:"radio"},null,8,["options","modelValue"])])])]}),_:1})]}),_:1},8,["modelValue","onSubmit"]),(0,r.bF)(ee,{modelValue:e.modalHistory,"onUpdate:modelValue":t[27]||(t[27]=function(t){return e.modalHistory=t}),showButtons:!1},null,8,["modelValue"])]}),_:1})}var Q=o(41562),$=o.n(Q),j=o(99550),B=o.n(j),X=o(76080),Y=o.n(X),W=o(45254),K=o.n(W),z=(o(34634),o(30683),o(52133),o(10239),o(50310),o(6724),o(11777),o(83190),o(88390),o(62692),o(88567)),J=o(95718),Z=o(53380),ee=o(54489),te=o(64208),oe=o(3112),ae=o(12143),ne=o(95477),re=o(80660),le=o(6123),se=o(62006),ie=o(36408),ce=o(27560),ue=o(75053),de=o(41615),pe=o(33950),fe=o(59089),me=o(95051),ve=o(6083),ge=o(54267),he=o(57668),Ae=o(17915),be=o(64303),De=o(37804),Ce=o(2652),Ee=o(71818),we={class:"row q-ma-xs q-col-gutter-sm"},Oe={class:"col-xs-12 col-lg-6"},Ie={class:"row q-ma-xs q-col-gutter-sm"},ke={class:"col-xs-12 col-lg-6"},Ne={class:"col-xs-12 col-lg-6"},Se={key:0,class:"col-xs-12 col-lg-12"},Pe={class:"row q-ma-xs q-col-gutter-sm"},_e={class:"col-xs-6 col-lg-6"},Me={class:"col-xs-6 col-lg-6"},Ve={class:"col-xs-12 col-lg-12"},Re={class:"row q-ma-xs q-col-gutter-sm"},Le={class:"col-xs-6 col-md-6 col-lg-6"},ye={key:0,class:"col-xs-3 col-md-6 col-lg-3"},Te={key:1,class:"col-xs-9 col-md-6 col-lg-3"},Ue={class:"col-xs-12 col-lg-12"},Fe={class:"col-xs-12 col-lg-6"};function xe(e,t){var o=(0,r.g2)("q-select"),a=(0,r.g2)("q-checkbox"),n=(0,r.g2)("q-option-group"),s=(0,r.g2)("q-input"),i=(0,r.g2)("q-chip-table"),c=(0,r.g2)("dayPicker"),u=(0,r.g2)("q-card-section");return(0,r.uX)(),(0,r.Wv)(u,null,{default:(0,r.k6)(function(){return[(0,r.Lk)("div",we,[(0,r.Lk)("div",Oe,[(0,r.Lk)("div",Ie,[(0,r.Lk)("div",ke,[(0,r.bF)(o,{label:"Perfil","option-label":"label","option-value":"value",options:e.perfiles,modelValue:e.selectPerfil,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.selectPerfil=t})},null,8,["options","modelValue"])]),(0,r.Lk)("div",Ne,[(0,r.bF)(a,{label:"Activar envío automático",modelValue:e.activo,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.activo=t}),"true-value":1,"false-value":0},null,8,["modelValue"])]),e.selectPerfil===e.PERFIL_ALUMNO?((0,r.uX)(),(0,r.CE)("div",Se,[(0,r.Lk)("div",Pe,[(0,r.Lk)("div",_e,[(0,r.bF)(o,{label:"Nivel",options:e.niveles,"option-label":"label","option-value":"value",modelValue:e.selectNivel,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.selectNivel=t}),onInput:e.getGrados},null,8,["options","modelValue","onInput"])]),(0,r.Lk)("div",Me,[(0,r.bF)(o,{label:"Grado","option-label":"label","option-value":"value",options:e.grados,modelValue:e.selectGrado,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.selectGrado=t}),onInput:e.getSecciones},null,8,["options","modelValue","onInput"])])])])):(0,r.Q3)("v-if",!0),(0,r.Lk)("div",Ve,[(0,r.Lk)("div",Re,[(0,r.Lk)("div",Le,[(0,r.bF)(n,{modelValue:e.selectAnio,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.selectAnio=t}),options:e.optionsAnios},null,8,["modelValue","options"])]),e.codigo===e.DEUDA?((0,r.uX)(),(0,r.CE)("div",ye,[(0,r.bF)(a,{modelValue:e.ckbNumMes,"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.ckbNumMes=t}),label:"Nro. Deudas"},null,8,["modelValue"])])):(0,r.Q3)("v-if",!0),e.ckbNumMes&&e.codigo===e.DEUDA?((0,r.uX)(),(0,r.CE)("div",Te,[(0,r.bF)(s,{label:"Cantidad Deudas",modelValue:e.nroDeudas,"onUpdate:modelValue":t[6]||(t[6]=function(t){return e.nroDeudas=t}),type:"number",onKeyup:(0,l.jR)(e.getDeudores,["enter"])},null,8,["modelValue","onKeyup"])])):(0,r.Q3)("v-if",!0)])]),(0,r.Lk)("div",Ue,[(0,r.bF)(i,{modelValue:e.conceptos,"onUpdate:modelValue":t[7]||(t[7]=function(t){return e.conceptos=t}),items:e.dataConceptos,title:"Conceptos de Cobro",textValue:"Código",textLabel:"Concepto"},null,8,["modelValue","items"])])])]),(0,r.Lk)("div",Fe,[(0,r.bF)(c,{ref:"picker",modelValue:e.days,"onUpdate:modelValue":t[8]||(t[8]=function(t){return e.days=t})},null,8,["modelValue"])])])]}),_:1})}o(12563),o(85472),o(45467),o(515),o(7346);var He=o(4437),Ge=o(58790),qe=["data-day"],Qe=["data-day"],$e={class:"item-day-grid"},je=["data-day"],Be=["data-day"];function Xe(e,t){var o=(0,r.g2)("q-tooltip"),a=(0,r.g2)("q-card");return(0,r.uX)(),(0,r.Wv)(a,{class:"q-card-legend",title:"Seleccionar Dias"},{default:(0,r.k6)(function(){return[(0,r.Lk)("div",{class:"grid-day-picker",onClick:t[0]||(t[0]=function(){return e.selectItemDay&&e.selectItemDay.apply(e,arguments)})},[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.arrayDays,function(e){return(0,r.uX)(),(0,r.CE)("div",{key:e,class:"item-day-grid"},[(0,r.Lk)("div",{class:"day","data-day":e},[(0,r.Lk)("span",{"data-day":e},(0,Ge.v_)(e),9,Qe)],8,qe)])}),128)),(0,r.Lk)("div",$e,[(0,r.Lk)("div",{class:"day","data-day":e.ultimoDia},[(0,r.Lk)("span",{"data-day":e.ultimoDia},[(0,r.eW)((0,Ge.v_)(e.ultimoDia),1),(0,r.bF)(o,{delay:100,offset:[0,10]},{default:(0,r.k6)(function(){return n()(t[1]||(t[1]=[(0,r.eW)("Ultimo día del mes",-1)]))}),_:1})],8,Be)],8,je)])])]}),_:1})}o(71225),o(71587),o(5962),o(66307);var Ye={emits:["update:modelValue","input"],components:{QCard:z.A,QCardSection:J.A,sieModal:ue.A,QSeparator:Z.A,QSelect:ee.A,QInput:te.A,QCheckbox:oe.A,QTooltip:le.nC},computed:{openModalEmit:{set:function(e){this.$emit("update:modelValue",e),this.$emit("input",e)},get:function(){return this.modelValue}}},props:{modelValue:{type:Array,default:function(){return[]}},selectDays:{type:Array,default:function(){return[]}}},watch:{modelValue:function(e,t){var o=this;return K()(Y()().m(function e(){var a,n,r,l;return Y()().w(function(e){while(1)switch(e.n){case 0:a=o.modelValue.filter(function(e){return!t.includes(e)}),n=$()(a);try{for(n.s();!(r=n.n()).done;)l=r.value,o.setDay(l,!1)}catch(e){n.e(e)}finally{n.f()}case 1:return e.a(2)}},e)}))()}},data:function(){return{isChecked:!1,arrayDays:Array.from({length:28},function(e,t){return t+1}),days:[],ultimoDia:"UD",count:0,copyValue:[]}},methods:{reset:function(){var e,t=$()(this.arrayDays);try{for(t.s();!(e=t.n()).done;){var o=e.value,a=document.querySelector('div[data-day="'.concat(o,'"]'));a.classList.remove("day-active")}}catch(e){t.e(e)}finally{t.f()}var n=document.querySelector('div[data-day="UD"]');n.classList.remove("day-active"),this.days=[],this.count=0,this.$emit("update:modelValue",[]),this.$emit("input",[])},setDay:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=document.querySelector('div[data-day="'.concat(e,'"]'));if(!o)return!1;var a=o.classList.toggle("day-active");return a?(this.days.includes(e)||this.days.push(e),t&&(this.$emit("update:modelValue",this.days),this.$emit("input",this.days)),!0):(this.days=this.days.filter(function(t){return String(t)!==String(e)}),t&&(this.$emit("update:modelValue",this.days),this.$emit("input",this.days)),!0)},selectItemDay:function(e){if(!e.target.closest(".grid-day-picker"))return!1;var t=e.target.dataset.day,o=document.querySelector('div[data-day="'.concat(t,'"]'));if(!o)return!1;this.setDay(t,!0),0==this.count&&(this.setDay(t,!1),this.count=1)}}},We=o(12807);const Ke=(0,We.A)(Ye,[["render",Xe]]);var ze=Ke,Je={components:{QDate:ae.A,QPopupProxy:ne.A,QCard:z.A,QCardSection:J.A,QSelect:ee.A,QOptionGroup:le.EX,QSeparator:Z.A,sieGrid:ie.A,QInput:te.A,footerGrid:ce.A,sieModal:ue.A,QCheckbox:oe.A,Upload:pe["default"],sieUpload:fe.A,QDownloadFile:se.A,QChip:me.A,sieEditor:ve.A,tesoreriaLoading:Ae.A,crearBotones:be.A,QChipTable:De.A,pageHeader:Ce.A,visorMensaje:Ee["default"],QDate1:He.A,dayPicker:ze},props:{codigo:{type:[String],require:!0}},data:function(){return{nivelAcceso:(0,he["default"])().ruta.nivel,componente:"envioAutomatico",PERFIL_ALUMNO:de["default"].PERFIL_ALUMNO,selectPerfil:de["default"].PERFIL_ALUMNO,selectAnio:de["default"].CURRENT_YEAR,selectDia:de["default"].CURRENT_DAY,selectNivel:de["default"].TODOS,selectGrado:de["default"].TODOS,selectSeccion:de["default"].TODOS,ckbNumMes:!1,perfiles:[],anios:[],niveles:[],grados:[],secciones:[],nroDeudas:0,personas:[],filtroPorMes:!1,dataMeses:(0,ge.generarMeses)(),seleccionarMes:de["default"].CURRENT_MONTH,optionsDeudas:[{label:"Deudas Vencidas",value:1},{label:"Aviso de Deudas",value:2}],DEUDAS_VENCIDAS:1,AVISO_DEUDAS:2,selectOption:1,botones:[],AVISO_DEUDA:de["default"].TIPO_ALERTA.AVISO_DEUDA,DEUDA:de["default"].TIPO_ALERTA.DEUDA,dataConceptos:[],days:[],controller:"api/MsgAlertAutomatiController",flat:"I",keysFlats:{update:"U",insert:"P"},conceptos:[],modalConceptos:!0,frameworkComponentsModal:{},ID_ALERT_AUTOMATI:null,beforeCodigo:null,activo:0,optionsAnios:[{label:"Deudas Año Actual",value:String(de["default"].CURRENT_YEAR)},{label:"Todas las deudas",value:"T"}],configMensaje:!1,titleMensaje:"",titulos:{"0006":"Deudas Vencidas","0009":"Aviso de Deudas"}}},methods:{obtenerDatosTab:function(){var e=this;return K()(Y()().m(function t(){return Y()().w(function(t){while(1)switch(t.n){case 0:if(e.beforeCodigo===e.codigo){t.n=1;break}return e.beforeCodigo=e.codigo,e.$refs.picker.reset(),t.n=1,e.init();case 1:return t.a(2,{botones:e.configMensaje?[{icon:"save",click:e.guardar,label:"Guardar",minAcceso:de["default"].LECTURA_ESCRITURA}]:[],title:"Configuración: ".concat(e.titulos[e.codigo]||"Alerta Autómatica"),minAcceso:(0,he["default"])().ruta.nivel,componente:"envioAutomatico"})}},t)}))()},getConfiguracionAutomatica:function(){var e=this;return K()(Y()().m(function t(){var o;return Y()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,re.$http.get("".concat(e.controller,"/getMsgAlertAutomati"),{params:{parametros:{msgcod:e.codigo}}});case 1:if(o=t.v,0!==Object.keys(o.data).length){t.n=2;break}return e.flat=e.keysFlats.insert,e.selectPerfil=de["default"].PERFIL_ALUMNO,e.selectAnio=de["default"].TOKEN_YEAR,e.selectNivel=de["default"].TODOS,e.selectGrado=de["default"].TODOS,e.conceptos=[],e.days=[],t.a(2,!0);case 2:e.setConfiguracion(o.data),e.flat=e.keysFlats.update;case 3:return t.a(2)}},t)}))()},setConfiguracion:function(e){this.days=JSON.parse(e.DIAS);var t=JSON.parse(e.PARAMETROS);this.selectPerfil=t.perfil,this.selectAnio=t.anio?String(t.anio):"",this.selectPerfil===de["default"].PERFIL_ALUMNO&&(this.selectGrado=t.grado,this.selectNivel=t.nivel),this.codigo===this.DEUDA&&Object.prototype.hasOwnProperty.call(t,"ckbNumMes")&&(this.ckbNumMes=Boolean(Number(t.ckbNumMes)),this.nroDeudas=t.nroDeudas||0),this.activo=Number(e.ACTIVO),this.ID_ALERT_AUTOMATI=e.ID_ALERT_AUTOMATI,this.conceptos=[];var o,a=$()(e.conceptos);try{for(a.s();!(o=a.n()).done;){var n=o.value;this.conceptos.push({value:n.CONCOB,label:n.CONDES})}}catch(e){a.e(e)}finally{a.f()}},validateSaveConfing:function(){try{if(!this.selectPerfil)throw new Error("Debe seleccionar el perfil");if(this.selectPerfil===de["default"].PERFIL_ALUMNO&&!this.selectNivel)throw new Error("Debe seleccionar el nivel");if(this.selectPerfil===de["default"].PERFIL_ALUMNO&&!this.selectGrado)throw new Error("Debe seleccionar el grado");if(!this.selectAnio)throw new Error("Debe seleccionar el grado");if(this.DEUDA===this.codigo&&this.ckbNumMes&&(!this.nroDeudas||0==this.nroDeudas))throw new Error("No ingreso el numero de deudas");if(this.AVISO_DEUDA===this.codigo&&!this.seleccionarMes)throw new Error("Debe seleccionar el mes");if(!this.conceptos||0===this.conceptos.length)throw new Error("No selecciono ningun concepto");if(!this.days||0===this.days.length)throw new Error("No selecciono ningún dia");return!0}catch(e){throw new Error(e.error?e.error.message:e.message,"warning")}},guardar:function(){var e=this;try{this.validateSaveConfing();var t=this.flat===this.keysFlats.update,o=t?"updateMsgAlertAutomati":"addMsgAlertAutomati";this.$confirm("¿Esta seguro de guardar la configuración?").onOk(K()(Y()().m(function a(){var n,r,l;return Y()().w(function(a){while(1)switch(a.p=a.n){case 0:return a.p=0,n={dias:e.days,conceptos:e.conceptos.map(function(e){return e.value}),perfil:e.selectPerfil,anio:e.selectAnio,nivel:e.selectNivel,grado:e.selectGrado,msgcod:e.codigo,ckbNumMes:Number(e.ckbNumMes),nroDeudas:e.nroDeudas,activo:e.activo},t&&(n.ID_ALERT_AUTOMATI=e.ID_ALERT_AUTOMATI),a.n=1,re.$http.post("".concat(e.controller,"/").concat(o),{data:n});case 1:return r=a.v,a.n=2,e.getConfiguracionAutomatica();case 2:return a.a(2,e.$alert(r.message,"success"));case 3:return a.p=3,l=a.v,a.a(2,e.$alert(l.error?l.error.message:l.message,"warning"))}},a,null,[[0,3]])})))}catch(e){return this.$alert(e.error?e.error.message:e.message,"warning")}},onGridReady:function(e){this.api=e.api},getConceptos:function(){var e=this;return K()(Y()().m(function t(){var o;return Y()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,de["default"].API_CONCEPTOS({render:"grid"});case 1:o=t.v,e.dataConceptos=o;case 2:return t.a(2)}},t)}))()},getPerfiles:function(){var e=this;return K()(Y()().m(function t(){return Y()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,de["default"].API_PERFILES();case 1:e.perfiles=t.v;case 2:return t.a(2)}},t)}))()},getAnios:function(){var e=this;return K()(Y()().m(function t(){return Y()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,de["default"].API_ANIOS();case 1:e.anios=t.v,e.anios.unshift({label:"Todos",value:"%"});case 2:return t.a(2)}},t)}))()},getNiveles:function(){var e=this;return K()(Y()().m(function t(){return Y()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,de["default"].API_NIVELES();case 1:e.niveles=t.v;case 2:return t.a(2)}},t)}))()},getGrados:function(){var e=this;return K()(Y()().m(function t(){return Y()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,de["default"].API_GRADOS(e.selectNivel);case 1:e.grados=t.v;case 2:return t.a(2)}},t)}))()},getSecciones:function(){var e=this;return K()(Y()().m(function t(){return Y()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,de["default"].API_SECCIONES(e.selectGrado,e.selectNivel);case 1:e.secciones=t.v;case 2:return t.a(2)}},t)}))()},closeModalCalendar:function(e){this.$refs[e].hide()},init:function(){var e=this;return K()(Y()().m(function t(){var o,a,n;return Y()().w(function(t){while(1)switch(t.n){case 0:return console.log(e.codigo),t.n=1,re.$http.get("api/EnvioAlertaController/getMensajeAlerta",{params:{params:{MSGCOD:e.codigo}}});case 1:return o=t.v,e.configMensaje=o.length>0,e.configMensaje||e.$alert("La alerta no tiene un mensaje configurado<br>Puede configurarlo en la pestaña mensaje","warning",!0),e.configMensaje&&(a=B()(o,1),n=a[0],e.titleMensaje=n.TIPO),t.n=2,e.getConfiguracionAutomatica();case 2:e.getConceptos(),e.getPerfiles(),e.getAnios(),e.getNiveles(),e.getGrados();case 3:return t.a(2)}},t)}))()}},beforeMount:function(){var e=this;return K()(Y()().m(function t(){return Y()().w(function(t){while(1)switch(t.n){case 0:e.beforeCodigo=e.codigo,e.init();case 1:return t.a(2)}},t)}))()}};const Ze=(0,We.A)(Je,[["render",xe]]);var et=Ze,tt=o(78840),ot=o(18105),at={components:{QDate:ae.A,QPopupProxy:ne.A,QCard:z.A,QCardSection:J.A,QSelect:ee.S,QOptionGroup:le.EX,QSeparator:Z.A,sieGrid:ie.A,QInput:te.A,footerGrid:ce.A,sieModal:ue.A,QCheckbox:oe.A,Upload:pe["default"],sieUpload:fe.A,QDownloadFile:se.A,QChip:me.A,sieEditor:ve.A,tesoreriaLoading:Ae.A,crearBotones:be.A,pageHeader:Ce.A,visorMensaje:Ee["default"],avisoAutomatico:et,QChipTable:De.A,QIcon:le.bP},data:function(){return{LECTURA_ESCRITURA:de["default"].LECTURA_ESCRITURA,nivelAcceso:(0,he["default"])().ruta.nivel,openModal:!0,openModalConfigMsg:!1,modalConceptos:!1,title:"Envío de Alertas de:",componente:"envioAlertas",api:"",rowData:null,columnDefs:null,frameworkComponents:{},PERFIL_ALUMNO:de["default"].PERFIL_ALUMNO,selectPerfil:de["default"].PERFIL_ALUMNO,selectAnio:String(de["default"].CURRENT_YEAR),selectDia:de["default"].CURRENT_DAY,selectNivel:de["default"].TODOS,selectGrado:de["default"].TODOS,selectSeccion:de["default"].TODOS,selectPersona:de["default"].TODOS,selectLocal:de["default"].TODOS,selectEstadoPersona:"1",conceptosSelect:[],Conceptos:[],dataConceptos:[],formRemoveConceptos:{},ckbEnviarIntranet:!0,ckbNumMes:!1,selectDestino:1,perfiles:[],anios:[],niveles:[],grados:[],secciones:[],pagina:1,pages:1,nroDeudas:0,personas:[],formReporte:{id_pefil:"",estado:"T",repcod:"PER_FAC",formato:"pdf",botonesReportes:[{label:"PDF",value:"pdf"},{label:"EXCEL",value:"xlsx"}],orden:[{label:"Alafabético",value:"A"},{label:"Nivel y Grado",value:"N"},{label:"Código",value:"C"}],seleccionOrden:"A"},mensaje:"",correoRemitente:"",asunto:"",statusBar:null,paramsEnvio:null,correoEnviado:!1,openModalTipoReporte:!1,tipoMensaje:3,loading:{showLoading:!1,procesados:0,total:0},filtroPorMes:!1,optionLocales:[],dataMeses:(0,ge.generarMeses)(),seleccionarMes:de["default"].CURRENT_MONTH,optionsDeudas:[{label:"Deudas Vencidas",value:de["default"].TIPO_ALERTA.DEUDA},{label:"Aviso de Deudas",value:de["default"].TIPO_ALERTA.AVISO_DEUDA}],optionsDestino:[{label:"Responsable Pago",value:1},{label:"Padre/Madre",value:2}],DEUDAS_VENCIDAS:de["default"].TIPO_ALERTA.DEUDA,AVISO_DEUDAS:de["default"].TIPO_ALERTA.AVISO_DEUDA,AVISO_DEUDAS_PERIODO:"0026",selectOption:"0006",defaultColDef:{sortable:!0},botones:[],columnsConceptos:[{headerName:"Código",field:"value",width:70},{headerName:"Concepto",field:"label",width:320}],optionsOrden:[{label:"Alfabético",value:3},{label:"NGS",value:1},{label:"Código",value:2}],selectOrden:3,tabs:[{label:"Envio",name:"tabIndex"},{label:"Mensaje",name:"tabMensaje"}],dataFiltrarPor:[{value:"F",label:"Fecha Vencimiento"},{value:"M",label:"Meses"}],selectFiltrarPor:"F",tabskey:{enviar:"tabIndex",mensaje:"tabMensaje",automatico:"tabAutomatico",reporte:"reporte"},pageHeader:{componente:"envioAlertaDeudores",nivelAcceso:(0,he["default"])().ruta.nivel,botones:this.botones,title:"Envío de Alertas de",cboTitle:!0},tabActive:"tabIndex",AVISO_DEUDA:de["default"].TIPO_ALERTA.AVISO_DEUDA,DEUDA:de["default"].TIPO_ALERTA.DEUDA,codigo:this.AVISO_DEUDA,procesando:!1,P_ENVIAR_ALERTA_AUTO:!1,P_COBRO_SEDE:!1,modalCambiar:!0,gridHistorial:{frameworkComponents:{actionButton:tt.A},rowData:[],columnDefs:[],api:null,params:null,defaultColDef:{suppressHeaderMenuButton:!0,filter:!0,floatingFilterComponentParams:{suppressFilterButton:!0},resizable:!0,sortable:!0,suppressDragLeaveHidesColumns:!0},pagina:1,pages:1},modalHistory:!1,meses:[],filtroHistorial:{mes:de["default"].CURRENT_MONTH,anio:String(de["default"].CURRENT_YEAR)},estadosPersona:de["default"].ESTADO_PERSONA,mensajeConfigurado:!1,totalSeleccionados:0}},methods:{changeTab:function(e){var t=this;return K()(Y()().m(function o(){var a;return Y()().w(function(o){while(1)switch(o.n){case 0:if(t.tabActive=e,"tabIndex"!==t.tabActive){o.n=1;break}return t.pageHeader.title=t.title,t.pageHeader.botones=t.botones,t.pageHeader.componente="envioAlertaDeudores",t.pageHeader.nivelAcceso=(0,he["default"])().ruta.nivel,t.pageHeader.cboTitle=!0,o.a(2,!0);case 1:if(t.pageHeader.cboTitle=!1,"reporte"!==e){o.n=2;break}return t.pageHeader.title="Historial de envíos",t.pageHeader.botones=[],t.pageHeader.componente="envioAlertaDeudores",t.pageHeader.nivelAcceso=(0,he["default"])().ruta.nivel,o.a(2,!0);case 2:return o.n=3,t.$refs[e].obtenerDatosTab();case 3:a=o.v,t.pageHeader.botones=a.botones,t.pageHeader.componente=a.componente,t.pageHeader.nivelAcceso=a.minAcceso,t.pageHeader.title=a.title;case 4:return o.a(2)}},o)}))()},obtenerConceptos:function(e){this.getDeudores()},openMdalCambiar:function(){this.modalCambiar=!0},crearBotones:function(){var e=this;return K()(Y()().m(function t(){var o;return Y()().w(function(t){while(1)switch(t.n){case 0:return o=[],o.push({icon:"send",click:e.enviarCorreo,label:"Enviar",minAcceso:e.LECTURA_ESCRITURA}),e.pageHeader.botones=o,e.botones=o,t.a(2,o)}},t)}))()},getNameCole:function(){var e=(0,he["default"])().url,t=e.split("."),o=t.at(0).split("//");return o.at(-1)},descargarListaNegra:function(){var e='{"name":"logCorreos.txt","ruta":"archivos/'.concat(this.getNameCole(),'/lista_negra_correos.txt","tipo":"xlsx"}');de["default"].DESCARGAR_ARCHIVO(e),this.$alert("Archivo Excportado Satisfactoriamente","success")},descargarLogCorreo:function(){var e='{"name":"logCorreos.txt","ruta":"archivos/'.concat(this.getNameCole(),'/logCorreos.txt","tipo":"xlsx"}');de["default"].DESCARGAR_ARCHIVO(e),this.$alert("Archivo Excportado Satisfactoriamente","success")},changeOptions:function(e){var t=this;return K()(Y()().m(function o(){return Y()().w(function(o){while(1)switch(o.n){case 0:e&&(t.selectOption=e),t.modalCambiar=!1,t.filtroPorMes=[t.AVISO_DEUDAS,t.AVISO_DEUDAS_PERIODO].includes(t.selectOption),t.codigo=t.selectOption,t.selectFiltrarPor="F",t.getTipoMensaje(),t.getDeudores();case 1:return o.a(2)}},o)}))()},changeTipoFiltro:function(){this.filtroPorMes="M"===this.selectFiltrarPor,this.getDeudores()},rowSelected:function(){this.totalSeleccionados=this.api.getSelectedRows().length},checkDeudas:function(){!0===this.ckbNumMes&&this.nroDeudas>0&&this.getDeudores()},getPerPerfil:function(){var e=this;return K()(Y()().m(function t(){var o,a;return Y()().w(function(t){while(1)switch(t.p=t.n){case 0:return t.p=0,e.personas=[],e.selectPersona=de["default"].TODOS,t.n=1,re.$http.get("api/personaController/getPersonaPerfil",{params:{params:{id_perfil:e.selectPerfil}}});case 1:o=t.v,o.length>0?(e.personas.push({value:"T",label:"Todos"}),o.map(function(t){return e.personas.push({value:t.ID_PERSONA,label:t.NOMBRE})})):e.personas=[],e.getDeudores(),t.n=3;break;case 2:t.p=2,a=t.v,console.error(a);case 3:return t.a(2)}},t,null,[[0,2]])}))()},onGridReady:function(e){this.api=e.api,this.api.sizeColumnsToFit()},getConceptos:function(){var e=this;return K()(Y()().m(function t(){var o;return Y()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,de["default"].API_CONCEPTOS({render:"grid"});case 1:o=t.v,e.dataConceptos=o;case 2:return t.a(2)}},t)}))()},getTipoMensaje:function(){var e=this;return K()(Y()().m(function t(){var o,a,n,r,l;return Y()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,re.$http.get("api/EnvioAlertaController/getMensajeAlerta",{params:{params:{MSGCOD:e.selectOption}}});case 1:o=t.v,o&&0!==o.length?e.mensajeConfigurado=!0:e.mensajeConfigurado=!1,a=B()(o,1),n=a[0],n.TEXTO&&0!==String(n.TEXTO).length?e.mensajeConfigurado=!0:e.mensajeConfigurado=!1,r="Envío de Alertas de: ",l=r,e.tipoMensaje=Number(n.CONFIG),e.title=l,e.pageHeader.title=e.title;case 2:return t.a(2)}},t)}))()},getPerfiles:function(){var e=this;return K()(Y()().m(function t(){return Y()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,de["default"].API_PERFILES();case 1:e.perfiles=t.v;case 2:return t.a(2)}},t)}))()},getAnios:function(){var e=this;return K()(Y()().m(function t(){return Y()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,de["default"].API_ANIOS();case 1:e.anios=t.v,e.anios.unshift({label:"Todos",value:"%"});case 2:return t.a(2)}},t)}))()},getColegioPersona:function(){var e=this;return K()(Y()().m(function t(){var o;return Y()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,re.$http.get("api/personaController/getDatosColegio",{params:{params:{}}});case 1:o=t.v,o.map(function(t){e.optionLocales.push({label:t.NOMBRE_COLEGIO,value:t.CODCOLEGIO})}),e.optionLocales.unshift({label:"Todos",value:"T"});case 2:return t.a(2)}},t)}))()},reporteCorreo:function(){return this.modalHistory=!0,!1},submit:function(){},enviarCorreo:function(){var e=this;return K()(Y()().m(function t(){var o,a;return Y()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,e.getTipoMensaje();case 1:if(e.mensajeConfigurado){t.n=2;break}return t.a(2,e.$alert("El tipo de alerta no tiene configurado el mensaje","warning"));case 2:o=e.api.getSelectedRows(),a="Ha ocurrido un error",o.length>0?e.$confirm("¿Esta seguro de enviar la alerta a los (".concat(o.length,") registros seleccionados?")).onOk(K()(Y()().m(function t(){var n,r,l,s,i,c,u,d,p,f;return Y()().w(function(t){while(1)switch(t.p=t.n){case 0:return n={MSGCOD:e.selectOption},t.n=1,re.$http.post("api/EnvioAlertaController/postRegistrarMailCampaign",{params:n});case 1:if(r=t.v,l={noEnviados:0,enviados:0},s=[],e.loading.showLoading=!0,e.loading.procesados=0,e.loading.total=o.length,!r.ID_MAIL_CAMPAIGN){t.n=12;break}i=$()(o),t.p=2,i.s();case 3:if((c=i.n()).done){t.n=9;break}return u=c.value,t.p=4,u.MSGCOD=e.selectOption,u.ANOCOB=e.selectAnio,u.DESTINO=e.selectDestino,u.ID_MAIL_CAMPAIGN=r.ID_MAIL_CAMPAIGN,e.selectOption!==e.AVISO_DEUDAS&&(u.FECVEN=(0,ge.convertToYMD)(e.selectDia)),e.filtroPorMes&&(u.MESCOB=e.seleccionarMes),u.CONCEPTO=e.conceptosSelect.map(function(e){return e.value}),t.n=5,re.$http.post("api/EnvioAlertaController/postEnviarAlerta",{params:u});case 5:d=t.v,1===d.code?l.enviados++:l.noEnviados++,s.push(u.CODIGO),t.n=7;break;case 6:t.p=6,p=t.v,l.noEnviados++,p.error&&(a=p.error.message);case 7:return t.p=7,e.loading.procesados++,t.f(7);case 8:t.n=3;break;case 9:t.n=11;break;case 10:t.p=10,f=t.v,i.e(f);case 11:return t.p=11,i.f(),t.f(11);case 12:e.getDeudores(s),e.loading.showLoading=!1,l.enviados>0?e.$alert("(".concat(l.enviados,") Alertas Enviados Satisfactoriamente"),"success"):e.$alert(o.length>1?"(".concat(l.noEnviados,") Alertas con Problemas para enviar"):a,"warning"),e.correoEnviado=!0,e.crearBotones(),e.getHistorialCorreos();case 13:return t.a(2)}},t,null,[[4,6,7,8],[2,10,11,12]])}))):e.$alert("No seleccionó ningún deudor para enviar correo");case 3:return t.a(2)}},t)}))()},convertDay:function(e){return e.split("/")[2]+"-"+e.split("/")[1]+"-"+e.split("/")[0]},peticionDeudas:function(e){var t=arguments;return K()(Y()().m(function o(){var a,n,r,l,s;return Y()().w(function(o){while(1)switch(o.n){case 0:return a=t.length>1&&void 0!==t[1]?t[1]:[],o.n=1,re.$http.get("api/EnvioAlertaController/getDeudores",{params:{params:e}});case 1:n=o.v,r=$()(n);try{for(r.s();!(l=r.n()).done;)s=l.value,a.length>0&&a.includes(s.CODIGO)?s.Estado="Enviado":s.Estado="Sin enviar"}catch(e){r.e(e)}finally{r.f()}return o.a(2,n)}},o)}))()},getDeudores:function(e){var t=this;return K()(Y()().m(function o(){var a,n;return Y()().w(function(o){while(1)switch(o.p=o.n){case 0:if(o.p=0,t.$q.loading.show(),t.procesando=!0,a={ANOCOB:t.selectAnio,ID_PERFIL:t.selectPerfil,CONCOB:[],ORDEN:t.selectOrden,CANTIDAD:null,ESTADO_PERSONA:t.selectEstadoPersona,msgCod:t.selectOption},0!==t.conceptosSelect.length){o.n=1;break}return t.rowData=[],t.$q.loading.hide(),o.a(2,!1);case 1:if(t.filtroPorMes||!t.ckbNumMes||0!==t.nroDeudas&&t.nroDeudas){o.n=2;break}return t.rowData=[],t.$q.loading.hide(),o.a(2,!1);case 2:return a.CONCOB=t.conceptosSelect.map(function(e){return e.value}),t.selectDia&&!t.filtroPorMes&&(a.FECVEN=t.convertDay(t.selectDia)),!t.filtroPorMes&&!0===t.ckbNumMes&&t.nroDeudas>0&&(a.CANTIDAD=t.nroDeudas),t.selectPersona&&t.selectPersona!==de["default"].TODOS&&(a.ID_PERSONA=t.selectPersona),t.selectNivel&&(a.INSTRUCOD=t.selectNivel),t.selectGrado&&(a.GRADOCOD=t.selectGrado),t.filtroPorMes&&(a.TIPO=2),t.P_COBRO_SEDE&&(a.LOCAL=t.selectLocal),a.MESCOB=t.seleccionarMes,a.DEUDAS_PENDIENTES=!0,e=e||[],o.n=3,t.peticionDeudas(a,e);case 3:t.rowData=o.v,t.$q.loading.hide(),o.n=5;break;case 4:o.p=4,n=o.v,t.$q.loading.hide(),t.$alert(n.error?n.error.message:n.message,"warning");case 5:return o.a(2)}},o,null,[[0,4]])}))()},getNiveles:function(){var e=this;return K()(Y()().m(function t(){return Y()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,de["default"].API_NIVELES();case 1:e.niveles=t.v,e.getDeudores();case 2:return t.a(2)}},t)}))()},getGrados:function(){var e=this;return K()(Y()().m(function t(){return Y()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,de["default"].API_GRADOS(e.selectNivel);case 1:e.grados=t.v,e.getDeudores();case 2:return t.a(2)}},t)}))()},getSecciones:function(){var e=this;return K()(Y()().m(function t(){return Y()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,de["default"].API_SECCIONES(e.selectGrado,e.selectNivel);case 1:e.secciones=t.v,e.getDeudores();case 2:return t.a(2)}},t)}))()},columns:function(){var e=this;return K()(Y()().m(function t(){return Y()().w(function(t){while(1)switch(t.n){case 0:e.columnDefs=[{headerName:"Código",field:"CODIGO",width:80},{headerName:"Apellidos y Nombres",field:"NOMBRE",width:275},{headerName:"Perfil",field:"PERFIL",width:110,hide:!0},{headerName:"NGS",field:"NGS",width:80},{headerName:"Nro. Deudas",field:"CANTIDAD",width:50},{headerName:"Estado",field:"Estado",width:120}];case 1:return t.a(2)}},t)}))()},closeModalCalendar:function(e){this.$refs[e].hide(),this.getDeudores()},getHistorialCorreos:function(){var e=this;return K()(Y()().m(function t(){var o;return Y()().w(function(t){while(1)switch(t.n){case 0:return o={mes:e.filtroHistorial.mes,anio:e.filtroHistorial.anio},t.n=1,re.$http.get("api/EnvioAlertaController/getEnviosAlerta",{params:{params:o}});case 1:e.gridHistorial.rowData=t.v;case 2:return t.a(2)}},t)}))()},columnsHistorial:function(){var e=[{headerName:"Código",field:"ID_MAIL_CAMPAIGN",width:70},{headerName:"Fecha Envío",field:"FECHA_ENVIO",valueFormatter:function(e){return e.value?(0,ot.Ay)(e.value,"DD/MM/YYYY"):null},filter:"agDateColumnFilter",width:140},{headerName:"Hora Envío",field:"FECHA_ENVIO",valueFormatter:function(e){return e.value?(0,ot.Ay)(e.value," HH:mm"):null},width:90},{headerName:"Usuario",field:"USUCOD",width:115},{headerName:"Asunto",field:"ASUNTO",width:400},{headerName:"Sin Enviar",field:"NO_ENVIADO",width:90},{headerName:"Enviado",field:"ENVIADO",width:90},{headerName:"Error",field:"ERROR",width:90},{cellRenderer:tt.A,cellRendererParams:{icon:"print",onClick:this.abrirModalReporte},width:50,filter:!1}];this.gridHistorial.columnDefs=e},onGridReadyHistorial:function(e){this.gridHistorial.api=e.api,this.gridHistorial.params=e,this.gridHistorial.api.sizeColumnsToFit()},generarReporteAlertas:function(){var e=document.getElementById("form");e.setAttribute("target","_blank"),e.setAttribute("method","POST"),e.setAttribute("action","/webservice/reporte-tesoreria/reporte"),e.children.tipReport?e.children.tipReport.value="reporte-alertas":e.appendChild(this.createHidden("tipReport","reporte-alertas")),e.children.idMailCampaign?e.children.idMailCampaign.value=this.paramsEnvio.ID_MAIL_CAMPAIGN:e.appendChild(this.createHidden("idMailCampaign",this.paramsEnvio.ID_MAIL_CAMPAIGN)),e.children.orden?e.children.orden.value=this.formReporte.seleccionOrden:e.appendChild(this.createHidden("orden",this.formReporte.seleccionOrden)),e.children.format?e.children.format.value=this.formReporte.formato:e.appendChild(this.createHidden("format",this.formReporte.formato)),e.submit()},createHidden:function(e,t){var o=document.createElement("input");return o.setAttribute("type","hidden"),o.setAttribute("name",e),o.setAttribute("id",e),o.setAttribute("value",t),o},abrirModalReporte:function(e){this.paramsEnvio=e.data,this.openModalTipoReporte=!0},generarReportePdf:function(e){var t=e.data.ID_MAIL_CAMPAIGN;if(!t)return this.$alert("No se han enviado correos");var o="".concat(origin,"/webservice/reporte-tesoreria/reporte-alertas?idMailCampaign=").concat(t,"&format=pdf");window.open(o,"_blank")},generarReporteXls:function(e){var t=e.data.ID_MAIL_CAMPAIGN;if(!t)return this.$alert("No se han enviado correos");var o="".concat(origin,"/webservice/reporte-tesoreria/reporte-alertas?idMailCampaign=").concat(t,"&format=xls");window.open(o,"_blank")},getMeses:function(){var e=this;return K()(Y()().m(function t(){return Y()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,de["default"].MESES();case 1:e.meses=t.v;case 2:return t.a(2)}},t)}))()}},beforeCreate:function(){var e=this;return K()(Y()().m(function t(){var o,a,n;return Y()().w(function(t){while(1)switch(t.n){case 0:return o=[de["default"].CONSTANTES_SISTEMA.P_ENVIAR_ALERTA_AUTO,de["default"].CONSTANTES_SISTEMA.P_COBRO_SEDE],a={ID_CONSTANTE:o},t.n=1,de["default"].API_CONSTANTES_SISTEMAS(a);case 1:n=t.v,e.P_ENVIAR_ALERTA_AUTO=1===Number(n.P_ENVIAR_ALERTA_AUTO),e.P_COBRO_SEDE=1===Number(n.P_COBRO_SEDE),e.P_ENVIAR_ALERTA_AUTO&&e.tabs.push({label:"Automatico",name:"tabAutomatico"}),e.tabs.push({label:"Historial",name:"reporte"});case 2:return t.a(2)}},t)}))()},created:function(){var e=this;return K()(Y()().m(function t(){return Y()().w(function(t){while(1)switch(t.n){case 0:e.statusBar={statusPanels:[{statusPanel:"agTotalAndFilteredRowCountComponent",align:"left"}]};case 1:return t.a(2)}},t)}))()},beforeMount:function(){var e=this;return K()(Y()().m(function t(){return Y()().w(function(t){while(1)switch(t.n){case 0:e.getTipoMensaje(),e.getConceptos(),e.getColegioPersona(),e.getPerfiles(),e.getNiveles(),e.getGrados(),e.getSecciones(),e.getPerPerfil(),e.columns(),e.getDeudores(),e.crearBotones(),e.changeOptions(),e.columnsHistorial(),e.getHistorialCorreos(),e.getMeses(),e.getAnios();case 1:return t.a(2)}},t)}))()}};const nt=(0,We.A)(at,[["render",q]]);var rt=nt}}]);