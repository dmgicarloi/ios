"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[55160],{55160:function(e,o,n){n.r(o),n.d(o,{default:function(){return te}});var t=n(8445),a=n.n(t),l=n(61758),r={class:"row"},i={class:"col-12 q-pa-sm"},s={class:"row q-col-gutter-sm"},c={class:"col"},u={class:"col-xs-12 col-sm-6 col-md-4 col-lg-3"},d={class:"col-xs-12 col-sm-6 col-md-4 col-lg-4"},m={class:"col-xs-12 col-sm-6 col-md-4 col-lg-2"},p={class:"col-xs-12 col-sm-6 col-md-4 col-lg-3"},f={class:"col-xs-12 col-sm-6 col-md-4 col-lg-3"},g={class:"col-xs-12 col-sm-6 col-md-4 col-lg-4"},b={class:"col-xs-12 col-sm-6 col-md-4 col-lg-2"},O={class:"col-xs-12 col-sm-6 col-md-4 col-lg-2"},v={class:"col-xs-12 col-sm-6 col-md-5 col-lg-2"},h={class:"col-xs-12 col-sm-6 col-md-4 col-lg-3"},k={class:"row q-gutter-xs"},A={class:"col"},E={class:"row full-height q-pt-sm"},C={class:"col column items-center justify-start"},I={class:"row sie-flat q-pt-md"},R={class:"col-xs-12"};function S(e,o){var n=this,t=(0,l.g2)("header-btn"),S=(0,l.g2)("autocomplete"),P=(0,l.g2)("q-input"),N=(0,l.g2)("q-select"),V=(0,l.g2)("q-date"),F=(0,l.g2)("q-popup-proxy"),D=(0,l.g2)("q-icon"),w=(0,l.g2)("q-tooltip"),L=(0,l.g2)("q-btn"),_=(0,l.g2)("sie-ngs"),x=(0,l.g2)("q-img"),M=(0,l.g2)("sie-table"),y=(0,l.g2)("q-card-section"),U=(0,l.g2)("q-card"),B=(0,l.g2)("modal-obs"),q=(0,l.g2)("modal-ampliar-retornos"),T=(0,l.g2)("modal-alertas"),G=(0,l.g2)("box-imagen"),Q=(0,l.g2)("q-page");return(0,l.uX)(),(0,l.Wv)(Q,{class:"movimiento-operaciones q-pa-sm sie-flat"},{default:(0,l.k6)(function(){return[(0,l.bF)(U,{flat:""},{default:(0,l.k6)(function(){return[(0,l.bF)(t,{name:"Realizar Devoluciones",buttons:e.buttons},null,8,["buttons"]),(0,l.bF)(y,{class:"q-pb-xs",style:{height:"calc(100vh - 143px)",padding:"0"}},{default:(0,l.k6)(function(){return[(0,l.Lk)("div",r,[(0,l.Lk)("div",i,[(0,l.Lk)("div",s,[(0,l.Lk)("div",c,[(0,l.bF)(_,{class:"q-pt-sm q-col-gutter-sm",ref:"refSieGNS",onNivel:o[16]||(o[16]=function(o){e.id_perfil=e.config.PERFIL_ALUMNO,e.getOperaciones()}),onGrado:e.getOperaciones,onSeccion:e.getOperaciones,"class-nivel":"col-xs-12 col-sm-6 col-md-4 col-lg-3","class-grado":"col-xs-12 col-sm-6 col-md-4 col-lg-3","class-seccion":"col-xs-12 col-sm-6 col-md-4 col-lg-2"},{prepend:(0,l.k6)(function(){return[(0,l.Lk)("div",u,[(0,l.bF)(S,{class:"q-ma-none",modelValue:e.solcod,"onUpdate:modelValue":o[0]||(o[0]=function(o){return e.solcod=o}),label:"Código/Nombre",data:e.solicitantes,keys:e.keysComplete,onSelected:e.selected},null,8,["modelValue","data","keys","onSelected"])]),(0,l.Lk)("div",d,[(0,l.bF)(P,{modelValue:e.nombre,"onUpdate:modelValue":o[1]||(o[1]=function(o){return e.nombre=o}),readonly:"",label:"Solicitante"},null,8,["modelValue"])]),(0,l.Lk)("div",m,[(0,l.bF)(P,{modelValue:e.descriptor,"onUpdate:modelValue":o[2]||(o[2]=function(o){return e.descriptor=o}),readonly:"",label:e.descriptorLabel},null,8,["modelValue","label"])]),(0,l.Lk)("div",p,[(0,l.bF)(N,{class:"q-ma-none",label:"Tipo Solicitante",type:"outlined",modelValue:e.id_perfil,"onUpdate:modelValue":o[3]||(o[3]=function(o){return e.id_perfil=o}),options:e.config.solicitantes,"option-value":"ID","option-label":"DESCRIPCION",onInput:e.changeSolicitante},null,8,["modelValue","options","onInput"])]),(0,l.Lk)("div",f,[(0,l.bF)(P,{modelValue:e.numingreso,"onUpdate:modelValue":o[4]||(o[4]=function(o){return e.numingreso=o}),label:"Número de Ingreso",ref:"refNumingreso",onKeyup:e.ejecutarAccion},null,8,["modelValue","onKeyup"])]),(0,l.Lk)("div",g,[(0,l.bF)(S,{class:"q-ma-nome",modelValue:e.titulo,"onUpdate:modelValue":o[5]||(o[5]=function(o){return e.titulo=o}),label:"Título",data:e.titulos,keys:e.keysTitulos,onSelected:e.tituloSelected},null,8,["modelValue","data","keys","onSelected"])]),(0,l.Lk)("div",b,[(0,l.bF)(P,{modelValue:e.parte,"onUpdate:modelValue":o[6]||(o[6]=function(o){return e.parte=o}),label:"Cod. Clasif.",onKeyup:e.cambiarClasif},null,8,["modelValue","onKeyup"])])]}),default:(0,l.k6)(function(){return[(0,l.Lk)("div",O,[(0,l.bF)(P,{label:"Desde",debounce:"500",maxlength:"10",format:"##/##/####",modelValue:e.desde,"onUpdate:modelValue":o[9]||(o[9]=function(o){return e.desde=o}),mask:"##/##/####",readonly:""},{append:(0,l.k6)(function(){return[(0,l.bF)(D,{class:"cursor-pointer",name:"date_range"},{default:(0,l.k6)(function(){return[(0,l.bF)(F,{ref:"qDateProxy3","transition-show":"scale","transition-hide":"scale"},{default:(0,l.k6)(function(){return[(0,l.bF)(V,{mask:"DD/MM/YYYY",modelValue:e.desde,"onUpdate:modelValue":o[7]||(o[7]=function(o){return e.desde=o}),onInput:o[8]||(o[8]=function(o){return e.filtrarFecha("qDateProxy3")})},null,8,["modelValue"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])]),(0,l.Lk)("div",v,[(0,l.bF)(P,{label:"Hasta",debounce:"500",maxlength:"10",format:"##/##/####",modelValue:e.hasta,"onUpdate:modelValue":o[12]||(o[12]=function(o){return e.hasta=o}),mask:"##/##/####",readonly:""},{append:(0,l.k6)(function(){return[(0,l.bF)(D,{class:"cursor-pointer",name:"date_range"},{default:(0,l.k6)(function(){return[(0,l.bF)(F,{ref:"qDateProxy4","transition-show":"scale","transition-hide":"scale"},{default:(0,l.k6)(function(){return[(0,l.bF)(V,{mask:"DD/MM/YYYY",modelValue:e.hasta,"onUpdate:modelValue":o[10]||(o[10]=function(o){return e.hasta=o}),onInput:o[11]||(o[11]=function(o){return e.filtrarFecha("qDateProxy4")})},null,8,["modelValue"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])]),(0,l.Lk)("div",h,[(0,l.Lk)("div",k,[(0,l.Lk)("div",A,[(0,l.bF)(N,{class:"q-ma-none",label:"Consultar",type:"outlined",modelValue:e.operacion,"onUpdate:modelValue":o[13]||(o[13]=function(o){return e.operacion=o}),options:e.config.operacionesBanco,"option-value":"ID","option-label":"DESCRIPCION",onInput:e.setearOperacion},null,8,["modelValue","options","onInput"])]),(0,l.bF)(L,{icon:"search",color:"primary",dense:"",onClick:o[14]||(o[14]=function(o){return e.getOperaciones()})},{default:(0,l.k6)(function(){return[(0,l.bF)(w,null,{default:(0,l.k6)(function(){return a()(o[22]||(o[22]=[(0,l.eW)("Buscar",-1)]))}),_:1})]}),_:1}),(0,l.bF)(L,{icon:"broom",color:"primary",dense:"",onClick:o[15]||(o[15]=function(o){return e.limpiar()})},{default:(0,l.k6)(function(){return[(0,l.bF)(w,null,{default:(0,l.k6)(function(){return a()(o[23]||(o[23]=[(0,l.eW)("Limpiar",-1)]))}),_:1})]}),_:1})])])]}),_:1},8,["onGrado","onSeccion"])]),(0,l.Lk)("div",null,[(0,l.Lk)("div",E,[(0,l.Lk)("div",C,[(0,l.bF)(x,{class:"foto-alumno",src:e.rutaFoto,width:"76px",height:"76px",onClick:e.openBoxImagen},{error:(0,l.k6)(function(){return[(0,l.bF)(x,{class:"foto-alumno",src:e.rutaFotoDefault,width:"76px",height:"76px"},null,8,["src"])]}),_:1},8,["src","onClick"])])])])]),(0,l.Lk)("div",I,[(0,l.Lk)("div",R,[(0,l.bF)(M,{ref:"refOper",columns:e.fieldsOperVigentes,onRowSelectedDbl:e.cargarDatosOper,"prevent-cell":"",data:e.rowsOperaciones,selection:"multiple",context:n,config:e.configTable,css:{height:"calc(100vh - 301px)"},totalPagination:e.totalPagination,totalRegistros:e.totalRegistros,"load-selection":e.loadSelected,onListarPagination:e.getOperaciones},null,8,["columns","onRowSelectedDbl","data","config","totalPagination","totalRegistros","load-selection","onListarPagination"])])])])])]}),_:1})]}),_:1}),e.modalObs?((0,l.uX)(),(0,l.Wv)(B,{key:0,modelValue:e.modalObs,"onUpdate:modelValue":o[17]||(o[17]=function(o){return e.modalObs=o}),operacion:e.config.OPERACION_PRESTAMO,"onUpdate:operacion":o[18]||(o[18]=function(o){return e.config.OPERACION_PRESTAMO=o}),currentRow:e.currentRow,configDB:e.config,onGetOperaciones:e.getOperaciones,onSetearLimite:e.setearLimite},null,8,["modelValue","operacion","currentRow","configDB","onGetOperaciones","onSetearLimite"])):(0,l.Q3)("v-if",!0),e.openModalAmpliarRetornos?((0,l.uX)(),(0,l.Wv)(q,{key:1,modelValue:e.openModalAmpliarRetornos,"onUpdate:modelValue":o[19]||(o[19]=function(o){return e.openModalAmpliarRetornos=o}),operacion:e.config.OPERACION_PRESTAMO,operSelected:e.operSelected,configDB:e.config,onGetOperaciones:e.getOperaciones},null,8,["modelValue","operacion","operSelected","configDB","onGetOperaciones"])):(0,l.Q3)("v-if",!0),e.openModalAlertas?((0,l.uX)(),(0,l.Wv)(T,{key:2,modelValue:e.openModalAlertas,"onUpdate:modelValue":o[20]||(o[20]=function(o){return e.openModalAlertas=o}),operacion:e.config.OPERACION_PRESTAMO,alertasOperaciones:e.alertasOperaciones,configDB:e.config},null,8,["modelValue","operacion","alertasOperaciones","configDB"])):(0,l.Q3)("v-if",!0),e.openModalImagen?((0,l.uX)(),(0,l.Wv)(G,{key:3,modelValue:e.openModalImagen,"onUpdate:modelValue":o[21]||(o[21]=function(o){return e.openModalImagen=o}),urlImage:e.urlImagenBox,urlImageDefault:e.rutaFotoDefault,titulo:e.nombre},null,8,["modelValue","urlImage","urlImageDefault","titulo"])):(0,l.Q3)("v-if",!0)]}),_:1})}var P=n(76080),N=n.n(P),V=n(45254),F=n.n(V),D=(n(71225),n(23825),n(10239),n(50310),n(5962),n(83190),n(24066),n(6123)),w=n(88567),L=n(95718),_=n(53380),x=n(57668),M=n(9736),y=n(3112),U=n(99515),B=n(16648),q=n(74656),T=n(53399),G=n(3042),Q=n(57343),Y={data:function(){return{configTable:{FECPREI:{component:"datetime",edit:!1},FECPREF:{component:"date",edit:!1},FECDEV:{component:"datetime",edit:!1},FECRES:{component:"datetime",edit:!1},OBS:{component:"button",icon:["write"],write:function(e){this.currentRow=e,this.modalObs=!0},tooltip:{write:"Agregar observación"},dense:!0,flat:!0}},rowsOperaciones:[]}},computed:{fieldsOperVigentes:function(){return[{name:"NUMINGRESO",label:"# Ingreso",field:"NUMINGRESO",align:"left",width:65,order:!0},{name:"NOMCOMP",label:"Nombre de Solicitante",field:"NOMCOMP",align:"left",wrap:!0,order:!0},{name:"NGS_CARGO",label:"NGS/Cargo",field:"NGS_CARGO",align:"left",wrap:!0,order:!0},{name:"PARTE",label:"Cod. Clasif.",field:"PARTE",align:"left",order:!0},{name:"TITULO",label:"Título",field:"TITULO",align:"left",wrap:!0,width:120,order:!0},{name:"SOLOBIB",label:"SB",field:"SOLOBIB",align:"center",order:!0},{name:"PL",label:"PL",field:"PL",align:"center",order:!0},{name:"NOMESTADO",label:"Estado",field:"NOMESTADO",align:"left",order:!0},{name:"FECRES",label:"Reserva",field:"FECRES",align:"left",wrap:!0,order:!0},{name:"FECPREI",label:"F. Prestamo",field:"FECPREI",align:"left",wrap:!0,order:!0},{name:"FECPREF",label:"F. Fin Prestamo",field:"FECPREF",align:"left",order:!0},{name:"FECDEV",label:"Devolución",field:"FECDEV",align:"left",wrap:!0},{name:"OBS",label:"Obs",field:"OBS",align:"left"}]}}},$=n(66592),W=n(18105),X=n(12143),j=n(95477),K=n(36667),z=n(87410),H=n(50012),J=n(90007),Z=n(98361),ee={mixins:[Y,$.A],components:{QCard:w.A,QCardSection:L.A,QSeparator:_.A,QInput:M.A,QRadio:U.A,QCheckbox:y.A,QSelect:B.A,QAvatar:q.A,QImg:T.A,autocomplete:G.A,QDate:X.A,QPopupProxy:j.A,sieNgs:K.A,modalObs:z.A,modalAmpliarRetornos:H.A,modalAlertas:J.A,boxImagen:Z.A,QPage:D.Tu,QIcon:D.bP,QBtn:D.Il,QTooltip:D.nC},computed:{rutaFotoDefault:function(){var e=(0,Q.getImageDefault)(this.sieInfo,this.sexo);return e},rutaFoto:function(){var e=(0,Q.imgEstudiante)(this.sieInfo,this.codigoFoto);return e},buttons:function(){var e=[];return e=this.operacion===this.config.OPERACION_DEVOLUCION?[this.bancoButtons.enviarAlerta,this.bancoButtons.imprimir,this.bancoButtons.revertirDev]:[this.bancoButtons.enviarAlerta,this.bancoButtons.devolucion,this.bancoButtons.imprimir,this.bancoButtons.ampliarPrestamos],e}},data:function(){var e=this;return{sieInfo:(0,x["default"])(),config:{},operacion:"",bancoButtons:{enviarAlerta:{icon:"email",permiso:">1",label:"Enviar alerta",click:function(){e.openEnvioAlerta()}},devolucion:{icon:"keyboard_return",permiso:">1",label:"Devolución",click:function(){var o="¿Está seguro de realizar la devolución de las operaciones seleccionadas?";e.devolucionPrestamos(e.config.OPERACION_DEVOLUCION,o,!0)}},imprimir:{icon:"print",permiso:">=1",label:"Imprimir",click:function(){e.imprimirAction()}},revertir:{icon:"undo",permiso:">1",label:"Revertir",click:function(){var o="¿Está seguro de revertir las operaciones seccionadas?";e.devolucionPrestamos(e.config.OPERACION_ANULACION,o)}},revertirDev:{icon:"undo",permiso:">1",label:"Revertir",click:function(){var o="¿Está seguro de revertir las operaciones seccionadas?";e.revertirDevoluciones(o)}},ampliarPrestamos:{icon:"edit",permiso:">1",label:"Ampliar prestamo",click:function(){e.openAmpliarPrestamo()}}},tab:"tab-operaciones",solcod:"",id_persona:"",personaSelected:{},id_perfil:"",solicitantes:[],solicitante:{},keysComplete:["TEXT"],keysTitulos:["TEXT"],keysCatalogos:["CATALOGO"],nombre:"",sexo:"M",descriptor:"",descriptorLabel:"NGS",tipoSolicita:"",numingreso:"",parte:"",titulo:"",titulos:[],desde:"",hasta:"",codigoFoto:"",hiddenOper:!0,currentRow:{},openModalAmpliarRetornos:!1,operSelected:[],reportCod:"relacionPrestamos",modalObs:!1,mostrarBloqueosObs:!1,mostrarBaja:!1,openModalAlertas:!1,alertasOperaciones:[],alerta:"",formObs:{},usaNgs:!0,caso:1,totalPagination:1,totalRegistros:"",openModalImagen:!1,urlImagenBox:"",loadSelected:{key:"NUMINGRESO",values:[]}}},methods:{imprimirAction:function(){this.operacion===this.config.OPERACION_DEVOLUCION?this.relacionDevoluciones():this.relacionPrestamos()},limpiar:function(){var e=this;return F()(N()().m(function o(){return N()().w(function(o){while(1)switch(o.n){case 0:return e.id_persona="",e.id_perfil="",e.solcod="",e.operacion=e.config.OPERACION_PRESTAMO,e.desde="",e.hasta="",e.titulo="",e.parte="",e.numingreso="",e.nombre="",e.loadSelected={key:"NUMINGRESO",values:[]},e.rowsOperaciones=[],e.descriptor="",e.descriptorLabel="NGS",e.setearNgs({}),e.getOperaciones(),o.n=1,e.$nextTick();case 1:e.$refs.refNumingreso&&e.$refs.refNumingreso.$el.focus();case 2:return o.a(2)}},o)}))()},getFilasSelected:function(e){return this.$refs.refOper.rowsSelected(e)},getCatalogos:function(){var e=this;return F()(N()().m(function o(){var n;return N()().w(function(o){while(1)switch(o.p=o.n){case 0:return o.p=0,o.n=1,e.$http.get("api/MantenimientosController/getComboLibrosCatalogos",{params:{params:{disponibles:!1}}});case 1:n=o.v,e.titulos=n||[],o.n=3;break;case 2:o.p=2,o.v,e.titulos=[];case 3:return o.a(2)}},o,null,[[0,2]])}))()},setearOperacion:function(){this.loadSelected={key:"NUMINGRESO",values:[]},this.desde="",this.hasta="",this.operacion===this.config.OPERACION_DEVOLUCION&&(this.desde=(0,W.Ay)(new Date,"DD/MM/YYYY"),this.hasta=(0,W.Ay)(new Date,"DD/MM/YYYY")),this.getOperaciones()},ejecutarAccion:function(e){var o=this;return F()(N()().m(function n(){var t,a,l;return N()().w(function(n){while(1)switch(n.n){case 0:if(13===e.keyCode){n.n=1;break}return n.a(2,!1);case 1:if(o.numingreso){n.n=2;break}return n.a(2,!1);case 2:if(o.solcod="",o.id_persona="",o.id_perfil="",!o.numingreso){n.n=8;break}return n.n=3,o.getOperaciones();case 3:if(t="",1!==o.rowsOperaciones.length||o.operacion!==o.config.OPERACION_PRESTAMO){n.n=7;break}if(a=o.solicitantes.filter(function(e){return e.ID_PERSONA===o.rowsOperaciones[0].ID_PERSONA}),!(a.length>0)){n.n=7;break}return a[0].NORECARGAR=!0,n.n=4,o.selected(a[0]);case 4:return t=n.v,n.n=5,o.loadSelected.values.push(o.rowsOperaciones[0]["NUMINGRESO"]);case 5:if(!t){n.n=7;break}return l="¿Desea realizar la devolución?",n.n=6,o.devolucionPrestamos(o.config.OPERACION_DEVOLUCION,l,!0,!1);case 6:t=n.v,t&&o.limpiar();case 7:return n.a(2,!1);case 8:return n.a(2)}},n)}))()}},created:function(){var e=this;return F()(N()().m(function o(){return N()().w(function(o){while(1)switch(o.n){case 0:return e.getPersonasBiblioteca(),o.n=1,e.getConfigOperaciones();case 1:e.getOperaciones(),e.getCatalogos();case 2:return o.a(2)}},o)}))()},mounted:function(){var e=this;return F()(N()().m(function o(){return N()().w(function(o){while(1)switch(o.n){case 0:e.$refs.refNumingreso&&e.$refs.refNumingreso.$el.focus();case 1:return o.a(2)}},o)}))()}},oe=n(12807);const ne=(0,oe.A)(ee,[["render",S]]);var te=ne}}]);