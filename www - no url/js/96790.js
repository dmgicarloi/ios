"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[96790],{96790:function(e,o,t){t.r(o),t.d(o,{default:function(){return w}});var a=t(8445),l=t.n(a),n=(t(71225),t(50310),t(5962),t(83190),t(61758)),i=t(58790),s={class:"column col q-ma-sm"},r={class:"row justify-between"},u={class:"row col-12"},c={class:"col-3"},d={class:"col-3"},p={class:"col-3"},m={class:"row"},f={class:"row"},g={class:"q-ma-sm"},h={key:0,class:"column col",style:{position:"relative"}},b={class:"column col",style:{position:"relative"}},v={class:"justify-row",style:{position:"absolute",right:"10px",top:"0px"}},E={key:1,class:"column col"};function k(e,o){var t=(0,n.g2)("sie-ano"),a=(0,n.g2)("q-select"),k=(0,n.g2)("sie-select"),C=(0,n.g2)("q-table"),O=(0,n.g2)("q-search"),S=(0,n.g2)("q-toggle"),A=(0,n.g2)("sie-upload"),I=(0,n.g2)("q-tooltip"),N=(0,n.g2)("sie-modal"),y=(0,n.g2)("q-btn"),F=(0,n.g2)("q-page-sticky");return(0,n.uX)(),(0,n.CE)("div",s,[(0,n.Lk)("div",r,[(0,n.Lk)("div",u,[(0,n.bF)(t,{class:"q-pt-xs col-xs-3 bg-white cr-curso",modelValue:e.ano,"onUpdate:modelValue":o[0]||(o[0]=function(o){return e.ano=o}),onSeleccionar:e.seleccionaSalon},{default:(0,n.k6)(function(){return[(0,n.eW)("- "+(0,i.v_)(e.ano),1)]}),_:1},8,["modelValue","onSeleccionar"]),(0,n.Lk)("div",c,[(0,n.bF)(a,{class:"q-if-outlined",optionValue:"DURACOD",optionLabel:"DURADES",label:"Periodo","float-label":"Periodo",options:e.periodos,modelValue:e.duracod,"onUpdate:modelValue":o[1]||(o[1]=function(o){return e.duracod=o}),onInput:e.seleccionaSalon},null,8,["options","modelValue","onInput"])]),(0,n.Lk)("div",d,[(0,n.bF)(a,{class:"q-if-outlined","option-value":"value","option-label":"label",label:"Tipo Alumno",options:e.tipoAlumnos,modelValue:e.proalu,"onUpdate:modelValue":o[2]||(o[2]=function(o){return e.proalu=o}),onInput:e.seleccionaSalon},null,8,["options","modelValue","onInput"])]),(0,n.Lk)("div",p,[(0,n.bF)(a,{class:"q-if-outlined",label:"Modo de Impresión",options:e.modoImpresionOpciones,modelValue:e.modoImpresion,"onUpdate:modelValue":o[3]||(o[3]=function(o){return e.modoImpresion=o})},null,8,["options","modelValue"])])])]),1===e.tipoCarnet?((0,n.uX)(),(0,n.CE)(n.FK,{key:0},[(0,n.Lk)("div",m,[(0,n.bF)(k,{class:"col",type:"outlined",modelValue:e.nivel,"onUpdate:modelValue":o[4]||(o[4]=function(o){return e.nivel=o}),options:e.niveles,label:"INSTRUDES",val:"INSTRUCOD",placeholder:"ngs.nivel",onInput:e.cambiarNivel},null,8,["modelValue","options","onInput"]),(0,n.bF)(k,{class:"col",type:"outlined",modelValue:e.grado,"onUpdate:modelValue":o[5]||(o[5]=function(o){return e.grado=o}),options:e.grados[e.nivel],label:"GRADODES",val:"GRADOCOD",placeholder:"ngs.grado",onInput:e.filtrarData},null,8,["modelValue","options","onInput"])]),(0,n.bF)(C,{class:"col q-my-sm","table-style":"max-height: 70vh","row-key":"NEMO",pagination:e.tablaNemos.paginacion,"onUpdate:pagination":o[6]||(o[6]=function(o){return e.tablaNemos.paginacion=o}),data:e.salones,columns:e.tablaNemos.columns,selection:e.tablaNemos.tipoSeleccion,selected:e.tablaNemos.registrosSeleccionados,"onUpdate:selected":o[7]||(o[7]=function(o){return e.tablaNemos.registrosSeleccionados=o}),"hide-bottom":""},null,8,["pagination","data","columns","selection","selected"])],64)):((0,n.uX)(),(0,n.CE)(n.FK,{key:1},[(0,n.Lk)("div",f,[(0,n.bF)(O,{class:"col q-if-outlined",modelValue:e.tablaEstudiantes.filter,"onUpdate:modelValue":o[8]||(o[8]=function(o){return e.tablaEstudiantes.filter=o})},null,8,["modelValue"])]),(0,n.bF)(C,{class:"col q-my-sm","table-style":"max-height: 70vh","row-key":"NOMCOMP",pagination:e.tablaEstudiantes.paginacion,"onUpdate:pagination":o[9]||(o[9]=function(o){return e.tablaEstudiantes.paginacion=o}),data:e.estudiantes,columns:e.tablaEstudiantes.columns,selection:e.tablaEstudiantes.tipoSeleccion,selected:e.tablaEstudiantes.registrosSeleccionados,"onUpdate:selected":o[10]||(o[10]=function(o){return e.tablaEstudiantes.registrosSeleccionados=o}),"hide-bottom":"",filter:e.tablaEstudiantes.filter},null,8,["pagination","data","columns","selection","selected","filter"])],64)),(0,n.bF)(N,{modelValue:e.modalConfiguracion,"onUpdate:modelValue":o[13]||(o[13]=function(o){return e.modalConfiguracion=o}),onSubmit:o[14]||(o[14]=function(o){return e.modalConfiguracion=!1})},{default:(0,n.k6)(function(){return[(0,n.Lk)("div",g,[(0,n.bF)(S,{modelValue:e.ocultaCabecera,"onUpdate:modelValue":o[11]||(o[11]=function(o){return e.ocultaCabecera=o}),label:"Ocultar Cabecera",color:"secondary"},null,8,["modelValue"])]),e.ocultaCabecera?(0,n.Q3)("v-if",!0):((0,n.uX)(),(0,n.CE)("div",h,[o[15]||(o[15]=(0,n.Lk)("span",{class:"text-bold",style:{"text-align":"center"}},"Escudo del Colegio",-1)),(0,n.bF)(A,{onUpload:e.addEscudo,icon:"file",title:"Escudo del Colegio",allow:["png"]},null,8,["onUpload"])])),(0,n.Lk)("div",b,[o[17]||(o[17]=(0,n.Lk)("div",{class:"row justify-center"},[(0,n.Lk)("span",{class:"text-bold",style:{"text-align":"center"}},"Fondo Frontal")],-1)),(0,n.bF)(A,{onUpload:e.addFrontal,icon:"file",title:"Fondo Frontal",allow:["png"]},{default:(0,n.k6)(function(){return[(0,n.Lk)("div",v,[(0,n.bF)(S,{class:"q-mr-sm",modelValue:e.repetirPosterior,"onUpdate:modelValue":o[12]||(o[12]=function(o){return e.repetirPosterior=o}),color:"secondary","checked-icon":"documents","unchecked-icon":"file_text_o",size:"sm"},{default:(0,n.k6)(function(){return[(0,n.bF)(I,null,{default:(0,n.k6)(function(){return l()(o[16]||(o[16]=[(0,n.eW)("Duplicar en posterior",-1)]))}),_:1})]}),_:1},8,["modelValue"])])]}),_:1},8,["onUpload"])]),e.repetirPosterior?(0,n.Q3)("v-if",!0):((0,n.uX)(),(0,n.CE)("div",E,[o[18]||(o[18]=(0,n.Lk)("span",{class:"text-bold",style:{"text-align":"center"}},"Fondo Posterior",-1)),(0,n.bF)(A,{onUpload:e.addPosterior,icon:"file",title:"Fondo Posterior",allow:["png"],remove:!0},null,8,["onUpload"])]))]}),_:1},8,["modelValue"]),(0,n.bF)(F,{expand:"",position:"bottom-right",offset:[20,20]},{default:(0,n.k6)(function(){return[(0,n.bF)(y,{fab:"",round:"",color:"secondary",icon:"file_export",onClick:e.exportar},null,8,["onClick"])]}),_:1})])}t(39866),t(77507),t(52133),t(56285),t(90095),t(6724),t(70199),t(48426),t(515),t(13715);var C=t(6123),O=t(16648),S=t(30545),A=t(80660),I=t(78131),N=t(57668),y=t(93616),F=t(33001),U=t(30640),V=t(59089),x=t(33950),q=t(2819),D=t(72453),P={components:{QOptionGroup:C.EX,sieAno:D.A,QRadio:C.$,QPageSticky:C._U,QCheckbox:C.vZ,sieSelect:y.A,QTable:S.A,SieModal:U.A,sieUpload:V.A,QToggle:C.c5,QSelect:O.A,QSearch:C.Ks,QTooltip:C.nC,QBtn:C.Il},data:function(){return{proalu:"T",duracod:"T",periodos:[],tipoAlumnos:[{label:"Todos",value:"T"},{label:"Internos",value:"I"},{label:"Externos",value:"E"}],sie:(0,N["default"])(),ano:(0,N["default"])().ano,tipoCarnet:2,salones:[],salonesBase:[],campos:[],salon:null,tablaNemos:{columns:[{name:"NEMO",field:"NEMO",align:"left"},{name:"NEMODES",field:"NEMODES",align:"left",label:this.$t("salon")}],paginacion:{page:1,rowsPerPage:40},registrosSeleccionados:[],tipoSeleccion:"single"},estudiantes:[],tablaEstudiantes:{columns:[{name:"NOMCOMP",field:"NOMCOMP",align:"left",label:this.$t("intranet.estudiante")}],paginacion:{page:1,rowsPerPage:40},registrosSeleccionados:[],tipoSeleccion:"multiple",filter:null},items:[{label:"Codigo de Alumno",value:"CODALU"},{label:"Nombre Completo",value:"NOMCOMP"},{label:"Nombre de Alumno",value:"NOMBRE"},{label:"Apellido Paterno",value:"PATERNO"},{label:"Apellido Materno",value:"MATERNO"},{label:"Salon",value:"SALON"},{label:"Nivel",value:"NIVEL"},{label:"Grado",value:"GRADO"},{label:"Sección",value:"SECCION"},{label:"Aula",value:"AULA"}],niveles:[],grados:{},nivel:"T",grado:"T",modalDetalle:!1,dataRevuelta:[],imagenes:{},repetirPosterior:!1,modoImpresionOpciones:[{value:"taller",label:"Vertical"},{value:"etiquetas004",label:"Etiquetas - 004"},{value:"etiquetas005",label:"Etiquetas - 005"}],modoImpresion:"taller",modalConfiguracion:!1,ocultaCabecera:!1,inicioEtk:1,maxEtk:{etiquetas004:33,etiquetas005:14}}},watch:{modoImpresion:function(){this.validaEtiquetas()},inicioEtk:function(){this.validaEtiquetas()}},methods:{cambiaAnio:function(){},validaEtiquetas:function(){this.modoImpresion.indexOf("etiquetas")>=0&&this.inicioEtk>this.maxEtk[this.modoImpresion]&&(this.inicioEtk=this.maxEtk[this.modoImpresion])},exportar:function(){var e=this;if(1===this.tipoCarnet&&this.tablaNemos.registrosSeleccionados.length>0||2===this.tipoCarnet&&this.tablaEstudiantes.registrosSeleccionados.length>0){var o="",t={ano:this.sie.ano,repcod:"carnetAsistenciaQr",tipoCarnet:this.tipoCarnet,modoImpresion:this.modoImpresion};if(1===this.tipoCarnet){var a=this.tablaNemos.registrosSeleccionados.map(function(e){return e.NEMO});o="?nemos="+a.join(","),t.nemos=a}else{var l=this.tablaEstudiantes.registrosSeleccionados.map(function(e){return e.CODALU});console.log("alucods:",l),l.length<=50?(o="?alucods="+l.join(","),t.alucods=l):(t.proalu=this.proalu,t.ano=this.ano,o="?proalu="+this.proalu,o+="&ano="+this.ano,o+="&duracod="+this.duracod)}if(["reportePdf","reporteExcel"].includes(this.modoImpresion))return void(0,q.exportFilePhp)(t,"webservice/reportes/reporte");if(Object.keys(this.imagenes).length>0&&Object.keys(this.imagenes).forEach(function(t){if(e.imagenes[t].name){var a=e.imagenes[t].name,l={archivo:a.substring(0,a.lastIndexOf(".")),extension:a.substring(a.lastIndexOf(".")+1,a.length)};o=o+"&"+t+"="+JSON.stringify(l)}}),o=o+"&modo="+this.modoImpresion,this.modoImpresion.indexOf("etiquetas")>=0&&(o=o+"&inicio="+this.inicioEtk),this.ocultaCabecera&&(o+="&ocultaCabecera=S"),this.imagenes["frontal"]&&this.repetirPosterior){var n=this.imagenes.frontal.name,i={archivo:n.substring(0,n.lastIndexOf(".")),extension:n.substring(n.lastIndexOf(".")+1,n.length)};o=o+"&posterior="+JSON.stringify(i)}var s=this.sie.api+"/HyoAlumnos/generarCarnetTaller"+o+"&token2="+this.sie.token+"&access_token="+this.sie.token;console.log(s),(0,I["default"])(s,"data.html",!0)}},getAlumnos:function(e){var o=this;A.$http.get("api/AsistenciaTalleresController/getAlumnosInscritos",{params:{params:{proalu:this.proalu,duracod:this.duracod,ano:this.ano}}}).then(function(e){console.log(e),o.estudiantes=e})},getPeriodos:function(e){var o=this;A.$http.get("api/AsistenciaTalleresController/getPeriodos").then(function(e){console.log(e),e.unshift({DURACOD:"T",DURADES:"Todos"}),o.periodos=e})},seleccionaSalon:function(e){this.tablaEstudiantes.registrosSeleccionados=[],this.getAlumnos()},subirImagenFinal:function(e,o){var t=this;(0,x.Upload)({url:"api/HyoArchivo/tmp/upload",file:o[0]}).then(function(o){t.imagenes[e]=o}).catch(function(){})},addEscudo:function(e){this.subirImagenFinal("escudo",e)},addFrontal:function(e){this.subirImagenFinal("frontal",e)},addPosterior:function(e){this.subirImagenFinal("posterior",e)},cambiarNivel:function(){this.grado="T",this.filtrarData()},filtrarData:function(){this.salones=Object.assign(this.salonesBase),"T"!==this.nivel&&(this.salones=(0,F.filterArray)(this.nivel,{field:"INSTRUCOD",list:this.salones}),"T"!==this.grado&&(this.salones=(0,F.filterArray)(this.grado,{field:"GRADOCOD",list:this.salones})))}},computed:{todos:function(){var e=this.campos.length===this.items.length;return this.campos.length!==this.items.length&&this.campos.length>0&&(e=null),e}},created:function(){this.getPeriodos()}},T=t(12807);const L=(0,T.A)(P,[["render",k]]);var w=L}}]);