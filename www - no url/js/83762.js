"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[83762],{83762:function(e,a,r){r.r(a),r.d(a,{default:function(){return x}});r(56285);var t=r(61758),o={class:"row items-center no-wrap"},n={class:"col-auto"},l={class:"row"},s={class:"row q-col-gutter-sm q-ma-sm q-pt-sm"},u={class:"col-xs-12 col-sm-6"},i={class:"col-xs-12 col-sm-6"},c={class:"row q-col-gutter-sm q-pa-md"},d={class:"col-xs-12"},p={class:"col-xs-12"},m={class:"col-xs-12"},f={class:"row q-pa-sm"},g={class:"col-xs-12"},v={class:"col-xs-12"};function h(e,a){var r=this,h=(0,t.g2)("crearBotones"),b=(0,t.g2)("q-separator"),E=(0,t.g2)("sie-select"),w=(0,t.g2)("sie-table"),T=(0,t.g2)("q-card"),C=(0,t.g2)("q-form"),A=(0,t.g2)("sie-modal"),P=(0,t.g2)("q-page");return(0,t.uX)(),(0,t.Wv)(P,{class:"sie-flat pasebrae bg-white q-pa-sm talleres--mantenimiento--paquete-taller"},{default:(0,t.k6)(function(){return[(0,t.bF)(T,{class:"q-ma-sm"},{default:(0,t.k6)(function(){return[(0,t.Lk)("div",o,[a[16]||(a[16]=(0,t.Lk)("div",{class:"col row"},[(0,t.Lk)("div",{class:"text-h6",style:{"font-size":"1.1rem","font-weight":"bold","padding-left":"16px"}},"Mantenimiento Paquete Taller")],-1)),(0,t.Lk)("div",n,[(0,t.bF)(h,{option:e.name,buttons:e.buttons,nivelAcceso:e.nivelAcceso},null,8,["option","buttons","nivelAcceso"])])]),(0,t.bF)(b),(0,t.Lk)("div",l,[(0,t.bF)(E,{class:"q-pa-sm col-sm-3",type:"outlined",modelValue:e.duracod,"onUpdate:modelValue":a[0]||(a[0]=function(a){return e.duracod=a}),val:"DURACOD",label:"DURADES",options:e.optPeriodo,readonly:!1,placeholder:"Periodo",onInput:a[1]||(a[1]=function(a){return e.cambiarPeriodo(1)})},null,8,["modelValue","options"]),(0,t.bF)(E,{class:"q-pa-sm col-sm-3",type:"outlined",modelValue:e.idPrograma,"onUpdate:modelValue":a[2]||(a[2]=function(a){return e.idPrograma=a}),val:"TIPOCOD",label:"TIPODES",options:e.optProgramas,readonly:!1,placeholder:"Programa",onInput:a[3]||(a[3]=function(a){return e.cambiarPrograma()})},null,8,["modelValue","options"]),(0,t.bF)(E,{class:"q-pa-sm col-sm-3",type:"outlined",modelValue:e.gruvacod,"onUpdate:modelValue":a[4]||(a[4]=function(a){return e.gruvacod=a}),val:"GRUVACOD",label:"GRUVADES",options:e.optGrupos,readonly:!1,placeholder:"Grupo",onInput:a[5]||(a[5]=function(a){return e.cambiarGrupo()})},null,8,["modelValue","options"]),(0,t.bF)(E,{class:"q-pa-sm col-sm-3",type:"outlined",modelValue:e.estadoTaller,"onUpdate:modelValue":a[6]||(a[6]=function(a){return e.estadoTaller=a}),val:"ESTADO",label:"ESTADODES",options:e.optEstadoTaller,readonly:!1,placeholder:"Estado",onInput:a[7]||(a[7]=function(a){return e.cambiarEstado()})},null,8,["modelValue","options"])]),(0,t.Lk)("div",s,[(0,t.Lk)("div",u,[(0,t.bF)(w,{columns:e.fieldsPaquetes,data:e.paquetes,context:r,config:e.configPaquetes,"show-footer":!1,css:{height:"calc(100vh - 221px)"},loadSelection:e.loadPaquetes,onRowSelected:e.rowSelected},null,8,["columns","data","config","loadSelection","onRowSelected"])]),(0,t.Lk)("div",i,[(0,t.bF)(w,{ref:"refTalleres",columns:e.fieldsTalleres,data:e.talleres,context:r,config:e.configTalleres,"show-footer":!1,css:{height:"calc(100vh - 221px)"}},null,8,["columns","data","config"])])])]}),_:1}),(0,t.bF)(A,{modelValue:e.modalAgregarPaquete,"onUpdate:modelValue":a[12]||(a[12]=function(a){return e.modalAgregarPaquete=a}),title:"Agregar Paquete",css:{"max-width":"800px"},onSubmit:e.guardarPaquete},{default:(0,t.k6)(function(){return[(0,t.bF)(C,{ref:"refFormPaquete"},{default:(0,t.k6)(function(){return[(0,t.Lk)("div",c,[(0,t.Lk)("div",d,[(0,t.bF)(E,{type:"outlined",modelValue:e.form.es_paquete_completo,"onUpdate:modelValue":a[8]||(a[8]=function(a){return e.form.es_paquete_completo=a}),val:"value",label:"label",options:e.optPaqueteCompleto,readonly:!1,placeholder:"Paquete Completo"},null,8,["modelValue","options"])]),(0,t.Lk)("div",p,[(0,t.bF)(E,{type:"outlined",modelValue:e.form.gruvacod,"onUpdate:modelValue":a[9]||(a[9]=function(a){return e.form.gruvacod=a}),val:"GRUVACOD",label:"GRUVADES",options:e.optGrupos,readonly:!1,placeholder:"Grupo",onInput:a[10]||(a[10]=function(a){return e.cambiarFormGrupo()})},null,8,["modelValue","options"])]),(0,t.Lk)("div",m,[(0,t.bF)(E,{type:"outlined",modelValue:e.form.id_curso_periodo,"onUpdate:modelValue":a[11]||(a[11]=function(a){return e.form.id_curso_periodo=a}),val:"ID_CURSO_PERIODO",label:"CURSODES",options:e.optTalleres,readonly:!1,placeholder:"Taller"},null,8,["modelValue","options"])])])]}),_:1},512)]}),_:1},8,["modelValue","onSubmit"]),(0,t.bF)(A,{modelValue:e.modalAgregarTalleres,"onUpdate:modelValue":a[15]||(a[15]=function(a){return e.modalAgregarTalleres=a}),title:"Agregar Talleres",css:{"max-width":"800px"},onSubmit:e.guardarTalleres},{default:(0,t.k6)(function(){return[(0,t.Lk)("div",f,[(0,t.Lk)("div",g,[(0,t.bF)(E,{class:"q-pa-sm",type:"outlined",modelValue:e.form.gruvacod,"onUpdate:modelValue":a[13]||(a[13]=function(a){return e.form.gruvacod=a}),val:"GRUVACOD",label:"GRUVADES",options:e.optGrupos,readonly:!1,placeholder:"Grupo",onInput:a[14]||(a[14]=function(a){return e.cambiarFormGrupo()})},null,8,["modelValue","options"])]),(0,t.Lk)("div",v,[(0,t.bF)(w,{class:"q-ma-sm",ref:"refTablaAgregarTalleres",context:r,config:e.configAgregarTalleres,columns:e.fieldsAgregarTalleres,data:e.optTalleres,dense:"",flat:"",bordered:"","wrap-cells":"",selection:"multiple",css:"height: calc(100vh - 160px)"},null,8,["config","columns","data"])])])]}),_:1},8,["modelValue","onSubmit"])]}),_:1})}var b=r(76080),E=r.n(b),w=r(45254),T=r.n(w),C=(r(12563),r(30683),r(74260),r(23825),r(52133),r(50310),r(32203),r(6724),r(515),r(83190),r(24066),r(6123)),A=r(11654),P=r(9736),D=r(16648),O=r(88567),q=r(95718),S=r(57668),_=r(30640),I=r(64303),R=r(53380),U=r(50425),L=r(34262),F=r(14667),V={data:function(){return{configPaquetes:{ES_PAQUETE_COMPLETO:{component:"select",options:[{value:1,label:"Si"},{value:0,label:"No"}],edit:!0,prevent:!0,autoSelect:!0,autoFocus:!0,label:"Seleccione",input:function(e){var a=this;return T()(E()().m(function r(){var t;return E()().w(function(r){while(1)switch(r.p=r.n){case 0:return r.p=0,r.n=1,a.$http.put("api/CtPaqueteTallerController/putCtPaqueteTaller",{datos:{es_paquete_completo:e.ES_PAQUETE_COMPLETO},params:{id_paquete_taller:e.ID_PAQUETE_TALLER}});case 1:a.$notify("El dato del paquete se ha actualizado correctamente"),r.n=3;break;case 2:r.p=2,t=r.v,a.$notify(t.message,"error");case 3:return r.a(2)}},r,null,[[0,2]])}))()}},ACCION:{component:"button",icon:["delete"],delete:function(e){var a=this;return T()(E()().m(function r(){var t,o,n;return E()().w(function(r){while(1)switch(r.p=r.n){case 0:return r.n=1,a.$confirmar("¿Está seguro de eliminar el taller del paquete?");case 1:if(t=r.v,!t){r.n=7;break}return r.p=2,o={id_paquete_taller:e.ID_PAQUETE_TALLER},r.n=3,a.$http.delete("api/CtPaqueteTallerController/deleteCtPaqueteTaller",{params:{params:o}});case 3:return r.n=4,a.getListaCursos();case 4:return r.n=5,a.getListaPaquetes();case 5:a.$notify("Se ha eliminado el paquete correctamente"),r.n=7;break;case 6:r.p=6,n=r.v,a.$notify(n.message,"error");case 7:return r.a(2)}},r,null,[[2,6]])}))()},prevent:!0}},paquetes:[],fieldsPaquetes:[{name:"ID_PAQUETE_TALLER",field:"ID_PAQUETE_TALLER",label:"ID",align:"left",width:10,wrap:!0,sortable:!0},{name:"ID_CURSO_PERIODO",field:"ID_CURSO_PERIODO",label:"Código",align:"left",width:40,wrap:!0,sortable:!0},{name:"PAQUETEDES",field:"PAQUETEDES",label:"Paquete",align:"left",width:80,wrap:!0,sortable:!0},{name:"ES_PAQUETE_COMPLETO",field:"ES_PAQUETE_COMPLETO",label:"Completo",wrap:!0,width:50,align:"left",sortable:!0},{name:"MONTOCUR",field:"MONTOCUR",label:"Monto",align:"right",width:50,wrap:!0,sortable:!0},{name:"ACCION",label:"ACCIONES",field:"ACCION",align:"center",width:50,wrap:!0}]}}},k=(r(1201),{data:function(){return{configTalleres:{FECINI:{component:"date",format:"DD/MM/YYYY",edit:!1},FECFIN:{component:"date",format:"DD/MM/YYYY",edit:!1},HORARIODES:{renderHtml:function(e,a){var r=this.agruparDiasPorHoras(e.HORARIODES.trimEnd());return a("div",{class:"row"},[a("div",{class:"col-12"},r.split(" (")[0]),a("div",{class:"col-12"},"("+r.split(" (")[1])])}},ACCION:{component:"button",icon:["delete"],delete:function(e){var a=this;return T()(E()().m(function r(){var t,o,n;return E()().w(function(r){while(1)switch(r.p=r.n){case 0:return r.n=1,a.$confirmar("¿Está seguro de eliminar el taller del paquete?");case 1:if(t=r.v,!t){r.n=6;break}return r.p=2,o={id_paquete_taller_det:e.ID_PAQUETE_TALLER_DET},r.n=3,a.$http.delete("api/CtPaqueteTallerDetController/deleteCtPaqueteTallerDet",{params:{params:o}});case 3:return a.$notify("El taller se ha eliminado del paquete correctamente"),r.n=4,a.getListaPaquetesDet(e);case 4:r.n=6;break;case 5:r.p=5,n=r.v,console.log(n),a.$notify(n.message,"error");case 6:return r.a(2)}},r,null,[[2,5]])}))()},prevent:!0}},talleres:[],fieldsTalleres:[{name:"ID_PAQUETE_TALLER_DET",field:"ID_PAQUETE_TALLER_DET",label:"ID",align:"left",sortable:!0},{name:"VACCOD",field:"VACCOD",label:"Código",align:"left",sortable:!0},{name:"CURSODES",field:"CURSODES",label:"Curso",wrap:!0,align:"left",sortable:!0},{name:"FECINI",field:"FECINI",label:"Fecha Inicio",align:"left",sortable:!0},{name:"FECFIN",field:"FECFIN",label:"Fecha Fin",align:"left",sortable:!0},{name:"HORARIODES",field:"HORARIODES",label:"Horario",wrap:!0,align:"left",sortable:!0},{name:"GRUVADES",field:"GRUVADES",label:"Grupo de Curso",wrap:!0,align:"left",sortable:!0},{name:"MONTOCUR",field:"MONTOCUR",label:"Monto",align:"left",sortable:!0},{name:"ACCION",label:"ACCIONES",field:"ACCION",align:"center"}]}}}),G=(r(10239),{data:function(){return{configAgregarTalleres:{FECINI:{component:"date",format:"DD/MM/YYYY",edit:!1},FECFIN:{component:"date",format:"DD/MM/YYYY",edit:!1},HORARIO:{renderHtml:function(e,a){var r=this.agruparDiasPorHoras(e.HORARIO.trimEnd());return a("div",{class:"row"},[a("div",{class:"col-12"},r.split(" (")[0]),a("div",{class:"col-12"},"("+r.split(" (")[1])])}}},fieldsAgregarTalleres:[{sortable:!0,label:"Curso",name:"CURSODES",field:"CURSODES",wrap:!0,align:"left"},{sortable:!0,label:"Fecha Inicio",name:"FECINI",field:"FECINI",align:"left"},{sortable:!0,label:"Fecha Fin",name:"FECFIN",field:"FECFIN",align:"left"},{sortable:!0,label:"Horario",name:"HORARIO",field:"HORARIO",wrap:!0,align:"left"},{sortable:!0,label:"Grupo de Curso",name:"GRUVADES",field:"GRUVADES",wrap:!0,align:"left"},{sortable:!0,label:"Monto",name:"MONTOCUR",field:"MONTOCUR",align:"left"}]}},methods:{validarCursosSeleccionados:function(e,a){var r=[];return e.map(function(e){var t=a.find(function(a){return a.ID_CURSO_PERIODO===e.ID_CURSO_PERIODO&&a.TURNO===e.TURNO});t&&r.push(e)}),r}}}),N=r(93616),y=r(2739),M={components:{QBtn:A.A,QSelect:D.A,QInput:P.A,QCard:O.A,QCardSection:q.A,sieModal:_.A,crearBotones:I.A,QSeparator:R.A,QTable:U.A,QIcon:L.A,sieSelect:N.A,QForm:y.A,QPage:C.Tu},mixins:[F.A,V,k,G],data:function(){return{name:"Mantenimiento Paquete Taller",nivelAcceso:2,sie:(0,S["default"])(),duracod:null,durades:null,idPrograma:0,gruvacod:null,estadoTaller:"T",optPeriodo:[],optProgramas:[],optGrupos:[],optEstadoTaller:[{ESTADO:"T",ESTADODES:"Todos"},{ESTADO:0,ESTADODES:"Abierto"},{ESTADO:1,ESTADODES:"Cerrado"}],buttons:[{label:"Agregar Paquete",icon:"add",click:this.openModalAgregarPaquete,minAcceso:2},{label:"Agregar Talleres",icon:"add",click:this.openModalAgregarTalleres,minAcceso:2}],form:{codigo_paquete:null,gruvacod:null,id_curso_periodo:null,es_paquete_completo:0},optPaqueteCompleto:[{value:0,label:"No"},{value:1,label:"SI"}],optTalleres:[],loadPaquetes:{key:"VACCOD",values:[]},rowSelect:{},modalAgregarPaquete:!1,modalAgregarTalleres:!1}},methods:{getDuracodActivo:function(){var e=this;return T()(E()().m(function a(){var r,t;return E()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,e.$http.get("api/InscripcionController/getPeriodo",{params:{activo:0}});case 1:r=a.v,e.optPeriodo=r,t=r.find(function(e){return"S"===e.VIGENTE}),e.duracod=t.DURACOD,e.durades=t.DURADES;case 2:return a.a(2)}},a)}))()},getTipogrupo:function(){var e=this;return T()(E()().m(function a(){var r;return E()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,e.$http.get("api/TipogrupovacController/getTipogrupo",{params:{parametros:{enUso:1,ano:e.sie.ano,duracod:e.duracod}}});case 1:r=a.v,e.optProgramas=r;case 2:return a.a(2)}},a)}))()},getGrupovac:function(){var e=this;return T()(E()().m(function a(){var r;return E()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,e.$http.get("api/GrupovacController/getGrupovac",{params:{parametros:{tipocod:e.idPrograma}}});case 1:r=a.v,r.unshift({GRUVACOD:null,GRUVADES:"Todos"}),e.optGrupos=e.optProgramas.length?r:[];case 2:return a.a(2)}},a)}))()},cambiarPeriodo:function(){var e=this;return T()(E()().m(function a(){return E()().w(function(a){while(1)switch(a.n){case 0:return e.idPrograma=0,e.gruvacod=null,a.n=1,e.getTipogrupo();case 1:return a.n=2,e.getGrupovac();case 2:return a.n=3,e.getListaPaquetes();case 3:return a.a(2)}},a)}))()},cambiarPrograma:function(){var e=this;return T()(E()().m(function a(){return E()().w(function(a){while(1)switch(a.n){case 0:return e.gruvacod=null,a.n=1,e.getGrupovac();case 1:return a.n=2,e.getListaPaquetes();case 2:return a.a(2)}},a)}))()},cambiarGrupo:function(){var e=this;return T()(E()().m(function a(){return E()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,e.getListaPaquetes();case 1:return a.a(2)}},a)}))()},cambiarEstado:function(){var e=this;return T()(E()().m(function a(){return E()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,e.getListaPaquetes();case 1:return a.a(2)}},a)}))()},cambiarFormGrupo:function(){var e=this;return T()(E()().m(function a(){return E()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,e.getListaCursos();case 1:return a.a(2)}},a)}))()},getListaPaquetes:function(){var e=this;return T()(E()().m(function a(){var r,t;return E()().w(function(a){while(1)switch(a.n){case 0:return r={ano:e.sie.ano,duracod:e.duracod,tipocod:e.idPrograma,gruvacod:e.gruvacod,abierto:e.estadoTaller,esPaqueteTaller:1},"T"!==e.estadoTaller&&(r.abierto=e.estadoTaller),a.n=1,e.$http.get("api/CtCursoPeriodoController/getListaPaquetes",{params:{params:r}});case 1:t=a.v,e.paquetes=t;case 2:return a.a(2)}},a)}))()},getListaPaquetesDet:function(e){var a=this;return T()(E()().m(function r(){var t,o;return E()().w(function(r){while(1)switch(r.n){case 0:return t={idPaqueteTaller:e.ID_PAQUETE_TALLER},r.n=1,a.$http.get("api/CtCursoPeriodoController/getListaPaquetesDet",{params:{params:t}});case 1:o=r.v,a.talleres=o;case 2:return r.a(2)}},r)}))()},getListaCursos:function(){var e=this;return T()(E()().m(function a(){var r,t;return E()().w(function(a){while(1)switch(a.n){case 0:return r={ano:e.sie.ano,duracod:e.duracod,gruvacod:e.form.gruvacod,noEsPaqueteTaller:1},a.n=1,e.$http.get("api/CtCursoPeriodoController/getCursoPeriodoTurno",{params:{params:r}});case 1:t=a.v,e.optTalleres=t;case 2:return a.a(2)}},a)}))()},rowSelected:function(e){var a=this;return T()(E()().m(function r(){return E()().w(function(r){while(1)switch(r.n){case 0:return a.loadPaquetes.values=[e.VACCOD],a.rowSelect=e,r.n=1,a.getListaPaquetesDet(e);case 1:return r.a(2)}},r)}))()},cleanForm:function(){this.form={codigo_paquete:null,gruvacod:null,id_curso_periodo:null,es_paquete_completo:0}},openModalAgregarPaquete:function(){var e=this;return T()(E()().m(function a(){var r;return E()().w(function(a){while(1)switch(a.p=a.n){case 0:return a.p=0,e.cleanForm(),e.modalAgregarPaquete=!0,a.n=1,e.getListaCursos();case 1:a.n=3;break;case 2:a.p=2,r=a.v,e.$notify(r.message,"warning");case 3:return a.a(2)}},a,null,[[0,2]])}))()},openModalAgregarTalleres:function(){var e=this;return T()(E()().m(function a(){var r;return E()().w(function(a){while(1)switch(a.p=a.n){case 0:if(a.p=0,Object.keys(e.rowSelect).length){a.n=1;break}throw new Error("Por favor selecciona un paquete");case 1:return e.modalAgregarTalleres=!0,a.n=2,e.getListaCursos();case 2:a.n=4;break;case 3:a.p=3,r=a.v,e.$notify(r.message,"warning");case 4:return a.a(2)}},a,null,[[0,3]])}))()},guardarPaquete:function(){var e=this;return T()(E()().m(function a(){var r;return E()().w(function(a){while(1)switch(a.p=a.n){case 0:if(a.p=0,e.form.id_curso_periodo){a.n=1;break}throw new Error("Por favor selecciona un taller");case 1:return e.form.codigo_paquete=e.form.id_curso_periodo,e.form.gruvacod=null,a.n=2,e.$http.post("api/CtPaqueteTallerController/postCtPaqueteTaller",{data:e.form});case 2:return a.n=3,e.getListaCursos();case 3:return a.n=4,e.getListaPaquetes();case 4:e.$notify("Se realizó el registro correctamente","success"),e.modalAgregarPaquete=!1,a.n=6;break;case 5:a.p=5,r=a.v,e.$notify(r.message,"warning");case 6:return a.a(2)}},a,null,[[0,5]])}))()},guardarTalleres:function(){var e=this;return T()(E()().m(function a(){var r,t,o;return E()().w(function(a){while(1)switch(a.p=a.n){case 0:if(a.p=0,Object.keys(e.rowSelect).length){a.n=1;break}throw new Error("Por favor selecciona un paquete");case 1:if(!e.validarCursosSeleccionados(e.$refs.refTablaAgregarTalleres.selected,e.talleres).length){a.n=2;break}if(r=e.validarCursosSeleccionados(e.$refs.refTablaAgregarTalleres.selected,e.talleres).find(function(e){return e.ID_CURSO_PERIODO&&e.TURNO}),!r){a.n=2;break}throw new Error("El taller ".concat(r.CURSODES," turno ").concat(r.TURNO," ya forma parte del paquete"));case 2:return t=e.$refs.refTablaAgregarTalleres.rowsSelected().map(function(a){return{id_paquete_taller:e.rowSelect.ID_PAQUETE_TALLER,id_curso_periodo:a.ID_CURSO_PERIODO,turno:a.TURNO}})||[],a.n=3,e.$http.post("api/CtPaqueteTallerDetController/postCtPaqueteTallerDet",{data:t});case 3:return a.n=4,e.getListaPaquetesDet(e.rowSelect);case 4:e.$notify("Se realizó el registro correctamente","success"),e.modalAgregarTalleres=!1,a.n=6;break;case 5:a.p=5,o=a.v,e.$notify(o.message,"warning");case 6:return a.a(2)}},a,null,[[0,5]])}))()},init:function(){var e=this;return T()(E()().m(function a(){return E()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,e.getDuracodActivo();case 1:return a.n=2,e.getTipogrupo();case 2:return a.n=3,e.getGrupovac();case 3:return a.n=4,e.getListaPaquetes();case 4:return a.a(2)}},a)}))()}},created:function(){var e=this;return T()(E()().m(function a(){return E()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,e.init();case 1:return a.a(2)}},a)}))()}},$=r(12807);const Q=(0,$.A)(M,[["render",h]]);var x=Q}}]);