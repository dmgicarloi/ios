"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[19198],{19198:function(e,o,r){r.r(o),r.d(o,{default:function(){return T}});var t=r(8445),a=r.n(t),n=r(61758),l=r(58790),i={class:"column",style:{display:"grid"}},s={class:"row"},u={class:"row justify-end col"},d={class:"q-ma-sm"},c={class:"q-ma-sm"},f={class:"col q-card"},m={class:"row"},p={class:"col"},b={class:"row justify-around"};function h(e,o){var r=(0,n.g2)("q-btn"),t=(0,n.g2)("q-toolbar-title"),h=(0,n.g2)("q-toolbar"),v=(0,n.g2)("header-btn"),H=(0,n.g2)("q-select"),I=(0,n.g2)("q-field"),g=(0,n.g2)("q-input"),O=(0,n.g2)("q-datetime"),R=(0,n.g2)("sie-modal"),M=(0,n.g2)("q-search"),A=(0,n.g2)("q-td"),_=(0,n.g2)("q-table");return(0,n.uX)(),(0,n.CE)("div",i,[e.estadoHorarios?(0,n.Q3)("v-if",!0):((0,n.uX)(),(0,n.Wv)(h,{key:0,color:"warning"},{default:(0,n.k6)(function(){return[(0,n.bF)(r,{flat:"",dense:"",round:"",icon:"warning"}),(0,n.bF)(t,null,{default:(0,n.k6)(function(){return a()(o[7]||(o[7]=[(0,n.eW)("Los horarios no son consecutivos, por favor revisar",-1)]))}),_:1})]}),_:1})),(0,n.bF)(v,{name:"Horarios",buttons:e.buttons},null,8,["buttons"]),(0,n.bF)(R,{modelValue:e.estadoModal,"onUpdate:modelValue":o[4]||(o[4]=function(o){return e.estadoModal=o}),title:"Agregar Horario",ok:!1,noClose:!0,escClick:!0,esc:!0},{footerMobile:(0,n.k6)(function(){return[(0,n.Lk)("div",s,[(0,n.bF)(r,{class:"q-ma-xs",dense:"",round:"",flat:"",icon:"close",onClick:e.cancelarAgregacion},null,8,["onClick"]),(0,n.bF)(r,{class:"q-ma-xs",dense:"",round:"",flat:"",icon:"save",onClick:e.ejecutarAccion},null,8,["onClick"])])]}),footer:(0,n.k6)(function(){return[(0,n.bF)(h,{inverted:""},{default:(0,n.k6)(function(){return[(0,n.Lk)("div",u,[(0,n.bF)(r,{class:"q-ma-xs style-button",dense:"",color:"secondary",onClick:e.cancelarAgregacion},{default:(0,n.k6)(function(){return a()(o[8]||(o[8]=[(0,n.eW)("Cancelar",-1)]))}),_:1},8,["onClick"]),(0,n.bF)(r,{class:"q-ma-xs style-button",dense:"",color:"primary",onClick:e.ejecutarAccion},{default:(0,n.k6)(function(){return[(0,n.eW)((0,l.v_)(e.lbAccion),1)]}),_:1},8,["onClick"])])]}),_:1})]}),default:(0,n.k6)(function(){return[(0,n.Lk)("div",d,[(0,n.bF)(I,{error:e.v$.datosModal.TH_ID.$error,"error-label":e.$t("validaciones.requerido")},{default:(0,n.k6)(function(){return[(0,n.bF)(H,{class:"q-if-outlined","float-label":"Tipo",options:e.tipos,modelValue:e.v$.datosModal.TH_ID.$model,"onUpdate:modelValue":o[0]||(o[0]=function(o){return e.v$.datosModal.TH_ID.$model=o}),placeholder:"Seleccione..."},null,8,["options","modelValue"])]}),_:1},8,["error","error-label"]),(0,n.bF)(I,{error:e.v$.datosModal.NOMBRE.$error,"error-label":e.$t("validaciones.requerido")},{default:(0,n.k6)(function(){return[(0,n.bF)(g,{class:"q-if-outlined","float-label":"Nombre",modelValue:e.v$.datosModal.NOMBRE.$model,"onUpdate:modelValue":o[1]||(o[1]=function(o){return e.v$.datosModal.NOMBRE.$model=o}),placeholder:"Escriba un nuevo nombre...",maxlength:"50"},null,8,["modelValue"])]}),_:1},8,["error","error-label"]),(0,n.bF)(I,{error:e.v$.datosModal.HORA_INICIO.$error,"error-label":e.$t("validaciones.requerido")},{default:(0,n.k6)(function(){return[(0,n.bF)(O,{class:"q-if-outlined","float-label":"Hora de Inicio",modelValue:e.v$.datosModal.HORA_INICIO.$model,"onUpdate:modelValue":o[2]||(o[2]=function(o){return e.v$.datosModal.HORA_INICIO.$model=o}),type:"time",format:"hh:mm A"},null,8,["modelValue"])]}),_:1},8,["error","error-label"]),(0,n.bF)(I,{error:e.v$.datosModal.HORA_FIN.$error,"error-label":e.$t("validaciones.requerido")},{default:(0,n.k6)(function(){return[(0,n.bF)(O,{class:"q-if-outlined","float-label":"Hora de Fin",modelValue:e.v$.datosModal.HORA_FIN.$model,"onUpdate:modelValue":o[3]||(o[3]=function(o){return e.v$.datosModal.HORA_FIN.$model=o}),type:"time",format:"hh:mm A"},null,8,["modelValue"])]}),_:1},8,["error","error-label"])])]}),_:1},8,["modelValue"]),(0,n.Lk)("div",c,[(0,n.Lk)("div",f,[(0,n.Lk)("div",m,[(0,n.Lk)("div",p,[(0,n.bF)(M,{class:"q-if-outlined",modelValue:e.filtro,"onUpdate:modelValue":o[5]||(o[5]=function(o){return e.filtro=o})},null,8,["modelValue"])]),(0,n.bF)(H,{class:"q-if-outlined","float-label":"Tipo Horario",options:e.tiposFilter,modelValue:e.filtro,"onUpdate:modelValue":o[6]||(o[6]=function(o){return e.filtro=o}),placeholder:"Seleccione..."},null,8,["options","modelValue"])]),(0,n.bF)(_,{data:e.horarios,columns:e.columns,filter:e.filtro,style:(0,l.Tr)({height:e.alto+"px"})},{"top-right":(0,n.k6)(function(){return a()(o[9]||(o[9]=[]))}),"body-cell-ACCIONES":(0,n.k6)(function(o){return[(0,n.bF)(A,{props:o},{default:(0,n.k6)(function(){return[(0,n.Lk)("div",b,[(0,n.bF)(r,{color:"blue",icon:"edit",flat:"",dense:"",round:"",onClick:function(r){return e.mostrarModal(o.row)}},null,8,["onClick"]),(0,n.bF)(r,{color:"red",icon:"delete",flat:"",dense:"",round:"",onClick:function(r){return e.eliminarHorario(o.row)}},null,8,["onClick"])])]}),_:2},1032,["props"])]}),_:1},8,["data","columns","filter","style"])])])])}var v=r(76080),H=r.n(v),I=r(45254),g=r.n(I),O=(r(52133),r(10239),r(50310),r(6724),r(48426),r(83190),r(68017),r(83972)),R=r(30545),M=r(11654),A=r(30640),_=r(6123),w=r(82640),$=r(57668),k=r(78786),C={setup:function(){var e=(0,O.fG)();return{v$:e}},components:{QTable:R.A,QBtn:M.A,sieModal:A.A,QDatetime:_.T5,QTd:_.Ef,QToolbar:_.ZV,QPopupEdit:_.GT,QSelect:_.Si,QToolbarTitle:_.r_,QField:_.Om,QInput:_.ie,QSearch:_.Ks},data:function(){var e=this;return{alto:null,permiso:(0,$["default"])().ruta.nivel,lbAccion:"",estadoModal:!1,filtro:"",estadoHorarios:!0,datosModal:{ID_TH:1,ID:null,NOMBRE:null,HORA_INICIO:null,HORA_FIN:null},tipos:[],tiposFilter:[],horarios:[],columns:[{name:"TH_ID",label:"Tipo",field:"TH_ID",align:"center",sortable:!0,format:function(o){var r=(0,k["default"])(e.tipos,o,{key:"value"});return-1===r?"":e.tipos[r].label}},{name:"NOMBRE",label:"Nombre",field:"NOMBRE",align:"column-style",sortable:!0},{name:"HORARIO",label:"Horario",field:"HORARIO",align:"center",sortable:!0},{name:"USUNOM",label:"Registrado por",field:"USUNOM",align:"left",sortable:!0},{name:"FH_REGISTRO",label:"Registrado",field:"FH_REGISTRO",align:"center",sortable:!0}]}},mounted:function(){this.obtenerHorarios(),this.obtenerTipos(),3===this.permiso&&this.columns.push({name:"ACCIONES",label:"Acciones",field:"ACCIONES",align:"center",style:"width: 90px"})},validations:function(){var e={TH_ID:{required:w.mw},NOMBRE:{required:w.mw},HORA_INICIO:{required:w.mw},HORA_FIN:{required:w.mw}};return{datosModal:e}},computed:{buttons:function(){var e=[];return this.permiso>=2&&e.push({label:"Agregar Horario",icon:"add",click:this.mostrarModal}),e}},methods:{handleResize:function(){var e=180;this.estadoHorarios&&(e=240),this.alto=window.innerHeight-e},mostrarModal:function(e){if(e.ID){this.lbAccion="Actualizar";var o=new Date;o.setHours(e.HORA_INICIO.split(":")[0]),o.setMinutes(e.HORA_INICIO.split(":")[1]);var r=new Date;r.setHours(e.HORA_FIN.split(":")[0]),r.setMinutes(e.HORA_FIN.split(":")[1]),this.datosModal=Object.assign({},e),this.datosModal.HORA_INICIO=o,this.datosModal.HORA_FIN=r}else this.limpiarCampos(),this.lbAccion="Agregar";this.estadoModal=!0},ejecutarAccion:function(){if(this.v$.$touch(),!this.v$.$error){var e=new Date(this.datosModal.HORA_INICIO),o=new Date(this.datosModal.HORA_FIN);o>e?(this.datosModal.ID?this.actualizarHorario():this.agregarHorario(),this.estadoModal=!1,this.limpiarCampos()):this.$notify("Horas Invalidas","warning")}},agregarHorario:function(){var e=this;return g()(H()().m(function o(){var r,t,a,n,l,i;return H()().w(function(o){while(1)switch(o.p=o.n){case 0:return o.p=0,r=e.datosModal,t=r.HORA_INICIO,a=r.HORA_FIN,n={TH_ID:e.datosModal.TH_ID,NOMBRE:e.datosModal.NOMBRE.trim(),HORA_INICIO:new Date(new Date(t).setSeconds(0)),HORA_FIN:new Date(new Date(a).setSeconds(0))},o.n=1,e.$http.post("api/RsHorarioController/addRsHorario",{data:n});case 1:l=o.v,1===l.code&&(e.obtenerHorarios(),e.$notify("Agregado","success")),o.n=3;break;case 2:o.p=2,i=o.v,e.$notify(i.error.message,"error");case 3:return o.a(2)}},o,null,[[0,2]])}))()},actualizarHorario:function(){var e=this;return g()(H()().m(function o(){var r,t,a,n,l,i;return H()().w(function(o){while(1)switch(o.p=o.n){case 0:return o.p=0,r=e.datosModal,t=r.HORA_INICIO,a=r.HORA_FIN,n={TH_ID:e.datosModal.TH_ID,NOMBRE:e.datosModal.NOMBRE.trim(),HORA_INICIO:t,HORA_FIN:a},o.n=1,e.$http.post("api/RsHorarioController/updateRsHorario",{id:e.datosModal.ID,params:n});case 1:l=o.v,1===l.code&&(e.obtenerHorarios(),e.$notify("Actualizado","success")),o.n=3;break;case 2:o.p=2,i=o.v,e.$notify(i.error.message,"error");case 3:return o.a(2)}},o,null,[[0,2]])}))()},eliminarHorario:function(e){var o=this;return g()(H()().m(function r(){var t,a,n;return H()().w(function(r){while(1)switch(r.p=r.n){case 0:return r.n=1,o.$confirmar("Â¿Esta Ud. Seguro de Eliminar el Horario?","warning",!0);case 1:if(t=r.v,!t){r.n=5;break}return r.p=2,e={id:e.ID},r.n=3,o.$http.delete("api/RsHorarioController/deleteRsHorario",{data:e});case 3:a=r.v,1===a.code&&(o.obtenerHorarios(),o.$notify("Eliminado","success")),r.n=5;break;case 4:r.p=4,n=r.v,o.$notify(n.error.message,"error");case 5:return r.a(2)}},r,null,[[2,4]])}))()},obtenerHorarios:function(){var e=this;return g()(H()().m(function o(){var r;return H()().w(function(o){while(1)switch(o.p=o.n){case 0:return o.p=0,o.n=1,e.$http.get("api/RsHorarioController/getRsHorario");case 1:return e.horarios=o.v,o.n=2,e.$http.get("api/RsHorarioController/getValidarHorarios");case 2:e.estadoHorarios=o.v,o.n=4;break;case 3:o.p=3,r=o.v,e.$notify(r.error.message,"error");case 4:return o.a(2)}},o,null,[[0,3]])}))()},cancelarAgregacion:function(){this.limpiarCampos(),this.estadoModal=!1},limpiarCampos:function(){for(var e in this.datosModal)this.datosModal[e]=null;this.v$.$reset()},timeToString:function(e,o){var r=new Date(e).toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"}),t=new Date(o).toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"});return{inicio:r,fin:t}},obtenerTipos:function(){var e=this;return g()(H()().m(function o(){var r,t;return H()().w(function(o){while(1)switch(o.p=o.n){case 0:return o.p=0,o.n=1,e.$http.get("api/RsTipoHorarioController/getRsTipoHorario");case 1:r=o.v,e.tipos=r.map(function(e){return{value:e.TH_ID,label:e.NOMBRE}}),e.tiposFilter=r.map(function(e){return{value:e.NOMBRE,label:e.NOMBRE}}),o.n=3;break;case 2:o.p=2,t=o.v,e.$notify(t.error.message,"error");case 3:return o.a(2)}},o,null,[[0,2]])}))()}},created:function(){var e=this;return g()(H()().m(function o(){return H()().w(function(o){while(1)switch(o.n){case 0:window.addEventListener("resize",e.handleResize),e.handleResize();case 1:return o.a(2)}},o)}))()},unmounted:function(){window.removeEventListener("resize",this.handleResize)}},N=r(12807);const F=(0,N.A)(C,[["render",h]]);var T=F}}]);