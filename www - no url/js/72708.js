"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[72708],{72708:function(e,t,n){n.r(t),n.d(t,{default:function(){return ee}});var a=n(61758),i={class:"row q-col-gutter-sm"},o={class:"col-xs-12 col-sm-6"},l={class:"row q-col-gutter-sm"},r={class:"col-xs-12"},s={class:"col-xs-12"},c={class:"col-xs-12 col-sm-6"},u={class:"row q-col-gutter-sm"},d={class:"col-xs-12"},m={class:"col-xs-12"},f={class:"row q-col-gutter-xs"},p={class:"col-xs-12 col-sm-12 col-md-6"},b={class:"row sie-flat"},g={class:"col-xs-12"},h={class:"col-xs-12"},v={class:"col-xs-12 col-sm-12 col-md-6"},w={class:"row sie-flat"},D={class:"col-xs-12"},C={class:"col-xs-12"},E={class:"row q-pa-sm q-col-gutter-sm"},I={class:"col-xs-12 col-md-8"},B={class:"col-xs-12 col-md-4"};function A(e,t){var n=this,A=(0,a.g2)("header-btn"),k=(0,a.g2)("q-separator"),S=(0,a.g2)("q-select"),O=(0,a.g2)("q-card-section"),x=(0,a.g2)("sie-table"),L=(0,a.g2)("q-card"),T=(0,a.g2)("q-img"),F=(0,a.g2)("materialBox"),M=(0,a.g2)("sie-modal"),U=(0,a.g2)("q-page");return(0,a.uX)(),(0,a.Wv)(U,{class:"movimiento-operaciones q-pa-sm sie-flat"},{default:(0,a.k6)(function(){return[(0,a.bF)(L,{flat:""},{default:(0,a.k6)(function(){return[(0,a.bF)(A,{name:"Transferencia de ejemplares: ",buttons:e.buttons},null,8,["buttons"]),(0,a.bF)(k),(0,a.bF)(O,null,{default:(0,a.k6)(function(){return[(0,a.Lk)("div",i,[(0,a.Lk)("div",o,[(0,a.Lk)("div",l,[(0,a.Lk)("div",r,[(0,a.bF)(S,{label:"Biblioteca origen",type:"outlined",modelValue:e.biblioteca,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.biblioteca=t}),options:e.bibliotecas,"option-value":"BIBCOD","option-label":"BIBDESC",onInput:t[1]||(t[1]=function(t){return e.getEstanterias()})},null,8,["modelValue","options"])]),(0,a.Lk)("div",s,[(0,a.bF)(S,{label:"Estanteria origen",type:"outlined",modelValue:e.estanteria,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.estanteria=t}),options:e.estanterias,"option-value":"UBICACOD","option-label":"UBICADES",onInput:t[3]||(t[3]=function(t){return e.getEjemplares()})},null,8,["modelValue","options"])])])]),(0,a.Lk)("div",c,[(0,a.Lk)("div",u,[(0,a.Lk)("div",d,[(0,a.bF)(S,{label:"Biblioteca destino",type:"outlined",modelValue:e.bibliotecaDestino,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.bibliotecaDestino=t}),options:e.bibliotecas,"option-value":"BIBCOD","option-label":"BIBDESC",onInput:t[5]||(t[5]=function(t){return e.getEstanteriasDes()})},null,8,["modelValue","options"])]),(0,a.Lk)("div",m,[(0,a.bF)(S,{label:"Estanteria destino",type:"outlined",modelValue:e.estanteriaDestino,"onUpdate:modelValue":t[6]||(t[6]=function(t){return e.estanteriaDestino=t}),options:e.estanteriasDestino,"option-value":"UBICACOD","option-label":"UBICADES"},null,8,["modelValue","options"])])])])])]}),_:1}),(0,a.bF)(O,null,{default:(0,a.k6)(function(){return[(0,a.Lk)("div",f,[(0,a.Lk)("div",p,[(0,a.Lk)("div",b,[(0,a.Lk)("div",g,[(0,a.bF)(A,{auto:!1,name:"Lista de Fichas","font-size":"16px",paddingX:"q-px-xs",border:!1})]),(0,a.Lk)("div",h,[(0,a.bF)(x,{ref:"ejemplares","row-key":"ID_CONTENIDO",columns:e.fieldsFicha,data:e.rowsEjemplares,selection:"single",config:e.config,css:{height:"calc(100vh - 290px)"},onRowSelected:e.agregar,"persistent-row-select":""},null,8,["columns","data","config","onRowSelected"])])])]),(0,a.Lk)("div",v,[(0,a.Lk)("div",w,[(0,a.Lk)("div",D,[(0,a.bF)(A,{auto:!1,name:"Lista de Ejemplares","font-size":"14px",border:!1})]),(0,a.Lk)("div",C,[(0,a.bF)(x,{ref:"procesar",columns:e.fields,data:e.rowsAgregar,selection:"multiple",context:n,config:e.configAgregar,css:{height:"calc(100vh - 290px)"}},null,8,["columns","data","config"])])])])])]}),_:1})]}),_:1}),(0,a.bF)(M,{modelValue:e.openModal,"onUpdate:modelValue":t[8]||(t[8]=function(t){return e.openModal=t}),title:"Detalle de Documento",css:{width:"700px"},onSubmit:e.infoSubmit},{default:(0,a.k6)(function(){return[(0,a.bF)(O,null,{default:(0,a.k6)(function(){return[(0,a.Lk)("div",E,[(0,a.Lk)("div",I,[(0,a.bF)(x,{"show-search":!1,"hide-bottom":!0,data:e.rowsDetalle,columns:e.fieldsInfo,config:e.configInfo},null,8,["data","columns","config"])]),(0,a.Lk)("div",B,[(0,a.bF)(T,{src:e.image,onClick:t[7]||(t[7]=function(t){return e.verCompleto(e.image)})},null,8,["src"])])])]}),_:1}),(0,a.bF)(F,{imageUrl:e.image,ref:"materialBox",titulo:e.tituloImg},null,8,["imageUrl","titulo"])]}),_:1},8,["modelValue","onSubmit"])]}),_:1})}var k=n(57008),S=n.n(k),O=n(76080),x=n.n(O),L=n(45254),T=n.n(L),F=(n(30683),n(52133),n(50310),n(6724),n(9240),n(83190),n(6123)),M=n(88567),U=n(95718),V=n(53380),j=n(9736),q=n(16648),R=n(982),y=n(3042),N=n(99515),_=n(3112),Q=n(30640),$=n(78840),P=n(10213),H=n(53399),G={class:"row"};function X(e,t){var n=(0,a.g2)("q-img"),i=(0,a.g2)("sie-modal");return(0,a.uX)(),(0,a.CE)("div",G,[(0,a.bF)(i,{modelValue:e.showModal,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.showModal=t}),persistent:"",title:e.titulo,footer:!1,onSubmit:e.closeModal},{default:(0,a.k6)(function(){return[(0,a.bF)(n,{src:e.imageUrl,onClick:e.closeModal},null,8,["src","onClick"])]}),_:1},8,["modelValue","title","onSubmit"])])}var z={props:{imageUrl:{type:String,required:!0},titulo:{type:String}},components:{sieModal:Q.A,QImg:H.A},data:function(){return{name:"materialBox",showModal:!1}},methods:{openModal:function(){this.showModal=!0},closeModal:function(){this.showModal=!1}},created:function(){}},W=n(12807);const J=(0,W.A)(z,[["render",X]]);var K=J,Y={components:{QCard:M.A,QCardSection:U.A,QSeparator:V.A,QInput:j.A,notify:R["default"],confirm:P.confirm,QSelect:q.A,sieModal:Q.A,autocomplete:y.A,actionButton:$.A,QRadio:N.A,QCheckbox:_.A,QImg:H.A,materialBox:K,QPage:F.Tu},computed:{},data:function(){var e=this;return{buttons:[{icon:"repeat",permiso:">2",label:"Transferir",click:this.transferir},{icon:"broom",permiso:">0",label:"Limpiar",click:this.limpiar}],openModal:!1,image:"https://web16.sieweb.com.pe/images/cms/sinimagen-150x150.png",tipo:1,bibliotecas:[],estanterias:[],estanteriasDestino:[],titulo:"",biblioteca:"",estanteria:"",bibliotecaDestino:"",estanteriaDestino:"",fichacod:"",zoomEnabled:!1,rowsEjemplares:[],rowsDetalle:[],rowsAgregar:[],tituloImg:"",config:{VER:{component:"button",icon:["book_open_page_variant as ver"],tooltip:{print:"Ver detalles"},ver:function(){var t=T()(x()().m(function t(n,a){var i;return x()().w(function(t){while(1)switch(t.n){case 0:return e.openModal=!0,t.n=1,e.$http.get("api/MantenimientosController/getDetalleFicha",{params:{params:a}});case 1:i=t.v,e.rowsDetalle=i,e.fieldsInfo[0].label="Tipo Documento: ".concat(i[0].FORDESC),e.tituloImg=i[0].TITULO;case 2:return t.a(2)}},t)}));function n(e,n){return t.apply(this,arguments)}return n}(),flat:!0,dense:!0}},configAgregar:{BIBDESC:{renderHtml:function(e,t){return t("span","".concat(e.BIBDESC||""," -  ").concat(e.UBICADES||""))}}},configInfo:{TIPO:{renderHtml:function(e,t){return t("span","Tipo Documento: ".concat(e.FORDESC||""))}}},fieldsFicha:[{name:"CATALOGO",label:"Catálogo",field:"CATALOGO",align:"left",maxWidth:30,wrap:!0},{name:"TITULO",label:"Título",field:"TITULO",align:"left",maxWidth:30,wrap:!0},{name:"TOTAL",label:"Ejemplares",field:"TOTAL",align:"center"},{name:"VER",label:"Ver",field:"VER",align:"left"}],fields:[{name:"NUMINGRESO",label:"# Ingreso",field:"NUMINGRESO",align:"left"},{name:"PARTE",label:"Num Clasif.",field:"PARTE",align:"left",wrap:!0},{name:"NUMEJEMP",label:"# Ejemp.",field:"NUMEJEMP",align:"center"},{name:"BIBDESC",label:"Biblioteca",field:"BIBDESC",align:"left",wrap:!0},{name:"ESTADO",label:"Estado",field:"ESTADO",align:"left"}],fieldsInfo:[{name:"MARCETI",label:"TIPO DOCUMENTO: ",field:"MARCETI",align:"left",wrap:!0},{name:"FICHADESC",label:"",field:"FICHADESC",align:"left",wrap:!0}]}},methods:{verCompleto:function(){this.$refs.materialBox.openModal()},infoSubmit:function(e){this.openModal=!1},transferir:function(e){var t=this,n=this.$refs.procesar.rowsSelected(null,null,!0);if(n.length<1)return(0,R["default"])("Debe seleccionar ejemplares para continuar el proceso","warning"),0;if(!this.bibliotecaDestino)return(0,R["default"])("Seleccione una biblioteca de destino","warning"),0;if(!this.estanteriaDestino)return(0,R["default"])("Seleccione una estanteria de destino","warning"),0;var a=n.some(function(e){return t.estanteriaDestino===e.UBICACOD&&t.bibliotecaDestino===e.BIBCOD});if(a)return(0,P.confirm)("No se puede transferir a la misma ubicación","info",!1,!1,"Transferir"),0;var i=n.map(function(e){return e.EXISTCOD});(0,P.confirm)("¿Está seguro de transferir los ejemplares?","info",!1,!1,"Transferir").onOk(function(){var e=T()(x()().m(function e(n){var a;return x()().w(function(e){while(1)switch(e.p=e.n){case 0:return e.p=0,e.n=1,t.$http.post("api/MantenimientosController/transferir",{params:{ejemplares:i,bibcod:t.bibliotecaDestino,ubicacod:t.estanteriaDestino}});case 1:return(0,R["default"])("Ejemplares transferidos exitosamente","success"),e.n=2,t.getEjemplares();case 2:t.rowsAgregar=[],e.n=4;break;case 3:e.p=3,a=e.v,(0,R["default"])("Ocurrio un error: ".concat(a.message),"warning");case 4:return e.a(2)}},e,null,[[0,3]])}));return function(t){return e.apply(this,arguments)}}())},selected:function(e){e&&(this.titulo=e.TITULO,this.fichacod=e.FICHACOD,this.getEjemplares())},agregar:function(e,t){var n=this;return T()(x()().m(function e(){var a;return x()().w(function(e){while(1)switch(e.n){case 0:return t.bibcod=n.biblioteca,t.ubicacod=n.estanteria,e.n=1,n.$http.get("api/ReportesBibliotecaController/getEjemplaresByFicha",{params:{params:t}});case 1:a=e.v,n.rowsAgregar=a;case 2:return e.a(2)}},e)}))()},limpiar:function(){this.estanteria="",this.titulo="",this.biblioteca=this.bibliotecas[0].BIBCOD,this.bibliotecaDestino="",this.estanteriaDestino="",this.rowsEjemplares=[],this.rowsAgregar=[]},getBibliotecas:function(){var e=this;return T()(x()().m(function t(){var n,a;return x()().w(function(t){while(1)switch(t.p=t.n){case 0:return t.p=0,n={columnas:["bibcod","bibdesc"],joins:[],order:{sidx:"bibdesc",sord:"asc"}},t.n=1,e.$http.get("api/MantenimientosController/getBibliotecas",{params:{parametros:n}});case 1:a=t.v,a.unshift({BIBCOD:"",BIBDESC:"Seleccione..."}),e.bibliotecas=a,t.n=3;break;case 2:t.p=2,t.v,e.bibliotecas=[],e.biblioteca="";case 3:return t.a(2)}},t,null,[[0,2]])}))()},getEstanterias:function(){var e=this;return T()(x()().m(function t(){var n,a;return x()().w(function(t){while(1)switch(t.p=t.n){case 0:return t.p=0,n={},n.bibcod=e.biblioteca,e.estanteria=null,t.n=1,e.$http.get("api/MantenimientosController/getEstanteriasBiblioteca",{params:{parametros:n}});case 1:return a=t.v,a.unshift({UBICACOD:"",UBICADES:"Seleccione..."}),e.estanterias=a,t.n=2,e.getEjemplares();case 2:return t.a(2,a);case 3:return t.p=3,t.v,t.a(2,[])}},t,null,[[0,3]])}))()},getEstanteriasDes:function(){var e=this;return T()(x()().m(function t(){var n,a;return x()().w(function(t){while(1)switch(t.p=t.n){case 0:return t.p=0,e.estanteriaDestino=null,n={},n.bibcod=e.bibliotecaDestino,t.n=1,e.$http.get("api/MantenimientosController/getEstanteriasBiblioteca",{params:{parametros:n}});case 1:return a=t.v,a.unshift({UBICACOD:"",UBICADES:"Seleccione..."}),e.estanteriasDestino=a,t.a(2,a);case 2:return t.p=2,t.v,t.a(2,[])}},t,null,[[0,2]])}))()},getEjemplares:function(){var e=this;return T()(x()().m(function t(){var n;return x()().w(function(t){while(1)switch(t.p=t.n){case 0:if(t.p=0,e.titulo||e.biblioteca||e.estanteria){t.n=1;break}return e.$notify("Aviso - Debe indicar datos para la consulta","warning"),t.a(2);case 1:return n={bibcod:e.biblioteca,ubicacod:e.estanteria,titulo:e.titulo,fichacod:e.fichacod},t.n=2,e.$http.get("api/ReportesBibliotecaController/getFichaLista",{params:{params:S()({},n)}});case 2:e.rowsEjemplares=t.v,t.n=4;break;case 3:t.p=3,t.v,e.rowsEjemplares=[];case 4:return t.a(2)}},t,null,[[0,3]])}))()}},created:function(){var e=this;return T()(x()().m(function t(){return x()().w(function(t){while(1)switch(t.n){case 0:e.getBibliotecas();case 1:return t.a(2)}},t)}))()}};const Z=(0,W.A)(Y,[["render",A]]);var ee=Z}}]);