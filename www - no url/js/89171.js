"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[89171],{89171:function(e,t,a){a.r(t),a.d(t,{default:function(){return k}});a(71225),a(50310),a(5962),a(83190);var l=a(61758),n=a(58790),o={class:"modal-detalle__header"},s={class:"modal-detalle__content"},r={class:"q-card"},i={class:"q-mt-sm"},u={class:"row q-gutter-md"},d={class:"row justify-between q-table__bottom row items-center"},c={class:"row"};function f(e,t){var a=this,f=(0,l.g2)("sie-modal"),m=(0,l.g2)("header-btn"),p=(0,l.g2)("q-icon"),b=(0,l.g2)("q-input"),h=(0,l.g2)("sie-table"),g=(0,l.g2)("q-page");return(0,l.uX)(),(0,l.Wv)(g,{class:"intranet--gestion-calidad bg-white q-pt-md q-px-sm"},{default:(0,l.k6)(function(){return[(0,l.bF)(f,{title:"METAS ANUALES",modelValue:e.estadoModalDetalle,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.estadoModalDetalle=t}),footer:!1},{default:(0,l.k6)(function(){return[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.dataMetasAnuales,function(e,a){return(0,l.uX)(),(0,l.CE)("div",{key:a,class:"modal-detalle"},[(0,l.Lk)("div",o,(0,n.v_)(a),1),(0,l.Lk)("div",s,[(0,l.Lk)("div",null,[t[4]||(t[4]=(0,l.Lk)("div",{class:"modal-detalle__subheader"},"Meta Anual",-1)),(0,l.Lk)("div",null,(0,n.v_)(e.META_ANUAL+(e.ES_PROMEDIO?"%":"")),1)]),(0,l.Lk)("div",null,[t[5]||(t[5]=(0,l.Lk)("div",{class:"modal-detalle__subheader"},"Resultado",-1)),(0,l.Lk)("div",null,(0,n.v_)(e.RESULTADO+(e.ES_PROMEDIO?"%":"")),1)])])])}),128))]}),_:1},8,["modelValue"]),(0,l.bF)(m,{name:"Tablero de resultados",buttons:e.buttons},null,8,["buttons"]),(0,l.Lk)("div",r,[(0,l.Lk)("div",i,[(0,l.Lk)("div",u,[(0,l.bF)(b,{class:"col",modelValue:e.filter,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.filter=t}),type:"search",placeholder:"Buscar",onInput:e.filterData,debounce:"500"},{prepend:(0,l.k6)(function(){return[(0,l.bF)(p,{name:"search"})]}),_:1},8,["modelValue","onInput"]),(0,l.bF)(b,{modelValue:e.anoI,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.anoI=t}),type:"number",label:"Inicio",onBlur:e.getTablaResultados,"input-style":"text-align: center"},null,8,["modelValue","onBlur"]),(0,l.bF)(b,{modelValue:e.anoF,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.anoF=t}),type:"number",label:"Fin",onBlur:e.getTablaResultados,"input-style":"text-align: center"},null,8,["modelValue","onBlur"])]),(0,l.bF)(h,{class:"q-mt-xs",ref:"tablaResultados",dense:"",flat:"",bordered:"","wrap-cells":"",css:"height: calc(100vh - 210px)","show-search":!1,context:a,columns:e.columns,data:e.dataTablaResultados,config:e.config,"header-tr":e.headResultados,hideBottom:!0},null,8,["columns","data","config","header-tr"]),(0,l.Lk)("div",d,[t[7]||(t[7]=(0,l.Lk)("div",{class:"column text-center justify-center"},[(0,l.Lk)("div",{class:"row text-center justify-center"},[(0,l.Lk)("div",{class:"text-bold"},"Niveles de cumplimiento")]),(0,l.Lk)("div",{class:"row"},[(0,l.Lk)("div",{class:"column text-center q-px-sm bg-red text-white"},[(0,l.Lk)("span",null,"Insatisfactorio"),(0,l.Lk)("span",null,"0% - 66%")]),(0,l.Lk)("div",{class:"column text-center q-px-sm bg-yellow"},[(0,l.Lk)("span",null,"Insatisfactorio"),(0,l.Lk)("span",null,"66% - 70%")]),(0,l.Lk)("div",{class:"column text-center q-px-sm bg-green text-white"},[(0,l.Lk)("span",null,"Satisfactorio"),(0,l.Lk)("span",null,"70% - 100%")])])],-1)),(0,l.Lk)("div",c,[t[6]||(t[6]=(0,l.Lk)("div",{class:"text-bold"},"Total:",-1)),(0,l.Lk)("span",null,(0,n.v_)(e.dataTablaResultados.length),1)])])])])]}),_:1})}var m=a(76080),p=a.n(m),b=a(45254),h=a.n(b),g=(a(10239),a(90095),a(515),a(13715),a(33777)),I=a(6123),R=a(2819),A=a(57668),T=a(9736),E=a(33001),L={name:"TablaResultados",components:{SieTable:g.A,QDatetime:I.T5,QInput:T.A,QPage:I.Tu,QIcon:I.bP},props:{anoInicio:{type:String,default:"2020"},anoFinal:{type:String,default:"2022"}},data:function(){return{anoI:(0,A["default"])().ano-3,anoF:(0,A["default"])().ano,dataTablaResultados:[],dataTablaBase:{},estadoModalDetalle:!1,headResultados:[],dataMetasAnuales:[],filter:null,columns:[],config:{fields:[{name:"ID",label:this.$t("N°"),align:"center",field:"ID"},{name:"NOMBRE_INDICADOR",label:this.$t("NOMBRE DEL INDICADOR"),align:"left",field:"NOMBRE_INDICADOR"},{name:"CRITERIO",label:this.$t("CRITERIO"),align:"center",field:"CRITERIO"},{name:"TIPO",label:this.$t("TIPO"),align:"center",field:"TIPO"},{name:"CATEGORIA",label:this.$t("CAMPO"),align:"center",field:"CATEGORIA"},{name:"META_GLOBAL",label:this.$t("META GLOBAL"),align:"center",field:"META_GLOBAL"}],flat:!0,round:!0,color:"primary"}}},methods:{getTablaResultados:function(){var e=this;return h()(p()().m(function t(){var a,l,n,o,s;return p()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,e.$http.get("api/CcAnoController/getCcAno",{params:{parametros:{ano:(0,A["default"])().ano}}});case 1:return a=t.v,l=a.tablaOriginal,l[(0,A["default"])().ano]&&(e.anoI=l[(0,A["default"])().ano].INICIO,e.anoF=l[(0,A["default"])().ano].FIN),t.n=2,e.$http.get("api/CcIndicadorController/getDataTableroResultados",{params:{anoI:e.anoI,anoF:e.anoF}});case 2:n=t.v,o=n.data,s=n.anos,e.dataTablaBase=o,e.setColumns(s),e.filterData();case 3:return t.a(2)}},t)}))()},setColumns:function(e){var t=this;this.columns=[{name:"ID",label:this.$t("N°"),align:"center",field:"ID"},{name:"NOMBRE_INDICADOR",label:this.$t("NOMBRE DEL INDICADOR"),align:"left",field:"NOMBRE_INDICADOR"},{name:"CRITERIO",label:this.$t("CRITERIO"),align:"center",field:"CRITERIO"},{name:"TIPO",label:this.$t("TIPO"),align:"center",field:"TIPO"},{name:"CATEGORIA",label:this.$t("CAMPO"),align:"center",field:"CATEGORIA"},{name:"META_GLOBAL",label:this.$t("META GLOBAL"),align:"center",field:"META_GLOBAL"}],this.headResultados=[[{label:"",colspan:"6",style:"text-align:left; font-weight:bold !important;",bgColor:"#ececec"},{label:"METAS ANUALES",colspan:2*e.length,style:"text-align:center; font-weight:bold !important;"}],[{label:"",colspan:"6",style:"text-align:left; font-weight:bold !important;",bgColor:"#ececec"}]],e.forEach(function(e){var a=e+"M",l=e+"R",n=e+"C";t.headResultados[1].push({label:e,colspan:"2",style:"text-align:center; font-weight:bold !important;"}),t.columns.push({name:a,label:"META",align:"center",field:a}),t.columns.push({name:l,label:"RESULTADO",align:"center",field:l}),t.config[l]={renderHtml:function(e,t,a,o){return a.background({text:e[l],color:e[n]||null,textColor:"yellow"!==e[n]?"white":"black"})}}})},filterData:function(){this.filter&&this.filter.length>0?this.dataTablaResultados=(0,E.filterArray)(this.filter,{field:["NOMBRE_INDICADOR"],list:this.dataTablaBase}):this.dataTablaResultados=this.dataTablaBase},exportarTableroDeResultados:function(e){var t=this;return h()(p()().m(function a(){var l;return p()().w(function(a){while(1)switch(a.n){case 0:try{l={tipo:e,anoI:t.anoI,anoF:t.anoF},"pdf"===e&&(t.anoF-t.anoI>0&&t.anoF-t.anoI<6?(0,R.exportFilePhp)(l,"/intranet/mapa-procesos/reporte-tablero-resultados","reporte-tablero-resultados","mapaconfiguracion"):t.$notify("El rango maximo para exportacion en PDF es de 5 anos","error")),"xls"===e&&(0,R.exportFilePhp)(l,"/intranet/mapa-procesos/reporte-tablero-resultados","reporte-tablero-resultados","mapaconfiguracion")}catch(e){t.$alert(e.message,"info")}case 1:return a.a(2)}},a)}))()},mostrarDetalle:function(e){console.log(e),e&&Object.keys(e).length>0?(this.estadoModalDetalle=!0,this.dataMetasAnuales=e):this.$notify("No hay información por mostrar","error")}},computed:{buttons:function(){var e=this;return[{icon:"file_pdf",label:"Exportar Pdf",tooltip:"Exportar PDF",permiso:"> 1",click:function(){e.exportarTableroDeResultados("pdf")}},{icon:"file_excel",label:"Exportar Excel",tooltip:"Exportar Excel",permiso:"> 1",click:function(){e.exportarTableroDeResultados("xls")}}]}},mounted:function(){var e=this;return h()(p()().m(function t(){return p()().w(function(t){while(1)switch(t.n){case 0:e.getTablaResultados();case 1:return t.a(2)}},t)}))()}},O=a(12807);const v=(0,O.A)(L,[["render",f]]);var k=v}}]);