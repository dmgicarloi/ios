"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[93985],{93985:function(e,n,o){o.r(n),o.d(n,{default:function(){return _}});var t=o(8445),a=o.n(t),s=o(61758),l=o(29104),r=o(58790),i={class:"col"},u={class:"column"},c={class:"column col"},d={class:"row justify-between"},m={class:"row q-mt-xs"},p={key:0,class:"row q-ma-xs justify-around",style:{height:"75vh","overflow-x":"auto"}},f={class:"q-card col-5 q-ma-xs"},h={class:"row"},v=["src"],g={class:"column col q-ma-xs"},k={class:"row justify-between"},w={class:"row"};function y(e,n){var o=(0,s.g2)("sie-upload"),t=(0,s.g2)("q-btn"),y=(0,s.g2)("sie-salones"),U=(0,s.g2)("q-toolbar"),b=(0,s.g2)("q-icon"),A=(0,s.g2)("sie-select");return(0,s.uX)(),(0,s.CE)("div",i,[(0,s.bo)((0,s.bF)(o,{allow:["jpg","JPG"],onUpload:e.uploadFotos,ref:"upload",multiple:!0},null,8,["onUpload"]),[[l.aG,!1]]),(0,s.Lk)("div",u,[(0,s.Q3)('header-btn(name="Importar" :buttons="buttons")'),(0,s.bF)(U,{class:"q-card",inverted:""},{default:(0,s.k6)(function(){return[(0,s.Lk)("div",c,[(0,s.Lk)("div",d,[n[3]||(n[3]=(0,s.Lk)("span",{class:"text-bold q-title text-primary q-my-xs"},"Importar",-1)),(0,s.Lk)("div",m,[e.nemo?((0,s.uX)(),(0,s.Wv)(t,{key:0,class:"q-mx-xs",style:{height:"20px"},color:"primary",size:"sm",icon:"file_download",onClick:e.importFile},{default:(0,s.k6)(function(){return a()(n[1]||(n[1]=[(0,s.eW)("Importar",-1)]))}),_:1},8,["onClick"])):(0,s.Q3)("v-if",!0),e.isSave?((0,s.uX)(),(0,s.Wv)(t,{key:1,style:{height:"20px"},color:"primary",size:"sm",icon:"save",onClick:e.guardarFotos},{default:(0,s.k6)(function(){return a()(n[2]||(n[2]=[(0,s.eW)("Procesar",-1)]))}),_:1},8,["onClick"])):(0,s.Q3)("v-if",!0)])]),(0,s.bF)(y,{class:"col no-border",modelValue:e.nemo,"onUpdate:modelValue":n[0]||(n[0]=function(n){return e.nemo=n}),todos:!1,onSeleccionar:e.getAlumnos},null,8,["modelValue","onSeleccionar"])])]}),_:1}),e.nemo&&e.imgUploads.length>0?((0,s.uX)(),(0,s.CE)("div",p,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.imgUploads,function(o){return(0,s.uX)(),(0,s.CE)("div",f,[(0,s.Lk)("div",h,[(0,s.Lk)("img",{src:e.getUrl(o),width:"200"},null,8,v),(0,s.Lk)("div",g,[(0,s.Lk)("div",k,[(0,s.Lk)("div",w,[n[4]||(n[4]=(0,s.Lk)("div",{class:"text-bold"},"Archivo: ",-1)),(0,s.Lk)("span",null,(0,r.v_)(o.originalFilename),1)]),o.INICIAL?((0,s.uX)(),(0,s.Wv)(b,{key:0,class:"q-ml-xs",name:"done_all",color:"green",style:{"font-size":"20px"}})):(0,s.Q3)("v-if",!0)]),(0,s.bF)(A,{class:"col",type:"outlined",options:e.estudiantes,val:"ALUCOD",label:"NOMCOMP",placeholder:"Estudiante",modelValue:o.ALUCOD,"onUpdate:modelValue":function(e){return o.ALUCOD=e}},null,8,["options","modelValue","onUpdate:modelValue"])]),(0,s.Q3)("span xxx")]),(0,s.Q3)("span {{getUrl(img)}}")])}),256))])):(0,s.Q3)("v-if",!0)])])}var U=o(76080),b=o.n(U),A=o(45254),C=o.n(A),L=(o(30683),o(10239),o(56285),o(50310),o(90095),o(83190),o(27153),o(13715),o(6123)),x=o(59089),O=o(88275),q=o(33950),F=o(80660),I=o(57668),Q=o(93616),D=o(69027),E=o(33001),S={components:{sieUpload:x.A,sieSalones:O.Ay,sieSelect:Q.A,QToolbar:L.ZV,QToolbarTitle:L.r_,QBtn:L.Il,QIcon:L.bP},data:function(){return{sie:(0,I["default"])(),nemo:null,estudiantes:[],imgUploads:[],showSave:!0}},computed:{isSave:function(){var e=this.imgUploads.length>0&&this.showSave&&this.nemo;return e}},methods:{importFile:function(){this.$refs.upload.$el.querySelector("input").click()},guardarFotos:function(){var e=this;return C()(b()().m(function n(){var o,t;return b()().w(function(n){while(1)switch(n.n){case 0:return o=[],n.n=1,e.imgUploads.forEach(function(){var n=C()(b()().m(function n(a,s){return b()().w(function(n){while(1)switch(n.n){case 0:a.ALUCOD&&o.push(a),s===e.imgUploads.length-1&&(o.length>0?(0,D.dialogConfirm)({message:"¿Está seguro de ejecutar este proceso?",ok:"Si",cancel:"No"}).then(function(n){n&&o.forEach(function(){var n=C()(b()().m(function n(o,a){var s;return b()().w(function(n){while(1)switch(n.n){case 0:return n.n=1,F.$http.post("api/HyoAlumnos/grabarNuevaFoto",{parametros:o});case 1:s=n.v,s.type&&(t=s),a===e.imgUploads.length-1&&(t||(t={msg:"m0001"}),e.$notify(e.$t("mensajes."+t.msg),t.type),e.imgUploads=[]);case 2:return n.a(2)}},n)}));return function(e,o){return n.apply(this,arguments)}}())}):e.$notify("No hay información por guardar","warning"));case 1:return n.a(2)}},n)}));return function(e,o){return n.apply(this,arguments)}}());case 1:return n.a(2)}},n)}))()},getUrl:function(e){var n=e.container,o=e.name;return this.sie.api+"/HyoArchivo/descargar/".concat(n,"/").concat(o,"?access_token=").concat(this.sie.token)},uploadFotos:function(e){var n=this;return C()(b()().m(function o(){var t,a,s,l;return b()().w(function(o){while(1)switch(o.p=o.n){case 0:t=0,n.imgUploads=[];case 1:return o.p=1,a=e[t],o.n=2,(0,q.Upload)({url:"api/HyoArchivo/tmp/upload",file:a});case 2:return s=o.v,l=s["originalFilename"].split(".")[0],o.n=3,n.getAlucod(l);case 3:s.ALUCOD=o.v,s.INICIAL=!!s.ALUCOD,n.imgUploads.push(s),o.n=5;break;case 4:o.p=4,o.v;case 5:t++;case 6:if(t<e.length){o.n=1;break}case 7:return o.a(2)}},o,null,[[1,4]])}))()},getAlucod:function(e){var n=this;return new Promise(function(o,t){var a=(0,E.filterArray)(e,{field:["ALUCOD","NOMCOMP","DOCIDENRO"],list:n.estudiantes});a.length>0?o(a[0].ALUCOD):o(null)})},getAlumnos:function(e){var n=this,o=e.NEMO;F.$http.get("api/HyoAlumnos/obtAlumnos",{params:{parametros:{aula:o}}}).then(function(e){var o=e.json;n.estudiantes=o,n.imgUploads=[]})}}},N=o(12807);const V=(0,N.A)(S,[["render",y]]);var _=V}}]);