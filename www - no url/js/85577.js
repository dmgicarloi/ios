"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[85577],{85577:function(a,o,e){e.r(o),e.d(o,{default:function(){return j}});var t=e(61758),s=e(58790),n={ref:"audioOk",src:"statics/sound/ok.mp3"},l={ref:"audioInfo",src:"statics/sound/duplicate.mp3"},i={ref:"audioError",src:"statics/sound/error.mp3"},r={class:"row q-mx-sm"},u={key:0,class:"q-card row q-ma-sm"},c={class:"row"},d={class:"row"},f={class:"row"},m={class:"row justify-center q-mx-sm"},h={class:"column col q-mr-xs"},g={class:"row"},p={key:0,class:"row"},b={key:1,class:"row q-pa-xs col",style:{border:"1px solid black !important","border-radius":"3px",height:"36px"}},A={style:{"font-size":"0.8rem"}},O={key:0,class:"row col",style:{border:"1px solid black !important","border-radius":"3px"}},v={style:{"font-size":"0.8rem"}},M={key:0,class:"row q-ma-xs"},k={class:"row q-mx-sm"};function C(a,o){var e=this,C=(0,t.g2)("header-btn"),D=(0,t.g2)("q-input"),L=(0,t.g2)("sie-select"),U=(0,t.g2)("q-item-separator"),E=(0,t.g2)("sie-usuario"),y=(0,t.g2)("q-item-tile"),S=(0,t.g2)("q-item-main"),w=(0,t.g2)("q-item"),x=(0,t.g2)("q-datetime"),q=(0,t.g2)("q-clock"),I=(0,t.g2)("q-chip"),N=(0,t.g2)("q-radio"),_=(0,t.g2)("q-card"),F=(0,t.g2)("q-page");return(0,t.uX)(),(0,t.Wv)(F,{class:"col justify-center items-center"},{default:(0,t.k6)(function(){return[(0,t.Lk)("audio",n,null,512),(0,t.Lk)("audio",l,null,512),(0,t.Lk)("audio",i,null,512),(0,t.bF)(_,{class:"bg-white col-7",style:{"max-width":"600px"}},{default:(0,t.k6)(function(){return[(0,t.bF)(C,{name:a.nameModo,buttons:a.buttons},null,8,["name","buttons"]),(0,t.Lk)("div",r,[(0,t.bF)(D,{class:"q-if-outlined",modelValue:a.usucod,"onUpdate:modelValue":o[0]||(o[0]=function(o){return a.usucod=o}),autofocus:!0,"float-label":"Codigo o DNI",onKeydown:a.registraPistola},null,8,["modelValue","onKeydown"]),(0,t.bF)(L,{class:"col",type:"outlined",modelValue:a.alucod,"onUpdate:modelValue":o[1]||(o[1]=function(o){return a.alucod=o}),label:"NOMCOMP",val:"ALUCOD",options:a.alumnos,placeholder:"estudiante"},null,8,["modelValue","options"])]),(0,t.bF)(U),a.usucod||a.alucod?((0,t.uX)(),(0,t.CE)("div",u,[(0,t.bF)(E,{class:"sie-usuario-xl q-mx-xs",usucod:a.infoAlumno.USUCOD},null,8,["usucod"]),(0,t.bF)(w,null,{default:(0,t.k6)(function(){return[(0,t.bF)(S,null,{default:(0,t.k6)(function(){return[(0,t.bF)(y,{label:""},{default:(0,t.k6)(function(){return[(0,t.Lk)("div",c,[o[6]||(o[6]=(0,t.Lk)("div",{class:"text-bold"},"Apellidos y nombres:",-1)),(0,t.Lk)("span",null,(0,s.v_)(a.infoAlumno.NOMCOMP),1)])]}),_:1}),(0,t.bF)(y,{sublabel:""},{default:(0,t.k6)(function(){return[(0,t.Lk)("div",d,[o[7]||(o[7]=(0,t.Lk)("div",{class:"text-bold"},"Salón:",-1)),(0,t.Lk)("span",null,(0,s.v_)(a.dataSalones[a.infoAlumno.NEMO].NEMODES),1)]),(0,t.Lk)("div",f,[o[8]||(o[8]=(0,t.Lk)("div",{class:"text-bold"},"Tutor:",-1)),(0,t.Lk)("span",null,(0,s.v_)(a.dataSalones[a.infoAlumno.NEMO].TUTORNOM),1)])]}),_:1})]}),_:1})]}),_:1})])):(0,t.Q3)("v-if",!0),(0,t.Lk)("div",m,[(0,t.Lk)("div",h,[(0,t.Lk)("div",g,[(0,t.bF)(x,{class:"q-if-outlined col",modelValue:a.fecha,"onUpdate:modelValue":o[2]||(o[2]=function(o){return a.fecha=o}),type:"date","float-label":a.$t("fecha"),disable:a.flagModo,format:"DD/MM/YYYY"},null,8,["modelValue","float-label","disable"])]),e.configuracionAsistencia["M_HORA_INDIVIDUAL"]?((0,t.uX)(),(0,t.CE)("div",p,[(0,t.bF)(x,{class:"q-if-outlined col",modelValue:a.hora,"onUpdate:modelValue":o[3]||(o[3]=function(o){return a.hora=o}),type:"time","float-label":a.$t("hora"),disable:a.flagModo,format:"hh:mm A"},null,8,["modelValue","float-label","disable"])])):((0,t.uX)(),(0,t.CE)("fieldset",b,[(0,t.Lk)("legend",A,[(0,t.Lk)("span",null,(0,s.v_)(a.$t("hora"))+" :",1)]),(0,t.bF)(q,{class:"q-py-none"})]))]),a.flagModo?(0,t.Q3)("v-if",!0):((0,t.uX)(),(0,t.CE)("fieldset",O,[(0,t.Lk)("legend",v,[(0,t.Lk)("span",null,(0,s.v_)(a.$t("Estados"))+" :",1)]),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(a.estados,function(e){return(0,t.uX)(),(0,t.CE)(t.FK,null,["NULO"!==e.ESTADOCOD?((0,t.uX)(),(0,t.CE)("div",M,[(0,t.bF)(N,{class:"q-px-xs q-mx-xs",label:e.ESTADOETI,modelValue:a.estado,"onUpdate:modelValue":o[4]||(o[4]=function(o){return a.estado=o}),val:e.ESTADOCOD,color:"secondary",style:(0,s.Tr)([{border:"1px solid black !important","border-radius":"3px",position:"relative"},{color:e.COLORHEXT,"background-color":e.COLORHEXF}])},{default:(0,t.k6)(function(){return[a.cargado?((0,t.uX)(),(0,t.Wv)(I,{key:0,class:"chip-especial",color:"red"},{default:(0,t.k6)(function(){return[(0,t.eW)((0,s.v_)(a.conteo[e.ESTADOCOD]),1)]}),_:2},1024)):(0,t.Q3)("v-if",!0)]}),_:2},1032,["label","modelValue","val","style"])])):(0,t.Q3)("v-if",!0)],64)}),256))]))]),(0,t.Lk)("div",k,[(0,t.bF)(D,{class:"q-if-outlined col",type:"textarea",modelValue:a.observacion,"onUpdate:modelValue":o[5]||(o[5]=function(o){return a.observacion=o}),"max-height":150,rows:"3","float-label":"Observación"},null,8,["modelValue"])])]}),_:1})]}),_:1})}var D=e(76080),L=e.n(D),U=e(45254),E=e.n(U),y=(e(10239),e(50310),e(90095),e(515),e(83190),e(13715),e(6123)),S=e(80660),w=e(57668),x=e(80340),q=e(69027),I=e(30640),N=e(93616),_=e(24974),F=e(65818),Q=e(23527),V=e(982),R=e(81288),T={components:{QSelect:y.Si,sieUsuario:_.A,sieModal:I.A,qr:Q.A,sieVacio:x.A,QToggle:y.c5,QCheckbox:y.vZ,QBtnToggle:y.QL,sieSelect:N.A,QRadio:y.$,QClock:F.A,QDatetime:y.T5,QChip:y.wQ,QPage:y.Tu,QCard:y.C$,QInput:y.ie,QItemSeparator:y.CL,QItem:y.H0,QItemMain:y.mF,QItemTile:y.lp},data:function(){return{now:new Date,sie:(0,w["default"])(),estado:null,usucod:"",modRegistro:0,fecha:new Date,dataAsistencia:{},dataAlumnos:{},dataSalones:{},feriados:{},estados:{},alumnos:[],alucod:null,regAnt:!1,conteo:{},observacion:"",cargado:!1,hora:new Date,configuracionAsistencia:{},periodo:null,flagModo:!1,nameModo:"Registro de Asistencia",salida:!1}},methods:{validaRegistro:function(a){},registraPistola:function(a){13===a.which&&this.dataAlumnos[this.usucod]&&Object.keys(this.dataAlumnos[this.usucod]).length>0&&(this.alucod=this.dataAlumnos[this.usucod].ALUCOD)},obtInfoMarcada:function(){var a=this;this.cargado=!0,this.periodo=null,S.$http.get("api/HyoHorasis/consultarAsistencia",{params:{info:{ALUCOD:this.alucod,FECHA:this.fecha}}}).then(function(o){var e=o.json,t=e.json,s=e.dataAsistencia,n=e.datosPeriodo;a.regAnt=t.length>0,a.conteo=s,a.hora=new Date,a.periodo=n?n.BIMECOD:null})},grabar:function(){var a=this,o=function(){if(a.periodo){var o={alucod:a.alucod,nemo:a.infoAlumno.NEMO,fecha:a.fecha,forzar:!0,estadoI:a.estado,observacion:a.observacion,hora:a.hora};a.configuracionAsistencia["M_HORA_INDIVIDUAL"]&&(o.hora=a.hora);var e=!1===a.flagModo?"registraAsistenciaForce":"registraSalida";S.$http.get("api/HyoHorasis/".concat(e),{params:o}).then(function(o){var e=o.json;if("m0000"===e.mensaje||"m0009"===e.mensaje){(0,V["default"])(a.$t("regAsistencia."+e.mensaje)),a.$refs.audioOk.play();var t=[a.infoAlumno.ALUCOD];S.$http.get("api/HyoHorasis/enviarAlerta",{params:{alucods:t,fecha:a.fecha,hora:a.hora}}).then(function(a){a.json}),a.alucod=null,a.usucod=null,a.observacion=null,a.cargado=!1}}).catch(function(o){o&&o.error&&"m0008"===o.error.message&&(0,V["default"])(a.$t("regAsistencia."+o.error.message),"error")})}else(0,V["default"])("No hay un periodo activo para esta fecha","error")};this.regAnt?this.flagModo?o():(0,q.dialogConfirm)({title:"El estudiante registro su asistencia el dia de hoy ",message:"¿Desea reemplazar la asistencia anterior?"}).then(function(a){a&&o()}):this.flagModo?(0,V["default"])("El estudiante no tiene registro de ingreso","error"):o()},cambiarModoRegistro:function(){this.flagModo=!this.flagModo,this.nameModo=this.flagModo?"Registro de Salida":"Registro de Ingreso",this.buttons[0].icon=this.flagModo?"door_in":"door_exit",this.buttons[0].label=this.flagModo?"Ingreso":"Salida"}},computed:{isLess:function(){return(0,R.isLess)()},infoAlumno:function(){return this.dataAlumnos[this.alucod]||{}},buttons:function(){var a=[];return this.salida&&a.push({label:"Salida",icon:"door_exit",click:this.cambiarModoRegistro}),this.fecha&&this.alucod&&(this.estado&&!1===this.flagModo?a.push({label:"Grabar",icon:"save",click:this.grabar}):this.estado&&!this.estado||!0!==this.flagModo||a.push({label:"Grabar",icon:"save",click:this.grabar})),a}},watch:{alucod:function(a){a&&this.fecha&&this.obtInfoMarcada()},fecha:function(a){a&&this.alucod&&this.obtInfoMarcada()}},created:function(){var a=this;return E()(L()().m(function o(){var e;return L()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,S.$http.get("api/HyoConfigurajustificaciones/getJustificaciones",{params:{agrupado:!0}});case 1:return a.configuracionAsistencia=o.v,o.n=2,(0,R.constantes)(["A_REGISTRA_SALIDA"]);case 2:e=o.v,a.salida=e.A_REGISTRA_SALIDA,S.$http.get("api/HyoHorasis/validacionesIniciales",{params:{sortNomcomp:!0}}).then(function(o){var e=o.json;a.alumnos=e.alumnos,a.dataAlumnos={},e.alumnos.forEach(function(o){a.dataAlumnos[o.ALUCOD]={ALUCOD:o.ALUCOD,NEMO:o.NEMO,USUCOD:o.USUCOD,NOMCOMP:o.NOMCOMP},a.dataAlumnos[o.USUCOD]={ALUCOD:o.ALUCOD,NEMO:o.NEMO,USUCOD:o.USUCOD,NOMCOMP:o.NOMCOMP},a.dataAlumnos[o.DOCIDENRO]={ALUCOD:o.ALUCOD,NEMO:o.NEMO,USUCOD:o.USUCOD,NOMCOMP:o.NOMCOMP}}),a.dataSalones=e.dataSalones,a.feriados=e.feriado,a.estados=e.estados});case 3:return o.a(2)}},o)}))()}},H=e(12807);const $=(0,H.A)(T,[["render",C]]);var j=$}}]);