"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[17572],{17572:function(e,o,t){t.r(o),t.d(o,{default:function(){return Z}});var n=t(61758);function r(e,o){var t=(0,n.g2)("verLog");return(0,n.uX)(),(0,n.Wv)(t,{onExportarText:e.exportarText,onExportarExcel:e.exportarExcel,onExportarArchivo:e.exportarArchivo},null,8,["onExportarText","onExportarExcel","onExportarArchivo"])}var a=t(76080),s=t.n(a),i=t(45254),c=t.n(i),l=(t(34634),t(30683),t(52133),t(10239),t(23513),t(50310),t(6724),t(83190),t(88390),t(8445)),d=t.n(l),u=t(58790),p={class:"row items-center no-wrap"},m={class:"col"},f={class:"text-h6"},v={class:"row q-ma-xs q-col-gutter-sm"},h={class:"col-xs-12"},g={class:"col-xs-12",style:{padding:"0",margin:"0"}},x={class:"row q-ma-xs q-col-gutter-sm",style:{overflow:"hidden"}},w={class:"col-xs-12",style:{overflow:"hidden"}},A={class:"row q-ma-xs q-col-gutter-sm",style:{overflow:"hidden"}},b={class:"col-xs-12",style:{overflow:"hidden"}},k=["onClick"],L={key:0,class:"col-xs-12"},E={key:1,class:"col-xs-12"},C={class:"row q-ma-xs q-col-gutter-sm"},T={class:"col-xs-12"};function D(e,o){var t=(0,n.g2)("crearBotones"),r=(0,n.g2)("q-card-section"),a=(0,n.g2)("q-separator"),s=(0,n.g2)("q-option-group"),i=(0,n.g2)("q-icon"),c=(0,n.g2)("q-tree"),l=(0,n.g2)("q-input"),D=(0,n.g2)("Qsplitter"),y=(0,n.g2)("q-btn"),S=(0,n.g2)("q-dialog"),V=(0,n.g2)("q-card");return(0,n.uX)(),(0,n.Wv)(V,{class:"layout-v1 my-card",flat:"",bordered:""},{default:(0,n.k6)(function(){return[(0,n.bF)(r,null,{default:(0,n.k6)(function(){return[(0,n.Lk)("div",p,[(0,n.Lk)("div",m,[(0,n.Lk)("div",f,(0,u.v_)(e.title),1)]),(0,n.bF)(t,{buttons:e.botones,nivelAcceso:e.nivelAcceso,componente:e.componente},null,8,["buttons","nivelAcceso","componente"])])]}),_:1}),(0,n.bF)(a),(0,n.bF)(r,null,{default:(0,n.k6)(function(){return[(0,n.Lk)("div",v,[(0,n.Lk)("div",h,[(0,n.bF)(s,{options:e.options.optionsLogs,modelValue:e.models.option,"onUpdate:modelValue":o[0]||(o[0]=function(o){return e.models.option=o}),inline:"",onInput:e.getCarpetasLogs},null,8,["options","modelValue","onInput"])]),(0,n.Lk)("div",g,[(0,n.bF)(r,null,{default:(0,n.k6)(function(){return[(0,n.bF)(D,{modelValue:e.splitterModel,"onUpdate:modelValue":o[3]||(o[3]=function(o){return e.splitterModel=o}),limits:[0,50],style:{padding:"0",overflow:"hidden",height:"calc(100vh - 250px)",width:"100%",border:"0.05rem solid #000"}},{before:(0,n.k6)(function(){return[(0,n.Lk)("div",x,[(0,n.Lk)("div",w,[(0,n.Lk)("div",A,[(0,n.Lk)("div",b,[(0,n.bF)(c,{class:"tree-logs",nodes:e.options.nodos,"node-key":"label","text-color":"primary","selected-color":"primary",ticked:e.models.ticked,"onUpdate:ticked":o[1]||(o[1]=function(o){return e.models.ticked=o})},{"header-a":(0,n.k6)(function(o){return[(0,n.bF)(i,{class:"fontSizeIcon",name:o.node.icon},null,8,["name"]),(0,n.Lk)("a",{style:{"text-decoration":"none"},href:"javascript:void(0)",onClick:function(t){return e.getLog(o)}},(0,u.v_)(o.node.file),9,k)]}),_:1},8,["nodes","ticked"])])])])])]}),after:(0,n.k6)(function(){return[e.models.viewArchivo?((0,n.uX)(),(0,n.CE)("div",L,[(0,n.bF)(l,{class:"txtbanco",v:"",type:"textarea",modelValue:e.models.contenido,"onUpdate:modelValue":o[2]||(o[2]=function(o){return e.models.contenido=o}),rows:"30",wrap:"off",readonly:""},null,8,["modelValue"])])):(0,n.Q3)("v-if",!0),e.models.viewArchivo?(0,n.Q3)("v-if",!0):((0,n.uX)(),(0,n.CE)("div",E)),o[7]||(o[7]=(0,n.Lk)("div",{class:"text-h1"},"VisualizaciÃ³n para el tipo de archivo no disponible",-1))]}),_:1},8,["modelValue"])]}),_:1})])])]}),_:1}),(0,n.bF)(S,{modelValue:e.modals.descarga,"onUpdate:modelValue":o[6]||(o[6]=function(o){return e.modals.descarga=o}),"stack-buttons":""},{title:(0,n.k6)(function(){return d()(o[8]||(o[8]=[(0,n.Lk)("span",null,"Tipo de Archivo",-1)]))}),body:(0,n.k6)(function(){return[(0,n.Lk)("div",C,[(0,n.Lk)("div",T,[(0,n.bF)(s,{inline:"",type:"radio",modelValue:e.models.tipoDescargar,"onUpdate:modelValue":o[4]||(o[4]=function(o){return e.models.tipoDescargar=o}),options:e.options.descarga},null,8,["modelValue","options"])])])]}),buttons:(0,n.k6)(function(t){return[(0,n.bF)(y,{onClick:o[5]||(o[5]=function(o){return e.descargar(e.models.tipoDescargar)}),"text-color":"white",color:"primary",icon:"file_download",label:"Descargar",size:"sm",autogrow:""})]}),_:1},8,["modelValue"])]}),_:1})}t(39866),t(62692);var y=t(88567),S=t(95718),V=t(53380),O=t(54489),Q=t(12143),_=t(80660),q=t(36408),F=t(27560),R=t(96330),I=t(75053),X=t(64208),$=t(6123),U=t(52220),B=t(95477),G=t(3112),M=t(41615),N=t(64303),W=t(59043),z=t(72029),H=(t(98169),{emits:["exportarExcel"],components:{headerGrid:R.A,sieGrid:q.A,footerGrid:F.A,QCard:y.A,QCardSection:S.A,QSelect:O.S,QSeparator:V.A,sieModal:I.A,QInput:X.A,QDate:Q.A,QPopupProxy:B.A,QDatetime:$.T5,QCheckbox:G.A,crearBotones:N.A,QTree:U.A,sieTree:W.A,QDialog:$.OQ,QOptionGroup:$.EX,Qsplitter:z.A,QIcon:$.bP,QBtn:$.Il},props:{carpeta:{type:[String],default:"logs"},title:{type:[String],default:"Logs del Sistema"}},data:function(){return{componente:"Logs",botones:[],nivelAcceso:3,tiposArchivos:{TEXTO:"txt",EXCEL:"xlsx"},icons:{FILE:"file_document",FOLDER:"folder",DOWNLOAD:"file_download"},models:{tipoLog:1,contentLog:"",ruta:"",filename:"",selected:[],expanded:[],ticked:[],tipoDescargar:"txt",contenido:"",extensionesView:["text","txt","TEXT","TXT"],viewArchivo:!1,option:1,carpetas:{1:"logs",2:"BANCOS"},archivoSeleccionado:""},maps:{rutas:{}},modals:{descarga:!1},options:{tipoLogs:[{label:"Deuda",value:1}],descarga:[{label:"Texto",value:"txt"},{label:"Excel",value:"xlsx"},{label:"Archivo",value:"file"}],nodos:[],optionsLogs:[{label:"Logs",value:1},{label:"Banco",value:2},{label:"Correos",value:3}]},show:{dowload:!1},splitterModel:30}},computed:{},methods:{crearBotones:function(){this.botones=[{label:"download",click:this.openModalDownLoad,minAcceso:M["default"].LECTURA_ESCRITURA,icon:"file_download"}]},openModalDownLoad:function(){this.modals.descarga=!0},prepararDescarga:function(e){this.modals.descarga=!0,this.models.ruta=this.maps.rutas[e.node.file],this.models.filename=e.node.file},descargarTxt:function(){var e=this;return c()(s()().m(function o(){var t;return s()().w(function(o){while(1)switch(o.n){case 0:t='{"name":"'.concat(e.models.ruta,'","ruta":"').concat(e.models.ruta,'","tipo":"').concat(e.tiposArchivos.TEXTO,'"}'),M["default"].DESCARGAR_ARCHIVO(t),e.modals.descarga=!1;case 1:return o.a(2)}},o)}))()},getLog:function(e){var o=this;return c()(s()().m(function t(){var n,r;return s()().w(function(t){while(1)switch(t.n){case 0:if(o.models.archivoSeleccionado=e.key,n=e.key.split(".").at(-1),o.models.viewArchivo=o.models.extensionesView.includes(n),o.models.ruta=o.maps.rutas[e.node.file],o.models.filename=e.node.file,!o.models.viewArchivo){t.n=2;break}return t.n=1,_.$http.get("api/TesoreriaServiciosController/getLog",{params:{datos:{archivo:o.models.ruta,sinDominio:e.node.sinDominio}}});case 1:r=t.v,o.models.contenido="Archivo: ".concat(o.models.archivoSeleccionado,"\n").concat(r.data.texto);case 2:o.crearBotones();case 3:return t.a(2)}},t)}))()},descargarExcel:function(){var e=this;return c()(s()().m(function o(){var t;return s()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,_.$http.get("api/TesoreriaServiciosController/getLog",{params:{datos:{archivo:e.models.ruta}}});case 1:if(t=o.v,e.models.contentLog=t.data.texto,0!==e.models.contentLog.length){o.n=2;break}return o.a(2,e.$alert("No se encontraron datos para exportar","warning"));case 2:e.$emit("exportarExcel",e.models),e.modals.descarga=!1;case 3:return o.a(2)}},o)}))()},descargarArchivo:function(){var e=this;return c()(s()().m(function o(){var t;return s()().w(function(o){while(1)switch(o.n){case 0:t='{"name":"'.concat(e.models.ruta,'","ruta":"').concat(e.models.ruta,'","tipo":"').concat(e.tiposArchivos.TEXTO,'"}'),M["default"].DESCARGAR_ARCHIVO(t),e.modals.descarga=!1;case 1:return o.a(2)}},o)}))()},descargar:function(e){var o=this;return c()(s()().m(function t(){var n;return s()().w(function(t){while(1)switch(t.n){case 0:return n={text:o.descargarTxt,xlxs:o.descargarExcel,file:o.descargarArchivo},t.a(2,n[e]()||o.descargarArchivo())}},t)}))()},crearNodos:function(e){var o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=[];for(var n in e){var r={};n.includes(".")?(r.label=n,r.file=n,r.header="a",r.icon=this.icons.FILE,r.dowload=this.icons.DOWNLOAD,this.maps.rutas[n]=e[n],r.sinDominio=o,t.push(r)):(r.label=n,r.icon=this.icons.FOLDER,r.tickable=!1,r.children=this.crearNodos(e[n],o),r.sinDominio=o,t.push(r))}return t},getCarpetasLogs:function(){var e=this;return c()(s()().m(function o(){return s()().w(function(o){while(1)switch(o.n){case 0:e.$nextTick(c()(s()().m(function o(){var t,n,r,a,i;return s()().w(function(o){while(1)switch(o.p=o.n){case 0:if(o.p=0,t={path:e.models.carpetas[e.models.option]},t.path){o.n=1;break}return n=e.crearNodos(M["default"].ARBOL_LOGS_CORREO,!0),o.a(2,e.options.nodos=n);case 1:return o.n=2,_.$http.get("api/TesoreriaServiciosController/getCarpetasLogs",{params:{datos:t}});case 2:r=o.v,a=r.data.arbol,i=e.crearNodos(a),e.options.nodos=i,o.n=4;break;case 3:o.p=3,o.v,e.options.nodos=[];case 4:return o.a(2)}},o,null,[[0,3]])})));case 1:return o.a(2)}},o)}))()}},beforeMount:function(){},created:function(){this.getCarpetasLogs()},mounted:function(){}}),P=t(12807);const j=(0,P.A)(H,[["render",D]]);var J=j,K={components:{verLog:J},data:function(){return{}},computed:{},methods:{exportarText:function(){},exportarExcel:function(e){var o=this;return c()(s()().m(function t(){var n,r,a,i,c,l,d;return s()().w(function(t){while(1)switch(t.n){case 0:return n=e.contentLog.split("\n"),r=n.at(0),a=n.slice(1),i=r.split("|"),c=a.map(function(e){var o=e.split("|"),t={};for(var n in o)t[i[n]]=o[n];return t}),t.n=1,_.$http.post("api/TesoreriaServiciosController/postExportarExcel",{datos:{data:c,filename:e.filename}});case 1:l=t.v,d='{"name":"'.concat(l.ruta,'","ruta":"').concat(l.ruta,'","tipo":"xlsx"}'),M["default"].DESCARGAR_ARCHIVO(d),o.$alert("Archivo Excportado Satisfactoriamente","success");case 2:return t.a(2)}},t)}))()},exportarArchivo:function(){}},beforeMount:function(){},created:function(){var e=this;return c()(s()().m(function o(){var t;return s()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,_.$http.get("api/TesoreriaServiciosController/getVerificarUserAdmin",{params:{params:{sieweb:!0}}});case 1:t=o.v,t||e.$router.push({name:"tesoreria.home"});case 2:return o.a(2)}},o)}))()},mounted:function(){}};const Y=(0,P.A)(K,[["render",r]]);var Z=Y}}]);