"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[88689],{88689:function(e,r,n){n.r(r),n.d(r,{default:function(){return U}});var o=n(61758),a={class:"row q-col-gutter-sm"},t={class:"col-xs-12"},i={class:"col-xs-12"},s={class:"row q-pa-sm q-col-gutter-sm"},u={class:"col-xs-12 col-sm-6"},l={class:"col-xs-12 col-sm-6"},c={class:"col-xs-12 col-sm-6"};function m(e,r){var n=this,m=(0,o.g2)("header-btn"),d=(0,o.g2)("sie-table"),f=(0,o.g2)("q-card-section"),p=(0,o.g2)("q-card"),w=(0,o.g2)("q-select"),h=(0,o.g2)("q-input"),b=(0,o.g2)("q-form"),O=(0,o.g2)("sie-modal"),g=(0,o.g2)("q-page");return(0,o.uX)(),(0,o.Wv)(g,{class:"q-pa-sm sie-flat"},{default:(0,o.k6)(function(){return[(0,o.bF)(p,{flat:"",bordered:""},{default:(0,o.k6)(function(){return[(0,o.bF)(f,null,{default:(0,o.k6)(function(){return[(0,o.Lk)("div",a,[(0,o.Lk)("div",t,[(0,o.bF)(m,{name:"Configurar Aprobador",buttons:e.buttons},null,8,["buttons"])]),(0,o.Lk)("div",i,[(0,o.bF)(d,{type:"normal",data:e.rows,columns:e.fields,config:e.config,selection:"single","save-cells":"",ref:"tablePermisoUsuario",onRowSelected:e.rowSelectPermisoUsuario,css:"height:calc(100vh - 170px)",context:n},null,8,["data","columns","config","onRowSelected"])])])]}),_:1})]}),_:1}),(0,o.bF)(O,{esc:"","esc-click":"",modelValue:e.openAdd,"onUpdate:modelValue":r[3]||(r[3]=function(r){return e.openAdd=r}),css:{width:"500px"},title:"create"===e.action?"Agregar Aprobador":"Modificar Aprobador",onSubmit:e.saveAcccion},{default:(0,o.k6)(function(){return[(0,o.bF)(b,{ref:"refForm"},{default:(0,o.k6)(function(){return[(0,o.Lk)("div",s,[(0,o.Lk)("div",u,[(0,o.bF)(w,{"emit-value":"",readonly:"update"===e.action,modelValue:e.form.ID_RESPONSABLE,"onUpdate:modelValue":r[0]||(r[0]=function(r){return e.form.ID_RESPONSABLE=r}),options:e.responsables,"option-value":"ID_PERSONA","option-label":"NOMCOMP",label:"Responsable *",rules:[e.required]},null,8,["readonly","modelValue","options","rules"])]),(0,o.Lk)("div",l,[(0,o.bF)(w,{"emit-value":"",readonly:"update"===e.action,modelValue:e.form.MONCOD,"onUpdate:modelValue":r[1]||(r[1]=function(r){return e.form.MONCOD=r}),options:e.monedas,"option-value":"MONCOD","option-label":"MONNOM",label:"Moneda *",rules:[e.required]},null,8,["readonly","modelValue","options","rules"])]),(0,o.Lk)("div",c,[(0,o.bF)(h,{modelValue:e.form.LIMITE,"onUpdate:modelValue":r[2]||(r[2]=function(r){return e.form.LIMITE=r}),type:"number",label:"Límite *",rules:[e.required]},null,8,["modelValue","rules"])])])]}),_:1},512)]}),_:1},8,["modelValue","title","onSubmit"])]}),_:1})}var d=n(76080),f=n.n(d),p=n(45254),w=n.n(p),h=(n(89571),n(11777),n(6123)),b=n(43136),O={data:function(){return{config:{ID_RESPONSABLE:{component:"select",options:[],optionValue:"ID_PERSONA",optionLabel:"NOMCOMP",edit:!1},MONCOD:{component:"select",options:[],optionValue:"MONCOD",optionLabel:"MONSIG",edit:!1},LIMITE:{renderHtml:function(e,r){return r("span",{},(0,b.format)(e.LIMITE||0))}},ACTION:{component:"button",icon:["edit as editar","delete as eliminar"],editar:function(e,r){var n=this;return w()(f()().m(function e(){return f()().w(function(e){while(1)switch(e.n){case 0:return n.rowPermisoUsuario=r,e.n=1,n.openActualizar();case 1:return e.a(2)}},e)}))()},eliminar:function(e,r){var n=this;return w()(f()().m(function e(){return f()().w(function(e){while(1)switch(e.n){case 0:return n.rowPermisoUsuario=r,e.n=1,n.deletePermisoUsuario();case 1:return e.a(2)}},e)}))()},tooltip:{editar:"Editar",eliminar:"Eliminar"},permisos:{editar:">1",eliminar:"===3"},flat:!0,dense:!0}},rows:[],fields:[{name:"ID_RESPONSABLE",label:"Responsable",field:"ID_RESPONSABLE",align:"left",sortable:!0},{name:"MONCOD",label:"Moneda",field:"MONCOD",align:"center",sortable:!0},{name:"LIMITE",label:"Límite",field:"LIMITE",align:"right",sortable:!0},{name:"ACTION",label:"Acción",field:"ACTION",align:"center",width:80}]}}},g=n(39893),P=n(81288),v=n(2739),E=n(9736),I=n(5215),A=n(88567),M=n(95718),N={mixins:[O],components:{QForm:v.A,QInput:E.A,QSelect:I.A,QCard:A.A,QCardSection:M.A,QPage:h.Tu},data:function(){return{required:g.require,buttons:[{label:"Agregar",icon:"plus",permiso:">1",click:this.openAgregar}],openAdd:!1,action:"create",rowPermisoUsuario:null,form:{ID_RESPONSABLE:null,MONCOD:null,LIMITE:null},responsables:[],monedas:[]}},methods:{openAgregar:function(){this.action="create",this.rowPermisoUsuario=null,(0,P.clear)(this.form),this.openAdd=!0},openActualizar:function(){this.rowPermisoUsuario?(this.action="update",this.form.ID_RESPONSABLE=this.rowPermisoUsuario.ID_RESPONSABLE,this.form.MONCOD=this.rowPermisoUsuario.MONCOD,this.form.LIMITE=this.rowPermisoUsuario.LIMITE,this.openAdd=!0):this.$notify("Selecciona un registro","info")},saveAcccion:function(){var e=this;return w()(f()().m(function r(){var n,o,a;return f()().w(function(r){while(1)switch(r.n){case 0:return r.n=1,e.$refs.refForm.validate();case 1:if(n=r.v,n){r.n=2;break}return r.a(2);case 2:if("create"!==e.action){r.n=4;break}return r.n=3,e.$confirmar("El registro se creará ¿Desea continuar?","info");case 3:o=r.v,o&&e.createPermisoUsuario(),r.n=6;break;case 4:return r.n=5,e.$confirmar("El registro se modificará ¿Desea continuar?","info");case 5:a=r.v,a&&e.updatePermisoUsuario();case 6:return r.a(2)}},r)}))()},rowSelectPermisoUsuario:function(e,r){this.rowPermisoUsuario=r},createPermisoUsuario:function(){var e=this;return w()(f()().m(function r(){var n,o,a,t;return f()().w(function(r){while(1)switch(r.p=r.n){case 0:return r.p=0,r.n=1,e.$http.post("api/PermisoUsuarioController/addPermisoUsuario",{data:e.form});case 1:n=r.v,o=n.message,a={ID_RESPONSABLE:e.form.ID_RESPONSABLE,MONCOD:e.form.MONCOD,LIMITE:e.form.LIMITE},e.rows.unshift(a),e.openAdd=!1,e.$notify(o,"success"),r.n=3;break;case 2:r.p=2,t=r.v,e.$notify(t.message,"warning");case 3:return r.a(2)}},r,null,[[0,2]])}))()},readPermisoUsuario:function(){var e=this;return w()(f()().m(function r(){var n,o;return f()().w(function(r){while(1)switch(r.p=r.n){case 0:return r.p=0,r.n=1,e.$http.get("api/PermisoUsuarioController/getPermisoUsuario",{params:{}});case 1:n=r.v,e.rows=n,r.n=3;break;case 2:r.p=2,o=r.v,e.$notify(o.message,"warning");case 3:return r.a(2)}},r,null,[[0,2]])}))()},readResponsables:function(){var e=this;return w()(f()().m(function r(){var n;return f()().w(function(r){while(1)switch(r.n){case 0:return r.n=1,e.$http.get("api/personaController/getPersonasPerfil",{params:{params:{id_perfil:8}}});case 1:n=r.v,e.config.ID_RESPONSABLE.options=n,e.responsables=n;case 2:return r.a(2)}},r)}))()},readMoneda:function(){var e=this;return w()(f()().m(function r(){var n,o;return f()().w(function(r){while(1)switch(r.p=r.n){case 0:return r.p=0,r.n=1,e.$http.get("api/HyoMonedas/readMoneda");case 1:n=r.v,e.monedas=n,e.config.MONCOD.options=n,r.n=3;break;case 2:r.p=2,o=r.v,e.$notify(o.message,"warning");case 3:return r.a(2)}},r,null,[[0,2]])}))()},deletePermisoUsuario:function(){var e=this;return w()(f()().m(function r(){var n,o,a,t;return f()().w(function(r){while(1)switch(r.p=r.n){case 0:if(e.rowPermisoUsuario){r.n=1;break}e.$notify("Selecciona un registro","info"),r.n=6;break;case 1:return r.n=2,e.$confirmar("¿Estás seguro de eliminar el registro?","delete");case 2:if(n=r.v,!n){r.n=6;break}return r.p=3,r.n=4,e.$http.delete("api/PermisoUsuarioController/deletePermisoUsuario",{params:{ID_RESPONSABLE:e.rowPermisoUsuario.ID_RESPONSABLE,MONCOD:e.rowPermisoUsuario.MONCOD}});case 4:o=r.v,a=o.message,e.rows.splice(e.rows.indexOf(e.rowPermisoUsuario),1),e.rowPermisoUsuario=null,e.$notify(a,"success"),r.n=6;break;case 5:r.p=5,t=r.v,e.$notify(t.message,"warning");case 6:return r.a(2)}},r,null,[[3,5]])}))()},updatePermisoUsuario:function(){var e=this;return w()(f()().m(function r(){var n,o,a,t;return f()().w(function(r){while(1)switch(r.p=r.n){case 0:return r.p=0,n=e.$refs.tablePermisoUsuario,r.n=1,e.$http.post("api/PermisoUsuarioController/updatePermisoUsuario",{ID_RESPONSABLE:e.form.ID_RESPONSABLE,MONCOD:e.form.MONCOD,params:{LIMITE:Number(e.form.LIMITE)}});case 1:o=r.v,a=o.message,e.openAdd=!1,n.updateRow(e.rowPermisoUsuario,e.form),e.$notify(a,"success"),r.n=3;break;case 2:r.p=2,t=r.v,e.$notify(t.message,"warning");case 3:return r.a(2)}},r,null,[[0,2]])}))()}},created:function(){var e=this;return w()(f()().m(function r(){var n;return f()().w(function(r){while(1)switch(r.p=r.n){case 0:return r.p=0,r.n=1,e.readPermisoUsuario();case 1:return r.n=2,e.readResponsables();case 2:return r.n=3,e.readMoneda();case 3:r.n=5;break;case 4:r.p=4,n=r.v,e.$notify(n.message,"warning");case 5:return r.a(2)}},r,null,[[0,4]])}))()}},S=n(12807);const L=(0,S.A)(N,[["render",m]]);var U=L}}]);