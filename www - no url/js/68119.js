"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[68119],{68119:function(e,a,t){t.r(a),t.d(a,{default:function(){return fe}});var o=t(61758),n=t(29104),l=t(58790),r={class:"col-xs-12"},i={class:"row"},c={class:"col-xs-12 col-sm-3 q-pa-xs"},s={class:"col-xs-12 col-sm-3 q-pa-xs"},u={class:"col-xs-12 col-sm-3 q-pa-xs"},d={class:"col-xs-12 col-sm-3 q-pa-xs"},O={class:"col-xs-12 col-sm-3 q-pa-xs"},N={class:"col-xs-12 col-sm-3 q-pa-xs"},A={class:"col-xs-12 col-sm-3 q-pa-xs"},C={class:"col-xs-12 col-sm-3 q-pa-xs"},m={class:"col-xs-12 col-sm-3 q-pa-xs"},p={class:"col-xs-12 col-sm-3 q-pa-xs"},E={class:"col-xs-12 col-sm-3 q-pa-xs"},b={class:"col-xs-12 col-sm-3 q-pa-xs"},f={class:"col-xs-12 col-sm-3 q-pa-xs"},M={class:"col-xs-12 col-sm-3 q-pa-xs"},T={class:"col-xs-12 col-sm-3 q-pa-xs"},h={key:0,class:"col-xs-12 col-sm-3 q-pa-xs"},I={class:"col-xs-6 q-pa-xs"},D={key:1,class:"col-xs-3 q-pa-xs"},g={key:2,class:"col-xs-3 q-pa-xs"},U={key:0},P={class:"column ptotal"};function v(e,a){var t=(0,o.g2)("q-page-header"),v=(0,o.g2)("q-separator"),R=(0,o.g2)("q-select"),L=(0,o.g2)("q-icon"),S=(0,o.g2)("q-input"),_=(0,o.g2)("q-card-main"),G=(0,o.g2)("q-card"),F=(0,o.g2)("q-date"),V=(0,o.g2)("q-popup-proxy"),w=(0,o.g2)("q-option-group"),B=(0,o.g2)("sie-grid"),k=(0,o.g2)("q-card-section"),x=(0,o.g2)("consultarComprobante"),y=(0,o.g2)("box-cuotas");return(0,o.uX)(),(0,o.Wv)(G,{class:"layout-v1 my-card",flat:"",bordered:""},{default:(0,o.k6)(function(){return[(0,o.bF)(t,{botones:e.pageHeader.botones,title:e.pageHeader.title,tabs:e.pageHeader.tabs,useTab:"",nivelAcceso:e.pageHeader.nivelAcceso,componente:e.pageHeader.componente,onActionTab:e.actionTab},null,8,["botones","title","tabs","nivelAcceso","componente","onActionTab"]),e.pageHeader.tabActive===e.pageHeader.tabsKeys.registro?((0,o.uX)(),(0,o.Wv)(v,{key:0})):(0,o.Q3)("v-if",!0),e.pageHeader.tabActive===e.pageHeader.tabsKeys.registro?((0,o.uX)(),(0,o.Wv)(k,{key:1},{default:(0,o.k6)(function(){return[(0,o.bF)(G,{class:"col-12 q-card-legend",title:"Comprobante Origen"},{default:(0,o.k6)(function(){return[(0,o.bF)(_,{class:"row"},{default:(0,o.k6)(function(){return[(0,o.Lk)("div",r,[(0,o.Lk)("div",i,[(0,o.Lk)("div",c,[(0,o.bF)(R,{class:"truncate-label",modelValue:e.NUMTAL,"onUpdate:modelValue":a[0]||(a[0]=function(a){return e.NUMTAL=a}),"option-value":"NUMTAL","option-label":"TALDES",options:e.talonarios,label:"Talonario",onInput:e.buscarDocumento},null,8,["modelValue","options","onInput"])]),(0,o.Lk)("div",s,[(0,o.bF)(S,{modelValue:e.NUMPAG,"onUpdate:modelValue":a[1]||(a[1]=function(a){return e.NUMPAG=a}),label:"Nro. Comprobante",onKeyup:(0,n.jR)(e.buscarDocumento,["enter"])},{default:(0,o.k6)(function(){return[(0,o.bF)(L,{class:"cursor-pointer",name:"search",style:{"font-size":"2rem"},color:"primary",onClick:e.buscarDocumento},null,8,["onClick"])]}),_:1},8,["modelValue","onKeyup"])]),(0,o.Lk)("div",u,[(0,o.bF)(S,{modelValue:e.cabecera.ESTADO,"onUpdate:modelValue":a[2]||(a[2]=function(a){return e.cabecera.ESTADO=a}),readonly:"",label:"Estado"},null,8,["modelValue"])]),(0,o.Lk)("div",d,[(0,o.bF)(S,{modelValue:e.cabecera.TIPO_OPERACION,"onUpdate:modelValue":a[3]||(a[3]=function(a){return e.cabecera.TIPO_OPERACION=a}),readonly:"",label:"Tipo de operación"},null,8,["modelValue"])]),(0,o.Lk)("div",O,[(0,o.bF)(S,{modelValue:e.cabecera.CODIGO,"onUpdate:modelValue":a[4]||(a[4]=function(a){return e.cabecera.CODIGO=a}),readonly:"",label:"Código"},null,8,["modelValue"])]),(0,o.Lk)("div",N,[(0,o.bF)(S,{modelValue:e.cabecera.CLIENTE,"onUpdate:modelValue":a[5]||(a[5]=function(a){return e.cabecera.CLIENTE=a}),readonly:"",label:"Girado a"},null,8,["modelValue"])]),(0,o.Lk)("div",A,[(0,o.bF)(S,{modelValue:e.cabecera.NOMBRE,"onUpdate:modelValue":a[6]||(a[6]=function(a){return e.cabecera.NOMBRE=a}),readonly:"",label:"Nombre"},null,8,["modelValue"])]),(0,o.Lk)("div",C,[(0,o.bF)(S,{modelValue:e.cabecera.USUARIO,"onUpdate:modelValue":a[7]||(a[7]=function(a){return e.cabecera.USUARIO=a}),readonly:"",label:"Usuario"},null,8,["modelValue"])]),(0,o.Lk)("div",m,[(0,o.bF)(S,{modelValue:e.cabecera.FECEMI,"onUpdate:modelValue":a[8]||(a[8]=function(a){return e.cabecera.FECEMI=a}),readonly:"",label:"Fecha de Emisión"},null,8,["modelValue"])]),(0,o.Lk)("div",p,[(0,o.bF)(S,{modelValue:e.cabecera.FECPAG,"onUpdate:modelValue":a[9]||(a[9]=function(a){return e.cabecera.FECPAG=a}),readonly:"",label:"Fecha de Pago"},null,8,["modelValue"])]),(0,o.Lk)("div",E,[(0,o.bF)(S,{modelValue:e.cabecera.MONEDA,"onUpdate:modelValue":a[10]||(a[10]=function(a){return e.cabecera.MONEDA=a}),readonly:"",label:"Moneda"},null,8,["modelValue"])]),(0,o.Lk)("div",b,[(0,o.bF)(S,{modelValue:e.cabecera.ORIGEN,"onUpdate:modelValue":a[11]||(a[11]=function(a){return e.cabecera.ORIGEN=a}),readonly:"",label:"Origen"},null,8,["modelValue"])])])])]}),_:1})]}),_:1}),(0,o.bF)(G,{class:"col-12 q-card-legend q-mt-lg",title:"Nota de "+e.tituloNota},{default:(0,o.k6)(function(){return[(0,o.bF)(_,{class:"row"},{default:(0,o.k6)(function(){return[(0,o.Lk)("div",f,[(0,o.bF)(R,{class:"truncate-label",modelValue:e.notaCredito.NUMTAL,"onUpdate:modelValue":a[12]||(a[12]=function(a){return e.notaCredito.NUMTAL=a}),"option-value":"NUMTAL","option-label":"TALDES",options:e.talonarioNc,label:"Talonario"},null,8,["modelValue","options"])]),(0,o.Lk)("div",M,[(0,o.bF)(S,{label:"Fec. Emisión",debounce:"500",maxlength:"10",format:"##/##/####",modelValue:e.fecemi,"onUpdate:modelValue":a[15]||(a[15]=function(a){return e.fecemi=a}),mask:"##/##/####",readonly:""},{append:(0,o.k6)(function(){return[(0,o.bF)(L,{class:"cursor-pointer",name:"date_range"},{default:(0,o.k6)(function(){return[(0,o.bF)(V,{ref:"qDateProxy1","transition-show":"scale","transition-hide":"scale"},{default:(0,o.k6)(function(){return[(0,o.bF)(F,{mask:"DD/MM/YYYY",modelValue:e.fecemi,"onUpdate:modelValue":a[13]||(a[13]=function(a){return e.fecemi=a}),onInput:a[14]||(a[14]=function(a){return e.closeModalCalendar("qDateProxy1")})},null,8,["modelValue"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])]),(0,o.Lk)("div",T,[(0,o.bF)(R,{class:"truncate-label",modelValue:e.notaCredito.MOTNOTA,"onUpdate:modelValue":a[16]||(a[16]=function(a){return e.notaCredito.MOTNOTA=a}),"option-value":"CLAVE","option-label":"VALOR",options:e.motivos,label:"Motivo"},null,8,["modelValue","options"])]),e.showOrigen?((0,o.uX)(),(0,o.CE)("div",h,[(0,o.bF)(w,{name:"Origen",color:"purple",options:e.origenes,inline:"",modelValue:e.selectOrigen,"onUpdate:modelValue":a[17]||(a[17]=function(a){return e.selectOrigen=a}),onInput:e.changeOrigen},null,8,["options","modelValue","onInput"])])):(0,o.Q3)("v-if",!0),(0,o.Lk)("div",I,[(0,o.bF)(S,{modelValue:e.notaCredito.OBSERVACION,"onUpdate:modelValue":a[18]||(a[18]=function(a){return e.notaCredito.OBSERVACION=a}),type:"text",label:"Observación",maxlength:e.sizeObs},null,8,["modelValue","maxlength"])]),e.showOrigen&&e.showCtaBanco?((0,o.uX)(),(0,o.CE)("div",D,[(0,o.bF)(R,{class:"truncate-label",modelValue:e.notaCredito.NUMCTA,"onUpdate:modelValue":a[19]||(a[19]=function(a){return e.notaCredito.NUMCTA=a}),"option-value":"NUMCTA","option-label":"CTACTE",options:e.ctaBancos,label:"Cta. Bancaria"},null,8,["modelValue","options"])])):(0,o.Q3)("v-if",!0),e.showOrigen&&e.showCtaBanco?((0,o.uX)(),(0,o.CE)("div",g,[(0,o.bF)(S,{modelValue:e.notaCredito.NUMOPE,"onUpdate:modelValue":a[20]||(a[20]=function(a){return e.notaCredito.NUMOPE=a}),type:"text",label:"Nro. Operación/Cheque",maxlength:e.sizeObs},null,8,["modelValue","maxlength"])])):(0,o.Q3)("v-if",!0)]}),_:1})]}),_:1},8,["title"]),e.pageHeader.tabActive===e.pageHeader.tabsKeys.registro?((0,o.uX)(),(0,o.CE)("div",U,[(0,o.bF)(B,{class:"q-mt-xs ag-theme-balham",columnDefs:e.columnDefs,rowData:e.rowData,onCellValueChanged:e.editing,rowClassRules:e.rowClassRules,frameworkComponents:e.frameworkComponents,onGridReady:e.onGridReady,style:{width:"100wv",height:"calc(100vh - 580px)"},singleClickEdit:!0,stopEditingWhenGridLosesFocus:!0,groupUseEntireRow:!0,groupIncludeFooter:!0},null,8,["columnDefs","rowData","onCellValueChanged","rowClassRules","frameworkComponents","onGridReady"]),(0,o.Lk)("p",P,"Total a Pagar: "+(0,l.v_)(e.cabecera.MONSIG)+": "+(0,l.v_)(e.total),1)])):(0,o.Q3)("v-if",!0)]}),_:1})):(0,o.Q3)("v-if",!0),(0,o.bo)((0,o.bF)(x,{ref:e.pageHeader.tabsKeys.consultar,cp:"notaDebito",lessHeight:"360",tab:""},null,512),[[n.aG,e.pageHeader.tabActive===e.pageHeader.tabsKeys.consultar]]),e.openModalCuotas?((0,o.uX)(),(0,o.Wv)(y,{key:2,modelValue:e.openModalCuotas,"onUpdate:modelValue":a[21]||(a[21]=function(a){return e.openModalCuotas=a}),onSubmit:e.guardarCuotasFactura,datos:e.datosFactura,numtal:e.NUMTAL,numpag:e.NUMPAG},null,8,["modelValue","onSubmit","datos","numtal","numpag"])):(0,o.Q3)("v-if",!0)]}),_:1})}var R=t(41562),L=t.n(R),S=t(57008),_=t.n(S),G=t(99550),F=t.n(G),V=t(8445),w=t.n(V),B=t(76080),k=t.n(B),x=t(45254),y=t.n(x),q=(t(30683),t(71225),t(39866),t(52133),t(10239),t(50310),t(5962),t(90095),t(6724),t(11777),t(15547),t(83190),t(44264),t(62692),t(13715),t(88567)),Y=t(95718),H=t(95051),$=t(53380),Q=t(54489),X=t(64208),K=t(97736),z=t(12143),W=t(2739),j=t(95477),J=t(80660),Z=t(6123),ee=t(36408),ae=t(57668),te=t(18105),oe=t(42037),ne=t(54267),le=t(56945),re=t(27560),ie=t(41615),ce=t(64303),se=t(74160),ue=t(3112),de=t(9820),Oe=t(2652),Ne=t(70674),Ae=t(33001),Ce=t(16648),me={components:{QSelect:Ce.A},data:function(){return{options:[],value:null}},beforeMount:function(){var e=this;return y()(k()().m(function a(){var t;return k()().w(function(a){while(1)switch(a.n){case 0:if(t=[],"string"!==typeof e.params.api){a.n=2;break}return a.n=1,J.$http.get(e.params.api,{params:{response:"combo"}});case 1:t=a.v,a.n=3;break;case 2:t=e.params.options||[];case 3:e.options=w()(t),e.value=e.params.value||e.params.defaultvalue;case 4:return a.a(2)}},a)}))()},render:function(){var e=this;return(0,o.h)(Ce.A,{modelValue:e.value,options:e.options,"hide-selected":!0,"fill-input":!0,"use-input":!0,onInput:function(a){e.value=a,e.params.setValue(a)},onFilter:function(a,t){t(function(){var t=w()(e.params.options);e.options=(0,Ae.filterArray)(a,{field:e.params.dLabel||"label",list:t})})}})}},pe={props:{tipoNota:{type:String,default:"CREDITO"},codNota:{type:String,default:"07"}},components:{QForm:W.A,QChip:H.A,QDate:z.A,QPopupProxy:j.A,QCard:q.A,QCardSection:Y.A,QSelect:Q.S,QOptionGroup:Z.EX,QSeparator:$.A,sieGrid:ee.A,QInput:X.A,boxCuotas:K.A,footerGrid:re.A,crearBotones:ce.A,QCheckbox:ue.A,consultarComprobante:de.A,QPageHeader:Oe.A,select:me,QCardMain:Z.d1,QIcon:Z.bP},mixins:[le.A],data:function(){return{nameComponent:"NotaCredito",notaCredito:{NUMTAL:null,ID_PERSONA:0,ID_PERFIL:0,ORIPAG:null,NUMCTA:null,FORPAG:null,FECEMI:(0,te.Ay)(new Date,"DD/MM/YYYY"),FECPAG:(0,te.Ay)(new Date,"DD/MM/YYYY"),MOTNOTA:null,OBSERVACION:null,AFECTO_MORA:0},ctaBancos:[],fecemi:(0,te.Ay)(new Date,"DD/MM/YYYY"),showCtaBanco:!1,NUMTAL:null,NUMPAG:null,total:"0.00",cabecera:{TOTAL:"0.00",NUMTAL:null,NUMPAG:null,CLIENTE:null,CODIGO:null,ID_PERSONA:null,ID_PERFIL:null,FECEMI:null,MONNOM:null,MONEDA:null,ESTADO:null,USUCOD:null,OBSERVA:null,TIPO_OPERACION:null,NOMBRE:null,ORIGEN:null,FECAPG:null,USUARIO:null,MONSIG:"S/"},talonarioNc:[],talonarios:[],nivelAcceso:(0,ae["default"])().ruta.nivel,columnDefs:[],pages:null,pagina:1,rowData:[],api:null,frameworkComponents:null,motivos:[],anulacion:!1,botones:[],openModalCuotas:!1,datosFactura:{},itemsNota:[],sizeObs:0,openModlasNt:!0,origenes:[],selectOrigen:ie["default"].ORIPAG_CAJA,showOrigen:!0,selectAfectaMora:0,showObservacion:1,showMora:!1,documentoMora:!1,devolucionTotal:"07",debito:!1,pageHeader:{title:"",botones:[],componente:"notaCredito",nivelAcceso:(0,ae["default"])().ruta.nivel,tabs:[{name:"index",label:"registro"},{name:"consultar",label:"consultar"}],tabsKeys:{registro:"index",consultar:"consultar"},tabActive:"index"},notaDebitoConceptos:[]}},mounted:function(){this.getOrigenes(),this.getDdl(),this.crearBotones(),this.columns()},computed:{tituloNota:function(){return"Débito"},tituloGrid:function(){return"Monto por N.D."}},methods:{getConceptos:function(){var e=this;return y()(k()().m(function a(){var t;return k()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,J.$http.get("api/ConcobroController/getConceptos",{params:{parametros:{response:"list",flat_nota_debito:!0}}});case 1:t=a.v,e.notaDebitoConceptos=t;case 2:return a.a(2)}},a)}))()},actionTab:function(e){var a=this;return y()(k()().m(function t(){var o;return k()().w(function(t){while(1)switch(t.n){case 0:if(a.pageHeader.tabActive=e,e!==a.pageHeader.tabsKeys.registro){t.n=1;break}return a.crearBotones(),a.pageHeader.title="Nota de Débito",a.componente="notaCredito",a.nivelAcceso=(0,ae["default"])().ruta.nivel,t.a(2,!0);case 1:return t.n=2,a.$refs[e].actionTab();case 2:o=t.v,a.pageHeader.title=o.title,a.pageHeader.botones=o.botones,a.pageHeader.nivelAcceso=o.nivelAcceso,a.pageHeader.componente=o.componente;case 3:return t.a(2)}},t)}))()},columns:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.frameworkComponents={select:me},this.columnDefs=[{headerName:"Item",field:"NUMITE",width:50},{headerName:"Año",field:"ANOCOB",width:70},{headerName:"Mes",field:"MESDES",width:100},{headerName:"Concepto",field:"CONDES",width:420,editable:!0,cellEditor:(0,Ne.A)(this,"CONDES"),cellEditorParams:{"option-value":"value","option-label":"label",options:e}},{headerName:"Anio",field:"ANOCOB",hide:!0},{headerName:"Mescob",field:"MESCOB",hide:!0},{headerName:"Deuda",field:"ID_DEUDA",hide:!0},{headerName:"Persona",field:"ID_PERSONA",hide:!0},{headerName:"Perfil",field:"ID_PERFIL",hide:!0},{headerName:"Moneda",field:"MONCOD",hide:!0},{headerName:"Moneda",field:"MONSIG",width:100},{headerName:"Total",field:"MONTOPAG",cellClass:"text-right",valueFormatter:oe.toFixed,width:120},{headerName:this.tituloGrid,field:"MONTONOTA",cellClass:"text-right",valueFormatter:oe.toFixed,width:120,editable:ie["default"].MOTIVO_NC.DEVOLUCION_TOTAL!==this.notaCredito.MOTNOTA}]},changeOrigen:function(){this.showCtaBanco=this.selectOrigen===ie["default"].ORIPAG_BANCO,this.notaCredito.ORIPAG=this.selectOrigen},getOrigenes:function(){var e=this;return y()(k()().m(function a(){return k()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,ie["default"].ORIGENES(!1);case 1:e.origenes=a.v;case 2:return a.a(2)}},a)}))()},getDdl:function(){var e=this;return y()(k()().m(function a(){var t;return k()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,(0,se.n)(["PAGO"]);case 1:t=a.v,e.sizeObs=t.PAGO.OBSERVA;case 2:return a.a(2)}},a)}))()},crearBotones:function(){this.botones=[{label:"Guardar",icon:"save",click:this.guardarNota,minAcceso:ie["default"].LECTURA_ESCRITURA}],this.pageHeader.botones=this.botones},obtDetalle:function(e){var a=this,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=[];return e.forEach(function(e){if(e.MONTONOTA>0||!0===t){var n={ANOCOB:e.ANOCOB,CONCOB:e.CONCOB,MESCOB:e.MESCOB,MONCOD:e.MONCOD,BOLEMI:e.BOLEMI,FECVEN:e.FECVEN,CONCEPTO:e.CONCEPTO,ID_DEUDA:e.ID_DEUDA,ID_PERSONA:e.ID_PERSONA,ID_PERFIL:e.ID_PERFIL,MONTOCOB:0,MONTOMOR:0,MONTODES:0,MONTOPAG:0,NRODOC:"".concat(e.NUMTAL,"-").concat(e.NUMPAG)};ie["default"].MOTIVO_ND.INTERES_MORA===a.notaCredito.MOTNOTA?n.MONTOMOR=Number(e.MONTONOTA):n.MONTOCOB=Number(e.MONTONOTA),n.MONTOPAG=Number(n.MONTOCOB)+Number(n.MONTOMOR),o.push(n)}}),o},editing:function(e){if("CONCOB"===e.colDef.field)return!1;this.cellValueChanged(e);var a=0,t=w()(this.rowData);t.forEach(function(t){t.NUMITE!==e.data.NUMITE&&(a+=parseFloat(t.MONTONOTA||0))});var o=e.data.MONTONOTA||0;a=parseFloat(a)+parseFloat(o),this.total=a.toFixed(2)},onGridReady:function(e){this.api=e.api},getRowsNota:function(){return!0===this.anulacion||ie["default"].MOTIVO_NOTA_CREDITO.AJUTES_CUOTAS.includes(this.notaCredito.MOTNOTA)?this.rowData:this.changes.updated},guardarNota:function(){var e=this;return y()(k()().m(function a(){var t,o,n,l;return k()().w(function(a){while(1)switch(a.n){case 0:if(e.NUMTAL&&e.NUMPAG){a.n=1;break}return e.$alert("Debe Elegir un talonario e Ingresar el Número de comprobante","warning"),a.a(2,!1);case 1:if(null!==e.notaCredito.NUMTAL){a.n=2;break}return e.$alert("Debe Elegir el talonario de la nota ","warning"),a.a(2,!1);case 2:if(null!==e.notaCredito.MOTNOTA){a.n=3;break}return e.$alert("Debe Elegir el motivo de la nota ","warning"),a.a(2,!1);case 3:if(e.cabecera.ANUPAG!==ie["default"].PAGO_ANUPAG.ANULADO){a.n=4;break}return e.$alert("El comprobante (".concat(e.cabecera.NUMTAL,"-").concat(e.cabecera.NUMPAG,") esta ANULADO. No se puede aplicar nota "),"warning"),a.a(2,!1);case 4:return a.n=5,e.getRowsNota();case 5:if(e.itemsNota=a.v,0!==e.itemsNota.length){a.n=6;break}return e.$alert("Debe de ingresar el monto por la nota","warning"),a.a(2,!1);case 6:if(e.debito){a.n=7;break}return a.a(2,e.guardarNotaCredito());case 7:return t={pago:e.notaCredito,pagoDet:e.obtDetalle(e.itemsNota,!1)},o={ID_CONSTANTE:[ie["default"].CONSTANTES_SISTEMA.P_ENVIA_SUNAT_INDIVIDUAL]},a.n=8,ie["default"].API_CONSTANTES_SISTEMAS(o);case 8:if(n=a.v,l="¿Esta seguro de registrar la nota?",!n.P_ENVIA_SUNAT_INDIVIDUAL){a.n=10;break}if(e.notaCredito.OBSERVACION||ie["default"].MOTIVO_ND.PENALIDADES_OTROS!==e.notaCredito.MOTNOTA){a.n=9;break}return e.$alert("Debe colocar los siguientes datos en la observación: SERIE y NÚMERO del comprobante, RUC, FECHA DE EMISIÓN, MONTO y MONEDA.","warning"),a.a(2,!1);case 9:l="Este comprobante será enviado automaticamente a SUNAT, ¿Esta seguro de registrar la nota de débito?";case 10:return a.n=11,e.ajaxNotaDebito(t,l);case 11:return a.a(2)}},a)}))()},ajaxNotaDebito:function(e,a){var t=this;return y()(k()().m(function o(){return k()().w(function(o){while(1)switch(o.n){case 0:e.pago.FECEMI=(0,ne.convertToYMD)(t.fecemi),e.pago.FECPAG=(0,ne.convertToYMD)(t.fecemi),t.$confirm(a,"info",!1,!0).onOk(function(){J.$http.post("api/PagoController/postNotaDebito",{datos:e}).then(function(e){t.$q.loading.hide();var a=w()(e.data),o=a[0];t.changes.updated=[],t.itemsNota=[],t.openModalCuotas=!1,t.showMora=!1,t.notaCredito.OBSERVACION="",t.$alert(e.message,"success",!1,!0).onOk(function(e){t.$confirm("¿Desea Imprimir la nota de débito?","info",!1,!0).onOk(function(){var e=(0,ae["default"])().origin;t.clean(),ie["default"].IMPRIMIR_COMPROBANTE(e,o.numtal,o.numpag)}).onCancel(function(e){t.clean()})})}).catch(function(e){var a=e.error;t.$q.loading.hide(),t.$alert(a.message,"warning")})});case 1:return o.a(2)}},o)}))()},closeModalCalendar:function(e){this.$refs[e].hide()},buscarDocumento:function(){var e=this;return y()(k()().m(function a(){var t,o,n,l,r,i,c,s,u;return k()().w(function(a){while(1)switch(a.n){case 0:if(null==e.NUMTAL||null==e.NUMPAG){a.n=5;break}return e.NUMPAG&&(e.NUMPAG=(0,ne.agregaZeros)(e.NUMPAG,ie["default"].MAX_LENGTH_NUMPAG)),t={numtal:e.NUMTAL,numpag:e.NUMPAG},a.n=1,J.$http.get("api/PagoController/getComprobante",{params:{parametros:t}});case 1:if(o=a.v,0!==o.length){a.n=2;break}return e.notaCredito={NUMTAL:null,ID_PERSONA:0,ID_PERFIL:0,ORIPAG:null,NUMCTA:null,FORPAG:null,FECEMI:(0,te.Ay)(new Date,"DD/MM/YYYY"),FECPAG:(0,te.Ay)(new Date,"DD/MM/YYYY"),MOTNOTA:null,OBSERVACION:null,AFECTO_MORA:0},e.cabecera={TOTAL:"0.00",NUMTAL:null,NUMPAG:null,CLIENTE:null,CODIGO:null,ID_PERSONA:null,ID_PERFIL:null,FECEMI:null,MONNOM:null,MONEDA:null,ESTADO:null,USUCOD:null,OBSERVA:null,TIPO_OPERACION:null,NOMBRE:null,FECPAG:null,ORIGEN:null,USUARIO:null},e.datosFactura={},e.$alert("No existen datos del comprobante (".concat(e.NUMTAL,"-").concat(e.NUMPAG,")"),"warning"),e.rowData=[],a.a(2,!0);case 2:if(!(o.length>0)){a.n=4;break}return n=F()(o,1),l=n[0],e.documentoMora=Number(l.MONTOTMOR)>0,l.TIPCLIENTE===ie["default"].TIPCLIENTE.SUBCLIENTE?(e.cabecera.CLIENTE=l.CLIENTE,e.cabecera.PERFIL=l.PERFIL_SUBCLIENTE,e.notaCredito.ID_PERSONA=l.ID_PERSONA_SUB,e.notaCredito.ID_PERFIL=l.ID_PERFIL_SUB,e.cabecera.NOMBRE=l.CLIENTE):(e.cabecera.CLIENTE=l.CLIENTE,e.cabecera.PERFIL=l.PERFIL_CLIENTE,e.notaCredito.ID_PERSONA=l.ID_PERSONA,e.notaCredito.ID_PERFIL=l.ID_PERFIL),e.cabecera.NOMBRE=l.SUBCLIENTE?l.SUBCLIENTE:l.CLIENTE,e.cabecera.ANUPAG=l.ANUPAG,e.cabecera.MONEDA=l.MONEDA,e.cabecera.MONSIG=l.MONSIG,e.cabecera.FECEMI=(0,te.Ay)(new Date(l.FECEMI),"DD/MM/YYYY"),l.FECPAG?e.cabecera.FECPAG=(0,te.Ay)(new Date(l.FECPAG),"DD/MM/YYYY"):e.cabecera.FECPAG="",e.cabecera.CODIGO=l.CODIGO,e.cabecera.ESTADO=l.ESTADO,e.cabecera.NUMTAL=l.NUMTAL,e.cabecera.NUMPAG=l.NUMPAG,e.cabecera.CODSUNAT=l.CODSUNAT,e.notaCredito.MONCOD=l.MONCOD,e.notaCredito.NUMTALO=l.NUMTAL,e.notaCredito.NUMPAGO=l.NUMPAG,e.cabecera.TIPO_OPERACION=l.TIPO_OPERACION,e.cabecera.USUARIO=l.USUCOD,l.ORIPAG?l.ORIPAG===ie["default"].ORIPAG_BANCO?(e.cabecera.ORIGEN="Banco",e.ctaBancos.length>0&&e.ctaBancos.forEach(function(a){if(a.NUMCTA.toString()===l.NUMCTA&&a.CTACTE){var t=a.CTACTE.split("|");e.cabecera.ORIGEN="Banco ".concat(t[0],"-").concat(t[1])}})):l.ORIPAG===ie["default"].ORIPAG_CAJA&&(e.cabecera.ORIGEN="Caja"):e.cabecera.ORIGEN="",a.n=3,J.$http.get("api/PagoController/getComprobantesConceptos",{params:{parametros:t}});case 3:r=a.v,r=r.map(function(e){return _()(_()({},e),{},{CONCEPTO:e.CONCOB})}),i=e.notaDebitoConceptos.map(function(e){return e.CONCOB}),c=L()(r);try{for(c.s();!(s=c.n()).done;)u=s.value,i.includes(u.CONCOB)||e.notaDebitoConceptos.push({CONCOB:u.CONCOB,CONDES:u.CONDES})}catch(e){c.e(e)}finally{c.f()}e.rowData=r,e.datosFactura={cliente:l.CLIENTE,monsig:l.MONSIG,total:l.MONTOTPAG};case 4:e.frameworkComponents={select:me},e.columnDefs=[{headerName:"Item",field:"NUMITE",width:50},{headerName:"Año",field:"ANOCOB",width:70},{headerName:"Mes",field:"MESDES",width:100},{headerName:"Concepto",field:"CONCOB",width:420,cellRenderer:me,cellRendererParams:{options:e.notaDebitoConceptos.map(function(e){return{value:e.CONCOB,label:e.CONDES}})}},{headerName:"Mescob",field:"MESCOB",hide:!0},{headerName:"Deuda",field:"ID_DEUDA",hide:!0},{headerName:"Persona",field:"ID_PERSONA",hide:!0},{headerName:"Perfil",field:"ID_PERFIL",hide:!0},{headerName:"Moneda",field:"MONCOD",hide:!0},{headerName:"Moneda",field:"MONSIG",width:100},{headerName:"Total",field:"MONTOPAG",cellClass:"text-right",valueFormatter:oe.toFixed,width:120},{headerName:e.tituloGrid,field:"MONTONOTA",cellClass:"text-right",valueFormatter:oe.toFixed,width:120,editable:ie["default"].MOTIVO_NC.DEVOLUCION_TOTAL!==e.notaCredito.MOTNOTA}];case 5:if(e.NUMPAG&&(e.NUMPAG=(0,ne.agregaZeros)(e.NUMPAG,ie["default"].MAX_LENGTH_NUMPAG)),null!==e.NUMTAL){a.n=6;break}return a.a(2,e.$alert("No selecciono el talonario","warning"));case 6:return a.a(2)}},a)}))()},consultar:function(){this.$router.push({name:"tesoreria.registroConsultarComprobante",params:{cp:"notaCredito"}})},clean:function(){this.notaCredito.NUMTAL=null,this.notaCredito.OBSERVACION=null,this.notaCredito.MOTNOTA=null,this.notaCredito.NUMCTA=null,this.notaCredito.NUMOPE=null,this.NUMTAL=null,this.NUMPAG=null,this.total="0.00",this.cabecera={TOTAL:"0.00",NUMTAL:null,NUMPAG:null,CLIENTE:null,ID_PERSONA:null,ID_PERFIL:null,FECEMI:null,MONNOM:null,ESTADO:null,ANUPAG:null},this.rowData=[]},init:function(){var e=this;this.pageHeader.title="Nota de Débito",J.$http.get("api/bancoController/getCuentasBancarias",{params:{parametros:{response:"combo"}}}).then(function(a){e.ctaBancos=a});var a=this.debito?ie["default"].ESTADO_TABLA.MOTIVO_NOTA_DEBITO:ie["default"].ESTADO_TABLA.MOTIVO_NOTA_CREDITO;J.$http.get("api/EstadoTablaController/getEstadoTabla",{params:{parametros:{CODIGO:a}}}).then(function(a){e.motivos=a.map(function(e){var a=e.CLAVE,t=e.VALOR;return{CLAVE:a,VALOR:"".concat(a," | ").concat(t)}})}),J.$http.get("api/talonarioController/getTalonariosUsuario",{params:{parametros:{response:"combo",opcionMenu:"nota"}}}).then(function(a){if(a.length>0){if(e.talonarioNc=a.filter(function(a){return e.debito?a.ID_COMPROBANTE===ie["default"].NOTA_DEBITO:a.ID_COMPROBANTE===ie["default"].NOTA_CREDITO}),1===e.talonarioNc.length){var t=F()(e.talonarioNc,1),o=t[0];e.notaCredito.NUMTAL=o.NUMTAL}e.talonarios=a.filter(function(e){return![ie["default"].NOTA_CREDITO,ie["default"].NOTA_DEBITO].includes(e.ID_COMPROBANTE)})}})}},created:function(){this.debito="DEBITO"===this.tipoNota,this.init(),this.getConceptos()}},Ee=t(12807);const be=(0,Ee.A)(pe,[["render",v]]);var fe=be}}]);