"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[42575],{42575:function(e,o,t){t.r(o),t.d(o,{default:function(){return w}});var n=t(8445),i=t.n(n),a=t(61758),l={class:"row q-ma-sm"},r={class:"col-xs-12 col-sm-12 col-md-12 col-xl-12 q-pa-sm"},c={class:"row q-pa-sm"},s={class:"col-12"},u={class:"col-12"},d={class:"col-12"},f={key:1,class:"column col items-center justify-center"};function m(e,o){var t=(0,a.g2)("q-toolbar-title"),n=(0,a.g2)("q-toolbar"),m=(0,a.g2)("q-spinner-oval"),p=(0,a.g2)("q-inner-loading"),v=(0,a.g2)("q-item-side"),b=(0,a.g2)("q-item-main"),g=(0,a.g2)("q-item"),h=(0,a.g2)("q-list"),k=(0,a.g2)("q-popover"),A=(0,a.g2)("q-icon"),P=(0,a.g2)("q-td"),F=(0,a.g2)("q-table"),$=(0,a.g2)("q-select"),q=(0,a.g2)("q-input"),y=(0,a.g2)("sie-upload"),I=(0,a.g2)("sie-modal"),Q=(0,a.g2)("sie-pdf"),_=(0,a.g2)("sie-vacio"),C=(0,a.g2)("q-btn"),T=(0,a.g2)("q-page-sticky"),D=(0,a.g2)("q-page"),O=(0,a.gN)("close-overlay");return(0,a.uX)(),(0,a.Wv)(D,null,{default:(0,a.k6)(function(){return[(0,a.bF)(n,{class:"shadow-2 z-fab",inverted:""},{default:(0,a.k6)(function(){return[(0,a.bF)(t,{class:"q-pa-none"},{default:(0,a.k6)(function(){return i()(o[5]||(o[5]=[(0,a.eW)("Proyecto Educativo Institucional",-1)]))}),_:1})]}),_:1}),(0,a.Lk)("div",l,[(0,a.bF)(p,{visible:e.loadingSave},{default:(0,a.k6)(function(){return[(0,a.bF)(m,{size:"50px",color:"primary"})]}),_:1},8,["visible"]),(0,a.Lk)("div",r,[(0,a.bF)(F,{color:"secondary",data:e.dataPei.data,columns:e.dataPei.columns},{"body-cell-OPCIONES":(0,a.k6)(function(o){return[(0,a.bF)(P,{props:o},{default:(0,a.k6)(function(){return[(0,a.bF)(A,{name:"more_vert"},{default:(0,a.k6)(function(){return[(0,a.bF)(k,{style:{"min-width":"200px"}},{default:(0,a.k6)(function(){return[(0,a.bF)(h,{class:"no-border",link:""},{default:(0,a.k6)(function(){return[(0,a.bo)(((0,a.uX)(),(0,a.Wv)(g,{onClick:function(t){return e.formDetalle(o.row)}},{default:(0,a.k6)(function(){return[(0,a.bF)(v,{icon:"remove_red_eye",color:"black"}),(0,a.bF)(b,{label:e.$t("botones.verDocumento")},null,8,["label"])]}),_:1},8,["onClick"])),[[O]]),e.acceso?(0,a.bo)(((0,a.uX)(),(0,a.Wv)(g,{key:0,onClick:function(t){return e.deletePei(o.row.ID)}},{default:(0,a.k6)(function(){return[(0,a.bF)(v,{icon:"delete",color:"black"}),(0,a.bF)(b,{label:e.$t("botones.eliminar")},null,8,["label"])]}),_:1},8,["onClick"])),[[O]]):(0,a.Q3)("v-if",!0)]}),_:2},1024)]}),_:2},1024)]}),_:2},1024)]}),_:2},1032,["props"])]}),_:1},8,["data","columns"])])]),(0,a.bF)(I,{class:"modal-carpeta",modelValue:e.form,"onUpdate:modelValue":o[2]||(o[2]=function(o){return e.form=o}),footer:!0,ok:e.$t("botones.guardar"),header:!0,title:e.$t("subirArchivo"),onSubmit:e.save,"esc-click":""},{default:(0,a.k6)(function(){return[(0,a.Lk)("div",c,[(0,a.Lk)("div",s,[(0,a.bF)($,{outlined:"",modelValue:e.ano,"onUpdate:modelValue":o[0]||(o[0]=function(o){return e.ano=o}),options:e.dataYears,"option-label":"ANO","option-value":"ANO",label:e.$t("ano")},null,8,["modelValue","options","label"])]),(0,a.Lk)("div",u,[(0,a.bF)(q,{rules:[function(o){return!!o||e.$t("mensajes.m0020")}],modelValue:e.descripcion,"onUpdate:modelValue":o[1]||(o[1]=function(o){return e.descripcion=o}),label:"Descripción","error-message":e.$t("mensajes.m0020"),error:e.v$.descripcion.$error},null,8,["rules","modelValue","error-message","error"])]),(0,a.Lk)("div",d,[(0,a.bF)(y,{onUpload:e.addFile,icon:"file",title:e.$t("subirArchivos"),allow:["pdf"]},null,8,["onUpload","title"])])])]}),_:1},8,["modelValue","ok","title","onSubmit"]),(0,a.bF)(I,{class:"documento",modelValue:e.openDocumento,"onUpdate:modelValue":o[3]||(o[3]=function(o){return e.openDocumento=o}),column:"",title:e.tituloDocumento,header:!0,ok:!1,footer:!1},{default:(0,a.k6)(function(){return[e.urlActivo?((0,a.uX)(),(0,a.Wv)(Q,{key:0,class:"col",src:e.urlActivo,"no-download":!0},null,8,["src"])):((0,a.uX)(),(0,a.CE)("div",f,[(0,a.bF)(_,{class:"col",icon:"phonelink_erase"})]))]}),_:1},8,["modelValue","title"]),(0,a.bF)(T,{expand:"",position:"bottom-right",offset:[20,20]},{default:(0,a.k6)(function(){return[e.acceso?((0,a.uX)(),(0,a.Wv)(C,{key:0,fab:"",round:"",color:"secondary",icon:"plus",onClick:o[4]||(o[4]=function(o){return e.formArchivo("add")})})):(0,a.Q3)("v-if",!0)]}),_:1})]}),_:1})}t(56285);var p=t(83972),v=t(6123),b=t(9736),g=t(30640),h=t(30545),k=t(18105),A=t(59089),P=t(33950),F=t(84603),$=t(80340),q=t(16648),y=t(57668),I=t(80660),Q={getTodos:function(){return I.$http.get("api/HyoPcpei/getTodos")},savePei:function(e){return I.$http.post("api/HyoPcpei/savePei",e)},getAnios:function(){return I.$http.get("api/HyoAnos/getAnios")},deletePei:function(e){return I.$http.post("api/HyoPcpei/deletePei",e)}},_=t(982),C=t(69027),T=t(82640),D=function(e){return(0,k.Ay)(e,"DD/MM/YYYY HH:mm")},O={setup:function(){var e=(0,p.fG)();return{v$:e}},components:{QTable:h.A,QTr:v.qh,QTd:v.Ef,QTooltip:v.nC,QPopover:v.VM,QToggle:v.c5,QInnerLoading:v.SQ,QSpinnerOval:v.VA,sieModal:g.A,notify:_["default"],QPageSticky:v._U,siePdf:F.A,sieUpload:A.A,sieVacio:$.A,QSelect:q.S,QInput:b.A,QPage:v.Tu,QToolbar:v.ZV,QToolbarTitle:v.r_,QIcon:v.bP,QList:v.Mb,QItem:v.H0,QItemSide:v.n1,QItemMain:v.mF,QBtn:v.Il},data:function(){var e=(0,y["default"])();return{sie:e,acceso:e.ruta.nivel>2,dataYears:[],loadingSave:!1,dataPei:{data:[],columns:[{name:"ANO",label:"AÑO",field:"ANO",align:"left",sortable:!0},{name:"FH_AUDITORIA",label:"FECHA CARGA",field:"FH_AUDITORIA",align:"left",format:D,sortable:!0},{name:"DESCRIPCION",label:"ARCHIVO",field:"DESCRIPCION",align:"left",sortable:!0},{name:"OPCIONES",label:"",field:"OPCIONES",align:"center"}]},id:null,ano:"",descripcion:"",form:!1,objArchivo:null,urlActivo:null,openDocumento:!1,tituloDocumento:""}},validations:{descripcion:{required:T.mw}},methods:{getTodos:function(){var e=this;Q.getTodos().then(function(o){e.dataPei.data=o}).catch(function(e){console.log("error")})},formArchivo:function(){this.objArchivo={},this.descripcion="",this.form=!0},addFile:function(e){var o=this;(0,P.Upload)({url:"api/HyoArchivo/tmp/upload",file:e[0]}).then(function(e){o.objArchivo=e}).catch(function(){})},save:function(){var e=this;this.v$.$touch();var o={ano:this.ano+"",descripcion:this.descripcion,archivoTemp:this.objArchivo.name};o.archivoTemp?this.v$.$invalid?console.log(this.v$):Q.savePei(o).then(function(o){o.json;e.getTodos(),e.loadingSave=!1,e.form=!1,(0,_["default"])(e.$t("mensajes.m0001"),"success")}).catch(function(o){(0,_["default"])(e.$t("mensajes.m0091"),"warning")}):(0,_["default"])("el archivo es requerido","warning")},formDetalle:function(e){this.urlActivo=this.generarUrl(e.RUTA),this.openDocumento=!0,this.tituloDocumento=e.DESCRIPCION},generarUrl:function(e){return this.sie.api+"/HyoPcpei/descargar/"+e+"/documento_pei?sie-token="+this.sie.token},getAnios:function(){var e=this;Q.getAnios().then(function(o){e.dataYears=o})},deletePei:function(e){var o=this;(0,C.dialogConfirm)({message:this.$t("mensajes.m0006.confirmacion")}).then(function(t){t&&Q.deletePei({id:e}).then(function(){o.getTodos(),(0,_["default"])(o.$t("mensajes.m0006.ok"),"success")}).catch(function(e){(0,_["default"])(o.$t("mensajes.m0006.mal"),"warning")})})}},created:function(){this.loadingSave=!1,this.getTodos(),this.getAnios(),this.ano=""+this.sie.ano}},S=t(12807);const V=(0,S.A)(O,[["render",m]]);var w=V}}]);