"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[82659],{82659:function(e,t,a){a.r(t),a.d(t,{default:function(){return W}});var o=a(8445),n=a.n(o),i=(a(71225),a(50310),a(5962),a(83190),a(61758)),s=a(58790),r={class:"row q-pa-sm"},l={class:"col-xs-10 col-md-10 col-sm-12"},c={class:"col-xs-2 col-md-2 col-sm-12"},u={class:"row q-pa-sm"},d={class:"col-xs-12 col-md-12"},f={class:"col-10"},m={class:"row q-pa-sm"},p={class:"col-xs-5 col-md-5 col-sm-12"},g={class:"col-xs-5 col-md-5 col-sm-12"},S={class:"col-xs-2 col-md-2 col-sm-12"},b={class:"row q-pa-sm"},F={class:"col-xs-12 col-md-12"},k={class:"col-10"};function h(e,t){var a=(0,i.g2)("q-toolbar-title"),o=(0,i.g2)("q-toolbar"),h=(0,i.g2)("q-tab"),v=(0,i.g2)("sie-select"),w=(0,i.g2)("q-btn"),U=(0,i.g2)("q-search"),C=(0,i.g2)("q-td"),_=(0,i.g2)("q-tr"),y=(0,i.g2)("q-table"),A=(0,i.g2)("q-tab-pane"),j=(0,i.g2)("sie-pdf"),O=(0,i.g2)("sie-modal"),Q=(0,i.g2)("q-tabs"),q=(0,i.g2)("q-card"),R=(0,i.g2)("q-page");return(0,i.uX)(),(0,i.Wv)(R,null,{default:(0,i.k6)(function(){return[(0,i.bF)(q,{class:"q-card q-my-sm q-mx-sm"},{default:(0,i.k6)(function(){return[(0,i.bF)(o,{class:"shadow-2 z-fab",inverted:""},{default:(0,i.k6)(function(){return[(0,i.bF)(a,{class:"q-pa-none titulo"},{default:(0,i.k6)(function(){return n()(t[12]||(t[12]=[(0,i.eW)("Mantenimiento de Sectoristas",-1)]))}),_:1})]}),_:1}),(0,i.bF)(Q,{inverted:""},{title:(0,i.k6)(function(){return[e.permisoRegistro?((0,i.uX)(),(0,i.Wv)(h,{key:0,default:"",name:"tab-1",label:"Sectoristas"})):(0,i.Q3)("v-if",!0),(0,i.bF)(h,{default:!e.permisoRegistro,name:"tab-2",label:"Familias por sectorista",onClick:t[0]||(t[0]=function(t){return e.tabSectoristas()})},null,8,["default"])]}),default:(0,i.k6)(function(){return[e.permisoRegistro?((0,i.uX)(),(0,i.Wv)(A,{key:0,name:"tab-1","keep-alive":""},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",r,[(0,i.Lk)("div",l,[(0,i.bF)(v,{class:"col",type:"outlined",modelValue:e.usuario,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.usuario=t}),options:e.usuarios,label:"USUNOM",val:"USUCOD",placeholder:"Seleccione un usuario"},null,8,["modelValue","options"])]),(0,i.Lk)("div",c,[(0,i.bF)(w,{class:"q-mr-sm",size:"sm",icon:"plus",label:"Agregar",color:"primary",onClick:t[2]||(t[2]=function(t){return e.addSectorista()})})])]),(0,i.Lk)("div",u,[(0,i.Lk)("div",d,[(0,i.bF)(y,{data:e.dataUsuarios,columns:e.conf.columns,selection:e.conf.selection,pagination:e.conf.pagination,selected:e.conf.selected,"onUpdate:selected":t[4]||(t[4]=function(t){return e.conf.selected=t}),"row-key":"USUCOD",color:"secondary",filter:e.conf.filter},{top:(0,i.k6)(function(a){return[(0,i.Lk)("div",f,[(0,i.bF)(U,{class:"q-if-outlined","hide-underline":"",modelValue:e.conf.filter,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.conf.filter=t})},null,8,["modelValue"])])]}),body:(0,i.k6)(function(t){return[(0,i.bF)(_,{class:(0,s.C4)(["cursor-pointer",t.row.__index==e.currentRow.row.__index?"tr-select":""]),props:t},{default:(0,i.k6)(function(){return[(0,i.bF)(C,{key:"USUCOD",props:t},{default:(0,i.k6)(function(){return[(0,i.eW)((0,s.v_)(t.row.USUCOD),1)]}),_:2},1032,["props"]),(0,i.bF)(C,{key:"USUNOM",props:t},{default:(0,i.k6)(function(){return[(0,i.eW)((0,s.v_)(t.row.USUNOM),1)]}),_:2},1032,["props"]),(0,i.bF)(C,{key:"ACTIONS",props:t},{default:(0,i.k6)(function(){return[(0,i.bF)(w,{dense:"",flat:"",round:"",icon:"delete",onClick:function(a){return e.delSectorista(t.row)}},null,8,["onClick"])]}),_:2},1032,["props"])]}),_:2},1032,["class","props"])]}),_:1},8,["data","columns","selection","pagination","selected","filter"])])])]}),_:1})):(0,i.Q3)("v-if",!0),(0,i.bF)(A,{name:"tab-2","keep-alive":""},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",m,[(0,i.Lk)("div",p,[(0,i.bF)(v,{class:"col",type:"outlined",modelValue:e.sectorista,"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.sectorista=t}),options:e.sectoristas,label:"USUNOM",val:"ID_SECTORISTA",placeholder:"Seleccione un sectorista",onInput:t[6]||(t[6]=function(t){return e.getFamiliasSectorista()})},null,8,["modelValue","options"])]),(0,i.Lk)("div",g,[(0,i.bF)(v,{class:"col",type:"outlined",modelValue:e.familia,"onUpdate:modelValue":t[7]||(t[7]=function(t){return e.familia=t}),options:e.familias,label:"FAMDES",val:"FAMCOD",placeholder:"Seleccione una familia"},null,8,["modelValue","options"])]),(0,i.Lk)("div",S,[e.permisoRegistro?((0,i.uX)(),(0,i.Wv)(w,{key:0,class:"q-mr-sm",size:"sm",icon:"plus",label:"Agregar",color:"primary",onClick:t[8]||(t[8]=function(t){return e.setSectoristaFam()})})):(0,i.Q3)("v-if",!0)])]),(0,i.Lk)("div",b,[(0,i.Lk)("div",F,[(0,i.bF)(y,{data:e.dataFamiliasSectorista,columns:e.confSec.columns,selection:e.confSec.selection,pagination:e.confSec.pagination,selected:e.confSec.selected,"onUpdate:selected":t[10]||(t[10]=function(t){return e.confSec.selected=t}),"row-key":"FAMCOD",color:"secondary",filter:e.confSec.filter},{top:(0,i.k6)(function(a){return[(0,i.Lk)("div",k,[(0,i.bF)(U,{class:"q-if-outlined","hide-underline":"",modelValue:e.confSec.filter,"onUpdate:modelValue":t[9]||(t[9]=function(t){return e.confSec.filter=t})},null,8,["modelValue"])])]}),body:(0,i.k6)(function(t){return[(0,i.bF)(_,{class:(0,s.C4)(["cursor-pointer",t.row.__index==e.currentRow.row.__index?"tr-select":""]),props:t},{default:(0,i.k6)(function(){return[(0,i.bF)(C,{key:"FAMCOD",props:t},{default:(0,i.k6)(function(){return[(0,i.eW)((0,s.v_)(t.row.FAMCOD),1)]}),_:2},1032,["props"]),(0,i.bF)(C,{key:"FAMDES",props:t},{default:(0,i.k6)(function(){return[(0,i.eW)((0,s.v_)(t.row.FAMDES),1)]}),_:2},1032,["props"]),(0,i.bF)(C,{key:"ACTIONS",props:t},{default:(0,i.k6)(function(){return[e.permisoRegistro?((0,i.uX)(),(0,i.Wv)(w,{key:0,dense:"",flat:"",round:"",icon:"print",onClick:function(a){return e.getReporte(t.row,"pdf")}},null,8,["onClick"])):(0,i.Q3)("v-if",!0),e.permisoRegistro?((0,i.uX)(),(0,i.Wv)(w,{key:1,dense:"",flat:"",round:"",icon:"file_excel",onClick:function(a){return e.getReporte(t.row,"xlsx")}},null,8,["onClick"])):(0,i.Q3)("v-if",!0),e.permisoRegistro?((0,i.uX)(),(0,i.Wv)(w,{key:2,dense:"",flat:"",round:"",icon:"delete",onClick:function(a){return e.delSectoristaFam(t.row)}},null,8,["onClick"])):(0,i.Q3)("v-if",!0)]}),_:2},1032,["props"])]}),_:2},1032,["class","props"])]}),_:1},8,["data","columns","selection","pagination","selected","filter"]),(0,i.bF)(O,{class:"modal-viewer",modelValue:e.modalReport,"onUpdate:modelValue":t[11]||(t[11]=function(t){return e.modalReport=t}),title:"Estado de cuenta",footer:!1},{default:(0,i.k6)(function(){return[(0,i.bF)(j,{class:"col",src:e.urlReport,style:{"min-height":"60vh","min-width":"50vw"}},null,8,["src"])]}),_:1},8,["modelValue"])])])]}),_:1})]}),_:1})]}),_:1})]}),_:1})}var v=a(99550),w=a.n(v),U=(a(23825),a(27153),a(66307),a(24066),a(83972)),C=a(6123),_=a(93616),y=a(30640),A=a(982),j=a(69027),O=a(80660),Q={getUsuarios:function(){return O.$http.get("api/HyoUsuario/obtenerUsuarios",{})},getSectoristas:function(){return O.$http.get("api/HyoSectorista/getSectoristas",{})},getFamilias:function(){return O.$http.get("api/HyoFamilias/getFamilias",{params:{params:{notSectorista:!0}}})},getFamiliasSectorista:function(e){return O.$http.get("api/HyoSectorista/getFamiliasSectorista",{params:{id:e}})},addSectorista:function(e){return O.$http.get("api/HyoSectorista/addSectorista",{params:{usucod:e}})},delSectorista:function(e){return O.$http.get("api/HyoSectorista/delSectorista",{params:{id:e}})},delSectoristaFam:function(e){return O.$http.get("api/HyoSectorista/delSectoristaFam",{params:{famcod:e}})},setSectoristaFam:function(e,t){return O.$http.get("api/HyoSectorista/setSectoristaFam",{params:{id:e,famcod:t}})}},q=a(57668),R=a(56089),$=a(9054),D=a(8901),M=a(59089),T=a(84603),V=a(6583),x=a(2819),N={setup:function(){var e=(0,U.fG)();return{v$:e}},components:{QFab:C.l6,QFabAction:C.B$,QTabs:C.uw,QTab:C.zu,QTabPane:C.dg,QTable:C.kH,QTh:C.EJ,QTr:C.qh,QTd:C.Ef,QToggle:C.c5,QPopupEdit:C.GT,QSelect:C.Si,QPageSticky:C._U,sieSelect:_.A,sieModal:y.A,QIframe:R.A,SieVisor:$.A,SieView:D.A,sieUpload:M.A,siePdf:T.A,QPage:C.Tu,QCard:C.C$,QToolbar:C.ZV,QToolbarTitle:C.r_,QBtn:C.Il,QSearch:C.Ks},data:function(){return{permisoRegistro:(0,q["default"])().ruta.nivel>=3,currentRow:{old:{},row:{}},conf:{data:[],columns:[{name:"USUCOD",label:"Código",field:"USUCOD",align:"left"},{name:"USUNOM",label:"Nombre",field:"USUNOM",align:"left"},{name:"ACTIONS",label:"",align:"center"}],pagination:{page:1,rowsPerPage:200},filter:"",selection:"none",selected:[]},confSec:{data:[],columns:[{name:"FAMCOD",label:"Código",field:"FAMCOD",align:"left"},{name:"FAMDES",label:"Familia",field:"FAMDES",align:"left"},{name:"ACTIONS",label:"",align:"center"}],pagination:{page:1,rowsPerPage:200},filter:"",selection:"none",selected:[]},usuario:"",usuarios:[],sectorista:"",sectoristas:[],familia:"",familias:[],modalReport:!1,urlReport:""}},computed:{dataUsuarios:function(){var e=this.conf.data;return e},dataFamiliasSectorista:function(){var e=this.confSec.data;return e}},methods:{tabUsuarios:function(){var e=this;Q.getUsuarios().then(function(t){e.usuarios=(0,V["default"])(t)}),this.getSectoristas()},getSectoristas:function(){var e=this;Q.getSectoristas().then(function(t){e.conf.data=(0,V["default"])(t)})},tabSectoristas:function(){var e=this;Promise.all([Q.getSectoristas(),Q.getFamilias()]).then(function(t){var a=w()(t,2),o=a[0],n=a[1];e.sectoristas=(0,V["default"])(o),e.familias=n.json,e.sectorista="",e.familia="",e.confSec.data=[]})},getFamilias:function(){var e=this;Q.getFamilias().then(function(t){e.familias=t.json})},getFamiliasSectorista:function(){var e=this;Q.getFamiliasSectorista(this.sectorista).then(function(t){e.confSec.data=(0,V["default"])(t)})},addSectorista:function(){var e=this;if(""===this.usuario)return(0,A["default"])("Para realizar el proceso debe seleccionar un usuario","warning"),!1;(0,j.confirmar)(this.$t("mensajes.m0007"),function(){return Q.addSectorista(e.usuario)}).then(function(t){"success"===t.json.icono?((0,A["default"])(e.$t("mensajes."+t.json.msg),"success"),e.getSectoristas(),e.usuario=""):(0,A["default"])(e.$t("mensajes."+t.json.msg),"warning")}).catch(function(){(0,A["default"])("No se pudo registrar","warning")})},delSectorista:function(e){var t=this;(0,j.confirmar)(this.$t("mensajes.m0006.confirmacion"),function(){return Q.delSectorista(e.ID_SECTORISTA)}).then(function(e){"success"===e.json.icono?((0,A["default"])(t.$t("mensajes."+e.json.msg),"success"),t.getSectoristas()):(0,A["default"])(t.$t("mensajes."+e.json.msg),"warning")}).catch(function(){(0,A["default"])("No se pudo eliminar","warning")})},delSectoristaFam:function(e){var t=this;(0,j.confirmar)(this.$t("mensajes.m0006.confirmacion"),function(){return Q.delSectoristaFam(e.FAMCOD)}).then(function(e){"success"===e.json.icono?((0,A["default"])(t.$t("mensajes."+e.json.msg),"success"),t.getFamilias(),t.getFamiliasSectorista()):(0,A["default"])(t.$t("mensajes."+e.json.msg),"warning")}).catch(function(){(0,A["default"])("No se pudo eliminar","warning")})},setSectoristaFam:function(){var e=this;return""===this.sectorista?((0,A["default"])("Para realizar el proceso debe seleccionar un sectorista","warning"),!1):""===this.familia?((0,A["default"])("Para realizar el proceso debe seleccionar una familia","warning"),!1):void(0,j.confirmar)(this.$t("mensajes.m0007"),function(){return Q.setSectoristaFam(e.sectorista,e.familia)}).then(function(t){"success"===t.json.icono?((0,A["default"])(e.$t("mensajes."+t.json.msg),"success"),e.getFamilias(),e.getFamiliasSectorista()):(0,A["default"])(e.$t("mensajes."+t.json.msg),"warning")}).catch(function(){(0,A["default"])("No se pudo registrar","warning")})},getReporte:function(e,t){if("xlsx"===t)return this.urlReport=(0,q["default"])().url+"/corporativo/reportes/codigoreporte/0028/tipo/"+t+"/famcod/"+e.FAMCOD+"/ano/"+(0,q["default"])().ano+"/moncod/",(0,x.open)({action:this.urlReport}),!1;this.modalReport=!0}},watch:{},validations:{},created:function(){this.permisoRegistro?this.tabUsuarios():this.tabSectoristas()}},L=a(12807);const P=(0,L.A)(N,[["render",h]]);var W=P}}]);