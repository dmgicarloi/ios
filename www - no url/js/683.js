"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[683],{683:function(e,t,o){o.r(t),o.d(t,{default:function(){return Me}});o(11777),o(15547);var a=o(61758),r=o(58790),n=o(29104),s={class:"row gutter-xs q-col-gutter-sm"},i={class:"col-xs-12 col-lg-12"},l={class:"row gutter-xs q-col-gutter-sm"},c={class:"col-xs-12 col-md-12 col-lg-6"},u={class:"row gutter-xs q-col-gutter-sm"},d={class:"col-xs-12 col-lg-8"},f={class:"col-xs-12 col-lg-4"},m={class:"row gutter-xs q-col-gutter-sm"},p={class:"col-xs-12 col-lg-6"},g={class:"col-xs-12 col-lg-6 flex align-center justify-end",style:{"align-items":"center"}},h={class:"column ptotal"},b={class:"col-xs-12 col-lg-6"},D={class:"row gutter-xs q-col-gutter-sm"},w={class:"col-xs-6 col-lg-6"},v={class:"col-xs-6 col-lg-6"},C={class:"row gutter-xs q-col-gutter-sm"},k={class:"col-xs-12 col-lg-12"};function A(e,t){var o=this,A=(0,a.g2)("page-header"),F=(0,a.g2)("q-select"),E=(0,a.g2)("q-date"),M=(0,a.g2)("q-popup-proxy"),N=(0,a.g2)("q-icon"),O=(0,a.g2)("q-input"),x=(0,a.g2)("q-card"),P=(0,a.g2)("q-card-section"),T=(0,a.g2)("sie-grid"),V=(0,a.g2)("footer-grid"),B=(0,a.g2)("consultar");return(0,a.uX)(),(0,a.Wv)(x,{class:"layout-v1 my-card",flat:"",bordered:""},{default:(0,a.k6)(function(){return[(0,a.bF)(A,{title:e.pageHeader.title,componente:e.pageHeader.componente,nivelAcceso:e.pageHeader.nivelAcceso,tabs:e.pageHeader.tabs,botones:e.pageHeader.botones,useTab:"",onActionTab:e.changeTab},null,8,["title","componente","nivelAcceso","tabs","botones","onActionTab"]),e.tabs.tabActivo===e.tabs.keysTabs.registro?((0,a.uX)(),(0,a.Wv)(P,{key:0},{default:(0,a.k6)(function(){return[(0,a.Lk)("div",s,[(0,a.Lk)("div",i,[(0,a.Lk)("div",l,[(0,a.Lk)("div",c,[(0,a.bF)(x,{class:"col-12 q-card-legend q-mt-lg",style:{padding:"0.5rem",margin:"0rem"},title:"Datos del Depósito"},{default:(0,a.k6)(function(){return[(0,a.Lk)("div",u,[(0,a.Lk)("div",d,[(0,a.bF)(F,{class:"truncate-label",modelValue:e.form.banco,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.form.banco=t}),label:"Número de cuenta",placeholder:"Seleccione banco",options:e.options.ctsBancos,onInput:e.getDatosBanncos},null,8,["modelValue","options","onInput"])]),(0,a.Lk)("div",f,[(0,a.bF)(O,{label:"Fecha",debounce:"500",maxlength:"10",format:"##/##/####",modelValue:e.form.fecha,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.form.fecha=t}),mask:"##/##/####"},{append:(0,a.k6)(function(){return[(0,a.bF)(N,{class:"cursor-pointer",name:"date_range"},{default:(0,a.k6)(function(){return[(0,a.bF)(M,{ref:"qDateProxy1","transition-show":"scale","transition-hide":"scale"},{default:(0,a.k6)(function(){return[(0,a.bF)(E,{mask:"DD/MM/YYYY",modelValue:e.form.fecha,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.form.fecha=t}),onInput:t[2]||(t[2]=function(t){return e.closeModalCalendar("qDateProxy1")})},null,8,["modelValue"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])])]),(0,a.Lk)("div",m,[(0,a.Lk)("div",p,[(0,a.bF)(O,{label:"Nro. Depósito",placeholder:"Ingrese número de depósito",modelValue:e.form.nroDeposito,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.form.nroDeposito=t})},null,8,["modelValue"])]),(0,a.Lk)("div",g,[(0,a.Lk)("p",h,"Total a Pagar: "+(0,r.v_)(o.models.banco.MONSIG)+" "+(0,r.v_)(Number(e.models.total).toFixed(2)),1)])])]}),_:1})]),(0,a.Lk)("div",b,[(0,a.bF)(x,{class:"col-12 q-card-legend q-mt-lg",style:{padding:"0.5rem",margin:"0rem"},title:"Filtrar por:"},{default:(0,a.k6)(function(){return[(0,a.Lk)("div",D,[(0,a.Lk)("div",w,[(0,a.bF)(O,{label:"Fecha Ini.",debounce:"500",maxlength:"10",format:"##/##/####",modelValue:e.filtros.fechaIni,"onUpdate:modelValue":t[7]||(t[7]=function(t){return e.filtros.fechaIni=t}),mask:"##/##/####"},{append:(0,a.k6)(function(){return[(0,a.bF)(N,{class:"cursor-pointer",name:"date_range"},{default:(0,a.k6)(function(){return[(0,a.bF)(M,{ref:"qDateProxy2","transition-show":"scale","transition-hide":"scale"},{default:(0,a.k6)(function(){return[(0,a.bF)(E,{mask:"DD/MM/YYYY",modelValue:e.filtros.fechaIni,"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.filtros.fechaIni=t}),onInput:t[6]||(t[6]=function(t){return e.closeModalCalendar("qDateProxy2")})},null,8,["modelValue"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])]),(0,a.Lk)("div",v,[(0,a.bF)(O,{label:"Fecha Fin",debounce:"500",maxlength:"10",format:"##/##/####",modelValue:e.filtros.fechaFin,"onUpdate:modelValue":t[10]||(t[10]=function(t){return e.filtros.fechaFin=t}),mask:"##/##/####"},{append:(0,a.k6)(function(){return[(0,a.bF)(N,{class:"cursor-pointer",name:"date_range"},{default:(0,a.k6)(function(){return[(0,a.bF)(M,{ref:"qDateProxy3","transition-show":"scale","transition-hide":"scale"},{default:(0,a.k6)(function(){return[(0,a.bF)(E,{mask:"DD/MM/YYYY",modelValue:e.filtros.fechaFin,"onUpdate:modelValue":t[8]||(t[8]=function(t){return e.filtros.fechaFin=t}),onInput:t[9]||(t[9]=function(t){return e.closeModalCalendar("qDateProxy3")})},null,8,["modelValue"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])])]),(0,a.Lk)("div",C,[(0,a.Lk)("div",k,[(0,a.bF)(F,{label:"Empresa",placeholder:"Seleccione una empresa",options:e.options.empresas,modelValue:e.filtros.empresa,"onUpdate:modelValue":t[11]||(t[11]=function(t){return e.filtros.empresa=t}),onInput:e.getPagosCaja},null,8,["options","modelValue","onInput"])])])]}),_:1})])])])])]}),_:1})):(0,a.Q3)("v-if",!0),e.tabs.tabActivo===e.tabs.keysTabs.registro?((0,a.uX)(),(0,a.Wv)(P,{key:1},{default:(0,a.k6)(function(){return[(0,a.Lk)("div",null,[(0,a.bF)(T,{class:"ag-theme-balham",style:{height:"calc(100vh - 380px)"},rowData:e.grid.rowData,columnDefs:e.grid.columnDefs,onGridReady:e.onGridReady,frameworkComponents:e.grid.frameworkComponents,enableCellTextSelection:"",floatingFilter:"",defaultColDef:e.grid.defaultColDef,onRowSelected:e.getLabelTotal,rowSelection:"multiple"},null,8,["rowData","columnDefs","onGridReady","frameworkComponents","defaultColDef","onRowSelected"]),(0,a.bF)(V,{style:{width:"100%"},modelValue:e.grid.footer.page,"onUpdate:modelValue":t[12]||(t[12]=function(t){return e.grid.footer.page=t}),max:e.grid.footer.maxPages,onLoad:e.getPagosCaja,rows:e.grid.rowData},null,8,["modelValue","max","onLoad","rows"])])]}),_:1})):(0,a.Q3)("v-if",!0),(0,a.bo)((0,a.bF)(B,{ref:e.tabs.keysTabs.consultar,onRefresh:e.getPagosCaja},null,8,["onRefresh"]),[[n.aG,e.tabs.tabActivo===e.tabs.keysTabs.consultar]])]}),_:1})}var F=o(99550),E=o.n(F),M=o(76080),N=o.n(M),O=o(45254),x=o.n(O),P=(o(12563),o(71225),o(74260),o(52133),o(50310),o(5962),o(32203),o(6724),o(92802),o(83190),o(68017),o(88567)),T=o(95718),V=o(53380),B=o(54489),y=o(12143),I=o(6123),R=o(54267),q=o(80660),U=o(36408),_=o(27560),Y=o(96330),L=o(75053),S=o(64208),G=o(95477),$=o(3112),Q=o(41615),H=o(42037),j=o(18105),z=o(64303),X=o(12533),W=o(38739),J=o(2652),Z=o(57668),K=o(8445),ee=o.n(K),te={class:"row gutter-xs q-mb-sm"},oe={class:"col-xs-12"},ae={class:"row gutter-xs q-col-gutter-sm"},re={class:"col-xs-12 col-lg-6"},ne={class:"col-xs-6 col-lg-3"},se={class:"col-xs-6 col-lg-3"},ie={class:"row q-ma-xs q-col-gutter-sm"},le={class:"col-xs-12"},ce={class:"text-h6"},ue={class:"row q-ma-xs q-col-gutter-sm"},de={class:"col-xs-12"},fe={class:"col-xs-6"};function me(e,t){var o=(0,a.g2)("q-select"),n=(0,a.g2)("q-date"),s=(0,a.g2)("q-popup-proxy"),i=(0,a.g2)("q-icon"),l=(0,a.g2)("q-input"),c=(0,a.g2)("q-card"),u=(0,a.g2)("q-card-section"),d=(0,a.g2)("q-separator"),f=(0,a.g2)("sie-grid"),m=(0,a.g2)("footer-grid"),p=(0,a.g2)("tesoreriaLoading"),g=(0,a.g2)("q-option-group"),h=(0,a.g2)("sie-modal");return(0,a.uX)(),(0,a.CE)("div",null,[t[16]||(t[16]=(0,a.Lk)("form",{id:"form"},null,-1)),(0,a.bF)(u,{style:{"padding-bottom":"0"}},{default:(0,a.k6)(function(){return[(0,a.Lk)("div",te,[(0,a.Lk)("div",oe,[(0,a.bF)(c,{class:"col-12 q-card-legend q-mt-lg",style:{padding:"0.5rem","margin-top":"0rem"},title:"Filtros"},{default:(0,a.k6)(function(){return[(0,a.Lk)("div",ae,[(0,a.Lk)("div",re,[(0,a.bF)(o,{class:"truncate-label",label:"Banco",placeholder:"Seleccione banco",options:e.options.ctsBancos,modelValue:e.filtros.banco,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.filtros.banco=t}),onInput:e.getDepositos},null,8,["options","modelValue","onInput"])]),(0,a.Lk)("div",ne,[(0,a.bF)(l,{label:"Fecha Ini.",debounce:"500",maxlength:"10",format:"##/##/####",modelValue:e.filtros.fechaIni,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.filtros.fechaIni=t}),mask:"##/##/####"},{append:(0,a.k6)(function(){return[(0,a.bF)(i,{class:"cursor-pointer",name:"date_range"},{default:(0,a.k6)(function(){return[(0,a.bF)(s,{ref:"qDateProxy2","transition-show":"scale","transition-hide":"scale"},{default:(0,a.k6)(function(){return[(0,a.bF)(n,{mask:"DD/MM/YYYY",modelValue:e.filtros.fechaIni,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.filtros.fechaIni=t}),onInput:t[2]||(t[2]=function(t){return e.closeModalCalendar("qDateProxy2")})},null,8,["modelValue"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])]),(0,a.Lk)("div",se,[(0,a.bF)(l,{label:"Fecha Fin",debounce:"500",maxlength:"10",format:"##/##/####",modelValue:e.filtros.fechaFin,"onUpdate:modelValue":t[6]||(t[6]=function(t){return e.filtros.fechaFin=t}),mask:"##/##/####"},{append:(0,a.k6)(function(){return[(0,a.bF)(i,{class:"cursor-pointer",name:"date_range"},{default:(0,a.k6)(function(){return[(0,a.bF)(s,{ref:"qDateProxy3","transition-show":"scale","transition-hide":"scale"},{default:(0,a.k6)(function(){return[(0,a.bF)(n,{mask:"DD/MM/YYYY",modelValue:e.filtros.fechaFin,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.filtros.fechaFin=t}),onInput:t[5]||(t[5]=function(t){return e.closeModalCalendar("qDateProxy3")})},null,8,["modelValue"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])])])]}),_:1})])])]}),_:1}),(0,a.bF)(d),(0,a.bF)(u,null,{default:(0,a.k6)(function(){return[(0,a.Lk)("div",null,[(0,a.bF)(f,{class:"ag-theme-balham",style:{height:"calc(100vh - 360px)"},rowData:e.grid.rowData,columnDefs:e.grid.columnDefs,onGridReady:e.onGridReady,enableCellTextSelection:"",floatingFilter:"",frameworkComponents:e.grid.frameworkComponents,defaultColDef:e.grid.defaultColDef,rowSelection:"multiple"},null,8,["rowData","columnDefs","onGridReady","frameworkComponents","defaultColDef"])]),(0,a.bF)(m,{style:{width:"100%"},modelValue:e.grid.footer.page,"onUpdate:modelValue":t[7]||(t[7]=function(t){return e.grid.footer.page=t}),max:e.grid.footer.maxPages,onLoad:e.getDepositos,rows:e.grid.rowData},null,8,["modelValue","max","onLoad","rows"])]}),_:1}),(0,a.bF)(p,{modelValue:e.loading.show,total:e.loading.total,procesados:e.loading.procesados,label:e.loading.label},null,8,["modelValue","total","procesados","label"]),(0,a.bF)(h,{modelValue:e.modals.reporte,"onUpdate:modelValue":t[9]||(t[9]=function(t){return e.modals.reporte=t}),showButtonsReporte:"",onExportar:e.generarReporte},{default:(0,a.k6)(function(){return[(0,a.bF)(u,null,{default:(0,a.k6)(function(){return ee()(t[15]||(t[15]=[(0,a.Lk)("div",{class:"row q-ma-xs q-col-gutter-sm"},[(0,a.Lk)("div",{class:"text-h6"},"Reportes Deposito")],-1)]))}),_:1}),(0,a.bF)(u,null,{default:(0,a.k6)(function(){return[(0,a.bF)(g,{options:e.reporte.reportes,modelValue:e.reporte.reporte,"onUpdate:modelValue":t[8]||(t[8]=function(t){return e.reporte.reporte=t}),inline:""},null,8,["options","modelValue"])]}),_:1})]}),_:1},8,["modelValue","onExportar"]),(0,a.bF)(h,{modelValue:e.openModalEditar,"onUpdate:modelValue":t[14]||(t[14]=function(t){return e.openModalEditar=t}),onSubmit:e.editarDeposito,labelButtonOk:"Guardar"},{default:(0,a.k6)(function(){return[(0,a.Lk)("div",ie,[(0,a.Lk)("div",le,[(0,a.Lk)("div",ce,"Editar Deposito: N°"+(0,r.v_)(e.currentData.NUMDEPO),1)])]),(0,a.Lk)("div",ue,[(0,a.Lk)("div",de,[(0,a.bF)(o,{label:"Cuenta Bancaria","option-value":"NUMCTA","option-label":"CTACTE",options:e.ctaBanco,modelValue:e.formEditar.codCtaBanco,"onUpdate:modelValue":t[10]||(t[10]=function(t){return e.formEditar.codCtaBanco=t})},null,8,["options","modelValue"])]),(0,a.Lk)("div",fe,[(0,a.bF)(l,{label:"Fecha Depósito",debounce:"500",maxlength:"10",format:"##/##/####",modelValue:e.formEditar.fecDepo,"onUpdate:modelValue":t[13]||(t[13]=function(t){return e.formEditar.fecDepo=t}),mask:"##/##/####"},{append:(0,a.k6)(function(){return[(0,a.bF)(i,{class:"cursor-pointer",name:"date_range"},{default:(0,a.k6)(function(){return[(0,a.bF)(s,{ref:"qDateProxy2","transition-show":"scale","transition-hide":"scale"},{default:(0,a.k6)(function(){return[(0,a.bF)(n,{mask:"DD/MM/YYYY",modelValue:e.formEditar.fecDepo,"onUpdate:modelValue":t[11]||(t[11]=function(t){return e.formEditar.fecDepo=t}),onInput:t[12]||(t[12]=function(t){return e.closeModalCalendarEdit("qDateProxy2")})},null,8,["modelValue"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])])])]}),_:1},8,["modelValue","onSubmit"])])}var pe=o(91134),ge=o.n(pe),he=o(41562),be=o.n(he),De=(o(30683),o(10239),o(70199),o(27360),o(60858),o(64702),o(53514),o(17915)),we=o(78840),ve={emits:["refresh"],components:{QBtn:I.Il,headerGrid:Y.A,sieGrid:U.A,footerGrid:_.A,QCard:P.A,QCardSection:T.A,QSelect:B.S,QSeparator:V.A,sieModal:L.A,QInput:S.A,QDate:y.A,QPopupProxy:G.A,QDatetime:I.T5,QCheckbox:$.A,crearBotones:z.A,QOptionGroup:W.A,pageHeader:J.A,tesoreriaLoading:De.A,QIcon:I.bP},data:function(){return{filtros:{banco:Q["default"].TODOS,fechaIni:Q["default"].CURRENT_DAY,fechaFin:Q["default"].CURRENT_DAY},grid:{frameworkComponents:{},api:null,params:null,rowData:[],columnDefs:[],footer:{page:1,maxPages:1},defaultColDef:{suppressHeaderMenuButton:!0,filter:!0,floatingFilterComponentParams:{suppressFilterButton:!0},resizable:!0,sortable:!0,suppressDragLeaveHidesColumns:!0}},options:{ctsBancos:[]},loading:{show:!1,procesados:0,total:0,label:"Elimninando"},reporte:{reportes:[{label:"Relación Depósitos ordenados por Fecha",value:"1"},{label:"Relación Depósitos por Cuenta de Banco",value:"2"}],reporte:"1"},modals:{reporte:!1},currentData:[],openModalEditar:!1,formEditar:{codCtaBanco:0,fecDepo:0},ctaBanco:[],messageValidation:""}},methods:ge()(ge()({generarReporte:function(e){var t=document.getElementById("form"),o={FECINI:this.filtros.fechaIni,FECFIN:this.filtros.fechaFin,tipReport:"deposito-fecha",reporte:"1"===this.reporte.reporte?"F":"B",format:e};Q["default"].FORMULARIO_REPORTES(t,o,"")},obtenerDatosTab:function(){return{botones:this.crearBotones(),minAcceso:1,componente:"consultarCreditos"}},onGridReady:function(e){this.grid.api=e.api,this.grid.params=e},closeModalCalendar:function(e){this.getDepositos(),this.$refs[e].hide()},closeModalCalendarEdit:function(e){this.$refs[e].hide()},grabar:function(){},getDepositos:function(){},obtCuentasBancarias:function(){var e=this;return x()(N()().m(function t(){return N()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,Q["default"].API_CTABANCOS();case 1:e.options.ctsBancos=t.v;case 2:return t.a(2)}},t)}))()},columns:function(){var e=this;this.grid.frameworkComponents={agDate:X.A,agActionButton:we.A};var t=[{headerName:"Nro. Despósito",width:120,field:"NUMDEPO"},{headerName:"Cod. Cta.",width:75,field:"NUMCTA"},{headerName:"Banco",width:200,field:"BANCO"},{headerName:"Nro. Cuenta Bancaria",width:200,field:"CTACTE"},{headerName:"Fecha de Déposito",width:150,field:"FECDEPO",valueFormatter:function(e){return(0,j.Ay)(e.value,"DD/MM/YYYY")}},{headerName:"Mon.",width:75,field:"MONSIG",cellStyle:{textAlign:"right"}},{headerName:"Monto",width:120,field:"TOTAL",cellStyle:{textAlign:"right"},valueFormatter:H.toFixed,decimales:2},{cellRenderer:we.A,width:40,cellRendererParams:{icon:"file_pdf",title:"Reporte",onClick:this.imprimir},filter:!1},{cellRenderer:we.A,width:40,cellRendererParams:{icon:"edit",title:"Editar",onClick:function(t){e.abrirEditarDeposito(t.data)}},filter:!1}];this.grid.columnDefs=t},imprimir:function(e){var t={numcta:e.data.NUMCTA,numDepo:e.data.NUMDEPO,usucod:(0,Z["default"])().usucod},o="".concat(origin,"/webservice/reporte-tesoreria/reporte?tipReport=deposito&id=").concat(btoa(JSON.stringify(t)));window.open(o,"_blank")},abrirEditarDeposito:function(e){this.openModalEditar=!0,this.currentData=e,this.formEditar.codCtaBanco=e.NUMCTA,this.formEditar.fecDepo=(0,R.formatearFecha)(new Date(e.FECDEPO))},editarDeposito:function(){var e=this,t={numdepo:this.currentData.NUMDEPO};if(this.currentData.NUMCTA!==this.formEditar.codCtaBanco&&this.currentData.FECDEPO!==this.formEditar.fecDepo&&(this.messageValidation="¿Esta seguro de actualizar la cuenta de Banco y la fecha para el deposito (".concat(this.currentData.NUMDEPO,")?")),this.currentData.NUMCTA!==this.formEditar.codCtaBanco&&(t.CTADEPO=this.formEditar.codCtaBanco,this.messageValidation="¿Esta seguro de actualizar la cuenta de Banco para el deposito (".concat(this.currentData.NUMDEPO,")?")),this.currentData.FECDEPO!==this.formEditar.fecDepo&&(t.FECDEPO=(0,j.Ay)((0,R.convertToYMD)(this.formEditar.fecDepo),"YYYY-MM-DD"),this.messageValidation="¿Esta seguro de actualizar la fecha para el deposito (".concat(this.currentData.NUMDEPO,")?")),this.currentData.NUMCTA===this.formEditar.codCtaBanco&&this.currentData.FECDEPO===this.formEditar.fecDepo)return this.$alert("No edito nigun campo","warning");console.log(t),this.$confirm(this.messageValidation).onOk(x()(N()().m(function o(){return N()().w(function(o){while(1)switch(o.p=o.n){case 0:return e.$q.loading.show(),o.p=1,o.n=2,q.$http.put("api/bancoController/putCuentaBanco",{params:t}).then(function(t){e.$alert(t.message,"success"),e.getDepositos(),e.openModalEditar=!1}).catch(function(t){e.$alert(t.error.message,"error")});case 2:e.$q.loading.hide(),o.n=4;break;case 3:o.p=3,o.v,e.$q.loading.hide();case 4:return o.a(2)}},o,null,[[1,3]])})))},eliminar:function(){var e=this,t=this.grid.api.getSelectedRows();if(0===t.length)return this.$alert("No selecciono ningún registro","warning");this.$confirm("¿Esta seguro de eliminar los depositos?").onOk(x()(N()().m(function o(){var a,r,n,s,i,l,c,u,d,f,m,p,g;return N()().w(function(o){while(1)switch(o.p=o.n){case 0:e.loading.show=!0,e.loading.procesados=0,e.loading.total=t.length,a={error:[],success:[]},r=be()(t),o.p=1,r.s();case 2:if((n=r.n()).done){o.n=8;break}return s=n.value,o.p=3,i={numcta:s.NUMCTA,numdepo:s.NUMDEPO},o.n=4,q.$http.delete("api/BancoController/deleteDeposito",{params:{datos:i}});case 4:l=o.v,a.success.push(l),o.n=6;break;case 5:o.p=5,p=o.v,a.error.push(p.error?p.error.message:p.message);case 6:return o.p=6,e.loading.procesados++,o.f(6);case 7:o.n=2;break;case 8:o.n=10;break;case 9:o.p=9,g=o.v,r.e(g);case 10:return o.p=10,r.f(),o.f(10);case 11:c=a.error,u=a.success,d={message:"",icon:"success"},1===c.length&&0===u.length&&(f=E()(c,1),m=f[0],d.message=m,d.icon="warning"),c.length>1&&0===u.length&&(d.message="Proceso Finalizado: (".concat(t.length,") depositos no Eliminados"),d.icon="warning"),0===c.length&&u.length>0&&(d.message="Proceso Finalizado: (".concat(t.length,") Depositos Eliminados Satisfactoriamente")),c.length>0&&u.length>0&&(d.message="Proceso Finalizado: (".concat(t.length,") Depositos no Eliminados y (").concat(t.length,") eliminados")),e.$alert(d.message,d.icon,!0),e.$emit("refresh"),e.getDepositos(),e.loading.show=!1;case 12:return o.a(2)}},o,null,[[3,5,6,7],[1,9,10,11]])})))},modalReporte:function(){this.modals.reporte=!0}},"getDepositos",function(){var e=this;return x()(N()().m(function t(){var o,a;return N()().w(function(t){while(1)switch(t.n){case 0:return o={fecini:(0,R.convertToYMD)(e.filtros.fechaIni),fecfin:(0,R.convertToYMD)(e.filtros.fechaFin),tipo:1},e.filtros.banco!==Q["default"].TODOS&&(o.banco=e.filtros.banco),t.n=1,q.$http.get("api/BancoController/getDepositos",{params:{datos:o}});case 1:a=t.v,e.grid.rowData=a;case 2:return t.a(2)}},t)}))()}),"crearBotones",function(){var e=[{label:"Eliminar",icon:"delete",click:this.eliminar,minAcceso:1},{label:"Formatos",icon:"print_r",click:this.modalReporte,minAcceso:1}];return e}),beforeMount:function(){var e=this;return x()(N()().m(function t(){return N()().w(function(t){while(1)switch(t.n){case 0:return e.columns(),e.crearBotones(),e.obtCuentasBancarias(),e.getDepositos(),t.n=1,q.$http.get("api/bancoController/getCuentasBancarias",{params:{parametros:{response:"combo"}}});case 1:e.ctaBanco=t.v;case 2:return t.a(2)}},t)}))()}},Ce=o(12807);const ke=(0,Ce.A)(ve,[["render",me]]);var Ae=ke,Fe={components:{QBtn:I.Il,headerGrid:Y.A,sieGrid:U.A,footerGrid:_.A,QCard:P.A,QCardSection:T.A,QSelect:B.S,QSeparator:V.A,sieModal:L.A,QInput:S.A,QDate:y.A,QPopupProxy:G.A,QDatetime:I.T5,QCheckbox:$.A,crearBotones:z.A,QOptionGroup:W.A,pageHeader:J.A,consultar:Ae,QIcon:I.bP},data:function(){return{pageHeader:{botones:[],componente:"deposito",nivelAcceso:3,tabs:[{name:"tabIndex",label:"registro"},{name:"tabConsultar",label:"consultar"}],title:"Depositos Bancarios"},form:{nroDeposito:"",banco:"",fecha:Q["default"].CURRENT_DAY},filtros:{fechaIni:Q["default"].CURRENT_DAY,fechaFin:Q["default"].CURRENT_DAY,empresa:Q["default"].TODOS},models:{total:0,banco:{MONSIG:"S/"}},tabs:{tab:"tabIndex",keysTabs:{registro:"tabIndex",consultar:"tabConsultar"},tabActivo:"tabIndex"},grid:{frameworkComponents:{},api:null,params:null,rowData:[],columnDefs:[],defaultColDef:{suppressHeaderMenuButton:!0,filter:!0,floatingFilterComponentParams:{suppressFilterButton:!0},resizable:!0,sortable:!0,suppressDragLeaveHidesColumns:!0},footer:{page:1,maxPages:1}},data:{bancos:[]},options:{ctsBancos:[],empresas:[]}}},beforeMount:function(){var e=this;return x()(N()().m(function t(){return N()().w(function(t){while(1)switch(t.n){case 0:e.columns(),e.obtCuentasBancarias(),e.crearBotones(),e.getEmpresas();case 1:return t.a(2)}},t)}))()},methods:{getEmpresas:function(){var e=this;return x()(N()().m(function t(){var o;return N()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,q.$http.get("api/empresaController/getEmpresas");case 1:o=t.v,e.options.empresas=o.map(function(e){return{value:e.EMPCOD,label:e.RAZONSOCIAL}}),e.options.empresas.unshift({label:"Todos",value:"T"});case 2:return t.a(2)}},t)}))()},getLabelTotal:function(){var e=this;try{var t=this.grid.api.getSelectedRows(),o=t.reduce(function(t,o){return e.models.banco.MONCOD===o.MONCOD&&(t+=Number(o.MONTOTPAG)),t},0);this.models.total=o}catch(e){console.log(e.message)}},changeTab:function(e){var t=this;return x()(N()().m(function o(){var a;return N()().w(function(o){while(1)switch(o.n){case 0:if(t.tabs.tabActivo=e,e!==t.tabs.keysTabs.registro){o.n=1;break}return t.pageHeader.botones=t.crearBotones(),t.pageHeader.componente="deposito",t.pageHeader.nivelAcceso=(0,Z["default"])().ruta.nivel,o.a(2,!0);case 1:return o.n=2,t.$refs[e].obtenerDatosTab();case 2:a=o.v,t.pageHeader.botones=a.botones,t.pageHeader.componente=a.componente,t.pageHeader.nivelAcceso=a.minAcceso;case 3:return o.a(2)}},o)}))()},onGridReady:function(e){this.grid.api=e.api,this.grid.params=e},closeModalCalendar:function(e){this.getPagosCaja(),this.$refs[e].hide()},validarDeposito:function(){try{var e=this.grid.api.getSelectedRows();if(0===e.length)throw new Error("No selecciono ningún registro");if(!this.form.nroDeposito||0===String(this.form.nroDeposito).trim().length)throw new Error("No ingreso el nro de depósito");if(!this.form.banco)throw new Error("No selecciono el banco");if(!this.form.fecha)throw new Error("No selecciono la fecha");return!0}catch(e){throw new Error(e.error?e.error.message:e.message,"warning")}},getItemsSeleccionados:function(){return this.grid.api.getSelectedRows()},generarCabeceraDeposito:function(){var e={NUMDEPO:this.form.nroDeposito,CTADEPO:this.form.banco,MONCOD:this.models.banco.MONCOD,FECDEPO:(0,R.convertToYMD)(this.form.fecha),MONTOTDEPO:this.getItemsSeleccionados().reduce(function(e,t){return e+Number(t.MONTOTPAG)},0).toFixed(2)};return e},generarDetalle:function(){var e=this,t=this.getItemsSeleccionados(),o=t.map(function(t){return{NUMDEPO:e.form.nroDeposito,CTADEPO:e.form.banco,NUMTAL:t.NUMTAL,NUMPAG:t.NUMPAG,MONTODEPO:t.MONTOTPAG}});return o},grabar:function(){var e=this;return x()(N()().m(function t(){var o;return N()().w(function(t){while(1)switch(t.p=t.n){case 0:t.p=0,e.validarDeposito(),e.$confirm("¿Está seguro de ejecutar el proceso").onOk(x()(N()().m(function t(){var o,a,r;return N()().w(function(t){while(1)switch(t.p=t.n){case 0:return t.p=0,e.$q.loading.show(),o={cabecera:e.generarCabeceraDeposito(),detalle:e.generarDetalle()},t.n=1,q.$http.post("api/bancoController/postRegistrarDeposito",{datos:o});case 1:a=t.v,e.form.nroDeposito="",e.$alert(a.message,"success"),e.getPagosCaja(),e.$refs[e.tabs.keysTabs.consultar].getDepositos(),t.n=3;break;case 2:return t.p=2,r=t.v,t.a(2,e.$alert(r.error?r.error.message:r.message,"warning"));case 3:return t.p=3,e.$q.loading.hide(),t.f(3);case 4:return t.a(2)}},t,null,[[0,2,3,4]])}))),t.n=2;break;case 1:return t.p=1,o=t.v,t.a(2,e.$alert(o.error?o.error.message:o.message,"warning"));case 2:return t.a(2)}},t,null,[[0,1]])}))()},getPagosCaja:function(){var e=this;return x()(N()().m(function t(){var o,a,r,n,s;return N()().w(function(t){while(1)switch(t.n){case 0:return e.$q.loading.show(),o={fecini:(0,R.convertToYMD)(e.filtros.fechaIni),fecfin:(0,R.convertToYMD)(e.filtros.fechaFin)},e.filtros.empresa!==Q["default"].TODOS&&(o.empcod=e.filtros.empresa),t.n=1,q.$http.get("api/PagoController/getRelacionPagosDeposito",{params:{parametros:o}});case 1:a=t.v,r=a,e.grid.rowData=r.filter(function(t){return t.MONCOD===e.models.banco.MONCOD}),e.models.total=0,e.grid.rowData.length>0&&(n=E()(e.grid.rowData,1),s=n[0],e.models.banco.MONSIG=s.MONEDA),e.$q.loading.hide();case 2:return t.a(2)}},t)}))()},getDatosBanncos:function(){var e=this;this.models.banco=this.data.bancos.find(function(t){return t.NUMCTA===e.form.banco}),this.getPagosCaja()},obtCuentasBancarias:function(){var e=this;return x()(N()().m(function t(){var o,a;return N()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,q.$http.get("api/bancoController/getCuentasBancarias",{params:{parametros:{response:""}}});case 1:return e.data.bancos=t.v,t.n=2,Q["default"].API_CTABANCOS(!1);case 2:if(e.options.ctsBancos=t.v,0!==e.data.bancos.length){t.n=3;break}return e.$alert("No tiene regitrado ninguna cuentaria","warning"),t.a(2,!1);case 3:o=E()(e.options.ctsBancos,1),a=o[0],e.form.banco=a.value,e.getDatosBanncos();case 4:return t.a(2)}},t)}))()},columns:function(){var e=this;return x()(N()().m(function t(){var o;return N()().w(function(t){while(1)switch(t.n){case 0:return e.grid.frameworkComponents={agDate:X.A,actionButton:we.A},o=[{headerName:"Nro. Doc.",width:120,field:"NRODOC"},{headerName:"Código",width:120,field:"CODIGO"},{headerName:"Apellidos y Nombres/Razón Social",field:"NOMBRE",width:325},{headerName:"Fec. Emisión",width:130,field:"FECEMI",valueFormatter:function(e){return(0,j.Ay)(e.value,"DD/MM/YYYY")},filter:!1},{headerName:"Fec. Pago",width:120,field:"FECPAG",valueFormatter:function(e){return(0,j.Ay)(e.value,"DD/MM/YYYY")},filter:!1},{headerName:"Mon.",field:"MONSIG",width:60,cellStyle:{textAlign:"right"}},{headerName:"Monto",width:120,field:"MONTOTPAG",valueFormatter:H.toFixed,decimales:2,cellStyle:{textAlign:"right"}},{headerName:"",cellRenderer:we.A,cellRendererParams:{icon:"file_pdf",title:"Exportar PDF",onClick:e.imprimir},width:40,filter:!1,resizable:!1,sortable:!1}],e.grid.columnDefs=o,t.n=1,e.getPagosCaja();case 1:return t.a(2)}},t)}))()},imprimir:function(e){var t=e.data,o=t.NUMPAG,a=t.NUMTAL,r=(0,Z["default"])().origin;Q["default"].IMPRIMIR_COMPROBANTE(r,a,o)},crearBotones:function(){var e=[{label:"Grabar",icon:"save",click:this.grabar,minAcceso:1}];return this.pageHeader.botones=e,e}}};const Ee=(0,Ce.A)(Fe,[["render",A]]);var Me=Ee}}]);