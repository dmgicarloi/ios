"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[57580],{57580:function(e,n,o){o.r(n),o.d(n,{default:function(){return O}});var t=o(8445),a=o.n(t),l=o(61758),r=o(58790),i={class:"col col-12"},u={class:"col col-12 bg-white"},c={class:"col col-12 bg-white"},s={class:"text-black"},d={class:"text-black"};function f(e,n){var o=(0,l.g2)("q-tooltip"),t=(0,l.g2)("q-fab-action"),f=(0,l.g2)("q-spinner-oval"),p=(0,l.g2)("q-inner-loading"),m=(0,l.g2)("q-alert"),b=(0,l.g2)("q-item-label"),g=(0,l.g2)("q-item-section"),k=(0,l.g2)("q-item"),F=(0,l.g2)("q-list"),_=(0,l.g2)("importar"),v=(0,l.g2)("q-radio"),h=(0,l.g2)("q-checkbox"),x=(0,l.g2)("sie-modal"),A=(0,l.g2)("q-table");return(0,l.uX)(),(0,l.CE)("div",null,[(0,l.bF)(_,{url:e.url,onImport:e.loadTemplate,onProcess:e.abrirModalProceso},{helptext:(0,l.k6)(function(){return a()(n[9]||(n[9]=[(0,l.Lk)("dd",null,"- Primero exportar la plantilla",-1),(0,l.Lk)("dd",null,"- No modificar el archivo generado por el sistema",-1),(0,l.Lk)("dd",null,"- No insertar columnas ni filas",-1),(0,l.Lk)("dd",null,"- Solo llenar la información solicitada",-1)]))}),buttons:(0,l.k6)(function(){return[(0,l.bF)(t,{color:"secondary",icon:"file_excel",onClick:n[0]||(n[0]=function(n){return e.openModalFields=!0})},{default:(0,l.k6)(function(){return[(0,l.bF)(o,{anchor:"center left",self:"center right"},{default:(0,l.k6)(function(){return a()(n[10]||(n[10]=[(0,l.eW)("Exportar plantilla",-1)]))}),_:1})]}),_:1})]}),grid:(0,l.k6)(function(){return[(0,l.bF)(p,{class:"col",visible:""!=e.textoProgreso},{default:(0,l.k6)(function(){return[(0,l.bF)(f,{size:"50px",color:"primary"}),(0,l.Lk)("label",null,(0,r.v_)(e.textoProgreso),1)]}),_:1},8,["visible"]),""!=e.objResponse.informe?((0,l.uX)(),(0,l.CE)(l.FK,{key:0},[(0,l.Lk)("div",i,[(0,l.bF)(m,{type:"positive"},{default:(0,l.k6)(function(){return[(0,l.Lk)("div",null,(0,r.v_)(e.objResponse.informe),1)]}),_:1})]),(0,l.Lk)("div",u,[(0,l.bF)(F,{bordered:"",separator:""},{default:(0,l.k6)(function(){return[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.objResponse.errores,function(e,n){return(0,l.uX)(),(0,l.Wv)(k,{key:"e_"+n,separator:""},{default:(0,l.k6)(function(){return[(0,l.bF)(g,null,{default:(0,l.k6)(function(){return[(0,l.bF)(b,{class:"text-red"},{default:(0,l.k6)(function(){return[(0,l.eW)((0,r.v_)(e),1)]}),_:2},1024)]}),_:2},1024)]}),_:2},1024)}),128)),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.objResponse.infoLog,function(e,n){return(0,l.uX)(),(0,l.Wv)(k,{key:"i_"+n,separator:""},{default:(0,l.k6)(function(){return[(0,l.bF)(g,null,{default:(0,l.k6)(function(){return[(0,l.bF)(b,null,{default:(0,l.k6)(function(){return[(0,l.eW)((0,r.v_)(e),1)]}),_:2},1024)]}),_:2},1024)]}),_:2},1024)}),128))]}),_:1})])],64)):(0,l.Q3)("v-if",!0)]}),_:1},8,["url","onImport","onProcess"]),(0,l.bF)(x,{modelValue:e.openModalConfirm,"onUpdate:modelValue":n[5]||(n[5]=function(n){return e.openModalConfirm=n}),title:"Seleccione tipo de importación",css:{minWidth:"40vw"},onSubmit:e.procesar,ok:"Procesar"},{default:(0,l.k6)(function(){return[(0,l.Lk)("div",c,[(0,l.bF)(F,{bordered:"",separator:""},{default:(0,l.k6)(function(){return[(0,l.bF)(k,null,{default:(0,l.k6)(function(){return[(0,l.bF)(g,null,{default:(0,l.k6)(function(){return[(0,l.bF)(b,null,{default:(0,l.k6)(function(){return[(0,l.bF)(v,{class:"text-bold",modelValue:e.tipoMigracion,"onUpdate:modelValue":n[1]||(n[1]=function(n){return e.tipoMigracion=n}),val:1,label:"AÑO DE INGRESO "+(e.anioToken-1)+" ESTADO DEL ALUMNO: PROMOVIDO Y EX-ALUMNO"},null,8,["modelValue","label"])]}),_:1}),(0,l.bF)(b,null,{default:(0,l.k6)(function(){return[(0,l.eW)("- Todos los alumnos se crearán con año de ingreso "+(0,r.v_)(e.anioToken-1)+" y con estado Promovido o Ex-alumno.",1)]}),_:1}),(0,l.bF)(b,null,{default:(0,l.k6)(function(){return[(0,l.eW)("- Crear salones "+(0,r.v_)(e.anioToken-1)+".",1)]}),_:1}),(0,l.bF)(b,null,{default:(0,l.k6)(function(){return[(0,l.eW)("- Registrar en sistuación del alumno en el año "+(0,r.v_)(e.anioToken-1)+" (histórico).",1)]}),_:1}),(0,l.bF)(b,null,{default:(0,l.k6)(function(){return[(0,l.eW)("- Crear salones "+(0,r.v_)(e.anioToken)+".",1)]}),_:1}),(0,l.bF)(b,null,{default:(0,l.k6)(function(){return a()(n[11]||(n[11]=[(0,l.eW)("- No toma en cuenta la columna año de ingreso ni estado del alumno del archivo excel.",-1)]))}),_:1})]}),_:1})]}),_:1}),(0,l.bF)(k,null,{default:(0,l.k6)(function(){return[(0,l.bF)(g,null,{default:(0,l.k6)(function(){return[(0,l.bF)(b,null,{default:(0,l.k6)(function(){return[(0,l.bF)(v,{class:"text-bold",modelValue:e.tipoMigracion,"onUpdate:modelValue":n[2]||(n[2]=function(n){return e.tipoMigracion=n}),val:2,label:"AÑO DE INGRESO "+e.anioToken+" ESTADO DEL ALUMNO: VIGENTE"},null,8,["modelValue","label"])]}),_:1}),(0,l.bF)(b,null,{default:(0,l.k6)(function(){return[(0,l.eW)("- Todos los alumnos se crearán con año de ingreso "+(0,r.v_)(e.anioToken)+" y con estado Vigente.",1)]}),_:1}),(0,l.bF)(b,null,{default:(0,l.k6)(function(){return[(0,l.eW)("- Crear salones "+(0,r.v_)(e.anioToken)+".",1)]}),_:1}),(0,l.bF)(b,null,{default:(0,l.k6)(function(){return[(0,l.eW)("- Registrar en situación del alumno en el año "+(0,r.v_)(e.anioToken)+".",1)]}),_:1}),(0,l.bF)(b,null,{default:(0,l.k6)(function(){return a()(n[12]||(n[12]=[(0,l.eW)("- No toma en cuenta la columna año de ingreso ni estado del alumno del archivo excel.",-1)]))}),_:1})]}),_:1})]}),_:1}),(0,l.bF)(k,null,{default:(0,l.k6)(function(){return[(0,l.bF)(g,null,{default:(0,l.k6)(function(){return[(0,l.bF)(b,null,{default:(0,l.k6)(function(){return[(0,l.bF)(v,{class:"text-bold",modelValue:e.tipoMigracion,"onUpdate:modelValue":n[3]||(n[3]=function(n){return e.tipoMigracion=n}),val:3,label:"AÑO DE INGRESO Y ESTADO DEL ALUMNO PERSONALIZADO"},null,8,["modelValue"])]}),_:1}),(0,l.bF)(b,null,{default:(0,l.k6)(function(){return a()(n[13]||(n[13]=[(0,l.eW)("- Todos los alumnos se crearán con año de ingreso y con estado del Excel.",-1)]))}),_:1})]}),_:1})]}),_:1}),(0,l.bF)(k,null,{default:(0,l.k6)(function(){return[(0,l.bF)(g,null,{default:(0,l.k6)(function(){return[(0,l.bF)(b,{class:"text-bold"},{default:(0,l.k6)(function(){return a()(n[14]||(n[14]=[(0,l.eW)("Para las 3 opciones anteriores:",-1)]))}),_:1}),(0,l.bF)(b,null,{default:(0,l.k6)(function(){return[(0,l.bF)(h,{modelValue:e.alucodDni,"onUpdate:modelValue":n[4]||(n[4]=function(n){return e.alucodDni=n}),label:"Usar el Dni como Código de alumno",color:"teal"},null,8,["modelValue"])]}),_:1})]}),_:1})]}),_:1}),(0,l.bF)(k,null,{default:(0,l.k6)(function(){return[(0,l.bF)(g,null,{default:(0,l.k6)(function(){return[(0,l.bF)(m,{type:"warning"},{default:(0,l.k6)(function(){return[(0,l.Lk)("div",s,"Si no existe la columna Código de Familia se tomará el correlativo del año "+(0,r.v_)(e.anioIng)+".",1),(0,l.Lk)("div",d,"Si no existe la columna Código de Alumno o Dni, se tomará el correlativo del año "+(0,r.v_)(e.anioIng)+".",1),n[15]||(n[15]=(0,l.Lk)("div",{class:"text-black"},"Si no existen algunos los datos del nivel, grado o sección, no se procede con la matrícula.",-1))]}),_:1})]}),_:1})]}),_:1})]}),_:1})])]}),_:1},8,["modelValue","onSubmit"]),(0,l.bF)(x,{modelValue:e.openModalFields,"onUpdate:modelValue":n[8]||(n[8]=function(n){return e.openModalFields=n}),title:"Seleccione los campos a exportar",css:{minWidth:"40vw"},onSubmit:e.exportar,ok:"Exportar"},{default:(0,l.k6)(function(){return[(0,l.bF)(A,{"table-class":"no-scroll",data:e.dataCampos,columns:e.columnsCampos,selected:e.dataSelected,"onUpdate:selected":n[6]||(n[6]=function(n){return e.dataSelected=n}),pagination:e.paginationFields,"onUpdate:pagination":n[7]||(n[7]=function(n){return e.paginationFields=n}),"rows-per-page-options":[0],"hide-bottom":"","row-key":"ID",selection:"multiple",color:"primary"},null,8,["data","columns","selected","pagination"])]}),_:1},8,["modelValue","onSubmit"])])}var p=o(76080),m=o.n(p),b=o(45254),g=o.n(b),k=(o(30683),o(71225),o(74260),o(52133),o(50310),o(5962),o(32203),o(6724),o(70199),o(83190),o(68017),o(80660)),F=o(6123),_=o(24729),v=o(57668),h=o(80340),x=o(30640),A=o(982),C=o(46267),E=o(65673),L=o(82327),S=o(88865),T=o(66824),I={components:{QTable:F.kH,QTr:F.qh,QTd:F.Ef,QFab:F.l6,QFabAction:F.B$,Dialog:_.A,sieVacio:h.A,sieModal:x.A,notify:A["default"],importar:C.A,QInnerLoading:F.SQ,QSpinnerOval:F.VA,QRadio:F.$,QCheckbox:F.vZ,QAlert:F.ex,QList:E.A,QItem:L.A,QItemSection:S.A,QItemLabel:T.A,QTooltip:F.nC},data:function(){return{objResponse:{informe:"",errores:[],infoLog:[]},alucodDni:!0,tipoMigracion:1,textoProgreso:"",openModalConfirm:!1,anioToken:(0,v["default"])().ano,url:"api/HyoExcel/cargarDataFamAlu",tipo:"1",openModalFields:!1,dataTemplate:[],dataCampos:[],dataSelected:[],urlExp:"/".concat(k.API_LMS,"/api/HyoExcel/exportPlantillaPersonalizada"),columnsCampos:[{name:"DESCRIPCION",label:"SELECCIONAR TODOS",field:"DESCRIPCION",align:"left"}],pagination:{sortBy:null,descending:!1,page:1,rowsPerPage:20},paginationFields:{sortBy:null,descending:!1,page:1,rowsPerPage:2e4}}},computed:{anioIng:function(){return 1===parseInt(this.tipoMigracion,10)?this.anioToken-1:this.anioToken}},methods:{init:function(){this.obtenerCamposAExp()},obtenerCamposAExp:function(){var e=this;this.$http.get("api/HyoMCampos/obtCampos",{params:{tabla:["ALUMNO","FAMILIA"]}}).then(function(n){var o=n.json;e.dataCampos=o,e.dataSelected=o.filter(function(e){return"S"===e.OBLIGATORIO.trim()})}).catch(function(e){console.log(e)})},loadTemplate:function(e){this.dataTemplate=e.json,this.abrirModalProceso()},exportar:function(){var e=this.dataSelected.map(function(e){return e.ID});location.href=this.urlExp+"?sie-token="+(0,v["default"])().token+"&data="+JSON.stringify(e)},abrirModalProceso:function(){this.dataTemplate.length>0?this.openModalConfirm=!0:this.$q.dialog({title:"Aviso",message:"No hay información para importar",ok:"Aceptar"})},procesar:function(){var e=this;return g()(m()().m(function n(){var o,t,a;return m()().w(function(n){while(1)switch(n.p=n.n){case 0:return e.openModalConfirm=!1,e.objResponse={informe:"",errores:[],infoLog:[]},e.textoProgreso="Cargando..",n.p=1,n.n=2,(0,k.stream)("api/HyoMigracion/migrarFamiliaEstudianteP",{method:"POST",data:{data:e.dataTemplate,tipo:e.tipoMigracion,anioIng:e.anioIng,alucodDni:e.alucodDni}},function(n){n&&"fila"in n?e.textoProgreso="Procesando fila: ".concat(n.fila," de ").concat(e.dataTemplate.length):n&&"progreso"in n&&(e.textoProgreso=n.progreso)});case 2:o=n.v,(0,A["default"])("Proceso Finalizado, ver el detalle en pantalla principal"),t=o.find(function(e){return"respuesta"in e}).respuesta,e.objResponse={informe:t.informe,errores:t.errores,infoLog:t.infoLog},n.n=4;break;case 3:n.p=3,a=n.v,(0,A["default"])(a.message,"error");case 4:e.textoProgreso="";case 5:return n.a(2)}},n,null,[[1,3]])}))()}},created:function(){this.init()}},M=o(12807);const P=(0,M.A)(I,[["render",f]]);var O=P}}]);