"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[48049],{48049:function(e,a,t){t.r(a),t.d(a,{default:function(){return w}});var r=t(61758),d=t(58790),i={class:"row items-center no-wrap"},o={class:"col"},l={class:"text-h6"},n={class:"col-auto"};function s(e,a){var t=(0,r.g2)("q-btn"),s=(0,r.g2)("q-card-section"),c=(0,r.g2)("q-separator"),u=(0,r.g2)("q-card"),h=(0,r.g2)("q-page");return(0,r.uX)(),(0,r.Wv)(h,null,{default:(0,r.k6)(function(){return[(0,r.bF)(u,{class:"layout-v1 col my-card",flat:"",bordered:""},{default:(0,r.k6)(function(){return[(0,r.bF)(s,null,{default:(0,r.k6)(function(){return[(0,r.Lk)("div",i,[(0,r.Lk)("div",o,[(0,r.Lk)("div",l,(0,d.v_)(e.title),1),(0,r.Q3)("div.q-card-subtitle {{subtitle}}")]),(0,r.Lk)("div",n,[e.nivelAcceso>=2?((0,r.uX)(),(0,r.Wv)(t,{key:0,class:"q-mr-sm",icon:"add",color:"primary",label:"Apertura",size:"sm",onClick:e.apertura},null,8,["onClick"])):(0,r.Q3)("v-if",!0),(0,r.Q3)('q-btn.q-mr-sm( v-if ="nivelAcceso >= 2" slot="right" icon="add" color="primary" label="Nuevo" size="sm" @click="agregar")')])])]}),_:1}),(0,r.bF)(c),(0,r.Q3)('q-card-sectioncreate-grid( :refresh="refresh" :config="config" :methodUpdate="methodUpdate" @clickdelete="deleted" @clickedit="edit" :methodGet="methodGet")'),(0,r.Q3)('template(v-if="openModal")//modal edit -add\ncreate-form(@updated="loadList" :idFormulario="idFormulario" :modal="true" v-model="openModal" :methodUpdate="methodUpdate" :methodAdd="methodAdd" :primary="[\'ID_CAJA_USU\']" :dataform="dataEdit")'),(0,r.Q3)('template(v-if="openModalApertura")create-form( :dataform="dataEdit" @change="updatedForm" @updated="aperturarCaja" :idFormulario="24" :modal="true" v-model="openModalApertura" :primary="[\'ID_CAJA_USU\']")\n    create-grid(ref="grid"  :local="true" :refresh="refreshModal" :config="configGrid" :methodGet="methodGrid.methodGet" styles="width: 100%; height: 150px")')]}),_:1})]}),_:1})}var c=t(57008),u=t.n(c),h=(t(30683),t(77507),t(10239),t(80660)),m=t(57668),f=t(7729),A=t(10213),p=t(30640),C=t(42037),g=t(26697),O=t(53093),M=t(43346),N=t(53811),D=t(88567),v=t(95718),_=t(53380),E=t(18105),I=t(6123),b=t(16648),U={props:{methodGet:{type:String,default:"cajaController/getCajaApertura"},methodDelete:{type:String,default:"cajaController/deleteCajaApertura"},methodAdd:{type:String,default:"cajaController/addCajaUsuario"},methodUpdate:{type:String,default:"cajaController/updateCajaUsuario"}},components:{createGrid:f.A,QCard:D.A,QCardSection:v.A,QSeparator:_.A,QTabs:g.A,QTab:O.A,QTabPanels:N.A,QTabPanel:M.A,QPagination:I.ao,sieModal:p.A,QSearch:I.Ks,QSelect:b.A,QPage:I.Tu,QBtn:I.Il},data:function(){return{currentEdit:!1,refresh:1,title:"Apertura Caja",subtitle:"Hisorial de aperturas de caja",nivelAcceso:(0,m["default"])().ruta.nivel,dataEdit:{},vjson:2,rowData:[],columnDefs:[],frameworkComponents:null,pagina:1,max:10,schema:{},openModal:!1,titleModalAdd:"",idFormulario:23,campoDelete:["ID_CAJA_USU"],campoMsgDelete:"NOMCOMP",campos:[],order:null,routeEdit:null,routeAdd:null,paramsEdit:{},modoAdd:1,modoEdit:1,refreshModal:1,openModalApertura:!1,monedas:[],config:{vjson:2,tabla:[{width:50,headerName:"",field:"ID_CAJA",hide:!0},{width:50,headerName:"",field:"ID_CAJA_USU",hide:!0},{width:50,headerName:"",field:"ID_CAJA_DIARIO",hide:!0},{width:150,headerName:"Caja",field:"NOMBRE",resizable:!0},{width:300,headerName:"Cajero",field:"NOMCOMP",resizable:!0},{width:80,headerName:"Moneda",field:"MONCOD",hide:!0},{width:80,headerName:"Moneda",field:"MONNOM"},{width:120,headerName:"Fecha apertura",field:"FECHA",valueFormatter:function(e){return(0,E.Ay)(e.value,"DD/MM/YYYY")}},{width:80,headerName:"Turno",field:"TURNONOM"},{width:80,headerName:"Cerrada",field:"CIERRE",valueFormatter:function(e){return 0===e.value?"No":"Sí"}},{width:125,headerName:"Monto Apertura",field:"MONTOAPER",cellClass:"text-right",valueFormatter:C.toFixed,decimales:this.decimales},{width:125,headerName:"Monto Cobrado",field:"MONTOCOB",cellClass:"text-right",valueFormatter:C.toFixed,decimales:this.decimales},{width:125,headerName:"Monto Cierre",field:"MONTOCIERRE",cellClass:"text-right",valueFormatter:C.toFixed,decimales:this.decimales}],btnEdit:!0,btnDelete:!0,idFormulario:24,primary:["ID_CAJA_USU"],campoMsgDelete:"NOMCOMP",order:null},methodGrid:{methodUpdate:"",methodAdd:"agregaCaja",methodGet:"cajaController/getCajaDiario",methodDelete:""},decimales:2,configGrid:{msgErrorLocal:"No es posible eliminar tablas aperturadas. ",filtro:{ID_CAJA_DIARIO:0},tabla:[{headerName:"Código",field:"ID_CAJA_DIARIO",width:80,hide:!0},{headerName:"Moneda",field:"MONCOD",editable:!0,cellRenderer:agSelect,cellRendererParams:{dValue:"MONCOD",dLabel:"MONNOM",defaultvalue:"001",maxval:["001","002","003"],api:"api/cobroController/getMoneda"},width:120},{headerName:"Monto Apertura",field:"MONTOAPER",editable:!0,singleClickEdit:!0,valueFormatter:C.toFixed,decimales:this.decimales,cellClass:"text-right",width:120},{headerName:"Monto Cobrado",field:"MONTOCOB",editable:!1,valueFormatter:C.toFixed,decimales:this.decimales,cellClass:"text-right",width:120},{headerName:"Monto Cierre",field:"MONTOCIERRE",editable:!0,singleClickEdit:!0,valueFormatter:C.toFixed,decimales:this.decimales,cellClass:"text-right",width:100}],btnEdit:!1,btnDelete:!0,idFormulario:24,primary:["ID_CAJA_DIARIO","MONCOD"],campoMsgDelete:"NOMCOMP",order:null}}},methods:{loadList:function(){this.refresh=this.refresh+1},updatedForm:function(e){if(!this.currentEdit){var a=e.ID_CAJA_USU,t=e.FECHA,r=e.TURNO;if(a&&t&&r){t=t.split("/").reverse().join("/");var d=u()({},this.configGrid);d.filtro={ID_CAJA_USU:a,FECHA:t,TURNO:r},this.configGrid=u()({},d)}}},aperturarCaja:function(e){var a=this;this.currentEdit=!1;var t=this.$refs.grid.rowData;if(!(t.length>0))return(0,A.alert)("Debe ingresar un monto de apertura","warning"),!1;e.ID_CAJA_DIARIO=t[0].ID_CAJA_DIARIO,e.FECHA=e.FECHA.split("/").reverse().join("/");var r={apertura:e,detalle:t};h.$http.post("api/cajaController/addAperturaCaja",{data:r}).then(function(e){a.openModalApertura=!1,a.refresh=a.refresh+1,(0,A.alert)(e.message,"success")}).catch(function(e){var a=e.error;(0,A.alert)(a.message,"warning")})},edit:function(e){this.currentEdit=!0;var a=e.data,t=a.ID_CAJA_USU,r=a.NOMBRE,d=a.MONCOD,i=a.FECHA,o=a.TURNO,l=a.CIERRE;this.dataEdit={ID_CAJA_USU:t,NOMBRE:r,MONCOD:d,FECHA:i,TURNO:o,CIERRE:l};var n=u()({},this.configGrid);n.filtro={ID_CAJA_USU:t,FECHA:i,TURNO:o,MONCOD:d},this.configGrid=u()({},n),this.openModalApertura=!0},apertura:function(){var e=u()({},this.configGrid);e.filtro={ID_CAJA_USU:0},this.configGrid=u()({},e),this.openModalApertura=!0},agregar:function(e){1===this.modoAdd?this.openModal=!0:this.$router.push({name:this.routeAdd})},deleted:function(e){var a=this,t=e.data,r=t.NOMCOMP,d=t.NOMBRE,i=t.MONCOD,o=t.ID_CAJA_DIARIO;(0,A.confirm)("Esta seguro de eliminar la apertura del usuario \n ".concat(r," de la caja ").concat(d),"delete").onOk(function(){h.$http.delete("api/".concat(a.methodDelete),{params:{MONCOD:i,ID_CAJA_DIARIO:o}}).then(function(e){a.refresh=a.refresh+1,(0,A.alert)("Registro Eliminado")}).catch(function(e){var a=e.error;console.error(a),(0,A.alert)("No se puede eliminar la apertura de caja ".concat(a.message),"warning")})})},getMonedas:function(){return h.$http.get("api/cobroController/getMoneda",{params:{response:"combo"}})}}},F=t(12807);const R=(0,F.A)(U,[["render",s]]);var w=R}}]);