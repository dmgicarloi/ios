"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[83360],{83360:function(e,o,a){a.r(o),a.d(o,{default:function(){return fe}});var l=a(8445),t=a.n(l),n=(a(71225),a(50310),a(5962),a(83190),a(61758)),i=a(58790),r={class:"col"},s={class:"row col"},d={class:"row col justify-aroud"},u={class:"col row justify-center"},c={class:"col row justify-end"},f={class:"col q-ma-xs"},m={class:"col row"},v={class:"q-ml-xs"},p={class:"q-ml-xs"},b={class:"col row"},h={class:"q-ml-xs"},$={class:"col q-pa-xs border-field q-mb-sm"},k={class:"leyenda"},V={class:"col row"},I={class:"q-ml-xs"},g={class:"col row"},E={class:"q-ml-xs"},q={key:0,class:"col row"},y={class:"q-ml-xs"},O={class:"q-ma-xs"};function D(e,o){var a=(0,n.g2)("q-td"),l=(0,n.g2)("q-icon"),D=(0,n.g2)("q-tooltip"),_=(0,n.g2)("q-search"),S=(0,n.g2)("q-datetime"),F=(0,n.g2)("q-select"),M=(0,n.g2)("q-btn"),w=(0,n.g2)("q-table"),C=(0,n.g2)("sie-modal"),A=(0,n.g2)("q-field"),T=(0,n.g2)("q-input"),L=(0,n.g2)("q-fab"),P=(0,n.g2)("q-page-sticky");return(0,n.uX)(),(0,n.CE)("div",r,[(0,n.bF)(w,{class:"col q-ma-xs cabecera",data:e.dataTabla,columns:e.columns,filter:e.filter,style:(0,i.Tr)({height:e.alto+"px"})},{"body-cell-ESTADO":(0,n.k6)(function(o){return[(0,n.bF)(a,{props:o,class:(0,i.C4)({"fondo-2":2===o.row.ESTADO,"fondo-3":3===o.row.ESTADO,"fondo-4":4===o.row.ESTADO})},{default:(0,n.k6)(function(){return[(0,n.eW)((0,i.v_)(e.estados[o.row.ESTADO]),1)]}),_:2},1032,["props","class"])]}),"body-cell-FH_PERMISO":(0,n.k6)(function(o){return[(0,n.bF)(a,{props:o},{default:(0,n.k6)(function(){return[(0,n.eW)((0,i.v_)(e.date(o.row.FH_PERMISO,"DD/MM/YYYY hh:mm a")),1)]}),_:2},1032,["props"])]}),"body-cell-VALIDAR":(0,n.k6)(function(i){return[(0,n.bF)(a,{props:i,onClick:function(o){return e.openModalValidar(i.row)}},{default:(0,n.k6)(function(){return[i.row.ESTADO<3?((0,n.uX)(),(0,n.Wv)(l,{key:0,name:"done_all",style:{"font-size":"16px"}})):(0,n.Q3)("v-if",!0),i.row.ESTADO<3?((0,n.uX)(),(0,n.Wv)(D,{key:1},{default:(0,n.k6)(function(){return t()(o[10]||(o[10]=[(0,n.eW)("ValidaciÃ³n",-1)]))}),_:1})):(0,n.Q3)("v-if",!0)]}),_:2},1032,["props","onClick"])]}),"body-cell-PRINT":(0,n.k6)(function(i){return[(0,n.bF)(a,{props:i,onClick:function(o){return e.verDetalle(i.row)}},{default:(0,n.k6)(function(){return[(0,n.bF)(l,{name:"remove_red_eye",style:{"font-size":"16px"}}),(0,n.bF)(D,null,{default:(0,n.k6)(function(){return t()(o[11]||(o[11]=[(0,n.eW)("Ver Detalle",-1)]))}),_:1})]}),_:1},8,["props","onClick"])]}),"top-right":(0,n.k6)(function(a){return[(0,n.Lk)("div",s,[(0,n.bF)(_,{class:"q-if-outlined col",modelValue:e.filter,"onUpdate:modelValue":o[0]||(o[0]=function(o){return e.filter=o})},null,8,["modelValue"]),(0,n.bF)(S,{class:"q-if-outlined",style:{"margin-bottom":"0px"},modelValue:e.filtros.fIni,"onUpdate:modelValue":o[1]||(o[1]=function(o){return e.filtros.fIni=o}),type:"date","float-label":e.$t("fechainicio"),format:"DD/MM/YYYY",onInput:e.cargaInicial},null,8,["modelValue","float-label","onInput"]),(0,n.bF)(S,{class:"q-if-outlined",style:{"margin-bottom":"0px"},modelValue:e.filtros.fFin,"onUpdate:modelValue":o[2]||(o[2]=function(o){return e.filtros.fFin=o}),type:"date","float-label":e.$t("fechafin"),format:"DD/MM/YYYY",onInput:e.cargaInicial},null,8,["modelValue","float-label","onInput"]),(0,n.bF)(F,{class:"q-if-outlined",style:{"margin-bottom":"0px"},modelValue:e.filtros.estado,"onUpdate:modelValue":o[3]||(o[3]=function(o){return e.filtros.estado=o}),options:e.listaEstados,"float-label":"Estado",onInput:e.cambiarEstado},null,8,["modelValue","options","onInput"])])]}),bottom:(0,n.k6)(function(){return[(0,n.Lk)("div",d,[o[12]||(o[12]=(0,n.Lk)("div",{class:"col"},null,-1)),(0,n.Lk)("div",u,[(0,n.bF)(M,{flat:"",dense:"",round:"",icon:"refresh",onClick:e.cargaInicial},null,8,["onClick"])]),(0,n.Lk)("div",c,[(0,n.Lk)("span",null,"Registros Seleccionados "+(0,i.v_)(e.dataTabla.length),1)])])]}),_:1},8,["data","columns","filter","style"]),(0,n.bF)(C,{modelValue:e.modalDetalle,"onUpdate:modelValue":o[4]||(o[4]=function(o){return e.modalDetalle=o}),title:"Detalle de Permiso"},{default:(0,n.k6)(function(){return[(0,n.Lk)("div",f,[(0,n.Lk)("div",m,[o[13]||(o[13]=(0,n.Lk)("b",null,"Solicitado por:",-1)),(0,n.Lk)("span",v,(0,i.v_)(" "+e.permisoSelect.SOLNOM+" "),1),(0,n.Lk)("b",p,"("+(0,i.v_)(e.permisoSelect.MEDIODESC)+")",1)]),(0,n.Lk)("div",b,[o[14]||(o[14]=(0,n.Lk)("b",null,"Motivo:",-1)),(0,n.Lk)("span",h,(0,i.v_)(e.permisoSelect.MOTIVODESC),1)]),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.dataDetalle,function(a){return(0,n.uX)(),(0,n.CE)("fieldset",$,[(0,n.Lk)("legend",k,"Estado: "+(0,i.v_)(a.ESTADODESC),1),(0,n.Lk)("div",V,[o[15]||(o[15]=(0,n.Lk)("b",null,"Usuario :",-1)),(0,n.Lk)("span",I,(0,i.v_)(a.USUNOM),1)]),(0,n.Lk)("div",g,[o[16]||(o[16]=(0,n.Lk)("b",null,"Registrado :",-1)),(0,n.Lk)("span",E,(0,i.v_)(e.date(a.FH_REGISTRO,"DD/MM/YYYY HH:mm")),1)]),a.OBSERVACION?((0,n.uX)(),(0,n.CE)("div",q,[o[17]||(o[17]=(0,n.Lk)("b",null,"Comentario :",-1)),(0,n.Lk)("span",y,(0,i.v_)(a.OBSERVACION),1)])):(0,n.Q3)("v-if",!0)])}),256))])]}),_:1},8,["modelValue"]),(0,n.bF)(C,{modelValue:e.modalValidar,"onUpdate:modelValue":o[7]||(o[7]=function(o){return e.modalValidar=o}),title:"Validar Permiso",onSubmit:e.saveValidacion},{default:(0,n.k6)(function(){return[(0,n.Lk)("div",O,[(0,n.bF)(A,{error:e.v$.dataValidacion.estado.$error,"error-label":e.$t("validaciones.requerido")},{default:(0,n.k6)(function(){return[(0,n.bF)(F,{class:"q-if-outlined",modelValue:e.v$.dataValidacion.estado.$model,"onUpdate:modelValue":o[5]||(o[5]=function(o){return e.v$.dataValidacion.estado.$model=o}),options:e.estadosValidacion,"float-label":"Estado"},null,8,["modelValue","options"])]}),_:1},8,["error","error-label"]),(0,n.bF)(T,{class:"q-if-outlined col",modelValue:e.dataValidacion.observacion,"onUpdate:modelValue":o[6]||(o[6]=function(o){return e.dataValidacion.observacion=o}),type:"textarea","float-label":"Observacion",rows:"3"},null,8,["modelValue"])])]}),_:1},8,["modelValue","onSubmit"]),(0,n.bF)(C,{modelValue:e.modalEjecutar,"onUpdate:modelValue":o[8]||(o[8]=function(o){return e.modalEjecutar=o}),footer:!1},{default:(0,n.k6)(function(){return[((0,n.uX)(),(0,n.Wv)((0,n.$y)(e.opcionModal),{onCloseModal:e.cerrarModal},null,40,["onCloseModal"]))]}),_:1},8,["modelValue"]),e.listadoOpciones.length>0?((0,n.uX)(),(0,n.Wv)(P,{key:0,position:"bottom-right",offset:[20,20]},{default:(0,n.k6)(function(){return[1===e.listadoOpciones.length?((0,n.uX)(),(0,n.Wv)(M,{key:0,fab:"",round:"",color:"secondary",icon:"add",onClick:o[9]||(o[9]=function(o){return e.mostrarModal("registro")})})):((0,n.uX)(),(0,n.Wv)(L,{key:1,color:"secondary",icon:"more_vertical",direction:"up"},{default:(0,n.k6)(function(){return[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.listadoOpciones,function(o){return(0,n.uX)(),(0,n.Wv)(M,{key:o.opcion,round:"",color:"secondary",icon:o.icono,onClick:function(a){return e.mostrarModal(o.opcion)}},{default:(0,n.k6)(function(){return[(0,n.bF)(D,null,{default:(0,n.k6)(function(){return[(0,n.eW)((0,i.v_)(o.placeholder),1)]}),_:2},1024)]}),_:2},1032,["icon","onClick"])}),128))]}),_:1}))]}),_:1})):(0,n.Q3)("v-if",!0)])}a(30683),a(10239),a(90095),a(515),a(13715);var _=a(83972),S=a(6123),F=a(57668),M=a(30640),w=a(30545),C=a(80660),A={class:"col"},T={class:"col q-ma-xs"},L={class:"col row q-ma-xs justify-around"},P={class:"col row"};function Q(e,o){var a=(0,n.g2)("sie-estudiantes"),l=(0,n.g2)("q-field"),t=(0,n.g2)("q-datetime"),i=(0,n.g2)("q-select"),r=(0,n.g2)("q-input"),s=(0,n.g2)("q-btn"),d=(0,n.g2)("q-toolbar");return(0,n.uX)(),(0,n.CE)("div",A,[(0,n.Lk)("div",T,[(0,n.bF)(l,{error:e.v$.infoInsert.alucod.$error,"error-label":e.$t("validaciones.requerido")},{default:(0,n.k6)(function(){return["005"!==e.sie.tipcod?((0,n.uX)(),(0,n.Wv)(a,{key:0,modelValue:e.v$.infoInsert.alucod.$model,"onUpdate:modelValue":o[0]||(o[0]=function(o){return e.v$.infoInsert.alucod.$model=o})},null,8,["modelValue"])):(0,n.Q3)("v-if",!0)]}),_:1},8,["error","error-label"]),e.infoInsert.alucod?((0,n.uX)(),(0,n.CE)(n.FK,{key:0},[(0,n.Lk)("div",L,[(0,n.bF)(l,{error:e.v$.infoInsert.fh_permiso.$error,"error-label":e.$t("validaciones.requerido")},{default:(0,n.k6)(function(){return[(0,n.bF)(t,{class:"q-if-outlined",modelValue:e.v$.infoInsert.fh_permiso.$model,"onUpdate:modelValue":o[1]||(o[1]=function(o){return e.v$.infoInsert.fh_permiso.$model=o}),type:"date","float-label":e.$t("fecha")},null,8,["modelValue","float-label"])]}),_:1},8,["error","error-label"]),(0,n.bF)(l,{error:e.v$.infoInsert.fh_permiso.$error,"error-label":e.$t("validaciones.requerido")},{default:(0,n.k6)(function(){return[(0,n.bF)(t,{class:"q-if-outlined",modelValue:e.v$.infoInsert.fh_permiso.$model,"onUpdate:modelValue":o[2]||(o[2]=function(o){return e.v$.infoInsert.fh_permiso.$model=o}),type:"time","float-label":e.$t("hora")},null,8,["modelValue","float-label"])]}),_:1},8,["error","error-label"])]),(0,n.bF)(l,{error:e.v$.infoInsert.solicitante.$error,"error-label":e.$t("validaciones.requerido")},{default:(0,n.k6)(function(){return[(0,n.bF)(i,{class:"q-if-outlined",modelValue:e.v$.infoInsert.solicitante.$model,"onUpdate:modelValue":o[3]||(o[3]=function(o){return e.v$.infoInsert.solicitante.$model=o}),options:e.parentescos,"float-label":"Solicitante"},null,8,["modelValue","options"])]}),_:1},8,["error","error-label"]),(0,n.bF)(l,{error:e.v$.infoInsert.solicitantenom.$error,"error-label":e.$t("validaciones.requerido")},{default:(0,n.k6)(function(){return["OTR"===e.infoInsert.solicitante?((0,n.uX)(),(0,n.Wv)(r,{key:0,class:"q-if-outlined",modelValue:e.v$.infoInsert.solicitantenom.$model,"onUpdate:modelValue":o[4]||(o[4]=function(o){return e.v$.infoInsert.solicitantenom.$model=o}),maxlength:"150","float-label":"Nombre"},null,8,["modelValue"])):(0,n.Q3)("v-if",!0)]}),_:1},8,["error","error-label"]),(0,n.Lk)("div",P,[(0,n.bF)(l,{class:"col",error:e.v$.infoInsert.medio.$error,"error-label":e.$t("validaciones.requerido")},{default:(0,n.k6)(function(){return[(0,n.bF)(i,{class:"q-if-outlined col",modelValue:e.v$.infoInsert.medio.$model,"onUpdate:modelValue":o[5]||(o[5]=function(o){return e.v$.infoInsert.medio.$model=o}),options:e.modoRegistro,"float-label":"Medio",readonly:e.sie.esFamilia},null,8,["modelValue","options","readonly"])]}),_:1},8,["error","error-label"]),(0,n.bF)(l,{class:"col",error:e.v$.infoInsert.motivo.$error,"error-label":e.$t("validaciones.requerido")},{default:(0,n.k6)(function(){return[(0,n.bF)(i,{class:"q-if-outlined col",modelValue:e.v$.infoInsert.motivo.$model,"onUpdate:modelValue":o[6]||(o[6]=function(o){return e.v$.infoInsert.motivo.$model=o}),options:e.motivoPermiso,"float-label":"Motivo"},null,8,["modelValue","options"])]}),_:1},8,["error","error-label"])]),(0,n.bF)(l,{error:e.v$.infoInsert.motivodes.$error,"error-label":e.$t("validaciones.requerido")},{default:(0,n.k6)(function(){return[e.infoInsert.motivo===e.valorOtros?((0,n.uX)(),(0,n.Wv)(r,{key:0,class:"q-if-outlined",modelValue:e.v$.infoInsert.motivodes.$model,"onUpdate:modelValue":o[7]||(o[7]=function(o){return e.v$.infoInsert.motivodes.$model=o}),maxlength:"100","float-label":"Otro Motivo"},null,8,["modelValue"])):(0,n.Q3)("v-if",!0)]}),_:1},8,["error","error-label"]),(0,n.bF)(r,{class:"q-if-outlined col",modelValue:e.infoInsert.sustento,"onUpdate:modelValue":o[8]||(o[8]=function(o){return e.infoInsert.sustento=o}),type:"textarea","float-label":"Observacion",rows:"3"},null,8,["modelValue"])],64)):(0,n.Q3)("v-if",!0)]),(0,n.bF)(d,{class:"row justify-end",inverted:""},{default:(0,n.k6)(function(){return[(0,n.bF)(s,{color:"primary",label:"Aceptar",onClick:e.saveInfo},null,8,["onClick"])]}),_:1})])}var R=a(92173),U=a(82640),x={setup:function(){var e=(0,_.fG)();return{v$:e}},emits:["closeModal"],components:{QDatetime:S.T5,sieEstudiantes:R.Ay,sieModal:M.A,QSelect:S.Si,QToolbar:S.ZV,QField:S.Om,QInput:S.ie,QBtn:S.Il},props:["modal"],data:function(){return{sie:(0,F["default"])(),valorOtros:"O",motivoPermiso:[],parentescos:[{label:"Padre",value:"PAD"},{label:"Madre",value:"MAD"},{label:"Otro",value:"OTR"}],modoRegistro:[{label:"Sistema",value:1},{label:"Agenda",value:2}],infoInsert:{alucod:null,fh_permiso:new Date,solicitante:null,solicitantenom:"",medio:(0,F["default"])().esFamilia?1:null,motivo:null,motivodes:null,sustento:null}}},methods:{getContactos:function(e){console.log(this.infoInsert.alucod,e)},cerrarModal:function(){this.$emit("closeModal")},saveInfo:function(){var e=this;this.v$.$touch(),this.v$.$invalid||C.$http.post("api/HyoPermisoSalidas/savePermiso",this.infoInsert).then(function(o){var a=o.json;a.id&&(C.$http.get("api/HyoPermisoSalidas/sendMensaje",{params:{id:a.id,estado:1}}).then(function(e){var o=e.json;console.log(o)}),e.cerrarModal())})},cargaInicial:function(){}},validations:function(){var e=this,o=function(){return"OTR"!==e.infoInsert.solicitante||e.infoInsert.solicitantenom.length>0},a=function(){return e.infoInsert.motivo!==e.valorOtros||e.infoInsert.motivodes.length>0},l={infoInsert:{alucod:{required:U.mw},fh_permiso:{required:U.mw},solicitante:{required:U.mw},motivo:{required:U.mw},medio:{required:U.mw},solicitantenom:{validaOtroSolicitante:o},motivodes:{validaOtroMotivo:a}}};return l},mounted:function(){var e=this;C.$http.get("api/HyoTablaSe/datosSe",{params:{princod:"371"}}).then(function(o){var a=o.listar;a.forEach(function(o){"O"===o.SECUEQU&&(e.valorOtros=o.SECUCOD),e.motivoPermiso.push({label:o.SECUDES,value:o.SECUCOD})})})}},j=a(12807);const X=(0,j.A)(x,[["render",Q]]);var Y=X,H={class:"col bg-white"};function W(e,o){return(0,n.uX)(),(0,n.CE)("div",H)}var N=a(42771),z={components:{relacionMatricula:N.A},data:function(){return{sie:(0,F["default"])()}},methods:{cargaInicial:function(){}},init:function(){}};const B=(0,j.A)(z,[["render",W]]);var K=B,G={class:"col bg-white"};function Z(e,o){return(0,n.uX)(),(0,n.CE)("div",G)}var J={components:{relacionMatricula:N.A},data:function(){return{sie:(0,F["default"])()}},methods:{cargaInicial:function(){}},init:function(){}};const ee=(0,j.A)(J,[["render",Z]]);var oe=ee,ae={class:"col q-card q-ma-xs"};function le(e,o){return(0,n.uX)(),(0,n.CE)("div",ae)}var te={components:{},data:function(){return{sie:(0,F["default"])()}},methods:{cargaInicial:function(){}},init:function(){}};const ne=(0,j.A)(te,[["render",le]]);var ie=ne,re=a(18105),se=a(982),de=a(33001),ue={setup:function(){var e=(0,_.fG)();return{v$:e}},components:{QPageSticky:S._U,registro:Y,validacion:K,reportes:oe,listado:ie,QFab:S.l6,sieModal:M.A,QTable:w.A,QDatetime:S.T5,QTd:S.Ef,QSelect:S.Si,QIcon:S.bP,QTooltip:S.nC,QSearch:S.Ks,QBtn:S.Il,QField:S.Om,QInput:S.ie},data:function(){return{sie:(0,F["default"])(),opcion:"listado",listadoOpciones:[],modalEjecutar:!1,modalDetalle:!1,opcionModal:null,modalValidar:!1,permisoSelect:{},listaEstados:[],estados:{1:"Registrado",2:"Aprobado",3:"Ejecutado",4:"Rechazado"},estadosValidacion:[],dataTabla:[],dataValidacion:{estado:null,observacion:null},dataBase:[],alto:0,filtros:{fIni:new Date((new Date).setMonth(0,1)),fFin:new Date((new Date).setMonth(11,31)),estado:0},filter:null,dataDetalle:[],columns:[{name:"NOMCOMP",field:"NOMCOMP",align:"left",label:this.$t("apellidosynombres")},{name:"FH_PERMISO",field:"FH_PERMISO",align:"left",label:"Fecha de Permiso"},{name:"ESTADO",field:"ESTADOD",align:"left",label:"Estado"},{name:"PRINT",field:"PRINT",align:"right"}]}},methods:{date:re.Ay,handleResize:function(){var e=125;this.alto=window.innerHeight-e},mostrarModal:function(e){this.modalEjecutar=!0,this.opcionModal=e},cerrarModal:function(){this.modalEjecutar=!1,this.cargaInicial()},cargaInicial:function(){var e=this;C.$http.post("api/HyoPermisoSalidas/getPermisos",this.filtros).then(function(o){var a=o.json;e.dataBase=a,e.cambiarEstado(e.filtros.estado)})},cambiarEstado:function(e){this.dataTabla=this.dataBase,0!==e&&(this.dataTabla=(0,de.filterArray)(e,{field:"ESTADO",list:this.dataTabla}))},openModalValidar:function(e){if(e.ESTADO<3){this.modalValidar=!0,this.dataValidacion={estado:null,observacion:null,id_permiso:e.ID};var o=[{label:this.estados[4],value:4}];switch(e.ESTADO){case 1:o.unshift({label:this.estados[2],value:2});break;case 2:o.unshift({label:this.estados[3],value:3});break}this.estadosValidacion=o}},saveValidacion:function(){var e=this;this.v$.$touch(),this.v$.$invalid||C.$http.post("api/HyoPErmisosalidadetalles/saveDetalle",this.dataValidacion).then(function(o){var a=o.json;if((0,se["default"])(e.$t("mensajes."+a.msg),a.type),"success"===a.type){var l={id:e.dataValidacion.id_permiso,estado:e.dataValidacion.estado};C.$http.get("api/HyoPermisoSalidas/sendMensaje",{params:l}),e.modalValidar=!1,e.cargaInicial()}})},verDetalle:function(e){var o=this;this.permisoSelect=e,C.$http.get("api/HyoPErmisosalidadetalles/getDetalle",{params:{id_permiso:e.ID}}).then(function(e){var a=e.json;o.dataDetalle=a,o.modalDetalle=!0})}},unmounted:function(){window.removeEventListener("resize",this.handleResize)},created:function(){var e=this;this.listaEstados=[{label:"Todos",value:0}],Object.keys(this.estados).forEach(function(o){e.listaEstados.push({label:e.estados[o],value:o})}),window.addEventListener("resize",this.handleResize),this.sie.esOtros&&3===this.sie.ruta.nivel&&this.columns.push({name:"VALIDAR",field:"VALIDAR",align:"center"}),this.handleResize(),this.cargaInicial();var o=[];this.sie.ruta.nivel>1&&(o.push({opcion:"registro",icono:"add",placeholder:"Nuevo Permiso"}),this.listadoOpciones=[].concat(o))},validations:function(){var e={dataValidacion:{estado:{required:U.mw}}};return e}};const ce=(0,j.A)(ue,[["render",D]]);var fe=ce}}]);