"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[31893],{31893:function(e,a,o){o.r(a),o.d(a,{default:function(){return R}});var n=o(61758),t={class:"row q-col-gutter-sm"},r={class:"col-xs-12 col-sm-5"},l={class:"col-xs-12 col-sm-7"},i={class:"col-xs-12 col-sm-5"},u={class:"col-xs-12 col-sm-7"},s={class:"row q-pa-sm q-col-gutter-sm"},c={class:"col-xs-12"},d={class:"col-xs-12 sie-flat"};function m(e,a){var o=this,m=(0,n.g2)("header-btn"),b=(0,n.g2)("q-tab"),f=(0,n.g2)("q-tabs"),g=(0,n.g2)("q-separator"),p=(0,n.g2)("q-input"),C=(0,n.g2)("q-form"),h=(0,n.g2)("q-tab-panel"),v=(0,n.g2)("q-tab-panels"),M=(0,n.g2)("q-card-section"),O=(0,n.g2)("q-card"),w=(0,n.g2)("q-checkbox"),A=(0,n.g2)("sie-table"),k=(0,n.g2)("sie-modal"),F=(0,n.g2)("q-page");return(0,n.uX)(),(0,n.Wv)(F,{class:"cambio-codigo-alumno q-pa-sm"},{default:(0,n.k6)(function(){return[(0,n.bF)(O,null,{default:(0,n.k6)(function(){return[(0,n.bF)(m,{name:e.nombreHeader,buttons:e.buttons},null,8,["name","buttons"]),(0,n.bF)(M,{class:"q-pa-none",style:{height:"calc(100vh - 115px)",padding:"0"}},{default:(0,n.k6)(function(){return[(0,n.bF)(f,{inverted:"",animated:"",modelValue:e.tab,"onUpdate:modelValue":a[0]||(a[0]=function(a){return e.tab=a}),swipeable:e.isLess},{default:(0,n.k6)(function(){return[(0,n.bF)(b,{default:"",name:"tab-1",label:"Estudiante",onClick:e.initTab},null,8,["onClick"]),(0,n.bF)(b,{name:"tab-2",label:"Familia",onClick:e.initTab},null,8,["onClick"]),(0,n.bF)(b,{name:"tab-3",label:"Personal",onClick:e.initTab},null,8,["onClick"])]}),_:1},8,["modelValue","swipeable"]),(0,n.bF)(g),e.formTabs.length>0?((0,n.uX)(),(0,n.Wv)(v,{key:0,modelValue:e.tab,"onUpdate:modelValue":a[1]||(a[1]=function(a){return e.tab=a}),"keep-alive":""},{default:(0,n.k6)(function(){return[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.formTabs,function(a,o){return(0,n.uX)(),(0,n.Wv)(h,{name:a.tab},{default:(0,n.k6)(function(){return[(0,n.bF)(C,{class:"q-py-md",ref_for:!0,ref:a.formulario},{default:(0,n.k6)(function(){return[(0,n.Lk)("div",t,[(0,n.Lk)("div",r,[(0,n.bF)(p,{modelValue:a.codigo,"onUpdate:modelValue":function(e){return a.codigo=e},label:"Código Actual",rules:[e.campoRequerido],debounce:"500",onInput:e.getDatosPersona},null,8,["modelValue","onUpdate:modelValue","rules","onInput"])]),(0,n.Lk)("div",l,[(0,n.bF)(p,{modelValue:a.nombre,"onUpdate:modelValue":function(e){return a.nombre=e},disable:"",label:"Referencia"},null,8,["modelValue","onUpdate:modelValue"])]),(0,n.Lk)("div",i,[(0,n.bF)(p,{modelValue:a.nuevoCodigo,"onUpdate:modelValue":function(e){return a.nuevoCodigo=e},label:"Código Nuevo",rules:[e.campoRequerido],debounce:"500",onInput:e.validarNuevoCodigo},null,8,["modelValue","onUpdate:modelValue","rules","onInput"])]),(0,n.Lk)("div",u,[(0,n.bF)(p,{modelValue:a.nuevoNombre,"onUpdate:modelValue":function(e){return a.nuevoNombre=e},disable:"",label:"Referencia"},null,8,["modelValue","onUpdate:modelValue"])])])]}),_:2},1536)]}),_:2},1032,["name"])}),256))]}),_:1},8,["modelValue"])):(0,n.Q3)("v-if",!0)]}),_:1})]}),_:1}),(0,n.bF)(k,{class:"modal-alumno-filtro",modelValue:e.openModal,"onUpdate:modelValue":a[3]||(a[3]=function(a){return e.openModal=a}),title:e.tituloModal},{default:(0,n.k6)(function(){return[(0,n.Lk)("div",s,[(0,n.Lk)("div",c,[(0,n.bF)(w,{modelValue:e.todos,"onUpdate:modelValue":a[2]||(a[2]=function(a){return e.todos=a}),label:"Listar todos"},null,8,["modelValue"])]),(0,n.Lk)("div",d,[(0,n.bF)(A,{selection:"single",context:o,css:"height:calc(100vh - 240px)",search:e.tituloModal,columns:e.columns,onRowSelected:e.rowSelected,data:e.rows,config:e.config},null,8,["search","columns","onRowSelected","data","config"])])])]}),_:1},8,["modelValue","title"])]}),_:1})}var b=o(76080),f=o.n(b),g=o(45254),p=o.n(g),C=o(41562),h=o.n(C),v=o(99550),M=o.n(v),O=(o(71225),o(52133),o(50310),o(5962),o(6724),o(83190),o(6123)),w={data:function(){return{config:{},datarows:[],columns:[{name:"ALUCOD",label:"Código",field:"ALUCOD",align:"center"},{name:"NOMCOMP",label:"Apellidos y Nombres",field:"NOMCOMP",align:"left"}]}}},A=o(88567),k=o(95718),F=o(53380),P=o(982),V=o(80660),D={cambiarCodigo:function(e,a,o){switch(e){case"tab-1":return V.$http.post("api/AlumnoController/cambiarCodigoAlumno",{alucod:a,newalucod:o});case"tab-2":return V.$http.post("api/FamiliaController/cambiarCodigoFamilia",{famcod:a,newfamcod:o});case"tab-3":return V.$http.post("api/ProfeController/cambiarCodigoPersonal",{profcod:a,newprofcod:o})}}},T=o(30640),q=o(9736),E=o(2739),N=o(3112),L=o(53093),U=o(26697),S=o(53811),x=o(43346),y=o(81288),$={components:{QCard:A.A,QCardSection:k.A,sieModal:T.A,QInput:q.A,QForm:E.A,QCheckbox:N.A,QTab:L.A,QTabs:U.A,QTabPanels:S.A,QTabPanel:x.A,QSeparator:F.A,QPage:O.Tu},mixins:[w],data:function(){return{formTabs:[],codigo:null,alumno:null,nuevoCodigo:null,nuevoAlumno:null,dataSinMatricula:[],buttons:[{icon:"search",label:"Buscar",click:this.buscar},{icon:"cog",label:"Procesar",click:this.procesar}],tituloModal:"",tituloBuscarModal:"",nombreHeader:"",openModal:!1,todos:!1,tab:"tab-1",nameEstado:"",valueEstado:"",relCampos:{codigo:"ALUCOD",nombre:"NOMCOMP"},currentPersona:{}}},computed:{isLess:function(){return(0,y.isLess)()},rows:function(){var e=this,a=[];return!1===this.todos?this.datarows.map(function(o){o[e.nameEstado]===e.valueEstado&&(a[a.length]=o)}):a=this.datarows,a}},methods:{configurarTabs:function(){for(var e=[],a=0;a<3;a++)e[e.length]={codigo:null,nombre:null,nuevoCodigo:null,nuevoNombre:null,tab:"tab-".concat(a+1),data:[],formulario:"refFormtab-".concat(a+1)};this.formTabs=e},campoRequerido:function(e){return!!e||"Campo requerido"},rowSelected:function(e,a){var o=this;this.currentPersona=a;var n=this.formTabs.filter(function(e){return e.tab===o.tab}),t=M()(n,1),r=t[0];r.codigo=e[this.relCampos.codigo],r.nombre=e[this.relCampos.nombre],this.openModal=!1},encontraPersona:function(e){var a,o={},n=h()(this.datarows);try{for(n.s();!(a=n.n()).done;){var t=a.value;if(t[this.relCampos.codigo]===e){o=t;break}}}catch(e){n.e(e)}finally{n.f()}return{persona:o,nombre:o[this.relCampos.nombre]?o[this.relCampos.nombre]:null}},getDatosPersona:function(e){var a=this,o=this.formTabs.filter(function(e){return e.tab===a.tab}),n=M()(o,1),t=n[0],r=this.encontraPersona(e),l=r.nombre,i=r.persona;t.nombre=l,this.currentPersona=i},validarNuevoCodigo:function(e){var a=this,o=this.formTabs.filter(function(e){return e.tab===a.tab}),n=M()(o,1),t=n[0],r=this.encontraPersona(e),l=r.nombre;t.nuevoNombre=l,t.nuevoNombre&&(0,P["default"])("El nuevo código ingresado ya se encuentra registrado","warning")},buscar:function(){var e=this;return p()(f()().m(function a(){return f()().w(function(a){while(1)switch(a.n){case 0:e.openModal=!0;case 1:return a.a(2)}},a)}))()},initTab:function(){var e=this;return p()(f()().m(function a(){var o,n,t,r,l;return f()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,e.$nextTick();case 1:o=e.formTabs.filter(function(a){return a.tab===e.tab}),n=M()(o,1),t=n[0],r={},l=e.tab,a.n="tab-1"===l?2:"tab-2"===l?4:"tab-3"===l?6:8;break;case 2:return e.tituloBuscarModal="Buscar Estudiante",e.tituloModal="Buscar Estudiantes",e.nombreHeader="Modificar Código de Estudiante",e.columns=[{name:"ALUCOD",label:"Código",field:"ALUCOD",align:"center"},{name:"NOMCOMP",label:"Apellidos y Nombres",field:"NOMCOMP",align:"left"}],e.relCampos.codigo="ALUCOD",e.relCampos.nombre="NOMCOMP",e.nameEstado="ESTADO",e.valueEstado="V",a.n=3,e.$http.get("api/HyoAlumnos/getAllAlumnos");case 3:return t.data=e.datarows=a.v,a.a(3,8);case 4:return e.tituloBuscarModal="Buscar Familia",e.tituloModal="Buscar Familias",e.nombreHeader="Modificar Código de Familia",e.columns=[{name:"FAMCOD",label:"Código",field:"FAMCOD",align:"center"},{name:"FAMDES",label:"Apellidos y Nombres",field:"FAMDES",align:"left"}],e.relCampos.codigo="FAMCOD",e.relCampos.nombre="FAMDES",e.nameEstado="ESTADO",e.valueEstado="A",r.columnas=["FAMCOD","FAMDES","ESTADO"],r.order={sidx:"famdes",sord:"asc"},a.n=5,e.$http.get("api/FamiliaController/getDatosFamilia",{params:{parametros:r}});case 5:return t.data=e.datarows=a.v,a.a(3,8);case 6:return e.tituloBuscarModal="Buscar personal",e.tituloModal="Buscar personal",e.nombreHeader="Modificar Código de Personal",e.columns=[{name:"PROFCOD",label:"Código",field:"PROFCOD",align:"center"},{name:"NOMCOMP",label:"Apellidos y Nombres",field:"NOMCOMP",align:"left"}],e.relCampos.codigo="PROFCOD",e.relCampos.nombre="NOMCOMP",e.nameEstado="SITCOD",e.valueEstado="0001",r.fields=["PROFCOD","NOMCOMP","SITCOD"],r.order={sidx:"nomcomp",sord:"asc"},a.n=7,e.$http.get("api/ProfeController/getProfe",{params:{parametros:r}});case 7:return t.data=e.datarows=a.v,a.a(3,8);case 8:e.limpiar(t);case 9:return a.a(2)}},a)}))()},limpiar:function(e){e.codigo="",e.nombre="",e.nuevoCodigo="",e.nuevoNombre="",this.$refs[e.formulario][0].reset()},procesar:function(){var e=this;return p()(f()().m(function a(){var o,n,t,r,l,i,u,s;return f()().w(function(a){while(1)switch(a.p=a.n){case 0:return o=e.formTabs.filter(function(a){return a.tab===e.tab}),n=M()(o,1),t=n[0],a.n=1,e.$refs[t.formulario][0].validate();case 1:if(r=a.v,r){a.n=2;break}return a.a(2);case 2:if(t.codigo!==t.nuevoCodigo){a.n=3;break}return(0,P["default"])("Debe agregar un código diferente al código actual","warning"),a.a(2,!1);case 3:if(!t.nuevoNombre){a.n=4;break}return(0,P["default"])("El nuevo código ingresado ya se encuentra registrado","warning"),a.a(2,!1);case 4:return e.$q.loading.show(),a.p=5,a.n=6,D.cambiarCodigo(e.tab,t.codigo,t.nuevoCodigo);case 6:l=a.v,i=l.message,e.$q.loading.hide(),e.currentPersona[e.relCampos.codigo]=t.nuevoCodigo,e.$notify(i,"success"),e.limpiar(t),a.n=8;break;case 7:a.p=7,s=a.v,u=s.error,e.$q.loading.hide(),e.$notify(u.message,"error");case 8:return a.a(2)}},a,null,[[5,7]])}))()}},created:function(){var e=this;return p()(f()().m(function a(){return f()().w(function(a){while(1)switch(a.n){case 0:e.configurarTabs();case 1:return a.a(2)}},a)}))()},mounted:function(){var e=this;return p()(f()().m(function a(){return f()().w(function(a){while(1)switch(a.n){case 0:e.initTab();case 1:return a.a(2)}},a)}))()}},Q=o(12807);const B=(0,Q.A)($,[["render",m]]);var R=B}}]);