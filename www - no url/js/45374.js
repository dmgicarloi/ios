"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[45374],{45374:function(e,o,t){t.r(o),t.d(o,{default:function(){return fe}});var a=t(8445),n=t.n(a),i=t(61758),l=t(29104),r=t(58790),s={class:"q-pa-sm"},u={class:"row"},c={class:"col gutter-xs"},d={key:0,class:"q-pr-md-xs",style:{"margin-top":"2px"}},p={key:1,class:"q-pr-md-xs",style:{"margin-top":"2px"}},m={style:{"margin-top":"2px"}},f={key:2},v={class:"row"},C={class:"col"},h={key:0,class:"row"},b={class:"col-xs-12"},A={key:1,class:"row"},g={class:"col"},O={class:"row"},k={key:2,class:"row"},E={class:"col-xs-12"},I={key:3,class:"row"},D={class:"col-12"},S={key:4,class:"bg-grey-2 flex-center row"},N={key:0,class:"col-xs-6 col-md-2"},U={key:1,class:"col-xs-12 col-md-5"},F={class:"row"},L={class:"flex-block"},P={class:"col-xs-12 col-md-4"},M={class:"row"},y={key:1,class:"column col"},_={class:"text-black"},T={class:"row q-px-sm q-pt-sm"},j={class:"col"},V={key:0,class:"row q-px-md q-pb-md text-weight-bold"};function q(e,o){var t=(0,i.g2)("q-select"),a=(0,i.g2)("destinatarios"),q=(0,i.g2)("q-btn"),x=(0,i.g2)("q-checkbox"),$=(0,i.g2)("q-input"),w=(0,i.g2)("q-chips-input"),R=(0,i.g2)("sie-editor"),G=(0,i.g2)("q-option-group"),Q=(0,i.g2)("q-search"),X=(0,i.g2)("q-table"),H=(0,i.g2)("q-page-sticky"),W=(0,i.g2)("q-toolbar-title"),z=(0,i.g2)("q-toolbar"),J=(0,i.g2)("sie-vacio"),K=(0,i.g2)("q-td"),B=(0,i.g2)("q-icon"),Y=(0,i.g2)("q-tooltip"),Z=(0,i.g2)("q-tr"),ee=(0,i.g2)("sie-modal"),oe=(0,i.g2)("q-list-header"),te=(0,i.g2)("q-item-side"),ae=(0,i.g2)("q-item-main"),ne=(0,i.g2)("q-item"),ie=(0,i.g2)("q-item-separator"),le=(0,i.g2)("q-list"),re=(0,i.g2)("sie-cloud"),se=(0,i.g2)("q-page");return(0,i.uX)(),(0,i.Wv)(se,{class:"bg-white envioCorreo"},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",s,[(0,i.Lk)("div",u,[(0,i.Lk)("div",c,[(0,i.bF)(t,{class:"q-if-outlined no-bottom",modelValue:e.tipo,"onUpdate:modelValue":o[0]||(o[0]=function(o){return e.tipo=o}),options:e.tipos,label:e.$t("tipo"),onInput:e.resetPlantilla},null,8,["modelValue","options","label","onInput"])]),e.tipo&&e.isAgregarCopia&&!e.chkEnviarCarta?((0,i.uX)(),(0,i.CE)("div",d,[(0,i.bF)(a,{class:"q-pb-sm",ref:"getDestinatarios",perfiles:e.perfiles,loadDestinatarios:e.data,chips:!1,envioCorreo:!0},null,8,["perfiles","loadDestinatarios"])])):(0,i.Q3)("v-if",!0),""!==e.tipo&&e.enviado?((0,i.uX)(),(0,i.CE)("div",p,[(0,i.bF)(q,{label:"Reporte de envio",round:e.isLess,size:e.isLess?"12px":"md","no-caps":"",color:"secondary",icon:"print",onClick:o[1]||(o[1]=function(o){return e.imprimir(e.reporteIdUltimoEnvio)})},null,8,["round","size"])])):(0,i.Q3)("v-if",!0),(0,i.Lk)("div",m,[(0,i.bF)(q,{label:"Correos Enviados",round:e.isLess,size:e.isLess?"12px":"md","no-caps":"",color:"secondary",icon:"email",onClick:e.correosEnviados},null,8,["round","size","onClick"])]),"F"===e.tipo||"A"===e.tipo||"P"===e.tipo||"O"===e.tipo?((0,i.uX)(),(0,i.CE)("div",f,[(0,i.bF)(x,{class:"q-if-outlined no-bottom",modelValue:e.chkEnviarCarta,"onUpdate:modelValue":o[2]||(o[2]=function(o){return e.chkEnviarCarta=o}),label:"enviar cartas","true-value":1,"false-value":0,onInput:e.setPlantilla},null,8,["modelValue","onInput"])])):(0,i.Q3)("v-if",!0)]),e.tipo?((0,i.uX)(),(0,i.CE)(i.FK,{key:0},[(0,i.Lk)("div",v,[(0,i.Lk)("div",C,[(0,i.bF)($,{class:"q-if-outlined",modelValue:e.asunto,"onUpdate:modelValue":o[3]||(o[3]=function(o){return e.asunto=o}),"float-label":e.$t("intranet.mensajeria.asunto")},null,8,["modelValue","float-label"])]),(0,i.Lk)("div",null,[e.chkEnviarCarta?((0,i.uX)(),(0,i.Wv)(q,{key:1,class:"q-my-sm",round:"",color:"dark",icon:"info",dense:"",flat:"",onClick:e.abrirEtiquetas},null,8,["onClick"])):((0,i.uX)(),(0,i.Wv)(q,{key:0,class:"q-my-sm",round:"",color:"dark",icon:"paperclip",dense:"",flat:"",onClick:e.abrirAdjuntos},null,8,["onClick"]))])]),e.chkEnviarCarta?(0,i.Q3)("v-if",!0):((0,i.uX)(),(0,i.CE)("div",h,[(0,i.Lk)("div",b,[(0,i.bF)(w,{class:"q-if-outlined",modelValue:e.chipAdjuntos,"onUpdate:modelValue":o[4]||(o[4]=function(o){return e.chipAdjuntos=o}),readonly:"","float-label":"Adjuntos"},null,8,["modelValue"])])])),e.correos.length>0?((0,i.uX)(),(0,i.CE)("div",A,[(0,i.Lk)("div",g,[(0,i.bF)(w,{class:"q-if-outlined",modelValue:e.correos,"onUpdate:modelValue":o[5]||(o[5]=function(o){return e.correos=o}),"float-label":e.$t("destinatarios")+"("+e.correos.length+")",readonly:""},null,8,["modelValue","float-label"])]),(0,i.Lk)("div",null,[(0,i.bF)(q,{class:"q-my-sm",round:"",color:"dark",icon:"close",dense:"",flat:"",onClick:e.limpiarCorreosSeleccion},null,8,["onClick"]),(0,i.bF)(q,{class:"q-my-sm",round:"",color:"dark",icon:"file_download",dense:"",flat:"",onClick:e.exportarCorreos},null,8,["onClick"])])])):(0,i.Q3)("v-if",!0),(0,i.bo)((0,i.Lk)("div",O,[(0,i.bF)(x,{class:"q-if-outlined",modelValue:e.modeEditor,"onUpdate:modelValue":o[6]||(o[6]=function(o){return e.modeEditor=o}),label:e.$t("modoEditor"),onInput:o[7]||(o[7]=function(o){return e.resetPlantilla(!1)})},null,8,["modelValue","label"])],512),[[l.aG,!e.chkEnviarCarta]]),e.modeEditor||e.chkEnviarCarta?(0,i.Q3)("v-if",!0):((0,i.uX)(),(0,i.CE)("div",k,[(0,i.Lk)("div",E,[(0,i.bF)($,{class:"q-if-outlined",type:"textarea",rows:"3","max-height":100,modelValue:e.mensajeCorreo,"onUpdate:modelValue":o[8]||(o[8]=function(o){return e.mensajeCorreo=o}),"float-label":e.$t("intranet.configuracionMatricula.cmatricula.mensaje")},null,8,["modelValue","float-label"])])])),e.modeEditor||e.chkEnviarCarta?((0,i.uX)(),(0,i.CE)("div",I,[(0,i.Lk)("div",D,[(0,i.bF)(R,{modelValue:e.mensajeCorreo,"onUpdate:modelValue":o[9]||(o[9]=function(o){return e.mensajeCorreo=o})},null,8,["modelValue"])])])):(0,i.Q3)("v-if",!0),"O"!==e.tipo?((0,i.uX)(),(0,i.CE)("div",S,[(0,i.Lk)("div",{class:(0,r.C4)({"col-xs-6 col-md-2":"P"!==e.tipo,"col-xs-12 col-md-4":"P"===e.tipo})},[(0,i.bF)(t,{class:"q-if-outlined",modelValue:e.instrucod,"onUpdate:modelValue":o[10]||(o[10]=function(o){return e.instrucod=o}),options:e.niveles,label:e.$t("ngs.nivel"),preSelect:e.preSelect},null,8,["modelValue","options","label","preSelect"])],2),(0,i.Lk)("div",{class:(0,r.C4)({"col-xs-6 col-md-2":"P"!==e.tipo,"col-xs-12 col-md-4":"P"===e.tipo})},[(0,i.bF)(t,{class:"q-if-outlined",modelValue:e.gradocod,"onUpdate:modelValue":o[11]||(o[11]=function(o){return e.gradocod=o}),options:e.grados,label:e.$t("ngs.grado"),preSelect:e.preSelect},null,8,["modelValue","options","label","preSelect"])],2),(0,i.Lk)("div",{class:(0,r.C4)({"col-xs-6 col-md-1":"P"!==e.tipo,"col-xs-12 col-md-4":"P"===e.tipo})},[(0,i.bF)(t,{class:"q-if-outlined",modelValue:e.seccioncod,"onUpdate:modelValue":o[12]||(o[12]=function(o){return e.seccioncod=o}),options:e.secciones,label:e.$t("ngs.seccion"),preSelect:e.preSelect},null,8,["modelValue","options","label","preSelect"])],2),"P"!==e.tipo?((0,i.uX)(),(0,i.CE)("div",N,[(0,i.bF)(t,{class:"q-if-outlined",modelValue:e.matriculado,"onUpdate:modelValue":o[13]||(o[13]=function(o){return e.matriculado=o}),onInput:e.limpiarCorreosSeleccion,options:e.matriculados,label:e.$t("alumnoestado.M")},null,8,["modelValue","onInput","options","label"])])):(0,i.Q3)("v-if",!0),e.isFamiliaAlumno?((0,i.uX)(),(0,i.CE)("div",U,[(0,i.Lk)("div",F,[(0,i.Lk)("div",L,[(0,i.Lk)("div",null,(0,r.v_)(e.$t("anoIng")),1),(0,i.Lk)("div",null,[(0,i.bF)(G,{class:"float-left q-mr-lg-sm",onInput:e.limpiarCorreosSeleccion,modelValue:e.chkTipoAnioIng,"onUpdate:modelValue":o[14]||(o[14]=function(o){return e.chkTipoAnioIng=o}),options:e.optTipoAnioIng,color:"primary",inline:""},null,8,["onInput","modelValue","options"])])]),(0,i.Lk)("div",P,[(0,i.bF)(t,{class:"q-if-outlined mtop",modelValue:e.anio,"onUpdate:modelValue":o[15]||(o[15]=function(o){return e.anio=o}),options:e.anios,label:e.$t("anoIng"),preSelect:e.preSelect},null,8,["modelValue","options","label","preSelect"])])])])):(0,i.Q3)("v-if",!0)])):(0,i.Q3)("v-if",!0),(0,i.Lk)("div",M,[(0,i.bF)(X,{class:"full-width",style:{height:"330px"},filter:e.filtro,data:e.usuarios,columns:e.columnas,"row-key":"USUCOD",color:"secondary",selection:e.selection,selected:e.selected,"onUpdate:selected":o[17]||(o[17]=function(o){return e.selected=o})},{"top-right":(0,i.k6)(function(t){return[(0,i.bF)(Q,{class:"q-if-outlined","hide-underline":"",color:"primary",modelValue:e.filtro,"onUpdate:modelValue":o[16]||(o[16]=function(o){return e.filtro=o})},null,8,["modelValue"])]}),_:1},8,["filter","data","columns","selection","selected"])]),3!==e.acceso||e.isLess?(0,i.Q3)("v-if",!0):((0,i.uX)(),(0,i.Wv)(H,{key:5,expand:"",position:"bottom-right",offset:[20,20]},{default:(0,i.k6)(function(){return[(0,i.bF)(q,{fab:"",round:"",color:"secondary",icon:"send",onClick:e.enviarCorreo},null,8,["onClick"])]}),_:1})),3===e.acceso&&e.isLess?((0,i.uX)(),(0,i.Wv)(z,{key:6,class:"fixed-top q-toolbar-menu",inverted:""},{default:(0,i.k6)(function(){return[(0,i.bF)(W),(0,i.bF)(q,{flat:"",round:"",dense:"",icon:"send",color:"white",onClick:e.enviarCorreo},null,8,["onClick"])]}),_:1})):(0,i.Q3)("v-if",!0)],64)):((0,i.uX)(),(0,i.CE)("div",y,[(0,i.bF)(J,{subtitle:"mensajes.m0023",icon:"email"})]))]),(0,i.bF)(ee,{class:"enviados-modal",modelValue:e.openEnviados,"onUpdate:modelValue":o[18]||(o[18]=function(o){return e.openEnviados=o}),title:e.tituloEnviados,header:!0,ok:!1,loading:e.loadingEnviados},{footer:(0,i.k6)(function(){return[(0,i.Lk)("div",null,[(0,i.bF)(z,{class:"justify-end",color:"grey-2"},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",_,"Total: "+(0,r.v_)(e.enviados.length),1)]}),_:1})])]}),default:(0,i.k6)(function(){return[(0,i.bF)(X,{class:"col q-ma-sm",style:(0,r.Tr)(e.isLess?"height: 89vh":"height: 600px"),data:e.enviados,columns:e.columnaEnviados,"row-key":"name",hideBottom:""},{body:(0,i.k6)(function(t){return[(0,i.bF)(Z,{props:t},{default:(0,i.k6)(function(){return[(0,i.bF)(K,{key:"FH_ENVIO",props:t},{default:(0,i.k6)(function(){return[(0,i.eW)((0,r.v_)(e.date(t.row.FH_ENVIO,"DD/MM/YYYY HH:mm")),1)]}),_:2},1032,["props"]),(0,i.bF)(K,{key:"ASUNTO",props:t},{default:(0,i.k6)(function(){return[(0,i.eW)((0,r.v_)(t.row.ASUNTO),1)]}),_:2},1032,["props"]),(0,i.bF)(K,{key:"ID_ENVIO",props:t},{default:(0,i.k6)(function(){return[(0,i.bF)(B,{class:"cursor-pointer",name:"print",size:"20px",onClick:function(o){return e.imprimir(t.row.ID_ENVIO)}},null,8,["onClick"]),e.reporteAlerta?((0,i.uX)(),(0,i.Wv)(B,{key:0,class:"cursor-pointer",name:"file_pdf",size:"20px",onClick:function(o){return e.imprimirReporteAlerta(t.row.ID_ENVIO)}},{default:(0,i.k6)(function(){return[(0,i.bF)(Y,{class:"column"},{default:(0,i.k6)(function(){return n()(o[22]||(o[22]=[(0,i.Lk)("div",{class:"row"},[(0,i.Lk)("div",{class:"text-bold"},"Alertas")],-1)]))}),_:1})]}),_:1},8,["onClick"])):(0,i.Q3)("v-if",!0)]}),_:2},1032,["props"])]}),_:2},1032,["props"])]}),_:1},8,["style","data","columns"])]}),_:1},8,["modelValue","title","loading"]),(0,i.bF)(ee,{class:"etiquetas-modal",modelValue:e.openEtiquetas,"onUpdate:modelValue":o[19]||(o[19]=function(o){return e.openEtiquetas=o}),title:"Etiquetas",header:!0,footer:!1,ok:!1,loading:e.loadingEtiquetas},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",T,[(0,i.Lk)("div",j,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.etiquetas,function(e,o){return(0,i.uX)(),(0,i.Wv)(le,{key:o,class:"q-mb-sm q-py-none",separator:""},{default:(0,i.k6)(function(){return[(0,i.bF)(oe,{class:"bg-secondary text-white text-center text-weight-bold"},{default:(0,i.k6)(function(){return[(0,i.eW)((0,r.v_)(o),1)]}),_:2},1024),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e,function(e,o){return(0,i.uX)(),(0,i.Wv)(ne,{key:o},{default:(0,i.k6)(function(){return[(0,i.bF)(te,{class:"text-weight-bold text-black"},{default:(0,i.k6)(function(){return[(0,i.eW)((0,r.v_)("<".concat(o,">")),1)]}),_:2},1024),(0,i.bF)(ae,null,{default:(0,i.k6)(function(){return[(0,i.eW)((0,r.v_)(e),1)]}),_:2},1024)]}),_:2},1024)}),128)),(0,i.bF)(ie)]}),_:2},1024)}),128))])]),e.isFamiliaAlumno?((0,i.uX)(),(0,i.CE)("div",V,n()(o[23]||(o[23]=[(0,i.Lk)("div",{class:"col"},"NOTA: # indica la posición del alumno, ejemplo: alucod1",-1)])))):(0,i.Q3)("v-if",!0)]}),_:1},8,["modelValue","loading"]),(0,i.bF)(ee,{class:"enviocorreo-modal-adjuntos",modelValue:e.modalAdjuntos,"onUpdate:modelValue":o[21]||(o[21]=function(o){return e.modalAdjuntos=o}),title:"Adjuntar",header:!0,footer:!0,onSubmit:e.agregarAdjunto},{default:(0,i.k6)(function(){return[(0,i.bF)(re,{modelValue:e.adjuntos,"onUpdate:modelValue":o[20]||(o[20]=function(o){return e.adjuntos=o})},null,8,["modelValue"])]}),_:1},8,["modelValue","onSubmit"])]}),_:1})}var x=t(76080),$=t.n(x),w=t(45254),R=t.n(w),G=(t(12563),t(30683),t(39866),t(23825),t(10239),t(56285),t(50310),t(90095),t(48426),t(83190),t(27153),t(76921),t(13600),t(52776),t(37406),t(44264),t(66307),t(34993),t(13715),t(24066),t(57053),t(94013),t(32701),t(67396),t(50923),t(59502),t(6123)),Q=t(30640),X=t(93616),H=t(80340),W=t(6083),z=t(32195),J=t(16648),K=t(30545),B=t(80660),Y=t(982),Z=t(99637),ee=t(13813),oe=t(57668),te=t(48086),ae=t(33001),ne=t(8261),ie=t(54760),le=t(18105),re=t(78131),se=t(81288),ue=(t(52133),t(6724),t(70199),t(515),t(49089),t(7346),t(47035)),ce={obtPerfiles:function(){return B.$http.get("api/HyoTipUsuAcc/obtListaPerfiles",{params:{grupos:!0}}).then(function(e){var o=e.json;return o})},obtCorreoFamiliaAlumno:function(){return B.$http.get("api/HyoEnviocorreos/obtCorreosFamiliaAlumno").then(function(e){var o=e.json,t=JSON.parse(JSON.stringify(o)).map(function(e){return e.USUCOD=e.ALU_USUCOD,e.NGS=e.INSTRUCOD+""+e.GRADOCOD+e.SECCIONCOD,e}),a=JSON.parse(JSON.stringify(o)).map(function(e){return e.USUCOD=e.FAM_USUCOD,e}),n={x:{value:"0000",label:"Todos",orden:"999999"}},i={x:{value:"T",label:"Todos",orden:"a"}},l={},r={};return o.forEach(function(e){e.FAM_ANOING&&(n[e.FAM_ANOING]={value:e.FAM_ANOING,label:e.FAM_ANOING,orden:e.FAM_ANOING}),e.ALU_ANOING&&(n[e.ALU_ANOING]={value:e.ALU_ANOING,label:e.ALU_ANOING,orden:e.ALU_ANOING}),i[e.INSTRUCOD]={value:e.INSTRUCOD,label:e.INSTRUDES,orden:e.INSTRUCOD},l[e.INSTRUCOD+"-"+e.GRADOCOD]={INSTRUCOD:e.INSTRUCOD,GRADOCOD:e.GRADOCOD,GRADODES:e.GRADODES},r[e.INSTRUCOD+"-"+e.GRADOCOD+"-"+e.SECCIONCOD]={INSTRUCOD:e.INSTRUCOD,GRADOCOD:e.GRADOCOD,SECCIONCOD:e.SECCIONCOD,SECCIONDES:e.SECCIONDES}}),{anios:(0,ue["default"])(Object.values(n),"desc","orden"),niveles:(0,ue["default"])(Object.values(i),"asc","orden"),grados:(0,ue["default"])(Object.values(l),"asc","GRADOCOD"),secciones:(0,ue["default"])(Object.values(r),"asc","SECCIONCOD"),alumnos:(0,ue["default"])(t,"asc","FAMDES"),familias:(0,ue["default"])(a,"asc","FAMDES")}})},obtCorreoDocente:function(){return B.$http.get("api/HyoProfes/obtCorreoDocente").then(function(e){return(0,ue["default"])(e,"asc","NOMCOMP")})},obtCorreoPersonal:function(){return B.$http.get("api/HyoProfes/obtCorreoPersonal").then(function(e){return(0,ue["default"])(e,"asc","NOMCOMP")})},obtDatosDeColegio:function(){return B.$http.get("api/HyoColegios/obtenerDatosDeColegio").then(function(e){var o=e.json;return o})},obtCorreosEnviados:function(){return B.$http.post("api/HyoEnviocorreos/obtCorreosEnviados").then(function(e){var o=e.json;return o.fulfillmentValue?o.fulfillmentValue:o})}},de={components:{QCard:G.C$,QCheckbox:G.vZ,QSelect:J.S,QPageSticky:G._U,QChipsInput:G.XX,QOptionGroup:G.EX,QTable:K.A,QTh:G.EJ,QTr:G.qh,QTd:G.Ef,QTableColumns:G.$s,QToolbar:G.ZV,sieInfo:oe["default"],destinatarios:te.A,sieSelect:X.A,sieModal:Q.A,sieEditor:W.A,sieCloud:z.A,sieVacio:H.A,QPage:G.Tu,QBtn:G.Il,QInput:G.ie,QSearch:G.Ks,QToolbarTitle:G.r_,QIcon:G.bP,QTooltip:G.nC,QList:G.Mb,QListHeader:G.XR,QItem:G.H0,QItemSide:G.n1,QItemMain:G.mF,QItemSeparator:G.CL},data:function(){return{acceso:(0,oe["default"])().ruta.nivel,tipos:[{label:this.$t("familia"),value:"F"},{label:this.$t("alumno"),value:"A"},{label:this.$t("profesor"),value:"P"},{label:this.$t("seguridad.personal"),value:"O"}],tipo:null,chkEnviarCarta:0,asunto:"",mensajeCorreo:"",modeEditor:!1,alumnosTemp:[],familiasTemp:[],docentesTemp:[],personalTemp:[],niveles:[],instrucod:"T",gradosTemp:[],gradocod:"",seccionesTemp:[],seccioncod:"",matriculados:[{label:"Todos",value:"T"},{label:"Si",value:"S"},{label:"No",value:"N"}],chkTipoAnioIng:"A",optTipoAnioIng:[{label:"Por Familia",value:"F"},{label:"Por Alumno",value:"A"}],matriculado:"T",filtro:"",selection:"multiple",selected:[],enviado:!1,reporteIdUltimoEnvio:null,openEnviados:!1,tituloEnviados:"Imprimir Correos",loadingEnviados:!1,plant_carta:"",enviados:[],columnaEnviados:[{name:"FH_ENVIO",label:this.$t("fecha"),field:"FH_ENVIO",align:"left",sortable:!0},{name:"ASUNTO",label:this.$t("intranet.mensajeria.asunto"),field:"ASUNTO",align:"left",sortable:!0},{name:"ID_ENVIO",label:this.$t("imprimir"),field:"ID_ENVIO",align:"center",sortable:!0}],openEtiquetas:!1,loadingEtiquetas:!1,loadingGuardar:!1,adjuntos:[],modalAdjuntos:!1,chipAdjuntos:[],anio:"0000",anios:[],perfiles:[],data:[],enviarSobreFiltro:["0245"].includes((0,oe["default"])().colcod),isAgregarCopia:["0288"].indexOf((0,oe["default"])().colcod)>=0,reporteAlerta:["0020","0275"].includes((0,oe["default"])().colcod)}},computed:{usuarios:function(){var e=[];return"F"===this.tipo?e=this.familiasTemp:"A"===this.tipo?e=this.alumnosTemp:"P"===this.tipo?e=this.docentesTemp:"O"===this.tipo&&(e=this.personalTemp),"O"!==this.tipo&&("T"!==this.instrucod&&(e=(0,ae.filterArray)(this.instrucod,{field:"INSTRUCOD",list:e})),"T"!==this.gradocod&&(e=(0,ae.filterArray)(this.gradocod,{field:"GRADOCOD",list:e})),"T"!==this.seccioncod&&(e=(0,ae.filterArray)(this.seccioncod,{field:"SECCIONCOD",list:e})),this.isFamiliaAlumno&&("T"!==this.matriculado&&(e=(0,ae.filterArray)(this.matriculado,{field:"MATRICULA",list:e})),"0000"!==this.anio&&(e="F"===this.chkTipoAnioIng?(0,ae.filterArray)(this.anio,{field:"FAM_ANOING",list:e}):(0,ae.filterArray)(this.anio,{field:"ALU_ANOING",list:e})))),"F"===this.tipo?e=(0,ne["default"])(e,"FAMCOD"):["P","O"].indexOf(this.tipo)>=0&&(e=(0,ne["default"])(e,"PROFCOD")),e},columnas:function(){var e=[];return"F"===this.tipo?e.push({name:"FAMCOD",label:this.$t("codigo"),field:"FAMCOD",align:"center",sortable:!0},{name:"FAMDES",label:this.$t("nombres"),field:"FAMDES",align:"left",sortable:!0},{name:"PADMAIL",label:this.$t("correoPadre"),field:"PADMAIL",align:"center",sortable:!0},{name:"MADMAIL",label:this.$t("correoMadre"),field:"MADMAIL",align:"center",sortable:!0},{name:"APOMAIL",label:this.$t("correoApoderado"),field:"APOMAIL",align:"center",sortable:!0}):"A"===this.tipo?e.push({name:"ALUCOD",label:this.$t("codigo"),field:"ALUCOD",align:"center",sortable:!0},{name:"NGS",label:"NGS",field:"NGS",align:"center",sortable:!0},{name:"NOMCOMP",label:this.$t("nombres"),field:"NOMCOMP",align:"left",sortable:!0},{name:"ALU_EMAIL",label:this.$t("correoEstudiante"),field:"ALU_EMAIL",align:"center",sortable:!0}):"P"===this.tipo?e.push({name:"PROFCOD",label:this.$t("codigo"),field:"PROFCOD",align:"center",sortable:!0},{name:"NOMCOMP",label:this.$t("nombres"),field:"NOMCOMP",align:"left",sortable:!0},{name:"EMAIL",label:this.$t("correo"),field:"EMAIL",align:"center",sortable:!0}):"O"===this.tipo&&e.push({name:"USUCOD",label:this.$t("codigo"),field:"USUCOD",align:"center",sortable:!0},{name:"NOMCOMP",label:this.$t("nombres"),field:"NOMCOMP",align:"left",sortable:!0},{name:"EMAIL",label:this.$t("correo"),field:"EMAIL",align:"center",sortable:!0}),e},grados:function(){var e=this.gradosTemp;return e=(0,ae.filterArray)(this.instrucod,{field:"INSTRUCOD",list:e}),e.unshift({GRADOCOD:"T",GRADODES:"Todos"}),e=(0,ee["default"])(e,function(e){return{label:e.GRADODES,value:e.GRADOCOD}}),this.gradocod="T",e},secciones:function(){var e=this.seccionesTemp;return e=(0,ae.filterArray)(this.instrucod,{field:"INSTRUCOD",list:e}),e=(0,ae.filterArray)(this.gradocod,{field:"GRADOCOD",list:e}),e.unshift({SECCIONCOD:"T",SECCIONDES:"Todos"}),e=(0,ee["default"])(e,function(e){return{label:e.SECCIONDES,value:e.SECCIONCOD}}),this.seccioncod="T",e},correos:function(){var e=[];return this.correosUsuario.forEach(function(o){-1===e.indexOf(o.correo)&&e.push(o.correo)}),e},correosUsuario:function(){var e=this,o=[],t=[],a=new RegExp("[,;]");return(0,Z["default"])(this.data,function(e){if(e.EMAIL&&""!==e.EMAIL){var n=e.EMAIL.split(a);(0,Z["default"])(n,function(a){a&&!o.includes(e.USUCOD+"-"+a)&&(o.push(e.USUCOD+"-"+a),t.push({usucod:e.USUCOD,correo:a}))})}}),(0,Z["default"])(this.selected,function(n){var i=[],l=[];"F"===e.tipo?(n.PADMAIL&&""!==n.PADMAIL&&(i=i.concat(n.PADMAIL.split(a)),l=l.concat(n.PAD_ID_PERSONA)),n.MADMAIL&&""!==n.MADMAIL&&(i=i.concat(n.MADMAIL.split(a)),l=l.concat(n.MAD_ID_PERSONA)),n.APOMAIL&&""!==n.APOMAIL&&(i=i.concat(n.APOMAIL.split(a)),l=l.concat(n.APO_ID_PERSONA))):"A"===e.tipo?n.ALU_EMAIL&&""!==n.ALU_EMAIL&&(i=n.ALU_EMAIL.split(a),l=l.concat(n.ID_PERSONA)):n.EMAIL&&""!==n.EMAIL&&(i=n.EMAIL.split(a),l=l.concat(n.ID_PERSONA)),(0,Z["default"])(i,function(e,a){e&&!o.includes(n.USUCOD+"-"+e)&&(o.push(n.USUCOD+"-"+e),t.push({usucod:n.USUCOD,correo:e,id_persona:l[a]}))})}),t},isFamiliaAlumno:function(){return["A","F"].indexOf(this.tipo)>=0},etiquetas:function(){var e={},o={fecha:"Fecha",colegio:"Nombre del Colegio",director:"Nombre del Director del Colegio",email:"Correo Administrativo del Colegio",pagweb:"Pagina Web del Colegio",distrito:"Distrito del Colegio"},t={"alumno#":"Nombre del Alumno","alunomcomp#":"Nombre y apellido del Alumno","alucod#":"Usuario del Alumno","alucodgoogle#":"Usuario del Alumno en Minúscula","usupasa#":"Contraseña del Alumno","codbanco#":"Código de Banco del alumno","nemodes#":"Salón del Alumno (matriculados)","docide#":"Documento del Alumno","codalumno#":"Código del Alumno","email#":"Correo del Alumno"},a={famdes:"Nombre de Familia",famcod:"Usuario de Familia",codigof:"Código de Familia",usupasf:"Contraseña de la Familia"};if(["0011"].indexOf((0,oe["default"])().colcod)>=0?(a["contacod"]="Código Contable",a["sociores"]="Socio Responsable"):["0245"].indexOf((0,oe["default"])().colcod)>=0?t["respago#"]="Responsable de Pago del Alumno":["0329"].indexOf((0,oe["default"])().colcod)>=0?(a["respago"]="Responsable de Pago",a["docrespago"]="DNI del Responsable de Pago",a["respmat"]="Responsable de Matrícula",a["docrespmat"]="DNI del Responsable de Matrícula"):["0388"].indexOf((0,oe["default"])().colcod)>=0?a["house"]="House":-1!==["0073","0078"].indexOf((0,oe["default"])().colcod)?a["clavemat"]="Contraseña de matricula":-1!==["0500"].indexOf((0,oe["default"])().colcod)&&(a["maddoc"]="Documento madre",a["madmail"]="Correo electrónico madre",a["paddoc"]="Documento padre",a["padmail"]="Correo electrónico padre"),this.isFamiliaAlumno)"F"===this.tipo?(a["nivel"]="Nivel (descripción)",a["grado"]="Grado (descripción)",a["seccion"]="Sección (descripción)",a["ngs"]="Nivel, Grado y Sección"):o["ngs"]="Nivel, Grado y Sección",e.standard=o,e.familia=a,e.alumno=t;else if("P"===this.tipo||"O"===this.tipo){var n={pernom:"Nombre del Personal",profcod:"Usuario del Personal",usupasp:"Contraseña del Personal",profcodgoogle:"Usuario del Personal en Minúscula"};e.standard=Object.assign(o,n)}return e},isLess:function(){return(0,se.isLess)()}},methods:{date:le.Ay,obtMensaje:function(){var e=this;if(this.chkEnviarCarta=0,["F","A","P","O"].indexOf(this.tipo)>=0){var o={};"P"===this.tipo?o.tipo="P":o.tipo=this.tipo,B.$http.get("api/HyoPlantillausuarios/obtMensaje",{params:o}).then(function(o){var t=o.json;e.plant_carta=t[0]?t[0].PLANTILLA:"",e.setPlantilla()})}},setPlantilla:function(){1===this.chkEnviarCarta?this.mensajeCorreo=this.plant_carta:this.mensajeCorreo=""},resetPlantilla:function(e){this.mensajeCorreo="",this.obtMensaje(),e&&this.limpiarCorreosSeleccion()},enviarCorreo:function(){""===this.asunto?(0,Y["default"])(this.$t("mensajes.a0008"),"warning"):""===this.mensajeCorreo?(0,Y["default"])(this.$t("mensajes.a0009"),"warning"):0===this.correos.length?(0,Y["default"])(this.$t("mensajes.a0010"),"warning"):this._enviarCorreo(this.chkEnviarCarta,this.tipo)},_enviarCorreo:function(e,o){var t=this;return R()($()().m(function a(){var n;return $()().w(function(a){while(1)switch(a.p=a.n){case 0:if(t.$q.loading.show(),a.p=1,!e){a.n=6;break}if("P"!==o&&"O"!==o){a.n=3;break}return a.n=2,B.$http.post("api/HyoEnviocorreos/enviaCartasDocentes",{asunto:t.asunto,mensaje:t.mensajeCorreo,usuarios:t.correosUsuario});case 2:n=a.v,a.n=5;break;case 3:return a.n=4,B.$http.post("api/HyoEnviocorreos/enviaCartasFamAlu",{mensaje:t.mensajeCorreo,asunto:t.asunto,tipo:o,usuarios:t.correosUsuario,enviarSobreFiltro:t.enviarSobreFiltro,filtros:{chkTipoAnioIng:t.chkTipoAnioIng,anoing:t.anio,instrucod:t.instrucod,gradocod:t.gradocod,seccioncod:t.seccioncod,matricula:t.matriculado}});case 4:n=a.v;case 5:a.n=8;break;case 6:return a.n=7,B.$http.post("api/HyoEnviocorreos/enviarCorreo",{asunto:t.asunto,mensaje:t.mensajeCorreo,adjuntos:t.adjuntos,usuarios:t.correosUsuario});case 7:n=a.v;case 8:(0,Y["default"])(t.$t("mensajes."+n.json.msg),"m0019"===n.json.msg?"success":"warning"),n&&n.json&&"success"===n.json.tipo&&(t.enviado=!0,t.reporteIdUltimoEnvio=n.json.id,t.adjuntos=[],t.chipAdjuntos=[],t.asunto="",t.limpiarCorreosSeleccion(),e&&t.plant_carta!==t.mensajeCorreo&&t._avisoGuardarNuevaPlantillaCarta(o)),a.n=10;break;case 9:a.p=9,a.v,(0,Y["default"])("Ocurrió un error","warning");case 10:t.$q.loading.hide();case 11:return a.a(2)}},a,null,[[1,9]])}))()},_avisoGuardarNuevaPlantillaCarta:function(e){var o=this;this.$q.dialog({title:this.$t("mensajes.m0065"),ok:this.$t("respuesta.S"),cancel:this.$t("respuesta.N"),preventClose:!0}).onOk(function(){o.plant_carta=o.mensajeCorreo,B.$http.post("api/HyoPlantillausuarios/grabarPlantilla",{plantilla:o.mensajeCorreo,tipo:e}).then(function(e){e.json;o.resetPlantilla(),(0,Y["default"])(o.$t("mensajes.m0064"),"success"),o.$q.loading.hide()})}).onCancel(function(e){})},imprimir:function(e){var o={ID_ENVIO:e,repcod:"envioCorreo",format:"pdf","sie-token":(0,oe["default"])().token},t=(0,oe["default"])().url+"/intranet/reporte-node/reporte?"+(0,ie.stringify)(o);(0,G.KN)(t)},imprimirReporteAlerta:function(e){if(!e)return this.$alert("No se han enviado correos");var o="".concat((0,oe["default"])().origin,"/webservice/reporte-tesoreria/reporte-alertas-intranet?idEnvio=").concat(e);window.open(o,"_blank")},correosEnviados:function(){var e=this;return R()($()().m(function o(){return $()().w(function(o){while(1)switch(o.n){case 0:return e.enviados=[],e.openEnviados=!0,e.loadingEnviados=!0,o.n=1,ce.obtCorreosEnviados();case 1:e.enviados=o.v,e.loadingEnviados=!1;case 2:return o.a(2)}},o)}))()},abrirEtiquetas:function(){this.openEtiquetas=!0},exportarCorreos:function(){var e="";(0,Z["default"])(this.correos,function(o){e=e+o+"; "}),e=e.substring(0,e.length-2);var o=new Blob([e],{type:"text/plain"}),t=URL.createObjectURL(o);(0,re["default"])(t,"correos.txt")},abrirAdjuntos:function(){this.modalAdjuntos=!0},agregarAdjunto:function(){var e=this;(0,Z["default"])(this.adjuntos,function(o){e.chipAdjuntos.push(o.name)}),this.modalAdjuntos=!1},limpiarCorreosSeleccion:function(){this.data=[],this.selected=[]},preSelect:function(){var e=this;if(this.correosUsuario.length){var o=this.$t;return this.chkEnviarCarta&&this.enviarSobreFiltro?((0,Y["default"])("Existen registros seleccionados, envie primero el mensaje","error"),Promise.reject(new Error("error"))):this.$q.dialog({title:"Aviso",message:"Existen registros seleccionados, ¿desea mantener la selección?",ok:o("botones.si"),cancel:o("botones.no"),preventClose:!0}).onOk(function(){return Promise.resolve(!0)}).onCancel(function(){return e.limpiarCorreosSeleccion(),Promise.resolve(!0)})}return Promise.resolve(!0)},init:function(){var e=this;return R()($()().m(function o(){var t;return $()().w(function(o){while(1)switch(o.p=o.n){case 0:if(o.p=0,!e.isAgregarCopia){o.n=2;break}return o.n=1,ce.obtPerfiles();case 1:e.perfiles=o.v;case 2:return o.n=3,ce.obtCorreoDocente();case 3:return e.docentesTemp=o.v,o.n=4,ce.obtCorreoPersonal();case 4:return e.personalTemp=o.v,o.n=5,ce.obtCorreoFamiliaAlumno();case 5:t=o.v,e.alumnosTemp=t.alumnos,e.familiasTemp=t.familias,e.anios=t.anios,e.niveles=t.niveles,e.gradosTemp=t.grados,e.seccionesTemp=t.secciones,o.n=7;break;case 6:o.p=6,o.v,e.$notify("Ha ocurrido un problema de conexión vuelve a intentarlo","warning");case 7:return o.a(2)}},o,null,[[0,6]])}))()}},created:function(){this.init()}},pe=t(12807);const me=(0,pe.A)(de,[["render",q]]);var fe=me}}]);