"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[56996],{56996:function(e,t,n){n.r(t),n.d(t,{default:function(){return D}});var r=n(61758),a=n(58790),o={key:1,class:"row col"},i={class:"col-md-4 col-sm-5 col-xs-12 full-height q-py-md q-pl-md q-pr-sm-none q-pr-xs-md"},u={class:"col-md-8 col-sm-7 col-xs-12 column full-height overflow-auto q-pa-xs-md"},s={class:"row justify-center q-mb-md"},l={class:"row q-pa-sm"},c={class:"col-12"},d={class:"row"},m={class:"col"},f={class:"q-item-icon q-item-inverted flex flex-center"};function p(e,t){var n=(0,r.g2)("sie-vacio"),p=(0,r.g2)("q-avatar"),g=(0,r.g2)("q-item-section"),b=(0,r.g2)("q-item-label"),v=(0,r.g2)("sie-progress"),h=(0,r.g2)("q-icon"),k=(0,r.g2)("q-item"),F=(0,r.g2)("q-list"),O=(0,r.g2)("q-popover"),q=(0,r.g2)("sie-creator"),y=(0,r.g2)("q-btn"),Q=(0,r.g2)("q-search"),w=(0,r.g2)("q-item-side"),A=(0,r.g2)("q-item-main"),_=(0,r.g2)("q-checkbox"),C=(0,r.g2)("sie-modal"),x=(0,r.g2)("q-page"),L=(0,r.gN)("ripple"),R=(0,r.gN)("close-overlay");return(0,r.uX)(),(0,r.Wv)(x,null,{default:(0,r.k6)(function(){return[e.vacio?((0,r.uX)(),(0,r.Wv)(n,{key:0})):((0,r.uX)(),(0,r.CE)("div",o,[(0,r.Lk)("div",i,[(0,r.bF)(F,{class:"bg-white q-py-none overflow-auto full-height",separator:""},{default:(0,r.k6)(function(){return[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.examenes,function(t,n){return(0,r.bo)(((0,r.uX)(),(0,r.Wv)(k,{key:n,clickable:"",onClick:function(n){return e.getCamposByForm(t)},active:e.idFormulario===t.ID_FORMULARIO,"active-class":"bg-grey-12 text-grey-8"},{default:(0,r.k6)(function(){return[(0,r.bF)(g,{avatar:""},{default:(0,r.k6)(function(){return[(0,r.bF)(p,{icon:t.ICONO,"text-color":"white",style:(0,a.Tr)({"background-color":t.COLOR})},null,8,["icon","style"])]}),_:2},1024),(0,r.bF)(g,null,{default:(0,r.k6)(function(){return[(0,r.bF)(b,{lines:"2"},{default:(0,r.k6)(function(){return[(0,r.eW)((0,a.v_)(t.TITULO),1)]}),_:2},1024),(0,r.bF)(b,{caption:""},{default:(0,r.k6)(function(){return[(0,r.eW)((0,a.v_)(t.CURSONOM),1)]}),_:2},1024),(0,r.bF)(b,{caption:""},{default:(0,r.k6)(function(){return[(0,r.eW)((0,a.v_)(t.INSTRUDES)+" - "+(0,a.v_)(t.GRADODES),1)]}),_:2},1024),(0,r.bF)(b,{caption:""},{default:(0,r.k6)(function(){return[(0,r.bF)(v,{height:"18px",total:t.NRO_PREGUNTAS,progreso:t.PROGRESO},null,8,["total","progreso"])]}),_:2},1024)]}),_:2},1024),!t.NRO_PREGUNTAS||t.AGOTADO||t.BLOQUEADO?(0,r.Q3)("v-if",!0):((0,r.uX)(),(0,r.Wv)(g,{key:0,side:""},{default:(0,r.k6)(function(){return[(0,r.bF)(h,{name:"more_vert"},{default:(0,r.k6)(function(){return[(0,r.bF)(O,null,{default:(0,r.k6)(function(){return[(0,r.bF)(F,{link:""},{default:(0,r.k6)(function(){return[(0,r.bo)(((0,r.uX)(),(0,r.Wv)(k,{clickable:"",onClick:function(n){return e.historialPreguntas(t)}},{default:(0,r.k6)(function(){return[(0,r.bF)(g,{avatar:""},{default:(0,r.k6)(function(){return[(0,r.bF)(h,{name:"history",color:"black"})]}),_:1}),(0,r.bF)(g,null,{default:(0,r.k6)(function(){return[(0,r.bF)(b,null,{default:(0,r.k6)(function(){return[(0,r.eW)((0,a.v_)(e.$t("botones.hitorialPreguntas")),1)]}),_:1})]}),_:1})]}),_:1},8,["onClick"])),[[L],[R]])]}),_:2},1024)]}),_:2},1024)]}),_:2},1024)]}),_:2},1024))]}),_:2},1032,["onClick","active"])),[[L]])}),128))]}),_:1})]),(0,r.Lk)("div",u,[e.idFormulario?((0,r.uX)(),(0,r.CE)(r.FK,{key:0},[(0,r.bF)(q,{class:"col full-height full-width overflow-auto q-mb-md",questions:e.questions,edit:!!e.edit,descripcion:e.objFormulario,numOptions:e.maxOpciones,subtitle:e.cursonom,simulacro:""},null,8,["questions","edit","descripcion","numOptions","subtitle"]),(0,r.Lk)("div",s,[(0,r.bF)(y,{onClick:e.saveQuestions,label:e.$t("botones.guardar"),color:"secondary",disable:e.bloqueado},null,8,["onClick","label","disable"])])],64)):((0,r.uX)(),(0,r.Wv)(n,{key:1,class:"col",title:e.$t("mensajes.m0027")},null,8,["title"]))])])),(0,r.bF)(C,{class:"modal-historial-pregunta",modelValue:e.modal,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.modal=t}),title:e.$t("botones.hitorialPreguntas"),ok:e.$t("botones.copiar"),onSubmit:e.copyPreguntas},{default:(0,r.k6)(function(){return[(0,r.Lk)("div",l,[(0,r.Lk)("div",c,[(0,r.bF)(Q,{class:"q-if-outlined",modelValue:e.searchQuest,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.searchQuest=t})},null,8,["modelValue"])])]),(0,r.Lk)("div",d,[(0,r.Lk)("div",m,[(0,r.bF)(F,{separator:""},{default:(0,r.k6)(function(){return[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.historyQuestions,function(n,o){return(0,r.uX)(),(0,r.Wv)(k,{key:o},{default:(0,r.k6)(function(){return[(0,r.bF)(w,null,{default:(0,r.k6)(function(){return[(0,r.Lk)("div",f,(0,a.v_)(o+1),1)]}),_:2},1024),(0,r.bF)(A,{innerHTML:n.title},null,8,["innerHTML"]),(0,r.bF)(w,null,{default:(0,r.k6)(function(){return[(0,r.bF)(_,{class:"q-if-outlined",modelValue:e.selectionQuestions,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.selectionQuestions=t}),val:n},null,8,["modelValue","val"])]}),_:2},1024)]}),_:2},1024)}),128))]}),_:1})])])]}),_:1},8,["modelValue","title","ok","onSubmit"])]}),_:1})}var g=n(76080),b=n.n(g),v=n(45254),h=n.n(v),k=(n(30683),n(71225),n(10239),n(56285),n(50310),n(5962),n(83190),n(52776),n(81813),n(68017),n(6123)),F=n(65673),O=n(82327),q=n(88865),y=n(66824),Q=n(74656),w=(n(70199),n(515),n(7346),n(80660)),A={obtFormulariosAsignados:function(){return w.$http.get("api/HyoFormulario/obtFormulariosAsignados")},getCamposByForm:function(e){return w.$http.get("api/HyoCampo/getCamposByForm",{params:e})},saveQuestions:function(e){return w.$http.post("api/HyoFormulario/saveForm",JSON.parse(JSON.stringify(e)))},historialPreguntas:function(e){return w.$http.get("api/HyoPregunta/historialPreguntas",{params:e})},maxOpciones:function(e){return w.$http.get("api/HyoFrmFormularioGrupo/maxOpciones",{params:e})},updateFhModificacion:function(e){return w.$http.get("api/HyoFrmFormularioGrupoDet/updateFhModificacion",{params:e})}},_=n(80340),C=n(64180),x=n(32282),L=n(30640),R=n(982),S=n(78786),U=n(99637),I=n(8261),N={components:{QCheckbox:k.vZ,QList:F.A,QItem:O.A,QItemSection:q.A,QItemLabel:y.A,QAvatar:Q.A,sieVacio:_.A,sieCreator:x.A,sieProgress:C.A,sieModal:L.A,QPage:k.Tu,QIcon:k.bP,QPopover:k.VM,QBtn:k.Il,QSearch:k.Ks,QItemSide:k.n1,QItemMain:k.mF},data:function(){return{vacio:!0,idFormulario:null,objFormulario:{},examenes:[],questions:[],title:null,type:null,bloqueado:!1,modal:!1,tempHistQuest:[],searchQuest:null,maxOpciones:1,cursonom:null,selectionQuestions:[]}},computed:{edit:function(){return parseInt(this.idFormulario)?parseInt(this.idFormulario):null},historyQuestions:function(){var e=this,t=this.tempHistQuest;return this.searchQuest&&(t=this.tempHistQuest.filter(function(t){return t.title.indexOf(e.searchQuest)>=0})),t}},methods:{init:function(){var e=this;return h()(b()().m(function t(){return b()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,A.obtFormulariosAsignados();case 1:e.examenes=t.v,e.vacio=!e.examenes.length;case 2:return t.a(2)}},t)}))()},getCamposByForm:function(e){var t=this;return h()(b()().m(function n(){var r,a,o,i,u,s;return b()().w(function(n){while(1)switch(n.n){case 0:if(!e.NRO_PREGUNTAS){n.n=5;break}if(!e.AGOTADO||e.BLOQUEADO){n.n=1;break}(0,R["default"])("La fecha límite para registrar sus preguntas expiró","warning"),n.n=4;break;case 1:if(r=e.ID_FORMULARIO,t.cursonom=e.CURSONOM.toUpperCase(),t.objFormulario={icon:e.ICONO,color:e.COLOR,label:e.TITULO,sublabel:e.CURSONOM,sublabeltwo:e.INSTRUDES+" - "+e.GRADODES},r===t.idFormulario){n.n=4;break}return t.idFormulario=r,t.bloqueado=!!e.BLOQUEADO,a={id:r},n.n=2,A.getCamposByForm(a);case 2:return o=n.v,i=o.questions,u=o.title,s=o.type,t.questions=i,t.title=u,t.type=s,n.n=3,A.maxOpciones({idFormulario:r});case 3:t.maxOpciones=n.v;case 4:n.n=6;break;case 5:(0,R["default"])("No tiene asignado una cantidad de preguntas","warning");case 6:return n.a(2)}},n)}))()},saveQuestions:function(){var e=this;return h()(b()().m(function t(){var n,r,a,o,i,u,s,l;return b()().w(function(t){while(1)switch(t.p=t.n){case 0:if(n={id:e.idFormulario||void 0,questions:e.questions||void 0,title:e.title||void 0,type:e.type||void 0},r=!1,(0,U["default"])(e.questions,function(t){t&&Array.isArray(t.props)&&t.props.length>0&&(0,U["default"])(t.props,function(t){t&&"options"===t.name&&(t.value.length===e.maxOpciones||r||(r=!0))})}),t.p=1,!(e.questions.length&&(0,S["default"])(e.questions,4,{key:"type"})>=0)){t.n=8;break}if(!r){t.n=2;break}(0,R["default"])("La cantidad de opciones por pregunta es "+e.maxOpciones,"warning"),t.n=7;break;case 2:return t.n=3,A.saveQuestions(n);case 3:if(a=t.v,!a.res||!a.res.message){t.n=4;break}(0,R["default"])(a.res.message,"warning"),t.n=7;break;case 4:return(0,R["default"])("Grabado correctamente","success"),t.n=5,A.updateFhModificacion({idFormulario:e.idFormulario});case 5:return t.n=6,A.obtFormulariosAsignados();case 6:e.examenes=t.v;case 7:t.n=9;break;case 8:(0,R["default"])("La primera pregunta debe ser de tipo subtitulo","warning");case 9:t.n=11;break;case 10:t.p=10,l=t.v,o={type:"El tipo de formulario",questions:"Las preguntas son requeridas"},l&&l.error&&"string"===typeof l.error.message&&(i="es un argumento obligatorio",u="Ocurrió un error",l.error.message.indexOf(i)>=0?(s=l.error.message.replace(i,"").trim(),(0,R["default"])("".concat(o[s]," ").concat(i),"warning")):l.error.message.indexOf(u)>=0?(0,R["default"])("".concat(u,", verifique la pregunta"),"warning"):(0,R["default"])(l.error.message,"warning"));case 11:return t.a(2)}},t,null,[[1,10]])}))()},historialPreguntas:function(e){var t=this;return h()(b()().m(function n(){var r,a;return b()().w(function(n){while(1)switch(n.p=n.n){case 0:if(t.tempHistQuest=[],!e.NRO_PREGUNTAS){n.n=6;break}if(!e.AGOTADO||e.BLOQUEADO){n.n=1;break}(0,R["default"])("La fecha límite para registrar sus preguntas expiró","warning"),n.n=5;break;case 1:return t.modal=!0,n.p=2,r={cursocod:e.CURSOCOD},n.n=3,A.historialPreguntas(r);case 3:a=n.v,t.tempHistQuest=(0,I["default"])(a,"title"),n.n=5;break;case 4:n.p=4,n.v,t.tempHistQuest=[];case 5:n.n=7;break;case 6:(0,R["default"])("No tiene asignado una cantidad de preguntas","warning");case 7:return n.a(2)}},n,null,[[2,4]])}))()},copyPreguntas:function(){var e=this;this.selectionQuestions.length?(0,U["default"])(this.selectionQuestions,function(t){var n=(0,S["default"])(e.questions,t.title,{key:"title"});n<0&&e.questions.push(t)}):(0,R["default"])("Seleccione al menos una pregunta","warning")}},created:function(){this.init()}},P=n(12807);const E=(0,P.A)(N,[["render",p]]);var D=E}}]);