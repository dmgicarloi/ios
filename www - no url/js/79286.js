"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[79286],{79286:function(e,a,t){t.r(a),t.d(a,{default:function(){return ve}});var o=t(61758);function n(e,a){var t=(0,o.g2)("q-page");return(0,o.uX)(),(0,o.Wv)(t,null,{default:(0,o.k6)(function(){return[((0,o.uX)(),(0,o.Wv)((0,o.$y)(e.tabSelect),{class:"q-ma-xs",onCambiar:e.cambiarEstado},null,40,["onCambiar"]))]}),_:1})}var l=t(6123),r=t(58790),i={class:"column"},s={class:"q-mt-sm q-card q-pa-sm"},c={class:"row col q-col-gutter-sm"},u={class:"q-ma-sm"},d={class:"row q-col-gutter-sm"},p={class:"q-ma-sm"},m={class:"row q-col-gutter-sm"},I={class:"q-ma-sm"},f={class:"row q-col-gutter-sm"},b={class:"q-ma-sm"},O={class:"q-ma-sm"},S={class:"q-mx-sm"},C={class:"row col"},E={class:"col q-ma-sm q-card"},v={class:"row"},T={class:"col q-mx-sm"},D={key:0,class:"row"},g={key:1,class:"column"},A={class:"row"},h={class:"col q-mx-sm"},_={key:0,class:"row"};function N(e,a){var t=this,n=(0,o.g2)("header-btn"),l=(0,o.g2)("q-select"),N=(0,o.g2)("q-input"),w=(0,o.g2)("sie-table"),V=(0,o.g2)("sie-modal"),k=(0,o.g2)("q-item-section"),F=(0,o.g2)("q-item"),R=(0,o.g2)("q-list"),y=(0,o.g2)("q-toggle"),P=(0,o.g2)("q-btn");return(0,o.uX)(),(0,o.CE)("div",i,[(0,o.bF)(n,{name:"Listado de soporte",buttons:e.buttons},null,8,["buttons"]),(0,o.Lk)("div",s,[(0,o.Lk)("div",c,[(0,o.bF)(l,{class:"col",modelValue:e.estado,"onUpdate:modelValue":a[0]||(a[0]=function(a){return e.estado=a}),options:e.estados,label:"Estados","option-value":"ID","option-label":"DESCRIPCION",onInput:e.cargaInicial},null,8,["modelValue","options","onInput"]),(0,o.bF)(l,{class:"col",modelValue:e.catalogo,"onUpdate:modelValue":a[1]||(a[1]=function(a){return e.catalogo=a}),options:e.catalogos,label:"Catalogo","option-value":"ID_CATALOGO",onInput:e.cargaInicial,"option-label":"DESCRIPCION"},null,8,["modelValue","options","onInput"]),(0,o.bF)(N,{class:"col",modelValue:e.F_INICIO,"onUpdate:modelValue":a[2]||(a[2]=function(a){return e.F_INICIO=a}),type:"date",onInput:e.cargaInicial,label:"Desde"},null,8,["modelValue","onInput"]),(0,o.bF)(N,{class:"col",modelValue:e.F_FIN,"onUpdate:modelValue":a[3]||(a[3]=function(a){return e.F_FIN=a}),type:"date",onInput:e.cargaInicial,label:"Hasta"},null,8,["modelValue","onInput"])]),(0,o.bF)(w,{class:"q-mt-xs",dense:"",flat:"",bordered:"","wrap-cells":"",css:"height: calc(100vh - 200px)","show-search":!0,context:this,columns:e.columns,data:e.soportes,config:e.config},null,8,["columns","data","config"])]),e.modalEditar?((0,o.uX)(),(0,o.Wv)(V,{key:0,modelValue:e.modalEditar,"onUpdate:modelValue":a[11]||(a[11]=function(a){return e.modalEditar=a}),title:"Editar detalle "+(null!==e.dataEditar.head.DESCACTIVO?"de "+e.dataEditar.head.DESCACTIVO:""),onSubmit:e.grabarEstado},{default:(0,o.k6)(function(){return[(0,o.Lk)("div",u,[(0,o.Lk)("div",d,[0===e.dataEditar.body.OMITE_ACTIVOS?((0,o.uX)(),(0,o.Wv)(N,{key:0,class:"col",modelValue:e.dataEditar.head.DESCACTIVO,"onUpdate:modelValue":a[4]||(a[4]=function(a){return e.dataEditar.head.DESCACTIVO=a}),label:"Activo",disable:""},null,8,["modelValue"])):(0,o.Q3)("v-if",!0),(0,o.bF)(l,{class:"col",modelValue:e.dataEditar.body.ESTADO_ID,"onUpdate:modelValue":a[5]||(a[5]=function(a){return e.dataEditar.body.ESTADO_ID=a}),options:e.estadosEdit,"option-label":"DESCRIPCION","option-value":"ID","option-disable":"HABILITADO",label:"Estado","bg-color":e.estadosObj[e.dataEditar.body.ESTADO_ID].BGCOLOR},null,8,["modelValue","options","bg-color"])])]),(0,o.Lk)("div",p,[(0,o.Lk)("div",m,[(0,o.bF)(N,{class:"col",modelValue:e.dataEditar.head.USUCOD_REGISTRO,"onUpdate:modelValue":a[6]||(a[6]=function(a){return e.dataEditar.head.USUCOD_REGISTRO=a}),label:"Registrado por",disable:""},null,8,["modelValue"]),0===e.dataEditar.body.OMITE_ACTIVOS?((0,o.uX)(),(0,o.Wv)(l,{key:0,class:"col",modelValue:e.dataEditar.body.ID_CONDICION,"onUpdate:modelValue":a[7]||(a[7]=function(a){return e.dataEditar.body.ID_CONDICION=a}),options:e.condiciones,"option-label":"DESCRIPCION","option-value":"ID_CONDICION",label:"Condición","bg-color":e.condicionesObj[e.dataEditar.body.ID_CONDICION].COLOR},null,8,["modelValue","options","bg-color"])):(0,o.Q3)("v-if",!0)])]),(0,o.Lk)("div",I,[(0,o.Lk)("div",f,[(0,o.bF)(N,{class:"col",modelValue:e.dataEditar.head.NOMPERSONA,"onUpdate:modelValue":a[8]||(a[8]=function(a){return e.dataEditar.head.NOMPERSONA=a}),label:"Atendido por",disable:""},null,8,["modelValue"])])]),(0,o.Lk)("div",b,[(0,o.bF)(N,{modelValue:e.dataEditar.body.MENSAJE,"onUpdate:modelValue":a[9]||(a[9]=function(a){return e.dataEditar.body.MENSAJE=a}),type:"textarea",label:"Mensaje de Solicitud",disable:""},null,8,["modelValue"])]),(0,o.Lk)("div",O,[(0,o.bF)(N,{modelValue:e.dataEditar.body.COMENTARIO,"onUpdate:modelValue":a[10]||(a[10]=function(a){return e.dataEditar.body.COMENTARIO=a}),type:"textarea",label:"Comentario"},null,8,["modelValue"])])]}),_:1},8,["modelValue","title","onSubmit"])):(0,o.Q3)("v-if",!0),(0,o.bF)(V,{modelValue:e.modalMantenimiento,"onUpdate:modelValue":a[17]||(a[17]=function(a){return e.modalMantenimiento=a}),title:"Mantenimiento de tipos",ok:!1},{default:(0,o.k6)(function(){return[(0,o.Lk)("div",S,[e.isLess?((0,o.uX)(),(0,o.Wv)(l,{key:0,class:"q-ma-sm",modelValue:e.tabSelect,"onUpdate:modelValue":a[12]||(a[12]=function(a){return e.tabSelect=a}),options:e.tabs,"option-value":"id",label:"Tipo"},null,8,["modelValue","options"])):(0,o.Q3)("v-if",!0),(0,o.Lk)("div",C,[e.isLess?(0,o.Q3)("v-if",!0):((0,o.uX)(),(0,o.Wv)(R,{key:0,class:"q-card q-my-sm q-mr-xs rounded-borders",dense:"",bordered:"",padding:""},{default:(0,o.k6)(function(){return[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.tabs,function(a){return(0,o.uX)(),(0,o.Wv)(F,{clickable:"",class:(0,r.C4)({"custom-selected":a.id===e.tabSelect}),onClick:function(t){return e.tabSelect=a.id}},{default:(0,o.k6)(function(){return[(0,o.bF)(k,null,{default:(0,o.k6)(function(){return[(0,o.Lk)("label",null,(0,r.v_)(a.label),1)]}),_:2},1024)]}),_:2},1032,["class","onClick"])}),256))]}),_:1})),(0,o.Lk)("div",E,["tipos"===e.tabSelect?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[(0,o.Lk)("div",v,[(0,o.Lk)("div",T,[e.newTipo?((0,o.uX)(),(0,o.CE)("div",D,[(0,o.bF)(N,{class:"col",modelValue:e.addData.DESCRIPCION,"onUpdate:modelValue":a[13]||(a[13]=function(a){return e.addData.DESCRIPCION=a}),label:"Descripción"},null,8,["modelValue"]),(0,o.bF)(y,{modelValue:e.addData.OMITE_ACTIVOS,"onUpdate:modelValue":a[14]||(a[14]=function(a){return e.addData.OMITE_ACTIVOS=a}),"false-value":0,"true-value":1,label:"Omite Activos"},null,8,["modelValue"])])):(0,o.Q3)("v-if",!0)]),(0,o.bF)(P,{onClick:e.editTipo,color:"primary",flat:"",dense:"",round:"",icon:e.newTipo?"save":"add"},null,8,["onClick","icon"])]),(0,o.bF)(w,{class:"q-mt-xs",dense:"",flat:"",bordered:"","wrap-cells":"",css:"height: calc(80vh - 200px)","show-search":!0,context:t,columns:e.columnsTipos,data:e.tiposData,config:e.configTipos},null,8,["columns","data","config"])],64)):(0,o.Q3)("v-if",!0),"subtipos"===e.tabSelect?((0,o.uX)(),(0,o.CE)("div",g,[(0,o.bF)(l,{class:"q-ma-sm",modelValue:e.tipoSelect,"onUpdate:modelValue":a[15]||(a[15]=function(a){return e.tipoSelect=a}),options:e.tiposData,"option-value":"ID_SOPORTE_TIPO","option-label":"DESCRIPCION",label:"Tipo"},null,8,["modelValue","options"]),(0,o.Lk)("div",A,[(0,o.Lk)("div",h,[e.newSubtipo?((0,o.uX)(),(0,o.CE)("div",_,[(0,o.bF)(N,{class:"col",modelValue:e.addSubtiposData.DESCRIPCION,"onUpdate:modelValue":a[16]||(a[16]=function(a){return e.addSubtiposData.DESCRIPCION=a}),label:"Descripción"},null,8,["modelValue"])])):(0,o.Q3)("v-if",!0)]),(0,o.bF)(P,{onClick:e.editSubtipo,color:"primary",flat:"",dense:"",round:"",icon:e.newSubtipo?"save":"add"},null,8,["onClick","icon"])]),(0,o.bF)(w,{class:"q-mt-xs",dense:"",flat:"",bordered:"","wrap-cells":"",css:"height: calc(80vh - 160px)","show-search":!0,context:t,columns:e.columnsSubtipos,data:e.subTiposData[e.tipoSelect],config:e.configSubtipos},null,8,["columns","data","config"])])):(0,o.Q3)("v-if",!0)])])])]}),_:1},8,["modelValue"])])}var w=t(8445),V=t.n(w),k=t(57008),F=t.n(k),R=t(76080),y=t.n(R),P=t(45254),L=t.n(P),$=(t(10239),t(50310),t(90095),t(83190),t(44264),t(2369),t(13715),t(96122)),q=t(57668),M=t(18105),U=t(9736),G=t(55973),Q=t(16648),x=t(65673),X=t(82327),H=t(88865),j=t(33777),Y=t(30640),B=t(81288),W=(new Date).getFullYear(),K=(new Date).getMonth(),J={emits:["cambiar"],components:{QInput:U.A,QSelect:Q.A,QToggle:G.A,SieTable:j.A,sieModal:Y.A,QTimeline:l.T,QTimelineEntry:l.HV,QScrollArea:$.A,QList:x.A,QItem:X.A,QItemSection:H.A,QBtn:l.Il},data:function(){return{estado:"T",catalogo:"T",condicionesObj:{},condiciones:[],estadosObj:{},tipos:[],F_INICIO:(0,M.Ay)(new Date(W,K,1),"YYYY-MM-DD"),F_FIN:(0,M.Ay)(new Date(W,K+1,0),"YYYY-MM-DD"),showTodos:3===(0,q["default"])().ruta.nivel,tabs:[{id:"tipos",label:"Tipos"},{id:"subtipos",label:"Subtipos"}],tiposData:[],subTiposData:[],tipoSelect:null,tabSelect:null,catalogos:[],estados:[],verTodos:!1,soportes:[],modalDetalle:!1,modalEditar:!1,modalMantenimiento:!1,dataDetalle:{},estadosEdit:[],addData:{DESCRIPCION:null,OMITE_ACTIVOS:0},addSubtiposData:{DESCRIPCION:null},newTipo:!1,newSubtipo:!1,columnsTipos:[{name:"DESCRIPCION",label:"Tipo",align:"center",field:"DESCRIPCION"},{name:"OMITE_ACTIVOS",label:"O. Activos",align:"center",field:"OMITE_ACTIVOS"},{name:"ACCIONES",field:"ACCIONES",align:"center"}],columnsSubtipos:[{name:"DESCRIPCION",label:"Tipo",align:"center",field:"DESCRIPCION"},{name:"ACCIONES",field:"ACCIONES",align:"center"}],columns:[{name:"ID_SOPORTE",label:"Id",align:"center",field:"ID_SOPORTE"},{name:"DESCACTIVO",label:"Activo",align:"left",field:"DESCACTIVO"},{name:"ID_ACTIVO_TXT",label:"Id Activo",align:"center",field:"ID_ACTIVO_TXT"},{name:"CATALOGO",label:"Catalogo",align:"left",field:"CATALOGO"},{name:"AF_SOLICITUD_ID",label:"Id. Solicitud",align:"center",field:"AF_SOLICITUD_ID"},{name:"TIPOSOPORTE",label:"Tipo",align:"center",field:"TIPOSOPORTE"},{name:"SUBTIPOSOPORTE",label:"Subtipo",align:"center",field:"SUBTIPOSOPORTE"},{name:"FH_INGRESO",label:"F. Ingreso",align:"center",field:"FH_INGRESO"},{name:"FH_SALIDA",label:"F. Salida",align:"center",field:"FH_SALIDA"},{name:"DESCRIPCION",label:"Estado",align:"center",field:"DESCRIPCION"},{name:"ACCIONES",align:"center",field:"ACCIONES"}],config:{flat:!0,round:!0,color:"primary",AF_SOLICITUD_ID:{renderHtml:function(e){var a=e.AF_SOLICITUD_ID.toString().padStart(8,"0")||null;return"<span>".concat(a,"</span>")}},ESTADODES:{renderHtml:function(e,a,t,o){return t.background({text:e.ESTADODES,textColor:e.COLOR,color:e.FONDO})}},DESCRIPCION:{renderHtml:function(e,a,t,o){return t.background({text:e.DESCRIPCION,textColor:e.TEXTCOLOR,color:e.BGCOLOR})}},FH_INGRESO:{edit:!1,component:"datetime"},FH_SALIDA:{edit:!1,component:"datetime"},ACCIONES:{edit:!1,component:"button",icon:["edit as editar","delete as borrar"],permisos:{editar:"===3",borrar:"===3"},flat:!0,round:!0,vermas:function(e){this.verDetalle(e)},editar:function(e){this.editarSoporte(e)},tooltip:{vermas:function(e){return"Ver Detalles"},editar:function(e){return"Modificar Estado"},borrar:function(e){return"Eliminar"}},validate:{borrar:function(e){return 1===e.ESTADO_ID},editar:function(e){return[4,5,6].indexOf(e.ESTADO_ID)<0}}}},configTipos:{ACCIONES:{flat:!0,dense:!0,component:"button",icon:["delete as borrar"],borrar:function(e,a){var t=this;return L()(y()().m(function a(){var o,n,l;return y()().w(function(a){while(1)switch(a.p=a.n){case 0:return a.n=1,t.$confirmar("¿Está seguro de eliminar este stipo?");case 1:if(o=a.v,!o){a.n=5;break}return a.p=2,n=e,a.n=3,t.$http.delete("api/AfSoporteTipoController/deleteAfSoporteTipo",{params:{params:n}});case 3:t.$notify("Eliminado correctamente"),t.cargarTiposSubtipos(),a.n=5;break;case 4:a.p=4,l=a.v,console.log(l),t.$notify(l.message,"error");case 5:return a.a(2)}},a,null,[[2,4]])}))()}},DESCRIPCION:{component:"input",input:function(e,a){var t=this;return L()(y()().m(function a(){var o,n,l,r;return y()().w(function(a){while(1)switch(a.p=a.n){case 0:return a.p=0,o=e.DESCRIPCION,n=e.ID_SOPORTE_TIPO,l={DESCRIPCION:o,ID_SOPORTE_TIPO:n},a.n=1,t.$http.post("api/AfSoporteTipoController/updateAfSoporteTipo",{params:l});case 1:t.$notify("Guardado correctamente"),t.cargarTiposSubtipos(),a.n=3;break;case 2:a.p=2,r=a.v,t.$notify(r.message,"error");case 3:return a.a(2)}},a,null,[[0,2]])}))()}},OMITE_ACTIVOS:{component:"select",options:[{label:"Si",value:1},{label:"No",value:0}],input:function(e,a){var t=this;return L()(y()().m(function a(){var o,n,l,r;return y()().w(function(a){while(1)switch(a.p=a.n){case 0:return a.p=0,o=e.OMITE_ACTIVOS,n=e.ID_SOPORTE_TIPO,l={OMITE_ACTIVOS:o,ID_SOPORTE_TIPO:n},a.n=1,t.$http.post("api/AfSoporteTipoController/updateAfSoporteTipo",{params:l});case 1:t.$notify("Guardado correctamente"),t.cargarTiposSubtipos(),a.n=3;break;case 2:a.p=2,r=a.v,t.$notify(r.message,"error");case 3:return a.a(2)}},a,null,[[0,2]])}))()}}},configSubtipos:{ACCIONES:{flat:!0,dense:!0,component:"button",icon:["delete as borrar"],borrar:function(e,a){var t=this;return L()(y()().m(function a(){var o,n,l;return y()().w(function(a){while(1)switch(a.p=a.n){case 0:return a.n=1,t.$confirmar("¿Está seguro de eliminar este subtipo?");case 1:if(o=a.v,!o){a.n=5;break}return a.p=2,n=e,a.n=3,t.$http.delete("api/AfSoporteTipoController/deleteAfSoporteSubtipo",{params:{params:n}});case 3:t.$notify("Eliminado correctamente"),t.cargarTiposSubtipos(),a.n=5;break;case 4:a.p=4,l=a.v,t.$notify(l.message,"error");case 5:return a.a(2)}},a,null,[[2,4]])}))()}},DESCRIPCION:{component:"input",input:function(e,a){var t=this;return L()(y()().m(function a(){var o,n,l;return y()().w(function(a){while(1)switch(a.p=a.n){case 0:return a.p=0,o=e.DESCRIPCION,n=e.ID_SOPORTE_SUBTIPO,l={DESCRIPCION:o,ID_SOPORTE_SUBTIPO:n},a.n=1,t.$http.post("api/AfSoporteTipoController/updateAfSoporteSubtipo",{params:l});case 1:t.$notify("Guardado correctamente"),t.cargarTiposSubtipos(),a.n=3;break;case 2:a.p=2,a.v,t.$notify("No se pudo guardar, reintente nuevamente","error");case 3:return a.a(2)}},a,null,[[0,2]])}))()}}},configDetalle:{},dataEditar:{head:{},body:{}}}},methods:{verDetalle:function(e){var a=this;return L()(y()().m(function t(){var o;return y()().w(function(t){while(1)switch(t.n){case 0:return o=e.ID_SOPORTE,a.dataDetalle.head=e,t.n=1,a.$http.get("api/AfSoporteController/getDetalleSoporte",{params:{id_soporte:o}});case 1:a.dataDetalle.body=t.v,a.modalDetalle=!0;case 2:return t.a(2)}},t)}))()},editarSoporte:function(e){var a=this;this.modalEditar=!0,this.dataEditar.head=F()({},e),this.dataEditar.body=F()({},e),this.estadosEdit.forEach(function(t){0===a.dataEditar.body.OMITE_ACTIVOS?t.HABILITADO=!(0===t.SOLO_SEGURO||1===t.SOLO_SEGURO&&1===e.IS_SEGURO)||!(0===t.IS_GARANTIA||1===t.IS_GARANTIA&&1===e.IS_GARANTIA):t.HABILITADO=[1,2,4,6].indexOf(t.ID)<0})},nuevaSolicitud:function(){this.$emit("cambiar","registro")},cargaInicial:function(){var e=this;return L()(y()().m(function a(){var t;return y()().w(function(a){while(1)switch(a.n){case 0:return t={F_INICIO:e.F_INICIO,F_FIN:e.F_FIN,CATALOGO:e.catalogo,ESTADO:e.estado},a.n=1,e.$http.get("api/AfSoporteController/getAfSoporte",{params:{params:t}});case 1:e.soportes=a.v;case 2:return a.a(2)}},a)}))()},habilitado:function(e){return console.log({row:e}),!1},grabarEstado:function(){var e=this;return L()(y()().m(function a(){var t,o;return y()().w(function(a){while(1)switch(a.p=a.n){case 0:if(t={ID_SOPORTE:e.dataEditar.head.ID_SOPORTE,ID_ACTIVO:e.dataEditar.head.ID_ACTIVO,COMENTARIO:e.dataEditar.body.COMENTARIO,LOG:e.estadosObj[e.dataEditar.body.ESTADO_ID].DESCRIPCION+(e.dataEditar.body.COMENTARIO?" - "+e.dataEditar.body.COMENTARIO:"")},t.ESTADO_ID=e.dataEditar.body.ESTADO_ID,(e.dataEditar.head.ID_CONDICION!==e.dataEditar.body.ID_CONDICION||e.dataEditar.body.ESTADO_ID>2)&&(t.ID_CONDICION=e.dataEditar.body.ID_CONDICION),!(t.ESTADO_ID||t.ID_CONDICION||t.COMENTARIO)){a.n=5;break}return a.n=1,e.$confirmar("¿Está seguro de guardar esta información?, este proceso sera Irreversible");case 1:if(o=a.v,!o){a.n=5;break}return a.p=2,a.n=3,e.$http.post("api/AfSoporteController/saveEstado",{params:t});case 3:e.modalEditar=!1,e.cargaInicial(),a.n=5;break;case 4:a.p=4,a.v;case 5:return a.a(2)}},a,null,[[2,4]])}))()},configurarTipos:function(){var e=this;return L()(y()().m(function a(){return y()().w(function(a){while(1)switch(a.n){case 0:e.modalMantenimiento=!0,e.tabSelect="tipos",e.cargarTiposSubtipos(),e.tipoSelect=null,e.newSubtipo=!1,e.newTipo=!1;case 1:return a.a(2)}},a)}))()},cargarTiposSubtipos:function(){var e=this;return L()(y()().m(function a(){var t,o,n;return y()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,e.$http.get("api/AfSoporteTipoController/getAfSoporteTipo");case 1:t=a.v,o=t.tipos,n=t.subTipos,e.tiposData=o,e.subTiposData=n;case 2:return a.a(2)}},a)}))()},editTipo:function(){var e=this;return L()(y()().m(function a(){var t;return y()().w(function(a){while(1)switch(a.n){case 0:if(e.newTipo){a.n=1;break}e.newTipo=!0,e.addData={DESCRIPCION:null,OMITE_ACTIVOS:0},a.n=3;break;case 1:if(!e.addData.DESCRIPCION){a.n=3;break}return a.n=2,e.$confirmar("¿Esta seguro de agregar este tipo?");case 2:if(t=a.v,t)try{e.$http.post("api/AfSoporteTipoController/addAfSoporteTipo",{data:e.addData}),e.$notify("Guardado correctamente"),e.cargarTiposSubtipos(),e.newTipo=!1}catch(a){e.$notify("No se puedo guardar la información","error")}case 3:return a.a(2)}},a)}))()},editSubtipo:function(){var e=this;return L()(y()().m(function a(){var t,o;return y()().w(function(a){while(1)switch(a.n){case 0:if(!e.tipoSelect){a.n=3;break}if(e.newSubtipo){a.n=1;break}e.addSubtiposData.DESCRIPCION=null,e.newSubtipo=!0,a.n=3;break;case 1:if(!e.addSubtiposData.DESCRIPCION){a.n=3;break}return a.n=2,e.$confirmar("¿Esta seguro de agregar este subtipo?");case 2:if(t=a.v,t)try{o=F()(F()({},e.addSubtiposData),{ID_SOPORTE:e.tipoSelect}),e.$http.post("api/AfSoporteTipoController/addSoporteSubtipo",{data:o}),e.$notify("Guardado correctamente"),e.cargarTiposSubtipos(),e.newSubtipo=!1}catch(a){e.$notify("No se puedo guardar la información","error")}case 3:return a.a(2)}},a)}))()}},computed:{isLess:function(){return(0,B.isLess)()},buttons:function(){var e=[];return 3===(0,q["default"])().ruta.nivel&&e.push({label:"Configurar",icon:"cogs",click:this.configurarTipos}),e}},mounted:function(){var e=this;return L()(y()().m(function a(){var t,o,n,l;return y()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,e.$http.get("api/afSoporteController/getCargaInicial");case 1:t=a.v,o=t.catalogos,n=t.estados,l=t.condicion,o.unshift({ID_CATALOGO:"T",DESCRIPCION:"Todos"}),e.estados=V()(n),e.catalogos=o,e.estados.unshift({ID:"T",DESCRIPCION:"Todos"}),e.estadosEdit=V()(n),e.condiciones=l,l.forEach(function(a){e.condicionesObj[a.ID_CONDICION]=a}),n.forEach(function(a){a.onlyNoActivos=[1,2,4].indexOf(a.ID)>=0,e.estadosObj[a.ID]=a}),e.cargaInicial();case 2:return a.a(2)}},a)}))()}},Z=t(12807);const z=(0,Z.A)(J,[["render",N]]);var ee=z,ae={class:"col column justify-center items-center"},te={class:"q-ma-sm"},oe={class:"q-ma-sm"},ne={class:"column row-md q-gutter-sm"},le={key:0,class:"q-ma-sm"},re={class:"column row-md q-gutter-sm"},ie={key:1,class:"q-ma-sm"},se={class:"q-ma-sm"},ce={class:"q-ma-sm row"},ue={class:"q-ma-sm"},de={class:"q-ma-sm"},pe={class:"row q-gutter-sm"};function me(e,a){var t=(0,o.g2)("q-toolbar"),n=(0,o.g2)("q-input"),l=(0,o.g2)("q-select"),i=(0,o.g2)("q-field"),s=(0,o.g2)("sie-table"),c=(0,o.g2)("q-btn");return(0,o.uX)(),(0,o.CE)("div",ae,[(0,o.Lk)("div",{class:"q-card",style:(0,r.Tr)({width:e.ancho,height:e.alto})},[(0,o.bF)(t,{class:"row justify-center"},{default:(0,o.k6)(function(){return V()(a[7]||(a[7]=[(0,o.Lk)("span",{class:"text-bold"},"Formulario de solicitud",-1)]))}),_:1}),(0,o.Lk)("div",te,[(0,o.Lk)("div",oe,[(0,o.Lk)("div",ne,[(0,o.bF)(n,{class:"col",modelValue:e.nombre,"onUpdate:modelValue":a[0]||(a[0]=function(a){return e.nombre=a}),disable:"",label:"Nombre"},null,8,["modelValue"]),(0,o.bF)(l,{class:"col",modelValue:e.tipoSolicitud,"onUpdate:modelValue":a[1]||(a[1]=function(a){return e.tipoSolicitud=a}),options:e.tipos,label:"Solicitud","option-value":"ID","option-label":"DESCRIPCION"},null,8,["modelValue","options"])])]),1===e.tipoSolicitud?((0,o.uX)(),(0,o.CE)("div",le,[(0,o.Lk)("div",re,[(0,o.bF)(n,{class:"col",modelValue:e.fecIni,"onUpdate:modelValue":a[2]||(a[2]=function(a){return e.fecIni=a}),type:"date",label:"Fecha de Inicio","input-style":"text-align: center;"},null,8,["modelValue"]),(0,o.bF)(n,{class:"col",modelValue:e.fecFin,"onUpdate:modelValue":a[3]||(a[3]=function(a){return e.fecFin=a}),type:"date",label:"Fecha de Fin","input-style":"text-align: center;"},null,8,["modelValue"])])])):(0,o.Q3)("v-if",!0),1===e.tipoSolicitud?((0,o.uX)(),(0,o.CE)("div",ie,[(0,o.bF)(i,{class:"row q-gutter-sm col",error:e.v$.catalogosSelect.$error,"error-label":e.$t("validaciones.requerido")},{default:(0,o.k6)(function(){return[(0,o.bF)(l,{class:"col",modelValue:e.v$.catalogosSelect.$model,"onUpdate:modelValue":a[4]||(a[4]=function(a){return e.v$.catalogosSelect.$model=a}),label:"Catalogo",options:e.catalogos,"option-value":"ID_CATALOGO","option-label":"DESCRIPCION","use-chips":"",multiple:"",color:"secondary",placeholder:"Seleccione uno o mas catalogos"},null,8,["modelValue","options"])]}),_:1},8,["error","error-label"])])):(0,o.Q3)("v-if",!0),(0,o.Lk)("div",se,[(0,o.bF)(i,{class:"row q-gutter-sm col",error:e.v$.mensaje.$error,"error-label":e.$t("validaciones.requerido")},{default:(0,o.k6)(function(){return[(0,o.bF)(n,{class:"col",modelValue:e.v$.mensaje.$model,"onUpdate:modelValue":a[5]||(a[5]=function(a){return e.v$.mensaje.$model=a}),type:"textarea",label:"Mensaje",placeholder:"Ingrese una descripción de la solicitud"},null,8,["modelValue"])]}),_:1},8,["error","error-label"])]),2===e.tipoSolicitud?((0,o.uX)(),(0,o.CE)(o.FK,{key:2},[(0,o.Lk)("div",ce,[(0,o.bF)(n,{class:"col",modelValue:e.transferencia,"onUpdate:modelValue":a[6]||(a[6]=function(a){return e.transferencia=a}),label:"Transferencia",onKeydown:e.buscarTransferencia},null,8,["modelValue","onKeydown"])]),(0,o.Lk)("div",ue,[(0,o.bF)(s,{dense:"",flat:"",bordered:"","wrap-cells":"",css:"height: calc(30vh)","show-search":!1,columns:e.columns,data:e.activos,selection:"multiple",config:e.config,ref:"tablaActicos","check-all-position":"right","load-selection":e.load},null,8,["columns","data","config","load-selection"])])],64)):(0,o.Q3)("v-if",!0)]),(0,o.bF)(t,{class:"row justify-end",inverted:""},{default:(0,o.k6)(function(){return[(0,o.Lk)("div",de,[(0,o.Lk)("div",pe,[(0,o.bF)(c,{color:"primary",onClick:e.volver},{default:(0,o.k6)(function(){return V()(a[8]||(a[8]=[(0,o.eW)("Cancelar",-1)]))}),_:1},8,["onClick"]),(0,o.bF)(c,{color:"primary",onClick:e.grabar},{default:(0,o.k6)(function(){return V()(a[9]||(a[9]=[(0,o.eW)("Grabar",-1)]))}),_:1},8,["onClick"])])])]}),_:1})],4)])}t(23825),t(52133),t(6724),t(24066);var Ie=t(83972),fe=t(82640),be={setup:function(){var e=(0,Ie.fG)();return{v$:e}},emits:["cambiar"],components:{QInput:U.A,QSelect:Q.A,sieTable:j.A,QToolbar:l.ZV,QField:l.Om,QBtn:l.Il},data:function(){return{sie:(0,q["default"])(),tipoSolicitud:1,tipos:[],nombre:(0,q["default"])().nombre,fecIni:(0,M.Ay)(new Date,"YYYY-MM-DD"),fecFin:(0,M.Ay)(new Date((new Date).getFullYear(),11,31),"YYYY-MM-DD"),mensaje:null,catalogos:[],catalogosSelect:[],activos:[],transferencia:null,load:{key:"ID_ACTIVO",values:[]},columns:[{name:"DESCRIPCION",label:"Activo",align:"left",field:"DESCRIPCION"},{name:"ID_ACTIVO_TXT",label:"Id",align:"left",field:"ID_ACTIVO_TXT"},{name:"FH_TRANSFERENCIA_I",label:"F. Inicio",align:"center",field:"FH_TRANSFERENCIA_I"},{name:"FH_FIN",label:"F. Fin",align:"center",field:"FH_FIN"}],config:{flat:!0,round:!0,color:"primary",FH_TRANSFERENCIA_I:{component:"date"},FH_FIN:{component:"date"}}}},methods:{volver:function(){this.$emit("cambiar","listado")},buscarTransferencia:function(e){var a=this;return L()(y()().m(function t(){return y()().w(function(t){while(1)switch(t.n){case 0:if(13!==e.which){t.n=2;break}return a.load.values=[],t.n=1,a.$http.get("api/AfTransferenciaController/getDetalle",{params:{id:a.transferencia}});case 1:a.activos=t.v,a.activos.length>0&&(a.load.values=a.activos.map(function(e){var a=e.ID_ACTIVO;return a}));case 2:return t.a(2)}},t)}))()},grabar:function(){var e=this;return L()(y()().m(function a(){var t,o,n,l,r;return y()().w(function(a){while(1)switch(a.p=a.n){case 0:if(a.p=0,e.v$.$touch(),e.v$.$invalid){a.n=6;break}t=e.catalogos.map(function(e){return e.ID_CATALOGO}),o={ID_SOLICITUD_TIPO:e.tipoSolicitud,MENSAJE:e.mensaje},r=e.tipoSolicitud,a.n=1===r?1:2===r?2:3;break;case 1:return o.CATALOGOS=t,o.F_INICIO=e.fecIni,o.F_FIN=e.fecFin,a.a(3,3);case 2:return o.ACTIVOS=e.$refs.tablaActicos.rowsSelected().map(function(e){var a=e.ID_ACTIVO;return a}),a.a(3,3);case 3:return a.n=4,e.$confirmar("¿Está seguro de registrar esta solicitud?");case 4:if(n=a.v,!n){a.n=6;break}return a.n=5,e.$http.post("api/AfSolicitudController/addAfSolicitud",{data:o});case 5:l=a.v,e.$notify(l.data.message),e.volver();case 6:a.n=8;break;case 7:a.p=7,a.v;case 8:return a.a(2)}},a,null,[[0,7]])}))()}},computed:{buttons:function(){var e=[];return e.push({label:"Volver",icon:"arrow_left",click:this.volver}),(0,q["default"])().ruta.nivel>=2&&e.push({label:"Grabar",icon:"save",click:this.grabar}),e},isGreater:function(){return(0,B.isGreater)()},ancho:function(){return(0,B.isGreater)()?"50vw":"100vw"},alto:function(){return(0,B.isGreater)()?"":"100vh"}},mounted:function(){var e=this;return L()(y()().m(function a(){return y()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,e.$http.get("api/afSolicitudController/getSolicitudTipo");case 1:return e.tipos=a.v,a.n=2,e.$http.get("api/AfCatalogoController/getAfCatalogo",{params:{parametros:{soloActivos:!0}}});case 2:e.catalogos=a.v;case 3:return a.a(2)}},a)}))()},validations:function(){var e=this,a=function(){return 2===e.tipoSolicitud||e.catalogosSelect.length>0},t={catalogosSelect:{valCatalogos:a},mensaje:{required:fe.mw}};return t}};const Oe=(0,Z.A)(be,[["render",me]]);var Se=Oe,Ce={components:{registro:Se,listado:ee,QPage:l.Tu},data:function(){return{tabSelect:"listado"}},methods:{cambiarEstado:function(e){this.tabSelect=e}}};const Ee=(0,Z.A)(Ce,[["render",n]]);var ve=Ee}}]);