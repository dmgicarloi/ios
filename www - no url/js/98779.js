"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[98779],{98779:function(e,o,a){a.r(o),a.d(o,{default:function(){return Qe}});a(71225),a(50310),a(5962),a(11777),a(83190);var t=a(61758),n=a(58790),r={class:"row items-center no-wrap"},i={class:"col row"},l={class:"text-h6"},c={class:"row gutter-xs q-mb-sm"},u={class:"col-xs-12 col-md-6"},s={class:"col-xs-12 col-md-2"},d={class:"col-xs-6 col-md-2"},m={class:"col-xs-6 col-md-2"},f={class:"col-xs-12 col-md-6 col-lg-3"},p={key:0,class:"col-xs-12 col-md-6 col-lg-3"},N={class:"col-xs-12 col-md-6 col-lg-2"},C={key:1,class:"col-xs-12 col-md-6 col-lg-2"},g={class:"col-xs-12 col-md-6 col-lg-2"},h={class:"row gutter-xs q-mb-sm"},A={key:0,class:"col-xs-12 col-md-8 col-lg-8"},M={class:"row q-ma-xs q-col-gutter-sm"},O={class:"col-xs-12"},v={class:"text-h6"},E={class:"row q-ma-xs q-col-gutter-sm"},b={class:"col-12 custom-select"},T={class:"div-90"},w={class:"row q-ma-xs q-col-gutter-sm"},P={class:"col-6"},U={class:"col-6"},D={class:"row q-ma-xs q-col-gutter-sm"},I={class:"col-12"},V={class:"row q-ma-xs q-col-gutter-sm"},_={class:"col-6"},S={class:"col-6"},R={class:"row q-ma-xs q-col-gutter-sm"},k={class:"col-6"},L={class:"col-6"},F={class:"row q-ma-xs q-col-gutter-sm"},G={class:"col-6"},$={class:"col-6"},y={class:"text-h6"},B={class:"row q-ma-xs q-col-gutter-sm"},q={class:"col-xs-12"},x={class:"text-h3"},Y={class:"row q-ma-xs q-col-gutter-sm"},Q={class:"col-12"},z={class:"col-12"},H={class:"text-h6"},X={class:"row q-ma-xs q-col-gutter-sm"};function W(e,o){var a=(0,t.g2)("crearBotones"),W=(0,t.g2)("q-card-section"),j=(0,t.g2)("tesoreriaLoading"),J=(0,t.g2)("q-separator"),K=(0,t.g2)("q-select"),Z=(0,t.g2)("q-date"),ee=(0,t.g2)("q-popup-proxy"),oe=(0,t.g2)("q-icon"),ae=(0,t.g2)("q-input"),te=(0,t.g2)("q-checkbox"),ne=(0,t.g2)("sie-grid"),re=(0,t.g2)("footer-grid"),ie=(0,t.g2)("forma-pago"),le=(0,t.g2)("formasPagoComprobantes"),ce=(0,t.g2)("sie-modal"),ue=(0,t.g2)("q-btn"),se=(0,t.g2)("q-radio"),de=(0,t.g2)("q-card");return(0,t.uX)(),(0,t.Wv)(de,{class:"layout-v1 my-card",flat:"",bordered:""},{default:(0,t.k6)(function(){return[(0,t.bF)(W,null,{default:(0,t.k6)(function(){return[(0,t.Lk)("div",r,[(0,t.Lk)("div",i,[(0,t.Lk)("div",l,(0,n.v_)(e.tituloComponente),1)]),(0,t.bF)(a,{buttons:e.botones,nivelAcceso:e.nivelAcceso,option:e.nameComponente,dropdown:"",style:{padding:"16px 0px"}},null,8,["buttons","nivelAcceso","option"])])]}),_:1}),(0,t.bF)(j,{modelValue:e.loading.showLoading,total:e.loading.total,procesados:e.loading.procesados},null,8,["modelValue","total","procesados"]),(0,t.bF)(J),(0,t.bF)(W,null,{default:(0,t.k6)(function(){return[(0,t.Lk)("div",c,[(0,t.Lk)("div",u,[(0,t.bF)(K,{class:"truncate-label",label:"Talonario","option-value":"value","option-label":"label",options:e.talon,modelValue:e.selectTalon,"onUpdate:modelValue":o[0]||(o[0]=function(o){return e.selectTalon=o}),onInput:e.filter},null,8,["options","modelValue","onInput"])]),(0,t.Lk)("div",s,[(0,t.bF)(K,{class:"truncate-label",label:"Filtro por",options:e.filtrar,modelValue:e.selectFiltrar,"onUpdate:modelValue":o[1]||(o[1]=function(o){return e.selectFiltrar=o}),onInput:e.filter},null,8,["options","modelValue","onInput"])]),(0,t.Lk)("div",d,[(0,t.bF)(ae,{class:"truncate-label",label:"Desde",debounce:"500",maxlength:"10",format:"##/##/####",modelValue:e.from,"onUpdate:modelValue":o[4]||(o[4]=function(o){return e.from=o}),mask:"##/##/####",readonly:""},{append:(0,t.k6)(function(){return[(0,t.bF)(oe,{class:"cursor-pointer",name:"date_range"},{default:(0,t.k6)(function(){return[(0,t.bF)(ee,{ref:"qDateProxy1","transition-show":"scale","transition-hide":"scale"},{default:(0,t.k6)(function(){return[(0,t.bF)(Z,{mask:"DD/MM/YYYY",modelValue:e.from,"onUpdate:modelValue":o[2]||(o[2]=function(o){return e.from=o}),onInput:o[3]||(o[3]=function(o){return e.closeModalCalendar("qDateProxy1")})},null,8,["modelValue"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])]),(0,t.Lk)("div",m,[(0,t.bF)(ae,{label:"Hasta",debounce:"500",maxlength:"10",format:"##/##/####",modelValue:e.to,"onUpdate:modelValue":o[7]||(o[7]=function(o){return e.to=o}),mask:"##/##/####",readonly:""},{append:(0,t.k6)(function(){return[(0,t.bF)(oe,{class:"cursor-pointer",name:"date_range"},{default:(0,t.k6)(function(){return[(0,t.bF)(ee,{ref:"qDateProxy2","transition-show":"scale","transition-hide":"scale"},{default:(0,t.k6)(function(){return[(0,t.bF)(Z,{mask:"DD/MM/YYYY",modelValue:e.to,"onUpdate:modelValue":o[5]||(o[5]=function(o){return e.to=o}),onInput:o[6]||(o[6]=function(o){return e.closeModalCalendar("qDateProxy2")})},null,8,["modelValue"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])]),(0,t.Lk)("div",f,[(0,t.bF)(K,{modelValue:e.visbleTalonMasivo,"onUpdate:modelValue":o[8]||(o[8]=function(o){return e.visbleTalonMasivo=o}),options:e.optionsTalonario,label:"Cambiar Talonario:",onInput:e.cargarColumnas},null,8,["modelValue","options","onInput"])]),Boolean(Number(e.visbleTalonMasivo))?((0,t.uX)(),(0,t.CE)("div",p,[(0,t.bF)(K,{class:"truncate-label",label:"Nuevo Talonario","option-value":"value","option-label":"label",options:e.dataTalonMasivo,modelValue:e.talonMasivo,"onUpdate:modelValue":o[9]||(o[9]=function(o){return e.talonMasivo=o}),onInput:e.seleccionarTalonarioMasivo},null,8,["options","modelValue","onInput"])])):(0,t.Q3)("v-if",!0),(0,t.Lk)("div",N,[(0,t.bF)(te,{label:"Usar Nro. Secuencial",modelValue:e.correlativoSecuencial,"onUpdate:modelValue":o[10]||(o[10]=function(o){return e.correlativoSecuencial=o})},null,8,["modelValue"])]),e.correlativoSecuencial?((0,t.uX)(),(0,t.CE)("div",C,[(0,t.bF)(ae,{label:"Nro. Inicial",modelValue:e.initCorrelativo,"onUpdate:modelValue":o[11]||(o[11]=function(o){return e.initCorrelativo=o}),onInput:e.setearCorrelativo,onBlur:e.setearFormato},null,8,["modelValue","onInput","onBlur"])])):(0,t.Q3)("v-if",!0),(0,t.Lk)("div",g,[(0,t.bF)(te,{label:"Usar Filtro Masivo",modelValue:e.filtroMasivo,"onUpdate:modelValue":o[12]||(o[12]=function(o){return e.filtroMasivo=o})},null,8,["modelValue"])])]),(0,t.Lk)("div",h,[e.filtroMasivo?((0,t.uX)(),(0,t.CE)("div",A,[(0,t.bF)(ae,{onInput:e.filterConcatCodigo,label:"Códigos",modelValue:e.concatCodigo,"onUpdate:modelValue":o[13]||(o[13]=function(o){return e.concatCodigo=o}),placeholder:"Ingrese Códigos(;)"},null,8,["onInput","modelValue"])])):(0,t.Q3)("v-if",!0)]),(0,t.Lk)("div",null,[(0,t.bF)(ne,{class:"fix-table-global ag-theme-balham",columnDefs:e.columnDefs,rowData:e.rowData,onGridReady:e.onGridReady,frameworkComponents:e.frameworkComponents,onCellValueChanged:e.cellValueChanged,onCellClicked:e.onCellClicked,rowMultiSelectWithClick:!0,enableCellTextSelection:!0,ensureDomOrder:!0,floatingFilter:"",defaultColDef:e.defaultColDef,onFilterChanged:e.onFilterChanged,style:{width:"100%",height:"calc(100vh - 345px)"},rowSelection:"multiple"},null,8,["columnDefs","rowData","onGridReady","frameworkComponents","onCellValueChanged","onCellClicked","defaultColDef","onFilterChanged"]),(0,t.bF)(re,{modelValue:e.page,"onUpdate:modelValue":o[14]||(o[14]=function(o){return e.page=o}),max:e.max,onLoad:e.filter,rows:e.contador},null,8,["modelValue","max","onLoad","rows"])])]}),_:1}),e.openFormaPago?((0,t.uX)(),(0,t.Wv)(ie,{key:0,showButtons:!1,modelValue:e.openFormaPago,"onUpdate:modelValue":o[15]||(o[15]=function(o){return e.openFormaPago=o}),feccam:e.fechaPago,saldo:e.saldo,mondeuda:e.moneda,numtal:e.NUMTAL,numpag:e.NUMPAG},null,8,["modelValue","feccam","saldo","mondeuda","numtal","numpag"])):(0,t.Q3)("v-if",!0),(0,t.bF)(ce,{onSubmit:e.cerrarModal,modelValue:e.openModal,"onUpdate:modelValue":o[16]||(o[16]=function(o){return e.openModal=o}),labelButtonOk:"Aceptar",css:{width:"56vw","min-height":"30vh"},ok:!1},{default:(0,t.k6)(function(){return[(0,t.bF)(W,null,{default:(0,t.k6)(function(){return[(0,t.bF)(le,{modal:!0,numtal:e.NumTalFor,numpag:e.NumPagFor,datosPagos:e.datosPagos},null,8,["numtal","numpag","datosPagos"])]}),_:1})]}),_:1},8,["onSubmit","modelValue"]),(0,t.bF)(ce,{modelValue:e.openModalModificar,"onUpdate:modelValue":o[27]||(o[27]=function(o){return e.openModalModificar=o}),onSubmit:e.modificarMontoComprobante,labelButtonOk:"Modificar"},{default:(0,t.k6)(function(){return[(0,t.Lk)("div",M,[(0,t.Lk)("div",O,[(0,t.Lk)("div",v,"Comprobante: "+(0,n.v_)(e.numComp),1)])]),(0,t.Lk)("div",null,[(0,t.Lk)("div",E,[(0,t.Lk)("div",b,[(0,t.Lk)("div",T,[(0,t.bF)(K,{label:"Concepto seleccionado","option-value":"NUMITE","option-label":"NUM_CONCEPTO",options:e.item,modelValue:e.formModificar.NUMITE,"onUpdate:modelValue":o[17]||(o[17]=function(o){return e.formModificar.NUMITE=o}),onInput:e.conceptoSeleccionado},null,8,["options","modelValue","onInput"])]),e.btnConceptoEdit?((0,t.uX)(),(0,t.Wv)(ue,{key:0,onClick:e.toggleEditMode,label:""},{default:(0,t.k6)(function(){return[(0,t.bF)(oe,{name:"edit",size:"20px"})]}),_:1},8,["onClick"])):(0,t.Q3)("v-if",!0)])]),e.editModeContent?((0,t.uX)(),(0,t.CE)("div",{key:0,class:(0,n.C4)({"q-card-legend q-card q-mb-md":e.editModeContent})},[(0,t.Lk)("div",w,[(0,t.Lk)("div",P,[(0,t.bF)(K,{label:"Nuevo Año","option-value":"value","option-label":"label",options:e.anios,modelValue:e.formModificar.ANOCOB_NUEVO,"onUpdate:modelValue":o[18]||(o[18]=function(o){return e.formModificar.ANOCOB_NUEVO=o})},null,8,["options","modelValue"])]),(0,t.Lk)("div",U,[(0,t.bF)(K,{label:"Nuevo Mes","option-value":"value","option-label":"label",options:e.meses,modelValue:e.formModificar.MESCOB_NUEVO,"onUpdate:modelValue":o[19]||(o[19]=function(o){return e.formModificar.MESCOB_NUEVO=o})},null,8,["options","modelValue"])])]),(0,t.Lk)("div",D,[(0,t.Lk)("div",I,[(0,t.bF)(K,{label:"Nuevo Concepto a seleccionar","option-value":"value","option-label":"label",options:e.conceptos,modelValue:e.formModificar.CONCEPTO_NUEVO,"onUpdate:modelValue":o[20]||(o[20]=function(o){return e.formModificar.CONCEPTO_NUEVO=o})},null,8,["options","modelValue"])])])],2)):(0,t.Q3)("v-if",!0)]),(0,t.Lk)("div",V,[(0,t.Lk)("div",_,[(0,t.bF)(ae,{type:"number",label:"Monto a Cobrar Actual",modelValue:e.formModificar.MONTO_ANT,"onUpdate:modelValue":o[21]||(o[21]=function(o){return e.formModificar.MONTO_ANT=o}),readonly:""},null,8,["modelValue"])]),(0,t.Lk)("div",S,[(0,t.bF)(ae,{type:"number",label:"Nuevo Monto a Cobrar",modelValue:e.formModificar.MONTO_NUEVO,"onUpdate:modelValue":o[22]||(o[22]=function(o){return e.formModificar.MONTO_NUEVO=o})},null,8,["modelValue"])])]),(0,t.Lk)("div",R,[(0,t.Lk)("div",k,[(0,t.bF)(ae,{type:"number",label:"Descuento Actual",modelValue:e.formModificar.DESC_ANT,"onUpdate:modelValue":o[23]||(o[23]=function(o){return e.formModificar.DESC_ANT=o}),readonly:""},null,8,["modelValue"])]),(0,t.Lk)("div",L,[(0,t.bF)(ae,{type:"number",label:"Nuevo Descuento",modelValue:e.formModificar.NUEVO_DESC,"onUpdate:modelValue":o[24]||(o[24]=function(o){return e.formModificar.NUEVO_DESC=o})},null,8,["modelValue"])])]),(0,t.Lk)("div",F,[(0,t.Lk)("div",G,[(0,t.bF)(ae,{type:"number",label:"Mora Actual",modelValue:e.formModificar.MORA_ANT,"onUpdate:modelValue":o[25]||(o[25]=function(o){return e.formModificar.MORA_ANT=o}),readonly:""},null,8,["modelValue"])]),(0,t.Lk)("div",$,[(0,t.bF)(ae,{type:"number",label:"Nueva Mora",modelValue:e.formModificar.NUEVA_MORA,"onUpdate:modelValue":o[26]||(o[26]=function(o){return e.formModificar.NUEVA_MORA=o})},null,8,["modelValue"])])])]}),_:1},8,["modelValue","onSubmit"]),(0,t.bF)(ce,{modelValue:e.openCambiarMotivoNC,"onUpdate:modelValue":o[30]||(o[30]=function(o){return e.openCambiarMotivoNC=o}),onSubmit:e.modificarMotivoNC,labelButtonOk:"Modificar"},{default:(0,t.k6)(function(){return[(0,t.Lk)("div",y,"Cambiar Motivo Nota de Crédito: "+(0,n.v_)(e.numNC),1),(0,t.Lk)("div",B,[(0,t.Lk)("div",q,[(0,t.Lk)("div",x,"Cliente: "+(0,n.v_)(e.clienteNC),1)])]),(0,t.Lk)("div",Y,[(0,t.Lk)("div",Q,[(0,t.bF)(K,{modelValue:e.motivoNCActual,"onUpdate:modelValue":o[28]||(o[28]=function(o){return e.motivoNCActual=o}),"option-value":"CLAVE","option-label":"VALOR",options:e.selectMotivosActual,label:"Motivo Actual",readonly:"",disable:""},null,8,["modelValue","options"])]),(0,t.Lk)("div",z,[(0,t.bF)(K,{modelValue:e.motivoNC,"onUpdate:modelValue":o[29]||(o[29]=function(o){return e.motivoNC=o}),"option-value":"CLAVE","option-label":"VALOR",options:e.selectMotivos,label:"Motivo Nuevo"},null,8,["modelValue","options"])])])]}),_:1},8,["modelValue","onSubmit"]),(0,t.bF)(ce,{modelValue:e.openModalCorregirCliente,"onUpdate:modelValue":o[34]||(o[34]=function(o){return e.openModalCorregirCliente=o}),onSubmit:e.corregirCliente,labelButtonOk:"Modificar",iconButtonOk:"save"},{default:(0,t.k6)(function(){return[(0,t.Lk)("div",H,"Comprobante ("+(0,n.v_)(e.tituloComprobante)+") a nombre del:",1),(0,t.Lk)("div",X,[(0,t.bF)(se,{modelValue:e.tipoCliente,"onUpdate:modelValue":o[31]||(o[31]=function(o){return e.tipoCliente=o}),val:"1",label:"Alumno"},null,8,["modelValue"]),(0,t.bF)(se,{modelValue:e.tipoCliente,"onUpdate:modelValue":o[32]||(o[32]=function(o){return e.tipoCliente=o}),val:"2",label:"Responsable de pago"},null,8,["modelValue"])]),Number(e.tipoCliente)===e.TIPCLIENTE.SUBCLIENTE?((0,t.uX)(),(0,t.Wv)(K,{key:0,modelValue:e.selectCliente,"onUpdate:modelValue":o[33]||(o[33]=function(o){return e.selectCliente=o}),options:e.selectDataClientes,label:"Responsable de Pago"},null,8,["modelValue","options"])):(0,t.Q3)("v-if",!0)]}),_:1},8,["modelValue","onSubmit"])]}),_:1})}var j=a(91134),J=a.n(j),K=a(57008),Z=a.n(K),ee=a(9504),oe=a.n(ee),ae=a(41562),te=a.n(ae),ne=a(76080),re=a.n(ne),ie=a(8445),le=a.n(ie),ce=a(45254),ue=a.n(ce),se=(a(12563),a(34634),a(30683),a(74260),a(71587),a(39866),a(77507),a(52133),a(10239),a(23513),a(32203),a(6724),a(92802),a(70199),a(15547),a(515),a(52776),a(84433),a(88390),a(62692),a(66307),a(2369),a(68017),a(7346),a(6123)),de=a(88567),me=a(95718),fe=a(53380),pe=a(99515),Ne=a(64208),Ce=a(54489),ge=a(18105),he=a(12143),Ae=a(95477),Me=a(80660),Oe=a(36408),ve=a(69759),Ee=a(78840),be=a(54267),Te=a(42037),we=a(27560),Pe=a(41615),Ue=a(75053),De=a(35611),Ie=a(57668),Ve=a(17955),_e=a(12533),Se=a(33001),Re=a(16648),ke={components:{QSelect:Re.A},data:function(){return{options:[],value:null}},beforeMount:function(){var e=this;return ue()(re()().m(function o(){var a;return re()().w(function(o){while(1)switch(o.n){case 0:if(a=[],"string"!==typeof e.params.api){o.n=2;break}return o.n=1,Me.$http.get(e.params.api,{params:{response:"combo"}});case 1:a=o.v,o.n=3;break;case 2:a=e.params.options||[];case 3:e.options=le()(a),e.value=e.params.value||e.params.defaultvalue;case 4:return o.a(2)}},o)}))()},render:function(){var e=this;return(0,t.h)(Re.A,{modelValue:e.value,options:e.options,"hide-selected":!0,"fill-input":!0,"use-input":!0,onInput:function(o){e.value=o,e.params.setValue(o)},onFilter:function(o,a){a(function(){var a=le()(e.params.options);e.options=(0,Se.filterArray)(o,{field:e.params.dLabel||"label",list:a})})}})}},Le=a(43554),Fe=a(64303),Ge=a(3112),$e=a(17915),ye=a(38739),Be=a(26319),qe={props:["lessHeight","cp"],components:{QCheckbox:Ge.A,consultarDocumento:De["default"],sieModal:Ue.A,QCard:de.A,QCardSection:me.A,QSeparator:fe.A,QDate:he.A,QPopupProxy:Ae.A,QInput:Ne.A,QSelect:Ce.S,sieGrid:Oe.A,formaPago:ve.A,formasPagoComprobantes:Ve.A,footerGrid:we.A,crearBotones:Fe.A,QRadio:pe.A,tesoreriaLoading:$e.A,QOptionGroup:ye.A,QIcon:se.bP,QBtn:se.Il},data:function(){return{nombre:"",tituloComponente:"Corrección de Comprobante",filtrar:[{label:"Fecha Emisión",value:"fecemi"},{label:"Fecha Pago",value:"fecpag"}],selectFiltrar:"fecemi",from:(0,ge.Ay)(new Date,"DD/MM/YYYY"),to:(0,ge.Ay)(new Date,"DD/MM/YYYY"),talon:[],selectTalon:Pe["default"].TODOS,item:[],conceptos:[],usuario:[],datosPagos:{},selectUsuario:Pe["default"].TODOS,columnDefs:null,rowData:null,backupData:null,api:null,openFormaPago:!1,frameworkComponents:null,page:1,max:1,NUMTAL:null,NUMPAG:null,saldo:0,openModal:!1,openCambiarMotivoNC:!1,moneda:{},fechaPago:new Date,componente:"",NOTA_CREDITO:"notaCredito",NumPagFor:"",NumTalFor:"",Cliente:"",comprobante:"",talonGrid:[],nameComponente:"CorreccionNroPago",botones:[],nivelAcceso:(0,Ie["default"])().nivelAcceso||3,visbleTalonMasivo:1,talonMasivo:"",dataTalonMasivo:[],fechaEmision:"",fechaPagoFiltro:"",openModalModificar:!1,numComp:"",numNC:"",clienteNC:"",selectMotivos:[],selectMotivosActual:[],motivoNC:"",motivoNCActual:"",numpagNC:"",numtalNC:"",numpagNCREF:"",numtalNCREF:"",anupagNC:"",motivosPermitidos:["06","07","09"],formModificar:{MONTO_ANT:0,MONTO_NUEVO:0,DESC_ANT:0,NUEVO_DESC:0,MORA_ANT:0,NUEVA_MORA:0,NUMITE:1,NUMITE_NUEVO:1,NUMTAL:"",NUMPAG:"",ANOCOB_NUEVO:0,MESCOB_NUEVO:0},defaultColDef:{suppressHeaderMenuButton:!0,filter:!0,floatingFilterComponentParams:{suppressFilterButton:!0},resizable:!0,sortable:!0,suppressDragLeaveHidesColumns:!0},openModalCorregirCliente:!1,columnDefsClientes:[],rowDataClientes:[],selectDataClientes:[],selectCliente:"",tipoCliente:null,dataComprobante:{},apiCliente:null,tituloComprobante:"",TIPCLIENTE:Pe["default"].TIPCLIENTE,loading:{showLoading:!1,procesados:0,total:0},optionsTalonario:[{label:"Masivo",value:1},{label:"Individual",value:0}],correlativoSecuencial:!1,initCorrelativo:"0000001",contador:null,filterModel:null,editModeContent:!1,btnConceptoEdit:!1,messageValidation:"",anios:[],meses:[],currentRow:[],concatCodigo:"",botonPrincipal:[],filtroMasivo:!1}},methods:{filterConcatCodigo:function(){var e=this;return ue()(re()().m(function o(){var a,t;return re()().w(function(o){while(1)switch(o.n){case 0:if(a=e.concatCodigo.split(";"),0!==a.length&&0!==e.concatCodigo.trim().length){o.n=1;break}return e.rowData=e.backupData,e.contador=e.rowData.length,o.a(2,!0);case 1:t=le()(e.backupData),e.rowData=t.filter(function(e){return a.includes(e.CODIGO)}),e.contador=e.rowData.length,e.$nextTick(function(){e.api.forEachNode(function(e){e.setSelected(!0)})});case 2:return o.a(2)}},o)}))()},getAnios:function(){var e=this;return ue()(re()().m(function o(){var a;return re()().w(function(o){while(1)switch(o.p=o.n){case 0:return o.p=0,o.n=1,Pe["default"].API_ANIOS();case 1:a=o.v,e.anios=a,o.n=3;break;case 2:o.p=2,o.v,e.$alert("Hubo un error al obtener los años a elegir");case 3:return o.a(2)}},o,null,[[0,2]])}))()},getMeses:function(){var e=this;return ue()(re()().m(function o(){var a;return re()().w(function(o){while(1)switch(o.p=o.n){case 0:return o.p=0,o.n=1,Pe["default"].MESES();case 1:a=o.v,e.meses=a,o.n=3;break;case 2:o.p=2,o.v,e.$alert("Hubo un error al obtener los meses a elegir");case 3:return o.a(2)}},o,null,[[0,2]])}))()},toggleEditMode:function(){this.editModeContent=!this.editModeContent},onFilterChanged:function(e){this.contador=Array.from({length:e.api.getDisplayedRowCount()}),this.filterModel=e.api.getFilterModel()},restoreFilterState:function(){this.filterModel&&this.api.setFilterModel(this.filterModel)},setearCorrelativo:function(){this.initCorrelativo=String(this.initCorrelativo).trim().split("").filter(function(e){return/\d/.test(e)}).join("")},setearFormato:function(){this.initCorrelativo=0===Number(this.initCorrelativo)?1:Number(this.initCorrelativo),this.initCorrelativo=String(this.initCorrelativo).length<7?String(this.initCorrelativo).padStart(7,"0"):String(this.initCorrelativo).slice(0,7)},limpiarMasivo:function(){if(1===Number(this.visbleTalonMasivo))return!0;this.filter()},seleccionarTalonarioMasivo:function(){var e=this;return ue()(re()().m(function o(){var a,t,n;return re()().w(function(o){while(1)switch(o.n){case 0:if(a=e.rowData,t=le()(e.api.getSelectedRows()).reduce(function(e,o){return e[o.NRODOC]=!0,e},{}),0!==a.length){o.n=1;break}return o.a(2,e.$alert("No se modificó ningún registro","warning"));case 1:n=a.map(function(o){return o.NVTALONARIO=e.talonMasivo,o.CAMBIO=!0,o}),e.initCorrelativo=(0,Le.k)(e.initCorrelativo),e.rowData=n,e.$nextTick(function(){e.api.forEachNode(function(e){return e.setSelected(t[e.data.NRODOC])})});case 2:return o.a(2)}},o)}))()},revertirMasivo:function(){var e=this,o=this.api.getSelectedRows();if(0===o.length)return this.$alert("Debe de seleccionar un comprobante","warning");var a=o.length>1?"los (".concat(o.length,") comprobantes seleccionados"):"el comprobante ".concat(o[0].NUMTAL,"-").concat(o[0].NUMPAG);this.$confirm("¿Esta seguro de REVERTIR ".concat(a,"?")).onOk(ue()(re()().m(function a(){var t,n,r,i,l,c,u;return re()().w(function(a){while(1)switch(a.p=a.n){case 0:t={correctamente:[],error:[]},e.loading.showLoading=!0,e.loading.total=o.length,e.loading.label="Revirtiendo Pagos",e.loading.procesados=0,n=te()(o),a.p=1,n.s();case 2:if((r=n.n()).done){a.n=10;break}if(i=r.value,a.p=3,i.ESTADO!==Pe["default"].COMPROBANTE_ANULADO){a.n=4;break}throw new Error("El comprobante (".concat(i.NUMTAL,"-").concat(i.NUMPAG,") esta ANULADO"));case 4:if([Pe["default"].COMPROBANTE_CANCELADO,Pe["default"].COMPROBANTE_CASTIGADO,Pe["default"].COMPROBANTE_CONDONADO].includes(Number(i.ESTADO))){a.n=5;break}throw new Error("El comprobante (".concat(i.NUMTAL,"-").concat(i.NUMPAG,") no esta cancelado"));case 5:return a.n=6,Me.$http.delete("api/formaPagoController/deleteFormaDePago",{params:{datos:{NUMTAL:i.NUMTAL,NUMPAG:i.NUMPAG}}});case 6:l=a.v,t.correctamente.push(l),a.n=8;break;case 7:a.p=7,c=a.v,t.error.push(c.error?c.error.message:c.message);case 8:e.loading.procesados++;case 9:a.n=2;break;case 10:a.n=12;break;case 11:a.p=11,u=a.v,n.e(u);case 12:return a.p=12,n.f(),a.f(12);case 13:if(e.loading.showLoading=!1,!(t.error.length>0&&0===t.correctamente.length)){a.n=14;break}return a.a(2,e.$alert(1===o.length?t.error[0]:"Proceso Finalizado: No se pudo revertir los comprobantes","warning"));case 14:if(!(t.error.length>0&&t.correctamente.length>0)){a.n=15;break}return e.filter(),a.a(2,e.$alert("Proceso Finalizado: (".concat(t.correctamente.length,") Comprobantes Revertidos y (").concat(t.error.length,") Comprobantes con Errores"),"success"));case 15:return e.filter(),a.a(2,e.$alert("Proceso Finalizado: (".concat(t.correctamente.length,") Comprobantes Revertirdos Satisfactoriamente"),"success"));case 16:return a.a(2)}},a,null,[[3,7],[1,11,12,13]])})))},crearBotones:function(){this.botones=[{label:"Procesar",icon:"settings",click:this.guardar,minAcceso:Pe["default"].SOLO_LECTURA,principal:!0},{label:"Convertir en Gratuitos",icon:"settings",click:this.convertirAnuladoGratuito,minAcceso:Pe["default"].ACCESO_TOTAL},{label:"Revertir Anulación",icon:"settings",click:this.revertirAnulacion,minAcceso:Pe["default"].ACCESO_TOTAL},{icon:"replay",label:"revertir pago",click:this.revertirMasivo,minAcceso:Pe["default"].LECTURA_ESCRITURA}]},guardar:function(){var e=this,o=this.api.getSelectedRows();return 0===o.length?this.$alert("No modificó ningún comprobante","warning"):this.correlativoSecuencial&&!this.initCorrelativo?this.$alert("No ingreso el inicio del correlativo"):void this.$confirm("¿Esta seguro de modificar los (".concat(o.length,") comprobantes?")).onOk(ue()(re()().m(function a(){var t,n,r,i,l,c,u,s,d,m,f;return re()().w(function(a){while(1)switch(a.p=a.n){case 0:a.p=0,t={errores:[],correctamente:[]},e.loading.showLoading=!0,e.loading.procesados=0,e.loading.total=o.length,s=oe()(o);case 1:if((d=s()).done){a.n=8;break}return n=d.value,r=o[n],a.n=2,e.obtenerDatosTalonario(r,n);case 2:if(i=a.v,!(Object.keys(i).length>0)){a.n=7;break}return a.p=3,a.n=4,Me.$http.post("api/PagoController/postCorreccionNroPago",{datos:i});case 4:l=a.v,t.correctamente.push(l.message),a.n=6;break;case 5:a.p=5,m=a.v,t.errores.push(m.error.message);case 6:return a.p=6,e.loading.procesados+=1,a.f(6);case 7:a.n=1;break;case 8:return e.loading.showLoading=!1,c="Proceso Finalizado",u="success",1===o.length?t.correctamente.length>0?c=t.correctamente[0]:(c=t.errores[0],u="warning"):t.correctamente.length>0&&0===t.errores.length?c="(".concat(t.correctamente.length,") Comprobantes Actualizados Satisfactoriamente "):t.errores.length>0&&0===t.correctamente.length?(c="(".concat(t.errores.length,") Comprobantes con Errores"),0===t.correctamente.length&&(u="warning")):(c="(".concat(t.correctamente.length,") Comprobantes Actualizados y (").concat(t.errores.length,") con Errores"),u="info"),e.$alert(c,u),a.n=9,e.pagosEmitidos();case 9:a.n=11;break;case 10:return a.p=10,f=a.v,e.$q.loading.hide(),a.a(2,e.$alert(f.error?f.error.message:f.message,"warning"));case 11:return a.a(2)}},a,null,[[3,5,6,7],[0,10]])})))},getTalonariosUsuario:function(){var e=this;return ue()(re()().m(function o(){var a;return re()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,Pe["default"].API_TALONARIOS();case 1:a=o.v,e.talon=[{value:"T",label:"Todos"}].concat(le()(a)),e.dataTalonMasivo=le()(a);case 2:return o.a(2)}},o)}))()},obtenerDatosTalonario:function(e,o){var a=this;return ue()(re()().m(function t(){var n,r;return re()().w(function(t){while(1)switch(t.p=t.n){case 0:if(t.p=0,e.NVTALONARIO!==e.NUMTAL||e.NVNUMERO!==e.NUMPAG||e.NVFECEMI!==e.FECEMI){t.n=1;break}return t.a(2,[]);case 1:if(n={comprobante:{numtal:e.NUMTAL,numpag:e.NUMPAG},nuevo:{}},n.nuevo.numpag=a.obtenerNuevoNuevoTalonario(e.NVNUMERO,o),n.nuevo.numpag||delete n.nuevo.numpag,e.NVTALONARIO&&(n.nuevo.numtal=e.NVTALONARIO),e.NVFECEMI&&(n.nuevo.fecemi=a.formarDateYYYMMDD((0,ge.Ay)(e.NVFECEMI))),e.CAMBIO){t.n=2;break}return t.a(2,[]);case 2:return t.a(2,n);case 3:throw t.p=3,r=t.v,new Error(r.message);case 4:return t.a(2)}},t,null,[[0,3]])}))()},obtenerNuevoNuevoTalonario:function(e,o){if(!this.correlativoSecuencial)return e&&e.trim().length>0?(0,Le.k)(e.trim()):null;var a=Number(this.initCorrelativo)+Number(o);return(0,Le.k)(a)},formarDateYYYMMDD:function(e){var o=e.split("T").at(0);return o},getTalones:function(){var e=this;return ue()(re()().m(function o(){var a,t;return re()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,Pe["default"].API_TALONARIOS();case 1:return a=o.v,t=a.map(function(e){return{label:e.label,value:e.value}}),e.talonGrid=t,o.a(2,t)}},o)}))()},getUsuarios:function(){var e=this;return ue()(re()().m(function o(){return re()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,Pe["default"].API_USUARIOS_TESORERIA();case 1:e.usuario=o.v;case 2:return o.a(2)}},o)}))()},volver:function(){window.history.go(-1)},cerrarModal:function(){this.openModal=!1,this.openModalModificar=!1,this.btnConceptoEdit=!1,this.editModeContent=!1},openModalFormaPago:function(){this.openFormaPago=!0},onGridReady:function(e){this.api=e.api},closeModalCalendar:function(e){this.$refs[e].hide(),this.filter()},filter:function(){this.pagosEmitidos()},onCellClicked:function(e){var o=e.colDef.field,a=e.data;return"NRODOCREF"===o&&(!(!a.NUMTALO||!a.NUMPAGO)&&void this.imprimirComprobanteReferencia(e.data))},cellValueChanged:function(e){"NVNUMERO"===e.colDef.field&&(e.data.NVNUMERO=(0,Le.k)(e.data.NVNUMERO.trim(),7)),e.data.CAMBIO=!0,e.api.updateRowData([e.data])},getConceptos:function(){var e=this;return ue()(re()().m(function o(){var a;return re()().w(function(o){while(1)switch(o.p=o.n){case 0:return o.p=0,o.n=1,Pe["default"].API_CONCEPTOS({ingvar:!0});case 1:a=o.v,e.conceptos=a,o.n=3;break;case 2:o.p=2,o.v,e.$alert("Hubo un error al obtener los conceptos a elegir");case 3:return o.a(2)}},o,null,[[0,2]])}))()},abrirModalCorregirMonto:function(e){var o=this;return ue()(re()().m(function a(){var t,n,r,i;return re()().w(function(a){while(1)switch(a.n){case 0:return o.openModalModificar=!0,o.numComp=e.NUMTAL+"-"+e.SERIE+"-"+e.NUMPAG,o.formModificar.NUMTAL=e.NUMTAL,o.formModificar.NUMPAG=e.NUMPAG,o.conceptoSeleccionado(),t={numtal:e.NUMTAL,numpag:e.NUMPAG},a.n=1,Me.$http.get("api/PagoController/getComprobantesConceptos",{params:{parametros:t}});case 1:n=a.v,n.length>0?(r=le()(n),i=r[0],o.formModificar.MONTO_ANT=i.MONTOCOB,o.formModificar.MONTO_NUEVO=i.MONTOCOB,o.formModificar.NUMITE=i.NUMITE,o.formModificar.DESC_ANT=i.MONTODES,o.formModificar.NUEVO_DESC=i.MONTODES,o.formModificar.MORA_ANT=i.MONTOMOR,o.formModificar.NUEVA_MORA=i.MONTOMOR,o.formModificar.ANOCOB_NUEVO=i.ANOCOB,o.formModificar.MESCOB_NUEVO=i.MESCOB,i.ID_DEUDA?o.formModificar.ID_DEUDA=i.ID_DEUDA:o.formModificar.ID_DEUDA=null,o.item=le()(n),o.item=o.item.map(function(e,a){return Z()(Z()({},e),{},J()({},"NUM_CONCEPTO",o.item.length>1?"".concat(a+1," - ").concat(e.CONCEPTO):"".concat(e.CONCEPTO)))})):o.$alert("Ha ocurrido un problema obteniendo el concepto","warning"),"I"===n[0].TIPPAG?(o.btnConceptoEdit=!0,o.editModeContent=!1):(o.btnConceptoEdit=!1,o.editModeContent=!1);case 2:return a.a(2)}},a)}))()},conceptoSeleccionado:function(){var e=this;return ue()(re()().m(function o(){var a;return re()().w(function(o){while(1)switch(o.n){case 0:return a={numtal:e.formModificar.NUMTAL,numpag:e.formModificar.NUMPAG,numite:e.formModificar.NUMITE},o.n=1,Me.$http.get("api/PagoController/getComprobantesConceptos",{params:{parametros:a}}).then(function(o){if(o.length>0){var a=le()(o),t=a[0];e.formModificar.MONTO_ANT=t.MONTOCOB,e.formModificar.MONTO_NUEVO=t.MONTOCOB,e.formModificar.NUMITE=t.NUMITE,e.formModificar.DESC_ANT=t.MONTODES,e.formModificar.NUEVO_DESC=t.MONTODES,e.formModificar.MORA_ANT=t.MONTOMOR,e.formModificar.NUEVA_MORA=t.MONTOMOR,e.formModificar.ANOCOB_NUEVO=t.ANOCOB,e.formModificar.MESCOB_NUEVO=t.MESCOB,t.ID_DEUDA?e.formModificar.ID_DEUDA=t.ID_DEUDA:e.formModificar.ID_DEUDA=null,e.currentRow=o}else e.$alert("Ha ocurrido un problema obteniendo el concepto","warning")});case 1:return o.a(2)}},o)}))()},modificarMontoComprobante:function(){var e=this;return ue()(re()().m(function o(){var a;return re()().w(function(o){while(1)switch(o.n){case 0:a={NUMTAL:e.formModificar.NUMTAL,NUMPAG:e.formModificar.NUMPAG,NUMITE:e.formModificar.NUMITE,MONTO:Number(e.formModificar.MONTO_NUEVO),MONTO_DES:e.formModificar.NUEVO_DESC,MONTO_MOR:e.formModificar.NUEVA_MORA,CONCEPTO_ANTIGUO:e.currentRow[0].CONCOB},e.btnConceptoEdit&&e.formModificar.CONCEPTO_NUEVO&&(a.CONCEPTO_NUEVO=e.formModificar.CONCEPTO_NUEVO),e.btnConceptoEdit&&e.formModificar.ANOCOB_NUEVO&&(a.ANOCOB_NUEVO=e.formModificar.ANOCOB_NUEVO),e.btnConceptoEdit&&e.formModificar.MESCOB_NUEVO&&(a.MESCOB_NUEVO=e.formModificar.MESCOB_NUEVO),e.formModificar.ID_DEUDA&&(a.ID_DEUDA=e.formModificar.ID_DEUDA),e.formModificar.MONTO_ANT!==a.MONTO&&e.formModificar.NUMITE!==a.CONCEPTO_NUEVO?e.messageValidation="¿Esta seguro de actualizar el concepto y el monto (".concat(a.MONTO.toFixed(2),") para el comprobante (").concat(e.numComp,")?"):e.formModificar.MONTO_ANT!==a.MONTO?e.messageValidation="¿Esta seguro de actualizar el monto (".concat(a.MONTO.toFixed(2),") para el comprobante (").concat(e.numComp,")?"):e.formModificar.CONCEPTO_NUEVO&&e.currentRow[0].CONCOB!==e.formModificar.CONCEPTO_NUEVO?e.messageValidation="¿Esta seguro de editar el concepto para el comprobante (".concat(e.numComp,")?"):e.currentRow[0].ANOCOB===a.ANOCOB_NUEVO&&e.currentRow[0].MESCOB===a.MESCOB_NUEVO||(e.messageValidation="¿Esta seguro de editar el mes y/o año para el comprobante (".concat(e.numComp,")?")),e.$confirm(e.messageValidation).onOk(ue()(re()().m(function o(){return re()().w(function(o){while(1)switch(o.p=o.n){case 0:return e.$q.loading.show(),o.p=1,o.n=2,Me.$http.put("api/PagoController/putModificarMonto",{datos:a}).then(function(o){e.formModificar.MONTO_ANT=e.formModificar.MONTO_NUEVO,e.formModificar.DESC_ANT=e.formModificar.NUEVO_DESC,e.formModificar.MORA_ANT=e.formModificar.NUEVA_MORA,e.formModificar.CONCEPTO_NUEVO="",e.$alert(o.message,"success"),e.cerrarModal()}).catch(function(o){e.$alert(o.error.message,"warning")});case 2:e.$q.loading.hide(),o.n=4;break;case 3:o.p=3,o.v,e.$q.loading.hide();case 4:return o.a(2)}},o,null,[[1,3]])})));case 1:return o.a(2)}},o)}))()},pagosEmitidos:function(){var e=arguments,o=this;return ue()(re()().m(function a(){var t,n,r;return re()().w(function(a){while(1)switch(a.n){case 0:return e.length>0&&void 0!==e[0]&&e[0],t={pagina:o.page,numtal:o.selectTalon,nombre:o.nombre,tipfecha:o.selectFiltrar,fecini:(0,ge.Ay)((0,be.convertToYMD)(o.from),"YYYY-MM-DD"),fecfin:(0,ge.Ay)((0,be.convertToYMD)(o.to),"YYYY-MM-DD"),origen:o.componente,orden:"tal_numagAsc"},a.n=1,Me.$http.get("api/PagoController/getPagosEmitidos",{params:{datos:t}});case 1:if(n=a.v,!(n.rows.length>0)){a.n=2;break}return r=n.rows.map(function(e){return e.NVFECEMI=e.FECEMI,e.CAMBIO=!1,e.FECVEN=(0,Be.parseStringToDate)(e.FECVEN),e.FECPAG=(0,Be.parseStringToDate)(e.FECPAG),e.FECEMI=(0,Be.parseStringToDate)(e.FECEMI),e.NVTALONARIO=1===o.visbleTalonMasivo?o.talonMasivo:"",e.CAMBIO=Boolean(Number(o.visbleTalonMasivo)),e}),o.max=n.pages,o.rowData=r,o.backupData=JSON.parse(JSON.stringify(r)),o.contador=r,o.seleccionarTalonarioMasivo(),o.$nextTick(function(){o.restoreFilterState(),o.filterConcatCodigo()}),a.a(2,n);case 2:o.rowData=[];case 3:return a.a(2)}},a)}))()},cambiarMotivoNC:function(e){var o=this;return ue()(re()().m(function a(){return re()().w(function(a){while(1)switch(a.n){case 0:if(e.CODSUNAT!==Pe["default"].CODSUNAT.NOTA_CREDITO){a.n=2;break}return a.n=1,Me.$http.get("api/EstadoTablaController/getEstadoTabla",{params:{parametros:{CODIGO:Pe["default"].ESTADO_TABLA.MOTIVO_NOTA_CREDITO}}}).then(function(e){o.selectMotivos=e.map(function(e){var o=e.CLAVE,a=e.VALOR;return{CLAVE:o,VALOR:"".concat(o," | ").concat(a)}}),o.selectMotivosActual=e.map(function(e){var o=e.CLAVE,a=e.VALOR;return{CLAVE:o,VALOR:"".concat(o," | ").concat(a)}})});case 1:o.numpagNC=e.NUMPAG,o.numtalNC=e.NUMTAL,o.numpagNCREF=e.NUMPAGO,o.numtalNCREF=e.NUMTALO,o.motivoNCActual=e.MOTNOTA,o.numNC=e.NUMTAL+"-"+e.SERIE+"-"+e.NUMPAG,o.clienteNC=e.NOMBRE,o.anupagNC=e.ANUPAG,o.motivoNC=null,o.openCambiarMotivoNC=!0,a.n=3;break;case 2:o.$alert("Esta opción solo se puede usar con Notas de crédito","info");case 3:return a.a(2)}},a)}))()},cambiarTippag:function(e){var o=this;return ue()(re()().m(function a(){return re()().w(function(a){while(1)switch(a.n){case 0:o.$confirm("¿Esta seguro de cambiar el TIPO DE PAGO de Ingresos Varios a Deuda del comprobante ".concat(e.NUMTAL,"-").concat(e.NUMPAG,"?")).onOk(ue()(re()().m(function a(){return re()().w(function(a){while(1)switch(a.p=a.n){case 0:return o.$q.loading.show(),a.p=1,a.n=2,Me.$http.put("api/PagoController/putModificarTippag",{datos:{numtal:e.NUMTAL,numpag:e.NUMPAG}}).then(function(){var e=ue()(re()().m(function e(a){return re()().w(function(e){while(1)switch(e.n){case 0:return o.$alert(a.message,"success"),e.n=1,o.pagosEmitidos();case 1:return e.a(2)}},e)}));return function(o){return e.apply(this,arguments)}}()).catch(function(e){o.$alert(e.error.message,"warning")});case 2:o.$q.loading.hide(),a.n=4;break;case 3:a.p=3,a.v,o.$q.loading.hide();case 4:return a.a(2)}},a,null,[[1,3]])})));case 1:return a.a(2)}},a)}))()},modificarMotivoNC:function(){var e=this;return ue()(re()().m(function o(){var a;return re()().w(function(o){while(1)switch(o.n){case 0:if(0!==e.motivoNC.length){o.n=1;break}return e.$alert("Debe de seleccionar un nuevo motivo para la Nota de Crédito.","warning"),o.a(2,!1);case 1:a={numtal:e.numtalNC,numpag:e.numpagNC,numtalo:e.numtalNCREF,numpago:e.numpagNCREF,motnota:e.motivoNC,motnotaActual:e.motivoNCActual},e.$confirm("¿Esta seguro de actualizar el motivo del comprobante (".concat(e.numNC,")?")).onOk(ue()(re()().m(function o(){return re()().w(function(o){while(1)switch(o.p=o.n){case 0:return e.$q.loading.show(),o.p=1,o.n=2,Me.$http.put("api/PagoController/putModificarMotivoNC",{datos:a}).then(function(){var o=ue()(re()().m(function o(a){return re()().w(function(o){while(1)switch(o.n){case 0:return e.$alert(a.message,"success"),e.openCambiarMotivoNC=!1,o.n=1,e.pagosEmitidos();case 1:return o.a(2)}},o)}));return function(e){return o.apply(this,arguments)}}()).catch(function(o){e.$alert(o.error.message,"warning")});case 2:e.$q.loading.hide(),o.n=4;break;case 3:o.p=3,o.v,e.$q.loading.hide();case 4:return o.a(2)}},o,null,[[1,3]])})));case 2:return o.a(2)}},o)}))()},convertirAnuladoGratuito:function(e){var o=this;return ue()(re()().m(function e(){var a,t,n,r,i,l,c;return re()().w(function(e){while(1)switch(e.n){case 0:a=o.api.getSelectedRows(),0===a.length?o.$alert("No seleccionó ningún comprobante","warning"):1===a.length?(t=le()(a),n=t[0],r=n.NUMTAL+"-"+n.SERIE+"-"+n.NUMPAG,i={numtal:n.NUMTAL,numpag:n.NUMPAG},n.ANUPAG===Pe["default"].PAGO_ANUPAG.ANULADO?o.$confirm("¿Esta seguro de cambiar el comprobante (".concat(r,")  anulado a gratuito?")).onOk(ue()(re()().m(function e(){return re()().w(function(e){while(1)switch(e.p=e.n){case 0:return o.$q.loading.show(),e.p=1,e.n=2,Me.$http.put("api/PagoController/putCambiarAnuladoPorGratuito",{datos:i}).then(function(){var e=ue()(re()().m(function e(a){return re()().w(function(e){while(1)switch(e.n){case 0:return o.$alert(a.message,"success"),e.n=1,o.pagosEmitidos();case 1:return e.a(2)}},e)}));return function(o){return e.apply(this,arguments)}}()).catch(function(e){o.$alert(e.error.message,"warning")});case 2:o.$q.loading.hide(),e.n=4;break;case 3:e.p=3,e.v,o.$q.loading.hide();case 4:return e.a(2)}},e,null,[[1,3]])}))):o.$alert("Esta opción solo se puede usar con Comprobantes Anulados","info")):(l=0,c=0,o.$confirm("¿Esta seguro de cambiar los (".concat(a.length,") comprobantes anulado a gratuitos?")).onOk(ue()(re()().m(function e(){var t,n;return re()().w(function(e){while(1)switch(e.p=e.n){case 0:o.$q.loading.show(),t=0;case 1:if(!(t<a.length)){e.n=8;break}if(n={numtal:a[t].NUMTAL,numpag:a[t].NUMPAG},a[t].ANUPAG!==Pe["default"].PAGO_ANUPAG.ANULADO||a[t].TIPPAG!==Pe["default"].PAGO_TIPPAG.INGRESOS){e.n=6;break}return o.$q.loading.show(),e.p=2,e.n=3,Me.$http.put("api/PagoController/putCambiarAnuladoPorGratuito",{datos:n}).then(function(){var e=ue()(re()().m(function e(o){return re()().w(function(e){while(1)switch(e.n){case 0:l+=1;case 1:return e.a(2)}},e)}));return function(o){return e.apply(this,arguments)}}()).catch(function(e){c+=1});case 3:o.$q.loading.hide(),e.n=5;break;case 4:e.p=4,e.v,o.$q.loading.hide();case 5:e.n=7;break;case 6:(a[t].ANUPAG!==Pe["default"].PAGO_ANUPAG.ANULADO||a[t].TIPPAG!==Pe["default"].PAGO_TIPPAG.INGRESOS)&&(c+=1);case 7:t++,e.n=1;break;case 8:return o.$q.loading.hide(),o.$alert("Proceso finalizado, (".concat(l,") comprobantes procesados, (").concat(c,") no procesados"),"info"),e.n=9,o.pagosEmitidos();case 9:return e.a(2)}},e,null,[[2,4]])}))));case 1:return e.a(2)}},e)}))()},revertirAnulacion:function(){var e=this;return ue()(re()().m(function o(){var a,t,n,r,i,l,c;return re()().w(function(o){while(1)switch(o.n){case 0:a=e.api.getSelectedRows(),0===a.length?e.$alert("No seleccionó ningún comprobante","warning"):1===a.length?(t=le()(a),n=t[0],r=n.NUMTAL+"-"+n.SERIE+"-"+n.NUMPAG,i={numtal:n.NUMTAL,numpag:n.NUMPAG,tippag:n.TIPPAG},n.ANUPAG===Pe["default"].PAGO_ANUPAG.ANULADO?e.$confirm("¿Esta seguro de revertir la anulación del comprobante (".concat(r,")?")).onOk(ue()(re()().m(function o(){return re()().w(function(o){while(1)switch(o.p=o.n){case 0:return e.$q.loading.show(),o.p=1,o.n=2,Me.$http.put("api/PagoController/putRevertirAnulacion",{datos:i}).then(function(){var o=ue()(re()().m(function o(a){return re()().w(function(o){while(1)switch(o.n){case 0:return e.$alert(a.message,"success"),o.n=1,e.pagosEmitidos();case 1:return o.a(2)}},o)}));return function(e){return o.apply(this,arguments)}}()).catch(function(o){e.$alert(o.error.message,"warning")});case 2:e.$q.loading.hide(),o.n=4;break;case 3:o.p=3,o.v,e.$q.loading.hide();case 4:return o.a(2)}},o,null,[[1,3]])}))):e.$alert("Esta opción solo se puede usar con Comprobantes Anulados","info")):(l=0,c=0,e.$confirm("¿Esta seguro de revertir la anulación de (".concat(a.length,") comprobantes?")).onOk(ue()(re()().m(function o(){var t,n;return re()().w(function(o){while(1)switch(o.p=o.n){case 0:e.$q.loading.show(),t=0;case 1:if(!(t<a.length)){o.n=8;break}if(n={numtal:a[t].NUMTAL,numpag:a[t].NUMPAG,tippag:a[t].TIPPAG},a[t].ANUPAG!==Pe["default"].PAGO_ANUPAG.ANULADO){o.n=6;break}return e.$q.loading.show(),o.p=2,o.n=3,Me.$http.put("api/PagoController/putRevertirAnulacion",{datos:n}).then(function(){var e=ue()(re()().m(function e(o){return re()().w(function(e){while(1)switch(e.n){case 0:l+=1;case 1:return e.a(2)}},e)}));return function(o){return e.apply(this,arguments)}}()).catch(function(e){c+=1});case 3:e.$q.loading.hide(),o.n=5;break;case 4:o.p=4,o.v,e.$q.loading.hide();case 5:o.n=7;break;case 6:c+=1;case 7:t++,o.n=1;break;case 8:return e.$q.loading.hide(),e.$alert("Proceso finalizado, (".concat(l,") comprobantes procesados, (").concat(c,") no procesados"),"info"),o.n=9,e.pagosEmitidos();case 9:return o.a(2)}},o,null,[[2,4]])}))));case 1:return o.a(2)}},o)}))()},getClientes:function(e){var o=this;return ue()(re()().m(function a(){var t,n;return re()().w(function(a){while(1)switch(a.p=a.n){case 0:return t={id_persona:e.TIPCLIENTE===Pe["default"].TIPCLIENTE.CLIENTE?e.ID_PERSONA:e.ID_PERSONA_SUB},a.p=1,a.n=2,Me.$http.get("api/personaController/getFamiliares",{params:{params:t}});case 2:n=a.v,o.rowDataClientes=n.filter(function(e){return"Hijo"!==e.RELACION}),o.selectDataClientes=o.rowDataClientes.map(function(e){return{label:" ".concat(e.RELACION," | ").concat(e.PERSONA," | ").concat(e.NRODOC),value:e.ID_PERSONA}}),o.selectCliente=o.dataComprobante.ID_PERSONA,a.n=4;break;case 3:a.p=3,a.v,o.$alert("Hubo un error al listar los clientes","warning");case 4:return a.a(2)}},a,null,[[1,3]])}))()},setColumnsClientes:function(){this.columnDefsClientes=[{width:40,headerName:"",checkboxSelection:!0},{headerName:"Nombres",field:"PERSONA",width:220},{headerName:"Parentesco",field:"RELACION",width:90},{headerName:"Número",field:"NRODOC",width:100}]},abrirModalCorregirCliente:function(e){var o=this;return ue()(re()().m(function a(){return re()().w(function(a){while(1)switch(a.n){case 0:return o.tituloComprobante=e.NRODOC,o.dataComprobante=Z()({},e),o.setColumnsClientes(),o.tipoCliente=String(e.TIPCLIENTE),a.n=1,o.getClientes(e);case 1:o.openModalCorregirCliente=!0;case 2:return a.a(2)}},a)}))()},corregirCliente:function(){var e=this;return ue()(re()().m(function o(){var a,t,n,r,i;return re()().w(function(o){while(1)switch(o.p=o.n){case 0:if(o.p=0,a=[e.rowDataClientes.find(function(o){return Number(o.ID_PERSONA)===Number(e.selectCliente)})],0!==a.length||Number(e.tipoCliente)!==e.TIPCLIENTE.SUBCLIENTE){o.n=1;break}return o.a(2,e.$alert("Debe seleccionar al menos un responsable de pago","warning"));case 1:return t=a[0],n={NUMPAG:e.dataComprobante.NUMPAG,NUMTAL:e.dataComprobante.NUMTAL,TIPCLIENTE:Number(e.tipoCliente),ID_PERSONA:null,ID_PERFIL:null,ID_PERSONA_SUB:null,ID_PERFIL_SUB:null},r={ID_PERSONA:null,ID_PERFIL:null},i={ID_PERSONA:null,ID_PERFIL:null},e.dataComprobante.TIPCLIENTE===e.TIPCLIENTE.CLIENTE?(r.ID_PERSONA=e.dataComprobante.ID_PERSONA,r.ID_PERFIL=e.dataComprobante.ID_PERFIL):e.dataComprobante.TIPCLIENTE===e.TIPCLIENTE.SUBCLIENTE&&(r.ID_PERSONA=e.dataComprobante.ID_PERSONA_SUB,r.ID_PERFIL=e.dataComprobante.ID_PERFIL_SUB,i.ID_PERSONA=e.dataComprobante.ID_PERSONA,i.ID_PERFIL=e.dataComprobante.ID_PERFIL),Number(e.tipoCliente)===e.TIPCLIENTE.CLIENTE?(n.ID_PERSONA=r.ID_PERSONA,n.ID_PERFIL=r.ID_PERFIL):Number(e.tipoCliente)===e.TIPCLIENTE.SUBCLIENTE&&(n.ID_PERSONA=t.ID_PERSONA,n.ID_PERFIL=t.ID_PERFIL,n.ID_PERSONA_SUB=r.ID_PERSONA,n.ID_PERFIL_SUB=r.ID_PERFIL),o.n=2,Me.$http.put("api/PagoController/putCorregirCliente",{params:n});case 2:return o.n=3,e.pagosEmitidos();case 3:e.$alert("Cliente corregido satisfactoriamente","success"),e.openModalCorregirCliente=!1,o.n=5;break;case 4:o.p=4,o.v,e.$alert("Hubo un problema al corregir el cliente","warning");case 5:return o.a(2)}},o,null,[[0,4]])}))()},imprimirComprobanteReferencia:function(e){var o=(0,Ie["default"])().origin;Pe["default"].IMPRIMIR_COMPROBANTE(o,e.NUMTALO,e.NUMPAGO)},imprimirComprobante:function(e){var o=(0,Ie["default"])().origin;Pe["default"].IMPRIMIR_COMPROBANTE(o,e.NUMTAL,e.NUMPAG)},onGridReadyClientes:function(e){var o=this;this.apiCliente=e.api,this.dataComprobante.TIPCLIENTE===this.TIPCLIENTE.SUBCLIENTE&&e.api.forEachNode(function(e){e.data&&e.data.ID_PERSONA===o.dataComprobante.ID_PERSONA&&o.apiCliente.selectNode(e,!0,!0)})},validarEstado:function(e){var o=e.colDef.field,a={};return!!e.data.ANUPAG&&(e.data.ANUPAG===Pe["default"].PAGO_ANUPAG.ANULADO&&(a=Z()(Z()({},a),{},{backgroundColor:"#FDD4CB",color:"#000"})),e.data.ANUPAG===Pe["default"].PAGO_ANUPAG.PENDIENTE&&(a=Z()(Z()({},a),{},{backgroundColor:"rgb(210, 225, 240)",color:"#000"})),"NRODOCREF"===o&&(a=Z()(Z()({},a),{},{cursor:"pointer",color:"blue",textDecoration:"underline"})),a)},cargarColumnas:function(){var e=this;return ue()(re()().m(function o(){var a,t;return re()().w(function(o){while(1)switch(o.n){case 0:return a=e,o.n=1,e.getTalones();case 1:t=[{headerName:"Nro. Documento",field:"NRODOC",width:130,cellStyle:e.validarEstado},{headerName:"Código",field:"CODIGO",width:100,cellStyle:e.validarEstado},{headerName:"Apellidos y Nombres / Razón Social",field:"NOMBRE",width:250,cellStyle:e.validarEstado},{headerName:"Fecha Emisión",field:"FECEMI",valueFormatter:function(e){return e.value?(0,ge.Ay)(e.value,"DD/MM/YYYY"):null},resizable:!1,filter:"agDateColumnFilter",filterParams:{},width:110,cellStyle:e.validarEstado}],t.push({headerName:"Fecha Ven.",field:"FECVEN",valueFormatter:function(e){return e.value?(0,ge.Ay)(e.value,"DD/MM/YYYY"):null},resizable:!1,filter:"agDateColumnFilter",filterParams:{},width:100,cellStyle:e.validarEstado},{headerName:"Fecha Pago",field:"FECPAG",valueFormatter:function(e){return e.value?(0,ge.Ay)(e.value,"DD/MM/YYYY"):null},resizable:!1,filter:"agDateColumnFilter",filterParams:{},width:100,cellStyle:e.validarEstado},{headerName:"Estado Documento",field:"ESTADO_DOC",width:120,cellStyle:e.validarEstado},{headerName:"",field:"MONSIG",width:55,cellStyle:e.validarEstado},{headerName:"Monto",field:"MONTOTPAG",width:90,cellClass:"text-right",valueFormatter:Te.toFixed,decimales:2,cellStyle:e.validarEstado,filter:!1}),e.visbleTalonMasivo||t.push({headerName:"Nv Talonario",field:"NVTALONARIO",width:160,cellRenderer:ke,cellRendererParams:{options:e.talonGrid},cellStyle:e.validarEstado,filter:!1}),t.push({headerName:"Nv Número",field:"NVNUMERO",editable:!0,width:120,cellStyle:e.validarEstado,filter:!1},{headerName:"Nv Fecha Emisión",field:"NVFECEMI",cellRenderer:_e.A,width:170,cellStyle:e.validarEstado,filter:!1},{headerName:"Nro. Doc Ref.",field:"NRODOCREF",width:130,cellStyle:e.validarEstado,cellClass:"pointer-cursor"},{headerName:"TIPPAG",field:"TIPPAG",cellStyle:e.validarEstado,width:70,hide:!0},{headerName:"TIPPAG",field:"TIPOPAGO",cellStyle:e.validarEstado,width:120},{filter:!1,headerName:"",cellRenderer:Ee.A,hide:!Pe["default"].USUARIOS_ADMIN.includes((0,Ie["default"])().usucod),cellRendererParams:{icon:"file_pdf",title:"Imprimir Reporte",onClick:function(e){var o=[e.data];a.imprimirComprobante(o[0])}},width:40,cellStyle:e.validarEstado},{filter:!1,headerName:"",cellRenderer:Ee.A,hide:!Pe["default"].USUARIOS_ADMIN.includes((0,Ie["default"])().usucod),cellRendererParams:{icon:"edit",title:"Editar Documento",onClick:function(e){var o=[e.data];a.abrirModalCorregirMonto(o[0])}},width:40,cellStyle:e.validarEstado},{headerName:"",hide:!Pe["default"].USUARIOS_ADMIN.includes((0,Ie["default"])().usucod),cellRendererSelector:function(e){if(e.data.CODSUNAT!==Pe["default"].CODSUNAT.FACTURA)return{component:Ee.A,params:{icon:"responsable_pago",title:"Cambiar Cliente/Resp. Pago",onClick:function(e){var o=[e.data];a.abrirModalCorregirCliente(o[0])}}}},filter:!1,width:40,cellStyle:e.validarEstado},{filter:!1,headerName:"",width:40,hide:!Pe["default"].USUARIOS_ADMIN.includes((0,Ie["default"])().usucod),cellRendererSelector:function(e){return[Pe["default"].PAGO_TIPPAG.COBRO,Pe["default"].PAGO_TIPPAG.SALIDAS].includes(e.data.TIPPAG)?void 0:{component:Ee.A,params:{icon:"table_edit",title:"Cambiar Tipo De Pago (TIPPAG)",onClick:function(e){var o=[e.data];a.cambiarTippag(o[0])}}}},cellStyle:e.validarEstado},{filter:!1,headerName:"",hide:!Pe["default"].USUARIOS_ADMIN.includes((0,Ie["default"])().usucod),cellRendererSelector:function(e){if(e.data.CODSUNAT===Pe["default"].CODSUNAT.NOTA_CREDITO)return{component:Ee.A,params:{icon:"file_edit",title:"Cambiar Motivo NC",onClick:function(e){var o=[e.data];a.cambiarMotivoNC(o[0])}}}},width:40,cellStyle:e.validarEstado},{headerName:"modified",field:"modified",hide:!0,cellStyle:e.validarEstado}),e.columnDefs=t;case 2:return o.a(2)}},o)}))()}},mounted:function(){},beforeMount:function(){this.frameworkComponents={agActionButton:Ee.A,agDate:_e.A,select:ke},this.columnDefs=[],this.rowData=[],this.cargarColumnas(),this.getTalonariosUsuario(),this.getUsuarios(),this.pagosEmitidos(),this.crearBotones(),this.getMeses(),this.getAnios(),this.getConceptos()}},xe=a(12807);const Ye=(0,xe.A)(qe,[["render",W]]);var Qe=Ye}}]);