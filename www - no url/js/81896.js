"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[81896],{81896:function(e,t,n){n.r(t),n.d(t,{default:function(){return j}});var o=n(8445),a=n.n(o),i=n(61758),s=n(58790),l={class:"row q-col-gutter-sm"},r={class:"col-xs-12 col-sm-6 col-md-2"},c={class:"col-xs-12 col-sm-6 col-md-6",style:{padding:"3px"}},u={class:"col-xs-12 col-sm-6 col-md-2"},d={class:"col-xs-12"},m={class:"col-xs-12"},f={class:"row q-pa-sm"},p={class:"col-12 q-pl-sm"},A={key:0,class:"col-12 q-pl-sm q-pt-sm"},b={style:{"font-size":"1.2rem","font-weight":"700"}},C={class:"col-12 q-pa-sm"};function g(e,t){var n=this,o=(0,i.g2)("header-btn"),g=(0,i.g2)("q-spinner-oval"),h=(0,i.g2)("q-inner-loading"),O=(0,i.g2)("q-select"),v=(0,i.g2)("sie-select"),k=(0,i.g2)("tooltip-asistencia"),D=(0,i.g2)("sie-table"),F=(0,i.g2)("q-card-section"),S=(0,i.g2)("q-card"),E=(0,i.g2)("q-tooltip"),V=(0,i.g2)("q-fab-action"),I=(0,i.g2)("q-fab"),P=(0,i.g2)("q-page-sticky"),T=(0,i.g2)("q-input"),w=(0,i.g2)("q-field"),U=(0,i.g2)("sie-modal"),L=(0,i.g2)("q-page");return(0,i.uX)(),(0,i.Wv)(L,null,{default:(0,i.k6)(function(){return[(0,i.bF)(S,null,{default:(0,i.k6)(function(){return[(0,i.bF)(o,{name:"Control de Asistencia por Curso",buttons:e.buttons},null,8,["buttons"]),(0,i.bF)(F,null,{default:(0,i.k6)(function(){return[(0,i.bF)(h,null,{default:(0,i.k6)(function(){return[(0,i.bF)(g,{size:"50px",color:"primary"})]}),_:1}),(0,i.Lk)("div",l,[(0,i.Lk)("div",r,[(0,i.bF)(O,{modelValue:e.periodo,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.periodo=t}),options:e.periodos,label:"Periodo","option-value":"DURACOD","option-label":"DURADES",onInput:e.cambiaPeriodo},null,8,["modelValue","options","onInput"])]),(0,i.Lk)("div",c,[(0,i.bF)(v,{class:"q-mb-sm",modelValue:e.cursocod,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.cursocod=t}),type:"outlined",options:e.cursos,label:"CURSODES",val:"CURSOCOD",onSelected:e.cambiarCurso,placeholder:"Curso","no-bottom":""},null,8,["modelValue","options","onSelected"])]),(0,i.Lk)("div",u,[(0,i.bF)(O,{modelValue:e.diames,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.diames=t}),options:e.optionMeses,label:"Mes",onInput:e.cambiaMes},null,8,["modelValue","options","onInput"])]),(0,i.Lk)("div",d,[(0,i.bF)(k)]),(0,i.Lk)("div",m,[(0,i.bF)(D,{"save-cells":"",selection:"single",context:n,css:"height:calc(100vh - 140px)",search:"Buscar Alumno",columns:e.columns,onRowSelected:e.rowSelected,data:e.rows,config:e.config},null,8,["columns","onRowSelected","data","config"])])])]}),_:1})]}),_:1}),(0,i.bF)(P,{position:"bottom-right",offset:[20,20]},{default:(0,i.k6)(function(){return[(0,i.bF)(I,{color:"secondary",icon:"more_vert",direction:"up"},{default:(0,i.k6)(function(){return[(0,i.bF)(V,{color:"secondary",icon:"delete"},{default:(0,i.k6)(function(){return[(0,i.bF)(E,null,{default:(0,i.k6)(function(){return a()(t[7]||(t[7]=[(0,i.eW)("Eliminar",-1)]))}),_:1})]}),_:1}),(0,i.bF)(V,{color:"secondary",icon:"plus",onClick:e.nuevo},{default:(0,i.k6)(function(){return[(0,i.bF)(E,null,{default:(0,i.k6)(function(){return a()(t[8]||(t[8]=[(0,i.eW)("Nuevo",-1)]))}),_:1})]}),_:1},8,["onClick"])]}),_:1})]}),_:1}),(0,i.bF)(U,{class:"modal-adicional",modelValue:e.modalAsistencia,"onUpdate:modelValue":t[6]||(t[6]=function(t){return e.modalAsistencia=t}),header:!0,title:"Marcar Asistencia",onSubmit:e.grabar},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",f,[(0,i.Lk)("div",p,[(0,i.bF)(k,{modelValue:e.params.ESTADO,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.params.ESTADO=t}),modal:!0,onInput:t[4]||(t[4]=function(t){return e.params.ESTADO=t})},null,8,["modelValue"])]),e.valoresAsistencia[e.params.ESTADO]?((0,i.uX)(),(0,i.CE)("div",A,[(0,i.Lk)("span",b,(0,s.v_)(e.valoresAsistencia[e.params.ESTADO].descripcion),1)])):(0,i.Q3)("v-if",!0),(0,i.Lk)("div",C,[(0,i.bF)(w,null,{default:(0,i.k6)(function(){return[(0,i.bF)(T,{class:"q-if-outlined no-bottom",type:"textarea",modelValue:e.params.OBSERVACION,"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.params.OBSERVACION=t}),"float-label":"Observación"},null,8,["modelValue"])]}),_:1})])])]}),_:1},8,["modelValue","onSubmit"])]}),_:1})}var h=n(14794),O=n.n(h),v=n(76080),k=n.n(v),D=n(57008),F=n.n(D),S=n(99550),E=n.n(S),V=n(45254),I=n.n(V),P=(n(30683),n(71225),n(23825),n(10239),n(50310),n(5962),n(90095),n(83190),n(52776),n(66307),n(81813),n(68017),n(13715),n(24066),{data:function(){var e=this;return{config2:{DELETE:{component:"button",icon:["delete as eliminar"],tooltip:{ver:"Ver",editar:"Editar",eliminar:"Eliminar"},eliminar:function(t,n){console.log(t),e.eliminarAnio(t)},flat:!0,dense:!0},A0601:{component:"button",text:"P",icon:["delete as eliminar"],tooltip:{ver:"Ver",editar:"Editar",eliminar:"Eliminar"},eliminar:function(e){console.log(e)},flat:!0,dense:!0},A0501:{renderHtml:function(e,t,n,o){return t("div",{style:{width:"30px",height:"100%"},class:["text-center","bg-primary","text-white","q-pa-sm"]},"P")},renderAction:function(e,t){},tooltip:function(e){return e.NOMCOMP}}},columns:[],columnsIni:[{name:"CODALU",label:"Código",field:"CODALU",align:"left"},{label:"Descripción",name:"NOMCOMP",field:"NOMCOMP",align:"left"}]}}}),T=n(88865),w=n(95718),U=n(30640),L=n(6123),y=n(16648),M=n(93616),q=n(57668),x=n(80660),_={registrarAsistencia:function(e){return x.$http.post("api/AsistenciaTalleresController/registrarAsistencia",{params:e})},getAsistencia:function(e,t,n){return x.$http.get("api/AsistenciaTalleresController/getAsistencia",{params:{params:{ano:e,duracod:t,cursocod:n}}})},getPeriodos:function(e){return x.$http.get("api/TablasController/getDuravac")},getCursos:function(e,t){return x.$http.get("api/AsistenciaTalleresController/getCursos",{params:{params:{ano:e,duracod:t}}})},getInscritos:function(e,t,n){return x.$http.get("api/AsistenciaTalleresController/getAlumnosInscritos",{params:{params:{ano:e,duracod:t,cursocod:n}}})},getAnios:function(e){return x.$http.get("api/MantenimientoController/getAniovac",{params:{params:{tipo:e}}})},grabarAnio:function(e){return x.$http.post("api/MantenimientoController/grabarAnio",{data:e})},updateAnioVac:function(e){return x.$http.post("api/MantenimientoController/updateAnioVac",{data:e,ANO:e.ANO})},deleteAnio:function(e){return x.$http.delete("api/MantenimientoController/deleteAnioVac",{params:{ANO:e}})}};function N(e,t){var n=(0,i.g2)("q-tooltip"),o=(0,i.g2)("q-btn");return(0,i.uX)(),(0,i.CE)("div",null,[(0,i.bF)(o,{class:(0,s.C4)(["q-mr-xs",e.getClase("P")]),size:"sm",style:{background:"#b6dff4"},label:"P",tooltip:"Presente",flat:"",onClick:t[0]||(t[0]=function(t){return e.btnClick("P")})},{default:(0,i.k6)(function(){return[(0,i.bF)(n,{anchor:"top middle",self:"top middle"},{default:(0,i.k6)(function(){return a()(t[8]||(t[8]=[(0,i.eW)("Presente",-1)]))}),_:1})]}),_:1},8,["class"]),(0,i.bF)(o,{class:(0,s.C4)(["q-mr-xs",e.getClase("R")]),size:"sm",style:{background:"#EBE76B"},label:"TI",tooltip:"Presente",flat:"",onClick:t[1]||(t[1]=function(t){return e.btnClick("R")})},{default:(0,i.k6)(function(){return[(0,i.bF)(n,{anchor:"top middle",self:"top middle"},{default:(0,i.k6)(function(){return a()(t[9]||(t[9]=[(0,i.eW)("Tardanza Injustificada",-1)]))}),_:1})]}),_:1},8,["class"]),(0,i.bF)(o,{class:(0,s.C4)(["q-mr-xs",e.getClase("Z")]),size:"sm",style:{background:"#FF9F0F"},label:"TJ",tooltip:"Presente",flat:"",onClick:t[2]||(t[2]=function(t){return e.btnClick("Z")})},{default:(0,i.k6)(function(){return[(0,i.bF)(n,{anchor:"top middle",self:"top middle"},{default:(0,i.k6)(function(){return a()(t[10]||(t[10]=[(0,i.eW)("Tardanza Justificada",-1)]))}),_:1})]}),_:1},8,["class"]),(0,i.bF)(o,{class:(0,s.C4)(["q-mr-xs",e.getClase("F")]),size:"sm",style:{background:"#CC0C15"},label:"FI",tooltip:"Presente",flat:"",onClick:t[3]||(t[3]=function(t){return e.btnClick("F")})},{default:(0,i.k6)(function(){return[(0,i.bF)(n,{anchor:"top middle",self:"top middle"},{default:(0,i.k6)(function(){return a()(t[11]||(t[11]=[(0,i.eW)("Falta injustificada",-1)]))}),_:1})]}),_:1},8,["class"]),(0,i.bF)(o,{class:(0,s.C4)(["q-mr-xs",e.getClase("J")]),size:"sm",style:{background:"#45BE6A"},label:"FJ",tooltip:"Presente",flat:"",onClick:t[4]||(t[4]=function(t){return e.btnClick("J")})},{default:(0,i.k6)(function(){return[(0,i.bF)(n,{anchor:"top middle",self:"top middle"},{default:(0,i.k6)(function(){return a()(t[12]||(t[12]=[(0,i.eW)("Falta justificada",-1)]))}),_:1})]}),_:1},8,["class"]),(0,i.bF)(o,{class:(0,s.C4)(["q-mr-xs",e.getClase("S")]),size:"sm",style:{background:"#555555"},label:"S",tooltip:"Presente",flat:"",onClick:t[5]||(t[5]=function(t){return e.btnClick("S")})},{default:(0,i.k6)(function(){return[(0,i.bF)(n,{anchor:"top middle",self:"top middle"},{default:(0,i.k6)(function(){return a()(t[13]||(t[13]=[(0,i.eW)("Suspensión",-1)]))}),_:1})]}),_:1},8,["class"]),(0,i.bF)(o,{class:(0,s.C4)(["q-mr-xs",e.getClase("V")]),size:"sm",style:{background:"#64f4c5"},label:"PV",tooltip:"Presente",flat:"",onClick:t[6]||(t[6]=function(t){return e.btnClick("V")})},{default:(0,i.k6)(function(){return[(0,i.bF)(n,{anchor:"top middle",self:"top middle"},{default:(0,i.k6)(function(){return a()(t[14]||(t[14]=[(0,i.eW)("Presente Injustificado Virtual",-1)]))}),_:1})]}),_:1},8,["class"]),(0,i.bF)(o,{size:"sm",style:{background:"#64f4c5"},label:"PP",tooltip:"Presente",flat:"",onClick:t[7]||(t[7]=function(t){return e.btnClick("E")}),class:(0,s.C4)(e.getClase("E"))},{default:(0,i.k6)(function(){return[(0,i.bF)(n,{anchor:"top middle",self:"top middle"},{default:(0,i.k6)(function(){return a()(t[15]||(t[15]=[(0,i.eW)("Presente Injustificado Presencial",-1)]))}),_:1})]}),_:1},8,["class"]),(0,i.Q3)('q-btn( icon="comment"  inverse flat @click="btnClick")q-tooltip( anchor="top middle" self="top middle") Observación')])}var Q={emits:["update:modelValue","input"],props:{modal:{type:Boolean,default:!1},modelValue:{type:String}},components:{QBtn:L.Il,QTooltip:L.nC,sieSelect:M.A,QFab:L.l6,QFabAction:L.B$,QPageSticky:L._U,QSelect:y.A,QItemSection:T.A,QCardSection:w.A,QInnerLoading:L.SQ,sieModal:U.A,QSpinnerOval:L.VA},data:function(){return{periodo:null}},computed:{currentValue:{get:function(){return this.modelValue},set:function(e){this.$emit("update:modelValue",e),this.$emit("input",e)}}},methods:{btnClick:function(e){console.log(e),this.currentValue=e},getClase:function(e){return{"boton-elejido":this.modal&&e===this.modelValue,"boton-noelejido":this.modal&&e!==this.modelValue}},created:function(){console.log("this.value",this.modelValue)}}},R=n(12807);const B=(0,R.A)(Q,[["render",N]]);var $=B,z={components:{TooltipAsistencia:$,sieSelect:M.A,QBtn:L.Il,QFab:L.l6,QFabAction:L.B$,QPageSticky:L._U,QSelect:y.A,QItemSection:T.A,QCardSection:w.A,QInnerLoading:L.SQ,sieModal:U.A,QSpinnerOval:L.VA,QPage:L.Tu,QCard:L.C$,QTooltip:L.nC,QField:L.Om,QInput:L.ie},mixins:[P],data:function(){return{params:{ESTADO:null,OBSERVACION:null,ALUCOD:null,FECHA:""},auxColumns:[],config:{},currentRow:{},modalAsistencia:!1,periodo:null,cursocod:null,diames:"T",optionMeses:[{value:"T",label:"Todos"}],diamesOptions:[{label:"Mes",value:"M"},{label:"Día",value:"D"}],periodos:[],cursos:[],rows:[],valoresAsistencia:{P:{color:"#b6dff4",estado:"P",descripcion:"Presente"},R:{color:"#EBE76B",estado:"TI",descripcion:"Tardanza Injustificada"},Z:{color:"#FF9F0F",estado:"TJ",descripcion:"Tardanza Justificada"},F:{color:"#CC0C15",estado:"FI",descripcion:"Falta Injustificada"},J:{color:"#45BE6A",estado:"FJ",descripcion:"Falta justificada"},S:{color:"#555555",estado:"S",descripcion:"Suspensión"},V:{color:"#64f4c5",estado:"PV",descripcion:"Presente Injustificado Virtual"},E:{color:"#64f4c5",estado:"PP",descripcion:"Presente Injustificado Presencial"},"-":{color:"#FFF",estado:"-",descripcion:""}},sie:(0,q["default"])(),rowAno:{ANO:"",DES:"",VIGENTE:""},sino:[{label:"Si",value:"S"},{label:"No",value:"N"}],modalAgregar:!1,dataAlumno:[],buttons:[{icon:"cogs",label:"Procesar",click:this.procesar}],tipoAlumnos:[{label:"Matriculados",value:"S"},{label:"Todos",value:"T"},{label:"Matriculados y Nuevos",value:"MN"}],tipoAlumno:"S"}},computed:{},methods:{btnClick:function(){},cambiaMes:function(e){var t=this,n=a()(this.auxColumns);this.columns="T"===e?n:n.filter(function(e){return!e.mes||e.mes===t.diames})},eligeEstado:function(e){this.params.ESTADO=e},cambiarCurso:function(e){var t=this;return I()(k()().m(function n(){var o,i,s,l,r,c,u,d,m,f,p,A,b,C,g,h,v,D,S,V;return k()().w(function(n){while(1)switch(n.n){case 0:return t.currentRow=e,o={},i=new Date(e.FECINI),s=new Date(e.FECFIN),l={0:"Dom",1:"Lun",2:"Mar",3:"Mie",4:"Jue",5:"Vie",6:"Sáb"},r={1:"DIALU",2:"DIAMA",3:"DIAMI",4:"DIAJU",5:"DIAVI",6:"DIASA",0:"DIADO"},c={"01":"Enero","02":"Febrero","03":"Marzo","04":"Abril","05":"Mayo","06":"Junio","07":"Julio","08":"Agosto","09":"Setiembre",10:"Octubre",11:"Noviembre",12:"Diciembre"},n.n=1,_.getAsistencia(t.sie.ano,t.periodo,t.cursocod);case 1:return u=n.v,d={},m=[{value:"T",label:"Todos"}],u.forEach(function(e){var t=e.FECHA?e.FECHA.split("T"):[""],n=E()(t,1),a=n[0],i=a.split("-"),s=E()(i,3),l=s[0],r=s[1],c=s[2];o.hasOwnProperty(e.ALUCOD)||(o[e.ALUCOD]={}),d.hasOwnProperty(e.ALUCOD)||(d[e.ALUCOD]={}),d.hasOwnProperty(e.ALUCOD)||(d[e.ALUCOD]={}),o[e.ALUCOD]["A"+c+"-"+r+"-"+l]=e.ESTADO,d[e.ALUCOD]["A"+c+"-"+r+"-"+l]=e}),f=i,p=[],A=a()(t.columnsIni),b={},n.n=2,_.getInscritos(t.sie.ano,t.periodo,t.cursocod);case 2:for(C=n.v,g=0;g<C.length;g++)h=C[g],o[h.CODALU]?(h=F()(F()(F()({},C[g]),b),o[h.CODALU]),v=d[h.CODALU].ESTADO,h.ESTADO=v,h.OBSERVACION=d[h.CODALU].OBSERVACION):h=F()(F()({},C[g]),b),C[g]=h;D=[],S={},V=k()().m(function n(){var o,a,i,s,u,C,g,h,O,v;return k()().w(function(n){while(1)switch(n.n){case 0:o=f.getFullYear()+"",a=f.getMonth()+1,i=f.getDate(),s="0".concat(i).substr(-2),u="0".concat(a).substr(-2),C=f.getDay(),g=l[C]+" "+s+"/"+u,h=t,"S"===e[r[C]]&&(D.hasOwnProperty(u)||(D[u]={},m.push({value:u,label:c[u]})),p.push({fechaTexto:g}),O="A"+s+"-"+u+"-"+o,v={name:O,label:g,field:O,mes:u,align:"left"},b[O]="-",A.push(v),S[O]={renderHtml:function(e,t,n,o){var a=d[e.CODALU]&&d[e.CODALU][O]?d[e.CODALU][O].ESTADO:"-",i=h.valoresAsistencia[a]?h.valoresAsistencia[a]:{};return t("div",{style:{width:"30px",height:"100%",textAlign:"center",borderRadius:"2px",padding:"4px",background:i.color}},i.estado)},renderAction:function(e){var t=d[e.CODALU]&&d[e.CODALU][O]?d[e.CODALU][O]:null,n=O.replace("A",""),o=n.split("-"),a=E()(o,3),i=a[0],s=a[1],l=a[2];this.params.ALUCOD=e.CODALU,this.params.PROALU=e.PROALU.trim(),this.params.FECHA=l+"-"+s+"-"+i,t?(this.params.ID=t.ID,this.params.OBSERVACION=t.OBSERVACION,this.params.ESTADO=t.ESTADO):(delete this.params.ID,this.params.OBSERVACION=null,this.params.ESTADO=null),this.modalAsistencia=!0},tooltip:function(e){var t=d[e.CODALU]&&d[e.CODALU][O]?d[e.CODALU][O]:{},n=h.valoresAsistencia[t.ESTADO]?h.valoresAsistencia[t.ESTADO].descripcion:"";return n=t.OBSERVACION?n+":\n "+t.OBSERVACION:n,n}}),f.setDate(f.getDate()+1);case 1:return n.a(2)}},n)});case 3:if(!(f.getTime()<=s.getTime())){n.n=5;break}return n.d(O()(V()),4);case 4:n.n=3;break;case 5:console.log("optionMeses:",m),t.optionMeses=[].concat(m),t.config=S,t.columns=A,t.auxColumns=a()(A),console.log("auxColumns:",t.auxColumns),t.rows=C;case 6:return n.a(2)}},n)}))()},cambiaPeriodo:function(){this.getCursos()},actualizarCampo:function(e){var t=this;_.updateAnioVac(e).then(function(e){t.getAnios(),t.$notify(e.message,"success")})},getPeriodos:function(){var e=this;return I()(k()().m(function t(){return k()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,_.getPeriodos();case 1:e.periodos=t.v;case 2:return t.a(2)}},t)}))()},getCursos:function(){var e=this;return I()(k()().m(function t(){return k()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,_.getCursos(e.sie.ano,e.periodo);case 1:e.cursos=t.v;case 2:return t.a(2)}},t)}))()},nuevo:function(){this.modalAgregar=!0},eliminarAnio:function(e){var t=this;_.deleteAnio(e.ANO).then(function(e){t.getAnios(),t.$notify(e.message,"success")})},grabar:function(){var e=this;return I()(k()().m(function t(){var n;return k()().w(function(t){while(1)switch(t.n){case 0:if(n=F()({},e.params),n.DURACOD=e.periodo,n.CURSOCOD=e.cursocod,n.ANO=e.sie.ano,e.params.ESTADO){t.n=1;break}return t.a(2,e.$notify("Debe Marcar la asistencia","warning"));case 1:_.registrarAsistencia(n).then(function(t){e.$notify(t.message,"success"),e.modalAsistencia=!1,e.cambiarCurso(e.currentRow)}).catch(function(t){var n=t.error;e.$notify(n.message,"warning")});case 2:return t.a(2)}},t)}))()},rowSelected:function(){},getAnios:function(){var e=this;return I()(k()().m(function t(){return k()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,_.getAnios("");case 1:e.dataAlumno=t.v;case 2:return t.a(2)}},t)}))()}},created:function(){this.getPeriodos()}};const J=(0,R.A)(z,[["render",g]]);var j=J}}]);