"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[21881],{21881:function(e,o,t){t.r(o),t.d(o,{default:function(){return P}});var a=t(61758),n={class:"consultar-documento item-border"},r={class:"row q-pa-sm q-col-gutter-sm border-top-none border-bottom-none default-margin"},i={class:"col-xs-12 padding-r-8"},c={class:"col-xs-6 padding-r-8 item-before-separator"},l={class:"col-xs-6 padding-r-8"},s={class:"col-xs-6 padding-r-8"},u={class:"col-xs-6 padding-r-8"},d={class:"row q-pa-sm flex justify-center items-center"},m={class:"col-xs-8 flex justify-end"},p={class:"col-xs-4"};function f(e,o){var t=(0,a.g2)("q-select"),f=(0,a.g2)("q-input"),h=(0,a.g2)("q-date"),v=(0,a.g2)("q-popup-proxy"),g=(0,a.g2)("q-icon"),b=(0,a.g2)("q-option-group"),w=(0,a.g2)("q-btn"),k=(0,a.g2)("q-card-section");return(0,a.uX)(),(0,a.Wv)(k,{class:"flex justify-evenly items-center main-section column"},{default:(0,a.k6)(function(){return[o[11]||(o[11]=(0,a.Lk)("h4",{class:"text-title"},"SIEWEB",-1)),(0,a.Lk)("div",n,[o[10]||(o[10]=(0,a.Lk)("div",{class:"row q-pa-sm q-col-gutter-sm head-form"},[(0,a.Lk)("div",{class:"col-xs-12"},[(0,a.Lk)("span",{class:"head-form-title text-center"},"Consultar Comprobante Electrónico")]),(0,a.Lk)("div",{class:"q-pa-sm q-col-gutter-sm"},[(0,a.Lk)("p",{class:"span-info"},"Señor Contribuyente , a través de esta consulta, Usted podrá consultar la validez de la Factura Electrónica, la Boleta de Venta Electrónica, las Notas Electrónicas vinculadas.")])],-1)),(0,a.Lk)("div",r,[(0,a.Lk)("div",i,[(0,a.bF)(t,{class:"truncate-label",label:"Tipo de documento",options:e.tipoDocumento,modelValue:e.formulario.codigo,"onUpdate:modelValue":o[0]||(o[0]=function(o){return e.formulario.codigo=o}),onInput:e.validarButtons},null,8,["options","modelValue","onInput"])]),(0,a.Lk)("div",c,[(0,a.bF)(f,{label:"Serie",modelValue:e.formulario.documento,"onUpdate:modelValue":o[1]||(o[1]=function(o){return e.formulario.documento=o}),maxlength:e.maxLeng.documento,onInput:o[2]||(o[2]=function(o){return e.maxlengthNumeroDocumento("numero")})},null,8,["modelValue","maxlength"])]),(0,a.Lk)("div",l,[(0,a.bF)(f,{label:"Número",modelValue:e.formulario.numero,"onUpdate:modelValue":o[3]||(o[3]=function(o){return e.formulario.numero=o}),maxlength:e.maxLeng.numero,onInput:o[4]||(o[4]=function(o){return e.maxlengthNumeroDocumento("documento")})},null,8,["modelValue","maxlength"])]),(0,a.Lk)("div",s,[(0,a.bF)(f,{placeholder:"dd/mm/yyyy","reverse-fill-mask":"",modelValue:e.formulario.fecha_emision,"onUpdate:modelValue":o[7]||(o[7]=function(o){return e.formulario.fecha_emision=o}),maxlength:"10",mask:"##/##/####",label:"Fecha Emisión"},{append:(0,a.k6)(function(){return[(0,a.bF)(g,{class:"cursor-pointer",name:"date_range"},{default:(0,a.k6)(function(){return[(0,a.bF)(v,{ref:"qDateProxy","transition-show":"scale","transition-hide":"scale"},{default:(0,a.k6)(function(){return[(0,a.bF)(h,{mask:"DD/MM/YYYY",modelValue:e.formulario.fecha_emision,"onUpdate:modelValue":o[5]||(o[5]=function(o){return e.formulario.fecha_emision=o}),onInput:o[6]||(o[6]=function(o){return e.closeCalendar("qDateProxy")})},null,8,["modelValue"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])]),(0,a.Lk)("div",u,[(0,a.bF)(f,{label:"Monto Total(*)",modelValue:e.formulario.monto,"onUpdate:modelValue":o[8]||(o[8]=function(o){return e.formulario.monto=o}),mask:"#.##","fill-mask":"0","reverse-fill-mask":"",hint:"Mask: #.##","input-class":"text-right"},null,8,["modelValue"])])]),(0,a.Lk)("div",d,[(0,a.Lk)("div",m,[(0,a.bF)(b,{class:"full-width",options:e.dataArchivo,type:"radio",inline:"",color:"primary",modelValue:e.archivo,"onUpdate:modelValue":o[9]||(o[9]=function(o){return e.archivo=o})},null,8,["options","modelValue"])]),(0,a.Lk)("div",p,[(0,a.bF)(w,{class:"full-width",color:e.disableButtons?"grey-8":"secondary",label:"Buscar",icon:"search",disable:e.disableButtons,onClick:e.submit,size:"md"},null,8,["color","disable","onClick"])])])]),o[12]||(o[12]=(0,a.Lk)("input",{type:"hidden",value:"",id:"token",name:"token"},null,-1))]}),_:1})}var h=t(8445),v=t.n(h),g=t(76080),b=t.n(g),w=t(45254),k=t.n(w),A=(t(34634),t(30683),t(23825),t(56285),t(50310),t(9240),t(11777),t(515),t(83190),t(27153),t(52776),t(88390),t(66307),t(38538),t(81813),t(7346),t(906),t(27360),t(24066),t(60858),t(64702),t(53514),t(57053),t(94013),t(32701),t(67396),t(50923),t(59502),t(88567)),x=t(95718),C=t(53380),L=t(54489),T=t(12143),V=t(80660),D=t(36408),y=t(27560),B=t(96330),E=(t(78840),t(57668)),S=t(75053),F=t(64208),I=(t(54267),t(6123)),U=t(95477),q=t(3112),M=t(41615),N=(t(42037),t(18105),t(64303)),_=t(7968),O=(t(81288),t(38739)),R={components:{headerGrid:B.A,sieGrid:D.A,footerGrid:y.A,QCard:A.A,QCardSection:x.A,QSelect:L.S,QSeparator:C.A,sieModal:S.A,QInput:F.A,QDate:T.A,QPopupProxy:U.A,QDatetime:I.T5,QCheckbox:q.A,crearBotones:N.A,listarSedes:_.A,QOptionGroup:O.A,QIcon:I.bP,QBtn:I.Il},props:{siscod:{type:Number,default:26}},data:function(){var e=4,o=8;return{tipoDocumento:[{label:"Boleta de Venta",value:"03"},{label:"Factura",value:"01"},{label:"Nota de Crédito",value:"07"},{label:"Nota de Débito",value:"08"}],sieInfo:(0,E["default"])(),colegio:"",maxLeng:{documento:e,numero:o},formulario:{monto:"0.00",documento:"#".repeat(e),numero:"#".repeat(o),codigo:"03",fecha_emision:M["default"].CURRENT_DAY},disableButtons:!0,TESORERIA:26,apis:{tesoreria:"api/TesoreriaServiciosController/postDescargarArchivoComprobante",default:"/servicios-pensiones/obtener-electronico-remoto",capcha:"api/TesoreriaServiciosController/postValidarCapcha",dowload:"api/TesoreriaServiciosController/getDownloadField"},archivo:"pdf",dataArchivo:[{label:"PDF",value:"pdf"},{label:"XML",value:"xml"}]}},methods:{closeCalendar:function(e){this.$refs[e].hide()},generarToken:function(){return k()(b()().m(function e(){return b()().w(function(e){while(1)switch(e.n){case 0:if(window.grecaptcha&&window.grecaptcha.enterprise){e.n=1;break}return console.error("reCAPTCHA no se ha cargado correctamente"),e.a(2);case 1:window.grecaptcha.enterprise.ready(k()(b()().m(function e(){var o,t;return b()().w(function(e){while(1)switch(e.p=e.n){case 0:return e.p=0,e.n=1,window.grecaptcha.enterprise.execute("6LdMGjMjAAAAAKaiDtmAm7M0XI7HxsplbB1VUNzp",{action:"login"});case 1:if(o=e.v,!o){e.n=2;break}return document.getElementById("token").value=o,e.n=2,V.$http.post("api/TesoreriaServiciosController/postValidarCapcha",{token:o});case 2:e.n=4;break;case 3:e.p=3,t=e.v,console.error("Error al generar token reCAPTCHA:",t);case 4:return e.a(2)}},e,null,[[0,3]])})));case 2:return e.a(2)}},e)}))()},validarCapch:function(){var e=this;return k()(b()().m(function o(){var t,a,n;return b()().w(function(o){while(1)switch(o.n){case 0:return t=document.getElementById("token").value,o.n=1,V.$http.post(e.apis.capcha,{token:t});case 1:a=o.v,n=JSON.parse(a.data),n.success||(alert("Tiempo Agotado..."),location.reload());case 2:return o.a(2)}},o)}))()},timeCapcha:function(){var e=this;return k()(b()().m(function o(){return b()().w(function(o){while(1)switch(o.n){case 0:setTimeout(function(){e.validarCapch()},3e5);case 1:return o.a(2)}},o)}))()},validarTesoreria:function(){var e=this;return k()(b()().m(function o(){var t,a,n;return b()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,V.$http.get("api/ConstanteSistemaController/getSistemasPorCodigo",{params:{params:{SISCOD:e.TESORERIA}}});case 1:t=o.v,t&&t.length>0&&(a=v()(t),n=a[0],e.sistemaTesoreria=1===Number(n.ESTADO));case 2:return o.a(2)}},o)}))()},maxlengthNumeroDocumento:function(e){var o=this.formulario,t=this.maxLeng[e];o[e].length>t&&(o[e]=o[e].substring(0,t)),this.validarButtons()},validarButtons:function(){var e=this.formulario;this.disableButtons=Object.keys(e).some(function(o){return!e[o]})},descargarArchivo:function(e){var o=this;return k()(b()().m(function t(){var a,n,r;return b()().w(function(t){while(1)switch(t.p=t.n){case 0:return t.p=0,t.n=1,V.$http.post(o.apis.tesoreria,{datos:e});case 1:a=t.v,n=atob(a),window.open("".concat(location.origin,"/lms/").concat(o.apis.dowload,"?token=").concat(btoa(n))),o.disableButtons=!1,t.n=3;break;case 2:t.p=2,r=t.v,o.$alert(r.message,"warning"),o.disableButtons=!1;case 3:return t.p=3,o.disableButtons=!1,t.f(3);case 4:return t.a(2)}},t,null,[[0,2,3,4]])}))()},submit:function(){return this.sistemaTesoreria?this.consultarDocumentoTesoreria(this.archivo):this.consultarDocumento(this.archivo)},obtenerFecha:function(){var e=this;return k()(b()().m(function o(){return b()().w(function(o){while(1)switch(o.n){case 0:return o.a(2,e.formulario.fecha_emision.replace(/[/]/g,"."))}},o)}))()},consultarDocumento:function(e){var o=this;return k()(b()().m(function t(){var a,n,r,i,c,l,s;return b()().w(function(t){while(1)switch(t.n){case 0:return n=o.formulario.codigo.substring(0,2),r=o.formulario.documento,i=o.formulario.numero,t.n=1,o.obtenerFecha();case 1:c=t.v,l=o.formulario.monto,s=e,a={tipo_documento:n,prefijo_documento:r,numero_documento:i,fecha_emision:c,monto_total:l,formato:s},V.$http.post(o.apis.default,{params:a}).then(function(o){1!==Number(o.data.status)&&alert(o.data.message);var t=document.createElement("a"),a="pdf"===e?"data:application/pdf;base64,".concat(o.data.file):new Blob([o.data.file],{type:"text/xml;charset=utf-8;"});t.href="pdf"===e?a:URL.createObjectURL(a),t.download=o.data.name,t.click(),"xml"===e&&setTimeout(function(){return URL.revokeObjectURL(t.href)},100)}).catch(function(e){alert(e.message)});case 2:return t.a(2)}},t)}))()},consultarDocumentoTesoreria:function(e){var o=this;return k()(b()().m(function t(){var a,n,r,i,c,l,s;return b()().w(function(t){while(1)switch(t.n){case 0:return o.disableButtons=!0,n=o.formulario.codigo.substring(0,2)||"",r=o.formulario.documento||"",i=o.formulario.numero||"",t.n=1,o.obtenerFecha();case 1:return c=t.v,l=o.formulario.monto,s=e,a={CODSUNAT:n,SERIE:r,NUMPAG:i,FECEMI:c,MONTO:l,FORMATO:s},t.a(2,o.descargarArchivo(a))}},t)}))()},cargarRecaptcha:function(){return new Promise(function(e){if(window.grecaptcha)e();else{var o=document.createElement("script");o.src="https://www.google.com/recaptcha/enterprise.js?render=6LdMGjMjAAAAAKaiDtmAm7M0XI7HxsplbB1VUNzp",o.onload=e,document.head.appendChild(o)}})}},beforeMount:function(){var e=this;return k()(b()().m(function o(){var t;return b()().w(function(o){while(1)switch(o.n){case 0:t=location.host.split(".").at(0),e.colegio=t.replace(t.at(0),t.at(0).toUpperCase());case 1:return o.a(2)}},o)}))()},mounted:function(){var e=this;return k()(b()().m(function o(){return b()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,e.cargarRecaptcha();case 1:return e.generarToken(),setTimeout(function(){e.timeCapcha()},100),o.n=2,e.validarTesoreria();case 2:return o.a(2)}},o)}))()}},j=t(12807);const Q=(0,j.A)(R,[["render",f]]);var P=Q}}]);