"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[76753],{76753:function(e,n,t){t.r(n),t.d(n,{default:function(){return J}});var i=t(61758),r=t(58790),a={class:"row q-col-gutter-sm items-center"},o={class:"col-md-3 col-xs-12"},l={class:"row col-xs-3"},s={key:0,class:"col-md-1 col-xs-12 row q-gutter-sm items-center"},c={class:"col"},u={class:"col-md-3 col-xs-12 row q-gutter-sm items-center"},d={class:"col"},m={class:"col"},f={class:"q-mt-sm"},p={class:"q-pa-lg"},h={class:"row q-col-gutter-lg"},b={key:0,class:"col-12"},A={key:1,class:"col-12"},g={class:"col-12"},E={class:"col-12"};function v(e,n){var t=this,v=(0,i.g2)("header-btn"),O=(0,i.g2)("q-input"),R=(0,i.g2)("q-select"),S=(0,i.g2)("sie-ngs"),w=(0,i.g2)("q-datetime"),C=(0,i.g2)("q-btn"),T=(0,i.g2)("sie-table"),k=(0,i.g2)("q-radio"),I=(0,i.g2)("sie-modal"),N=(0,i.g2)("q-card-section"),D=(0,i.g2)("envio-alerta"),F=(0,i.g2)("q-card"),V=(0,i.g2)("q-page");return(0,i.uX)(),(0,i.Wv)(V,{class:"q-pa-sm ficha_atencion--consulta"},{default:(0,i.k6)(function(){return[(0,i.bF)(F,{dense:"",flat:"",bordered:""},{default:(0,i.k6)(function(){return[(0,i.bF)(v,{name:e.title,buttons:e.buttons},null,8,["name","buttons"]),(0,i.bF)(N,null,{default:(0,i.k6)(function(){return[(0,i.Lk)("div",a,[(0,i.Lk)("div",o,[(0,i.bF)(O,{modelValue:e.form.nombre,"onUpdate:modelValue":n[0]||(n[0]=function(n){return e.form.nombre=n}),label:"Nombres"},null,8,["modelValue"])]),(0,i.Lk)("div",{class:(0,r.C4)(["col-xs-12",{"col-md-2":e.esSedes,"col-md-3":!e.esSedes}])},[(0,i.bF)(R,{modelValue:e.form.tipo,"onUpdate:modelValue":n[1]||(n[1]=function(n){return e.form.tipo=n}),label:"Paciente",options:e.tipoPaciente},null,8,["modelValue","options"])],2),(0,i.Lk)("div",l,[(0,i.bF)(S,{class:"col-md-12 col-xs-6 row q-gutter-sm items-center",ref:"refNsg",precargarGrado:!0,"show-seccion":!1,"class-nivel":"col","class-grado":"col"},null,512)]),e.esSedes?((0,i.uX)(),(0,i.CE)("div",s,[(0,i.Lk)("div",c,[(0,i.bF)(R,{modelValue:e.form.empcod,"onUpdate:modelValue":n[2]||(n[2]=function(n){return e.form.empcod=n}),label:"Sede de atención",options:e.listaSedes},null,8,["modelValue","options"])])])):(0,i.Q3)("v-if",!0),(0,i.Lk)("div",u,[(0,i.Lk)("div",d,[(0,i.bF)(w,{modelValue:e.form.fecIni,"onUpdate:modelValue":n[3]||(n[3]=function(n){return e.form.fecIni=n}),label:"De","only-picker":"","hide-bottom-space":""},null,8,["modelValue"])]),(0,i.Lk)("div",m,[(0,i.bF)(w,{modelValue:e.form.fecFin,"onUpdate:modelValue":n[4]||(n[4]=function(n){return e.form.fecFin=n}),label:"Hasta","only-picker":"","hide-bottom-space":""},null,8,["modelValue"])]),(0,i.bF)(C,{icon:"search",dense:"",flat:"",round:"",size:"md",onClick:e.buscarAtenciones},null,8,["onClick"])])]),(0,i.Lk)("div",f,[(0,i.bF)(T,{class:"sie-table_alto","row-key":"id",data:e.rows,config:e.config,columns:e.fields,selection:"single",context:t,dense:"",flat:"",bordered:"","wrap-cells":""},null,8,["data","config","columns"])]),(0,i.bF)(I,{title:"Imprimir",modelValue:e.imprimirTipo,"onUpdate:modelValue":n[9]||(n[9]=function(n){return e.imprimirTipo=n}),ok:"imprimir",css:{width:"300px"},onSubmit:e.imprimirDetalle},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",p,[(0,i.Lk)("div",h,[e.esLista?(0,i.Q3)("v-if",!0):((0,i.uX)(),(0,i.CE)("div",b,[(0,i.bF)(k,{val:"fichaAtencion",modelValue:e.tipoReporte,"onUpdate:modelValue":n[5]||(n[5]=function(n){return e.tipoReporte=n}),label:"Imprimir Ficha de Atención"},null,8,["modelValue"])])),!e.esLista&&e.tieneFichaAutorizacionSalida?((0,i.uX)(),(0,i.CE)("div",A,[(0,i.bF)(k,{val:"autorizacion",modelValue:e.tipoReporte,"onUpdate:modelValue":n[6]||(n[6]=function(n){return e.tipoReporte=n}),label:"Imprimir Autorización"},null,8,["modelValue"])])):(0,i.Q3)("v-if",!0),(0,i.Lk)("div",g,[(0,i.bF)(k,{val:"reporteDiario",modelValue:e.tipoReporte,"onUpdate:modelValue":n[7]||(n[7]=function(n){return e.tipoReporte=n}),label:"Imprimir Reporte Diario"},null,8,["modelValue"])]),(0,i.Lk)("div",E,["reporteDiario"===e.tipoReporte?((0,i.uX)(),(0,i.Wv)(w,{key:0,modelValue:e.diaElegido,"onUpdate:modelValue":n[8]||(n[8]=function(n){return e.diaElegido=n}),label:"Fecha","only-picker":""},null,8,["modelValue"])):(0,i.Q3)("v-if",!0)])])])]}),_:1},8,["modelValue","onSubmit"])]}),_:1}),(0,i.bF)(D,{modelValue:e.modalEnviarAlerta,"onUpdate:modelValue":n[10]||(n[10]=function(n){return e.modalEnviarAlerta=n}),title:"SieWeb Médico",onAceptar:e.enviarCorreo,nroatencion:e.nroatencion},null,8,["modelValue","onAceptar","nroatencion"])]}),_:1})]}),_:1})}var O=t(8445),R=t.n(O),S=t(76080),w=t.n(S),C=t(45254),T=t.n(C),k=(t(30683),t(71225),t(39866),t(52133),t(10239),t(50310),t(5962),t(6724),t(83190),t(6123)),I=t(88567),N=t(95718),D=t(30545),F=t(9736),V=t(16648),L=t(99515),y=t(57008),P=t.n(y),_=(t(77507),t(68017),t(80660)),H={getAtenciones:function(e){return T()(w()().m(function n(){var t;return w()().w(function(n){while(1)switch(n.n){case 0:return n.n=1,_.$http.get("api/FichaAtencionController/getAtencionesPorFecha/",{params:{params:e}});case 1:return t=n.v,t.map(function(e){e.HORING=e.HORING.substring(0,2)+":"+e.HORING.substring(2,4),e.HORSAL=e.HORSAL.substring(0,2)+":"+e.HORSAL.substring(2,4),e.NGS="0000"===e.CODTIPPER?e.INSTRUCOD+e.GRADOCOD+e.SECCIONCOD:"-";var n="";switch(e.ENVIA){case 1:n="Aula";break;case 2:n="Casa";break;case 3:n="Clínica";break}e.DESTINO=n}),n.a(2,t)}},n)}))()},anular:function(e){return T()(w()().m(function n(){return w()().w(function(n){while(1)switch(n.n){case 0:return n.a(2,_.$http.post("api/FichaAtencionController/anular",{params:e}))}},n)}))()},eliminarAtencion:function(e){return T()(w()().m(function n(){return w()().w(function(n){while(1)switch(n.n){case 0:return n.a(2,_.$http.post("api/FichaAtencionController/eliminarAtencion",{params:e}))}},n)}))()},getListaSedes:function(){return T()(w()().m(function e(){var n;return w()().w(function(e){while(1)switch(e.n){case 0:return e.n=1,_.$http.get("api/FichaAtencionController/getListaSedes/",{});case 1:return n=e.v,e.a(2,n)}},e)}))()}},x={data:function(){return{config:{NROATE:{renderHtml:function(e,n,t){var i=t.icon({name:"check_box"}),r=t.icon({name:"check_box_outline_blank"}),a=n("span",{},e.NROATE),o=[a];return"0000"===e.CODTIPPER&&1===e.ENTREGO_FICHA_SEGURO&&o.unshift(i),"0000"===e.CODTIPPER&&0===e.ENTREGO_FICHA_SEGURO&&o.unshift(r),n("div",{class:["row","items-center","q-gutter-xs",o.length>1?"justify-between":"justify-end"],style:{width:"100px"}},o)},tooltip:function(e){var n=!1;return"0000"===e.CODTIPPER&&1===e.ENTREGO_FICHA_SEGURO&&(n="Entregó ficha de seguro"),"0000"===e.CODTIPPER&&0===e.ENTREGO_FICHA_SEGURO&&(n="No entregó ficha de seguro"),n}},ESTADO:{renderHtml:function(e,n,t,i){return"S"===e.ESTADO&&(i.$$background="negative"),n("span",e.ESTADO)}},CANTIDAD:{edit:!0},FECATE:{component:"date",edit:!1},CORREOS:{renderHtml:function(e,n,t){var i=0===e.ENVIO_ALERTA?t.icon({name:"error_outline"}):!!e.CORREOS&&t.icon({name:"email"});return i},renderAction:function(e){var n=this;return T()(w()().m(function t(){var i;return w()().w(function(t){while(1)switch(t.n){case 0:if(1!==e.ENVIO_ALERTA||!e.CORREOS){t.n=1;break}return i=n.correoToLista(e.CORREOS),t.n=1,n.$confirmar(i,"info",!0);case 1:return t.a(2)}},t)}))()},tooltip:function(e){return 0===e.ENVIO_ALERTA?"El usuario NO envió la alerta":e.CORREOS?"Clic para ver los correos":void 0}},ACCIONES:{component:"button",icon:["edit","mail_resend as send","printer","block","delete"],permisos:{block:">= 2",printer:"> 1",edit:">= 1",delete:"=== 3",send:">=2"},tooltip:{block:"Anular",printer:"Imprimir",edit:"Editar",delete:"Eliminar",send:"Enviar notificación"},block:function(e,n){var t=this;return T()(w()().m(function i(){var r,a,o,l,s;return w()().w(function(i){while(1)switch(i.p=i.n){case 0:return i.n=1,t.$confirmar("¿Está seguro de anular la atención?","warning");case 1:if(r=i.v,!r){i.n=5;break}return a={nroate:e.NROATE},i.p=2,i.n=3,H.anular(a);case 3:o=i.v,n.ESTADO="S",t.$notify(o,"success"),i.n=5;break;case 4:i.p=4,s=i.v,l=s.error,t.$notify(l.message,"warning");case 5:return i.a(2)}},i,null,[[2,4]])}))()},printer:function(e){this.tieneFichaAutorizacionSalida=1!==e.ENVIA,this.esLista=!1,this.imprimirTipo=!0,this.tipoReporte="fichaAtencion",this.seleccionado=P()({},e),this.imprimirTipo=!0},edit:function(e){"S"!==e.ESTADO?this.$router.push({name:"medico.fichaAtencion.ficha",params:{nroate:e.NROATE}}):this.$notify("La atención fue anulada y no es posible editar","warning")},delete:function(e){var n=this;return T()(w()().m(function t(){var i,r,a,o,l;return w()().w(function(t){while(1)switch(t.p=t.n){case 0:return t.n=1,n.$confirmar("¿Está seguro de eliminar la atención?","delete");case 1:if(i=t.v,!i){t.n=5;break}return r={nroate:e.NROATE},t.p=2,t.n=3,H.eliminarAtencion(r);case 3:a=t.v,n.$notify(a,"success"),t.n=5;break;case 4:t.p=4,l=t.v,o=l.error,n.$notify(o.message,"warning");case 5:return t.a(2)}},t,null,[[2,4]])}))()},send:function(e,n){var t=this;return T()(w()().m(function i(){return w()().w(function(i){while(1)switch(i.n){case 0:t.modalEnviarAlerta=!0,t.nroatencion=e.NROATE,t.rowRef=n;case 1:return i.a(2)}},i)}))()},validate:{send:function(e){return e.ENVIO_CORREO}},flat:!0,color:"primary"}},modalEnviarAlerta:!1,nroatencion:null,rowRef:{}}},methods:{correoToLista:function(e){var n=e.split(",").map(function(e){return e.trim()}),t='<h1 style="font-family: Arial, sans-serif; margin: 10px 0; font-size: 12px; font-weight: bold; font-style: italic; font-variant: all-petite-caps">Lista de Correos Electrónicos</h1>\n                             <ul style="list-style-type: none; padding: 0;">\n                                '.concat(n.map(function(e){return'<li style="padding: 5px 10px; margin: 5px 0; background-color: #f9f9f9; border: 1px solid #ddd; border-radius: 5px; font-variant-caps: all-petite-caps">'.concat(e,"</li>")}).join(""),"\n                             </ul>");return t}}},G=t(33777),$=t(50304),q=t(30640),M=t(2819),U=t(36667),Q=t(10003),z=t(81288),X=t(57668),Y=t(26319),j={mixins:[x],props:{tipoconsulta:{type:String}},components:{QCard:I.A,QCardSection:N.A,sieTable:G.A,QRadio:L.A,QDatetime:$.A,sieModal:q.A,QTable:D.A,QInput:F.A,QSelect:V.A,EnvioAlerta:Q.A,sieNgs:U.A,QPage:k.Tu,QBtn:k.Il},data:function(){var e=this;return{seleccionado:null,esLista:!1,esSedes:["0084"].includes((0,X["default"])().colcod),tieneFichaAutorizacionSalida:!1,imprimirTipo:!1,tipoReporte:"fichaAtencion",diaElegido:new Date,del:new Date,al:new Date,eliminados:[],title:"Consultar Atenciones",rows:[],isHoy:["0170"].includes((0,X["default"])().colcod),listaSedes:[],tipoPaciente:[{label:"Todos",value:"%"},{label:"Alumno",value:"0000"},{label:"Familia",value:"002"},{label:"Personal",value:"001"},{label:"Paciente Externo",value:"003"}],dataInstru:[],dataGrado:[],fields:[],form:{nombre:null,tipo:"%",fecIni:this.isHoy?Y.dayHoyMonth:Y.dayStartMonth,fecFin:this.isHoy?Y.dayHoyMonth:Y.dayEndMonth,empcod:"%",instrucod:"%",gradocod:"%"},buttons:[{icon:"arrow_back",label:"Atrás",click:function(){e.$router.push({name:"medico.fichaAtencion"})}},{icon:"printer",label:"Imprimir",click:this.imprimirLista}]}},methods:{imprimirDetalle:function(){if("fichaAtencion"===this.tipoReporte){var e={print:"reportefichaaten",id:this.seleccionado.NROATE,NUEVO:!0};(0,M.exportFilePhp)(e,"medico/regis-ficha-atencion/reportefichaaten")}if("autorizacion"===this.tipoReporte){var n={print:"reporteautorizacionsalida",id:this.seleccionado.NROATE};(0,M.exportFilePhp)(n,"medico/regis-ficha-atencion/reporteautorizacionsalida")}if("reporteDiario"===this.tipoReporte){var t={print:"reportes",fecrep:k.p6.formatDate(this.diaElegido,"DD/MM/YYYY")};(0,M.exportFilePhp)(t,"medico/regis-ficha-atencion/reportes")}},imprimirLista:function(){this.esLista=!0,this.imprimirTipo=!0,this.tipoReporte="reporteDiario"},buscarAtenciones:function(){var e=this;return T()(w()().m(function n(){return w()().w(function(n){while(1)switch(n.n){case 0:return e.del=e.form.fecIni,e.al=e.form.fecFin,n.n=1,e.obtenerConsultas();case 1:return n.a(2)}},n)}))()},obtenerConsultas:function(){var e=this;return T()(w()().m(function n(){var t;return w()().w(function(n){while(1)switch(n.n){case 0:return t={fecIni:e.del,fecFin:e.al,nombre:e.form.nombre,tipo:e.form.tipo,esSedes:e.esSedes},e.esSedes&&(t.empcod=e.form.empcod),"0000"===e.form.tipo&&(t.instrucod=e.$refs.refNsg.ngs.nivel,t.gradocod=e.$refs.refNsg.ngs.grado),n.n=1,H.getAtenciones(t);case 1:e.rows=n.v;case 2:return n.a(2)}},n)}))()},enviarCorreo:function(){var e=this;return T()(w()().m(function n(){var t;return w()().w(function(n){while(1)switch(n.n){case 0:return n.n=1,H.getAtenciones({nroate:e.nroatencion});case 1:t=n.v,1===t.length&&e.rowRef&&(e.rowRef.ENVIO_ALERTA=t[0].ENVIO_ALERTA,e.rowRef.CORREOS=t[0].CORREOS);case 2:return n.a(2)}},n)}))()},getSedes:function(){var e=this;return T()(w()().m(function n(){var t;return w()().w(function(n){while(1)switch(n.n){case 0:return n.n=1,H.getListaSedes();case 1:t=n.v,"0084"===(0,X["default"])().colcod&&t.length>0&&(t=t.filter(function(e){return"01"!==e.EMPCOD})),t.length>0&&(t=t.map(function(e){return{label:e.EMPDES,value:e.EMPCOD}})),e.listaSedes=[{label:"Todos",value:"%"}].concat(R()(t));case 2:return n.a(2)}},n)}))()},getColumns:function(){var e=[];e.push({name:"NROATE",label:"N° Atencion",field:"NROATE",sortable:!0,align:"left"}),e.push({name:"FECATE",label:"Fecha",field:"FECATE",sortable:!0,align:"center"}),e.push({name:"HORING",label:"H.Ingreso",field:"HORING",sortable:!0,align:"center"}),e.push({name:"HOSAL",label:"H.Salida",field:"HORSAL",sortable:!0,align:"center"}),e.push({name:"NOMCOMP",label:"Nombre",field:"NOMCOMP",sortable:!0,align:"left"}),e.push({name:"TIP_PAC",label:"Tipo Paciente",field:"TIP_PAC",sortable:!0,align:"left"}),this.esSedes&&e.push({name:"EMPDES",label:"Sede de Atención",field:"EMPDES",sortable:!0,align:"left"}),e.push({name:"NGS",label:"NGS",field:"NGS",sortable:!0,align:"center"}),e.push({name:"DIAGDES",label:"Diagnostico",field:"DIAGDES",sortable:!0,align:"left"}),e.push({name:"CORREOS",label:"Alertas",field:"CORREOS",sortable:!0,align:"center"}),e.push({name:"DESTINO",label:"Enviar a",field:"DESTINO",sortable:!0,align:"left"}),e.push({name:"ACCIONES",label:"Acciones",align:"center"}),e.push({name:"ESTADO",label:"",field:"ESTADO",vIf:!1}),this.fields=e}},computed:{isLess:function(){return(0,z.isLess)()}},created:function(){var e=this;return T()(w()().m(function n(){return w()().w(function(n){while(1)switch(n.n){case 0:return e.getColumns(),e.esSedes&&e.getSedes(),n.n=1,e.buscarAtenciones();case 1:return n.a(2)}},n)}))()}},W=t(12807);const B=(0,W.A)(j,[["render",v],["__scopeId","data-v-a0fe17b8"]]);var J=B}}]);