"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[74058],{74058:function(e,o,r){r.r(o),r.d(o,{default:function(){return q}});var n=r(8445),t=r.n(n),a=r(61758),l=r(58790),s={class:"column",style:{display:"grid"}},i={class:"row"},c={class:"row justify-end"},u={class:"q-ma-sm"},d={class:"q-ma-sm"},f={class:"col q-card"},R={class:"column"},p={class:"row"},m={class:"row justify-around col"},v={class:"col row justify-center"},h={class:"col row justify-end"},I={class:"column justify-center"},C={class:"row justify-around"};function b(e,o){var r=(0,a.g2)("header-btn"),n=(0,a.g2)("q-btn"),b=(0,a.g2)("q-select"),O=(0,a.g2)("q-field"),E=(0,a.g2)("q-input"),g=(0,a.g2)("sie-modal"),k=(0,a.g2)("q-search"),M=(0,a.g2)("q-td"),_=(0,a.g2)("q-table");return(0,a.uX)(),(0,a.CE)("div",s,[(0,a.bF)(r,{name:"Recursos",buttons:e.buttons},null,8,["buttons"]),(0,a.bF)(g,{modelValue:e.estadoModal,"onUpdate:modelValue":o[4]||(o[4]=function(o){return e.estadoModal=o}),title:"Agregar Recurso",ok:!1,noClose:!0,escClick:!0,esc:!0},{footerMobile:(0,a.k6)(function(){return[(0,a.Lk)("div",i,[(0,a.bF)(n,{class:"q-ma-xs",dense:"",round:"",flat:"",icon:"close",onClick:e.cancelarAgregacion},null,8,["onClick"]),(0,a.bF)(n,{class:"q-ma-xs",dense:"",round:"",flat:"",icon:"save",onClick:e.ejecutarAccion},null,8,["onClick"])])]}),footer:(0,a.k6)(function(){return[(0,a.Lk)("div",c,[(0,a.bF)(n,{class:"q-ma-xs style-button",dense:"",color:"secondary",onClick:e.cancelarAgregacion},{default:(0,a.k6)(function(){return t()(o[7]||(o[7]=[(0,a.eW)("Cancelar",-1)]))}),_:1},8,["onClick"]),(0,a.bF)(n,{class:"q-ma-xs style-button",dense:"",color:"primary",onClick:e.ejecutarAccion},{default:(0,a.k6)(function(){return[(0,a.eW)((0,l.v_)(e.lbAccion),1)]}),_:1},8,["onClick"])])]}),default:(0,a.k6)(function(){return[(0,a.Lk)("div",u,[(0,a.bF)(O,{error:e.v$.datosModal.TIPO_RESERVA_ID.$error,"error-label":e.$t("validaciones.requerido")},{default:(0,a.k6)(function(){return[(0,a.bF)(b,{class:"q-if-outlined","float-label":"Tipo de Reserva",modelValue:e.v$.datosModal.TIPO_RESERVA_ID.$model,"onUpdate:modelValue":o[0]||(o[0]=function(o){return e.v$.datosModal.TIPO_RESERVA_ID.$model=o}),options:e.tiposReserva,filter:"",placeholder:"Seleccione el tipo de reserva"},null,8,["modelValue","options"])]}),_:1},8,["error","error-label"]),(0,a.bF)(O,{error:e.v$.datosModal.NOMBRE.$error,"error-label":e.$t("validaciones.requerido")},{default:(0,a.k6)(function(){return[(0,a.bF)(E,{class:"q-if-outlined","float-label":"Nombre",modelValue:e.datosModal.NOMBRE,"onUpdate:modelValue":o[1]||(o[1]=function(o){return e.datosModal.NOMBRE=o}),placeholder:"Escriba un nuevo nombre...",maxlength:"50"},null,8,["modelValue"])]}),_:1},8,["error","error-label"]),(0,a.bF)(O,{error:e.v$.datosModal.CODIGO_ACTIVO.$error,"error-label":e.$t("validaciones.requerido")},{default:(0,a.k6)(function(){return[(0,a.bF)(E,{class:"q-if-outlined","float-label":"Código activo",modelValue:e.datosModal.CODIGO_ACTIVO,"onUpdate:modelValue":o[2]||(o[2]=function(o){return e.datosModal.CODIGO_ACTIVO=o}),placeholder:"Escriba el código activo...",maxlength:"200"},null,8,["modelValue"])]}),_:1},8,["error","error-label"]),(0,a.bF)(O,null,{default:(0,a.k6)(function(){return[(0,a.bF)(E,{class:"q-if-outlined","float-label":"Descripción",modelValue:e.datosModal.DESCRIPCION,"onUpdate:modelValue":o[3]||(o[3]=function(o){return e.datosModal.DESCRIPCION=o}),placeholder:"Escriba una descripción...",type:"textarea",maxlength:"200",rows:"4"},null,8,["modelValue"])]}),_:1})])]}),_:1},8,["modelValue"]),(0,a.Lk)("div",d,[(0,a.Lk)("div",f,[(0,a.Lk)("div",R,[(0,a.Lk)("div",p,[(0,a.bF)(k,{class:"q-if-outlined col",modelValue:e.filtro,"onUpdate:modelValue":o[5]||(o[5]=function(o){return e.filtro=o})},null,8,["modelValue"])]),(0,a.bF)(b,{class:"q-if-outlined",modelValue:e.filtroTipoReserva,"onUpdate:modelValue":o[6]||(o[6]=function(o){return e.filtroTipoReserva=o}),options:e.tiposReserva,filter:"",multiple:"",chips:"",placeholder:"Tipos de Reserva",style:{width:"100%"},onInput:e.filtrarRecursos},null,8,["modelValue","options","onInput"])]),(0,a.bF)(_,{data:e.recursos,columns:e.columns,filter:e.filtro,style:(0,l.Tr)({height:e.alto+"px"})},(0,a.eX)({"body-cell-ACCIONES":(0,a.k6)(function(o){return[(0,a.bF)(M,{props:o},{default:(0,a.k6)(function(){return[(0,a.Lk)("div",C,[(0,a.bF)(n,{color:"blue",icon:"edit",flat:"",dense:"",round:"",onClick:function(r){return e.mostrarModal(o.row)}},null,8,["onClick"]),(0,a.bF)(n,{color:"red",icon:"delete",flat:"",dense:"",round:"",onClick:function(r){return e.eliminarRecurso(o.row)}},null,8,["onClick"])])]}),_:2},1032,["props"])]}),_:2},[e.recursos.length>0?{name:"bottom",fn:(0,a.k6)(function(){return[(0,a.Lk)("div",m,[o[9]||(o[9]=(0,a.Lk)("div",{class:"col"},null,-1)),(0,a.Lk)("div",v,[(0,a.bF)(n,{flat:"",dense:"",round:"",icon:"refresh",onClick:e.obtenerRecursos},null,8,["onClick"])]),(0,a.Lk)("div",h,[o[8]||(o[8]=(0,a.Lk)("div",{class:"column justify-center"},[(0,a.Lk)("span",null,"Total: ")],-1)),(0,a.Lk)("div",I,[(0,a.Lk)("span",null,(0,l.v_)(e.recursos.length),1)])])])]}),key:"0"}:void 0]),1032,["data","columns","filter","style"])])])])}var O=r(76080),E=r.n(O),g=r(45254),k=r.n(g),M=r(91134),_=r.n(M),A=(r(77507),r(10239),r(50310),r(90095),r(48426),r(83190),r(68017),r(13715),r(83972)),w=r(30545),D=r(11654),V=r(30640),T=r(6123),$=r(82640),S=r(57668),y={setup:function(){var e=(0,A.fG)();return{v$:e}},components:{QTable:w.A,QBtn:D.A,sieModal:V.A,QDatetime:T.T5,QTd:T.Ef,QSelect:T.Si,QToolbar:T.ZV,QField:T.Om,QInput:T.ie,QSearch:T.Ks},data:function(){return _()(_()({size:"100%",permiso:(0,S["default"])().ruta.nivel,lbAccion:"",estadoModal:!1,filtro:"",alto:0,filtroTipoReserva:[],oldTipoReserva:"",datosModal:{ID:null,NOMBRE:null,DESCRIPCION:null,CODIGO_ACTIVO:null,TIPO_RESERVA_ID:null},tiposReserva:[],recursos:[]},"alto",0),"columns",[{name:"ID",label:"Id",field:"ID",align:"center",sortable:!0},{name:"NOMBRE",label:"Nombre",field:"NOMBRE",align:"column-style",sortable:!0},{name:"DESCRIPCION",label:"Descripcion",field:"DESCRIPCION",align:"column-style"},{name:"CODIGO_ACTIVO",label:"Código activo",field:"CODIGO_ACTIVO",align:"column-style"},{name:"TIPO_RESERVA",label:"Tipo de Reserva",field:"TIPO_RESERVA",align:"center",sortable:!0}])},mounted:function(){this.obtenerRecursos(),this.obtenerTiposReservas(),window.addEventListener("resize",this.handleResize),this.handleResize(),3===this.permiso&&this.columns.push({name:"ACCIONES",label:"Acciones",field:"ACCIONES",align:"center",style:"width: 90px"});var e=window.innerWidth;e<500&&(this.size=e-16+"px"),window.addEventListener("resize",this.onResize)},validations:function(){var e={NOMBRE:{required:$.mw},CODIGO_ACTIVO:{required:$.mw},TIPO_RESERVA_ID:{required:$.mw}};return{datosModal:e}},computed:{buttons:function(){var e=[];return this.permiso>=2&&e.push({label:"Agregar Recurso",icon:"add",click:this.mostrarModal}),e}},unmounted:function(){window.removeEventListener("resize",this.handleResize)},methods:{handleResize:function(){var e=210;this.alto=window.innerHeight-e},mostrarModal:function(e){e.ID?(this.oldTipoReserva=e.TIPO_RESERVA_ID,this.lbAccion="Actualizar",this.datosModal=Object.assign({},e)):(this.limpiarCampos(),this.lbAccion="Agregar"),this.estadoModal=!0},ejecutarAccion:function(){this.v$.$touch(),this.v$.$error||(this.datosModal.ID?this.actualizarRecurso():this.agregarRecurso(),this.estadoModal=!1,this.limpiarCampos())},agregarRecurso:function(){var e=this;return k()(E()().m(function o(){var r,n,t;return E()().w(function(o){while(1)switch(o.p=o.n){case 0:return o.p=0,r={NOMBRE:e.datosModal.NOMBRE.trim(),DESCRIPCION:null===e.datosModal.DESCRIPCION?e.datosModal.DESCRIPCION:e.datosModal.DESCRIPCION.trim(),CODIGO_ACTIVO:e.datosModal.CODIGO_ACTIVO,TIPO_RESERVA_ID:e.datosModal.TIPO_RESERVA_ID},o.n=1,e.$http.post("api/RsRecursoController/addRsRecurso",{data:r});case 1:n=o.v,1===n.code&&(e.obtenerRecursos(),e.$notify("Agregado","success")),o.n=3;break;case 2:o.p=2,t=o.v,e.$notify(t.error.message,"error");case 3:return o.a(2)}},o,null,[[0,2]])}))()},actualizarRecurso:function(){var e=this;return k()(E()().m(function o(){var r,n,t,a,l,s;return E()().w(function(o){while(1)switch(o.p=o.n){case 0:return o.p=0,r={NOMBRE:e.datosModal.NOMBRE.trim(),DESCRIPCION:null===e.datosModal.DESCRIPCION?e.datosModal.DESCRIPCION:e.datosModal.DESCRIPCION.trim(),CODIGO_ACTIVO:e.datosModal.CODIGO_ACTIVO.trim()},n={OLD_TIPO_RESERVA:e.oldTipoReserva,TIPO_RESERVA_ID:e.datosModal.TIPO_RESERVA_ID},t=e.datosModal.ID,o.n=1,e.$http.post("api/RsRecursoController/updateRsRecurso",{id:t,params:r});case 1:return a=o.v,o.n=2,e.$http.post("api/RsRecursoController/updateRsRelacion",{id:t,params:n});case 2:l=o.v,1===a.code&&1===l.code&&(e.obtenerRecursos(),e.$notify("Actualizado","success")),o.n=4;break;case 3:o.p=3,s=o.v,e.$notify(s.error.message,"error");case 4:return o.a(2)}},o,null,[[0,3]])}))()},eliminarRecurso:function(e){var o=this;return k()(E()().m(function r(){var n,t,a;return E()().w(function(r){while(1)switch(r.p=r.n){case 0:return r.n=1,o.$confirmar("¿Esta Ud. Seguro de Eliminar el Recurso?","warning",!0);case 1:if(n=r.v,!n){r.n=5;break}return r.p=2,e={id_recurso:e.ID,tipo_reserva_id:e.TIPO_RESERVA_ID},r.n=3,o.$http.delete("api/RsRecursoController/deleteRsRecurso",{data:e});case 3:t=r.v,1===t.code?(o.obtenerRecursos(),o.$notify("Eliminado","success")):o.$notify(t.message,"error"),r.n=5;break;case 4:r.p=4,a=r.v,o.$notify(a.error.message,"error");case 5:return r.a(2)}},r,null,[[2,4]])}))()},obtenerRecursos:function(){var e=this;return k()(E()().m(function o(){var r;return E()().w(function(o){while(1)switch(o.p=o.n){case 0:return o.p=0,o.n=1,e.$http.get("api/RsRecursoController/getRsRecurso",{params:{filtros:""}});case 1:e.recursos=o.v,o.n=3;break;case 2:o.p=2,r=o.v,e.$notify(r.error.message,"error");case 3:return o.a(2)}},o,null,[[0,2]])}))()},filtrarRecursos:function(){var e=this;return k()(E()().m(function o(){var r,n;return E()().w(function(o){while(1)switch(o.p=o.n){case 0:return o.p=0,r=e.filtroTipoReserva.join(","),o.n=1,e.$http.get("api/RsRecursoController/getRsRecurso",{params:{filtros:r}});case 1:e.recursos=o.v,o.n=3;break;case 2:o.p=2,n=o.v,e.$notify(n.error.message,"error");case 3:return o.a(2)}},o,null,[[0,2]])}))()},obtenerTiposReservas:function(){var e=this;return k()(E()().m(function o(){var r,n;return E()().w(function(o){while(1)switch(o.p=o.n){case 0:return o.p=0,o.n=1,e.$http.get("api/RsTipoReservaController/getRsTipoReserva");case 1:r=o.v,r.forEach(function(o){var r={label:o.NOMBRE,value:o.ID};e.tiposReserva.push(r)}),o.n=3;break;case 2:o.p=2,n=o.v,e.$notify(n.error.message,"error");case 3:return o.a(2)}},o,null,[[0,2]])}))()},cancelarAgregacion:function(){this.limpiarCampos(),this.estadoModal=!1},limpiarCampos:function(){for(var e in this.datosModal)this.datosModal[e]=null;this.v$.$reset()},onResize:function(){var e=window.innerWidth;this.size=e<500?e-16+"px":"100%"}}},N=r(12807);const P=(0,N.A)(y,[["render",b]]);var q=P}}]);