"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[65117],{65117:function(e,o,a){a.r(o),a.d(o,{default:function(){return ie}});var t=a(8445),i=a.n(t),n=a(61758),l=a(58790),s={class:"q-card q-mt-sm"},c={class:"row q-mx-sm wrap"},d={key:0,class:"row q-mx-sm"},u={class:"row q-mx-sm"},r={class:"row justify-between col justify-center"},f={class:"col row justify-center"},h={class:"col row justify-end"},m={class:"row"},p={class:"column"},A={class:"col q-ma-xs"},b={class:"col row"},E={class:"col row"},g={class:"q-ma-sm"},v={key:0,class:"row q-mx-sm"},D={key:1,class:"row q-mx-sm"},O={class:"row q-mx-sm"},S={class:"row q-mx-sm"},C={class:"row q-mx-sm"};function T(e,o){var a=(0,n.g2)("header-btn"),t=(0,n.g2)("sie-estudiantes"),T=(0,n.g2)("sie-salones"),F=(0,n.g2)("q-select"),V=(0,n.g2)("q-search"),k=(0,n.g2)("q-datetime"),I=(0,n.g2)("q-btn"),R=(0,n.g2)("q-td"),M=(0,n.g2)("q-tooltip"),y=(0,n.g2)("q-icon"),q=(0,n.g2)("q-chip"),U=(0,n.g2)("q-download-file"),L=(0,n.g2)("q-table"),J=(0,n.g2)("q-input"),_=(0,n.g2)("sie-modal"),H=(0,n.g2)("sie-upload"),w=(0,n.g2)("sie-select"),N=(0,n.g2)("q-tab"),z=(0,n.g2)("q-tabs"),Y=(0,n.g2)("q-item-side"),G=(0,n.g2)("q-item-main"),Q=(0,n.g2)("q-item"),$=(0,n.g2)("q-checkbox"),P=(0,n.g2)("q-item-separator"),j=(0,n.g2)("q-scroll-area"),x=(0,n.g2)("q-list"),B=(0,n.g2)("q-page");return(0,n.uX)(),(0,n.Wv)(B,{class:"column q-pa-md"},{default:(0,n.k6)(function(){return[(0,n.bF)(a,{name:"Justificaciones de Salida",buttons:e.buttons},null,8,["buttons"]),(0,n.Lk)("div",s,[(0,n.Lk)("div",c,[e.sie.esFamilia?((0,n.uX)(),(0,n.Wv)(t,{key:0,class:"col-12 col-sm no-border",modelValue:e.alucod,"onUpdate:modelValue":o[0]||(o[0]=function(o){return e.alucod=o}),onSelected:e.selectAlumno},null,8,["modelValue","onSelected"])):((0,n.uX)(),(0,n.Wv)(T,{key:1,class:"col-12 col-sm no-border",style:{padding:"0 !important"},modelValue:e.filtros.nemo,"onUpdate:modelValue":o[1]||(o[1]=function(o){return e.filtros.nemo=o}),onSeleccionar:o[2]||(o[2]=function(o){return e.tipBusqueda(1)}),label:e.$t("salon"),campos:["NEMO","NEMODES","INSTRUCOD","GRADOCOD","SECCIONCOD"],todos:!0},null,8,["modelValue","label"])),(0,n.bF)(F,{class:"q-if-outlined",options:e.estadoJustificacion,multiple:"",chips:"",modelValue:e.filtros.estados,"onUpdate:modelValue":o[3]||(o[3]=function(o){return e.filtros.estados=o}),"float-label":"Estado",color:"secondary",onInput:e.filtrar},null,8,["options","modelValue","onInput"])]),e.sie.esFamilia?(0,n.Q3)("v-if",!0):((0,n.uX)(),(0,n.CE)("div",d,[(0,n.bF)(F,{class:"q-if-outlined col",options:e.niveles,modelValue:e.instrucod,"onUpdate:modelValue":o[4]||(o[4]=function(o){return e.instrucod=o}),"float-label":"Nivel",onInput:o[5]||(o[5]=function(o){return e.tipBusqueda(2)})},null,8,["options","modelValue"]),(0,n.bF)(F,{class:"q-if-outlined col",options:e.grados,modelValue:e.gradocod,"onUpdate:modelValue":o[6]||(o[6]=function(o){return e.gradocod=o}),"float-label":"Grado",onInput:o[7]||(o[7]=function(o){return e.tipBusqueda(2)})},null,8,["options","modelValue"]),(0,n.bF)(F,{class:"q-if-outlined col",options:e.secciones,modelValue:e.seccioncod,"onUpdate:modelValue":o[8]||(o[8]=function(o){return e.seccioncod=o}),"float-label":"Sección",onInput:e.filtrar},null,8,["options","modelValue","onInput"])])),(0,n.Lk)("div",u,[e.sie.esFamilia?(0,n.Q3)("v-if",!0):((0,n.uX)(),(0,n.Wv)(V,{key:0,class:"q-if-outlined col-12 col-sm",modelValue:e.filtros.alumno,"onUpdate:modelValue":o[9]||(o[9]=function(o){return e.filtros.alumno=o}),"float-label":"Alumno"},null,8,["modelValue"])),e.sie.esFamilia?(0,n.Q3)("v-if",!0):((0,n.uX)(),(0,n.Wv)(F,{key:1,class:"q-if-outlined",options:e.modoFiltro,modelValue:e.filtros.modo,"onUpdate:modelValue":o[10]||(o[10]=function(o){return e.filtros.modo=o}),"float-label":"Modo Busqueda",onInput:e.cargaInicial},null,8,["options","modelValue","onInput"])),(0,n.bF)(k,{class:"q-if-outlined col",modelValue:e.filtros.fIni,"onUpdate:modelValue":o[11]||(o[11]=function(o){return e.filtros.fIni=o}),type:"date",format:"DD/MM/YYYY","float-label":e.$t("fechainicio"),onInput:e.cargaInicial},null,8,["modelValue","float-label","onInput"]),(0,n.bF)(k,{class:"q-if-outlined col",modelValue:e.filtros.fFin,"onUpdate:modelValue":o[12]||(o[12]=function(o){return e.filtros.fFin=o}),type:"date",format:"DD/MM/YYYY","float-label":e.$t("fechafin"),onInput:e.cargaInicial},null,8,["modelValue","float-label","onInput"])])]),(0,n.bF)(L,{class:"q-mt-xs",style:{height:"55vh"},data:e.data,columns:e.columns,"row-key":"ID",filter:e.filtros.alumno,selection:"multiple",selected:e.listSelect,"onUpdate:selected":o[13]||(o[13]=function(o){return e.listSelect=o})},{bottom:(0,n.k6)(function(a){return[(0,n.Lk)("div",r,[o[37]||(o[37]=(0,n.Lk)("div",{class:"col"},null,-1)),(0,n.Lk)("div",f,[(0,n.bF)(I,{icon:"refresh",flat:"",dense:"",round:"",onClick:e.cargaInicial},null,8,["onClick"])]),(0,n.Lk)("div",h,[o[36]||(o[36]=(0,n.Lk)("div",{class:"text-bold"},"Total: ",-1)),(0,n.Lk)("span",null,(0,l.v_)(e.data.length),1)])])]}),"body-cell-FH_REGISTRO":(0,n.k6)(function(o){return[(0,n.bF)(R,{props:o},{default:(0,n.k6)(function(){return[(0,n.eW)((0,l.v_)(e.date(o.row.FH_REGISTRO,"DD/MM/YYYY HH:mm")),1)]}),_:2},1032,["props"])]}),"body-cell-ESTADO":(0,n.k6)(function(o){return[(0,n.bF)(R,{props:o,style:(0,l.Tr)({"background-color":e.estados[o.row.ESTADO].color})},{default:(0,n.k6)(function(){return[(0,n.eW)((0,l.v_)(e.estados[o.row.ESTADO].abr),1),(0,n.bF)(M,null,{default:(0,n.k6)(function(){return[(0,n.eW)((0,l.v_)(e.estados[o.row.ESTADO].titulo),1)]}),_:2},1024)]}),_:2},1032,["props","style"])]}),"body-cell-DETALLE":(0,n.k6)(function(e){return[(0,n.bF)(R,{props:e},{default:(0,n.k6)(function(){return[(0,n.bF)(y,{name:"info"}),(0,n.bF)(M,null,{default:(0,n.k6)(function(){return[(0,n.Lk)("div",m,[o[38]||(o[38]=(0,n.Lk)("div",{class:"text-bold"},"Detalle:  ",-1)),(0,n.Lk)("span",null,(0,l.v_)(e.row.DETALLE),1)])]}),_:2},1024)]}),_:2},1032,["props"])]}),"body-cell-FECHAMOD":(0,n.k6)(function(o){return[(0,n.bF)(R,{props:o},{default:(0,n.k6)(function(){return[(0,n.Lk)("div",p,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(o.row.FECHAS,function(o){return(0,n.uX)(),(0,n.Wv)(q,{class:"text-center",dense:"",color:o.COLORVUE,icon:o.ICONO},{default:(0,n.k6)(function(){return[(0,n.eW)((0,l.v_)(e.date(o.FECHA,"DD/MM/YYYY")),1),(0,n.bF)(M,null,{default:(0,n.k6)(function(){return[(0,n.eW)((0,l.v_)(o.ESTADODES),1)]}),_:2},1024)]}),_:2},1032,["color","icon"])}),256))])]}),_:2},1032,["props"])]}),"body-cell-NOMBRE_ARCHIVO":(0,n.k6)(function(o){return[(0,n.bF)(R,{props:o},{default:(0,n.k6)(function(){return[o.row.EXTENSION?((0,n.uX)(),(0,n.Wv)(U,{key:0,src:e.devuelveUrl(o.row),item:o.row,name:o.row.NOMBRE_ARCHIVO,extension:o.row.EXTENSION,inline:!1},null,8,["src","item","name","extension"])):(0,n.Q3)("v-if",!0)]}),_:2},1032,["props"])]}),_:1},8,["data","columns","filter","selected"]),(0,n.bF)(_,{modelValue:e.modalRechazar,"onUpdate:modelValue":o[20]||(o[20]=function(o){return e.modalRechazar=o}),title:e.dataRechazo.TIPO+" Justificación",labelButtonOk:e.dataRechazo.TIPO,onSubmit:o[21]||(o[21]=function(o){return e.rechazarJustificacion(e.dataRechazo.MODO)}),cancel:e.$t("cancelar")},{default:(0,n.k6)(function(){return[(0,n.Lk)("div",A,[(0,n.bF)(J,{class:"q-if-outlined",modelValue:e.dataRechazo.NOMCOMP,"onUpdate:modelValue":o[14]||(o[14]=function(o){return e.dataRechazo.NOMCOMP=o}),readonly:"","float-label":"Estudiante"},null,8,["modelValue"]),(0,n.Lk)("div",b,[(0,n.bF)(J,{class:"col q-if-outlined",modelValue:e.dataRechazo.NEMODES,"onUpdate:modelValue":o[15]||(o[15]=function(o){return e.dataRechazo.NEMODES=o}),readonly:"","float-label":"Salón"},null,8,["modelValue"])]),(0,n.Lk)("div",E,[(0,n.bF)(J,{class:"col q-if-outlined",modelValue:e.dataRechazo.SECUDES,"onUpdate:modelValue":o[16]||(o[16]=function(o){return e.dataRechazo.SECUDES=o}),readonly:"","float-label":"Tipo de justificación"},null,8,["modelValue"]),(0,n.bF)(J,{class:"col q-if-outlined",modelValue:e.dataRechazo.FH_JUSTIFICA,"onUpdate:modelValue":o[17]||(o[17]=function(o){return e.dataRechazo.FH_JUSTIFICA=o}),readonly:"","float-label":"Fecha justificación"},null,8,["modelValue"])]),(0,n.bF)(J,{class:"q-if-outlined col",type:"textarea",rows:"3",readonly:"",modelValue:e.dataRechazo.DETALLE,"onUpdate:modelValue":o[18]||(o[18]=function(o){return e.dataRechazo.DETALLE=o}),"float-label":"Detalle de la justificación"},null,8,["modelValue"]),(0,n.bF)(J,{class:"q-if-outlined col",type:"textarea",rows:"3",modelValue:e.dataRechazo.DETALLE_RECHAZO,"onUpdate:modelValue":o[19]||(o[19]=function(o){return e.dataRechazo.DETALLE_RECHAZO=o}),"float-label":"Motivo del "+e.dataRechazo.MOTIVO,maxlength:"250"},null,8,["modelValue","float-label"])])]}),_:1},8,["modelValue","title","labelButtonOk","cancel"]),(0,n.bF)(_,{modelValue:e.modalAddJusitificacion,"onUpdate:modelValue":o[32]||(o[32]=function(o){return e.modalAddJusitificacion=o}),title:"Agregar Justificacion",onSubmit:e.saveModal},{default:(0,n.k6)(function(){return[(0,n.Lk)("div",g,[e.sie.esFamilia?(0,n.Q3)("v-if",!0):((0,n.uX)(),(0,n.CE)("div",v,[(0,n.bF)(F,{class:"q-if-outlined col",options:e.nivelesAdd,modelValue:e.infoAdd.instrucod,"onUpdate:modelValue":o[22]||(o[22]=function(o){return e.infoAdd.instrucod=o}),"float-label":"Nivel",onInput:e.obtenerAlunosModal},null,8,["options","modelValue","onInput"]),(0,n.bF)(F,{class:"q-if-outlined col",options:e.gradosAdd,modelValue:e.infoAdd.gradocod,"onUpdate:modelValue":o[23]||(o[23]=function(o){return e.infoAdd.gradocod=o}),"float-label":"Grado",onInput:e.obtenerAlunosModal},null,8,["options","modelValue","onInput"]),(0,n.bF)(F,{class:"q-if-outlined col",options:e.seccionesAdd,modelValue:e.infoAdd.seccioncod,"onUpdate:modelValue":o[24]||(o[24]=function(o){return e.infoAdd.seccioncod=o}),"float-label":"Sección",onInput:e.obtenerAlunosModal},null,8,["options","modelValue","onInput"])])),e.sie.esFamilia?(0,n.Q3)("v-if",!0):((0,n.uX)(),(0,n.CE)("div",D,[(0,n.bF)(F,{class:"q-if-outlined col",filter:"",options:e.alumnos,modelValue:e.infoAdd.alucod,"onUpdate:modelValue":o[25]||(o[25]=function(o){return e.infoAdd.alucod=o}),"float-label":"Estudiante"},null,8,["options","modelValue"])])),(0,n.Lk)("div",O,[(0,n.bF)(k,{class:"q-if-outlined col",modelValue:e.infoAdd.fecIni,"onUpdate:modelValue":o[26]||(o[26]=function(o){return e.infoAdd.fecIni=o}),type:"date",format:"DD/MM/YYYY","float-label":e.$t("fechainicio")},null,8,["modelValue","float-label"]),(0,n.bF)(k,{class:"q-if-outlined col",modelValue:e.infoAdd.fecFin,"onUpdate:modelValue":o[27]||(o[27]=function(o){return e.infoAdd.fecFin=o}),type:"date",format:"DD/MM/YYYY","float-label":e.$t("fechafin")},null,8,["modelValue","float-label"])]),(0,n.Lk)("div",S,[(0,n.bF)(F,{class:"q-if-outlined col",options:e.infoEstados,modelValue:e.infoAdd.estado,"onUpdate:modelValue":o[28]||(o[28]=function(o){return e.infoAdd.estado=o}),"float-label":"Salida"},null,8,["options","modelValue"]),(0,n.bF)(F,{class:"q-if-outlined col",options:e.tipoJustificacion,modelValue:e.infoAdd.justificacion,"onUpdate:modelValue":o[29]||(o[29]=function(o){return e.infoAdd.justificacion=o}),"float-label":"Justificación"},null,8,["options","modelValue"])]),(0,n.Lk)("div",C,[(0,n.bF)(J,{class:"q-if-outlined col",type:"textarea",modelValue:e.infoAdd.detalleJustificacion,"onUpdate:modelValue":o[30]||(o[30]=function(o){return e.infoAdd.detalleJustificacion=o}),"float-label":"Detalle",rows:"3"},null,8,["modelValue"])]),(0,n.bF)(H,{class:"q-mx-sm",onUpload:e.addFile,icon:"file",modelValue:e.infoAdd.dataArchivo,"onUpdate:modelValue":o[31]||(o[31]=function(o){return e.infoAdd.dataArchivo=o}),onlyButton:!0,preview:!0,title:"Subir Archivos"},null,8,["onUpload","modelValue"])])]}),_:1},8,["modelValue","onSubmit"]),(0,n.bF)(_,{modelValue:e.modalConfig,"onUpdate:modelValue":o[35]||(o[35]=function(o){return e.modalConfig=o}),title:"Configuración de Justificaciones",ok:!1},{footerMobile:(0,n.k6)(function(){return[(0,n.bF)(I,{flat:"",dense:"",round:"",icon:"save",onClick:e.saveAlertas},null,8,["onClick"])]}),postButtonFooter:(0,n.k6)(function(){return[(0,n.bF)(I,{label:"guardar",onClick:e.saveAlertas,color:"primary"},null,8,["onClick"])]}),default:(0,n.k6)(function(){return[(0,n.bF)(w,{class:"col",type:"outlined",modelValue:e.modalState,"onUpdate:modelValue":o[33]||(o[33]=function(o){return e.modalState=o}),label:"ESTADODES",val:"ESTADOCOD",options:e.estadosNoJus,placeholder:"estado"},null,8,["modelValue","options"]),(0,n.bF)(z,{modelValue:e.tabSelectConfig,"onUpdate:modelValue":o[34]||(o[34]=function(o){return e.tabSelectConfig=o}),animated:"",inverted:""},{title:(0,n.k6)(function(){return[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.tabsConfig,function(e,o){return(0,n.uX)(),(0,n.Wv)(N,{key:e.value,name:e.label,label:e.label,modelValue:e.value},null,8,["name","label","modelValue"])}),128))]}),_:1},8,["modelValue"]),"Alerta"===e.tabSelectConfig?((0,n.uX)(),(0,n.Wv)(x,{key:0,class:"q-ma-sm"},{default:(0,n.k6)(function(){return[(0,n.bF)(Q,{class:"q-list-header text-primary"},{default:(0,n.k6)(function(){return[(0,n.bF)(Y,{class:"text-primary"},{default:(0,n.k6)(function(){return i()(o[39]||(o[39]=[(0,n.Lk)("span",null,"Estado",-1)]))}),_:1}),(0,n.bF)(G,null,{default:(0,n.k6)(function(){return i()(o[40]||(o[40]=[(0,n.Lk)("span",null,"Perfil",-1)]))}),_:1})]}),_:1}),(0,n.bF)(j,{class:"tabla-tamano"},{default:(0,n.k6)(function(){return[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.perfilesAlertas[e.modalState],function(e,o){return(0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.bF)(Q,null,{default:(0,n.k6)(function(){return[(0,n.bF)(Y,null,{default:(0,n.k6)(function(){return[(0,n.bF)($,{modelValue:e.ESTADO,"onUpdate:modelValue":function(o){return e.ESTADO=o}},null,8,["modelValue","onUpdate:modelValue"])]}),_:2},1024),(0,n.bF)(G,null,{default:(0,n.k6)(function(){return[(0,n.Lk)("span",null,(0,l.v_)(e.TIPNOM),1)]}),_:2},1024)]}),_:2},1024),(0,n.bF)(P)],64)}),256))]}),_:1})]}),_:1})):((0,n.uX)(),(0,n.Wv)(x,{key:1,class:"q-ma-sm"},{default:(0,n.k6)(function(){return[(0,n.bF)(Q,{class:"q-list-header text-primary"},{default:(0,n.k6)(function(){return[(0,n.bF)(Y,{class:"text-primary"},{default:(0,n.k6)(function(){return i()(o[41]||(o[41]=[(0,n.Lk)("span",null,"Estado",-1)]))}),_:1}),(0,n.bF)(G,null,{default:(0,n.k6)(function(){return i()(o[42]||(o[42]=[(0,n.Lk)("span",null,"Perfil",-1)]))}),_:1})]}),_:1}),(0,n.bF)(j,{class:"tabla-tamano"},{default:(0,n.k6)(function(){return[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.perfilesPermisos[e.modalState],function(e,o){return(0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.bF)(Q,null,{default:(0,n.k6)(function(){return[(0,n.bF)(Y,null,{default:(0,n.k6)(function(){return[(0,n.bF)($,{modelValue:e.ESTADO,"onUpdate:modelValue":function(o){return e.ESTADO=o}},null,8,["modelValue","onUpdate:modelValue"])]}),_:2},1024),(0,n.bF)(G,null,{default:(0,n.k6)(function(){return[(0,n.Lk)("span",null,(0,l.v_)(e.TIPNOM),1)]}),_:2},1024)]}),_:2},1024),(0,n.bF)(P)],64)}),256))]}),_:1})]}),_:1}))]}),_:1},8,["modelValue"])]}),_:1})}var F=a(76080),V=a.n(F),k=a(45254),I=a.n(k),R=(a(10239),a(56285),a(50310),a(90095),a(515),a(83190),a(27153),a(52776),a(81813),a(13715),a(83972)),M=a(6123),y=a(96122),q=a(13813),U=a(80660),L=a(69027),J=a(2819),_=a(57668),H=a(51082),w=a(30640),N=a(88275),z=a(93616),Y=a(24974),G=a(92173),Q=a(59089),$=a(80340),P=a(30545),j=a(62006),x=a(34858),B=a(65818),X=a(18105),W=a(78131),K=a(982),Z=a(33001),ee=a(33950),oe={setup:function(){var e=(0,R.fG)();return{v$:e}},components:{sieSalones:N.Ay,sieUsuario:Y.A,sieDate:H.A,sieModal:w.A,sieVacio:$.A,sieSelect:z.A,sieEstudiantes:G.Ay,sieUpload:Q.A,QSelect:M.Si,QToggle:M.c5,QCheckbox:M.vZ,QBtnToggle:M.QL,QRadio:M.$,QClock:B.A,QTable:P.A,QTh:M.EJ,QTr:M.qh,QTd:M.Ef,QTableColumns:M.$s,QPopupEdit:M.GT,QChip:M.wQ,QFabAction:M.B$,QPageSticky:M._U,QFab:M.l6,QDatetime:M.T5,QDownloadFile:j.A,QScrollArea:y.A,QTabs:M.uw,QTab:M.zu,QTabPane:M.dg,virtualList:x.Ay,QPage:M.Tu,QSearch:M.Ks,QBtn:M.Il,QTooltip:M.nC,QIcon:M.bP,QInput:M.ie,QList:M.Mb,QItem:M.H0,QItemSide:M.n1,QItemMain:M.mF,QItemSeparator:M.CL},data:function(){return{sie:(0,_["default"])(),nemo:null,modalRechazar:!1,data:[],filtros:{fIni:new Date,fFin:new Date,nemo:"T",estados:["P"],alumno:null,modo:"J"},baseGrados:{},instrucod:"T",gradocod:"T",seccioncod:"T",preData:[],estadoAsistencia:{},listSelect:[],tabsConfig:[{value:"alerta",label:"Alerta"},{value:"permiso",label:"Permisos"}],tabSelectConfig:"Alerta",estados:{P:{titulo:"Pendiente",abr:"Pen",color:"#ffa50021"},A:{titulo:"Aceptado",abr:"Acep",color:"#0080002b"},R:{titulo:"Rechazado",abr:"Rech",color:"#ff000030"}},modoBusqueda:1,alumnos:[],columns:[{name:"NOMCOMP",label:"Estudiante",field:"NOMCOMP",align:"left",sortable:!0},{name:"NEMODES",label:"Salón",field:"NEMODES",align:"left",sortable:!0},{name:"FECHAMOD",label:"F. Asistencia",field:"FECHAMOD",align:"left",sortable:!0},{name:"FH_REGISTRO",label:"F. Justificacion",field:"FH_REGISTRO",align:"left",sortable:!0},{name:"ESTADO",label:"Estado",field:"ESTADO",align:"center",sortable:!0},{name:"SECUDES",label:"Justificación",field:"SECUDES",align:"center",sortable:!0},{name:"NOMBRE_ARCHIVO",label:"Archivo",field:"NOMBRE_ARCHIVO",align:"left",sortable:!0},{name:"DETALLE",label:"Detalle",field:"DETALLE",align:"left",sortable:!0}],modoFiltro:[{label:"F. Justificacion",value:"J"},{label:"F. Asistencia",value:"A"}],modo:"J",estadoJustificacion:[{label:"Pendiente",value:"P"},{label:"Aceptado",value:"A"},{label:"Rechazado",value:"R"}],dataRechazo:{},tipoJustificacion:[],modalAddJusitificacion:!1,infoEstados:[],modalConfig:!1,configuracion:{},configuracionJustificaciones:{},siNo:[{label:"Si",value:1},{label:"No",value:0}],infoAdd:{instrucod:null,gradocod:null,seccioncod:null,alucod:null,fecIni:new Date,fecFin:new Date,estado:null,justificacion:null,detalleJustificacion:null,dataArchivo:{},alto:""},showConfigParams:!1,tabSelect:"A",perfilesAlertas:{},perfilesPermisos:{},estadosNoJus:[],modalState:null,alucod:""}},methods:{date:X.Ay,handleResize:function(){this.alto=window.innerHeight-305},cargaInicial:function(){var e=this;return I()(V()().m(function o(){return V()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,U.$http.get("api/HyoConfigurajustificaciones/getJustificaciones",{params:{agrupado:!0}});case 1:e.configuracionJustificaciones=o.v,U.$http.get("api/HyoJustificacionasistencias/getJustificacionesFecha",{params:e.filtros}).then(function(o){e.listSelect=[],o.forEach(function(e){e.FECHAMOD=(0,X.Ay)(e.FECHA,"DD/MM/YYYY"),e.FECREGMOD=(0,X.Ay)(e.FECREG,"DD/MM/YYYY HH:mm")}),e.preData=o,e.filtrar()});case 2:return o.a(2)}},o)}))()},tipBusqueda:function(e){this.modoBusqueda=e,this.filtrar()},addFile:function(e){var o=this;this.cerrarModal=!0,this.infoAdd.dataArchivo={},(0,ee.Upload)({url:"api/HyoArchivo/tmp/upload",file:e[0]}).then(function(e){o.infoAdd.dataArchivo.file=e}).catch(function(){})},saveModal:function(){var e=this;if(this.infoAdd.alucod)if(this.infoAdd.estado)if(this.infoAdd.justificacion)if(this.infoAdd.detalleJustificacion)if(!this.infoAdd.dataArchivo.file&&this.configuracionJustificaciones.ADJUNTO_OBLIGATORIO)(0,K["default"])("Debe subir un archivo","error");else{var o={TIPJUSCOD:this.infoAdd.justificacion,ASISTENCIA:this.infoAdd.estado,ALUCOD:this.infoAdd.alucod,DETALLE:this.infoAdd.detalleJustificacion,ESTADO:"A",fecFin:this.infoAdd.fecFin,fecIni:this.infoAdd.fecIni};this.infoAdd.dataArchivo.file&&(o.nombreTemporal=this.infoAdd.dataArchivo.file.name,o.ARCHIVO=this.infoAdd.dataArchivo.file.originalFilename.replace(/ /g,"_")),U.$http.post("api/HyoJustificacionasistencias/saveJustificacionAnticipada",{data:o}).then(function(a){"Ok"===a.json&&(o.listFechas=a.fechas,o.NEMO=a.NEMO,U.$http.post("api/HyoJustificacionasistencias/grabaInformacion",{data:o}).then(function(o){var a=o.json;"Ok"===a&&((0,K["default"])(e.$t("mensajes.m0001")),e.modalAddJusitificacion=!1,e.cargaInicial())}))})}else(0,K["default"])("Seleccione un Detalle para la justificación","error");else(0,K["default"])("Seleccione un tipo de justificación","error");else(0,K["default"])("Seleccione un estado de asistencia","error");else(0,K["default"])("Seleccione un Estudiante de la lista","error")},filtrar:function(){var e=this,o=i()(this.preData);switch(this.modoBusqueda){case 1:"T"!==this.filtros.nemo&&(console.log(this.modoBusqueda,this.filtros),o=(0,Z.filterArray)(this.filtros.nemo,{field:"NEMO",list:o||[]}));break;case 2:if("T"!==this.instrucod){var a=[];o.forEach(function(o){var t=0;o.INSTRUCOD!==e.instrucod?t=1:"T"!==e.gradocod?o.GRADOCOD!==e.gradocod&&(t=1):"T"!==e.seccioncod&&o.SECCIONCOD!==e.seccioncod&&(t=1),0===t&&a.push(o)}),o=a}break}console.log({data:o}),3!==this.filtros.estados.length&&(o=(0,Z.filterArray)(this.filtros.estados,{field:"ESTADO",list:o||[]})),this.data=i()(o)},imprimir:function(e){var o=this.sie.api+"/HyoWjustifica/descargar/"+e.ALUCOD+"/"+e.FECHA+"?access_token="+this.sie.token;(0,W["default"])(o,e.ARCHIVO)},imprimirReporte:function(){var e="intranet/reporte-node/reporte",o={repcod:"newListadoJustificaciones",fecini:(0,X.Ay)(this.filtros.fIni,"DD/MM/YYYY"),fecfin:(0,X.Ay)(this.filtros.fFin,"DD/MM/YYYY"),chkestjus:this.filtros.estados,modoBusqueda:this.modoBusqueda,formato:"pdf",alumno:this.filtros.alumno};1===this.modoBusqueda?o.nemo=this.filtros.nemo:"T"!==this.instrucod&&(o.instrucod=this.instrucod,"T"!==this.gradocod&&(o.gradocod=this.gradocod)),(0,L.dialogConfirm)({message:"Seleccione el formato de impresion",cancel:"PDF",ok:"Excel"}).then(function(a){a?(o.formato="xlsx",(0,J["default"])(o,e,"Reporte ")):(0,J["default"])(o,e,"Reporte "),console.log(o)})},procesarData:function(){var e=this;return new Promise(function(o,a){var t=[];e.listSelect.forEach(function(e){var o=e.FECHAS,a=e.NOMCOMP,i=e.ESTADO,n=e.DETALLE_RECHAZO,l=e.FAMDES,s=e.USUCODFAM,c=e.ID,d=[];if("P"===i){var u={NOMCOMP:a,ESTADO:i,DETALLE_RECHAZO:n,FAMDES:l,USUCODFAM:s,ID:c};o.forEach(function(e){var o=e.ID_CONTROL,a=e.NEMO,t=e.ALUCOD,i=e.ESTADOCOD,n=e.ESTJUSCOD,l=e.ESTADODES,s=e.FECHA;d.push({ID_CONTROL:o,NEMO:a,ALUCOD:t,ESTADOCOD:i,ESTJUSCOD:n,ESTADODES:l,FECHA:s})}),u["FECHAS"]=d,t.push(u)}}),o(t)})},aceptarJus:function(){var e=this,o="A";this.procesarData().then(function(a){(0,L.dialogConfirm)({title:e.$t("confirmacion"),message:e.$t("mensajes.m0007")}).then(function(t){t&&U.$http.post("api/HyoJustificacionasistencias/modifyState",{lista:a,estado:o}).then(function(o){(0,K["default"])(e.$t("mensajes."+o)),console.log(o),e.cargaInicial()})})})},aceptar:function(){1===this.listSelect.length?this.openModalRechazar(!0):this.listSelect.length>1&&this.aceptarJus()},openModalRechazar:function(e){e=!0===e;var o=this.listSelect,a=e?"aceptar":"rechazar";o.length>1?(0,K["default"])("Solo puede ".concat(a," un registro a la vez"),"error"):"P"===o[0].ESTADO&&(this.dataRechazo={},this.dataRechazo=o[0],this.dataRechazo.DETALLE_RECHAZO=null,this.dataRechazo.TIPO=e?"Aceptar":"Rechazar",this.dataRechazo.MOTIVO=e?"Aceptación":"Rechazo",this.dataRechazo.MODO=e,this.modalRechazar=!0,this.dataRechazo.FH_JUSTIFICA=(0,X.Ay)(o[0].FH_REGISTRO,"DD/MM/YYYY"),console.log(this.dataRechazo))},eliminarJus:function(){var e=this;this.procesarData().then(function(o){o.length>0?(0,L.dialogConfirm)({title:e.$t("mensajes.m0006.confirmacion"),message:e.$t("mensajes.m0010")}).then(function(a){a&&U.$http.post("api/HyoJustificacionasistencias/deleteJustificacion",{lista:o}).then(function(o){o.json;(0,K["default"])(e.$t("mensajes.m0006.ok")),e.cargaInicial()})}):(0,L.dialogConfirm)({title:"¡Atención!",message:"Solo se pueden eliminar justificaciones pendientes",cancel:!1})})},rechazarJustificacion:function(e){var o=this;if(this.v$.dataRechazo.$touch(),console.log(1,this.v$.$invalid),!this.v$.$invalid){var a=e?"A":"R";this.procesarData().then(function(e){console.log(e)}),U.$http.post("api/HyoJustificacionasistencias/modifyState",{lista:[this.dataRechazo],estado:a}).then(function(e){(0,K["default"])(o.$t("mensajes."+e)),o.cargaInicial(),o.modalRechazar=!1})}},addJustificacion:function(){this.infoAdd={instrucod:"T",gradocod:"T",seccioncod:"T",alucod:null,fecIni:new Date,fecFin:new Date,estado:null,justificacion:null,detalleJustificacion:null,dataArchivo:{}},this.modalAddJusitificacion=!0,this.obtenerAlunosModal()},devuelveUrl:function(e){var o=e.ID,a=this.sie.api+"/HyoJustificacionasistencias/descargar/"+o+"?access_token="+this.sie.token;return a},obtenerAlunosModal:function(){var e=this;this.infoAdd.alucod=null;var o=this.infoAdd;this.infoAdd.instrucod&&this.infoAdd.gradocod&&this.infoAdd.seccioncod?U.$http.get("api/HyoSalonAl/getAlumnosNGSTutor",{params:o}).then(function(o){console.log(o),e.alumnos=(0,q["default"])(o,function(e){var o=e.NOMCOMP,a=e.ALUCOD;return{label:o,value:a}})}):(this.alumnos=[],this.infoAdd.alucod=null)},configurarJustificaciones:function(){var e=this;this.tabSelect=["SIE","SIEWEB"].indexOf((0,_["default"])().usucod)>=0?"C":"A",U.$http.get("api/HyoJustificanotificaciones/getConfig").then(function(o){var a=o.data,t=o.estados;e.perfilesAlertas=a,e.modalConfig=!0,e.estadosNoJus=t,e.modalState=t[0].ESTADOCOD}),U.$http.get("api/HyoJustificacionpermisos/getConfig").then(function(o){e.perfilesPermisos=o})},saveAlertas:function(){var e=this,o={add:[],del:[]},a="Alerta"===this.tabSelectConfig?"perfilesAlertas":"perfilesPermisos",t="Alerta"===this.tabSelectConfig?"HyoJustificanotificaciones":"HyoJustificacionpermisos";console.log(a),Object.keys(this[a]).forEach(function(t){e[a][t].forEach(function(e){var a=e.ESTADO,t=e.TIPCOD,i=e.ID,n=e.ESTADOCOD;a?i||o.add.push({TIPCOD:t,ESTADOCOD:n}):i&&o.del.push(i)})}),0===o.add.length&&0===o.del.length?(0,K["default"])("No hay cambios por guardar","error"):U.$http.post("api/".concat(t,"/saveConfig"),{info:o}).then(function(o){(0,K["default"])("Guardado Correctamente"),e.modalConfig=!1,e.cargaInicial()}).catch(function(){(0,K["default"])("no se pudo guardar la informacion","error")})},selectAlumno:function(e){this.infoAlumno=e,this.loadAsistencia(e)}},computed:{niveles:function(){var e=[{label:"Todos",value:"T"}];return this.baseGrados.niveles&&this.baseGrados.niveles.length>0&&this.baseGrados.niveles.forEach(function(o){e.push({value:o.INSTRUCOD,label:o.INSTRUDES})}),e},grados:function(){var e=[{label:"Todos",value:"T"}];return"T"!==this.instrucod&&this.baseGrados.grados&&this.baseGrados.grados[this.instrucod].length>0&&this.baseGrados.grados[this.instrucod].forEach(function(o){e.push({value:o.GRADOCOD,label:o.GRADODES})}),e},secciones:function(){var e=[{label:"Todos",value:"T"}];return"T"===this.gradocod&&(this.seccioncod="T"),"T"!==this.instrucod&&"T"!==this.gradocod&&this.baseGrados.secciones&&this.baseGrados.secciones[this.instrucod+this.gradocod].length>0&&this.baseGrados.secciones[this.instrucod+this.gradocod].forEach(function(o){e.push({value:o.SECCIONCOD,label:o.SECCIONCOD})}),e},nivelesAdd:function(){var e=[{label:"Todos",value:"T"}];return this.infoAdd.gradocod="T",this.baseGrados.niveles&&this.baseGrados.niveles.length>0&&this.baseGrados.niveles.forEach(function(o){e.push({value:o.INSTRUCOD,label:o.INSTRUDES})}),e},gradosAdd:function(){var e=[{label:"Todos",value:"T"}];return this.infoAdd.instrucod&&"T"!==this.infoAdd.instrucod&&this.baseGrados.grados&&this.baseGrados.grados[this.infoAdd.instrucod].length>0&&this.baseGrados.grados[this.infoAdd.instrucod].forEach(function(o){e.push({value:o.GRADOCOD,label:o.GRADODES})}),e},seccionesAdd:function(){var e=[{label:"Todos",value:"T"}];return this.infoAdd.seccioncod="T",this.infoAdd.instrucod&&"T"!==this.infoAdd.instrucod&&this.infoAdd.gradocod&&"T"!==this.infoAdd.gradocod&&this.baseGrados.secciones&&this.baseGrados.secciones[this.infoAdd.instrucod+this.infoAdd.gradocod].length>0&&this.baseGrados.secciones[this.infoAdd.instrucod+this.infoAdd.gradocod].forEach(function(o){e.push({value:o.SECCIONCOD,label:o.SECCIONCOD})}),e},maxLista:function(){var e=this.alto-200;return e/20},buttons:function(){var e=[{label:"Imprimir",icon:"print",click:this.imprimirReporte}];return 3===this.sie.ruta.nivel&&e.unshift({label:"Agregar",icon:"add",click:this.addJustificacion}),this.listSelect.length>0&&3===this.sie.ruta.nivel&&(e.unshift({label:"Aceptar",icon:"done_all",click:this.aceptar}),1===this.listSelect.length&&e.unshift({label:"Rechazar",icon:"call_missed",click:this.openModalRechazar}),e.unshift({label:"Eliminar",icon:"delete",click:this.eliminarJus})),e}},unmounted:function(){window.removeEventListener("resize",this.handleResize)},validations:function(){var e=this.dataRechazo,o={dataRechazo:{DETALLE_RECHAZO:{required:!e.MODO}}};return o},watch:{"infoAdd.instrucod":function(e){this.infoAdd.gradocod=null,this.infoAdd.seccioncod=null,this.alumnos=[],this.infoAdd.alucod=null},"this.infoAdd.gradocod":function(e){this.infoAdd.seccioncod=null,this.alumnos=[],this.infoAdd.alucod=null}},created:function(){var e=this;window.addEventListener("resize",this.handleResize),this.handleResize(),U.$http.get("api/HyoHorasisEstado/listarHorasisEstadoConducta",{params:{soloInjustificada:!1,salida:!0}}).then(function(o){var a=o.json;e.infoEstados=(0,q["default"])(a,function(e){return{label:e.ESTADODES,value:e.ESTADOCOD}})}),U.$http.get("api/HyoInstrus/obtGradosAsignadosTutor").then(function(o){e.baseGrados=o}),U.$http.get("api/HyoTablaSe/obtArrayDatos",{params:{princods:["tJustificacion"],objOrden:{campos:"SECUDES",orden:"asc"}}}).then(function(o){var a=o.json;e.tipoJustificacion=(0,q["default"])(a.tJustificacion,function(e){var o=e.SECUCOD,a=e.SECUDES;return{label:a,value:o}})}),U.$http.get("api/HyoHorasisEstado/listarHorasisEstado",{params:{momento:1}}).then(function(o){var a=o.json;a.forEach(function(o){e.estadoAsistencia[o.ESTADOCOD]={},e.estadoAsistencia[o.ESTADOCOD].color=o.COLORHEXF,e.estadoAsistencia[o.ESTADOCOD].etk=o.ESTADOETI,e.estadoAsistencia[o.ESTADOCOD].descripcion=o.ESTADODES}),e.cargaInicial()})}},ae=a(12807);const te=(0,ae.A)(oe,[["render",T]]);var ie=te}}]);