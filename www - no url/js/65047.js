"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[65047],{65047:function(e,t,a){a.r(t),a.d(t,{default:function(){return te}});a(12982),a(3110),a(56285);var s=a(61758),n=a(58790),o={class:"row q-col-gutter-sm"},r={class:"col-12"},i={class:"row q-pa-sm q-col-gutter-sm"},l={class:"col-xs-12 col-sm-6 col-md-4"},c={class:"items"},u={class:"col-12"},d={class:"row q-col-gutter-sm"},m={class:"col-xs-12 col-sm-6"},p={class:"row q-col-gutter-sm q-pa-sm"},f={class:"col-12"},h={class:"col-12 q-pt-md"},b={class:"column"},g={class:"col self-end"},v={class:"col-12"},k={class:"col-xs-12 col-sm-6"},w={class:"row q-col-gutter-sm q-pa-sm"},A={class:"col-12"},M={class:"col-xs-12 q-pt-md"},y={class:"row q-col-gutter-sm justify-end"},S={class:"col-4"},C={class:"col-4"},q={class:"col-12"},L={key:0,class:"col-12"},x={class:"row q-col-gutter-sm"},P={class:"col-12"},R={class:"col-12",style:{"padding-bottom":"8px"}},I={class:"q-body-3",style:{position:"relative"}};function F(e,t){var a=(0,s.g2)("item"),F=(0,s.g2)("q-card"),O=(0,s.g2)("header-btn"),_=(0,s.g2)("q-select"),D=(0,s.g2)("sie-apexchart"),Y=(0,s.g2)("q-date"),U=(0,s.g2)("q-popup-proxy"),T=(0,s.g2)("q-icon"),V=(0,s.g2)("q-input"),N=(0,s.g2)("q-card-media"),Q=(0,s.g2)("q-item-tile"),E=(0,s.g2)("q-card-main"),$=(0,s.g2)("slide"),z=(0,s.g2)("carousel"),X=(0,s.g2)("q-page"),B=(0,s.gN)("lazy");return(0,s.uX)(),(0,s.Wv)(X,{class:"biblioteca-home q-pa-sm"},{default:(0,s.k6)(function(){return[(0,s.Lk)("div",o,[(0,s.Lk)("div",r,[(0,s.bF)(F,{flat:"",bordered:""},{default:(0,s.k6)(function(){return[(0,s.Lk)("div",i,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.items,function(e,t){return(0,s.uX)(),(0,s.CE)("div",l,[(0,s.Lk)("div",c,[(0,s.bF)(a,{color:e.color,nombre:e.name,icon:e.icon,description:e.description,number:e.number},null,8,["color","nombre","icon","description","number"])])])}),256))])]}),_:1})]),(0,s.Lk)("div",u,[(0,s.Lk)("div",d,[(0,s.Lk)("div",m,[(0,s.bF)(F,{flat:"",bordered:""},{default:(0,s.k6)(function(){return[(0,s.Lk)("div",p,[(0,s.Lk)("div",f,[(0,s.bF)(O,{name:"Préstamos por año","padding-x":"","font-size":"15px"})]),(0,s.Lk)("div",h,[(0,s.Lk)("div",b,[(0,s.Lk)("div",g,[(0,s.bF)(_,{modelValue:e.anio,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.anio=t}),options:e.anios,label:"Año",onInput:e.getPrestamos,"emit-value":""},null,8,["modelValue","options","onInput"])])])]),(0,s.Lk)("div",v,[(0,s.bF)(D,{type:"bar",height:"350",options:e.chartActSemResOpt,series:e.chartActSemRes.series},null,8,["options","series"])])])]}),_:1})]),(0,s.Lk)("div",k,[(0,s.bF)(F,{flat:"",bordered:""},{default:(0,s.k6)(function(){return[(0,s.Lk)("div",w,[(0,s.Lk)("div",A,[(0,s.bF)(O,{name:"Top 10 de Títulos más prestados (Estudiantes)","padding-x":"","font-size":"15px"})]),(0,s.Lk)("div",M,[(0,s.Lk)("div",y,[(0,s.Lk)("div",S,[(0,s.bF)(V,{label:"Desde",debounce:"500",maxlength:"10",format:"##/##/####",modelValue:e.desde,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.desde=t}),mask:"##/##/####",readonly:""},{append:(0,s.k6)(function(){return[(0,s.bF)(T,{class:"cursor-pointer",name:"date_range"},{default:(0,s.k6)(function(){return[(0,s.bF)(U,{ref:"qDateProxy1","transition-show":"scale","transition-hide":"scale"},{default:(0,s.k6)(function(){return[(0,s.bF)(Y,{mask:"DD/MM/YYYY",modelValue:e.desde,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.desde=t}),onInput:t[2]||(t[2]=function(t){e.$refs.qDateProxy1.hide(),e.getSolicitados()})},null,8,["modelValue"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])]),(0,s.Lk)("div",C,[(0,s.bF)(V,{label:"Hasta",debounce:"500",maxlength:"10",format:"##/##/####",modelValue:e.hasta,"onUpdate:modelValue":t[6]||(t[6]=function(t){return e.hasta=t}),mask:"##/##/####",readonly:""},{append:(0,s.k6)(function(){return[(0,s.bF)(T,{class:"cursor-pointer",name:"date_range"},{default:(0,s.k6)(function(){return[(0,s.bF)(U,{ref:"qDateProxy2","transition-show":"scale","transition-hide":"scale"},{default:(0,s.k6)(function(){return[(0,s.bF)(Y,{mask:"DD/MM/YYYY",modelValue:e.hasta,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.hasta=t}),onInput:t[5]||(t[5]=function(t){e.$refs.qDateProxy2.hide(),e.getSolicitados()})},null,8,["modelValue"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])])])]),(0,s.Lk)("div",q,[(0,s.bF)(D,{type:"donut",height:e.chartMasPrestadosRes.series&&e.chartMasPrestadosRes.series.length>0?397:365,options:e.chartMasPrestadosOpt,series:e.chartMasPrestadosRes.series&&e.chartMasPrestadosRes.series},null,8,["height","options","series"])])])]}),_:1})])])]),e.recomendados.length>0?((0,s.uX)(),(0,s.CE)("div",L,[(0,s.bF)(F,{flat:"",bordered:""},{default:(0,s.k6)(function(){return[(0,s.Lk)("div",x,[(0,s.Lk)("div",P,[(0,s.bF)(O,{name:"Recomendados",auto:!1,size:"10px","font-size":"15px",buttons:e.buttons},null,8,["buttons"])]),(0,s.Lk)("div",R,[(0,s.Lk)("div",I,[(0,s.bF)(z,{ref:"carousel","per-page-custom":[[360,2],[480,3],[768,5],[1024,6],[1360,7]]},{default:(0,s.k6)(function(){return[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.recomendados,function(t){return(0,s.uX)(),(0,s.Wv)($,{class:"q-px-sm recomendados"},{default:(0,s.k6)(function(){return[(0,s.bF)(F,{class:"full-height",flat:"",bordered:""},{default:(0,s.k6)(function(){return[(0,s.bF)(N,null,{default:(0,s.k6)(function(){return[(0,s.bo)((0,s.Lk)("img",null,null,512),[[B,{src:e.generarUrlImagen(t),error:"statics/img/librodefault.png"}]])]}),_:2},1024),(0,s.bF)(E,null,{default:(0,s.k6)(function(){return[(0,s.bF)(Q,{class:"q-caption text-bold",label:"",lines:"2"},{default:(0,s.k6)(function(){return[(0,s.eW)((0,n.v_)(t.TITULO),1)]}),_:2},1024),(0,s.bF)(Q,{class:"q-caption",sublabel:""},{default:(0,s.k6)(function(){return[(0,s.eW)((0,n.v_)(t.AUTOR),1)]}),_:2},1024)]}),_:2},1024)]}),_:2},1024)]}),_:2},1024)}),256))]}),_:1},512)])])])]}),_:1})])):(0,s.Q3)("v-if",!0)])]}),_:1})}var O=a(76080),_=a.n(O),D=a(45254),Y=a.n(D),U=(a(30683),a(77507),a(52133),a(10239),a(50310),a(6724),a(70199),a(83190),a(6123)),T=a(9736),V=a(16648),N={data:function(){return{config:{},rows:[],fields:[{name:"USUNOM",label:"Nombres",field:"USUNOM",align:"center",sortable:!0},{name:"TIPNOM",label:"Perfil",field:"TIPNOM",align:"center",sortable:!0}]}}},Q=a(57668),E=a(88567),$=a(95718),z=a(2144),X=a(38088),B=a(19066),H=a(54267),j=a(18105),G=a(12143),W=a(95477),K=a(53380),J={components:{QInput:T.A,QSelect:V.A,QCard:E.A,QCardSection:$.A,item:z.A,Carousel:X.F,Slide:X.q,SieApexchart:B.A,QDate:G.A,QPopupProxy:W.A,QSeparator:K.A,QPage:U.Tu,QIcon:U.bP,QCardMedia:U.wy,QCardMain:U.d1,QItemTile:U.lp},mixins:[N],data:function(){var e=this;return{buttons:[{label:"",flat:!0,icon:"arrow_forward",click:function(){e.$router.push({name:"biblioteca.mantenimiento.recomendado"})}}],text:"",openModal:!1,microfono:!1,sie:(0,Q["default"])(),items:[],recomendados:[],chartActSemRes:{},chartMasPrestadosRes:{},chartActSemResOpt:{},chartMasPrestadosOpt:{},anios:[],anio:"",desde:"",hasta:""}},methods:{getPrestamos:function(){var e=this;return Y()(_()().m(function t(){var a;return _()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,e.$http.get("api/OperacionesController/getPrestamos",{params:{params:{anio:e.anio}}});case 1:a=t.v,e.setChartActSemRes(a),e.setChartActSemResOpt();case 2:return t.a(2)}},t)}))()},getSolicitados:function(){var e=this;return Y()(_()().m(function t(){var a;return _()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,e.$http.get("api/OperacionesController/getLibrosSolicitadosAlumno",{params:{params:{desde:e.desde.split("/").reverse().join("/"),hasta:e.hasta.split("/").reverse().join("/")}}});case 1:a=t.v,e.setChartMasPrestadosRes(a),e.chartMasPrestadosOpt=e.setChartMasPrestadosOpt();case 2:return t.a(2)}},t)}))()},setChartActSemRes:function(e){var t=(0,H.meses)(),a=[],s=e.map(function(e){return a.push(t[e.MES]),e.CANTIDAD_PRESTAMO});this.chartActSemRes={series:[{name:"Préstamos",data:s}],meses:a}},setChartMasPrestadosRes:function(e){var t=[],a=e.map(function(e){return t.push(e.TITULO),e.CANTIDAD});this.chartMasPrestadosRes={series:a,titulos:t}},setChartActSemResOpt:function(){this.chartActSemResOpt={colors:H.backgroundColor,chart:{type:"bar"},plotOptions:{bar:{horizontal:!1,distributed:!0}},labels:[""],dataLabels:{enabled:!1},stroke:{show:!0,width:10,colors:["transparent"]},legend:{show:!1},xaxis:{categories:this.chartActSemRes.meses}}},setChartMasPrestadosOpt:function(){return{colors:H.backgroundColor,chart:{type:"donut"},dataLabels:{enabled:!1},plotOptions:{pie:{donut:{size:"80%"}}},labels:this.chartMasPrestadosRes.titulos,legend:{position:"bottom",horizontalAlign:"left",formatter:function(e,t){return[e," ( ",t.w.globals.series[t.seriesIndex]," ) "]}}}},getUsuarioIA:function(){var e=this;return Y()(_()().m(function t(){var a,s,n;return _()().w(function(t){while(1)switch(t.p=t.n){case 0:return t.p=0,t.n=1,e.$http.get("api/HyoBmCatalogacion/getDatosUsuarioIA",{params:{text:e.text}});case 1:a=t.v,s=a.result,e.rows=s,e.openModal=!0,t.n=3;break;case 2:t.p=2,n=t.v,e.$alert(n.message,"warning");case 3:return t.a(2)}},t,null,[[0,2]])}))()},activarMicrofono:function(){var e=this;if(this.text="",this.microfono=!this.microfono,!0===this.microfono){var t=window.SpeechRecognition||window.webkitSpeechRecognition,a=window.SpeechGrammarList||window.webkitSpeechGrammarList,s=new t,n=new a;s.grammars=n,s.continuous=!1,s.lang="es-ES",s.interimResults=!1,s.maxAlternatives=1,s.start(),s.onresult=function(t){var a=t.results[0][0].transcript;e.text=a,e.getUsuarioIA()},s.onspeechend=function(){s.stop(),e.microfono=!1}}},createReport:function(e){e.modulo=e.modulo||"reporte";var t=document.body.querySelector("#elReportes");t?document.body.querySelector("#elReportes").innerHTML="":(t=document.createElement("div"),t.id="elReportes",document.body.appendChild(t));var a="sieweb/".concat(e.modulo),s=document.createElement("form");s.style.display="none",s.action=a,s.method="POST",s.target="_blank";var n=document.createElement("input");n.name="data",n.type="hidden",n.value=JSON.stringify(e),s.appendChild(n),t.appendChild(s),s.submit()},generarUrlImagen:function(e){if(e.IMAGENISBN){var t=e.ISBN||-1;return"https://covers.openlibrary.org/b/isbn/".concat(t,"-M.jpg?default=false")}return this.sie.api+"/HyoCatalogo/descargarImagenes/"+e.IMG+"?sie-token="+this.sie.token}},created:function(){var e=this;return Y()(_()().m(function t(){var a,s,n,o;return _()().w(function(t){while(1)switch(t.n){case 0:return a=new Date,s=(0,j.Ay)(a,"MM"),n=(0,j.Ay)(a,"YYYY"),e.desde=(0,j.Ay)(new Date("".concat(n,"/").concat(s,"/01")),"DD/MM/YYYY"),e.hasta=(0,j.Ay)(a,"DD/MM/YYYY"),e.anio=n,t.n=1,e.$http.get("api/OperacionesController/getAniosOperacion");case 1:return o=t.v,o=o.map(function(e){return{label:e.ANIO,value:e.ANIO}}),e.anios=o,t.n=2,e.getPrestamos();case 2:return t.n=3,e.getSolicitados();case 3:return t.n=4,e.$http.get("api/HyoBmCatalogacion/getInventarioContadores",{params:{isCard:!0}});case 4:return e.items=t.v,t.n=5,e.$http.get("api/BmRecomendacionesController/getRecomendados",{params:{params:{limit:12}}});case 5:e.recomendados=t.v;case 6:return t.a(2)}},t)}))()},mounted:function(){}},Z=a(12807);const ee=(0,Z.A)(J,[["render",F]]);var te=ee}}]);