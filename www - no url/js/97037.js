"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[97037],{97037:function(e,t,n){n.r(t),n.d(t,{default:function(){return $}});var a=n(8445),l=n.n(a),o=(n(71225),n(50310),n(5962),n(83190),n(61758)),i=n(58790),s={class:"q-card q-mt-xs"},r={class:"row q-ma-xs"},u={class:"q-card q-mt-xs"},d={class:"row"},c={class:"row text-bold q-item-label"},f={class:"row q-item-sublabel"},m={class:"row text-bold q-item-label"},v={class:"row q-item-sublabel"},p={class:"row"},b={class:"row"},A={key:0,class:"row"},h={class:"q-ma-sm"},k={class:"row"},L={class:"text-bold"},E={class:"row q-mx-md q-mt-xs"},_={class:"row q-mx-md q-mt-xs"},D={class:"row q-mx-md q-mt-xs"},O={class:"row q-mx-md q-mt-xs"},F={key:0,class:"row q-mx-md q-mt-xs"},R={class:"row q-mx-md q-mt-xs"},T={key:1,class:"q-card q-mt-sm"},q={class:"row q-mx-md q-mt-xs"},g={class:"row q-mx-md q-mt-xs"},x={class:"row q-mx-md q-mt-xs"};function C(e,t){var n=(0,o.g2)("header-btn"),a=(0,o.g2)("q-search"),C=(0,o.g2)("q-datetime"),w=(0,o.g2)("q-btn"),I=(0,o.g2)("q-icon"),P=(0,o.g2)("q-item-main"),S=(0,o.g2)("q-list-header"),Q=(0,o.g2)("q-item"),M=(0,o.g2)("q-tooltip"),N=(0,o.g2)("q-item-side"),V=(0,o.g2)("q-select"),y=(0,o.g2)("q-input"),U=(0,o.g2)("q-field"),H=(0,o.g2)("q-popup-edit"),X=(0,o.g2)("q-item-separator"),z=(0,o.g2)("q-card"),$=(0,o.g2)("q-collapsible"),j=(0,o.g2)("recojo-archivo"),G=(0,o.g2)("q-list"),B=(0,o.g2)("sie-modal"),Y=(0,o.g2)("q-page");return(0,o.uX)(),(0,o.Wv)(Y,{class:"column q-pa-md"},{default:(0,o.k6)(function(){return[(0,o.bF)(n,{name:"Aceptación de Permisos",buttons:e.buttons},null,8,["buttons"]),(0,o.Lk)("div",s,[(0,o.Lk)("div",r,[(0,o.bF)(a,{class:"q-if-outlined col",modelValue:e.filter,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.filter=t}),onInput:e.filtrarData},null,8,["modelValue","onInput"]),(0,o.bF)(C,{class:"q-if-outlined",modelValue:e.fecIni,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.fecIni=t}),type:"date",format:"DD/MM/YYYY","float-label":"Desde",onInput:e.cambiarFecha},null,8,["modelValue","onInput"]),(0,o.bF)(C,{class:"q-if-outlined",modelValue:e.fecFin,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.fecFin=t}),type:"date",format:"DD/MM/YYYY","float-label":"Hasta",onInput:e.cambiarFecha},null,8,["modelValue","onInput"]),e.id?((0,o.uX)(),(0,o.Wv)(w,{key:0,class:"q-mt-sm",flat:"",dense:"",round:"",icon:"search",onClick:e.cambiarFecha},null,8,["onClick"])):(0,o.Q3)("v-if",!0)])]),(0,o.Lk)("div",u,[(0,o.bF)(G,{separator:"",style:(0,i.Tr)({"max-height":e.alto+"px","overflow-y":"auto"})},{default:(0,o.k6)(function(){return[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.infoAprobacion,function(n){return(0,o.uX)(),(0,o.CE)(o.FK,null,[n.DATA.length>1?((0,o.uX)(),(0,o.Wv)($,{key:0,opened:n.DATA.length>0,highlight:"","inset-separator":""},{header:(0,o.k6)(function(){return[(0,o.bF)(Q,{class:"col"},{default:(0,o.k6)(function(){return[(0,o.bF)(P,{class:"column"},{default:(0,o.k6)(function(){return[(0,o.Lk)("div",d,[1===n.ES_EMERGENCIA?((0,o.uX)(),(0,o.Wv)(I,{key:0,name:"error",color:"red-14"})):(0,o.Q3)("v-if",!0),(0,o.Lk)("span",c,(0,i.v_)(n.NOMCOMP),1)]),(0,o.Lk)("div",f,[t[4]||(t[4]=(0,o.Lk)("div",{class:"text-bold"},"Fecha:  ",-1)),(0,o.Lk)("span",null,(0,i.v_)(n.FH_SALIDA_PROP_FORMAT),1),t[5]||(t[5]=(0,o.Lk)("div",{class:"text-bold"}," Motivo:  ",-1)),(0,o.Lk)("span",null,(0,i.v_)(n.DESCRIPCION),1)])]}),_:2},1024),(0,o.bF)(N,{right:""},{default:(0,o.k6)(function(){return[(0,o.bF)(I,{name:"info_outline"}),(0,o.bF)(M,{class:"column",anchor:"bottom middle",self:"top middle",offset:[10,10]},{default:(0,o.k6)(function(){return[(0,o.bF)(S,null,{default:(0,o.k6)(function(){return l()(t[6]||(t[6]=[(0,o.Lk)("div",{class:"text-bold"},"Recogido por: ",-1)]))}),_:1}),(0,o.bF)(Q,{class:"row"},{default:(0,o.k6)(function(){return[t[7]||(t[7]=(0,o.Lk)("div",{class:"text-bold"},"Nombre: ",-1)),(0,o.Lk)("span",null,(0,i.v_)(n.DATA[0].NOMCOMP_RECOJO)+" ",1)]}),_:2},1024),(0,o.bF)(Q,{class:"row"},{default:(0,o.k6)(function(){return[t[8]||(t[8]=(0,o.Lk)("div",{class:"text-bold"},"Parentesco: ",-1)),(0,o.Lk)("span",null,(0,i.v_)(n.DATA[0].PARENTESCO),1)]}),_:2},1024)]}),_:2},1024)]}),_:2},1024)]}),_:2},1024)]}),default:(0,o.k6)(function(){return[(0,o.bF)(z,null,{default:(0,o.k6)(function(){return[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.DATA,function(n){return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.bF)(Q,{highlight:""},{default:(0,o.k6)(function(){return[(0,o.bF)(P,{class:"row"},{default:(0,o.k6)(function(){return[t[9]||(t[9]=(0,o.Lk)("div",{class:"text-bold"},"Paso :  ",-1)),(0,o.Lk)("span",null,(0,i.v_)(n.PASO),1),t[10]||(t[10]=(0,o.Lk)("span",null,"xxx",-1))]}),_:2},1024),(0,o.bF)(N,null,{default:(0,o.k6)(function(){return[(0,o.bF)(V,{class:"q-if-outlined",options:e.estadosAprobacion,modelValue:n.ESTADO_APR,"onUpdate:modelValue":function(e){return n.ESTADO_APR=e},"float-label":"Estado"},null,8,["options","modelValue","onUpdate:modelValue"])]}),_:2},1024),2===n.ESTADO_APR?((0,o.uX)(),(0,o.Wv)(N,{key:0},{default:(0,o.k6)(function(){return[(0,o.bF)(I,{name:"remove_red_eye",color:n.DETALLE&&n.DETALLE.length>0?"secondary":"light"},{default:(0,o.k6)(function(){return[(0,o.bF)(H,{class:"justify-center",modelValue:n.DETALLE,"onUpdate:modelValue":function(e){return n.DETALLE=e},cover:!1,offset:[-33,-20]},{default:(0,o.k6)(function(){return[t[11]||(t[11]=(0,o.Lk)("div",{class:"text-bold","text-color":"secondary"},"Motivo de Rechazo",-1)),(0,o.bF)(U,{count:400,"max-length":400},{default:(0,o.k6)(function(){return[(0,o.bF)(y,{modelValue:n.DETALLE,"onUpdate:modelValue":function(e){return n.DETALLE=e},"max-length":400,type:"textarea",rows:"3"},null,8,["modelValue","onUpdate:modelValue"])]}),_:2},1024)]}),_:2},1032,["modelValue","onUpdate:modelValue"])]}),_:2},1032,["color"])]}),_:2},1024)):(0,o.Q3)("v-if",!0)]}),_:2},1024),(0,o.bF)(X)],64)}),256))]}),_:2},1024)]}),_:2},1032,["opened"])):((0,o.uX)(),(0,o.Wv)(Q,{key:1,class:"col q-mx-md"},{default:(0,o.k6)(function(){return[(0,o.bF)(P,{class:"column"},{default:(0,o.k6)(function(){return[(0,o.Lk)("span",m,(0,i.v_)(n.NOMCOMP),1),(0,o.Lk)("div",v,[t[12]||(t[12]=(0,o.Lk)("div",{class:"text-bold"},"Fecha:  ",-1)),(0,o.Lk)("span",null,(0,i.v_)(n.FH_SALIDA_PROP_FORMAT),1),t[13]||(t[13]=(0,o.Lk)("div",{class:"text-bold"}," Motivo:  ",-1)),(0,o.Lk)("span",null,(0,i.v_)(n.DESCRIPCION),1)]),(0,o.Lk)("div",p,[t[14]||(t[14]=(0,o.Lk)("div",{class:"text-bold"},"Paso :  ",-1)),(0,o.Lk)("span",null,(0,i.v_)(n.DATA[0].PASO),1)])]}),_:2},1024),(0,o.bF)(N,{class:"column"},{default:(0,o.k6)(function(){return[(0,o.bF)(V,{class:"q-if-outlined",options:e.estadosAprobacion,modelValue:n.DATA[0].ESTADO_APR,"onUpdate:modelValue":function(e){return n.DATA[0].ESTADO_APR=e},"float-label":"Estado"},null,8,["options","modelValue","onUpdate:modelValue"]),(0,o.Lk)("div",b,[n.ADJUNTO_ORIGINAL?((0,o.uX)(),(0,o.CE)("div",A,[t[15]||(t[15]=(0,o.Lk)("div",{class:"row items-center"},[(0,o.Lk)("div",{class:"text-bold"},"Adjunto:")],-1)),(0,o.bF)(j,{data:n.DATA[0]},null,8,["data"])])):(0,o.Q3)("v-if",!0)])]}),_:2},1024),(0,o.bF)(N,{right:""},{default:(0,o.k6)(function(){return[(0,o.bF)(w,{flat:"",dense:"",round:"",icon:"info",onClick:function(t){return e.openDetalle(n.DATA[0])}},null,8,["onClick"])]}),_:2},1024)]}),_:2},1024))],64)}),256))]}),_:1},8,["style"])]),(0,o.bF)(B,{modelValue:e.modalDetalle,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.modalDetalle=t})},{default:(0,o.k6)(function(){return[(0,o.Lk)("div",h,[(0,o.Lk)("div",k,[(0,o.Lk)("span",L,"Detalle de permiso "+(0,i.v_)(e.infoDetalle.DESCRIPCION),1)]),t[25]||(t[25]=(0,o.Lk)("div",{class:"text-bold q-my-sm"},"Salida",-1)),(0,o.Lk)("div",E,[t[16]||(t[16]=(0,o.Lk)("div",{class:"text-bold"},"Usuario:  ",-1)),(0,o.Lk)("span",null,(0,i.v_)(e.infoDetalle.USUNOM_REGISTRO),1)]),(0,o.Lk)("div",_,[t[17]||(t[17]=(0,o.Lk)("div",{class:"text-bold"},"¿Quien Recoje?  ",-1)),(0,o.Lk)("span",null,(0,i.v_)(e.infoDetalle.NOMCOMP_RECOJO)+" ("+(0,i.v_)(e.infoDetalle.PARENTESCO)+")",1)]),(0,o.Lk)("div",D,[t[18]||(t[18]=(0,o.Lk)("div",{class:"text-bold"},"Fecha:  ",-1)),(0,o.Lk)("span",null,(0,i.v_)(e.infoDetalle.FH_SALIDA_PROP_FORMAT),1)]),(0,o.Lk)("div",O,[t[19]||(t[19]=(0,o.Lk)("div",{class:"text-bold"},"Detalle:  ",-1)),(0,o.Lk)("span",null,(0,i.v_)(e.infoDetalle.DETALLE),1)]),e.infoDetalle.ESTADO>2?((0,o.uX)(),(0,o.CE)("div",F,[t[20]||(t[20]=(0,o.Lk)("div",{class:"text-bold"},"Realizado:  ",-1)),(0,o.Lk)("span",null,(0,i.v_)(e.infoDetalle.FH_SALIDA_EFECTIVA_FORMAT),1)])):(0,o.Q3)("v-if",!0),(0,o.Lk)("div",R,[t[21]||(t[21]=(0,o.Lk)("div",{class:"text-bold"},"¿El estudiante retornarà?  ",-1)),(0,o.Lk)("span",null,(0,i.v_)(1===e.infoDetalle.RETORNA?"Si":"No"),1)]),2===e.infoDetalle.ESTADO&&e.showRechazados?((0,o.uX)(),(0,o.CE)("div",T,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.infoDetalle.ADICIONAL,function(e){return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",q,[t[22]||(t[22]=(0,o.Lk)("div",{class:"text-bold"},"Rechazado por :  ",-1)),(0,o.Lk)("span",null,(0,i.v_)(e.USUNOM),1)]),(0,o.Lk)("div",g,[t[23]||(t[23]=(0,o.Lk)("div",{class:"text-bold"},"Registrado el :  ",-1)),(0,o.Lk)("span",null,(0,i.v_)(e.FH_REGISTRO_FORMAT),1)]),(0,o.Lk)("div",x,[t[24]||(t[24]=(0,o.Lk)("div",{class:"text-bold"},"Motivo :  ",-1)),(0,o.Lk)("span",null,(0,i.v_)(e.DETALLE),1)])],64)}),256))])):(0,o.Q3)("v-if",!0)])]}),_:1},8,["modelValue"])]}),_:1})}n(10239),n(90095),n(515),n(13715);var w=n(83972),I=n(6123),P=n(93616),S=n(30545),Q=n(57668),M=n(80660),N=n(67329),V=n(82640),y=n(92173),U=n(982),H={setup:function(){var e=(0,w.fG)();return{v$:e}},components:{QSelect:I.Si,QToggle:I.c5,QCheckbox:I.vZ,QBtnToggle:I.QL,QRadio:I.$,QTable:S.A,QTh:I.EJ,QTr:I.qh,QTd:I.Ef,QTableColumns:I.$s,QPopupEdit:I.GT,QChip:I.wQ,QFabAction:I.B$,QPageSticky:I._U,QFab:I.l6,QDatetime:I.T5,QTab:I.zu,QTabs:I.uw,sieEstudiantes:y.Ay,sieSelect:P.A,QCollapsible:I.eS,recojoArchivo:N.A,QPage:I.Tu,QSearch:I.Ks,QBtn:I.Il,QList:I.Mb,QItem:I.H0,QItemMain:I.mF,QIcon:I.bP,QItemSide:I.n1,QTooltip:I.nC,QListHeader:I.XR,QCard:I.C$,QField:I.Om,QInput:I.ie,QItemSeparator:I.CL},data:function(){return{sie:(0,Q["default"])(),infoAprobacion:{},infoAprobacionBase:{},objParent:{},alto:0,filter:"",id:this.$route.params.id,fecIni:new Date,fecFin:new Date,infoDetalle:{},modalDetalle:!1,estadosAprobacion:[{value:0,label:"Pendiente"},{value:1,label:"Aprobado"},{value:2,label:"Rechazado"}]}},methods:{openDetalle:function(e){this.infoDetalle=e,this.modalDetalle=!0},handleResize:function(){this.alto=window.innerHeight-200},cambiarFecha:function(){this.id=null,this.init()},init:function(){var e=this,t={};t=this.id?{id:this.id}:{fecIni:this.fecIni,fecFin:this.fecFin},M.$http.get("api/HyoRpregistro/obtRegistroAprobacion",{params:{info:t}}).then(function(t){var n=t.json;e.infoAprobacionBase=n,e.filtrarData()})},filtrarData:function(){var e=this;this.infoAprobacion={},Object.keys(this.infoAprobacionBase).forEach(function(t){var n=0;0===n&&e.filter.length>0&&e.infoAprobacionBase[t].NOMCOMP.toUpperCase().indexOf(e.filter.toUpperCase())<0&&(n=1),0===n&&(e.infoAprobacion[t]=e.infoAprobacionBase[t])})},grabar:function(){var e=this;this.v$.$touch();var t=[];Object.keys(this.infoAprobacion).forEach(function(n){e.infoAprobacion[n].DATA.forEach(function(e){var n=e.ID_CONF,a=e.ID,l=e.ESTADO_APR,o=e.DETALLE;if(0!==l){var i={ID_CONF:n,ID_REGISTRO:a,ESTADO:l};2===l&&o&&o.length>0&&(i.DETALLE=o),t.push(i)}})}),t.length>0&&M.$http.post("api/HyoRpautorizacion/saveAutorizacion",{data:t}).then(function(t){var n=t.json;(0,U["default"])(e.$t("mensajes."+n.msg),n.type),n.type||e.init()})}},computed:{fechaMaxima:function(){var e=new Date;return new Date(e.getTime()+6e4*this.minDiff)},minRetorno:function(){var e=this.FH_SALIDA_PROP;return new Date(e.getTime()+6e5)},maxLista:function(){var e=this.alto-200;return e/20},buttons:function(){var e=[];return 3===this.sie.ruta.nivel&&e.unshift({label:"Grabar",icon:"save",click:this.grabar}),e}},unmounted:function(){window.removeEventListener("resize",this.handleResize)},watch:{ES_EMERGENCIA:function(){var e=1===this.ES_EMERGENCIA?this.minDiffEmer:this.minDiffReg;this.calcularTolerancia(e)}},validations:function(){var e={ALUCOD:{required:V.mw},ID_MOTIVO:{required:V.mw},FH_SALIDA_PROP:{required:V.mw},DOC_RECOJO:{required:V.mw},NOMCOMP_RECOJO:{required:V.mw},PARENT_RECOJO:{required:V.mw}};return 1===this.RETORNA&&(e.PARENT_RETORNO={required:V.mw},e.NOMCOMP_RETORNO={required:V.mw},e.FH_RETORNO_PROP={required:V.mw}),e},created:function(){var e=this;console.log(this.$route.params.id),window.addEventListener("resize",this.handleResize),this.handleResize(),this.init();var t={activos:1};this.sie.esFamilia&&(t.familia=1),this.sie.esOtros&&(t.personal=1),M.$http.get("api/HyoRpmotivos/getMotivos",{params:t}).then(function(t){var n=t.json;e.motivos=n}),M.$http.get("api/HyoTablaSe/datosSe",{params:{princod:"009"}}).then(function(t){var n=t.listar;e.listParent=[],n.forEach(function(t){var n=t.SECUEQU,a=t.SECUDES,l=t.SECUCOD;n&&(e.objParent[l]=n),e.listParent.push({value:l,label:a})})})}},X=n(12807);const z=(0,X.A)(H,[["render",C]]);var $=z}}]);