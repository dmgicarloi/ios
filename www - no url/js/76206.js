"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[76206],{76206:function(e,n,o){o.r(n),o.d(n,{default:function(){return P}});var a=o(61758),t={class:"column col q-ma-sm"},l={class:"q-ma-sm"},s={class:"q-col-gutter-sm"},r={class:"row q-gutter-sm col"},i={class:"row q-gutter-sm col"},u={class:"row q-gutter-sm col"},c={class:"q-ma-sm"},d={class:"column q-gutter-sm"},m={class:"row col"},f={class:"row col q-gutter-sm"},A={key:0,class:"row"},S={class:"q-card col q-mt-sm"};function p(e,n){var o=this,p=(0,a.g2)("header-btn"),b=(0,a.g2)("q-select"),g=(0,a.g2)("q-input"),h=(0,a.g2)("q-toggle"),v=(0,a.g2)("sie-editor"),O=(0,a.g2)("sie-modal"),E=(0,a.g2)("sie-table"),D=(0,a.g2)("q-form");return(0,a.uX)(),(0,a.CE)("div",t,[(0,a.bF)(p,{name:"Configuración de Pre Interesados",buttons:e.buttons},null,8,["buttons"]),(0,a.bF)(O,{modelValue:e.modalMensaje,"onUpdate:modelValue":n[4]||(n[4]=function(n){return e.modalMensaje=n}),title:"Configuración de mensajes",onSubmit:e.saveMensajes},{default:(0,a.k6)(function(){return[(0,a.Lk)("div",l,[(0,a.Lk)("div",s,[(0,a.Lk)("div",r,[(0,a.bF)(b,{class:"col",modelValue:e.momentoSelect,"onUpdate:modelValue":n[0]||(n[0]=function(n){return e.momentoSelect=n}),options:e.momentos,label:"Momento"},null,8,["modelValue","options"])]),[0,1].indexOf(e.momentoSelect)>=0?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[(0,a.Lk)("div",i,[(0,a.bF)(g,{class:"col",modelValue:e.infoMensajes[e.momentoSelect].TITULO,"onUpdate:modelValue":n[1]||(n[1]=function(n){return e.infoMensajes[e.momentoSelect].TITULO=n}),label:"Titulo"},null,8,["modelValue"]),(0,a.bF)(h,{modelValue:e.infoMensajes[e.momentoSelect].ESTADO,"onUpdate:modelValue":n[2]||(n[2]=function(n){return e.infoMensajes[e.momentoSelect].ESTADO=n}),label:"Activo","true-value":1,"false-value":0},null,8,["modelValue"])]),(0,a.Lk)("div",u,[(0,a.bF)(v,{class:"col",modelValue:e.infoMensajes[e.momentoSelect].MENSAJE,"onUpdate:modelValue":n[3]||(n[3]=function(n){return e.infoMensajes[e.momentoSelect].MENSAJE=n}),label:e.$t("matricula.mensaje")},null,8,["modelValue","label"])])],64)):(0,a.Q3)("v-if",!0)])])]}),_:1},8,["modelValue","onSubmit"]),(0,a.bF)(O,{modelValue:e.modalAno,"onUpdate:modelValue":n[8]||(n[8]=function(n){return e.modalAno=n}),title:"Año de Proceso",onSubmit:e.grabar},{default:(0,a.k6)(function(){return[(0,a.bF)(D,{ref:"formAno"},{default:(0,a.k6)(function(){return[(0,a.Lk)("div",c,[(0,a.Lk)("div",d,[(0,a.Lk)("div",m,[(0,a.Lk)("div",f,[e.infoAno.ID?((0,a.uX)(),(0,a.Wv)(g,{key:1,readonly:"",label:"Año",modelValue:e.infoAno.ANO,"onUpdate:modelValue":n[6]||(n[6]=function(n){return e.infoAno.ANO=n})},null,8,["modelValue"])):((0,a.uX)(),(0,a.Wv)(b,{key:0,class:"col",modelValue:e.infoAno.ANO,"onUpdate:modelValue":n[5]||(n[5]=function(n){return e.infoAno.ANO=n}),options:e.anosDisponibles,label:"Año","option-value":"ANO","option-label":"ANO","emit-value":"","option-disable":function(e){return Object(e)!==e||"C"===e.ESTADO},onInput:e.selectAno,rules:[function(e){return null!==e&&""!==e||"Por favor Seleccione un año"}]},null,8,["modelValue","options","option-disable","onInput","rules"])),(0,a.bF)(h,{class:"col",modelValue:e.infoAno.ESTADO,"onUpdate:modelValue":n[7]||(n[7]=function(n){return e.infoAno.ESTADO=n}),"true-value":1,"false-value":0,label:"Activo",color:"primary"},null,8,["modelValue"])])]),e.infoSalon&&e.infoSalon.length>0?((0,a.uX)(),(0,a.CE)("div",A,[(0,a.bF)(E,{class:"col",columns:e.columnsSalon,data:e.infoSalon,context:o,selection:"multiple",hideBottom:"",ref:"tablaSalon","load-selection":e.infoSalonesSelect},null,8,["columns","data","load-selection"])])):(0,a.Q3)("v-if",!0)])])]}),_:1},512)]}),_:1},8,["modelValue","onSubmit"]),(0,a.Lk)("div",S,[(0,a.bF)(E,{columns:e.columns,data:e.dataAnos,context:this,config:e.config,css:{height:"calc(100vh - 120px)"},"show-search":!1},null,8,["columns","data","config"])])])}var b=o(76080),g=o.n(b),h=o(57008),v=o.n(h),O=o(45254),E=o.n(O),D=o(8445),T=o.n(D),I=(o(71225),o(74260),o(39866),o(23825),o(52133),o(10239),o(50310),o(5962),o(32203),o(90095),o(6724),o(515),o(83190),o(62692),o(13715),o(24066),o(9736)),M=o(16648),w=o(33777),k=o(30640),j=o(2739),V=o(6123),N=o(6083),C={name:"configuracion",components:{QInput:I.A,sieTable:w.A,sieModal:k.A,QSelect:M.A,QForm:j.A,QToggle:V.c5,sieEditor:N.A},data:function(){return{search:"",cargando:!1,dataAnos:[],modalAno:!1,anos:[],infoAno:{},infoSalon:[],salonesSelect:{},modalMensaje:!1,momentos:[{label:"Al iniciar",value:0},{label:"Al Terminar",value:1}],momentoSelect:null,infoMensajes:{0:{ESTADO:1,TITULO:null,MENSAJE:null,MSJ_TIPO:0},1:{ESTADO:1,TITULO:null,MENSAJE:null,MSJ_TIPO:1}},infoSalonesSelect:{key:"key"},columns:[{name:"ANO",label:"Año",align:"center",field:"ANO"},{name:"ESTADO",label:"Estado",align:"center",field:"ESTADO"},{name:"SALON",label:"Grados",align:"left",field:"SALON",wrap:!0},{name:"EDIT",field:"EDIT",align:"center",width:80}],columnsSalon:[{name:"GRADODES",label:"Grado",align:"left",field:"GRADODES"}]}},computed:{buttons:function(){var e=[{label:"Mensajes",icon:"email",click:this.configMensaje,loading:this.cargando},{label:"Agregar",icon:"add",click:this.addAno,loading:this.cargando}];return e},config:function(){return{SALON:{renderHtml:function(e,n,o){var a=this.salonesSelect[e.ID].map(function(e){return e.GRADODES});return o.chips({items:a})}},ESTADO:{renderHtml:function(e,n,o,a){return o.icon({name:"".concat(1===e.ESTADO?"toggle_on":"toggle_off"),color:"".concat(1===e.ESTADO?"primary":"light")})}},EDIT:{component:"button",icon:["edit as editar"],editar:function(e){this.nuevoAno(e)}}}},anosDisponibles:function(){var e=T()(this.anos),n=this.dataAnos.map(function(e){return e.ANO});return e.filter(function(e){return!n.includes(e.ANO)})}},methods:{saveMensajes:function(){var e=this;return E()(g()().m(function n(){var o;return g()().w(function(n){while(1)switch(n.p=n.n){case 0:if(console.log(e.momentoSelect),!([0,1].indexOf(e.momentoSelect)+1)){n.n=4;break}return o=v()({},e.infoMensajes[e.momentoSelect]),n.p=1,n.n=2,e.$http.post("api/PreInteresadosController/saveMensajes",{params:o});case 2:e.$notify("Mensaje guardado correctamente"),e.configMensaje(),e.modalMensaje=!1,n.n=4;break;case 3:n.p=3,n.v;case 4:return n.a(2)}},n,null,[[1,3]])}))()},configMensaje:function(){var e=this;return E()(g()().m(function n(){var o;return g()().w(function(n){while(1)switch(n.n){case 0:return e.modalMensaje=!0,n.n=1,e.$http.get("api/PreInteresadosController/getMensajes");case 1:o=n.v,e.infoMensajes={0:{ESTADO:1,TITULO:null,MENSAJE:null,MSJ_TIPO:0},1:{ESTADO:1,TITULO:null,MENSAJE:null,MSJ_TIPO:1}},Object.keys(o).forEach(function(n){e.infoMensajes[n]=o[n][0]});case 2:return n.a(2)}},n)}))()},addAno:function(){this.nuevoAno({})},init:function(){var e=this;return E()(g()().m(function n(){var o;return g()().w(function(n){while(1)switch(n.n){case 0:return n.n=1,e.$http.get("api/PreInteresadosController/getPreInteresados");case 1:o=n.v,e.dataAnos=o.base,e.salonesSelect=o.salones;case 2:return n.a(2)}},n)}))()},nuevoAno:function(e){e.ID?(this.infoAno=v()({},e),this.selectAno()):(this.infoAno={ANO:null,DESCRIPCION:null,ESTADO:1},this.infoSalon=[]),this.modalAno=!0},selectAno:function(){var e=this;return E()(g()().m(function n(){var o,a;return g()().w(function(n){while(1)switch(n.n){case 0:return o=e.infoAno,n.n=1,e.$http.get("api/PreInteresadosController/getSalones",{params:{params:o}});case 1:a=n.v,e.infoSalon=a.dataBase,e.infoSalonesSelect.values=a.marcados;case 2:return n.a(2)}},n)}))()},grabar:function(){var e=this;return E()(g()().m(function n(){var o,a,t;return g()().w(function(n){while(1)switch(n.p=n.n){case 0:if(e.infoAno.ANO&&!(!e.$refs.tablaSalon.rowsSelected().length>0)){n.n=1;break}e.$notify("Faltan datos por completar","error"),n.n=6;break;case 1:return n.n=2,e.$confirmar("¿Está seguro de guardar esta informacion?");case 2:if(o=n.v,!o){n.n=6;break}return n.p=3,a=e.infoAno.ID?"updatePreInteresados":"addPreInteresados",t=v()(v()({},e.infoAno),{salones:e.$refs.tablaSalon.rowsSelected()}),e.infoAno.ID&&(t.salones={add:[],delete:[]},e.$refs.tablaSalon.rowsSelected().forEach(function(e){e.ID||t.salones.add.push({INSTRU:e.INSTRUCOD,GRADOCOD:e.GRADOCOD})}),e.infoSalonesSelect.values.forEach(function(n){e.$refs.tablaSalon.rowsSelected().find(function(e){var o=e.ID;return o===n.ID})||t.salones.delete.push(n.ID)})),n.n=4,e.$http.post("api/PreInteresadosController/".concat(a),{parametros:t});case 4:e.$notify("Grabado correctamente"),e.init(),e.modalAno=!1,n.n=6;break;case 5:n.p=5,n.v;case 6:return n.a(2)}},n,null,[[3,5]])}))()}},mounted:function(){var e=this;return E()(g()().m(function n(){return g()().w(function(n){while(1)switch(n.n){case 0:return n.n=1,e.$http.get("api/anioController/getAnios");case 1:e.anos=n.v,e.init();case 2:return n.a(2)}},n)}))()}},L=o(12807);const U=(0,L.A)(C,[["render",p]]);var P=U}}]);