"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[38939],{38939:function(e,a,t){t.r(a),t.d(a,{default:function(){return W}});var o=t(61758),i={class:"row q-ma-xs q-col-gutter-sm"},n={class:"col-xs-4 col-lg-2"},r={class:"row gutter-xs"},l={class:"col-xs-8 col-lg-4"},s={class:"row gutter-xs",style:{width:"100%"}},u={class:"col-xs-12",style:{width:"100%"}},c={class:"col-xs-12",id:"form",onsumit:"() => false"},d={class:"col-xs-12 col-lg-6"},f={class:"q-px-md q-pb-xs"},m={class:"row q-ma-xs q-col-gutter-sm"},h={class:"col-xs-4"},p={class:"col-xs-4"},g={class:"col-xs-4"},v={class:"row q-ma-xs q-col-gutter-sm"},b={class:"col-xs-6"},A={class:"col-xs-6"};function w(e,a){var t=(0,o.g2)("q-page-header"),w=(0,o.g2)("q-separator"),S=(0,o.g2)("q-select"),D=(0,o.g2)("q-card-section"),F=(0,o.g2)("q-option-group"),k=(0,o.g2)("q-card-main"),N=(0,o.g2)("q-card"),E=(0,o.g2)("q-input"),O=(0,o.g2)("q-date"),C=(0,o.g2)("q-popup-proxy"),x=(0,o.g2)("q-icon"),T=(0,o.g2)("sie-grid"),V=(0,o.g2)("footer-grid");return(0,o.uX)(),(0,o.Wv)(N,{class:"layout-v1 my-card",flat:"",bordered:""},{default:(0,o.k6)(function(){return[(0,o.bF)(t,{title:e.pageHeader.title,botones:e.pageHeader.botones,nivelAcceso:e.pageHeader.nivelAcceso},null,8,["title","botones","nivelAcceso"]),(0,o.bF)(w),(0,o.bF)(D,null,{default:(0,o.k6)(function(){return[(0,o.bF)(S,{label:"Empresa Aseguradora","option-label":"label","option-value":"value",options:e.dataSeguro,modelValue:e.aseguradora,"onUpdate:modelValue":a[0]||(a[0]=function(a){return e.aseguradora=a}),onInput:e.setForm},null,8,["options","modelValue","onInput"])]}),_:1}),(0,o.bF)(w),(0,o.bF)(D,null,{default:(0,o.k6)(function(){return[(0,o.Lk)("div",i,[(0,o.Lk)("div",n,[(0,o.bF)(N,{class:"q-card-legend",title:"Ordenar Por:"},{default:(0,o.k6)(function(){return[(0,o.bF)(k,null,{default:(0,o.k6)(function(){return[(0,o.Lk)("div",r,[(0,o.bF)(F,{color:"primary",type:"radio",modelValue:e.seleccionTipoOrden,"onUpdate:modelValue":a[1]||(a[1]=function(a){return e.seleccionTipoOrden=a}),onInput:e.setForm,options:e.filtrosOrden},null,8,["modelValue","onInput","options"])])]}),_:1})]}),_:1})]),(0,o.Lk)("div",l,[(0,o.bF)(N,{class:"q-card-legend",style:{height:"100%"},title:"Seleccionar Plantila(XLS, XLSX)"},{default:(0,o.k6)(function(){return[(0,o.bF)(k,{style:{height:"100%",display:"flex","justify-content":"center","align-items":"center"}},{default:(0,o.k6)(function(){return[(0,o.Lk)("div",s,[(0,o.Lk)("div",u,[(0,o.Lk)("form",c,[(0,o.bF)(E,{type:"file",modelValue:e.archivoSeleccionado,"onUpdate:modelValue":a[2]||(a[2]=function(a){return e.archivoSeleccionado=a}),name:"arch1",id:"arch1",accept:".xlsx,.xls"},null,8,["modelValue"])])])])]}),_:1})]}),_:1})]),(0,o.Lk)("div",d,[(0,o.bF)(N,{class:"q-card-legend",title:"Filtros para Exportar",style:{height:"100%"}},{default:(0,o.k6)(function(){return[(0,o.Lk)("div",f,[(0,o.Lk)("div",m,[(0,o.Lk)("div",h,[(0,o.bF)(S,{label:"Año","option-label":"label","option-value":"value",options:e.dataAnios,modelValue:e.filAnio,"onUpdate:modelValue":a[3]||(a[3]=function(a){return e.filAnio=a}),onInput:e.getAlumnosAsegurados,disable:!e.filtros.anio},null,8,["options","modelValue","onInput","disable"])]),(0,o.Lk)("div",p,[(0,o.bF)(S,{label:"Matriculado","option-label":"label","option-value":"value",options:e.dataMatriculado,modelValue:e.filMatriculado,"onUpdate:modelValue":a[4]||(a[4]=function(a){return e.filMatriculado=a}),onInput:e.getAlumnosAsegurados,disable:!e.filtros.matricula},null,8,["options","modelValue","onInput","disable"])]),(0,o.Lk)("div",g,[(0,o.bF)(S,{label:"Tipo de Seguro","option-label":"SECUDES","option-value":"SECUCOD",options:e.dataTipoSeguro,modelValue:e.filTipoSeguro,"onUpdate:modelValue":a[5]||(a[5]=function(a){return e.filTipoSeguro=a}),onInput:e.getAlumnosAsegurados,disable:!e.filtros.tipoSeguro},null,8,["options","modelValue","onInput","disable"])])]),(0,o.Lk)("div",v,[(0,o.Lk)("div",b,[(0,o.bF)(E,{label:"Fecha Inicio",debounce:"500",maxlength:"10",format:"##/##/####",modelValue:e.fecini,"onUpdate:modelValue":a[8]||(a[8]=function(a){return e.fecini=a}),mask:"##/##/####",disable:!e.filtros.fecini},{append:(0,o.k6)(function(){return[(0,o.bF)(x,{class:"cursor-pointer",name:"date_range"},{default:(0,o.k6)(function(){return[(0,o.bF)(C,{ref:"qDateFecini","transition-show":"scale","transition-hide":"scale"},{default:(0,o.k6)(function(){return[(0,o.bF)(O,{mask:"DD/MM/YYYY",modelValue:e.fecini,"onUpdate:modelValue":a[6]||(a[6]=function(a){return e.fecini=a}),onInput:a[7]||(a[7]=function(a){return e.closeModal("qDateFecini")})},null,8,["modelValue"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue","disable"])]),(0,o.Lk)("div",A,[(0,o.bF)(E,{label:"Fecha Fin",debounce:"500",maxlength:"10",format:"##/##/####",modelValue:e.fecfin,"onUpdate:modelValue":a[11]||(a[11]=function(a){return e.fecfin=a}),mask:"##/##/####",disable:!e.filtros.fecfin},{append:(0,o.k6)(function(){return[(0,o.bF)(x,{class:"cursor-pointer",name:"date_range"},{default:(0,o.k6)(function(){return[(0,o.bF)(C,{ref:"qDateFecfin","transition-show":"scale","transition-hide":"scale"},{default:(0,o.k6)(function(){return[(0,o.bF)(O,{mask:"DD/MM/YYYY",modelValue:e.fecfin,"onUpdate:modelValue":a[9]||(a[9]=function(a){return e.fecfin=a}),onInput:a[10]||(a[10]=function(a){return e.closeModal("qDateFecfin")})},null,8,["modelValue"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue","disable"])])])])]}),_:1})])])]}),_:1}),(0,o.bF)(w),e.muestraGrilla?((0,o.uX)(),(0,o.Wv)(D,{key:0},{default:(0,o.k6)(function(){return[(0,o.bF)(T,{class:"fix-table-global ag-theme-balham",rowData:e.rowData,columnDefs:e.columnDefs,onGridReady:e.onGridReady,rowSelection:"multiple",style:{height:"calc(100vh - 420px)"}},null,8,["rowData","columnDefs","onGridReady"]),(0,o.bF)(V,{style:{width:"100%"},pages:e.pages,page:e.page,rows:e.rowData,modelValue:e.selectPagina,"onUpdate:modelValue":a[12]||(a[12]=function(a){return e.selectPagina=a}),onLoad:e.getAlumnosAsegurados},null,8,["pages","page","rows","modelValue","onLoad"])]}),_:1})):(0,o.Q3)("v-if",!0)]}),_:1})}var S=t(76080),D=t.n(S),F=t(45254),k=t.n(F),N=(t(30683),t(88567)),E=t(95718),O=t(53380),C=t(36408),x=t(27560),T=t(96330),V=t(6123),R=t(64303),M=t(41615),y=t(33950),U=t(59089),q=t(80660),I=t(54267),_=t(34262),L=t(64208),Y=t(12143),P=t(95477),Q=t(18105),G=t(2652),X=t(3112),$=t(54489),H={components:{QCard:N.A,QCardSection:E.A,QIcon:_.A,QDate:Y.A,QInput:L.A,QPopupProxy:P.A,sieGrid:C.A,footerGrid:x.A,headerGrid:T.A,crearBotones:R.A,QOptionGroup:V.EX,sieUpload:U.A,QSeparator:O.A,QPageHeader:G.A,QCheckbox:X.A,QSelect:$.S,QCardMain:V.d1},data:function(){return{rowData:[],columnDefs:[],api:null,botones:[],nivelAcceso:3,name:"Exportar Seguros",filtrosOrden:[],seleccionTipoOrden:"A",page:1,pages:1,selectPagina:1,archivoCargado:null,filename:"",archivoSeleccionado:null,pageHeader:{title:"Exportación Seguro de Accidente",botones:[],nivelAcceso:3},dataSeguro:M["default"].ASEGURADORAS,aseguradora:"",muestraGrilla:!1,dataMatriculado:[{value:"%",label:"Todos"},{value:"S",label:"Sí"},{value:"N",label:"No"}],filMatriculado:"S",dataAnios:[],filAnio:String(M["default"].CURRENT_YEAR),dataTipoSeguro:[],filTipoSeguro:"%",fecini:(0,Q.Ay)(new Date,"01/".concat(M["default"].CURRENT_MONTH,"/").concat(M["default"].CURRENT_YEAR)),fecfin:(0,Q.Ay)(new Date,M["default"].CURRENT_DAY),filtros:{matricula:!1,anio:!1,tipoSeguro:!1,fecini:!1,fecfin:!1}}},methods:{getAlumnosAsegurados:function(){var e=this;return k()(D()().m(function a(){var t,o;return D()().w(function(a){while(1)switch(a.n){case 0:return t=e.getParams(),a.n=1,q.$http.get("api/personaController/getAsegurados",{params:{params:t}});case 1:o=a.v,e.rowData=o;case 2:return a.a(2)}},a)}))()},getFiltrosOrden:function(){var e=this;return k()(D()().m(function a(){return D()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,M["default"].ORDEN_REPORTE_FORMATOS();case 1:e.filtrosOrden=a.v;case 2:return a.a(2)}},a)}))()},onGridReady:function(e){this.api=e.api},cargarPlantilla:function(e){var a=this;return k()(D()().m(function t(){var o,i;return D()().w(function(t){while(1)switch(t.p=t.n){case 0:return t.p=0,t.n=1,(0,y["default"])({file:e[0]});case 1:o=t.v,a.archivoCargado=o,a.filename=o.nameOrigin,t.n=3;break;case 2:return t.p=2,i=t.v,t.a(2,a.$alert(i.error?i.error.message:i.message,"warning"));case 3:return t.a(2)}},t,null,[[0,2]])}))()},getParams:function(){return{tesoreria:!0,arch1:this.archivoSeleccionado,matriculado:this.filMatriculado,anio:this.filAnio,tipoSeguro:this.filTipoSeguro,orden:this.seleccionTipoOrden,seguro:this.aseguradora,fecini:(0,I.convertToYMD)(this.fecini),fecfin:(0,I.convertToYMD)(this.fecfin)}},exportar:function(){var e=this;return this.aseguradora?this.archivoSeleccionado?void this.$confirm("¿Esta seguro de ejecutar el proceso?").onOk(k()(D()().m(function a(){var t,o,i;return D()().w(function(a){while(1)switch(a.n){case 0:t=document.getElementById("form"),t.setAttribute("enctype","multipart/form-data"),o="/webservice/servicios-tesoreria/generar-archivo-seguros",i=e.getParams(),M["default"].FORMULARIO_REPORTES(t,i,o,!0),e.$alert("Archivo descargado satisfactoriamente","success");case 1:return a.a(2)}},a)}))):this.$alert("No se ha cargado la plantilla"):this.$alert("No selecciono Empresa Aseguradora")},closeModal:function(e){this.$refs[e].hide(),this.getAlumnosAsegurados()},crearBotones:function(){this.pageHeader.botones=[{label:"Ejecutar Proceso",icon:"settings",click:this.exportar,minAcceso:M["default"].LECTURA_ESCRITURA}]},setForm:function(){this.validarFormulario(),this.obtenerDatos()},validarFormulario:function(){this.filtros.matricula=!1,this.filtros.anio=!1,this.filtros.tipoSeguro=!1,this.filtros.fecini=!1,this.filtros.fecfin=!1,"rimac"===this.aseguradora?(this.filtros.matricula=!0,this.filtros.anio=!0,this.filtros.tipoSeguro=!0):"protecta"===this.aseguradora?(this.filtros.anio=!0,this.filtros.matricula=!0):"pacifico"===this.aseguradora&&(this.filtros.anio=!0,this.filtros.matricula=!0,this.filtros.fecini=!0,this.filtros.fecfin=!0)},obtenerDatos:function(){this.muestraGrilla=this.aseguradora&&this.aseguradora.length>0,this.columns(),this.getAlumnosAsegurados()},columns:function(){var e;e="protecta"===this.aseguradora?[{headerName:"Tip. Doc.",field:"DOCIDECOD",width:75},{headerName:"Núm. Doc",field:"DOCIDENRO",width:100},{headerName:"Nombres",field:"NOMCOMP",width:350},{headerName:"Sexo",field:"SEXODES",width:125},{headerName:"Fec. Nac.",field:"FECNAC",valueFormatter:function(e){return(0,Q.Ay)(e.value,"DD/MM/YYYY")},width:120},{headerName:"Nivel",field:"INSTRUDES",width:125}]:[{headerName:"Código",field:"ALUCOD",width:100},{headerName:"Tip. Doc.",field:"DOCIDECOD",width:75},{headerName:"Núm. Doc",field:"DOCIDENRO",width:100},{headerName:"Nombres",field:"NOMCOMP",width:350},{headerName:"Sexo",field:"SEXODES",width:125},{headerName:"Año",field:"ANO",width:75},{headerName:"Nivel",field:"INSTRUDES",width:125},{headerName:"Fec. Nac.",field:"FECNAC",valueFormatter:function(e){return(0,Q.Ay)(e.value,"DD/MM/YYYY")},width:120}],this.columnDefs=e},getAnios:function(){var e=this;return k()(D()().m(function a(){return D()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,M["default"].API_ANIOS();case 1:e.dataAnios=a.v;case 2:return a.a(2)}},a)}))()},getTipoSeguro:function(){var e=this;return k()(D()().m(function a(){var t;return D()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,q.$http.get("api/personaController/getTipoSeguro");case 1:t=a.v,t.data.unshift({SECUCOD:"%",SECUDES:"Todos"}),e.dataTipoSeguro=t.data;case 2:return a.a(2)}},a)}))()}},created:function(){},beforeMount:function(){var e=this;return k()(D()().m(function a(){return D()().w(function(a){while(1)switch(a.n){case 0:e.getFiltrosOrden(),e.crearBotones();case 1:return a.a(2)}},a)}))()},mounted:function(){this.getAnios(),this.getTipoSeguro()}},B=t(12807);const j=(0,B.A)(H,[["render",w]]);var W=j}}]);