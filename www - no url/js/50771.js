"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[50771],{50771:function(e,a,t){t.r(a),t.d(a,{default:function(){return k}});var o=t(61758),n=t(58790),l={class:"col overflow-auto"},i={class:"row"},s={class:"col-xs-12 col-sm-12 col-md-12 col-xl-12 q-pa-sm"},c={key:0,class:"col-12"},r={class:"col-xs-12 col-sm-12 col-md-3 col-xl-3"},d={class:"col col-xs-12 col-sm-12 col-md-3 col-xl-3"},u={class:"col-xs-12 col-sm-12 col-md-3 col-xl-3"},f={class:"col-xs-12 col-sm-12 col-md-3 col-xl-3"};function p(e,a){var t=(0,o.g2)("q-spinner-oval"),p=(0,o.g2)("q-inner-loading"),m=(0,o.g2)("sie-estudiantes"),g=(0,o.g2)("sie-select"),E=(0,o.g2)("q-datetime"),O=(0,o.g2)("q-toggle"),b=(0,o.g2)("q-card-main"),h=(0,o.g2)("q-card-separator"),v=(0,o.g2)("q-tooltip"),S=(0,o.g2)("q-icon"),C=(0,o.g2)("q-td"),I=(0,o.g2)("q-table"),A=(0,o.g2)("q-card"),T=(0,o.g2)("q-page");return(0,o.uX)(),(0,o.Wv)(T,{class:"reservasPrestamos"},{default:(0,o.k6)(function(){return[(0,o.Lk)("div",l,[(0,o.Lk)("div",i,[(0,o.bF)(p,{visible:e.loadingSave},{default:(0,o.k6)(function(){return[(0,o.bF)(t,{size:"50px",color:"primary"})]}),_:1},8,["visible"]),(0,o.Lk)("div",s,[(0,o.bF)(A,null,{default:(0,o.k6)(function(){return[(0,o.bF)(b,{class:"row"},{default:(0,o.k6)(function(){return[e.sieInfo.esFamilia||e.sieInfo.esEstudiante?((0,o.uX)(),(0,o.CE)("div",c,[(0,o.bF)(m,{onSelected:e.cambiarAlumno},null,8,["onSelected"])])):(0,o.Q3)("v-if",!0),(0,o.Lk)("div",r,[(0,o.bF)(g,{type:"outlined",modelValue:e.selectedEstadosOperacion,"onUpdate:modelValue":a[0]||(a[0]=function(a){return e.selectedEstadosOperacion=a}),options:e.estadosOperacion,label:"NOMESTADO",val:"IDTIPOPERA",placeholder:"Estado"},null,8,["modelValue","options"])]),(0,o.Lk)("div",d,[(0,o.bF)(E,{class:"q-if-outlined no-bottom","float-label":"Desde",color:"primary",format:"DD/MM/YYYY",onChange:e.getOperacionesSolicitante,modal:!0,modelValue:e.desde,"onUpdate:modelValue":a[1]||(a[1]=function(a){return e.desde=a}),type:"date"},null,8,["onChange","modelValue"])]),(0,o.Lk)("div",u,[(0,o.bF)(E,{class:"q-if-outlined no-bottom","float-label":"Hasta",color:"primary",format:"DD/MM/YYYY",onChange:e.getOperacionesSolicitante,modal:!0,modelValue:e.hasta,"onUpdate:modelValue":a[2]||(a[2]=function(a){return e.hasta=a}),type:"date"},null,8,["onChange","modelValue"])]),(0,o.Lk)("div",f,[(0,o.bF)(O,{class:"q-if-outlined",modelValue:e.vigente,"onUpdate:modelValue":a[3]||(a[3]=function(a){return e.vigente=a}),label:"Solo pendientes",color:"secondary",onInput:e.getOperacionesSolicitante},null,8,["modelValue","onInput"])])]}),_:1}),(0,o.bF)(h),(0,o.bF)(I,{class:"no-shadow table-sie","table-style":"height: 75vh",color:"secondary",pagination:e.operaciones.pagination,"onUpdate:pagination":a[4]||(a[4]=function(a){return e.operaciones.pagination=a}),"hide-bottom":"",data:e.dataOpe,columns:e.operaciones.columns},{"body-cell-CANCELAR":(0,o.k6)(function(a){return[(0,o.bF)(C,{props:a},{default:(0,o.k6)(function(){return[2===a.row.IDTIPOPERA?((0,o.uX)(),(0,o.Wv)(S,{key:0,class:"cursor-pointer cancelar-reserva",name:"test_cancel",onClick:function(t){return e.cancelarReserva(a.row)},size:"20px"},{default:(0,o.k6)(function(){return[(0,o.bF)(v,null,{default:(0,o.k6)(function(){return[(0,o.eW)((0,n.v_)(e.$t("botones.cancelar")),1)]}),_:1})]}),_:1},8,["onClick"])):(0,o.Q3)("v-if",!0)]}),_:2},1032,["props"])]}),_:1},8,["pagination","data","columns"])]}),_:1})])])])]}),_:1})}var m=t(6123),g=t(30640),E=t(57668),O=t(93616),b=t(80660),h={getOperacionesSolicitante:function(e){return b.$http.get("api/HyoOperacionesSolicitantes/getOperacionesSolicitante",e).then(function(e){return e})},cancelarReserva:function(e,a,t,o,n,l){return b.$http.post("api/HyoOperacionesSolicitantes/cancelarReserva",{existencia:e,operacion:a,numingreso:t,titulo:o,alucod:n,usucod:l})}},v=t(18105),S=t(982),C=t(33001),I=t(92173),A=function(e){return(0,v.Ay)(e,"DD/MM/YYYY")},T={components:{QTable:m.kH,QTr:m.qh,QTd:m.Ef,QSelect:m.Si,QDatetime:m.T5,QTooltip:m.nC,QToggle:m.c5,QInnerLoading:m.SQ,QSpinnerOval:m.VA,sieSelect:O.A,sieModal:g.A,notify:S["default"],sieEstudiantes:I.Ay,QPage:m.Tu,QCard:m.C$,QCardMain:m.d1,QCardSeparator:m.d6,QIcon:m.bP},data:function(){return{desde:null,hasta:null,sieInfo:(0,E["default"])(),esPersonal:(0,E["default"])().esDocente,estadosOperacion:[],selectedEstadosOperacion:0,loadingSave:!1,operaciones:{dataTemp:[],columns:[{name:"NUMINGRESO",label:"NÚMERO DE INGRESO",field:"NUMINGRESO",align:"left",sortable:!0},{name:"TITULO",label:"TÍTULO",field:"TITULO",align:"left",sortable:!0},{name:"PARTE",label:"CÓDIGO",field:"PARTE",align:"left",sortable:!0},{name:"UBICADES",label:"UBICACIÓN",field:"UBICADES",align:"left",sortable:!0},{name:"NOMESTADO",label:"ESTADO",field:"NOMESTADO",align:"left",sortable:!0},{name:"FECRES",label:"RESERVA",field:"FECRES",align:"left",format:A,sortable:!0},{name:"FECPREI",label:"PRESTAMO",field:"FECPREI",align:"left",format:A,sortable:!0},{name:"FECPREF",label:"VENCIMIENTO",field:"FECPREF",align:"left",format:A,sortable:!0},{name:"CANCELAR",label:"",field:"CANCELAR",align:"center"}],pagination:{page:1,rowsPerPage:500}},vigente:!0,alucod:"",usucod:""}},computed:{dataOpe:function(){var e=this.operaciones.dataTemp;return 0!==this.selectedEstadosOperacion&&(e=(0,C.filterArray)(this.selectedEstadosOperacion,{field:"IDTIPOPERA",list:e})),e}},methods:{getOperacionesSolicitante:function(){var e=this;h.getOperacionesSolicitante({params:{desde:this.desde,hasta:this.hasta,estado:this.selectedEstadosOperacion,vigente:this.vigente?"V":"",alucod:this.alucod}}).then(function(a){e.operaciones.dataTemp=a.datos,e.estadosOperacion=a.estados}).catch(function(e){console.log("error")})},cancelarReserva:function(e){var a=this;this.loadingSave=!0,h.cancelarReserva(e.EXISTCOD,e.IDOPERADET,e.NUMINGRESO,e.TITULO,this.alucod,this.usucod).then(function(e){var t=e.json;return a.loadingSave=!1,1===t.estado?(a.loadingSave=!1,(0,S["default"])(a.$t("mensajes.m0094"),"success"),a.getOperacionesSolicitante(),!0):((0,S["default"])(a.$t("mensajes.m0101"),"warning"),!1)}).catch(function(e){a.loadingSave=!1,(0,S["default"])(a.$t(e.error.message),"warning")})},cambiarAlumno:function(e){this.alucod=e.ALUCOD,this.usucod=e.USUCOD,this.getOperacionesSolicitante()}},created:function(){this.loadingSave=!1,(this.esPersonal||this.sieInfo.esOtros)&&this.getOperacionesSolicitante()}},R=t(12807);const D=(0,R.A)(T,[["render",p]]);var k=D}}]);