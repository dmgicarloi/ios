"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[87096],{87096:function(e,o,n){n.r(o),n.d(o,{default:function(){return N}});var r=n(61758),a={class:"row q-pa-sm q-col-gutter-sm"},t={class:"col-xs-12 col-sm-6"},s={class:"row q-pa-sm q-pt-md"},i={class:"col-xs-12"};function l(e,o){var n=this,l=(0,r.g2)("header-btn"),c=(0,r.g2)("q-select"),u=(0,r.g2)("q-card-section"),d=(0,r.g2)("q-separator"),f=(0,r.g2)("sie-table"),m=(0,r.g2)("q-card"),g=(0,r.g2)("sie-modal"),b=(0,r.g2)("q-page");return(0,r.uX)(),(0,r.Wv)(b,{class:"exalumnos-acceso-usuario"},{default:(0,r.k6)(function(){return[(0,r.bF)(m,null,{default:(0,r.k6)(function(){return[(0,r.bF)(l,{name:"Usuario Acceso",buttons:e.buttons},null,8,["buttons"]),(0,r.bF)(u,null,{default:(0,r.k6)(function(){return[(0,r.Lk)("div",a,[(0,r.Lk)("div",t,[(0,r.bF)(c,{modelValue:e.usucod,"onUpdate:modelValue":o[0]||(o[0]=function(o){return e.usucod=o}),optionValue:"USUCOD",optionLabel:"USUNOM",options:e.usuarios,label:"Usuario",onInput:o[1]||(o[1]=function(o){return e.getPromocionesUsuario()})},null,8,["modelValue","options"])])])]}),_:1}),(0,r.bF)(d),(0,r.bF)(u,null,{default:(0,r.k6)(function(){return[(0,r.bF)(f,{data:e.gridAccesos.rows,columns:e.gridAccesos.fields,ref:"table",config:e.gridAccesos.config,context:n,css:{height:"80vh"}},null,8,["data","columns","config"])]}),_:1})]}),_:1}),(0,r.bF)(g,{class:"modal-acceso-usuario",modelValue:e.openModal,"onUpdate:modelValue":o[2]||(o[2]=function(o){return e.openModal=o}),title:"Agregar Promoción",ok:e.$t("botones.guardar"),footer:!0,onSubmit:e.grabarPromociones,onClose:e.cerrarModal},{default:(0,r.k6)(function(){return[(0,r.Lk)("div",s,[(0,r.Lk)("div",i,[(0,r.bF)(f,{data:e.gridPromociones.rows,selection:"multiple",loadSelection:e.load,columns:e.gridPromociones.fields,ref:"tablePromo",config:e.gridPromociones.config,context:n,css:{height:"80vh"}},null,8,["data","loadSelection","columns","config"])])])]}),_:1},8,["modelValue","ok","onSubmit","onClose"])]}),_:1})}var c=n(76080),u=n.n(c),d=n(45254),f=n.n(d),m=(n(23825),n(83190),n(24066),n(6123)),g=n(95718),b=n(53380),p=n(16648),h=n(9736),w=n(95477),S={data:function(){return{gridAccesos:{config:{},rows:[],fields:[{name:"ANIO",label:"Año",field:"ANIO",align:"left",sortable:!0},{name:"NOMBRE",label:"Promoción",field:"NOMBRE",align:"left",sortable:!0},{name:"USUNOM",label:"Responsable",field:"USUNOM",align:"left",sortable:!0},{name:"INSTRUDES",label:"Nivel",field:"INSTRUDES",align:"left",sortable:!0},{name:"GRADODES",label:"Grado",field:"GRADODES",align:"left",sortable:!0},{name:"SECCIONDES",label:"Seccion",field:"SECCIONDES",align:"left",sortable:!0}]},gridPromociones:{config:{},rows:[],fields:[{name:"ANIO",label:"Año",field:"ANIO",align:"left",sortable:!0},{name:"NOMBRE",label:"Promoción",field:"NOMBRE",align:"left",sortable:!0},{name:"INSTRUDES",label:"Nivel",field:"INSTRUDES",align:"left",sortable:!0},{name:"GRADODES",label:"Grado",field:"GRADODES",align:"left",sortable:!0},{name:"SECCIONDES",label:"Seccion",field:"SECCIONDES",align:"left",sortable:!0}]}}}},A=n(57668),v=n(30640),O=n(2739),U={mixins:[S],components:{QPopupProxy:w.A,QSelect:p.A,QInput:h.A,QSeparator:b.A,QCardSection:g.A,sieModal:v.A,QForm:O.A,QPage:m.Tu,QCard:m.C$},data:function(){return{sie:(0,A["default"])(),currentRow:{},openModal:!1,usuarios:[],usucod:"",buttons:[{icon:"save",label:"Agregar Promocion",click:this.abrirModal,permiso:"=== 3"}],load:{values:[],key:"ID_PROMOCION"}}},methods:{abrirModal:function(){var e=this;return f()(u()().m(function o(){return u()().w(function(o){while(1)switch(o.n){case 0:if(e.usucod){o.n=1;break}return e.$notify("Debe seleccionar un usuario","warning"),o.a(2,!1);case 1:if(0!==e.gridPromociones.rows.length){o.n=2;break}return o.n=2,e.getPromociones();case 2:e.load.values=e.gridAccesos.rows,e.openModal=!0;case 3:return o.a(2)}},o)}))()},cerrarModal:function(){var e=this;return f()(u()().m(function o(){return u()().w(function(o){while(1)switch(o.n){case 0:e.openModal=!1;case 1:return o.a(2)}},o)}))()},getPromociones:function(){var e=this;return f()(u()().m(function o(){return u()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,e.$http.get("api/ExAlumnos/getPromociones");case 1:e.gridPromociones.rows=o.v;case 2:return o.a(2)}},o)}))()},getPromocionesUsuario:function(){var e=this;return f()(u()().m(function o(){return u()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,e.$http.get("api/ExAlumnos/getPromocionesUsuario",{params:{usucod:e.usucod}});case 1:e.gridAccesos.rows=o.v;case 2:return o.a(2)}},o)}))()},getUsuariosAdmin:function(){var e=this;return f()(u()().m(function o(){return u()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,e.$http.get("api/ExAlumnos/getUsuariosAdmin");case 1:e.usuarios=o.v,e.usuarios.unshift({USUNOM:"Seleccione...",USUCOD:""});case 2:return o.a(2)}},o)}))()},grabarPromociones:function(){var e=this;return f()(u()().m(function o(){var n,r,a,t,s;return u()().w(function(o){while(1)switch(o.p=o.n){case 0:if(o.p=0,n=e.$refs.tablePromo.rowsSelected(["ID_PROMOCION"]),0!==n.length||0!==e.gridAccesos.rows.length){o.n=1;break}return e.$notify("Debe seleccionar al menos una promoción","warning"),o.a(2,!1);case 1:if(e.usucod){o.n=2;break}return e.$notify("Debe seleccionar un usuario","warning"),o.a(2,!1);case 2:return o.n=3,e.$http.post("api/ExAlumnos/savePromocionUsuario",{params:{usucod:e.usucod,selected:n}});case 3:r=o.v,a=r.message,e.$notify(a,"success"),e.getPromocionesUsuario(),e.openModal=!1,o.n=5;break;case 4:o.p=4,s=o.v,t=s.error,e.$notify(t.message,"error");case 5:return o.a(2)}},o,null,[[0,4]])}))()}},created:function(){var e=this;return f()(u()().m(function o(){return u()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,e.getUsuariosAdmin();case 1:return o.a(2)}},o)}))()}},P=n(12807);const E=(0,P.A)(U,[["render",l]]);var N=E}}]);