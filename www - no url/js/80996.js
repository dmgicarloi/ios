"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[80996],{80996:function(e,n,o){o.r(n),o.d(n,{default:function(){return z}});var l=o(8445),a=o.n(l),t=(o(71225),o(50310),o(5962),o(83190),o(61758)),i=o(58790),s={class:"column"},d={class:"column q-pa-sm"},r={class:"row"},u={class:"row"},f={class:"row"},c={class:"row justify-end"},p={key:0,class:"q-table q-table-horizontal-separator q-card q-mt-sm"},h={key:0},I={key:0},m={class:"row"},M={class:"row"},O={key:0},_={class:"row"},A={class:"row"},C={key:0},b={key:0},S={key:0},F={key:1},k={key:2},v={class:"row"},D={key:1,class:"q-pa-sm"},g={class:"row"},L={class:"row justify-end"},E={key:2,class:"q-pa-sm"},y={class:"row"};function T(e,n){var o=(0,t.g2)("header-btn"),l=(0,t.g2)("q-datetime"),T=(0,t.g2)("q-select"),N=(0,t.g2)("q-search"),V=(0,t.g2)("q-tooltip"),R=(0,t.g2)("q-btn"),H=(0,t.g2)("q-td"),w=(0,t.g2)("q-table"),P=(0,t.g2)("sie-select"),Y=(0,t.g2)("q-input"),q=(0,t.g2)("q-list-header"),U=(0,t.g2)("q-item-side"),j=(0,t.g2)("q-item-tile"),Q=(0,t.g2)("q-item-main"),X=(0,t.g2)("q-item"),$=(0,t.g2)("q-list"),B=(0,t.g2)("q-checkbox"),x=(0,t.g2)("q-toolbar"),W=(0,t.g2)("sie-modal");return(0,t.uX)(),(0,t.CE)("div",s,[(0,t.bF)(o,{buttons:e.buttons},null,8,["buttons"]),(0,t.Lk)("div",d,[(0,t.Lk)("div",r,[(0,t.bF)(l,{class:"q-if-outlined",type:"date",modelValue:e.fecIni,"onUpdate:modelValue":n[0]||(n[0]=function(n){return e.fecIni=n}),"float-label":e.$t("desde"),format:"DD/MM/YYYY",onChange:e.init},null,8,["modelValue","float-label","onChange"]),(0,t.bF)(l,{class:"q-if-outlined",type:"date",modelValue:e.fecFin,"onUpdate:modelValue":n[1]||(n[1]=function(n){return e.fecFin=n}),"float-label":e.$t("hasta"),format:"DD/MM/YYYY",onChange:e.init},null,8,["modelValue","float-label","onChange"])]),(0,t.Lk)("div",u,[e.filtroEspecial?((0,t.uX)(),(0,t.Wv)(T,{key:0,class:"q-if-outlined col",modelValue:e.selectFiltro,"onUpdate:modelValue":n[2]||(n[2]=function(n){return e.selectFiltro=n}),options:e.dataTipos,"float-label":"Estado",onInput:e.filtrarInfo,multiple:"",chips:""},null,8,["modelValue","options","onInput"])):(0,t.Q3)("v-if",!0)]),(0,t.Lk)("div",f,[(0,t.bF)(N,{class:"q-if-outlined col",modelValue:e.filter,"onUpdate:modelValue":n[3]||(n[3]=function(n){return e.filter=n})},null,8,["modelValue"])])]),(0,t.bF)(w,{data:e.datosAsistencia,columns:e.columns,selection:e.sinCerrar?"multiple":"none","row-key":"ID_ASISTENCIA",style:(0,i.Tr)({"max-height":e.alto}),selected:e.seleccionarCerrar,"onUpdate:selected":n[4]||(n[4]=function(n){return e.seleccionarCerrar=n})},{"body-cell-INFO":(0,t.k6)(function(o){return[(0,t.bF)(H,{props:o},{default:(0,t.k6)(function(){return[(0,t.bF)(R,{flat:"",dense:"",round:"",icon:"info",onClick:function(n){return e.openModal(2,o.row)},class:(0,i.C4)({"text-secondary":o.row.hasObserva})},{default:(0,t.k6)(function(){return[(0,t.bF)(V,null,{default:(0,t.k6)(function(){return a()(n[36]||(n[36]=[(0,t.eW)("Ver Informacion",-1)]))}),_:1})]}),_:1},8,["onClick","class"])]}),_:2},1032,["props"])]}),_:1},8,["data","columns","selection","style","selected"]),(0,t.bF)(W,{modelValue:e.showModal,"onUpdate:modelValue":n[35]||(n[35]=function(n){return e.showModal=n}),title:e.tiposModal[e.tipoModal],onSubmit:e.saveInfo},{default:(0,t.k6)(function(){return[2===e.tipoModal?((0,t.uX)(),(0,t.CE)(t.FK,{key:0},[(0,t.Lk)("div",c,[(0,t.bF)(R,{flat:"",dense:"",round:"",icon:"delete",onClick:n[5]||(n[5]=function(n){return e.eliminarAsistencia(e.infoModal)})})]),e.cargando?(0,t.Q3)("v-if",!0):((0,t.uX)(),(0,t.CE)("table",p,[(0,t.Lk)("tbody",null,[(0,t.Lk)("tr",null,[n[37]||(n[37]=(0,t.Lk)("th",null,[(0,t.Lk)("b",null,"Fecha:")],-1)),(0,t.Lk)("td",null,[(0,t.Lk)("span",null,(0,i.v_)(e.infoModal.F_ASISTENCIA),1)])]),e.infoModal.T_REGISTRO?((0,t.uX)(),(0,t.CE)("tr",h,[n[38]||(n[38]=(0,t.Lk)("th",null,[(0,t.Lk)("b",null,"Tipo de Marcación:")],-1)),(0,t.Lk)("td",null,[(0,t.Lk)("span",null,(0,i.v_)(e.iconosTipo[e.infoModal.T_REGISTRO].ICONODESC),1)])])):(0,t.Q3)("v-if",!0),(0,t.Lk)("tr",null,[n[39]||(n[39]=(0,t.Lk)("th",null,[(0,t.Lk)("b",null,"Personal:")],-1)),(0,t.Lk)("td",null,[(0,t.Lk)("span",null,(0,i.v_)(e.infoModal.PROFNOM),1)])]),(0,t.Lk)("tr",null,[n[40]||(n[40]=(0,t.Lk)("th",null,[(0,t.Lk)("b",null,"Estado:")],-1)),(0,t.Lk)("td",null,[0===e.editables["ID_TIPO"]?((0,t.uX)(),(0,t.CE)("b",{key:0,style:(0,i.Tr)({color:e.infoModal.COLOR})},(0,i.v_)(e.infoModal.DESCRIPCION),5)):((0,t.uX)(),(0,t.Wv)(P,{key:1,type:"outlined",noBottom:"",modelValue:e.infoModal.ID_TIPO_new,"onUpdate:modelValue":n[6]||(n[6]=function(n){return e.infoModal.ID_TIPO_new=n}),options:e.leyenda,label:"label",val:"value"},null,8,["modelValue","options"]))]),e.acceso>2?((0,t.uX)(),(0,t.CE)("td",I,[0===e.editables["ID_TIPO"]?((0,t.uX)(),(0,t.Wv)(R,{key:0,icon:"edit",flat:"",dense:"",round:"",onClick:n[7]||(n[7]=function(n){return e.editCampo("ID_TIPO",1)})})):((0,t.uX)(),(0,t.Wv)(R,{key:1,icon:"close",flat:"",dense:"",round:"",onClick:n[8]||(n[8]=function(n){return e.editCampo("ID_TIPO",0)})}))])):(0,t.Q3)("v-if",!0)]),(0,t.Lk)("tr",null,[n[43]||(n[43]=(0,t.Lk)("th",null,[(0,t.Lk)("b",null,"Ingreso:")],-1)),(0,t.Lk)("td",null,[0===e.editables["FH_INGRESO"]?((0,t.uX)(),(0,t.CE)(t.FK,{key:0},[(0,t.Lk)("span",null,(0,i.v_)(e.date(e.infoModal.FH_INGRESO,"DD/MM/YYYY hh:mm A")),1),(0,t.Lk)("div",m,[n[41]||(n[41]=(0,t.Lk)("b",null,"IP: ",-1)),(0,t.Lk)("span",null,(0,i.v_)(e.infoModal.IP_INGRESO),1)]),(0,t.Lk)("div",M,[n[42]||(n[42]=(0,t.Lk)("b",null,"Usuario: ",-1)),(0,t.Lk)("span",null,(0,i.v_)(e.infoModal.USUCOD_INGRESO),1)])],64)):((0,t.uX)(),(0,t.Wv)(l,{key:1,class:"q-if-outlined",type:"datetime",modelValue:e.infoModal.FH_INGRESO_new,"onUpdate:modelValue":n[9]||(n[9]=function(n){return e.infoModal.FH_INGRESO_new=n}),format:"DD/MM/YYYY hh:mm A"},null,8,["modelValue"]))]),e.acceso>2?((0,t.uX)(),(0,t.CE)("td",O,[0===e.editables["FH_INGRESO"]?((0,t.uX)(),(0,t.Wv)(R,{key:0,icon:"edit",flat:"",dense:"",round:"",onClick:n[10]||(n[10]=function(n){return e.editCampo("FH_INGRESO",1)})})):((0,t.uX)(),(0,t.Wv)(R,{key:1,icon:"close",flat:"",dense:"",round:"",onClick:n[11]||(n[11]=function(n){return e.editCampo("FH_INGRESO",0)})}))])):(0,t.Q3)("v-if",!0)]),(0,t.Lk)("tr",null,[n[47]||(n[47]=(0,t.Lk)("th",null,[(0,t.Lk)("b",null,"Salida:")],-1)),(0,t.Lk)("td",null,[e.infoModal.FH_SALIDA?((0,t.uX)(),(0,t.CE)(t.FK,{key:0},[0===e.editables["FH_SALIDA"]?((0,t.uX)(),(0,t.CE)(t.FK,{key:0},[(0,t.Lk)("span",null,(0,i.v_)(e.date(e.infoModal.FH_SALIDA,"DD/MM/YYYY hh:mm A")),1),(0,t.Lk)("div",_,[n[44]||(n[44]=(0,t.Lk)("b",null,"IP: ",-1)),(0,t.Lk)("span",null,(0,i.v_)(e.infoModal.IP_SALIDA),1)]),(0,t.Lk)("div",A,[n[45]||(n[45]=(0,t.Lk)("b",null,"Usuario: ",-1)),(0,t.Lk)("span",null,(0,i.v_)(e.infoModal.USUCOD_SALIDA),1)])],64)):((0,t.uX)(),(0,t.Wv)(l,{key:1,class:"q-if-outlined",type:"datetime",modelValue:e.infoModal.FH_SALIDA_new,"onUpdate:modelValue":n[12]||(n[12]=function(n){return e.infoModal.FH_SALIDA_new=n}),format:"DD/MM/YYYY hh:mm A"},null,8,["modelValue"]))],64)):((0,t.uX)(),(0,t.CE)(t.FK,{key:1},[e.acceso>2?((0,t.uX)(),(0,t.Wv)(R,{key:0,dense:"",color:"secondary",onClick:n[13]||(n[13]=function(n){return e.saveSalida(e.infoModal)})},{default:(0,t.k6)(function(){return a()(n[46]||(n[46]=[(0,t.eW)("Cerrar Asistencia",-1)]))}),_:1})):(0,t.Q3)("v-if",!0)],64))]),e.acceso>2&&e.infoModal.FH_SALIDA?((0,t.uX)(),(0,t.CE)("td",C,[0===e.editables["FH_SALIDA"]?((0,t.uX)(),(0,t.Wv)(R,{key:0,icon:"edit",flat:"",dense:"",round:"",onClick:n[14]||(n[14]=function(n){return e.editCampo("FH_SALIDA",1)})})):((0,t.uX)(),(0,t.CE)(t.FK,{key:1},[(0,t.bF)(R,{icon:"delete",flat:"",dense:"",round:"",onClick:n[15]||(n[15]=function(n){return e.eliminarCampo("FH_SALIDA",0)})}),(0,t.bF)(R,{icon:"close",flat:"",dense:"",round:"",onClick:n[16]||(n[16]=function(n){return e.editCampo("FH_SALIDA",0)})})],64))])):(0,t.Q3)("v-if",!0)]),(0,t.Lk)("tr",null,[n[48]||(n[48]=(0,t.Lk)("th",null,[(0,t.Lk)("b",null,"Observación:")],-1)),(0,t.Lk)("td",null,[0===e.editables["OBSERVACION"]?((0,t.uX)(),(0,t.CE)("span",b,(0,i.v_)(e.infoModal.OBSERVACION),1)):((0,t.uX)(),(0,t.Wv)(Y,{key:1,modelValue:e.infoModal.OBSERVACION_new,"onUpdate:modelValue":n[17]||(n[17]=function(n){return e.infoModal.OBSERVACION_new=n}),type:"textarea","max-height":300,maxlength:"300"},null,8,["modelValue"]))]),e.acceso>2?((0,t.uX)(),(0,t.CE)("td",S,[0===e.editables["OBSERVACION"]?((0,t.uX)(),(0,t.Wv)(R,{key:0,icon:"edit",flat:"",dense:"",round:"",onClick:n[18]||(n[18]=function(n){return e.editCampo("OBSERVACION",1)})})):((0,t.uX)(),(0,t.Wv)(R,{key:1,icon:"close",flat:"",dense:"",round:"",onClick:n[19]||(n[19]=function(n){return e.editCampo("OBSERVACION",0)})}))])):(0,t.Q3)("v-if",!0)]),e.infoModal.MT>0?((0,t.uX)(),(0,t.CE)("tr",F,[n[49]||(n[49]=(0,t.Lk)("th",null,[(0,t.Lk)("b",null,"Min. Tardanza:")],-1)),(0,t.Lk)("td",null,[(0,t.Lk)("span",null,(0,i.v_)(e.infoModal.MT)+" Minutos",1)])])):(0,t.Q3)("v-if",!0),e.infoModal.MA>0?((0,t.uX)(),(0,t.CE)("tr",k,[n[50]||(n[50]=(0,t.Lk)("th",null,[(0,t.Lk)("b",null,"Min. Salida Anticipada:")],-1)),(0,t.Lk)("td",null,[(0,t.Lk)("span",null,(0,i.v_)(e.infoModal.MA)+" Minutos",1)])])):(0,t.Q3)("v-if",!0)])])),e.infoModal.detalle&&e.infoModal.detalle.length>0?((0,t.uX)(),(0,t.Wv)($,{key:1},{default:(0,t.k6)(function(){return[(0,t.bF)(q,null,{default:(0,t.k6)(function(){return a()(n[51]||(n[51]=[(0,t.eW)("Eventos:",-1)]))}),_:1}),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.infoModal.detalle,function(o){return(0,t.uX)(),(0,t.Wv)(X,null,{default:(0,t.k6)(function(){return[(0,t.bF)(U,{icon:o.ICONO,inverted:"",color:o.COLOR},null,8,["icon","color"]),(0,t.bF)(Q,null,{default:(0,t.k6)(function(){return[(0,t.bF)(j,{label:""},{default:(0,t.k6)(function(){return[(0,t.Lk)("b",null,(0,i.v_)(o.DESCRIPCION),1)]}),_:2},1024),(0,t.bF)(j,{sublabel:""},{default:(0,t.k6)(function(){return[(0,t.Lk)("div",v,[n[52]||(n[52]=(0,t.Lk)("b",null,"Inicio: ",-1)),(0,t.Lk)("span",null,(0,i.v_)(e.date(o.FH_INICIO,"DD/MM/YYYY hh:mm A"))+" ",1),n[53]||(n[53]=(0,t.Lk)("b",null,"Final:  ",-1)),(0,t.Lk)("span",null,(0,i.v_)(e.date(o.FH_FINAL,"DD/MM/YYYY hh:mm A"))+" ",1)])]}),_:2},1024)]}),_:2},1024)]}),_:2},1024)}),256))]}),_:1})):(0,t.Q3)("v-if",!0)],64)):3===e.tipoModal?((0,t.uX)(),(0,t.CE)("div",D,[(0,t.Lk)("div",g,[(0,t.bF)(l,{class:"q-if-outlined col",type:"date",modelValue:e.infoModal.fecIni,"onUpdate:modelValue":n[20]||(n[20]=function(n){return e.infoModal.fecIni=n}),"float-label":e.$t("desde"),format:"DD/MM/YYYY"},null,8,["modelValue","float-label"]),(0,t.bF)(l,{class:"q-if-outlined col",type:"date",modelValue:e.infoModal.fecFin,"onUpdate:modelValue":n[21]||(n[21]=function(n){return e.infoModal.fecFin=n}),"float-label":e.$t("hasta"),format:"DD/MM/YYYY"},null,8,["modelValue","float-label"])]),(0,t.bF)(T,{class:"q-if-outlined col",noBottom:"",filter:e.listaJefes.length>10,modelValue:e.infoModal.jefeSelect,"onUpdate:modelValue":n[22]||(n[22]=function(n){return e.infoModal.jefeSelect=n}),options:e.listaJefes,"float-label":"Encargado",onInput:e.selectJefeModal},null,8,["filter","modelValue","options","onInput"]),(0,t.bF)(T,{class:"q-if-outlined col",noBottom:"",filter:e.infoModal.equipo.length>10,modelValue:e.infoModal.profcod,"onUpdate:modelValue":n[23]||(n[23]=function(n){return e.infoModal.profcod=n}),options:e.infoModal.equipo,"float-label":"Personal"},null,8,["filter","modelValue","options"]),(0,t.bF)(T,{class:"q-if-outlined",modelValue:e.infoModal.ID_TIPO,"onUpdate:modelValue":n[24]||(n[24]=function(n){return e.infoModal.ID_TIPO=n}),options:e.leyenda,"float-label":"Estado"},null,8,["modelValue","options"]),(0,t.bF)(B,{modelValue:e.infoModal.marcaIngreso,"onUpdate:modelValue":n[25]||(n[25]=function(n){return e.infoModal.marcaIngreso=n})},{default:(0,t.k6)(function(){return a()(n[54]||(n[54]=[(0,t.eW)("Marcar de ingreso",-1)]))}),_:1},8,["modelValue"]),e.infoModal.marcaIngreso?((0,t.uX)(),(0,t.Wv)(l,{key:0,class:"q-if-outlined",type:"datetime",modelValue:e.infoModal.fh_ingreso,"onUpdate:modelValue":n[26]||(n[26]=function(n){return e.infoModal.fh_ingreso=n}),format:"DD/MM/YYYY hh:mm A"},null,8,["modelValue"])):(0,t.Q3)("v-if",!0),(0,t.bF)(B,{modelValue:e.infoModal.marcaSalida,"onUpdate:modelValue":n[27]||(n[27]=function(n){return e.infoModal.marcaSalida=n})},{default:(0,t.k6)(function(){return a()(n[55]||(n[55]=[(0,t.eW)("Marcar de salida",-1)]))}),_:1},8,["modelValue"]),e.infoModal.marcaSalida?((0,t.uX)(),(0,t.Wv)(l,{key:1,class:"q-if-outlined",type:"datetime",modelValue:e.infoModal.fh_salida,"onUpdate:modelValue":n[28]||(n[28]=function(n){return e.infoModal.fh_salida=n}),format:"DD/MM/YYYY hh:mm A"},null,8,["modelValue"])):(0,t.Q3)("v-if",!0),(0,t.bF)(Y,{class:"q-if-outlined",modelValue:e.infoModal.observacion,"onUpdate:modelValue":n[29]||(n[29]=function(n){return e.infoModal.observacion=n}),type:"textarea","max-height":300,maxlength:"300","float-label":"Observación"},null,8,["modelValue"]),(0,t.Lk)("div",L,[(0,t.bF)(B,{modelValue:e.infoModal.repetir,"onUpdate:modelValue":n[30]||(n[30]=function(n){return e.infoModal.repetir=n})},{default:(0,t.k6)(function(){return a()(n[56]||(n[56]=[(0,t.eW)("Repetir",-1)]))}),_:1},8,["modelValue"])])])):4===e.tipoModal?((0,t.uX)(),(0,t.CE)("div",E,[(0,t.Lk)("div",y,[(0,t.bF)(l,{class:"q-if-outlined col",type:"date",modelValue:e.infoModal.fecIni,"onUpdate:modelValue":n[31]||(n[31]=function(n){return e.infoModal.fecIni=n}),"float-label":e.$t("fecha"),format:"DD/MM/YYYY",onChange:e.obtFaltantes},null,8,["modelValue","float-label","onChange"]),(0,t.bF)(T,{class:"q-if-outlined col",modelValue:e.infoModal.ID_TIPO,"onUpdate:modelValue":n[32]||(n[32]=function(n){return e.infoModal.ID_TIPO=n}),options:e.leyenda,"float-label":"Estado",readonly:""},null,8,["modelValue","options"])]),(0,t.bF)(x,{class:"row q-pa-none q-ma-none justify-around",inverted:""},{default:(0,t.k6)(function(){return[(0,t.bF)(N,{class:"col q-pt-lg q-if-outlined",modelValue:e.infoModal.filter,"onUpdate:modelValue":n[33]||(n[33]=function(n){return e.infoModal.filter=n})},null,8,["modelValue"])]}),_:1}),(0,t.bF)(w,{"hide-bottom":"",data:e.infoModal.arrData,columns:e.columnsFaltas,selection:"multiple","row-key":"ID_TURNO",style:{height:"60vh"},filter:e.infoModal.filter,selected:e.infoModal.arrFaltas,"onUpdate:selected":n[34]||(n[34]=function(n){return e.infoModal.arrFaltas=n})},{"body-cell-H_INICIO":(0,t.k6)(function(n){return[(0,t.bF)(H,{props:n},{default:(0,t.k6)(function(){return[(0,t.Lk)("span",null,(0,i.v_)(e.date(n.row.H_INICIO,"hh:mm A")),1)]}),_:2},1032,["props"])]}),"body-cell-H_FINAL":(0,t.k6)(function(n){return[(0,t.bF)(H,{props:n},{default:(0,t.k6)(function(){return[(0,t.Lk)("span",null,(0,i.v_)(e.date(n.row.H_FINAL,"hh:mm A")),1)]}),_:2},1032,["props"])]}),_:1},8,["data","columns","filter","selected"])])):(0,t.Q3)("v-if",!0)]}),_:1},8,["modelValue","title","onSubmit"])])}var N=o(57008),V=o.n(N),R=(o(30683),o(23825),o(52133),o(10239),o(90095),o(6724),o(9240),o(70199),o(49089),o(27153),o(66307),o(13715),o(24066),o(6123)),H=o(96122),w=o(30545),P=o(80660),Y=o(57668),q=o(18105),U=o(30640),j=o(982),Q=o(69027),X=o(33001),$=o(93616),B=o(2819),x=o(13813),W={components:{sieSelect:$.A,QItemSeparator:R.CL,QPageSticky:R._U,QTabs:R.uw,QTab:R.zu,QTabPane:R.dg,QSelect:R.Si,QDatetime:R.T5,QTable:w.A,QTr:R.qh,QTh:R.EJ,QTd:R.Ef,QCheckbox:R.vZ,QCollapsible:R.eS,sieModal:U.A,QFab:R.l6,QFabAction:R.B$,QScrollArea:H.A,QSearch:R.Ks,QBtn:R.Il,QTooltip:R.nC,QInput:R.ie,QList:R.Mb,QListHeader:R.XR,QItem:R.H0,QItemSide:R.n1,QItemMain:R.mF,QItemTile:R.lp,QToolbar:R.ZV},props:["acceso","sieInfo","accesoP"],data:function(){return{sie:(0,Y["default"])(),filter:null,fecIni:new Date,fecFin:new Date,dataTipos:[],leyenda:[],datosAsistencia:[],filtroEspecial:["0490"].indexOf((0,Y["default"])().colcod)>=0,tipoFiltro:"T",selectFiltro:[],alto:null,listaJefes:[],jefeSelect:null,showAdicional:["055","001"].indexOf((0,Y["default"])().tipcod)>=0||this.accesoP,sinCerrar:!1,showModal:!1,datosBase:null,tipoModal:null,infoModal:{},cargando:!1,seleccionarCerrar:[],tiposModal:[null,"Detalles de asistencia","Editar asistencia","Agregar Registros","Procesar Faltas"],iconosTipo:{0:{ICONOTIPO:"perm_contact_calendar",ICONODESC:"Registro"},1:{ICONOTIPO:"daily_calendar",ICONODESC:"Gestión"},3:{ICONOTIPO:"folder_star",ICONODESC:"Especial"}},editables:{ID_TIPO:0,FH_INGRESO:0,FH_SALIDA:0,OBSERVACION:0},columns:[],columnsBase:[{name:"NOMCOMP",label:this.$t("apellidosynombres"),field:"NOMCOMP",align:"left",sortable:!0},{name:"FECHA",label:this.$t("fecha"),field:"FECHA",align:"center"},{name:"HORA",label:"H. Registro",field:"HORA",align:"center"},{name:"HORASAL",label:"Control",field:"HORASAL",align:"center"},{name:"USUCOD",label:"Usuario",field:"USUCOD",align:"center"}],columnsFaltas:[{name:"NOMCOMP",label:this.$t("apellidosynombres"),field:"NOMCOMP",align:"left"}]}},methods:{date:q.Ay,seleccionarPersonal:function(e){var n=this;e?this.datosAsistencia.forEach(function(e){n.seleccionarCerrar.indexOf(e)<0&&n.seleccionarCerrar.push(e)}):this.seleccionarCerrar=[]},cerrarMultiple:function(){var e=this,n=[];this.seleccionarCerrar.forEach(function(e){var o=e.ID_ASISTENCIA,l=e.ID_FRM_USUARIO;n.push({ID_ASISTENCIA:o,ID_FRM_USUARIO:l})}),(0,Q.dialogConfirm)({message:this.$t("mensajes.m0007")}).then(function(o){o&&P.$http.post("api/HyoApasistencia/saveSalida",{arrInfo:n}).then(function(n){var o=n.json;(0,j["default"])(e.$t("mensajes."+o.msg),o.type),"success"===o.type&&(e.init(),e.seleccionarCerrar=[],e.showModal=!1)})})},handleResize:function(){var e=220;this.alto=window.innerHeight-e+"px"},selectJefeModal:function(){var e=this,n={soloAsignados:"T"!==this.infoModal.jefeSelect,PROFCOD:"T"!==this.infoModal.jefeSelect?this.infoModal.jefeSelect:null,showTurnos:!0,fh_inicio:this.infoModal.fecIni,fh_fin:this.infoModal.fecFin,unicos:!0};P.$http.get("api/HyoJefaturapersona/obtEquipo",{params:n}).then(function(n){var o=n.json;e.infoModal.equipo=(0,x["default"])(o,function(e){return{label:e.NOMCOMP,value:e.PROFCOD}})})},obtFaltantes:function(){var e=this,n={fecha:this.infoModal.fecIni};this.infoModal.arrData=[],P.$http.get("api/HyoApasistencia/obtFaltas",{params:n}).then(function(n){var o=n.json;e.infoModal.arrData=o})},imprimirReporte:function(e){e||(e="pdf");var n=this.jefeSelect,o="intranet/reporte-node/reporte",l={reporte:1,fecini:(0,q.Ay)(this.fecIni,"YYYY-MM-DD"),fecfin:(0,q.Ay)(this.fecFin,"YYYY-MM-DD"),profcod:n,tiposSelect:this.selectFiltro,agrupadoFecha:0,repcod:"asistenciaPersonal",profeSelect:"T",formato:e,ano:(0,Y["default"])().ano},a=Math.abs(this.fecFin-this.fecIni),t=Math.ceil(a/864e5);if(t>30)return(0,j["default"])("El reporte no puede ser de mas de 30 días","warning"),!1;(0,B.exportFilePhp)(l,o,"Reporte ")},openModal:function(e,n){var o=this;this.tipoModal=e,this.showModal=!0,this.cargando=!1,n?2===e&&(this.cargando=!0,Promise.all([P.$http.get("api/HyoApassitenciaeventos/getInfo",{params:n}),P.$http.get("api/HyoApasistencia/getDetalleAsistencia",{params:n})]).then(function(e){n.detalle=e[0].json,o.infoModal=V()(V()({},e[1].json),n),o.cargando=!1})):(this.infoModal={jefeSelect:this.listaJefes[0].value,fecIni:new Date,fecFin:new Date,equipo:[],marcaSalida:!1,marcaIngreso:!1,observacion:null,fh_ingreso:new Date,fh_salida:new Date,arrFaltas:[],arrData:[],repetir:!1,filter:null},3===this.tipoModal?(this.infoModal.repetir=!1,this.selectJefeModal()):4===this.tipoModal&&(this.obtFaltantes(),this.infoModal.ID_TIPO=3))},saveSalida:function(e){var n=this,o=e.ID_ASISTENCIA,l=e.ID_FRM_USUARIO;(0,Q.dialogConfirm)({message:this.$t("mensajes.m0007")}).then(function(e){e&&P.$http.post("api/HyoApasistencia/saveSalida",{ID_ASISTENCIA:o,ID_FRM_USUARIO:l}).then(function(e){var o=e.json;(0,j["default"])(n.$t("mensajes."+o.msg),o.type),"success"===o.type&&(n.showModal=!1,n.init())})})},filtrarInfo:function(){var e=this;this.datosAsistencia=[];var n=(0,X.stringToStandard)(this.filter||"");this.datosAsistencia=this.datosBase.filter(function(o){var l=0;return e.sinCerrar&&o.FH_SALIDA&&(l=1),e.filtroEspecial?e.selectFiltro.length<e.dataTipos.length&&e.selectFiltro.indexOf(o.ID_TIPO)<0&&(l=1):"T"!==e.tipoFiltro&&o.ID_TIPO!==e.tipoFiltro&&(l=1),Object.values(o).some(function(e){return-1!==(0,X.stringToStandard)(e+"").indexOf(n)})||(l=1),0===l})},saveInfo:function(){var e=this;if(2===this.tipoModal){var n=0,o={ID_ASISTENCIA:this.infoModal.ID_ASISTENCIA};this.infoModal.FH_INGRESO!==this.infoModal.FH_INGRESO_new&&this.infoModal.FH_INGRESO_new&&(o.FH_INGRESO=this.infoModal.FH_INGRESO_new,n=1),this.infoModal.FH_SALIDA!==this.infoModal.FH_SALIDA_new&&this.infoModal.FH_SALIDA_new&&(o.FH_SALIDA=this.infoModal.FH_SALIDA_new,n=1),this.infoModal.OBSERVACION!==this.infoModal.OBSERVACION_new&&this.infoModal.OBSERVACION_new&&(o.OBSERVACION=this.infoModal.OBSERVACION_new,n=1),this.infoModal.ID_TIPO!==this.infoModal.ID_TIPO_new&&this.infoModal.ID_TIPO_new&&(o.ID_TIPO=this.infoModal.ID_TIPO_new,n=1),1===n&&P.$http.post("api/HyoApasistencia/updateAsistencia",o).then(function(n){var o=n.json;(0,j["default"])(e.$t("mensajes."+o.msg),o.type),"success"===o.type&&(e.init(),e.infoModal={},e.editables={ID_TIPO:0,FH_INGRESO:0,FH_SALIDA:0,OBSERVACION:0},e.showModal=!1)})}else if(3===this.tipoModal)if(this.infoModal.profcod)if(this.infoModal.ID_TIPO){var l={profcod:this.infoModal.profcod,desde:this.infoModal.fecIni,hasta:this.infoModal.fecFin,ID_TIPO:this.infoModal.ID_TIPO};this.infoModal.marcaSalida&&(l.saveSalida=this.infoModal.marcaSalida,l.fh_salida=this.infoModal.fh_salida),this.infoModal.marcaIngreso&&(l.saveIngreso=this.infoModal.marcaIngreso,l.fh_ingreso=this.infoModal.fh_ingreso),this.infoModal.observacion&&this.infoModal.observacion.length>0&&(l.observacion=this.infoModal.observacion),P.$http.post("api/HyoApasistencia/saveIngresoMultiple",l).then(function(n){var o=n.json;(0,j["default"])(e.$t("mensajes."+o.msg),o.type),"success"===o.type&&(e.init(),e.showModal=e.infoModal.repetir,e.infoModal.repetir&&(e.infoModal.profcod=null))})}else(0,j["default"])("Debe seleccionar un estado","error");else(0,j["default"])("Debe seleccionar un personal","error");else if(4===this.tipoModal)if(this.infoModal.arrFaltas.length<=0)(0,j["default"])("Debe seleccionar un personal");else{var a={ID_TIPO:this.infoModal.ID_TIPO,arrTurnos:(0,x["default"])(this.infoModal.arrFaltas,function(e){return e.ID_TURNO}),fecha:this.infoModal.fecIni};P.$http.post("api/HyoApasistencia/insertarFaltas",a).then(function(n){var o=n.json;(0,j["default"])(e.$t("mensajes."+o.msg),o.type),"success"===o.type&&(e.init(),e.showModal=!1)})}},editCampo:function(e,n){this.infoModal[e+"_new"]=this.infoModal[e],this.editables[e]=n},eliminarCampo:function(e,n){var o=this;(0,Q.dialogConfirm)().then(function(n){if(n){var l={ID_ASISTENCIA:o.infoModal.ID_ASISTENCIA};P.$http.post("api/HyoApasistencia/limpiarSalida",l).then(function(n){var l=n.json;(0,j["default"])(o.$t("mensajes."+l.msg),l.type),"success"!==l.type&&l.type||(o.init(),o.infoModal={},o.editables={ID_TIPO:0,FH_INGRESO:0,FH_SALIDA:0,OBSERVACION:0},o.showModal=!1,o.editables[e]=0)})}})},eliminarAsistencia:function(e){var n=this,o=e.ID_ASISTENCIA;(0,Q.dialogDelete)().then(function(e){e&&P.$http.post("api/HyoApasistencia/eliminarAsistencia",{ID_ASISTENCIA:o}).then(function(e){var o=e.json;(0,j["default"])(n.$t("mensajes."+o.msg),o.type),"success"===o.type&&(n.init(),n.showModal=!1)})})},init:function(){var e=this,n={fecIni:this.fecIni,fecFin:this.fecFin,soloAsignados:"T"!==this.jefeSelect,PROFCOD:"T"!==this.jefeSelect?this.jefeSelect:null};P.$http.get("api/AsistenciaColegioController/getAsistencia",{params:{params:n}}).then(function(n){e.datosBase=n.data.map(function(e){var n=new Date(e.FH_REGISTRO);return e.FH_SALIDA?e.HORASAL="Salida":e.HORASAL="Ingreso",e.HORA=n.toLocaleTimeString("en-US"),e.FECHA=(0,q.Ay)(e.FECHA,"YYYY-MM-DD"),e}),e.filtrarInfo()})},openProcesar:function(){this.openModal(4)},openAgregar:function(){this.openModal(3)},printpdf:function(){this.imprimirReporte()},printxls:function(){var e=(0,Y["default"])(),n={fecIni:this.fecIni,fecFin:this.fecFin,soloAsignados:"T"!==this.jefeSelect,PROFCOD:"T"!==this.jefeSelect?this.jefeSelect:null},o="".concat(e.host,"/api/AsistenciaColegioController/exportar?params=").concat(JSON.stringify(n));(0,B.open)({action:o})}},unmounted:function(){window.removeEventListener("resize",this.handleResize)},computed:{buttons:function(){var e=[{label:"Excel",icon:"file_excel",click:this.printxls}];return e},selectAll:function(){var e=this,n=0;this.seleccionarCerrar.forEach(function(o){e.datosAsistencia.indexOf(o)>=0&&n++});var o=!1;return n>0&&(o=n===this.datosAsistencia.length||void 0),o}},created:function(){var e=this;"0516"===this.sie.colcod&&this.columnsFaltas.push({name:"NOMJEFE",label:this.$t("Encargado"),field:"NOMJEFE",align:"left"}),this.columnsFaltas.push({name:"H_INICIO",label:this.$t("inicio"),field:"H_INICIO",align:"left"}),this.columnsFaltas.push({name:"H_FINAL",label:this.$t("final"),field:"H_FINAL",align:"left"}),P.$http.get("api/HyoAptipos/obtInfo").then(function(n){var o=n.json;e.filtroEspecial?o.forEach(function(n,o){e.leyenda.push({label:n.DESCRIPCION,value:n.ID_TIPO,COLOR:n.COLOR,ICONO:n.ICONO,icon:n.ICONO}),e.selectFiltro.push(n.ID_TIPO)}):(e.dataTipos.push({label:"Todos",value:"T"}),e.leyenda=(0,x["default"])(o,function(e){return{label:e.DESCRIPCION,value:e.ID_TIPO,COLOR:e.COLOR,ICONO:e.ICONO,icon:e.ICONO}})),e.dataTipos=[].concat(a()(e.dataTipos),a()(e.leyenda))}),this.showAdicional?P.$http.get("api/HyoJefaturapersona/obtJefes",{params:{soloAsignados:!0}}).then(function(n){var o=n.json;o.unshift({PROFCOD:"T",NOMCOMP:"Todos"}),e.jefeSelect="T",e.init(),e.listaJefes=(0,x["default"])(o,function(e){return{label:e.NOMCOMP,value:e.PROFCOD}})}):(this.jefeSelect=this.sie.profcod,this.init()),window.addEventListener("resize",this.handleResize),this.columns=a()(this.columnsBase),this.handleResize()},watch:{filter:function(e){this.filtrarInfo()},sinCerrar:function(e){this.columns=[],this.columns=a()(this.columnsBase)}}},G=o(12807);const J=(0,G.A)(W,[["render",T]]);var z=J}}]);