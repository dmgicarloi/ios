"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[83682],{83682:function(e,a,o){o.r(a),o.d(a,{default:function(){return Ne}});var r=o(8445),t=o.n(r),n=o(61758),i=o(58790),l=o(29104),s={class:"row q-ma-xs q-col-gutter-sm"},c={class:"col-xs-12 col-md-12 col-lg-6"},u={key:0,class:"row q-ma-xs q-col-gutter-sm"},d={class:"col-xs-4"},p={class:"col-xs-8"},m={key:1,class:"row q-ma-xs q-col-gutter-sm"},f={key:0,class:"col-xs-4"},g={key:1,class:"col-xs-4"},h={key:2,class:"col-xs-4"},v={key:2,class:"row q-ma-xs q-col-gutter-sm"},C={class:"col-xs-12"},A={class:"row q-ma-xs q-col-gutter-sm"},b={class:"row q-ma-xs q-col-gutter-sm"},D={key:0,class:"col-xs-6"},O={class:"co-xs-4"},w={class:"row q-ma-xs q-col-gutter-sm"},R={class:"col-xs-12"},I={key:3,class:"row q-ma-xs q-col-gutter-sm"},M={class:"col-xs-12"},N={class:"col-xs-12 col col-md-12 col-lg-6"},S={class:"row q-ma-xs q-col-gutter-sm"},k={class:"col-xs-12 col-sm-12 col-md-12 col-lg-12"},E={class:"row q-ma-xs q-col-gutter-sm"},T={class:"col-xs-6 col-lg-6"},_={class:"col-xs-6 col-lg-6"},P={class:"col-xs-12 col-sm-12 col-md-12 col-lg-12"},F={class:"row q-ma-xs q-col-gutter-sm"},L={class:"col-xs-12"},H={class:"row"},V={class:"col-12"};function x(e,a){var o=(0,n.g2)("q-page-header"),r=(0,n.g2)("q-separator"),x=(0,n.g2)("tesoreriaLoading"),G=(0,n.g2)("q-select"),y=(0,n.g2)("q-date"),U=(0,n.g2)("q-popup-proxy"),q=(0,n.g2)("q-icon"),$=(0,n.g2)("q-input"),Q=(0,n.g2)("q-checkbox"),B=(0,n.g2)("q-option-group"),j=(0,n.g2)("q-chip-table"),K=(0,n.g2)("sie-grid"),X=(0,n.g2)("footer-grid"),Y=(0,n.g2)("q-card-section"),z=(0,n.g2)("sie-modal"),W=(0,n.g2)("mensaje"),J=(0,n.g2)("q-card");return(0,n.uX)(),(0,n.Wv)(J,{class:"layout-v1 my-card",flat:"",bordered:""},{default:(0,n.k6)(function(){return[(0,n.bF)(o,{useTab:"",onActionTab:e.actionTab,botones:e.pageHeader.botones,title:e.pageHeader.title,tabs:e.pageHeader.tabs,componente:"cartaMorosidad"},null,8,["onActionTab","botones","title","tabs"]),(0,n.bF)(r),(0,n.bF)(x,{modelValue:e.loading.showLoading,total:e.loading.total,procesados:e.loading.procesados},null,8,["modelValue","total","procesados"]),(0,n.bo)((0,n.bF)(Y,null,{default:(0,n.k6)(function(){return[(0,n.Lk)("div",s,[(0,n.Lk)("div",c,[e.cartaMorosidadFamiliar?(0,n.Q3)("v-if",!0):((0,n.uX)(),(0,n.CE)("div",u,[(0,n.Lk)("div",d,[(0,n.bF)(G,{label:"Perfil","option-label":"label","option-value":"value",options:e.perfiles,modelValue:e.selectPerfil,"onUpdate:modelValue":a[0]||(a[0]=function(a){return e.selectPerfil=a}),onInput:e.getPerPerfil},null,8,["options","modelValue","onInput"])]),(0,n.Lk)("div",p,[(0,n.bF)(G,{class:"truncate-label",label:"Persona","option-label":"label","option-value":"value",options:e.personas,modelValue:e.selectPersona,"onUpdate:modelValue":a[1]||(a[1]=function(a){return e.selectPersona=a}),onInput:e.getDeudores},null,8,["options","modelValue","onInput"])])])),e.cartaMorosidadFamiliar?(0,n.Q3)("v-if",!0):((0,n.uX)(),(0,n.CE)("div",m,[e.selectPerfil===e.PERFIL_ALUMNO?((0,n.uX)(),(0,n.CE)("div",f,[(0,n.bF)(G,{label:"Nivel",options:e.niveles,"option-label":"label","option-value":"value",modelValue:e.selectNivel,"onUpdate:modelValue":a[2]||(a[2]=function(a){return e.selectNivel=a}),onInput:e.getGrados},null,8,["options","modelValue","onInput"])])):(0,n.Q3)("v-if",!0),e.selectPerfil===e.PERFIL_ALUMNO?((0,n.uX)(),(0,n.CE)("div",g,[(0,n.bF)(G,{label:"Grado","option-label":"label","option-value":"value",options:e.grados,modelValue:e.selectGrado,"onUpdate:modelValue":a[3]||(a[3]=function(a){return e.selectGrado=a}),onInput:e.getSecciones},null,8,["options","modelValue","onInput"])])):(0,n.Q3)("v-if",!0),e.selectPerfil===e.PERFIL_ALUMNO?((0,n.uX)(),(0,n.CE)("div",h,[(0,n.bF)(G,{label:"Seccion","option-label":"label","option-value":"value",options:e.secciones,modelValue:e.selectSeccion,"onUpdate:modelValue":a[4]||(a[4]=function(a){return e.selectSeccion=a}),onInput:e.getDeudores},null,8,["options","modelValue","onInput"])])):(0,n.Q3)("v-if",!0)])),e.cartaMorosidadFamiliar?((0,n.uX)(),(0,n.CE)("div",v,[(0,n.Lk)("div",C,[(0,n.bF)(G,{label:"Famiia",placeholder:"Seleccione la familia",options:e.familias,modelValue:e.selectFamilia,"onUpdate:modelValue":a[5]||(a[5]=function(a){return e.selectFamilia=a}),onInput:e.getDeudores},null,8,["options","modelValue","onInput"])])])):(0,n.Q3)("v-if",!0),(0,n.Lk)("div",A,[(0,n.Lk)("div",{class:(0,i.C4)(e.cartaMorosidadFamiliar?"col-xs-6":"col-xs-4")},[(0,n.bF)(G,{label:"Año",options:e.anios,"option-label":"label","option-value":"value",modelValue:e.selectAnio,"onUpdate:modelValue":a[6]||(a[6]=function(a){return e.selectAnio=a}),onInput:e.getDeudores},null,8,["options","modelValue","onInput"])],2),(0,n.Lk)("div",{class:(0,i.C4)(e.cartaMorosidadFamiliar?"col-xs-6":"col-xs-4")},[(0,n.bF)($,{"reverse-fill-mask":"",maxlength:"10",mask:"##/##/####",label:"Fecha Vencimiento",modelValue:e.selectDia,"onUpdate:modelValue":a[9]||(a[9]=function(a){return e.selectDia=a})},{append:(0,n.k6)(function(){return[(0,n.bF)(q,{class:"cursor-pointer",name:"date_range"},{default:(0,n.k6)(function(){return[(0,n.bF)(U,{ref:"qDateProxy1","transition-show":"scale","transition-hide":"scale"},{default:(0,n.k6)(function(){return[(0,n.bF)(y,{mask:"DD/MM/YYYY",modelValue:e.selectDia,"onUpdate:modelValue":a[7]||(a[7]=function(a){return e.selectDia=a}),onInput:a[8]||(a[8]=function(a){return e.closeModalCalendar("qDateProxy1")})},null,8,["modelValue"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])],2)]),(0,n.Lk)("div",b,[e.cartaMorosidadFamiliar?((0,n.uX)(),(0,n.CE)("div",D,[(0,n.bF)(G,{label:"Concepto",placeholder:"Seleccione Concepto",options:e.dataConceptos,onInput:e.getDeudores,modelValue:e.selectConcepto,"onUpdate:modelValue":a[10]||(a[10]=function(a){return e.selectConcepto=a})},null,8,["options","onInput","modelValue"])])):(0,n.Q3)("v-if",!0),(0,n.Lk)("div",{class:(0,i.C4)(e.cartaMorosidadFamiliar?"col-xs-3":"col-xs-4")},[(0,n.bF)(Q,{modelValue:e.ckbNumMes,"onUpdate:modelValue":a[11]||(a[11]=function(a){return e.ckbNumMes=a}),label:"Nro. Deudas",onInput:e.checkDeudas},null,8,["modelValue","onInput"])],2),e.ckbNumMes?((0,n.uX)(),(0,n.CE)("div",{key:1,class:(0,i.C4)(e.cartaMorosidadFamiliar?"col-xs-3":"col-xs-4")},[(0,n.bF)($,{label:"Cantidad Deudas",modelValue:e.nroDeudas,"onUpdate:modelValue":a[12]||(a[12]=function(a){return e.nroDeudas=a}),type:"number",onBlur:e.getDeudores,onKeyup:(0,l.jR)(e.getDeudores,["enter"])},null,8,["modelValue","onBlur","onKeyup"])],2)):(0,n.Q3)("v-if",!0),(0,n.Lk)("div",O,[(0,n.bF)(Q,{modelValue:e.enviarCorreo,"onUpdate:modelValue":a[13]||(a[13]=function(a){return e.enviarCorreo=a}),label:"Enviar Correo",onInput:e.activarMensajeCorreo},null,8,["modelValue","onInput"])])]),(0,n.Lk)("div",w,[(0,n.Lk)("div",R,[a[22]||(a[22]=(0,n.eW)("Ordenar Por:",-1)),(0,n.bF)(B,{type:"radio",options:e.optionsOrden,modelValue:e.selectOrden,"onUpdate:modelValue":a[14]||(a[14]=function(a){return e.selectOrden=a}),inline:!0,onInput:e.getDeudores},null,8,["options","modelValue","onInput"])])]),e.cartaMorosidadFamiliar?(0,n.Q3)("v-if",!0):((0,n.uX)(),(0,n.CE)("div",I,[(0,n.Lk)("div",M,[(0,n.bF)(j,{modelValue:e.conceptosSelect,"onUpdate:modelValue":a[15]||(a[15]=function(a){return e.conceptosSelect=a}),title:"Conceptos de Cobro",items:e.dataConceptos,onInput:e.getDeudores,textValue:"Código",textLabel:"Concepto"},null,8,["modelValue","items","onInput"])])]))]),(0,n.Lk)("div",N,[(0,n.bF)(Y,null,{default:(0,n.k6)(function(){return[(0,n.bF)(K,{class:"fix-tab-height ag-theme-balham",frameworkComponents:e.frameworkComponents,columnDefs:e.columnDefs,rowData:e.rowData,onRowSelected:e.rowSelected,onGridReady:e.onGridReady,style:{height:"60vh"}},null,8,["frameworkComponents","columnDefs","rowData","onRowSelected","onGridReady"]),(0,n.bF)(X,{modelValue:e.pagina,"onUpdate:modelValue":a[16]||(a[16]=function(a){return e.pagina=a}),max:e.pages,onLoad:e.getDeudores,rows:e.rowData},null,8,["modelValue","max","onLoad","rows"])]}),_:1})])])]}),_:1},512),[[l.aG,e.pageHeader.tabActive===e.pageHeader.tabsKey.generacion]]),e.pageHeader.tabsKey.historial===e.pageHeader.tabActive?((0,n.uX)(),(0,n.Wv)(Y,{key:0},{default:(0,n.k6)(function(){return[(0,n.Lk)("div",S,[(0,n.Lk)("div",k,[(0,n.Lk)("div",E,[(0,n.Lk)("div",T,[(0,n.bF)(G,{placeholder:"Seleccionar Año",label:"Año",options:e.anios,modelValue:e.filtroHistorial.anio,"onUpdate:modelValue":a[17]||(a[17]=function(a){return e.filtroHistorial.anio=a}),onInput:e.getHistorialCorreos},null,8,["options","modelValue","onInput"])]),(0,n.Lk)("div",_,[(0,n.bF)(G,{placeholder:"Seleccione Mes",label:"Mes",options:e.meses,modelValue:e.filtroHistorial.mes,"onUpdate:modelValue":a[18]||(a[18]=function(a){return e.filtroHistorial.mes=a}),onInput:e.getHistorialCorreos},null,8,["options","modelValue","onInput"])])])]),(0,n.Lk)("div",P,[(0,n.Lk)("div",F,[(0,n.Lk)("div",L,[(0,n.bF)(K,{class:"fix-tab-height ag-theme-balham",onGridReady:e.onGridReadyHistorial,style:{height:"50vh"},columnDefs:e.gridHistorial.columnDefs,rowData:e.gridHistorial.rowData,frameworkComponents:e.gridHistorial.frameworkComponents,defaultColDef:e.gridHistorial.defaultColDef,floatingFilter:"",enableCellTextSelection:""},null,8,["onGridReady","columnDefs","rowData","frameworkComponents","defaultColDef"]),(0,n.bF)(X,{modelValue:e.gridHistorial.pagina,"onUpdate:modelValue":a[19]||(a[19]=function(a){return e.gridHistorial.pagina=a}),max:e.gridHistorial.pages,onLoad:e.getHistorialCorreos,rows:e.gridHistorial.rowData},null,8,["modelValue","max","onLoad","rows"])])])])])]}),_:1})):(0,n.Q3)("v-if",!0),(0,n.bF)(z,{modelValue:e.modalOptionReporte,"onUpdate:modelValue":a[21]||(a[21]=function(a){return e.modalOptionReporte=a}),labelButtonOk:"Aceptar",onSubmit:e.closeModalOptionReporte},{default:(0,n.k6)(function(){return[(0,n.bF)(Y,null,{default:(0,n.k6)(function(){return t()(a[23]||(a[23]=[(0,n.Lk)("div",{class:"row item-center no-wrap"},[(0,n.Lk)("div",{class:"col"},[(0,n.Lk)("div",{class:"text-h6"},"Tipo de Carta de Morosidad")])],-1)]))}),_:1}),(0,n.bF)(Y,null,{default:(0,n.k6)(function(){return[(0,n.Lk)("div",H,[(0,n.Lk)("div",V,[(0,n.bF)(B,{color:"primary",type:"radio",modelValue:e.selectTipoReporte,"onUpdate:modelValue":a[20]||(a[20]=function(a){return e.selectTipoReporte=a}),options:e.tiposReporte},null,8,["modelValue","options"])])])]}),_:1})]}),_:1},8,["modelValue","onSubmit"]),(0,n.bo)((0,n.bF)(W,{ref:e.pageHeader.tabsKey.mensaje,codigo:e.selectTipoReporte,tab:!0},null,8,["codigo"]),[[l.aG,e.pageHeader.tabActive===e.pageHeader.tabsKey.mensaje]]),(0,n.bo)((0,n.bF)(W,{ref:e.pageHeader.tabsKey.correo,codigo:e.codigoMensajeCorreo,tab:!0},null,8,["codigo"]),[[l.aG,e.pageHeader.tabActive===e.pageHeader.tabsKey.correo]])]}),_:1})}var G=o(41562),y=o.n(G),U=o(9504),q=o.n(U),$=o(57008),Q=o.n($),B=o(99550),j=o.n(B),K=o(76080),X=o.n(K),Y=o(45254),z=o.n(Y),W=(o(30683),o(71225),o(39866),o(52133),o(10239),o(56285),o(50310),o(5962),o(6724),o(11777),o(83190),o(88567)),J=o(95718),Z=o(53380),ee=o(54489),ae=o(64208),oe=o(3112),re=o(12143),te=o(95477),ne=o(80660),ie=o(6123),le=o(62006),se=o(36408),ce=o(27560),ue=o(75053),de=o(41615),pe=o(33950),me=o(59089),fe=o(95051),ge=o(6083),he=o(57668),ve=o(64303),Ce=o(37804),Ae=o(17915),be=o(2652),De=o(71818),Oe=o(78840),we=o(18105),Re={components:{crearBotones:ve.A,QDate:re.A,QPopupProxy:te.A,QCard:W.A,QCardSection:J.A,QSelect:ee.S,QOptionGroup:ie.EX,QSeparator:Z.A,sieGrid:se.A,QInput:ae.A,footerGrid:ce.A,sieModal:ue.A,QCheckbox:oe.A,Upload:pe["default"],sieUpload:me.A,QDownloadFile:le.A,QChip:fe.A,sieEditor:ge.A,tesoreriaLoading:Ae.A,QPageHeader:be.A,mensaje:De["default"],QChipTable:Ce.A,QIcon:ie.bP},data:function(){return{LECTURA_ESCRITURA:de["default"].LECTURA_ESCRITURA,nivelAcceso:(0,he["default"])().ruta.nivel||3,openModal:!0,openModalConfigMsg:!1,title:"Cartas de Morosidad",api:"",rowData:null,columnDefs:null,frameworkComponents:{},PERFIL_ALUMNO:de["default"].PERFIL_ALUMNO,selectPerfil:de["default"].PERFIL_ALUMNO,selectAnio:de["default"].TOKEN_YEAR,selectDia:de["default"].CURRENT_DAY,selectNivel:de["default"].TODOS,selectGrado:de["default"].TODOS,selectSeccion:de["default"].TODOS,selectPersona:de["default"].TODOS,conceptosSelect:[],Conceptos:[],dataConceptos:[],formRemoveConceptos:{},ckbEnviarIntranet:!0,ckbNumMes:!1,perfiles:[],anios:[],niveles:[],grados:[],secciones:[],pagina:1,pages:1,nroDeudas:0,personas:[],mensaje:"",correoRemitente:"",asunto:"",statusBar:null,idEnvio:null,correoEnviado:!1,modalOptionReporte:!0,selectTipoReporte:de["default"].TIPO_ALERTA.MOROSIDAD,tiposReporte:[{label:"Carta Individual(Formato A4)",value:de["default"].TIPO_ALERTA.MOROSIDAD},{label:"Carta Simple(Formato A5)",value:de["default"].TIPO_ALERTA.MOROSIDAD_A5}],componente:"cartaMorosidad",botones:[],P_TIPO_CARTA_MOROSIDAD:2,cartaMorosidadFamiliar:!1,columnsConceptos:[{headerName:"Código",field:"value",width:70},{headerName:"Concepto",field:"label",width:320}],filterLabelConcepto:{value:"Código",label:"Concepto"},selectConcepto:de["default"].TODOS,familias:[],selectFamilia:de["default"].TODOS,loading:{showLoading:!1,procesados:0,total:0},optionsOrden:[],selectOrden:3,pageHeader:{botones:[],tabActive:"index",title:"Carta Morosidad",tabs:[{name:"index",label:"generación"},{name:"mensaje",label:"carta"}],tabsKey:{generacion:"index",mensaje:"mensaje",correo:"correo",historial:"historial"}},enviarCorreo:!1,codigoMensajeCorreo:"0027",gridHistorial:{frameworkComponents:{actionButton:Oe.A},rowData:[],columnDefs:[],api:null,params:null,defaultColDef:{suppressHeaderMenuButton:!0,filter:!0,floatingFilterComponentParams:{suppressFilterButton:!0},resizable:!0,sortable:!0,suppressDragLeaveHidesColumns:!0},pagina:1,pages:1},filtroHistorial:{mes:de["default"].CURRENT_MONTH,anio:String(de["default"].CURRENT_YEAR)},meses:[]}},created:function(){this.statusBar={statusPanels:[{statusPanel:"agTotalAndFilteredRowCountComponent",align:"left"}]}},methods:{columnsHistorial:function(){var e=[{headerName:"Código",field:"ID_MAIL_CAMPAIGN",width:70},{headerName:"Fecha Envío",field:"FECHA_ENVIO",valueFormatter:function(e){return e.value?(0,we.Ay)(e.value,"DD/MM/YYYY"):null},filter:"agDateColumnFilter",width:140},{headerName:"Hora Envío",field:"FECHA_ENVIO",valueFormatter:function(e){return e.value?(0,we.Ay)(e.value," HH:mm"):null},width:90},{headerName:"Usuario",field:"USUCOD",width:115},{headerName:"Asunto",field:"ASUNTO",width:400},{headerName:"Sin Enviar",field:"NO_ENVIADO",width:90},{headerName:"Enviado",field:"ENVIADO",width:90},{headerName:"Error",field:"ERROR",width:90},{cellRenderer:Oe.A,cellRendererParams:{icon:"file_pdf",onClick:this.generarReportePdf},width:50,filter:!1},{cellRenderer:Oe.A,cellRendererParams:{icon:"file_excel_new",onClick:this.generarReporteXls},width:50,filter:!1}];this.gridHistorial.columnDefs=e},generarReportePdf:function(e){var a=e.data.ID_MAIL_CAMPAIGN;if(!a)return this.$alert("No se han enviado correos");var o="".concat(origin,"/webservice/reporte-tesoreria/reporte-alertas?idMailCampaign=").concat(a,"&format=pdf");window.open(o,"_blank")},generarReporteXls:function(e){var a=e.data.ID_MAIL_CAMPAIGN;if(!a)return this.$alert("No se han enviado correos");var o="".concat(origin,"/webservice/reporte-tesoreria/reporte-alertas?idMailCampaign=").concat(a,"&format=xls");window.open(o,"_blank")},getHistorialCorreos:function(){var e=this;return z()(X()().m(function a(){var o;return X()().w(function(a){while(1)switch(a.n){case 0:return o={mes:e.filtroHistorial.mes,anio:e.filtroHistorial.anio},a.n=1,ne.$http.get("api/EnvioAlertaController/getEnviosAlerta",{params:{params:o}});case 1:e.gridHistorial.rowData=a.v;case 2:return a.a(2)}},a)}))()},onGridReadyHistorial:function(e){this.gridHistorial.api=e.api,this.gridHistorial.params=e},activarMensajeCorreo:function(){var e=this;if(this.pageHeader.botones=this.crearBotones(),this.enviarCorreo)return this.pageHeader.tabs.push({name:"correo",label:"correo"},{name:"historial",label:"Historial"}),!0;this.pageHeader.tabs=this.pageHeader.tabs.filter(function(a){return![e.pageHeader.tabsKey.correo,e.pageHeader.tabsKey.historial].includes(a.name)})},getOrden:function(){var e=[{label:"Alfabético",value:3},{label:"Código",value:2}];this.cartaMorosidadFamiliar||e.push({label:"NGS",value:1}),this.optionsOrden=e},actionTab:function(e){var a=this;return z()(X()().m(function o(){var r;return X()().w(function(o){while(1)switch(o.n){case 0:if(a.pageHeader.tabActive=e,e!==a.pageHeader.tabsKey.generacion){o.n=1;break}return a.pageHeader.botones=a.crearBotones(),a.pageHeader.title=a.createTitle(),o.a(2,!0);case 1:if(e!==a.pageHeader.tabsKey.historial){o.n=2;break}return a.pageHeader.title="Historial de Envios",a.pageHeader.botones=[],o.a(2,!0);case 2:return o.n=3,a.$refs[e].obtenerDatosTab();case 3:return r=o.v,a.pageHeader.title=r.title,a.pageHeader.botones=r.botones,o.a(2,!0)}},o)}))()},getMeses:function(){var e=this;return z()(X()().m(function a(){return X()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,de["default"].MESES();case 1:e.meses=a.v;case 2:return a.a(2)}},a)}))()},crearBotones:function(){return this.botones=[{label:"Cambiar",icon:"change_sync",click:this.openModalOptionReporte,minAcceso:de["default"].SOLO_LECTURA}],this.enviarCorreo&&this.botones.push({label:"Enviar Cartas",icon:"email",click:this.submit,minAcceso:de["default"].SOLO_LECTURA}),this.enviarCorreo||this.botones.push({label:"Generar Carta",icon:"file_pdf",click:this.submit,minAcceso:de["default"].SOLO_LECTURA}),this.botones},createTitle:function(){var e=this,a=this.tiposReporte.filter(function(a){return Number(a.value)===Number(e.selectTipoReporte)}),o=j()(a,1),r=o[0];return this.title="Carta de Morosidad: ".concat(r.label),this.pageHeader.title=this.title,this.title},openModalOptionReporte:function(){this.modalOptionReporte=!0},closeModalOptionReporte:function(){this.modalOptionReporte=!1,this.createTitle()},searchParams:function(){},rowSelected:function(){},checkDeudas:function(){!0===this.ckbNumMes&&this.nroDeudas>0&&this.getDeudores()},getPerPerfil:function(){var e=this;return z()(X()().m(function a(){var o;return X()().w(function(a){while(1)switch(a.p=a.n){case 0:return a.p=0,e.personas=[],e.selectPersona=de["default"].TODOS,a.n=1,ne.$http.get("api/personaController/getPersonaPerfil",{params:{params:{id_perfil:e.selectPerfil}}});case 1:o=a.v,o.length>0?(e.personas.push({value:"T",label:"Todos"}),o.map(function(a){return e.personas.push({value:a.ID_PERSONA,label:a.NOMBRE})})):e.personas=[],e.getDeudores(),a.n=3;break;case 2:a.p=2,a.v;case 3:return a.a(2)}},a,null,[[0,2]])}))()},onGridReady:function(e){this.api=e.api},getConceptos:function(){var e=this;return z()(X()().m(function a(){return X()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,de["default"].API_CONCEPTOS({render:"grid"});case 1:e.dataConceptos=a.v,e.cartaMorosidadFamiliar&&e.dataConceptos.unshift({label:"Todos",value:"T"});case 2:return a.a(2)}},a)}))()},obtenerConceptos:function(e){this.getDeudores()},getPerfiles:function(){var e=this;return z()(X()().m(function a(){return X()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,de["default"].API_PERFILES();case 1:e.perfiles=a.v;case 2:return a.a(2)}},a)}))()},getAnios:function(){var e=this;return z()(X()().m(function a(){return X()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,de["default"].API_ANIOS();case 1:e.anios=a.v;case 2:return a.a(2)}},a)}))()},getAlumno:function(e){},reporteCorreo:function(){if(this.idEnvio){var e="".concat(origin,"/webservice/reporte-tesoreria/reporte-alertas?idEnvio=").concat(this.idEnvio);window.open(e,"_blank")}else this.$alert("No se han enviado correos")},generarPdfSimple:function(){var e=this;return z()(X()().m(function a(){var o;return X()().w(function(a){while(1)switch(a.n){case 0:if(o=e.rowData,0!==o.length){a.n=1;break}return a.a(2,e.$alert("No existe ningún registro para exportar","warning"));case 1:e.$confirm("¿Esta seguro de generar la carta de morosidad a los (".concat(o.length,") registros seleccionados?")).onOk(z()(X()().m(function a(){var r,t,n,i,l,s,c,u,d,p,m,f,g,h,v,C,A;return X()().w(function(a){while(1)switch(a.p=a.n){case 0:if(a.p=0,e.loading.showLoading=!0,e.loading.total=o.length,e.loading.procesados=0,r={correctamente:[],errores:[]},!e.enviarCorreo){a.n=2;break}return n={MSGCOD:e.selectTipoReporte},a.n=1,ne.$http.post("api/EnvioAlertaController/postRegistrarMailCampaign",{params:n});case 1:t=a.v;case 2:i=e.conceptosSelect.map(function(e){return e.value}),h=q()(o);case 3:if((v=h()).done){a.n=10;break}if(l=v.value,a.p=4,o[l].CONCEPTO=i,s={MSGCOD:e.selectTipoReporte,formato:de["default"].FORMATO_CARTA_MOROSIDAD[e.selectTipoReporte],index:l,ANOCOB:e.selectAnio,enviarCorreo:e.enviarCorreo},e.enviarCorreo&&(s.ID_MAIL_CAMPAIGN=t.ID_MAIL_CAMPAIGN),Number(l)%2!==0&&0!==Number(l)){a.n=6;break}return a.n=5,ne.$http.get("api/EnvioAlertaController/getPlantillaCartaMorosidad",{params:{params:Q()(Q()({},s),o[l])}});case 5:c=a.v,r.correctamente.push(c);case 6:a.n=8;break;case 7:a.p=7,C=a.v,r.errores.push(C);case 8:return a.p=8,e.loading.procesados++,a.f(8);case 9:a.n=3;break;case 10:return a.n=11,ne.$http.post("api/EnvioAlertaController/postGenerarCartaMorosidad",{params:{MSGCOD:e.selectTipoReporte}});case 11:if(u=a.v,d="",p="",r.errores.length>0&&(d+="Procesos con Errores:(".concat(r.errores.length,") "),p="warning"),r.correctamente.length>0&&(d+="Procesado finalizado:(".concat(r.correctamente.length,") Cartas Generadas Satisfactoriamente "),p="success"),e.enviarCorreo){a.n=12;break}return m='{"name":"'.concat(u.archivo,'","ruta":"').concat(u.ruta,'","tipo":"pdf"}'),a.n=12,de["default"].DESCARGAR_ARCHIVO(m);case 12:1===r.errores.length&&0===r.correctamente.length&&(f=j()(r.errores,1),g=f[0],d=g.message),e.loading.showLoading=!1,e.getHistorialCorreos(),e.$alert(d,p),a.n=14;break;case 13:return a.p=13,A=a.v,e.loading.showLoading=!1,a.a(2,e.$alert(A.error.message||A.message,"warning"));case 14:return a.p=14,e.loading.showLoading=!1,a.f(14);case 15:return a.a(2)}},a,null,[[4,7,8,9],[0,13,14,15]])})));case 2:return a.a(2)}},a)}))()},generarCartaMorosidadFamiliar:function(){var e=this,a=this.rowData;if(0===a.length)return this.$alert("No existe ningún registro para exportar","warning");this.$confirm("¿Esta seguro de generar la carta de morosidad a los (".concat(a.length,") registros?")).onOk(z()(X()().m(function o(){var r,t,n,i,l,s,c,u,d,p,m,f,g,h,v,C,A,b;return X()().w(function(o){while(1)switch(o.p=o.n){case 0:if(o.p=0,!e.enviarCorreo){o.n=2;break}return t={MSGCOD:e.selectTipoReporte},o.n=1,ne.$http.post("api/EnvioAlertaController/postRegistrarMailCampaign",{params:t});case 1:r=o.v;case 2:e.loading.showLoading=!0,e.loading.total=a.length,e.loading.procesados=0,n={correctamente:[],errores:[]},v=q()(a);case 3:if((C=v()).done){o.n=12;break}if(i=C.value,o.p=4,l=a[i],s={FAMCOD:l.FAMCOD,ID_PERFAM:l.ID_PERFARM,FECVEN:e.convertDay(e.selectDia),ANOCOB:e.selectAnio,CONCOB:e.selectConcepto,MSGCOD:e.selectTipoReporte,index:i,enviarCorreo:e.enviarCorreo,envioFamilia:!0},e.enviarCorreo&&(s.ID_MAIL_CAMPAIGN=r.ID_MAIL_CAMPAIGN),Number(i)%2!==0&&(0!==Number(i)||String(e.selectTipoReporte)!==String(de["default"].TIPO_ALERTA.MOROSIDAD_A5))){o.n=6;break}return s.nextRegistro=a[Number(i)+1],o.n=5,ne.$http.get("api/EnvioAlertaController/getPlantillaCartaMorosidad",{params:{params:s}});case 5:return c=o.v,n.correctamente.push(c),o.a(3,3);case 6:if(de["default"].TIPO_ALERTA.MOROSIDAD_A4!==e.selectTipoReporte){o.n=8;break}return o.n=7,ne.$http.get("api/EnvioAlertaController/getPlantillaCartaMorosidad",{params:{params:s}});case 7:return u=o.v,n.correctamente.push(u),o.a(3,3);case 8:o.n=10;break;case 9:o.p=9,A=o.v,n.errores.push(A);case 10:return o.p=10,e.loading.procesados++,o.f(10);case 11:o.n=3;break;case 12:return e.$q.loading.hide(),o.n=13,ne.$http.post("api/EnvioAlertaController/postGenerarCartaMorosidad",{params:{MSGCOD:e.selectTipoReporte}});case 13:if(d=o.v,p="",m="",n.errores.length>0&&(p+="Procesos con Errores:(".concat(n.errores.length,") "),m="warning"),n.correctamente.length>0&&(p+="Procesado finalizado:(".concat(n.correctamente.length,") Cartas Generadas Satisfactoriamente "),m="success"),e.enviarCorreo){o.n=14;break}return f='{"name":"'.concat(d.archivo,'","ruta":"').concat(d.ruta,'","tipo":"pdf"}'),o.n=14,de["default"].DESCARGAR_ARCHIVO(f);case 14:1===n.errores.length&&0===n.correctamente.length&&(g=j()(n.errores,1),h=g[0],p=h.message),e.getHistorialCorreos(),e.loading.showLoading=!1,e.$alert(p,m),o.n=16;break;case 15:o.p=15,b=o.v,e.loading.showLoading=!1,e.$alert(b.error?b.error.message:b.message,"warning");case 16:return o.a(2)}},o,null,[[4,9,10,11],[0,15]])})))},generar:function(){var e=this;return z()(X()().m(function a(){var o,r,t,n;return X()().w(function(a){while(1)switch(a.n){case 0:return o=e.rowData,a.n=1,ne.$http.get("api/EnvioAlertaController/getMensajeAlerta",{params:{params:{MSGCOD:e.selectTipoReporte}}});case 1:if(r=a.v,0!==r.length){a.n=2;break}return a.a(2,e.$alert("No se a configurado el nombre ni el contenido del PDF","warning"));case 2:if(t=j()(r,1),n=t[0],n&&n.ASUNTO&&0!==n.ASUNTO.length){a.n=3;break}return a.a(2,e.$alert("No se a configurado el nombre del PDF de la carta de morosidad","warning"));case 3:if(0!==o.length){a.n=4;break}return a.a(2,e.$alert("No existe ningún registro para exportar","warning"));case 4:e.$confirm("¿Esta seguro de generar la carta de morosidad a los (".concat(o.length,") registros?")).onOk(z()(X()().m(function a(){var r,t,n,i,l,s,c,u,d,p,m,f,g,h,v;return X()().w(function(a){while(1)switch(a.p=a.n){case 0:if(a.p=0,e.loading.showLoading=!0,e.loading.total=o.length,e.loading.procesados=0,r={correctamente:[],errores:[]},!e.enviarCorreo){a.n=2;break}return n={MSGCOD:e.selectTipoReporte},a.n=1,ne.$http.post("api/EnvioAlertaController/postRegistrarMailCampaign",{params:n});case 1:t=a.v;case 2:g=q()(o);case 3:if((h=g()).done){a.n=9;break}return i=h.value,a.p=4,o[i].CONCEPTO=e.conceptosSelect.map(function(e){return e.value}),l={MSGCOD:e.selectTipoReporte,formato:de["default"].FORMATO_CARTA_MOROSIDAD[e.selectTipoReporte],index:i,ANOCOB:e.selectAnio,enviarCorreo:e.enviarCorreo,id_persona:o[i].ID_PERSONA},e.enviarCorreo&&(l.ID_MAIL_CAMPAIGN=t.ID_MAIL_CAMPAIGN),a.n=5,ne.$http.get("api/EnvioAlertaController/getPlantillaCartaMorosidad",{params:{params:Q()(Q()({},l),o[i])}});case 5:s=a.v,r.correctamente.push(s),a.n=7;break;case 6:a.p=6,v=a.v,r.errores.push(v);case 7:return a.p=7,e.loading.procesados++,a.f(7);case 8:a.n=3;break;case 9:return a.n=10,ne.$http.post("api/EnvioAlertaController/postGenerarCartaMorosidad",{params:{MSGCOD:e.selectTipoReporte}});case 10:if(c=a.v,u="",d="",r.errores.length>0&&(u+="Procesos con Errores:(".concat(r.errores.length,") "),d="warning"),r.correctamente.length>0&&(u+="Procesado finalizado:(".concat(r.correctamente.length,") Cartas Generadas Satisfactoriamente "),d="success"),e.enviarCorreo){a.n=11;break}return p='{"name":"'.concat(c.archivo,'","ruta":"').concat(c.ruta,'","tipo":"pdf"}'),a.n=11,de["default"].DESCARGAR_ARCHIVO(p);case 11:1===r.errores.length&&0===r.correctamente.length&&(m=j()(r.errores,1),f=m[0],u=f.message),e.loading.showLoading=!1,e.$alert(u,d),e.getHistorialCorreos(),e.$q.loading.hide(),a.n=13;break;case 12:a.p=12,a.v,e.$q.loading.hide(),e.$alert("Error al generar el pdf","warning");case 13:return a.a(2)}},a,null,[[4,6,7,8],[0,12]])})));case 5:return a.a(2)}},a)}))()},submit:function(){return this.cartaMorosidadFamiliar?this.generarCartaMorosidadFamiliar():this.selectTipoReporte===de["default"].TIPO_ALERTA.MOROSIDAD_A5?this.generarPdfSimple():this.selectTipoReporte===de["default"].TIPO_ALERTA.MOROSIDAD?this.generar():void 0},convertDay:function(e){return e.split("/")[2]+"-"+e.split("/")[1]+"-"+e.split("/")[0]},peticionDeudas:function(e){var a=arguments,o=this;return z()(X()().m(function r(){var t,n;return X()().w(function(r){while(1)switch(r.n){case 0:return a.length>1&&void 0!==a[1]?a[1]:[],e.DEUDAS_PENDIENTES=!0,t=o.cartaMorosidadFamiliar?"getDeudoresFamilia":"getDeudores",r.n=1,ne.$http.get("api/EnvioAlertaController/".concat(t),{params:{params:e}});case 1:return n=r.v,r.a(2,n)}},r)}))()},getDeudoresFamilia:function(){var e=this;return z()(X()().m(function a(){var o,r;return X()().w(function(a){while(1)switch(a.n){case 0:return o={anio:e.selectAnio,fecven:e.convertDay(e.selectDia),orden:e.selectOrden},e.selectConcepto&&e.selectConcepto!==de["default"].TODOS&&(o.concob=e.selectConcepto),e.ckbNumMes&&(o.nroDeudas=e.nroDeudas),e.selectFamilia&&e.selectFamilia!==de["default"].TODOS&&(o.famcod=e.selectFamilia),a.n=1,e.peticionDeudas(o);case 1:r=a.v,e.rowData=r;case 2:return a.a(2)}},a)}))()},getDeudores:function(e){var a=this;return z()(X()().m(function o(){var r,t,n,i,l;return X()().w(function(o){while(1)switch(o.p=o.n){case 0:if(o.p=0,!a.cartaMorosidadFamiliar){o.n=1;break}return o.a(2,a.getDeudoresFamilia());case 1:if(r={ANOCOB:a.selectAnio,ID_PERFIL:a.selectPerfil,FECVEN:a.convertDay(a.selectDia),CONCOB:[],orden:a.selectOrden,msgCod:a.selectTipoReporte},0!==a.conceptosSelect.length){o.n=2;break}return a.rowData=[],o.a(2,!1);case 2:t=y()(a.conceptosSelect);try{for(t.s();!(n=t.n()).done;)i=n.value,r.CONCOB.push(i.value)}catch(e){t.e(e)}finally{t.f()}return!0===a.ckbNumMes&&a.nroDeudas>0&&(r.CANTIDAD=a.nroDeudas),a.selectPersona&&a.selectPersona!==de["default"].TODOS&&(r.ID_PERSONA=a.selectPersona),a.selectNivel&&(r.INSTRUCOD=a.selectNivel),a.selectGrado&&(r.GRADOCOD=a.selectGrado),a.selectSeccion&&(r.SECCIONCOD=a.selectSeccion),e=e||[],o.n=3,a.peticionDeudas(r,e);case 3:a.rowData=o.v,o.n=5;break;case 4:o.p=4,l=o.v,a.$alert(l.error.message);case 5:return o.a(2)}},o,null,[[0,4]])}))()},getNiveles:function(){var e=this;return z()(X()().m(function a(){return X()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,de["default"].API_NIVELES();case 1:e.niveles=a.v,e.getDeudores();case 2:return a.a(2)}},a)}))()},getGrados:function(){var e=this;return z()(X()().m(function a(){return X()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,de["default"].API_GRADOS(e.selectNivel);case 1:e.grados=a.v,e.getDeudores();case 2:return a.a(2)}},a)}))()},getSecciones:function(){var e=this;return z()(X()().m(function a(){return X()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,de["default"].API_SECCIONES(e.selectGrado,e.selectNivel);case 1:e.secciones=a.v,e.getDeudores();case 2:return a.a(2)}},a)}))()},columns:function(){var e=this;return z()(X()().m(function a(){var o;return X()().w(function(a){while(1)switch(a.n){case 0:o=[{headerName:"Código",field:"CODIGO",width:100},{headerName:"Apellidos y Nombres",field:"NOMBRE",width:350},{headerName:"NGS",field:"NGS",width:80},{headerName:"Nro. Deudas",field:"CANTIDAD",width:98}],e.cartaMorosidadFamiliar&&(o=[{headerName:"Código",field:"FAMCOD",width:100},{headerName:"Familia",field:"FAMILIA",width:250},{headerName:"Nro. Deudas",field:"NRODEUDAS",width:98},{headerName:"Nro. Hijos",field:"NROHIJOS",width:98}]),e.columnDefs=o;case 1:return a.a(2)}},a)}))()},closeModalCalendar:function(e){this.$refs[e].hide(),this.getDeudores()},getFamilas:function(){var e=this;return z()(X()().m(function a(){return X()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,de["default"].API_FAMILIAS();case 1:e.familias=a.v;case 2:return a.a(2)}},a)}))()}},beforeCreate:function(){var e=this;return z()(X()().m(function a(){var o,r;return X()().w(function(a){while(1)switch(a.n){case 0:return o={ID_CONSTANTE:[de["default"].CONSTANTES_SISTEMA.P_TIPO_CARTA_MOROSIDAD]},a.n=1,de["default"].API_CONSTANTES_SISTEMAS(o);case 1:r=a.v,e.P_TIPO_CARTA_MOROSIDAD=r.P_TIPO_CARTA_MOROSIDAD,e.cartaMorosidadFamiliar=e.P_TIPO_CARTA_MOROSIDAD===de["default"].TIPO_CARTA_MOROSIDAD.FAMILIAR,e.columns(),e.getOrden(),e.cartaMorosidadFamiliar&&e.getFamilas();case 2:return a.a(2)}},a)}))()},beforeMount:function(){var e=this;return z()(X()().m(function a(){return X()().w(function(a){while(1)switch(a.n){case 0:e.getConceptos(),e.getPerfiles(),e.getAnios(),e.getNiveles(),e.getGrados(),e.getSecciones(),e.getPerPerfil(),e.getDeudores(),e.createTitle(),e.crearBotones(),e.getMeses(),e.getHistorialCorreos(),e.pageHeader.botones=e.crearBotones(),e.pageHeader.title=e.createTitle(),e.columnsHistorial();case 1:return a.a(2)}},a)}))()}},Ie=o(12807);const Me=(0,Ie.A)(Re,[["render",x]]);var Ne=Me}}]);