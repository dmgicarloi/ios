"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[36198],{36198:function(e,n,o){o.r(n),o.d(n,{default:function(){return Ze}});var a=o(8445),t=o.n(a),i=(o(515),o(61758)),r=o(58790),l=o(29104),s={key:0,class:"btn-flotante bg-positive text-white column items-center justify-center cursor-pointer"},c={class:"row"},u={class:"col-12"},d={class:"row"},m={class:"col"},f={class:"row q-pa-sm q-col-gutter-sm"},p={key:0,class:"col-xs-12"},b={class:"row full-height q-pt-sm"},g={class:"col column items-center justify-start"},h={class:"col-xs-12 col-md-2"},v={class:"col-xs-12 col-md-8"},O={class:"col-xs-12 col-md-2"},S={class:"col-xs-12 col-sm-6 col-md-4"},E={class:"col-xs-12 col-sm-6 col-md-4"},I={class:"col-xs-12 col-sm-6 col-md-4"},A={class:"col-xs-12 col-sm-6 col-md-4"},w={class:"col-xs-12 col-sm-12 col-md-8"},k={key:0},T={class:"row full-height q-pt-sm"},L={class:"col column items-center justify-start"},D={class:"col-12"},C={class:"row q-col-gutter-sm"},F={class:"col-12"},P={class:"col-12"},M={class:"col-12"},N={class:"col-12"},x={class:"row q-col-gutter-sm"},V={class:"col-xs-12 col-sm-6 col-md-4"},y={class:"col-xs-12 col-sm-6 col-md-4"},R={class:"col-xs-12 col-sm-12 col-md-4"},j={class:"col-xs-12 col-sm-6 col-md-4"},U={class:"col-xs-12 col-sm-6 col-md-4"},_={class:"col-xs-12 col-sm-6 col-md-4"},B={class:"row q-gutter-xs"},Y={class:"col"},$={class:"col-12 q-mt-sm"},q={class:"col-12"},X={class:"row q-col-gutter-md"},G={class:"col-xs-12 col-sm-6 col-md-4 col-xl-3 column justify-center"},Q={class:"col-xs-12 col-sm-6 col-md-4 col-xl-3 column justify-center"},W={class:"col-xs-12 col-sm-6 col-md-4 col-xl-3"},z={class:"col-12"},J={class:"col-12"},H={class:"col-12"},K={class:"row q-pa-sm q-col-gutter-sm"},Z={class:"col-xs-12"},ee={class:"col-xs-12"},ne={class:"row q-pa-sm q-col-gutter-sm"},oe={class:"col-xs-12"},ae={class:"col-xs-12"},te={class:"row q-pa-sm q-col-gutter-sm"},ie={class:"col-12 sie-flat"},re={class:"row q-pa-sm q-col-gutter-sm"},le={class:"col-12 sie-flat"};function se(e,n){var o=this,a=(0,i.g2)("q-item-section"),se=(0,i.g2)("q-item"),ce=(0,i.g2)("q-list"),ue=(0,i.g2)("q-popup-proxy"),de=(0,i.g2)("q-icon"),me=(0,i.g2)("header-btn"),fe=(0,i.g2)("q-tab"),pe=(0,i.g2)("q-tabs"),be=(0,i.g2)("q-separator"),ge=(0,i.g2)("q-img"),he=(0,i.g2)("autocomplete"),ve=(0,i.g2)("q-input"),Oe=(0,i.g2)("q-date"),Se=(0,i.g2)("sie-table"),Ee=(0,i.g2)("q-tab-panel"),Ie=(0,i.g2)("sie-salones"),Ae=(0,i.g2)("q-tooltip"),we=(0,i.g2)("q-btn"),ke=(0,i.g2)("q-select"),Te=(0,i.g2)("q-tab-panels"),Le=(0,i.g2)("q-card-section"),De=(0,i.g2)("q-card"),Ce=(0,i.g2)("sie-modal"),Fe=(0,i.g2)("catalogo-biblioteca"),Pe=(0,i.g2)("cronograma"),Me=(0,i.g2)("box-imagen"),Ne=(0,i.g2)("q-page"),xe=(0,i.gN)("close-overlay");return(0,i.uX)(),(0,i.Wv)(Ne,{class:"sie-flat biblioteca-prestamosyreservas q-pa-sm"},{default:(0,i.k6)(function(){return["persona"===e.tab?((0,i.uX)(),(0,i.CE)(i.FK,{key:0},[Object.keys(e.dataSolicitantes).length>0?((0,i.uX)(),(0,i.CE)("div",s,[(0,i.bF)(de,{name:"person_book",size:"20px"},{default:(0,i.k6)(function(){return[(0,i.bF)(ue,{modelValue:e.openProxy,"onUpdate:modelValue":n[0]||(n[0]=function(n){return e.openProxy=n})},{default:(0,i.k6)(function(){return[(0,i.bF)(ce,{class:"rounded-borders",dense:"",bordered:"",padding:""},{default:(0,i.k6)(function(){return[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.dataSolicitantes,function(n){return(0,i.uX)(),(0,i.Wv)(se,{clickable:"",onClick:function(o){e.selected(n.info),e.openProxy=!1}},{default:(0,i.k6)(function(){return[(0,i.bF)(a,null,{default:(0,i.k6)(function(){return[(0,i.eW)((0,r.v_)(e.getDataSolicitante(n).NOMCOMP),1)]}),_:2},1024)]}),_:2},1032,["onClick"])}),256))]}),_:1})]}),_:1},8,["modelValue"])]}),_:1})])):(0,i.Q3)("v-if",!0)],64)):(0,i.Q3)("v-if",!0),(0,i.bF)(De,{flat:"",bordered:""},{default:(0,i.k6)(function(){return["persona"===e.tab?((0,i.uX)(),(0,i.Wv)(me,{key:0,name:"Préstamos y Reserva",buttons:e.buttons},null,8,["buttons"])):((0,i.uX)(),(0,i.Wv)(me,{key:1,name:"Préstamos y Reserva",auto:!1,buttons:e.buttonsSeccion},null,8,["buttons"])),(0,i.bF)(Le,null,{default:(0,i.k6)(function(){return[(0,i.bF)(pe,{modelValue:e.tab,"onUpdate:modelValue":n[1]||(n[1]=function(n){return e.tab=n}),dense:"",align:"left"},{default:(0,i.k6)(function(){return[(0,i.bF)(fe,{default:"",name:"persona",label:"Persona"}),(0,i.bF)(fe,{name:"seccion",label:"Seccion"})]}),_:1},8,["modelValue"]),(0,i.bF)(be),(0,i.bF)(Te,{modelValue:e.tab,"onUpdate:modelValue":n[33]||(n[33]=function(n){return e.tab=n}),animated:"","keep-alive":""},{default:(0,i.k6)(function(){return[(0,i.bF)(Ee,{name:"persona"},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",c,[(0,i.Lk)("div",u,[(0,i.Lk)("div",d,[(0,i.Lk)("div",m,[(0,i.Lk)("div",f,[e.getWidth<=699?((0,i.uX)(),(0,i.CE)("div",p,[(0,i.Lk)("div",b,[(0,i.Lk)("div",g,[(0,i.bF)(ge,{class:"foto-alumno",src:e.rutaFoto,width:"100px",height:"100px"},{error:(0,i.k6)(function(){return[(0,i.bF)(ge,{class:"foto-alumno",src:e.rutaFotoDefault(),width:"100px",height:"100px"},null,8,["src"])]}),_:1},8,["src"])])])])):(0,i.Q3)("v-if",!0),(0,i.Lk)("div",h,[(0,i.bF)(he,{class:"q-ma-none",ref:"refSolicita",modelValue:e.solcod,"onUpdate:modelValue":n[2]||(n[2]=function(n){return e.solcod=n}),label:"Código/Nombre",data:e.solicitantes,keys:e.keysComplete,onSelected:e.selected},null,8,["modelValue","data","keys","onSelected"])]),(0,i.Lk)("div",v,[(0,i.bF)(ve,{readonly:"",modelValue:e.solicitante,"onUpdate:modelValue":n[3]||(n[3]=function(n){return e.solicitante=n}),label:"Solicitante"},null,8,["modelValue"])]),(0,i.Lk)("div",O,[(0,i.bF)(ve,{modelValue:e.descriptor,"onUpdate:modelValue":n[4]||(n[4]=function(n){return e.descriptor=n}),readonly:"",label:e.descriptorLabel},null,8,["modelValue","label"])]),(0,i.Lk)("div",S,[(0,i.bF)(ve,{label:"F. Reserva",debounce:"500",maxlength:"10",format:"##/##/####",modelValue:e.freserva,"onUpdate:modelValue":n[7]||(n[7]=function(n){return e.freserva=n}),mask:"##/##/####",readonly:""},{append:(0,i.k6)(function(){return[(0,i.bF)(de,{class:"cursor-pointer",name:"date_range"},{default:(0,i.k6)(function(){return[(0,i.bF)(ue,{ref:"qDateProxy1","transition-show":"scale","transition-hide":"scale"},{default:(0,i.k6)(function(){return[(0,i.bF)(Oe,{mask:"DD/MM/YYYY",modelValue:e.freserva,"onUpdate:modelValue":n[5]||(n[5]=function(n){return e.freserva=n}),onInput:n[6]||(n[6]=function(n){return e.$refs.qDateProxy1.hide()}),options:e.optionsPI},null,8,["modelValue","options"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])]),(0,i.Lk)("div",E,[(0,i.bF)(ve,{label:"F. Ini. Préstamo",debounce:"500",maxlength:"10",format:"##/##/####",modelValue:e.fprestamo,"onUpdate:modelValue":n[10]||(n[10]=function(n){return e.fprestamo=n}),mask:"##/##/####",readonly:""},{append:(0,i.k6)(function(){return[(0,i.bF)(de,{class:"cursor-pointer",name:"date_range"},{default:(0,i.k6)(function(){return[(0,i.bF)(ue,{ref:"qDateProxy2","transition-show":"scale","transition-hide":"scale"},{default:(0,i.k6)(function(){return[(0,i.bF)(Oe,{mask:"DD/MM/YYYY",modelValue:e.fprestamo,"onUpdate:modelValue":n[8]||(n[8]=function(n){return e.fprestamo=n}),onInput:n[9]||(n[9]=function(n){return e.seleccionaDia("qDateProxy2")}),options:e.optionsPI},null,8,["modelValue","options"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])]),(0,i.Lk)("div",I,[(0,i.bF)(ve,{label:"F. Fin Préstamo",debounce:"500",maxlength:"10",format:"##/##/####",modelValue:e.fretorno,"onUpdate:modelValue":n[13]||(n[13]=function(n){return e.fretorno=n}),mask:"##/##/####",readonly:""},{append:(0,i.k6)(function(){return[(0,i.bF)(de,{class:"cursor-pointer",name:"date_range"},{default:(0,i.k6)(function(){return[(0,i.bF)(ue,{ref:"qDateProxy3","transition-show":"scale","transition-hide":"scale"},{default:(0,i.k6)(function(){return[(0,i.bF)(Oe,{mask:"DD/MM/YYYY",modelValue:e.fretorno,"onUpdate:modelValue":n[11]||(n[11]=function(n){return e.fretorno=n}),onInput:n[12]||(n[12]=function(n){return e.$refs.qDateProxy3.hide()}),options:e.optionsPFA},null,8,["modelValue","options"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])]),(0,i.Lk)("div",A,[(0,i.bF)(ve,{ref:"refNumingreso",modelValue:e.nroIngreso,"onUpdate:modelValue":n[14]||(n[14]=function(n){return e.nroIngreso=n}),label:"Nro Ingreso",onKeyup:n[15]||(n[15]=(0,l.jR)(function(n){return e.tituloSelected({NUMINGRESO:e.nroIngreso},!0)},["enter"]))},null,8,["modelValue"])]),(0,i.Lk)("div",w,[(0,i.bF)(he,{class:"q-ma-none",modelValue:e.titulo,"onUpdate:modelValue":n[16]||(n[16]=function(n){return e.titulo=n}),label:"Título",data:e.titulos,keys:e.keysTitulos,onSelected:e.tituloSelected},null,8,["modelValue","data","keys","onSelected"])])])]),e.getWidth>=700?((0,i.uX)(),(0,i.CE)("div",k,[(0,i.Lk)("div",T,[(0,i.Lk)("div",L,[(0,i.bF)(ge,{class:"foto-alumno",src:e.rutaFoto,width:"76px",height:"76px",onClick:e.openBoxImagen},{error:(0,i.k6)(function(){return[(0,i.bF)(ge,{class:"foto-alumno",src:e.rutaFotoDefault(),width:"76px",height:"76px"},null,8,["src"])]}),_:1},8,["src","onClick"])])])])):(0,i.Q3)("v-if",!0)])]),(0,i.Lk)("div",D,[(0,i.Lk)("div",C,[(0,i.Lk)("div",F,[(0,i.bF)(me,{auto:!1,"padding-x":"",border:!1,"no-label":"",name:"TÍTULOS AGREGADOS","font-size":"14px",buttons:e.buttonsFichaAgregada},null,8,["buttons"])]),(0,i.Lk)("div",P,[(0,i.bF)(Se,{ref:"tableEjemplares",columns:e.fields,data:e.rows,"show-search":!1,selection:"single",context:o,config:e.config,css:{height:"280px"}},null,8,["columns","data","config"])]),(0,i.Lk)("div",M,[(0,i.bF)(me,{auto:!1,"padding-x":"",border:!1,"no-label":"",name:"OPERACIONES VIGENTES","font-size":"14px"})]),(0,i.Lk)("div",N,[(0,i.bF)(Se,{ref:"tableOperaciones",columns:e.fieldsOperaciones,data:e.rowsOperaciones,"show-search":!1,selection:"single",context:o,config:e.configOperaciones,css:{height:"200px"}},null,8,["columns","data","config"])])])])])]}),_:1}),(0,i.bF)(Ee,{name:"seccion"},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",x,[(0,i.Lk)("div",V,[(0,i.bF)(Ie,{class:"sie-select-border q-ma-none no-border",ref:"refSalon",modelValue:e.nemo,"onUpdate:modelValue":n[17]||(n[17]=function(n){return e.nemo=n}),todos:!0,label:"Salon",nemocompuesto:!0,onSeleccionar:e.seleccionarSalon,campos:["NEMO","NEMODES","INSTRUCOD","GRADOCOD","SECCIONCOD"]},null,8,["modelValue","onSeleccionar"])]),(0,i.Lk)("div",y,[(0,i.bF)(ve,{modelValue:e.nroIngreso,"onUpdate:modelValue":n[18]||(n[18]=function(n){return e.nroIngreso=n}),label:"Nro Ingreso",onKeyup:n[19]||(n[19]=(0,l.jR)(function(n){return e.tituloSelectedSeccion({NUMINGRESO:e.nroIngreso},!0)},["enter"]))},null,8,["modelValue"])]),(0,i.Lk)("div",R,[(0,i.bF)(he,{class:"q-ma-nome",modelValue:e.tituloSeccion,"onUpdate:modelValue":n[20]||(n[20]=function(n){return e.tituloSeccion=n}),label:"Título",data:e.titulos,keys:e.keysTitulos,onSelected:e.tituloSelectedSeccion},null,8,["modelValue","data","keys","onSelected"])]),(0,i.Lk)("div",j,[(0,i.bF)(ve,{label:"F. Reserva",debounce:"500",maxlength:"10",format:"##/##/####",modelValue:e.freservaseccion,"onUpdate:modelValue":n[23]||(n[23]=function(n){return e.freservaseccion=n}),mask:"##/##/####",readonly:""},{append:(0,i.k6)(function(){return[(0,i.bF)(de,{class:"cursor-pointer",name:"date_range"},{default:(0,i.k6)(function(){return[(0,i.bF)(ue,{ref:"qDateProxy1","transition-show":"scale","transition-hide":"scale"},{default:(0,i.k6)(function(){return[(0,i.bF)(Oe,{mask:"DD/MM/YYYY",modelValue:e.freservaseccion,"onUpdate:modelValue":n[21]||(n[21]=function(n){return e.freservaseccion=n}),onInput:n[22]||(n[22]=function(n){return e.$refs.qDateProxy1.hide()}),options:e.optionsPI},null,8,["modelValue","options"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])]),(0,i.Lk)("div",U,[(0,i.bF)(ve,{label:"F. Ini. Préstamo",debounce:"500",maxlength:"10",format:"##/##/####",modelValue:e.fprestamoseccion,"onUpdate:modelValue":n[26]||(n[26]=function(n){return e.fprestamoseccion=n}),mask:"##/##/####",readonly:""},{append:(0,i.k6)(function(){return[(0,i.bF)(de,{class:"cursor-pointer",name:"date_range"},{default:(0,i.k6)(function(){return[(0,i.bF)(ue,{ref:"qDateProxy2","transition-show":"scale","transition-hide":"scale"},{default:(0,i.k6)(function(){return[(0,i.bF)(Oe,{mask:"DD/MM/YYYY",modelValue:e.fprestamoseccion,"onUpdate:modelValue":n[24]||(n[24]=function(n){return e.fprestamoseccion=n}),onInput:n[25]||(n[25]=function(n){return e.$refs.qDateProxy2.hide()}),options:e.optionsPI},null,8,["modelValue","options"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])]),(0,i.Lk)("div",_,[(0,i.Lk)("div",B,[(0,i.Lk)("div",Y,[(0,i.bF)(ve,{label:"F. Fin Préstamo",debounce:"500",maxlength:"10",format:"##/##/####",modelValue:e.fretornoseccion,"onUpdate:modelValue":n[29]||(n[29]=function(n){return e.fretornoseccion=n}),mask:"##/##/####",readonly:""},{append:(0,i.k6)(function(){return[(0,i.bF)(de,{class:"cursor-pointer",name:"date_range"},{default:(0,i.k6)(function(){return[(0,i.bF)(ue,{ref:"qDateProxy3","transition-show":"scale","transition-hide":"scale"},{default:(0,i.k6)(function(){return[(0,i.bF)(Oe,{mask:"DD/MM/YYYY",modelValue:e.fretornoseccion,"onUpdate:modelValue":n[27]||(n[27]=function(n){return e.fretornoseccion=n}),onInput:n[28]||(n[28]=function(n){return e.$refs.qDateProxy3.hide()}),options:e.optionsPFS},null,8,["modelValue","options"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])]),(0,i.bF)(we,{icon:"calendar",color:"primary",dense:"",onClick:n[30]||(n[30]=function(n){return e.openCronograma()})},{default:(0,i.k6)(function(){return[(0,i.bF)(Ae,null,{default:(0,i.k6)(function(){return t()(n[44]||(n[44]=[(0,i.eW)("Cronograma Plan Lector",-1)]))}),_:1})]}),_:1}),(0,i.bF)(we,{icon:"broom",color:"primary",dense:"",onClick:n[31]||(n[31]=function(n){return e.limpiar()})},{default:(0,i.k6)(function(){return[(0,i.bF)(Ae,null,{default:(0,i.k6)(function(){return t()(n[45]||(n[45]=[(0,i.eW)("Limpiar",-1)]))}),_:1})]}),_:1})])]),(0,i.Lk)("div",$,[(0,i.bF)(me,{auto:!1,"padding-x":"","no-label":"",name:"ALUMNOS","font-size":"14px"})]),(0,i.Lk)("div",q,[(0,i.Lk)("div",X,[(0,i.Lk)("div",G,[(0,i.Lk)("span",null,[n[46]||(n[46]=(0,i.Lk)("b",null,"Cant. Alumnos:",-1)),(0,i.Lk)("span",null,(0,r.v_)(e.rowsAlumnos.length||0),1)])]),(0,i.Lk)("div",Q,[(0,i.Lk)("span",null,[n[47]||(n[47]=(0,i.Lk)("b",null,"Cant. Ejemplares:",-1)),(0,i.Lk)("span",null,(0,r.v_)(e.ejemplaresSeccion.length||0),1)])]),(0,i.Lk)("div",W,[(0,i.bF)(ke,{modelValue:e.asignacion,"onUpdate:modelValue":n[32]||(n[32]=function(n){return e.asignacion=n}),"emit-value":"",options:e.asignaciones,label:"Asignación",onInput:e.cambiarAsignacion},null,8,["modelValue","options","onInput"])])])]),(0,i.Lk)("div",z,[(0,i.bF)(Se,{ref:"tableAlumnos",columns:e.fieldsAlumnos,data:e.rowsAlumnos,"show-search":!1,selection:"single",context:o,config:e.configAlumnos,css:{height:"340px"}},null,8,["columns","data","config"])]),(0,i.Lk)("div",J,[(0,i.bF)(me,{"padding-x":"",border:!1,"no-label":"",name:"OPERACIONES VIGENTES","font-size":"14px",buttons:[]})]),(0,i.Lk)("div",H,[(0,i.bF)(Se,{id:"operaciones-vigentes",ref:"tableOperacionesVigentes",columns:e.fieldsOperacionesVigentes,data:e.rowsOperacionesVigentes,"show-search":!1,selection:"single",context:o,config:e.configOperacionesVigentes,css:{height:"146px"}},null,8,["columns","data","config"])])])]}),_:1})]}),_:1},8,["modelValue"])]}),_:1})]}),_:1}),(0,i.bF)(Ce,{"esc-click":"",esc:"",modelValue:e.openModalObservacion,"onUpdate:modelValue":n[36]||(n[36]=function(n){return e.openModalObservacion=n}),title:"Agregar Observación",onSubmit:e.saveObservacion},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",K,[(0,i.Lk)("div",Z,[(0,i.bF)(ve,{modelValue:e.observacionLibro,"onUpdate:modelValue":n[34]||(n[34]=function(n){return e.observacionLibro=n}),label:"Observación del Libro",type:"textarea"},null,8,["modelValue"])]),(0,i.Lk)("div",ee,[(0,i.bF)(ve,{modelValue:e.condicionFisica,"onUpdate:modelValue":n[35]||(n[35]=function(n){return e.condicionFisica=n}),label:"Condición Física"},null,8,["modelValue"])])])]}),_:1},8,["modelValue","onSubmit"]),(0,i.bF)(Ce,{"esc-click":"",esc:"",modelValue:e.openModalObservacionSeccion,"onUpdate:modelValue":n[39]||(n[39]=function(n){return e.openModalObservacionSeccion=n}),title:"Agregar Observación",onSubmit:e.saveObservacionSeccion},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",ne,[(0,i.Lk)("div",oe,[(0,i.bF)(ve,{modelValue:e.observacionLibro,"onUpdate:modelValue":n[37]||(n[37]=function(n){return e.observacionLibro=n}),label:"Observación del Libro",type:"textarea"},null,8,["modelValue"])]),(0,i.Lk)("div",ae,[(0,i.bF)(ve,{modelValue:e.condicionFisica,"onUpdate:modelValue":n[38]||(n[38]=function(n){return e.condicionFisica=n}),label:"Condición Física"},null,8,["modelValue"])])])]}),_:1},8,["modelValue","onSubmit"]),(0,i.bF)(Ce,{"esc-click":"",esc:"",modelValue:e.openModalEjemplares,"onUpdate:modelValue":n[40]||(n[40]=function(n){return e.openModalEjemplares=n}),title:"Existencias",ok:"Agregar",onSubmit:e.agregarEjemplares},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",te,[(0,i.Lk)("div",ie,[(0,i.bF)(Se,{ref:"tableAddEjemplares",columns:e.fieldsEjemplares,data:e.rowsEjemplares,"show-search":!1,selection:e.selectionEjemplares,context:o,config:e.configEjemplares,css:{height:"350px"},"load-selection":e.selectedEjemplares},null,8,["columns","data","selection","config","load-selection"])])])]}),_:1},8,["modelValue","onSubmit"]),(0,i.bF)(Ce,{"esc-click":"",esc:"",modelValue:e.openModalAsignarEjemplar,"onUpdate:modelValue":n[41]||(n[41]=function(n){return e.openModalAsignarEjemplar=n}),title:"Asignar Ejemplar",ok:"Asignar Existencia",onSubmit:e.asignarEjemplar},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",re,[(0,i.Lk)("div",le,[(0,i.bF)(Se,{ref:"tableasignarEjemplares",columns:e.fieldsAsignarEjemplares,data:e.rowsAsignarEjemplares,"show-search":!1,selection:"single",onRowSelectedDbl:e.asignarEjemplar,context:o,config:e.configAsignarEjemplares,css:{height:"350px"}},null,8,["columns","data","onRowSelectedDbl","config"])])])]}),_:1},8,["modelValue","onSubmit"]),(0,i.bF)(Ce,{"esc-click":"",esc:"",modelValue:e.openModalCatalogo,"onUpdate:modelValue":n[42]||(n[42]=function(n){return e.openModalCatalogo=n}),title:"Catálogo",maximized:"",footer:!1,ok:!1,noClose:e.isLess},(0,i.eX)({footerMobile:(0,i.k6)(function(){return[(0,i.bo)((0,i.bF)(we,{flat:"",round:"",dense:"",icon:"close"},null,512),[[xe]])]}),default:(0,i.k6)(function(){return[(0,i.bF)(Fe,{ref:"refCatalogo",id_persona:e.id_persona,disponibles:e.disponibles,info:e.itemSolicitante,onTituloSelected:e.tituloSelected,onMostrarAtras:e.mostrarAtras},null,8,["id_persona","disponibles","info","onTituloSelected","onMostrarAtras"])]}),_:2},[e.btnAtras?{name:"preButtons",fn:(0,i.k6)(function(){return[(0,i.bF)(we,{flat:"",round:"",dense:"",icon:"arrow_back",onClick:e.atras},null,8,["onClick"])]}),key:"0"}:void 0]),1032,["modelValue","noClose"]),(0,i.bF)(Pe,{ref:"refModalCronograma"},null,512),e.openModalImagen?((0,i.uX)(),(0,i.Wv)(Me,{key:1,modelValue:e.openModalImagen,"onUpdate:modelValue":n[43]||(n[43]=function(n){return e.openModalImagen=n}),urlImage:e.urlImagenBox,urlImageDefault:e.rutaFotoDefault(),titulo:e.solicitante},null,8,["modelValue","urlImage","urlImageDefault","titulo"])):(0,i.Q3)("v-if",!0)]}),_:1})}var ce=o(99550),ue=o.n(ce),de=o(76080),me=o.n(de),fe=o(45254),pe=o.n(fe),be=(o(30683),o(71225),o(74260),o(23825),o(77507),o(52133),o(10239),o(50310),o(5962),o(32203),o(6724),o(70199),o(83190),o(68017),o(7346),o(24066),o(6123)),ge=o(21103),he=o(71271),ve=o(9736),Oe=o(16648),Se=o(2739),Ee=(o(89571),{data:function(){return{config:{ACTION:{component:"button",icon:["edit as editar","write as observacion","delete as eliminar"],observacion:function(e,n){var o=this;return pe()(me()().m(function a(){return me()().w(function(a){while(1)switch(a.n){case 0:o.itemEjemplar=n,o.observacionLibro=e.NOTABIB,o.condicionFisica=e.ESTFISICO,o.openModalObservacion=!0;case 1:return a.a(2)}},a)}))()},eliminar:function(e,n){var o=this;return pe()(me()().m(function e(){var a;return me()().w(function(e){while(1)switch(e.n){case 0:return e.n=1,o.$confirmar("¿Está seguro de eliminar?","delete");case 1:a=e.v,a&&(o.rows.splice(o.rows.indexOf(n),1),o.setDataEjemplares());case 2:return e.a(2)}},e)}))()},editar:function(e){var n=this;return pe()(me()().m(function o(){return me()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,n.tituloSelected(e);case 1:!1===n.openModalEjemplares&&n.$alert("El título seleccionado solo cuenta con un ejemplar","info");case 2:return o.a(2)}},o)}))()},tooltip:{editar:"Editar",observacion:"Observación",eliminar:"Eliminar"},flat:!0,dense:!0}},rows:[],fields:[{name:"NUMINGRESO",label:"# Ingreso",field:"NUMINGRESO",align:"left",sortable:!0},{name:"PARTE",label:"Cod. Clasif",field:"PARTE",align:"left",sortable:!0},{name:"TITULO",label:"Título",field:"TITULO",align:"left",sortable:!0},{name:"SOLOBIB",label:"SB",field:"SOLOBIB",align:"center",sortable:!0},{name:"PL",label:"PL",field:"PL",align:"center",sortable:!0},{name:"ACTION",label:"Acciones",field:"ACTION",align:"center"}]}}}),Ie=o(57343);window.loadImageArtifice=function(e,n,o){e.src=(0,Ie.getImageDefault)({webhost:n},o)};var Ae={data:function(){return{currentAlumno:{},configAlumnos:{ACTION:{component:"button",icon:["book_search as book","write","add","delete"],colors:{book:function(e){return e.PARTE&&null===e.ESTADO?"primary":"red"},add:function(e){return e.PARTE&&null===e.ESTADO?"primary":"red"}},write:function(e,n){this.currentAlumno=n,this.observacionLibro=e.NOTABIB,this.condicionFisica=e.ESTFISICO,this.openModalObservacionSeccion=!0},book:function(e){var n=this;return pe()(me()().m(function o(){var a;return me()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,n.getOperaciones({ID_PERSONA:e.ID_PERSONA});case 1:a=o.v,n.rowsOperacionesVigentes=a,n.scrollToElement();case 2:return o.a(2)}},o)}))()},add:function(e,n){var o=this;return pe()(me()().m(function e(){var a,t;return me()().w(function(e){while(1)switch(e.n){case 0:if(0!==o.ejemplaresSeccion.length){e.n=1;break}return o.$notify("Debe indicar un título","info"),e.a(2,!1);case 1:if(o.currentAlumno=n,a=JSON.parse(JSON.stringify(o.ejemplaresSeccion)),t=[],o.rowsAlumnos.map(function(e){e.NUMINGRESO&&t.push(e.NUMINGRESO)}),o.rowsAsignarEjemplares=a.filter(function(e,n){return-1===t.indexOf(e.NUMINGRESO)}),0!==o.rowsAsignarEjemplares.length){e.n=2;break}return o.$notify("No hay más ejemplares del título para asignar","info"),e.a(2,!1);case 2:o.openModalAsignarEjemplar=!0;case 3:return e.a(2)}},e)}))()},delete:function(e,n){n.NUMINGRESO="",n.PARTE="",n.SOLOBIB="",n.TITULO="",n.EXISTCOD="",n.PL="",n.$$color="#FF0000"},tooltip:{book:"Operaciones Vigentes",write:"Observación",add:"Agregar Existencia",delete:"Eliminar Existencia"},validate:{write:function(e){return null===e.ESTADO&&e.PARTE},delete:function(e){return e.PARTE&&null===e.ESTADO},add:function(e){return null===e.ESTADO}},flat:!0,dense:!0},ESTADO:{renderHtml:function(e,n,o,a){return e.PARTE&&null===e.ESTADO?a["$$color"]="#000000":a["$$color"]="#FF0000",n("span",{},e.ESTADO)}},FOTO:{renderHtml:function(e,n){var o=(0,Ie.imgEstudiante)(this.sie,e.ALUCOD),a=e.SEXO||"M";return n("img",{style:{width:"25px"},src:o,onerror:"loadImageArtifice(this,'".concat(this.sie.webhost,"', '").concat(a,"')")})},renderAction:function(e){this.urlImagenBox=(0,Ie.imgEstudiante)(this.sie,e.ALUCOD),this.openModalImagen=!0}}},openModalObservacionSeccion:!1,rowsAlumnos:[],fieldsAlumnos:[{name:"NUMINGRESO",label:"# Ingreso",field:"NUMINGRESO",align:"left",sortable:!0},{name:"PARTE",label:"Cod. Clasif",field:"PARTE",align:"left",sortable:!0},{name:"TITULO",label:"Título",field:"TITULO",align:"left",sortable:!0,wrap:!0,width:100},{name:"SOLOBIB",label:"SB",field:"SOLOBIB",align:"center",sortable:!0},{name:"PL",label:"PL",field:"PL",align:"center",sortable:!0},{name:"ESTADO",label:"",field:"ESTADO",align:"left",vIf:!1},{name:"NOMCOMP",label:"Alumno",field:"NOMCOMP",align:"left",sortable:!0,wrap:!0,width:100},{name:"FOTO",label:"Foto",field:"FOTO",align:"center"},{name:"ACTION",label:"Acciones",field:"ACTION",align:"left",sortable:!0,width:125}]}},methods:{scrollToElement:function(){var e=this.$el.querySelector("div");e&&e.scrollBy(0,1e4)}}},we={data:function(){return{configEjemplares:{},rowsEjemplares:[],fieldsEjemplares:[{name:"NUMINGRESO",label:"# Ingreso",field:"NUMINGRESO",align:"left",sortable:!0},{name:"PARTE",label:"Num. Clasif",field:"PARTE",align:"left",sortable:!0},{name:"NUMEJEMP",label:"Ejemplar",field:"NUMEJEMP",align:"center",sortable:!0},{name:"BIBDESC",label:"Ubicación",field:"BIBDESC",align:"left",sortable:!0},{name:"TITULO",label:"Título",field:"TITULO",align:"left",sortable:!0},{name:"SOLOBIB",label:"SB",field:"SOLOBIB",align:"center",sortable:!0}]}}},ke={data:function(){return{configOperaciones:{FECPREI:{component:"datetime"},FECPREF:{component:"date"}},rowsOperaciones:[],fieldsOperaciones:[{name:"NUMINGRESO",label:"# Ingreso",field:"NUMINGRESO",align:"left",sortable:!0},{name:"PARTE",label:"Cod. Clasif",field:"PARTE",align:"left",sortable:!0},{name:"TITULO",label:"Título",field:"TITULO",align:"left",sortable:!0},{name:"NOMOPERA",label:"Operación",field:"NOMOPERA",align:"center",sortable:!0},{name:"PL",label:"PL",field:"PL",align:"center",sortable:!0},{name:"FECPREI",label:"Fecha",field:"FECPREI",align:"center",sortable:!0},{name:"FECPREF",label:"Retorno",field:"FECPREF",align:"center",sortable:!0}]}}},Te={data:function(){return{configAsignarEjemplares:{},rowsAsignarEjemplares:[],fieldsAsignarEjemplares:[{name:"NUMINGRESO",label:"# Ingreso",field:"NUMINGRESO",align:"left",sortable:!0},{name:"PARTE",label:"Cod. Clasif",field:"PARTE",align:"left",sortable:!0},{name:"TITULO",label:"Título",field:"TITULO",align:"left",sortable:!0},{name:"SOLOBIB",label:"SB",field:"SOLOBIB",align:"center",sortable:!0},{name:"PL",label:"PL",field:"PL",align:"center",sortable:!0}],disabledAsignarEjemplares:{key:"NUMINGRESO",values:[]}}}},Le={data:function(){return{configOperacionesVigentes:{},rowsOperacionesVigentes:[],fieldsOperacionesVigentes:[{name:"NUMINGRESO",label:"# Ingreso",field:"NUMINGRESO",align:"left",sortable:!0},{name:"PARTE",label:"Cod. Clasif",field:"PARTE",align:"left",sortable:!0},{name:"TITULO",label:"Título",field:"TITULO",align:"left",sortable:!0},{name:"SOLOBIB",label:"SB",field:"SOLOBIB",align:"center",sortable:!0},{name:"PL",label:"PL",field:"PL",align:"center",sortable:!0}]}}},De=o(57668),Ce=o(81288),Fe=o(88567),Pe=o(95718),Me=o(20456),Ne=o(53380),xe=o(53399),Ve=o(53093),ye=o(26697),Re=o(53811),je=o(43346),Ue=o(12143),_e=o(95477),Be=o(65673),Ye=o(82327),$e=o(88865),qe=o(18105),Xe=o(2713),Ge=o(88275),Qe=o(2819),We=o(1396),ze=o(98361),Je={components:{QChip:be.wQ,QSpinnerDots:be.FS,QList:Be.A,QItem:Ye.A,QItemSection:$e.A,QInput:ve.A,QSelect:Oe.A,QForm:Se.A,QCard:Fe.A,QCardSection:Pe.A,QCardActions:Me.A,QTab:Ve.A,QTabs:ye.A,QTabPanels:Re.A,QTabPanel:je.A,QSeparator:Ne.A,QImg:xe.A,QDate:Ue.A,QPopupProxy:_e.A,Cronograma:Xe.A,sieSalones:Ge.Ay,catalogoBiblioteca:We["default"],boxImagen:ze.A,QPage:be.Tu,QIcon:be.bP,QBtn:be.Il,QTooltip:be.nC},mixins:[Ee,we,ke,Ae,Te,Le],data:function(){var e=this;return{selectionEjemplares:"multiple",enviaAlerta:!1,buttons:[{label:"Prestar",icon:"book",click:function(){var n=pe()(me()().m(function n(){var o;return me()().w(function(n){while(1)switch(n.n){case 0:o='<div class="row"><div class="col-12"><b>Proceso de Prestamo</b></div><div class="col-12">Este proceso enviará automáticamente una alerta al solicitante.</div></div>',e.confirmOperacion("OPERACION_PRESTAMO",o);case 1:return n.a(2)}},n)}));function o(){return n.apply(this,arguments)}return o}()},{label:"Reservar",icon:"folder_account",click:function(){var n=pe()(me()().m(function n(){var o;return me()().w(function(n){while(1)switch(n.n){case 0:o='<div class="row"><div class="col-12"><b>Proceso de Reserva</b></div><div class="col-12">Este proceso enviará automáticamente una alerta al solicitante.</div></div>',e.confirmOperacion("OPERACION_RESERVA",o);case 1:return n.a(2)}},n)}));function o(){return n.apply(this,arguments)}return o}()},{label:"Cancelar",icon:"cancel",click:this.deleteDataEjemplares},{label:"Cancelar Lista",icon:"user_cancel",click:this.deleteAllDataEjemplares}],buttonsSeccion:[{label:"Préstamo Sección",icon:"group_add",click:function(){var n=pe()(me()().m(function n(){var o,a,t,i,r,l,s,c,u,d,m,f,p;return me()().w(function(n){while(1)switch(n.p=n.n){case 0:if(!e.isLoading){n.n=1;break}return n.a(2);case 1:if(e.isLoading=!0,o=e.rowsAlumnos.filter(function(e){return!!e.PARTE}),a=(e.fretornoseccion||"").split("/").reverse().join("/"),a){n.n=2;break}return e.$alert("Debe seleccionar fecha de préstamo fin","info"),n.a(2);case 2:if(!(o.length>0)){n.n=10;break}return t=ue()(e.rowsAlumnos,1),i=t[0],o=o.map(function(e){return{existcod:e.EXISTCOD,numingreso:e.NUMINGRESO,id_persona:e.ID_PERSONA,solcod:e.ALUCOD}}),r={fecpref:a,oper:e.configuracion.OPERACION_PRESTAMO,pl:(i.PL||"").trim(),sb:(i.SOLOBIB||"").trim(),descriptor:e.nemo,titulo:i.TITULO,bibcod:"01",fichas:o},n.p=3,n.n=4,e.$http.post("api/OperacionesController/prestamoSeccion",{data:r});case 4:return l=n.v,s=l.data.datos,n.n=5,e.$confirmar('<div class="row"><div class="col-12"><b>Proceso finalizado correctamente</b><div class="col-12">¿Desea imprimir la relación de préstamo?</div></div></div>',{icon:"print",color:"primary"},{okLabel:"Imprimir",cancelLabel:"Cancelar",html:!0});case 5:return c=n.v,c&&(u=e.$refs.refSalon.listaSalones.find(function(n){return n.NEMO===e.nemo}),d={repTitulo:i.TITULO,repNemo:e.nemo,repFecha:a,repNemodes:u.NEMODES2,report_cod:"prestamoSalon"},(0,Qe.exportFilePhp)(d,"webservice/reportes-biblioteca/reporte")),n.n=6,e.$confirmar('<div class="row"><div class="col-12"><b>Proceso finalizado correctamente</b><div class="col-12">Proceso finalizado correctamente ¿Desea enviar correo electrónico?</div></div></div>',{icon:"email",color:"warning"},{okLabel:"Enviar",cancelLabel:"Cancelar",html:!0});case 6:if(m=n.v,!m){n.n=8;break}return n.n=7,e.$http.post("api/OperacionesController/enviarAlertas",{data:{operaciones:s,tipo:e.configuracion.OPERACION_PRESTAMO}});case 7:f=n.v,p=f.message,e.$notify(p,"success"),e.rowsAlumnos=[],e.rowsOperacionesVigentes=[],e.nemo=null,e.tituloSeccion=null,e.nroIngreso=null,e.freservaseccion=(0,qe.Ay)(new Date,"DD/MM/YYYY"),e.fprestamoseccion=(0,qe.Ay)(new Date,"DD/MM/YYYY");case 8:e.isLoading=!1,n.n=10;break;case 9:n.p=9,n.v,e.isLoading=!1,e.$notify("No ha sido posible completar el proceso, inténtalo mas tarde","warning");case 10:return n.a(2)}},n,null,[[3,9]])}));function o(){return n.apply(this,arguments)}return o}()}],buttonsFichaAgregada:[{tooltip:"Agregar Ejemplar",icon:"plus",click:function(){var n=pe()(me()().m(function n(){return me()().w(function(n){while(1)switch(n.n){case 0:if(e.validarPrestamos()){n.n=1;break}return n.a(2);case 1:e.openModalCatalogo=!0;case 2:return n.a(2)}},n)}));function o(){return n.apply(this,arguments)}return o}()},{tooltip:"Eliminar Todos",icon:"delete",click:this.deleteEjemplares},{tooltip:"Cronograma Plan Lector",icon:"calendar",click:function(){e.$refs.refModalCronograma.openCronograma()}}],tab:"persona",sie:(0,De["default"])(),solicitantes:[],keysComplete:["TEXT"],solcod:"",id_persona:null,disponibles:0,itemSolicitante:{},solicitante:"",evaluacionSolicitante:{},freserva:"",fprestamo:"",fretorno:"",feriados:[],hoy:(0,qe.Ay)(new Date,"YYYY/MM/DD"),seAgregoFines:!1,freservaseccion:"",fprestamoseccion:"",fretornoseccion:"",descriptor:"",descriptorLabel:"",titulo:"",nroIngreso:"",keysTitulos:["TEXT"],titulos:[],openModalObservacion:!1,observacionLibro:"",condicionFisica:"",openModalEjemplares:!1,selectedEjemplares:{key:"EXISTCOD",values:[]},dataSolicitantes:{},itemEjemplar:{},openProxy:!1,nemo:"",nivel:"",grado:"",configuracion:{},asignaciones:[{label:"Automático",value:"A"},{label:"Manual",value:"M"}],asignacion:"A",tituloSeccion:"",ejemplaresSeccion:[],itemSelectedSeccion:{},openModalAsignarEjemplar:!1,openModalCatalogo:!1,items:[{},{},{},{},{}],btnAtras:!1,openModalImagen:!1,urlImagenBox:"",codigoFoto:"",isLoading:!1,sexo:""}},computed:{rutaFoto:function(){return(0,Ie.imgEstudiante)(this.sie,this.codigoFoto)},getWidth:function(){return ge.A.width},isLess:function(){return(0,Ce.isLess)()}},methods:{openBoxImagen:function(){this.urlImagenBox=this.codigoFoto?this.rutaFoto:this.rutaFotoDefault(),this.openModalImagen=!0},validarPrestamos:function(){return 0===Object.keys(this.evaluacionSolicitante).length?(this.$notify("Indique un solicitante","info"),!1):(this.disponibles=parseInt(this.evaluacionSolicitante.permitidos||0)-parseInt(this.evaluacionSolicitante.cant_prestamos||0),this.disponibles<=0?(this.$notify("El solicitante alcanzó el limite de ejemplares permitidos (".concat(this.evaluacionSolicitante.permitidos,")"),"info"),!1):(this.disponibles=this.disponibles-this.rows.length,this.disponibles<=0?(this.$notify("El solicitante no tiene permitido agregrar más ejemplares","info"),!1):!this.evaluacionSolicitante.bloqueado||(this.$alert(this.evaluacionSolicitante.bloqueado,"info",!0),!1)))},openCronograma:function(){this.$refs.refModalCronograma.openCronograma()},mostrarAtras:function(e){this.btnAtras=e},refresher:function(e,n){var o=this;setTimeout(function(){for(var e=[],a=0;a<7;a++)e.push({});o.items=o.items.concat(e),n()},500)},confirmOperacion:function(){var e=arguments,n=this;return pe()(me()().m(function o(){var a,t,i,r;return me()().w(function(o){while(1)switch(o.n){case 0:if(a=e.length>0&&void 0!==e[0]?e[0]:"",t=e.length>1&&void 0!==e[1]?e[1]:"",!n.isLoading){o.n=1;break}return o.a(2);case 1:if(n.isLoading=!0,a){o.n=2;break}return n.$notify("Operación indefinida, comuniquese con el área de sistemas","warning"),o.a(2);case 2:if(i=n.configuracion[a],!n.enviaAlerta){o.n=5;break}return o.n=3,n.$confirmar(t,"info",!0);case 3:if(r=o.v,!r){o.n=4;break}return o.n=4,n.grabarOperacion(i);case 4:o.n=6;break;case 5:return o.n=6,n.grabarOperacion(i);case 6:return o.a(2)}},o)}))()},grabarOperacion:function(){var e=arguments,n=this;return pe()(me()().m(function o(){var a,t,i,r,l,s;return me()().w(function(o){while(1)switch(o.p=o.n){case 0:if(a=e.length>0&&void 0!==e[0]?e[0]:"",o.p=1,a){o.n=2;break}return n.$alert("Debe agregar una operación","info"),o.a(2);case 2:return t=n.rows.map(function(e){return{BIBCOD:e.BIBCOD,TITULO:e.TITULO,PL:e.PL,SB:e.SOLOBIB,NUMINGRESO:e.NUMINGRESO,EXISTCOD:e.EXISTCOD}}),i={id_persona:n.itemSolicitante.ID_PERSONA,id_perfil:n.itemSolicitante.ID_PERFIL,docest:n.itemSolicitante.DOCEST,solcod:n.solcod,descriptor:n.descriptor,tiposolicita:n.itemSolicitante.TIPO_SOLICITA,fecres:(n.freserva||"").split("/").reverse().join("/"),fecprei:(n.fprestamo||"").split("/").reverse().join("/"),fecpref:(n.fretorno||"").split("/").reverse().join("/"),oper:a,ejemplares:t},o.n=3,n.$http.post("api/OperacionesController/grabarOperacion",{data:i});case 3:return r=o.v,l=r.message,o.n=4,n.deleteDataEjemplares(!1);case 4:n.getTitulos(),n.$alert(l,"success",!0),n.isLoading=!1,o.n=6;break;case 5:o.p=5,s=o.v,n.$alert(s.message||"Problema de conexión, inténtelo mas tarde","warning",!0),n.isLoading=!1;case 6:return o.a(2)}},o,null,[[1,5]])}))()},saveObservacion:function(){var e=this;return pe()(me()().m(function n(){return me()().w(function(n){while(1)switch(n.p=n.n){case 0:return n.p=0,n.n=1,e.$http.post("api/MantenimientosController/updateExistencia",{params:{NOTABIB:e.observacionLibro,ESTFISICO:e.condicionFisica},id:{EXISTCOD:e.itemEjemplar.EXISTCOD}});case 1:e.itemEjemplar.NOTABIB=e.observacionLibro,e.itemEjemplar.ESTFISICO=e.condicionFisica,e.setDataEjemplares(),e.openModalObservacion=!1,n.n=3;break;case 2:n.p=2,n.v,e.$notify("Ha ocurrido un problema con la conexón, inténtalo mas tarde","warning");case 3:return n.a(2)}},n,null,[[0,2]])}))()},saveObservacionSeccion:function(){var e=this;return pe()(me()().m(function n(){return me()().w(function(n){while(1)switch(n.p=n.n){case 0:return n.p=0,n.n=1,e.$http.post("api/MantenimientosController/updateExistencia",{params:{NOTABIB:e.observacionLibro,ESTFISICO:e.condicionFisica},id:{EXISTCOD:e.currentAlumno.EXISTCOD}});case 1:e.currentAlumno.NOTABIB=e.observacionLibro,e.currentAlumno.ESTFISICO=e.condicionFisica,e.openModalObservacionSeccion=!1,n.n=3;break;case 2:n.p=2,n.v,e.$notify("Ha ocurrido un problema con la conexón, inténtalo mas tarde","warning");case 3:return n.a(2)}},n,null,[[0,2]])}))()},getDataSolicitante:function(e){return(null===e||void 0===e?void 0:e.info)||{}},setDataEjemplares:function(){var e=he.A.getItem("dataSolicitantes")||{};e[this.itemSolicitante.ID_PERSONA]={data:this.rows,info:this.itemSolicitante},he.A.set("dataSolicitantes",e),this.dataSolicitantes=e},clearFiltros:function(){this.codigoFoto="",this.solcod="",this.solicitante="",this.sexo="",this.descriptor="",this.descriptorLabel="",this.freserva=(0,qe.Ay)(new Date,"DD/MM/YYYY"),this.fprestamo=(0,qe.Ay)(new Date,"DD/MM/YYYY"),this.fretorno="",this.titulo="",this.nroIngreso="",this.rowsOperaciones=[]},deleteEjemplares:function(){var e=this;return pe()(me()().m(function n(){var o,a,t;return me()().w(function(n){while(1)switch(n.n){case 0:return n.n=1,e.$confirmar("¿Está seguro de eliminar?","delete");case 1:o=n.v,o&&(e.rows=[],t=he.A.getItem("dataSolicitantes")||{},null!==(a=t[e.itemSolicitante.ID_PERSONA])&&void 0!==a&&a.data&&(t[e.itemSolicitante.ID_PERSONA].data=[]),he.A.set("dataSolicitantes",t));case 2:return n.a(2)}},n)}))()},deleteAllDataEjemplares:function(){var e=this;return pe()(me()().m(function n(){var o;return me()().w(function(n){while(1)switch(n.n){case 0:return n.n=1,e.$confirmar("Si cancela se eliminará la lista de solicitantes ¿Está seguro de cancelar?","delete");case 1:o=n.v,o&&(e.clearFiltros(),e.dataSolicitantes={},e.rows=[],he.A.set("dataSolicitantes",{}));case 2:return n.a(2)}},n)}))()},deleteDataEjemplares:function(){var e=arguments,n=this;return pe()(me()().m(function o(){var a,t,i;return me()().w(function(o){while(1)switch(o.n){case 0:if(a=!(e.length>0&&void 0!==e[0])||e[0],t=function(){n.clearFiltros();var e=he.A.getItem("dataSolicitantes")||{};delete e[n.itemSolicitante.ID_PERSONA],n.dataSolicitantes=e,n.rows=[],he.A.set("dataSolicitantes",e)},!a){o.n=2;break}return o.n=1,n.$confirmar("Si cancela se eliminará al solicitante: ".concat(n.itemSolicitante.NOMCOMP," ¿Está seguro de cancelar?"),"delete");case 1:i=o.v,i&&t(),o.n=3;break;case 2:t();case 3:return o.a(2)}},o)}))()},removerExistenciasPorFicha:function(e){var n=JSON.parse(JSON.stringify(this.rows)),o=e?[e]:this.rowsEjemplares,a={};for(var t in n){var i=n[t];a[i.EXISTCOD]=i}o.map(function(e){a[e.EXISTCOD]&&delete a[e.EXISTCOD]});var r=[];for(var l in a)r.push(a[l]);return this.rows=r,n},validarCantidadEjemplaresPermitidos:function(e){var n=e.length+this.rows.length;return n>this.evaluacionSolicitante.permitidos},validarExisteEjemplar:function(e){var n=this;return pe()(me()().m(function o(){var a,t,i,r,l,s;return me()().w(function(o){while(1)switch(o.n){case 0:return a=n.removerExistenciasPorFicha(e),o.n=1,n.$nextTick();case 1:for(i in t={},n.rows)r=n.rows[i],t[r.EXISTCOD]=r;if(l=[],l=e?[e]:n.$refs.tableAddEjemplares.rowsSelected(),s=n.validarCantidadEjemplaresPermitidos(l),!s){o.n=2;break}return n.$alert('<div class="row"><div class="col-12 text-bold">'.concat(n.evaluacionSolicitante.nomcomp,'</div><div class="col-12">No se le permite más de ').concat(n.evaluacionSolicitante.permitidos," ejemplar(es) para préstamo regular</div></div>"),"info",!0),n.rows=a,o.a(2);case 2:l.map(function(e){t[e.EXISTCOD]||n.rows.push(e)}),n.setDataEjemplares();case 3:return o.a(2)}},o)}))()},agregarEjemplares:function(){var e=this;return pe()(me()().m(function n(){return me()().w(function(n){while(1)switch(n.n){case 0:return n.n=1,e.validarExisteEjemplar();case 1:e.openModalEjemplares=!1;case 2:return n.a(2)}},n)}))()},getTitulos:function(){var e=this;return pe()(me()().m(function n(){var o;return me()().w(function(n){while(1)switch(n.p=n.n){case 0:return n.p=0,n.n=1,e.$http.get("api/MantenimientosController/getComboLibrosCatalogos",{params:{params:{disponibles:!0}}});case 1:o=n.v,e.titulos=o||[],n.n=3;break;case 2:n.p=2,n.v,e.titulos=[];case 3:return n.a(2)}},n,null,[[0,2]])}))()},tituloSelected:function(e){var n=arguments,o=this;return pe()(me()().m(function a(){var t,i,r;return me()().w(function(a){while(1)switch(a.n){case 0:if(t=n.length>1&&void 0!==n[1]&&n[1],o.solcod){a.n=1;break}return o.$alert("Debe indicar un solicitante","info"),a.a(2);case 1:if(o.validarPrestamos()){a.n=2;break}return o.titulo="",a.a(2);case 2:return o.titulo=e.TITULO||"",a.n=3,o.getEjemplares(e,t);case 3:if(i=a.v,!(i.length<1)){a.n=4;break}return o.$alert("Ejemplar no disponible.","info"),a.a(2);case 4:if(o.openModalCatalogo&&(o.openModalCatalogo=!1),1!==i.length){a.n=6;break}return a.n=5,o.validarExisteEjemplar(i[0]);case 5:a.n=7;break;case 6:if(!(i.length>1)){a.n=7;break}return o.selectionEjemplares="multiple",(1===o.evaluacionSolicitante.permitidos||o.itemSolicitante.TIPO_SOLICITA!==o.configuracion.SOLICITA_PERSONAL&&!o.configuracion.PERMITIR_MISMO_LIBRO)&&(o.selectionEjemplares="single"),o.openModalEjemplares=!0,o.rowsEjemplares=i,r=[],o.rows.map(function(e){r.indexOf(e.EXISTCOD)<0&&r.push(e.EXISTCOD)}),o.selectedEjemplares.values=r,a.n=7,o.validarExisteEjemplar();case 7:return a.a(2)}},a)}))()},clearAlumnos:function(e){e=e||this.rowsAlumnos,e.map(function(e){e.NUMINGRESO="",e.PARTE="",e.SOLOBIB="",e.TITULO="",e.EXISTCOD="",e.PL="",e.$$color="#FF0000"})},limpiar:function(){this.nemo="",this.nroIngreso="",this.tituloSeccion="",this.freservaseccion="",this.fprestamoseccion="",this.fretornoseccion="",this.nivel="",this.grado="",this.asignacion="A",this.rowsAlumnos=[],this.rowsOperacionesVigentes=[]},tituloSelectedSeccion:function(e){var n=arguments,o=this;return pe()(me()().m(function a(){var t,i,r,l;return me()().w(function(a){while(1)switch(a.n){case 0:return t=n.length>1&&void 0!==n[1]&&n[1],o.tituloSeccion=e.TITULO||"",t||(o.nroIngreso=""),o.itemSelectedSeccion=e,a.n=1,o.getEjemplares(e,t);case 1:if(i=a.v,0!==i.length){a.n=2;break}return o.$notify("No hay ejemplares disponibles","info"),a.a(2,!1);case 2:return a.n=3,o.$http.get("api/OperacionesController/getFechaRetornoSalon",{params:{parametros:{nemo:o.nemo,nivel:o.nivel,grado:o.grado,ficha:i[0].FICHACOD,pl:i[0].PL&&"Si"===i[0].PL.trim()}}});case 3:r=a.v,l=new Date(r.retorno),isNaN(l)||(o.fretornoseccion=(0,qe.Ay)(l,"DD/MM/YYYY")),o.asignacion="A",o.asignarEjemplarAuto(i);case 4:return a.a(2)}},a)}))()},asignarEjemplarAuto:function(e){if("A"!==this.asignacion)return!1;var n=0,o=e.length;this.rowsAlumnos.map(function(a,t){null===a.ESTADO&&o>n?(a.NUMINGRESO=e[n].NUMINGRESO,a.PARTE=e[n].PARTE,a.SOLOBIB=e[n].SOLOBIB,a.TITULO=e[n].TITULO,a.EXISTCOD=e[n].EXISTCOD,a.NOTABIB=e[n].NOTABIB,a.ESTFISICO=e[n].ESTFISICO,a.PL=e[n].PL,n++):(a.NUMINGRESO="",a.PARTE="",a.SOLOBIB="",a.TITULO="",a.EXISTCOD="",a.NOTABIB="",a.ESTFISICO="",a.PL="")}),this.ejemplaresSeccion=e},cambiarAsignacion:function(e){var n=this;return pe()(me()().m(function o(){var a;return me()().w(function(o){while(1)switch(o.n){case 0:n.clearAlumnos(),"A"===e&&(a=JSON.parse(JSON.stringify(n.ejemplaresSeccion)),n.asignarEjemplarAuto(a));case 1:return o.a(2)}},o)}))()},listarExistencias:function(){var e=arguments,n=this;return pe()(me()().m(function o(){var a,t;return me()().w(function(o){while(1)switch(o.n){case 0:return a=e.length>0&&void 0!==e[0]?e[0]:{},o.n=1,n.getEjemplares(a);case 1:t=o.v,t.length>0&&n.rows.push(t[0]);case 2:return o.a(2)}},o)}))()},getEjemplares:function(e,n){var o={estado:"D"};return n?(o.numingreso=e.NUMINGRESO,"seccion"===this.tab&&(o.seccion=!0)):o.fichacod=e.FICHACOD,this.$http.get("api/OperacionesController/getEjemplares",{params:{params:o}})},rutaFotoDefault:function(){var e=(0,Ie.getImageDefault)(this.sie,this.sexo);return e},getEvaluacionSolicitante:function(e){var n=this;return pe()(me()().m(function o(){var a,t;return me()().w(function(o){while(1)switch(o.p=o.n){case 0:return o.p=0,a={solcod:e.SOLCOD,tipcod:e.TIPCOD,nomcomp:e.NOMCOMP,descriptor:e.DESCRIPTOR},o.n=1,n.$http.get("api/OperacionesController/getEvaluacionSolicitante",{params:{parametros:a}});case 1:n.evaluacionSolicitante=o.v,t=new Date(n.evaluacionSolicitante.retorno),isNaN(t)||(n.fretorno=(0,qe.Ay)(t,"DD/MM/YYYY")),n.evaluacionSolicitante.bloqueado&&n.$alert(n.evaluacionSolicitante.bloqueado,"info",!0),o.n=3;break;case 2:return o.p=2,o.v,o.a(2,[]);case 3:return o.a(2)}},o,null,[[0,2]])}))()},getOperaciones:function(e){return this.$http.get("api/OperacionesController/getOperaciones",{params:{parametros:{oper:"vigentes",id_persona:e.ID_PERSONA}}})},clear:function(){var e,n=he.A.getItem("dataSolicitantes")||{};this.dataSolicitantes=n;var o=(null===(e=n[this.itemSolicitante.ID_PERSONA])||void 0===e?void 0:e.data)||[];this.rows=o},selected:function(e){var n=this;return pe()(me()().m(function o(){return me()().w(function(o){while(1)switch(o.n){case 0:return n.isLoading=!1,n.itemSolicitante=e,n.enviaAlerta="S"===n.itemSolicitante.DOCEST&&n.configuracion.ENVIAR_ALERTA_AUTOMATICA_DOCENTE||"S"!==n.itemSolicitante.DOCEST&&n.configuracion.ENVIAR_ALERTA_AUTOMATICA,n.clear(),n.solcod=e.SOLCOD,n.id_persona=e.ID_PERSONA,n.solicitante=e.NOMCOMP,n.sexo=e.SEXO,n.descriptor=e.DESCRIPTOR,n.descriptorLabel=e.ETIQUETA,n.freserva=(0,qe.Ay)(new Date,"DD/MM/YYYY"),n.fprestamo=(0,qe.Ay)(new Date,"DD/MM/YYYY"),n.fretorno="",n.titulo="",n.codigoFoto=e.TIPO_SOLICITA===n.configuracion.SOLICITA_ALUMNO?e.SOLCOD:"",o.n=1,n.getEvaluacionSolicitante(e);case 1:return o.n=2,n.getOperaciones(e);case 2:n.rowsOperaciones=o.v,n.$refs.refNumingreso&&n.$refs.refNumingreso.$el.focus();case 3:return o.a(2)}},o)}))()},getPersonasBiblioteca:function(){var e=this;return pe()(me()().m(function n(){return me()().w(function(n){while(1)switch(n.p=n.n){case 0:return n.p=0,n.n=1,e.$http.get("api/OperacionesController/getPersonasBiblioteca",{params:{parametros:{}}});case 1:e.solicitantes=n.v,n.n=3;break;case 2:return n.p=2,n.v,n.a(2,[]);case 3:return n.a(2)}},n,null,[[0,2]])}))()},getLibros:function(e){return this.$http.get("api/HyoCatalogo/obtenerCatalogo",{params:e})},seleccionarSalon:function(e){var n=this;return pe()(me()().m(function o(){var a;return me()().w(function(o){while(1)switch(o.n){case 0:return n.nivel=e.INSTRUCOD,n.grado=e.GRADOCOD,o.n=1,n.$http.get("api/OperacionesController/getAlumnosSalonAsistencia",{params:{nemo:e.NEMO}});case 1:a=o.v,n.clearAlumnos(a),n.freservaseccion=(0,qe.Ay)(new Date,"DD/MM/YYYY"),n.fprestamoseccion=(0,qe.Ay)(new Date,"DD/MM/YYYY"),n.fretornoseccion=(0,qe.Ay)(new Date,"DD/MM/YYYY"),n.rowsAlumnos=a;case 2:return o.a(2)}},o)}))()},asignarEjemplar:function(){var e=this.$refs.tableasignarEjemplares.rowSelected();this.currentAlumno.NUMINGRESO=e.NUMINGRESO||"",this.currentAlumno.PARTE=e.PARTE||"",this.currentAlumno.SOLOBIB=e.SOLOBIB||"",this.currentAlumno.TITULO=e.TITULO||"",this.currentAlumno.EXISTCOD=e.EXISTCOD||"",this.currentAlumno.PL=e.PL||"",this.openModalAsignarEjemplar=!1},atras:function(){this.$refs.refCatalogo.atras()},optionsPI:function(e){var n=new Date(this.hoy);return new Date(e)>=n&&-1===this.feriados.indexOf(e)&&-1===[0,6].indexOf(new Date(e).getDay())},optionsPF:function(e,n){var o=new Date(n||this.hoy);return new Date(e)>=o&&-1===this.feriados.indexOf(e)&&-1===[0,6].indexOf(new Date(e).getDay())},optionsPFS:function(e){var n=new Date(this.fprestamoseccion.split("/").reverse().join("/"));return this.optionsPF(e,n)},optionsPFA:function(e){var n=new Date(this.fprestamo.split("/").reverse().join("/"));return this.optionsPF(e,n)},obtDiaFinal:function(e){try{var n,o=0,a=this.evaluacionSolicitante.dianum,t=new Date(e.split("/").reverse().join("/"));while(o<a){t=be.p6.addToDate(t,{days:1}),n=(0,qe.Ay)(t,"YYYY/MM/DD");var i=be.p6.getDayOfWeek(t),r=this.feriados.indexOf(n)>=0;!r&&[6,7].indexOf(i)<0&&o++}return(0,qe.Ay)(t,"DD/MM/YYYY")}catch(e){return console.log(e),""}},seleccionaDia:function(e){this.fretorno=this.obtDiaFinal(this.fprestamo),this.$refs[e].hide()}},created:function(){var e=this;return pe()(me()().m(function n(){var o;return me()().w(function(n){while(1)switch(n.n){case 0:return n.n=1,e.$http.get("api/OperacionesController/getFeriados");case 1:return e.feriados=n.v,n.n=2,e.$http.get("api/OperacionesController/getConstantesBib");case 2:return e.configuracion=n.v,o=he.A.getItem("dataSolicitantes")||{},e.dataSolicitantes=o,n.n=3,e.getPersonasBiblioteca();case 3:return n.n=4,e.getTitulos();case 4:return n.n=5,e.$nextTick();case 5:e.$refs.refSolicita&&e.$refs.refSolicita.focusComplete();case 6:return n.a(2)}},n)}))()}},He=o(12807);const Ke=(0,He.A)(Je,[["render",se]]);var Ze=Ke}}]);