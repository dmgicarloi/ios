"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[15691],{15691:function(n,o,e){e.r(o),e.d(o,{default:function(){return F}});var a=e(61758),i=e(58790),t={class:"row q-col-gutter-md"},c={class:"col-xs-12"},r={class:"row"},s={class:"col-xs-12"},l={class:"row"},u={class:"col-xs-12"},d={class:"row"},m={class:"col-xs-12"};function f(n,o){var e=(0,a.g2)("header-btn"),f=(0,a.g2)("formulario"),g=(0,a.g2)("q-card-section"),A=(0,a.g2)("q-card"),I=(0,a.g2)("sie-modal"),h=(0,a.g2)("q-select"),D=(0,a.g2)("sie-table"),p=(0,a.g2)("q-checkbox"),O=(0,a.g2)("q-page");return(0,a.uX)(),(0,a.Wv)(O,{class:"q-pa-sm sie-flat"},{default:(0,a.k6)(function(){return[(0,a.bF)(A,{flat:"",bordered:""},{default:(0,a.k6)(function(){return[(0,a.bF)(e,{name:n.tituloForm,auto:!0,buttons:n.botonesForm},null,8,["name","buttons"]),(0,a.bF)(g,null,{default:(0,a.k6)(function(){return[(0,a.Lk)("div",t,[(0,a.Lk)("div",c,[(0,a.bF)(f,{schema:n.schemas.viewAdmDocumento,ref:"formApp",key:"formApp",onClickIconGrid:n.clickIconGrid,onChangeInput:n.changeInput},null,8,["schema","onClickIconGrid","onChangeInput"])])])]}),_:1})]}),_:1}),(0,a.bF)(I,{title:n.configModalSel.titulo,modelValue:n.openModal,"onUpdate:modelValue":o[0]||(o[0]=function(o){return n.openModal=o}),ok:"GRABAR",onSubmit:n.submit},{default:(0,a.k6)(function(){return[(0,a.bF)(g,{class:(0,i.C4)(n.classContModal)},{default:(0,a.k6)(function(){return[(0,a.bF)(f,{schema:n.schemaModal,ref:"formModal",key:"formModal",modal:!0},null,8,["schema"])]}),_:1},8,["class"])]}),_:1},8,["title","modelValue","onSubmit"]),(0,a.bF)(I,{title:n.modalAsignacion.titulo,modelValue:n.modalAsignacion.open,"onUpdate:modelValue":o[2]||(o[2]=function(o){return n.modalAsignacion.open=o}),onSubmit:n.saveAsignacion},{default:(0,a.k6)(function(){return[(0,a.bF)(g,null,{default:(0,a.k6)(function(){return[(0,a.Lk)("div",r,[(0,a.Lk)("div",s,[(0,a.bF)(h,{class:"q-if-outlined",modelValue:n.modalAsignacion.estado,"onUpdate:modelValue":o[1]||(o[1]=function(o){return n.modalAsignacion.estado=o}),options:n.modalAsignacion.estados,label:"Estado",onInput:n.estadoAsignacion},null,8,["modelValue","options","onInput"])])]),(0,a.Lk)("div",l,[(0,a.Lk)("div",u,[(0,a.bF)(D,{ref:"grid",selection:"multiple","show-search":!0,columns:n.config.fields,data:n.config.rows,config:n.config.config,loadSelection:n.loadSelection},null,8,["columns","data","config","loadSelection"])])])]}),_:1})]}),_:1},8,["title","modelValue","onSubmit"]),(0,a.bF)(I,{title:n.modalConfigAdicional.titulo,modelValue:n.modalConfigAdicional.open,"onUpdate:modelValue":o[3]||(o[3]=function(o){return n.modalConfigAdicional.open=o}),onSubmit:n.saveConfigAdicional},{default:(0,a.k6)(function(){return[(0,a.bF)(g,null,{default:(0,a.k6)(function(){return[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.modalConfigAdicional.checks,function(o,e){return(0,a.uX)(),(0,a.CE)("div",d,[(0,a.Lk)("div",m,[(0,a.bF)(p,{label:o.label,modelValue:n.modalConfigAdicional.models[o.model],"onUpdate:modelValue":function(e){return n.modalConfigAdicional.models[o.model]=e},"true-value":1,"false-value":0},null,8,["label","modelValue","onUpdate:modelValue"])])])}),256))]}),_:1})]}),_:1},8,["title","modelValue","onSubmit"])]}),_:1})}var g=e(76080),A=e.n(g),I=e(45254),h=e.n(I),D=(e(71225),e(74260),e(52133),e(10239),e(50310),e(5962),e(32203),e(90095),e(6724),e(48426),e(83190),e(13715),e(6123)),p=e(80660),O=e(10213),C=e(65848),b=e(40714),w={methods:{gridAsignaciones:function(n){return h()(A()().m(function o(){var e,a;return A()().w(function(o){while(1)switch(o.n){case 0:return e={},a=[{name:"IDENTIFICADOR",label:n.labelIdent,field:"IDENTIFICADOR",align:"left",sortable:!0},{name:"NOMBRE",label:n.labelNombre,field:"NOMBRE",align:"left",sortable:!0},{name:"SITUACION",label:"Situación",field:"SITUACION",align:"left",sortable:!0,vIf:!1}],o.a(2,{config:e,rows:[],fields:a})}},o)}))()}}},E=e(53429),_={mixins:[C.A,b.A,w],data:function(){var n=this.init(),o=[{id:"",label:"Todos"},{id:"asignado",label:"Asignados"},{id:"pendiente",label:"No asignados"}];return n.sie.idDocumento=0,n.classContModal="",n.sie.asignaDocumentos=!1,n.sie.bloqSubidaPPFF=!1,n.sie.accesoEspTesoreria=!1,n.modalAsignacion={open:!1,titulo:"",row:{},estado:"",estados:this.sieSelectOptions(o,"id","label")},n.loadSelection={key:"IDENTIFICADOR",values:[]},n.config={},n.modalConfigAdicional={open:!1,titulo:"",row:{},checks:[],models:{BLOQ_SUBIDA_PPFF:0,ACCESO_ESP_TESORERIA:0}},n},methods:{preModal:function(n,o,e){var a=this;return h()(A()().m(function o(){var i,t;return A()().w(function(o){while(1)switch(o.n){case 0:i=a.configModalSel.codigoFormulario,o.n="admDocumento"===i?1:2;break;case 1:return"I"===e&&(n={ANIO:a.sie.ano}),o.a(3,2);case 2:t=a.configModalSel.codigoFormulario,o.n="admDocPreguntas"===t?3:"admDocumento"===t||"admDocGrados"===t?4:5;break;case 3:return a.classContModal="cont-modal-xl",o.a(3,6);case 4:return a.classContModal="cont-modal-md",o.a(3,6);case 5:return a.classContModal="cont-modal-sm",o.a(3,6);case 6:return o.a(2,n)}},o)}))()},preSubmit:function(n){var o=!0;switch(this.configModalSel.codigoFormulario){case"admDocGrados":var e=this.$refs["formModal"].$refs["GRID_3"].selected;n={idDocumento:this.sie.idDocumento,rows:e};break;case"admDocPreguntas":var a=this.$refs["formModal"].$refs["GRID_3"].selected;n={idDocumento:this.sie.idDocumento,rows:a};break}return{res:o,data:n}},postSubmit:function(n){var o=this;return h()(A()().m(function n(){return A()().w(function(n){while(1)switch(n.n){case 0:o.reloadGrid("formApp","GRID_2");case 1:return n.a(2)}},n)}))()},postDelete:function(n){var o=this;return h()(A()().m(function n(){return A()().w(function(n){while(1)switch(n.n){case 0:o.reloadGrid("formApp","GRID_2");case 1:return n.a(2)}},n)}))()},modalDocGrados:function(n,o,e){var a=this;return h()(A()().m(function o(){return A()().w(function(o){while(1)switch(o.n){case 0:return a.sie.idDocumento=n.ID_DOCUMENTO,o.n=1,a.runModal(null,"admDocGrados","I");case 1:return o.a(2)}},o)}))()},modalPreguntas:function(n,o,e){var a=this;return h()(A()().m(function o(){return A()().w(function(o){while(1)switch(o.n){case 0:return a.sie.idDocumento=n.ID_DOCUMENTO,o.n=1,a.runModal(null,"admDocPreguntas","I");case 1:return o.a(2)}},o)}))()},verAsignaciones:function(n){var o=this;return h()(A()().m(function e(){var a,i,t,c,r,s,l;return A()().w(function(e){while(1)switch(e.n){case 0:return a=n.DIRIGIDO===E["default"].DIRIGIDO_DOCUMENTOS.FAMILIA,i={anoadm:n.ANIO,id_documento:n.ID_DOCUMENTO,dirigido:n.DIRIGIDO,agrupar:!0},t={key:"",label:"",identificador:""},a?(i.order=[{sidx:"VF.NOMBRE_FAMILIA",sord:"asc"}],i.campos=["AD.ID_REGISTRO","VF.ID_PERFAM","VF.FAMCOD","VF.NOMBRE_FAMILIA"],t={key:"ID_PERFAM",label:"NOMBRE_FAMILIA",identificador:"FAMCOD",labelIdent:"Código",labelNombre:"Familia"}):(i.order=[{sidx:"VF.NOMCOMP",sord:"asc"}],i.campos=["AD.ID_REGISTRO","VF.ID_PERSONA","VF.NUMERO_DOCUMENTO","VF.NOMCOMP"],t={key:"ID_PERSONA",label:"NOMCOMP",identificador:"NUMERO_DOCUMENTO",labelIdent:"Dni",labelNombre:"Interesado"}),e.n=1,o.getApiAction("api/postulacionController/getItemsAsignacionDocumentos",i);case 1:return c=e.v,c.map(function(n){n.ID=n[t.key],n.IDENTIFICADOR=n[t.identificador],n.NOMBRE=n[t.label],n.SITUACION=n.ID_REGISTRO&&n.ID_REGISTRO>0?"asignado":"pendiente"}),o.modalAsignacion.titulo=n.NOMBRE+" - Asignación de "+(a?"Familias":"Interesados"),o.modalAsignacion.row=n,o.modalAsignacion.estado="",o.modalAsignacion.open=!0,s=Object,l={},e.n=2,o.gridAsignaciones(t);case 2:o.config=s.assign.call(s,l,e.v),o.config.rows=c,r=c.filter(function(n){return n.ID_REGISTRO&&n.ID_REGISTRO>0}),o.loadSelection={key:"IDENTIFICADOR",values:r};case 3:return e.a(2)}},e)}))()},estadoAsignacion:function(){var n=this;return h()(A()().m(function o(){return A()().w(function(o){while(1)switch(o.n){case 0:n.$refs.grid.find(n.modalAsignacion.estado);case 1:return o.a(2)}},o)}))()},saveAsignacion:function(){var n=this;return h()(A()().m(function o(){return A()().w(function(o){while(1)switch(o.n){case 0:(0,O.confirm)("¿Está seguro de actualizar los registros?","update").onOk(function(){var o={id_documento:n.modalAsignacion.row.ID_DOCUMENTO,dirigido:n.modalAsignacion.row.DIRIGIDO,rows:n.$refs.grid.selected};p.$http.post("api/postulacionController/updateAsignacionDocumentos",{data:o}).then(function(){var o=h()(A()().m(function o(e){var a;return A()().w(function(o){while(1)switch(o.n){case 0:a=1===e.code?"success":"warning",n.$notify(e.message,a),n.modalAsignacion.open=!1;case 1:return o.a(2)}},o)}));return function(n){return o.apply(this,arguments)}}()).catch(function(o){n.$notify(o.error.message,"warning")})});case 1:return o.a(2)}},o)}))()},verConfigAdicional:function(n){var o=this;return h()(A()().m(function e(){return A()().w(function(e){while(1)switch(e.n){case 0:o.modalConfigAdicional.titulo=n.NOMBRE+" - Configuraciones adicionales",o.modalConfigAdicional.checks.forEach(function(e){o.modalConfigAdicional.models[e.model]=n[e.model]}),o.modalConfigAdicional.row=n,o.modalConfigAdicional.open=!0;case 1:return e.a(2)}},e)}))()},checksConfigAdicional:function(){var n=this;return h()(A()().m(function o(){var e;return A()().w(function(o){while(1)switch(o.n){case 0:e=[],n.modalConfigAdicional.checks=e,n.sie.bloqSubidaPPFF&&e.push({label:"¿Bloquear la subida de archivos a los PPFF? (sólo aplica a documentos de subida y/o bajada)",model:"BLOQ_SUBIDA_PPFF"}),n.sie.accesoEspTesoreria&&e.push({label:"¿Acceso especial a los usuarios del perfil ''Tesorería''?",model:"ACCESO_ESP_TESORERIA"}),n.modalConfigAdicional.checks=e;case 1:return o.a(2)}},o)}))()},saveConfigAdicional:function(){var n=this;return h()(A()().m(function o(){var e;return A()().w(function(o){while(1)switch(o.n){case 0:if(0!==n.modalConfigAdicional.checks.length){o.n=1;break}return n.$notify("No hay campos para actualizar","warning"),o.a(2,!1);case 1:e={ID_DOCUMENTO:n.modalConfigAdicional.row.ID_DOCUMENTO},n.modalConfigAdicional.checks.forEach(function(o){e[o.model]=n.modalConfigAdicional.models[o.model]}),(0,O.confirm)("¿Está seguro de actualizar el registro?","update").onOk(function(){p.$http.post("api/postulacionController/updateDocumento",{data:e}).then(function(){var o=h()(A()().m(function o(e){var a;return A()().w(function(o){while(1)switch(o.n){case 0:a=1===e.code?"success":"warning",n.$notify(e.message,a),n.modalConfigAdicional.open=!1,n.reloadGrid("formApp","GRID_2");case 1:return o.a(2)}},o)}));return function(n){return o.apply(this,arguments)}}()).catch(function(o){n.$notify(o.error.message,"warning")})});case 2:return o.a(2)}},o)}))()}},created:function(){var n=this;return h()(A()().m(function o(){var e,a,i;return A()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,n.getConstantesAdmision(["AD_ASIGNA_DOCUMENTOS","AD_DOCUMENTOS_BLOQ_SUBIDA_PPFF","AD_DOCUMENTOS_ACCESO_ESP_TESORERIA"]);case 1:return e=o.v,n.sie.asignaDocumentos=e.AD_ASIGNA_DOCUMENTOS,n.sie.bloqSubidaPPFF=e.AD_DOCUMENTOS_BLOQ_SUBIDA_PPFF,n.sie.accesoEspTesoreria=e.AD_DOCUMENTOS_ACCESO_ESP_TESORERIA,a=n.sie.bloqSubidaPPFF||n.sie.accesoEspTesoreria,i=[{id:"viewAdmDocumento",ref:"formApp"}],o.n=2,n.loadSchemas(i);case 2:n.$nextTick(h()(A()().m(function o(){return A()().w(function(o){while(1)switch(o.n){case 0:if(!n.sie.asignaDocumentos){o.n=1;break}return o.n=1,n.addBotonGrid({schema:"viewAdmDocumento",index:0,icon:"person",eventos:"verAsignaciones",permiso:3});case 1:if(!a){o.n=3;break}return o.n=2,n.addBotonGrid({schema:"viewAdmDocumento",index:0,icon:"playlist_add",eventos:"verConfigAdicional",permiso:3});case 2:return o.n=3,n.checksConfigAdicional();case 3:return o.a(2)}},o)})));case 3:return o.a(2)}},o)}))()},components:{QPage:D.Tu,QCard:D.C$,QSelect:D.Si,QCheckbox:D.vZ}},v=e(12807);const S=(0,v.A)(_,[["render",f]]);var F=S}}]);