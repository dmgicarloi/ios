"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[6845],{6845:function(e,t,o){o.r(t),o.d(t,{default:function(){return le}});var a=o(8445),l=o.n(a),i=o(61758),n={class:"row q-gutter-sm"},r={class:"col-xs-12"},s={key:0,class:"row q-col-gutter-xs"},c={class:"col-xs-12 col-sm-3"},u={class:"col-xs-12 col-sm-3"},p={class:"col-xs-12 col-sm-5"},d={class:"row q-gutter-xs"},m={class:"col"},f={key:1,class:"row q-col-gutter-xs"},b={class:"col-xs-12"},h={class:"row q-gutter-xs"},v={class:"col-3"},g={class:"row q-col-gutter-xs"},k={class:"col-xs-12 col-sm-12 col-md-6"},w={class:"row sie-flat"},E={class:"col-xs-12"},C={class:"col-xs-12"},x={class:"col-xs-12 col-sm-12 col-md-6"},q={class:"row sie-flat"},I={class:"col-xs-12"},V={class:"col-xs-12"},y={class:"row sie-flat"},S={class:"col-xs-12 q-pb-xs"},B={class:"col-xs-12"},A={class:"row q-pa-sm q-col-gutter-sm"},L={class:"col-xs-12"},O={key:0,class:"col-xs-12"},T={key:1,class:"col-xs-12"},F={key:2,class:"col-xs-12"},P={key:3,class:"col-xs-12"},U={key:4,class:"col-xs-12"};function _(e,t){var o=this,a=(0,i.g2)("header-btn"),_=(0,i.g2)("q-radio"),D=(0,i.g2)("q-card-section"),M=(0,i.g2)("q-separator"),N=(0,i.g2)("q-select"),j=(0,i.g2)("autocomplete"),Q=(0,i.g2)("q-tooltip"),R=(0,i.g2)("q-btn"),$=(0,i.g2)("q-input"),X=(0,i.g2)("sie-table"),G=(0,i.g2)("q-card"),W=(0,i.g2)("q-checkbox"),z=(0,i.g2)("sie-modal"),H=(0,i.g2)("q-page");return(0,i.uX)(),(0,i.Wv)(H,{class:"movimiento-operaciones q-pa-sm sie-flat"},{default:(0,i.k6)(function(){return[(0,i.bF)(G,{flat:"",bordered:""},{default:(0,i.k6)(function(){return[(0,i.bF)(a,{name:"Generar Etiquetas:",buttons:e.buttons},null,8,["buttons"]),(0,i.bF)(D,{class:"q-pb-xs"},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",n,[(0,i.Lk)("div",r,[(0,i.bF)(_,{modelValue:e.tipo,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.tipo=t}),val:1,label:"Consulta",onInput:e.limpiar},null,8,["modelValue","onInput"]),(0,i.bF)(_,{modelValue:e.tipo,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.tipo=t}),val:2,label:"Manual",onInput:e.limpiar},null,8,["modelValue","onInput"])])])]}),_:1}),(0,i.bF)(M),(0,i.bF)(D,null,{default:(0,i.k6)(function(){return[1===e.tipo?((0,i.uX)(),(0,i.CE)("div",s,[(0,i.Lk)("div",c,[(0,i.bF)(N,{class:"q-ma-none",label:"Biblioteca",type:"outlined",modelValue:e.biblioteca,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.biblioteca=t}),options:e.bibliotecas,"option-value":"BIBCOD","option-label":"BIBDESC",onInput:t[3]||(t[3]=function(t){return e.getEstanterias()})},null,8,["modelValue","options"])]),(0,i.Lk)("div",u,[(0,i.bF)(N,{class:"q-ma-none",label:"Estanteria",type:"outlined",modelValue:e.estanteria,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.estanteria=t}),options:e.estanterias,"option-value":"UBICACOD","option-label":"UBICADES",onInput:t[5]||(t[5]=function(t){return e.getEjemplares()})},null,8,["modelValue","options"])]),(0,i.Lk)("div",p,[(0,i.Lk)("div",d,[(0,i.Lk)("div",m,[(0,i.bF)(j,{class:"q-ma-none",modelValue:e.titulo,"onUpdate:modelValue":t[6]||(t[6]=function(t){return e.titulo=t}),data:e.titulos,keys:e.keysComplete,onSelected:e.selected},null,8,["modelValue","data","keys","onSelected"])]),(0,i.bF)(R,{icon:"search",size:"10px",color:"primary",onClick:e.getEjemplares},{default:(0,i.k6)(function(){return[(0,i.bF)(Q,null,{default:(0,i.k6)(function(){return l()(t[15]||(t[15]=[(0,i.eW)("Buscar",-1)]))}),_:1})]}),_:1},8,["onClick"]),(0,i.bF)(R,{icon:"broom",size:"10px",color:"primary",onClick:e.limpiar},{default:(0,i.k6)(function(){return[(0,i.bF)(Q,null,{default:(0,i.k6)(function(){return l()(t[16]||(t[16]=[(0,i.eW)("Limpiar",-1)]))}),_:1})]}),_:1},8,["onClick"])])])])):(0,i.Q3)("v-if",!0),2===e.tipo?((0,i.uX)(),(0,i.CE)("div",f,[(0,i.Lk)("div",b,[(0,i.Lk)("div",h,[(0,i.Lk)("div",v,[(0,i.bF)($,{modelValue:e.numingreso,"onUpdate:modelValue":t[7]||(t[7]=function(t){return e.numingreso=t}),label:"Número de Ingreso",onKeyup:e.getDataNumeroIngreso},null,8,["modelValue","onKeyup"])]),(0,i.bF)(R,{icon:"broom",size:"10px",color:"primary",onClick:e.limpiar},{default:(0,i.k6)(function(){return[(0,i.bF)(Q,null,{default:(0,i.k6)(function(){return l()(t[17]||(t[17]=[(0,i.eW)("Limpiar",-1)]))}),_:1})]}),_:1},8,["onClick"])])])])):(0,i.Q3)("v-if",!0)]}),_:1}),1===e.tipo?((0,i.uX)(),(0,i.Wv)(D,{key:0},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",g,[(0,i.Lk)("div",k,[(0,i.Lk)("div",w,[(0,i.Lk)("div",E,[(0,i.bF)(a,{auto:!1,name:"Ejemplares","font-size":"16px",paddingX:"q-px-xs",border:!1,buttons:e.buttonsEjemplares},null,8,["buttons"])]),(0,i.Lk)("div",C,[((0,i.uX)(),(0,i.Wv)(X,{ref:"ejemplares",columns:e.fields,data:e.rowsEjemplares,selection:"multiple",context:o,css:{height:"calc(100vh - 320px)"},key:e.rowsEjemplares.length},null,8,["columns","data"]))])])]),(0,i.Lk)("div",x,[(0,i.Lk)("div",q,[(0,i.Lk)("div",I,[(0,i.bF)(a,{auto:!1,name:"Procesar","font-size":"14px",border:!1,buttons:e.buttonsProcesar},null,8,["buttons"])]),(0,i.Lk)("div",V,[(0,i.bF)(X,{ref:"procesar",columns:e.fields,data:e.rowsProcesar,selection:"multiple",context:o,"load-selection":e.lote,css:{height:"calc(100vh - 320px)"}},null,8,["columns","data","load-selection"])])])])])]}),_:1})):(0,i.Q3)("v-if",!0),2===e.tipo?((0,i.uX)(),(0,i.Wv)(D,{key:1},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",y,[(0,i.Lk)("div",S,[(0,i.bF)(a,{auto:!1,name:"Procesar","font-size":"14px",buttons:e.buttonsProcesar},null,8,["buttons"])]),(0,i.Lk)("div",B,[(0,i.bF)(X,{ref:"procesar",columns:e.fields,data:e.rowsProcesar,selection:"multiple",context:o,"load-selection":e.lote,css:{height:"calc(100vh - 320px)"}},null,8,["columns","data","load-selection"])])])]}),_:1})):(0,i.Q3)("v-if",!0)]}),_:1}),(0,i.bF)(z,{modelValue:e.openModal,"onUpdate:modelValue":t[14]||(t[14]=function(t){return e.openModal=t}),title:"Configuración de etiquetas",onSubmit:e.imprimir,css:{minWidth:"40vw",maxWidth:"40vw",minHeight:"40vh"}},{default:(0,i.k6)(function(){return[(0,i.bF)(D,null,{default:(0,i.k6)(function(){return[(0,i.Lk)("div",A,[(0,i.Lk)("div",L,[(0,i.bF)(N,{class:"q-ma-none",label:"Tipo de Etiqueta",type:"outlined",modelValue:e.form.tipoEtiqueta,"onUpdate:modelValue":t[8]||(t[8]=function(t){return e.form.tipoEtiqueta=t}),options:e.tipoEtiquetas,onInput:e.cambiarEtiqueta},null,8,["modelValue","options","onInput"])]),1!==e.form.tipoEtiqueta?((0,i.uX)(),(0,i.CE)("div",O,[(0,i.bF)(N,{class:"q-ma-none",label:"Papel",type:"outlined",modelValue:e.form.sel_papel,"onUpdate:modelValue":t[9]||(t[9]=function(t){return e.form.sel_papel=t}),options:e.tipoPapel},null,8,["modelValue","options"])])):(0,i.Q3)("v-if",!0),0===e.form.tipoEtiqueta?((0,i.uX)(),(0,i.CE)("div",T,[(0,i.bF)(W,{modelValue:e.form.checkCodigoBarras,"onUpdate:modelValue":t[10]||(t[10]=function(t){return e.form.checkCodigoBarras=t}),label:"Mostrar código de Barras","true-value":1,"false-value":0},null,8,["modelValue"])])):(0,i.Q3)("v-if",!0),1!==e.form.tipoEtiqueta?((0,i.uX)(),(0,i.CE)("div",F,[(0,i.bF)(W,{modelValue:e.form.rdAccion,"onUpdate:modelValue":t[11]||(t[11]=function(t){return e.form.rdAccion=t}),label:"Mostrar código de Clasificacion","true-value":1,"false-value":0},null,8,["modelValue"])])):(0,i.Q3)("v-if",!0),1!==e.form.tipoEtiqueta&&[5,6].indexOf(e.form.sel_papel)<0?((0,i.uX)(),(0,i.CE)("div",P,[(0,i.bF)(W,{modelValue:e.form.checkBorde,"onUpdate:modelValue":t[12]||(t[12]=function(t){return e.form.checkBorde=t}),label:"Bordes","true-value":1,"false-value":0},null,8,["modelValue"])])):(0,i.Q3)("v-if",!0),0===e.form.tipoEtiqueta?((0,i.uX)(),(0,i.CE)("div",U,[(0,i.bF)(W,{modelValue:e.form.checkMostrarTitulo,"onUpdate:modelValue":t[13]||(t[13]=function(t){return e.form.checkMostrarTitulo=t}),label:"Mostrar Título","true-value":1,"false-value":0},null,8,["modelValue"])])):(0,i.Q3)("v-if",!0)])]}),_:1})]}),_:1},8,["modelValue","onSubmit"])]}),_:1})}var D=o(76080),M=o.n(D),N=o(45254),j=o.n(N),Q=o(41562),R=o.n(Q),$=(o(30683),o(23825),o(77507),o(89571),o(50310),o(90095),o(70199),o(515),o(83190),o(52776),o(81813),o(7346),o(13715),o(24066),o(6123)),X=o(88567),G=o(95718),W=o(53380),z=o(9736),H=o(16648),J=o(3042),K=o(99515),Y=o(3112),Z=o(2819),ee=o(57668),te={components:{QCard:X.A,QCardSection:G.A,QSeparator:W.A,QInput:z.A,QSelect:H.A,autocomplete:J.A,QRadio:K.A,QCheckbox:Y.A,QPage:$.Tu,QBtn:$.Il,QTooltip:$.nC},computed:{},data:function(){return{sieInfo:(0,ee["default"])(),buttons:[{icon:"print",permiso:">=1",label:"Imprimir",click:this.openModalImprimir}],buttonsProcesar:[{icon:"delete",click:this.quitar}],buttonsEjemplares:[{icon:"keyboard_arrow_right",click:this.agregar}],openModal:!1,tipo:1,allTitulos:[],titulos:[],keysComplete:["TITULO","TOTAL","FICHACOD"],bibliotecas:[],estanterias:[],coleccionesBib:[],colecciones:[],titulo:"",biblioteca:"",estanteria:"",coleccion:"",numingreso:"",fichacod:"",rowsEjemplares:[],rowsProcesar:[],fields:[{name:"NUMINGRESO",label:"# Ingreso",field:"NUMINGRESO",align:"left"},{name:"PARTE",label:"Cod. Clasif.",field:"PARTE",align:"left"},{name:"TITULO",label:"Título",field:"TITULO",align:"left"}],lote:{key:"NUMINGRESO",values:[]},form:{txt_etiquetas:"",tipoEtiqueta:0,rdAccion:0,sel_papel:2,checkCodigoBarras:1,checkBorde:0,checkMostrarTitulo:0,report_cod:"etiquetas"},tipoEtiquetas:[{value:0,label:"Código de Barras"},{value:1,label:"Código de clasificación"},{value:2,label:"Código QR"}],tipoPapel:[],papel:[{value:2,label:"Margen superior 3, inferior 2"},{value:3,label:"Margen superior 3.5, inferior 3.5"},{value:4,label:"Pegafan A4-004 25,4 x 63,5 mm"}],papelBarra:[{value:7,label:"Pegafan A4-003 25,4 x 99,0 mm"},{value:5,label:"Ticket: Una columna"},{value:6,label:"Ticket: Dos columnas"}]}},methods:{selected:function(e){e&&(this.titulo=e.TITULO,this.fichacod=e.FICHACOD,this.getEjemplares())},agregar:function(){var e=this.$refs.ejemplares.rowsSelected(null,null,!0);if(0!==e.length){this.rowsProcesar=this.rowsProcesar.concat(e),this.lote.values=this.$refs.procesar.rowsSelected(["NUMINGRESO"],this.rowsProcesar);var t,o=R()(e);try{for(o.s();!(t=o.n()).done;){var a=t.value;this.rowsEjemplares.splice(this.rowsEjemplares.indexOf(a),1)}}catch(e){o.e(e)}finally{o.f()}}else this.$notify("Debe seleccionar registros","info")},quitar:function(){var e=this.$refs.procesar.rowsSelected();if(0!==e.length){var t,o=R()(e);try{for(o.s();!(t=o.n()).done;){var a=t.value;this.rowsProcesar.splice(this.rowsProcesar.indexOf(a),1)}}catch(e){o.e(e)}finally{o.f()}}else this.$notify("Debe seleccionar registros","info")},limpiar:function(){this.numingreso="",this.estanteria="",this.titulo="",this.biblioteca=this.bibliotecas[0].BIBCOD,this.rowsEjemplares=[]},getBibliotecas:function(){var e=this;return j()(M()().m(function t(){var o,a;return M()().w(function(t){while(1)switch(t.p=t.n){case 0:return t.p=0,o={columnas:["bibcod","bibdesc"],joins:[],order:{sidx:"bibdesc",sord:"asc"}},t.n=1,e.$http.get("api/MantenimientosController/getBibliotecas",{params:{parametros:o}});case 1:a=t.v,a.unshift({BIBCOD:"",BIBDESC:"Seleccione..."}),e.bibliotecas=a,t.n=3;break;case 2:t.p=2,t.v,e.bibliotecas=[],e.biblioteca="";case 3:return t.a(2)}},t,null,[[0,2]])}))()},getEstanterias:function(){var e=this;return j()(M()().m(function t(){var o,a;return M()().w(function(t){while(1)switch(t.p=t.n){case 0:return t.p=0,o={},o.bibcod=e.biblioteca,t.n=1,e.$http.get("api/MantenimientosController/getEstanteriasBiblioteca",{params:{parametros:o}});case 1:return a=t.v,a.unshift({UBICACOD:"",UBICADES:"Seleccione..."}),e.estanterias=a,e.estanteria=a[0].UBICACOD,t.a(2,a);case 2:return t.p=2,t.v,t.a(2,[])}},t,null,[[0,2]])}))()},getTitulos:function(){var e=this;return j()(M()().m(function t(){var o,a;return M()().w(function(t){while(1)switch(t.p=t.n){case 0:return t.p=0,o={columnas:["fichacod","titulo","disponibles","prestados","reservados","catalogo"],joins:[],order:{sidx:"titulo",sord:"asc"}},t.n=1,e.$http.get("api/MantenimientosController/getTitulos",{params:{parametros:o}});case 1:a=t.v,a.forEach(function(e){var t=e.DISPONIBLES?parseInt(e.DISPONIBLES):0,o=e.PRESTADOS?parseInt(e.PRESTADOS):0,a=e.RESERVADOS?parseInt(e.RESERVADOS):0,l=e.CATALOGO?" | "+e.CATALOGO:"",i=t+o+a;e.TOTAL="Cant.:".concat(i).concat(l)}),e.allTitulos=a,e.titulos=JSON.parse(JSON.stringify(a)),t.n=3;break;case 2:t.p=2,t.v,e.allTitulos=[];case 3:return t.a(2)}},t,null,[[0,2]])}))()},getDataNumeroIngreso:function(e){var t=this;return j()(M()().m(function o(){var a,l,i,n,r,s;return M()().w(function(o){while(1)switch(o.p=o.n){case 0:if(o.p=0,13===e.keyCode){o.n=1;break}return o.a(2);case 1:if(t.numingreso){o.n=2;break}return t.$notify("Aviso - Debe indicar un numero de ingreso.","warning"),o.a(2);case 2:t.numingreso=(t.numingreso||"").replace(/\s|'|"/g,""),a={},l=R()(t.rowsProcesar);try{for(l.s();!(i=l.n()).done;)n=i.value,a[n.NUMINGRESO]=n}catch(e){l.e(e)}finally{l.f()}if(!a[t.numingreso]){o.n=3;break}return t.$notify("Aviso - Número de ingreso duplicado","warning"),o.a(2);case 3:return r={numingreso:t.numingreso},o.n=4,t.$http.get("api/MantenimientosController/getEjemplares",{params:{parametros:r}});case 4:if(s=o.v,0!==s.length){o.n=5;break}return t.$notify("Número de ingreso no existe","warning"),o.a(2);case 5:t.rowsProcesar=t.rowsProcesar.concat(s),t.lote.values=t.$refs.procesar.rowsSelected(["NUMINGRESO"],t.rowsProcesar),t.numingreso="",o.n=7;break;case 6:o.p=6,o.v,t.rowsProcesar=[];case 7:return o.a(2)}},o,null,[[0,6]])}))()},getEjemplares:function(){var e=this;return j()(M()().m(function t(){var o;return M()().w(function(t){while(1)switch(t.p=t.n){case 0:if(t.p=0,e.titulo||e.biblioteca||e.estanteria){t.n=1;break}return e.$notify("Aviso - Debe indicar datos para la consulta","warning"),t.a(2);case 1:return o={bibcod:e.biblioteca,ubicacod:e.estanteria,titulo:e.titulo,fichacod:e.fichacod},t.n=2,e.$http.get("api/ReportesBibliotecaController/getEjemplares",{params:{parametros:o}});case 2:e.rowsEjemplares=t.v,t.n=4;break;case 3:t.p=3,t.v,e.rowsEjemplares=[];case 4:return t.a(2)}},t,null,[[0,3]])}))()},openModalImprimir:function(){var e=this.$refs.procesar.rowsSelected(["NUMINGRESO"]);0!==e.length?(this.form.txt_etiquetas=e.join(","),this.form.tipoEtiqueta=0,this.form.acceso_bibcod=this.sieInfo.acceso_bibcod,this.form.acceso_biblio=this.sieInfo.acceso_biblio,this.cambiarEtiqueta(),this.openModal=!0):this.$notify("Debe seleccionar las etiquetas a imprimir.","info")},imprimir:function(){var e=this;return j()(M()().m(function t(){return M()().w(function(t){while(1)switch(t.n){case 0:(0,Z.exportFilePhp)(e.form,"webservice/reportes-biblioteca/reporte");case 1:return t.a(2)}},t)}))()},cambiarEtiqueta:function(){0===this.form.tipoEtiqueta?this.tipoPapel=this.papel.concat(this.papelBarra):this.tipoPapel=this.papel,this.form.sel_papel=2}},created:function(){var e=this;return j()(M()().m(function t(){return M()().w(function(t){while(1)switch(t.n){case 0:e.titulo="",e.getBibliotecas(),e.getTitulos();case 1:return t.a(2)}},t)}))()}},oe=o(12807);const ae=(0,oe.A)(te,[["render",_]]);var le=ae}}]);