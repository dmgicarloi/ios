"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[17972],{17972:function(e,n,a){a.r(n),a.d(n,{default:function(){return te}});var r=a(8445),t=a.n(r),o=(a(71225),a(50310),a(5962),a(83190),a(61758)),i={class:"row q-col-gutter-md text-weight-thin text-bold"},c={class:"col-xs-12"},l={class:"col-xs-12 col-sm-6 col-md-2"},s={class:"col-xs-12 col-sm-6 col-md-2"},u={class:"col-xs-12 col-sm-12 col-md-2"},d={class:"row q-gutter-xs"},f={class:"col"},m={class:"col-xs-12"},h={class:"q-col-gutter-sm q-pa-sm q-col-gutter-sm"},p={class:"col-xs-12"},g={class:"col-xs-12 q-pa-xs"},F={class:"col-xs-12 col-sm-6"},b={class:"col-xs-12 col-sm-6"},v={class:"row q-col-gutter-sm"},I={class:"col-6 q-pa-xs"},C={class:"col-5 q-pa-xs"},k={class:"col q-pa-xs"},w={class:"row q-col-gutter-sm q-pt-md"},D={class:"col-xs-12 col-sm-12 col-md-6"},E={class:"col-xs-12 col-sm-6 col-md-3"},R={class:"col-xs-12 col-sm-6 col-md-3"},N={class:"col-xs-12 sie-flat"},O={class:"row justify-center q-pa-xs"};function T(e,n){var a=this,r=(0,o.g2)("header-btn"),T=(0,o.g2)("q-date"),x=(0,o.g2)("q-popup-proxy"),V=(0,o.g2)("q-icon"),q=(0,o.g2)("q-input"),M=(0,o.g2)("q-select"),y=(0,o.g2)("q-tooltip"),A=(0,o.g2)("q-btn"),S=(0,o.g2)("sie-ngs"),L=(0,o.g2)("sie-table"),U=(0,o.g2)("q-card-section"),_=(0,o.g2)("q-card"),G=(0,o.g2)("multi-n-g"),$=(0,o.g2)("sie-modal"),Y=(0,o.g2)("q-page");return(0,o.uX)(),(0,o.Wv)(Y,{class:"biblioteca-mantenimiento-recomendado q-pa-sm sie-flat"},{default:(0,o.k6)(function(){return[(0,o.bF)(_,{flat:"",bordered:""},{default:(0,o.k6)(function(){return[(0,o.bF)(r,{name:"Recomendados",buttons:e.buttons},null,8,["buttons"]),(0,o.bF)(U,null,{default:(0,o.k6)(function(){return[(0,o.Lk)("div",i,[(0,o.Lk)("div",c,[(0,o.bF)(S,{class:"q-col-gutter-sm",ref:"refNsg","show-seccion":!1,"class-nivel":"col-xs-12 col-sm-6 col-md-3","class-grado":"col-xs-12 col-sm-6 col-md-3",onNivel:n[8]||(n[8]=function(n){return e.getRecomendados()}),onGrado:n[9]||(n[9]=function(n){return e.getRecomendados()})},{default:(0,o.k6)(function(){return[(0,o.Lk)("div",l,[(0,o.bF)(q,{label:"Fecha Inicio",debounce:"500",maxlength:"10",format:"##/##/####",modelValue:e.filter.fechaInicio,"onUpdate:modelValue":n[2]||(n[2]=function(n){return e.filter.fechaInicio=n}),mask:"##/##/####",readonly:""},{append:(0,o.k6)(function(){return[(0,o.bF)(V,{class:"cursor-pointer",name:"date_range"},{default:(0,o.k6)(function(){return[(0,o.bF)(x,{ref:"qDateProxy1","transition-show":"scale","transition-hide":"scale"},{default:(0,o.k6)(function(){return[(0,o.bF)(T,{mask:"DD/MM/YYYY",modelValue:e.filter.fechaInicio,"onUpdate:modelValue":n[0]||(n[0]=function(n){return e.filter.fechaInicio=n}),onInput:n[1]||(n[1]=function(n){return e.filtrarFecha("qDateProxy1")})},null,8,["modelValue"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])]),(0,o.Lk)("div",s,[(0,o.bF)(q,{label:"Fecha Fin",debounce:"500",maxlength:"10",format:"##/##/####",modelValue:e.filter.fechaFin,"onUpdate:modelValue":n[5]||(n[5]=function(n){return e.filter.fechaFin=n}),mask:"##/##/####",readonly:""},{append:(0,o.k6)(function(){return[(0,o.bF)(V,{class:"cursor-pointer",name:"date_range"},{default:(0,o.k6)(function(){return[(0,o.bF)(x,{ref:"qDateProxy2","transition-show":"scale","transition-hide":"scale"},{default:(0,o.k6)(function(){return[(0,o.bF)(T,{mask:"DD/MM/YYYY",modelValue:e.filter.fechaFin,"onUpdate:modelValue":n[3]||(n[3]=function(n){return e.filter.fechaFin=n}),onInput:n[4]||(n[4]=function(n){return e.filtrarFecha("qDateProxy2")})},null,8,["modelValue"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])]),(0,o.Lk)("div",u,[(0,o.Lk)("div",d,[(0,o.Lk)("div",f,[(0,o.bF)(M,{modelValue:e.filter.vigente,"onUpdate:modelValue":n[6]||(n[6]=function(n){return e.filter.vigente=n}),options:e.vigentes,label:"Vigente",onInput:n[7]||(n[7]=function(n){return e.getRecomendados()})},null,8,["modelValue","options"])]),(0,o.bF)(A,{class:"q-pa-sm",icon:"broom",size:"10px",color:"primary",onClick:e.limpiar},{default:(0,o.k6)(function(){return[(0,o.bF)(y,null,{default:(0,o.k6)(function(){return t()(n[27]||(n[27]=[(0,o.eW)("Limpiar",-1)]))}),_:1})]}),_:1},8,["onClick"])])])]}),_:1},512)]),(0,o.Lk)("div",m,[(0,o.bF)(L,{ref:"tabla",columns:e.fields,data:e.rows,selection:"multiple",config:e.config,context:a,css:{height:"calc(100vh - 210px)"}},null,8,["columns","data","config"])])])]}),_:1})]}),_:1}),(0,o.bF)($,{class:"q-pa-xs",modelValue:e.openModalModificar,"onUpdate:modelValue":n[17]||(n[17]=function(n){return e.openModalModificar=n}),title:"Editar Recomendados",onSubmit:e.guardarEditarRecomendados,css:{width:"50%"}},{default:(0,o.k6)(function(){return[(0,o.Lk)("div",h,[(0,o.Lk)("div",p,[(0,o.bF)(q,{modelValue:e.formEditar.titulo,"onUpdate:modelValue":n[10]||(n[10]=function(n){return e.formEditar.titulo=n}),label:"Título",readonly:""},null,8,["modelValue"])]),(0,o.Lk)("div",g,[(0,o.bF)(G,{class:"q-col-gutter-sm",ref:"refMultiNGEdit",n:e.nivelesEdit,g:e.gradosEdit,"class-nivel":"col-xs-12 col-sm-6","class-grado":"col-xs-12 col-sm-6","nivel-todos":"","grado-todos":""},null,8,["n","g"])]),(0,o.Lk)("div",F,[(0,o.bF)(q,{label:"Fecha Inicio",debounce:"500",maxlength:"10",format:"##/##/####",modelValue:e.formEditar.fechaInicio,"onUpdate:modelValue":n[13]||(n[13]=function(n){return e.formEditar.fechaInicio=n}),mask:"##/##/####",readonly:""},{append:(0,o.k6)(function(){return[(0,o.bF)(V,{class:"cursor-pointer",name:"date_range"},{default:(0,o.k6)(function(){return[(0,o.bF)(x,{ref:"qDateProxy1","transition-show":"scale","transition-hide":"scale"},{default:(0,o.k6)(function(){return[(0,o.bF)(T,{mask:"DD/MM/YYYY",modelValue:e.formEditar.fechaInicio,"onUpdate:modelValue":n[11]||(n[11]=function(n){return e.formEditar.fechaInicio=n}),onInput:n[12]||(n[12]=function(n){return e.ocultarModalFecha("qDateProxy1")})},null,8,["modelValue"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])]),(0,o.Lk)("div",b,[(0,o.bF)(q,{label:"Fecha Fin",debounce:"500",maxlength:"10",format:"##/##/####",modelValue:e.formEditar.fechaFin,"onUpdate:modelValue":n[16]||(n[16]=function(n){return e.formEditar.fechaFin=n}),mask:"##/##/####",readonly:""},{append:(0,o.k6)(function(){return[(0,o.bF)(V,{class:"cursor-pointer",name:"date_range"},{default:(0,o.k6)(function(){return[(0,o.bF)(x,{ref:"qDateProxy2","transition-show":"scale","transition-hide":"scale"},{default:(0,o.k6)(function(){return[(0,o.bF)(T,{mask:"DD/MM/YYYY",modelValue:e.formEditar.fechaFin,"onUpdate:modelValue":n[14]||(n[14]=function(n){return e.formEditar.fechaFin=n}),onInput:n[15]||(n[15]=function(n){return e.ocultarModalFecha("qDateProxy2")})},null,8,["modelValue"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])])])]}),_:1},8,["modelValue","onSubmit"]),(0,o.bF)($,{modelValue:e.openModalCrear,"onUpdate:modelValue":n[26]||(n[26]=function(n){return e.openModalCrear=n}),title:"Recomendar Fichas",css:{width:"900px"}},{footer:(0,o.k6)(function(){return[(0,o.Lk)("div",O,[(0,o.bF)(A,{color:"primary",label:"Recomendar",onClick:e.guardarNuevoRecomendado},null,8,["onClick"])])]}),default:(0,o.k6)(function(){return[(0,o.bF)(_,{flat:""},{default:(0,o.k6)(function(){return[(0,o.bF)(U,{class:"q-pb-none"},{default:(0,o.k6)(function(){return[(0,o.Lk)("div",v,[(0,o.Lk)("div",I,[(0,o.bF)(q,{label:"Busqueda",modelValue:e.busqueda,"onUpdate:modelValue":n[18]||(n[18]=function(n){return e.busqueda=n})},null,8,["modelValue"])]),(0,o.Lk)("div",C,[(0,o.bF)(M,{modelValue:e.marcSelected,"onUpdate:modelValue":n[19]||(n[19]=function(n){return e.marcSelected=n}),label:"Filtros",options:e.marcFiltro},null,8,["modelValue","options"])]),(0,o.Lk)("div",k,[(0,o.bF)(A,{class:"q-pa-sm",icon:"search",size:"10px",color:"primary",onClick:e.buscar},{default:(0,o.k6)(function(){return[(0,o.bF)(y,null,{default:(0,o.k6)(function(){return t()(n[28]||(n[28]=[(0,o.eW)("Buscar",-1)]))}),_:1})]}),_:1},8,["onClick"])])])]}),_:1}),(0,o.bF)(U,null,{default:(0,o.k6)(function(){return[(0,o.bF)(r,{name:"Recomendación:","font-size":"14px"}),(0,o.Lk)("div",w,[(0,o.Lk)("div",D,[(0,o.bF)(G,{class:"q-col-gutter-sm",ref:"refMultiNG",n:e.niveles,g:e.grados,"class-nivel":"col-xs-12 col-sm-6","class-grado":"col-xs-12 col-sm-6",required:"","nivel-todos":"","grado-todos":""},null,8,["n","g"])]),(0,o.Lk)("div",E,[(0,o.bF)(q,{label:"Fecha Inicio",debounce:"500",maxlength:"10",format:"##/##/####",modelValue:e.formCrear.fechaInicio,"onUpdate:modelValue":n[22]||(n[22]=function(n){return e.formCrear.fechaInicio=n}),mask:"##/##/####",readonly:""},{append:(0,o.k6)(function(){return[(0,o.bF)(V,{class:"cursor-pointer",name:"date_range"},{default:(0,o.k6)(function(){return[(0,o.bF)(x,{ref:"qDateProxyIni","transition-show":"scale","transition-hide":"scale"},{default:(0,o.k6)(function(){return[(0,o.bF)(T,{mask:"DD/MM/YYYY",modelValue:e.formCrear.fechaInicio,"onUpdate:modelValue":n[20]||(n[20]=function(n){return e.formCrear.fechaInicio=n}),onInput:n[21]||(n[21]=function(n){return e.ocultarModalFecha("qDateProxyIni")})},null,8,["modelValue"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])]),(0,o.Lk)("div",R,[(0,o.bF)(q,{label:"Fecha Fin",debounce:"500",maxlength:"10",format:"##/##/####",modelValue:e.formCrear.fechaFin,"onUpdate:modelValue":n[25]||(n[25]=function(n){return e.formCrear.fechaFin=n}),mask:"##/##/####",readonly:""},{append:(0,o.k6)(function(){return[(0,o.bF)(V,{class:"cursor-pointer",name:"date_range"},{default:(0,o.k6)(function(){return[(0,o.bF)(x,{ref:"qDateProxyFin","transition-show":"scale","transition-hide":"scale"},{default:(0,o.k6)(function(){return[(0,o.bF)(T,{mask:"DD/MM/YYYY",modelValue:e.formCrear.fechaFin,"onUpdate:modelValue":n[23]||(n[23]=function(n){return e.formCrear.fechaFin=n}),onInput:n[24]||(n[24]=function(n){return e.ocultarModalFecha("qDateProxyFin")})},null,8,["modelValue"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])]),(0,o.Lk)("div",N,[(0,o.bF)(L,{ref:"tablaAgregar",columns:e.fieldsNew,data:e.rowsAgregar,selection:"multiple",config:e.config,context:a,css:{height:"400px"}},null,8,["columns","data","config"])])])]}),_:1})]}),_:1})]}),_:1},8,["modelValue"])]}),_:1})}var x=a(57008),V=a.n(x),q=a(14794),M=a.n(q),y=a(76080),A=a.n(y),S=a(45254),L=a.n(S),U=(a(74260),a(39866),a(23825),a(77507),a(52133),a(10239),a(30317),a(32203),a(6724),a(62692),a(66307),a(76213),a(24066),{data:function(){return{config:{FECINI:{component:"date",edit:!1},FECFIN:{component:"date",edit:!1},ACTION:{component:"button",icon:["edit","delete"],edit:function(e,n){var a=this;this.openModalModificar=!0,this.currentRecomendadoEditar=n,this.codigoEdit=e.CODIGO,this.nivelesEdit=n.INSTRUCOD.split(","),this.gradosEdit=n.GRADOCOD.split(",").map(function(e,n){return a.nivelesEdit[n]+e}),this.$nextTick(L()(A()().m(function n(){return A()().w(function(n){while(1)switch(n.n){case 0:a.formEditar.titulo=e.TITULO,e.FECINI&&(a.formEditar.fechaInicio=e.FECINI.split("/").reverse().join("/")),e.FECFIN&&(a.formEditar.fechaFin=e.FECFIN.split("/").reverse().join("/"));case 1:return n.a(2)}},n)})))},delete:function(e,n){this.eliminaRecomendacion(e,n)},tooltip:{edit:"Editar",delete:"Eliminar"},permisos:{edit:">1",delete:"===3"},dense:!0,flat:!0}},rows:[],fields:[{name:"CODIGO",label:"Código",field:"CODIGO",align:"center",sortable:!0,wrap:!0},{name:"TITULO",label:"Título",field:"TITULO",align:"left",wrap:!0},{name:"NIVEL",label:"Niveles",field:"NIVEL",align:"center",sortable:!0,wrap:!0},{name:"GRADO",label:"Grados",field:"GRADO",align:"center",sortable:!0,wrap:!0},{name:"FECINI",label:"Fecha Inicial",field:"FECINI",align:"center",sortable:!0},{name:"FECFIN",label:"Fecha FInal",field:"FECFIN",align:"center",sortable:!0},{name:"DISPONIBLES",label:"Disponible",field:"DISPONIBLES",align:"center",sortable:!0},{name:"RESERVADOS",label:"Reservado",field:"RESERVADOS",align:"center",sortable:!0},{name:"PRESTADOS",label:"Prestado",field:"PRESTADOS",align:"center",sortable:!0},{name:"VIGENTE",label:"Vigente",field:"VIGENTE",align:"center",sortable:!0},{name:"ACTION",label:"Editar",field:"ACTION",align:"center",width:90}],fieldsNew:[{name:"FICHACOD",label:"Código",field:"FICHACOD",align:"center",sortable:!0},{name:"TITULO",label:"Título",field:"TITULO",align:"left",wrap:!0}]}}}),_=a(9736),G=a(16648),$=a(2739),Y=a(57668),P=a(36667),B=a(12143),Q=a(95477),H=a(18105),j=a(6123),W=a(53380),z=a(25662),X=a(2819),J=a(10213),K=a(11654),Z=a(88567),ee=a(95718),ne={mixins:[U],components:{QInput:_.A,QForm:$.A,sieNgs:P.A,QDate:B.A,QPopupProxy:Q.A,QSelect:G.A,QDatetime:j.T5,QSeparator:W.A,multiNG:z.A,confirm:J.confirm,QBtn:K.A,QCard:Z.A,QCardSection:ee.A,QPage:j.Tu,QIcon:j.bP,QTooltip:j.nC},data:function(){var e=this;return{sie:(0,Y["default"])(),codigoEdit:"",buttons:[{icon:"plus",label:"Agregar",permiso:">1",click:function(n){e.formCrear.fechaInicio="",e.formCrear.fechaFin="",e.openModalCrear=!0}},{icon:"delete",label:"Eliminar",click:this.deleteRecomendados,permiso:"===3"},{icon:"print",label:"Imprimir",click:function(n){var a={titulo:"",node:!0,instrucod:e.nivel,gradocod:e.grado,fecini:e.filter.fechaInicio,fecfin:e.filter.fechaFin,vigente:e.filter.vigente};(0,X.exportFilePhp)(a,"biblioteca/mantenimiento-recomendados/reporte")}}],filter:{fechaInicio:"",fechaFin:"",vigente:0},vigentes:[{label:"Todos",value:0},{label:"Si",value:"S"},{label:"No",value:"N"}],openModalModificar:!1,openModalCrear:!1,formEditar:{titulo:"",nivel:"",grado:"",fechaInicio:"",fechaFin:""},formCrear:{titulo:"",nivel:"",grado:"",fechaInicio:"",fechaFin:""},niveles:[],grados:[],nivelesEdit:[],gradosEdit:[],rowsAgregar:[],nivel:"",grado:"",marcSelected:"245a",busqueda:"",marcFiltro:[],currentRecomendadoEditar:{}}},methods:{limpiar:function(){var e=this;return L()(A()().m(function n(){return A()().w(function(n){while(1)switch(n.n){case 0:return e.rows=[],e.filter.fechaInicio="",e.filter.fechaFin="",e.filter.vigente="S",e.$refs.refNsg.ngs.nivel="T",e.$refs.refNsg.ngs.grado="T",n.n=1,e.getRecomendados();case 1:return n.a(2)}},n)}))()},cruceRangosDeFecha:function(e,n){var a=new Date(e.FECINI).getTime(),r=new Date(e.FECFIN).getTime(),t=new Date(n.FECINI).getTime(),o=new Date(n.FECFIN).getTime(),i=a>=t&&a<=o,c=r>=t&&r<=o,l=t>=a&&t<=r,s=o>=a&&o<=r;return i||c||l||s},comprobarCruceDeFechas:function(e){var n=this;return L()(A()().m(function a(){var r,t,o;return A()().w(function(a){while(1)switch(a.n){case 0:if(!(n.rows.length<1)){a.n=1;break}return a.a(2,!1);case 1:r=A()().m(function a(){var r,t,i,c,l,s,u;return A()().w(function(a){while(1)switch(a.n){case 0:if(r=n.rows[o],t=r.INSTRUCOD.split(","),i=r.GRADOCOD.split(","),c=t.map(function(e,n){return e+i[n]}),l=c.filter(function(n){return e.NG.includes(n)}),s=e.TITULO&&e.CODIGO?r.TITULO===e.TITULO&&e.CODIGO!==r.CODIGO:e.FICHACOD.find(function(e){return r.FICHACOD===e}),u=n.cruceRangosDeFecha(e,r),!(l.length>0&&u&&s)){a.n=1;break}return n.$alert('Hay un cruce de fecha para:  "'+r.TITULO+'"',"warning"),a.a(2,{v:!0});case 1:return a.a(2)}},a)}),o=0;case 2:if(!(o<n.rows.length)){a.n=5;break}return a.d(M()(r()),3);case 3:if(t=a.v,!t){a.n=4;break}return a.a(2,t.v);case 4:o++,a.n=2;break;case 5:return a.a(2)}},a)}))()},invertirFecha:function(e){var n=e.fechaInicio.split("/").reverse().join("/"),a=e.fechaFin.split("/").reverse().join("/");return{fecIni:n,fecFin:a}},formatearFecha:function(e){var n=e.fechaInicio.split("/"),a=e.fechaFin.split("/"),r=new Date(n[2],n[1]-1,n[0]),t=new Date(a[2],a[1]-1,a[0]);return{fecIni:r,fecFin:t}},validarRangoFecha:function(){var e=!!this.openModalCrear,n=e?this.formCrear:this.formEditar,a=this.formatearFecha(n),r=a.fecIni,t=a.fecFin;if(r>t)return this.$notify("La fecha de inicio no puede ser mayor a la fecha de fin","warning"),e?this.formCrear.fechaFin="":this.formEditar.fechaFin="",!1},eliminaRecomendacion:function(e,n){var a=this;return L()(A()().m(function n(){return A()().w(function(n){while(1)switch(n.n){case 0:(0,J.confirm)("¿Realmente desea eliminar este registro?","delete").onOk(L()(A()().m(function n(){var r;return A()().w(function(n){while(1)switch(n.p=n.n){case 0:return n.p=0,n.n=1,a.$http.delete("api/BmRecomendacionesController/deleteBmRecomendaciones",{params:{id:e.CODIGO}});case 1:return n.n=2,a.getRecomendados();case 2:a.$notify("Registro eliminado exitosamente.","success"),n.n=4;break;case 3:n.p=3,r=n.v,a.$notify(r.message,"warning");case 4:return n.a(2)}},n,null,[[0,3]])})));case 1:return n.a(2)}},n)}))()},buscar:function(e,n){var a=this;return L()(A()().m(function e(){var n;return A()().w(function(e){while(1)switch(e.n){case 0:return n={MARCCOD:a.marcSelected,BUSQUEDA:a.busqueda},""===a.marcSelected&&""===a.busqueda&&(n=null),e.n=1,a.$http.get("api/BmRecomendacionesController/getListaFichas",{params:{params:{filtro:n}}});case 1:return a.rowsAgregar=e.v,e.a(2,1)}},e)}))()},verificaNiveles:function(e){var n=this;return L()(A()().m(function a(){var r,t,o,i,c,l,s,u,d,f,m;return A()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,n.$nextTick();case 1:if(r=e.filter(function(e){return"T"!==e}),!n.$refs.refMultiNG){a.n=3;break}return a.n=2,n.$refs.refMultiNG.obtGrados();case 2:m=a.v,a.n=5;break;case 3:return a.n=4,n.$refs.refMultiNGEdit.obtGrados();case 4:m=a.v;case 5:return t=m,o=t.filter(function(e){return"I"===e.INSTRUCOD}),i=t.filter(function(e){return"P"===e.INSTRUCOD}),c=t.filter(function(e){return"S"===e.INSTRUCOD}),l=o.every(function(n){return e.includes(n.INSTRUCOD+n.GRADOCOD)}),s=i.every(function(n){return e.includes(n.INSTRUCOD+n.GRADOCOD)}),u=c.every(function(n){return e.includes(n.INSTRUCOD+n.GRADOCOD)}),l&&(r=r.filter(function(e){return!e.startsWith("I")}),r.push("IT")),s&&(r=r.filter(function(e){return!e.startsWith("P")}),r.push("PT")),u&&(r=r.filter(function(e){return!e.startsWith("S")}),r.push("ST")),d=["IT","PT","ST"],a.n=6,d.every(function(e){return r.includes(e)});case 6:if(f=a.v,!f){a.n=7;break}return a.a(2,["TT"]);case 7:return a.a(2,r)}},a)}))()},guardarNuevoRecomendado:function(e){var n=this;return L()(A()().m(function e(){var a,r,t,o,i,c,l,s,u,d;return A()().w(function(e){while(1)switch(e.p=e.n){case 0:return e.n=1,n.$refs.refMultiNG.getNivelGrado();case 1:return a=e.v,e.n=2,n.verificaNiveles(a);case 2:if(r=e.v,!(a.length<1)){e.n=3;break}return n.$notify("Campos niveles y grados son obligatorios","info"),e.a(2);case 3:if(n.formCrear.fechaInicio&&n.formCrear.fechaFin){e.n=4;break}return n.$notify("Campos fechas son obligatorios","info"),e.a(2);case 4:if(t=n.$refs.tablaAgregar.rowsSelected("FICHACOD"),!(t.length<1)){e.n=5;break}return n.$notify("Debe seleccionar almenos una ficha","info"),e.a(2);case 5:return o=[],t.map(function(e){o.push(e.FICHACOD)}),i={FICHACOD:o,FECINI:n.formCrear.fechaInicio,FECFIN:n.formCrear.fechaFin,USUCOD:n.sie.usucod,NG:r},c=n.formatearFecha(n.formCrear),l=c.fecIni,s=c.fecFin,i.FECINI=l,i.FECFIN=s,e.n=6,n.comprobarCruceDeFechas(i);case 6:if(u=e.v,!u){e.n=7;break}return e.a(2);case 7:return e.p=7,e.n=8,n.$http.post("api/BmRecomendacionesController/registrarNuevo",{data:i});case 8:return e.n=9,n.getRecomendados();case 9:n.$notify("Recomendaciones generadas exitosamente","success"),n.openModalCrear=!1,e.n=11;break;case 10:e.p=10,d=e.v,n.$notify(d.message,"warning");case 11:return e.a(2)}},e,null,[[7,10]])}))()},required:function(e){return![null,void 0,""].includes(e)||"Campo requerido"},getRecomendados:function(){var e=this;return L()(A()().m(function n(){var a,r,t,o,i,c,l,s,u,d;return A()().w(function(n){while(1)switch(n.n){case 0:return a=e.invertirFecha(e.filter),r=a.fecIni,t=a.fecFin,o=e.filter.vigente,i=e.$refs.refNsg.NGS("object"),c=i.nivel,l=i.grado,s="%"===c?"T":c,u="%"===l?"T":l,e.nivel=c,e.grado=l,d={fecIni:r,fecFin:t,vigente:o,instrucod:s,gradocod:u},n.n=1,e.$http.get("api/HyoFichaRecomendado/getRecomendado",{params:{params:d}});case 1:e.rows=n.v;case 2:return n.a(2)}},n)}))()},filtrarFecha:function(e){var n=this;return L()(A()().m(function a(){return A()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,n.getRecomendados();case 1:n.ocultarModalFecha(e);case 2:return a.a(2)}},a)}))()},ocultarModalFecha:function(e){var n=this;return L()(A()().m(function a(){return A()().w(function(a){while(1)switch(a.n){case 0:return(n.openModalCrear||n.openModalModificar)&&n.validarRangoFecha(),a.n=1,n.$refs[e].hide();case 1:return a.a(2)}},a)}))()},guardarEditarRecomendados:function(){var e=this;return L()(A()().m(function n(){var a,r,t,o,i,c,l,s;return A()().w(function(n){while(1)switch(n.p=n.n){case 0:return a=e.$refs.refMultiNGEdit.getNivelGrado(),n.n=1,e.verificaNiveles(a);case 1:if(r=n.v,e.formEditar.fechaInicio&&e.formEditar.fechaFin){n.n=2;break}return e.$notify("Campos fechas son obligatorios","info"),n.a(2);case 2:return t=e.invertirFecha(e.formEditar),o=t.fecIni,i=t.fecFin,c={},c={CODIGO:e.codigoEdit,FECINI:o,FECFIN:i,NG:r},n.n=3,e.comprobarCruceDeFechas(V()(V()({},c),{},{TITULO:e.formEditar.titulo}));case 3:if(l=n.v,!l){n.n=4;break}return n.a(2);case 4:return n.p=4,n.n=5,e.$http.post("api/BmRecomendacionesController/updateBmRecomendaciones",{params:c});case 5:return n.n=6,e.getRecomendados();case 6:e.openModalModificar=!1,e.$notify("Datos actualizados exitosamente","success"),n.n=8;break;case 7:n.p=7,s=n.v,e.openModalModificar=!1,e.$notify(s.message,"warning");case 8:return n.a(2,0)}},n,null,[[4,7]])}))()},deleteRecomendados:function(){var e=this;return L()(A()().m(function n(){var a,r,t,o;return A()().w(function(n){while(1)switch(n.n){case 0:if(a=e.$refs.tabla.rowsSelected(["CODIGO","INSTRUCOD"]),!(a.length<1)){n.n=1;break}return e.$notify("Debe seleccionar los elementos que desea eliminar","info"),n.a(2);case 1:return n.n=2,e.$confirmar("¿Está seguro de eliminar los elementos seleccionados? ¡El proceso es irreversible!","delete");case 2:if(r=n.v,!r){n.n=5;break}return n.n=3,e.$http.post("api/HyoFichaRecomendado/deleteRecomendado",{codigos:a});case 3:return t=n.v,o=t.message,n.n=4,e.getRecomendados();case 4:e.$notify(o,"success");case 5:return n.a(2)}},n)}))()}},created:function(){var e=this;return L()(A()().m(function n(){var a,r;return A()().w(function(n){while(1)switch(n.n){case 0:a=new Date,r=new Date(a.getFullYear(),a.getMonth(),1),r=(0,H.Ay)(r,"DD/MM/YYYY"),e.filter.fechaInicio=r;case 1:return n.a(2)}},n)}))()},mounted:function(){var e=this;return L()(A()().m(function n(){var a;return A()().w(function(n){while(1)switch(n.n){case 0:return n.n=1,e.getRecomendados();case 1:return n.n=2,e.$http.get("api/BmRecomendacionesController/getListaFichas");case 2:return e.rowsAgregar=n.v,n.n=3,e.$http.get("api/BmRecomendacionesController/getFiltrosMarc");case 3:a=n.v,e.marcFiltro=[{label:"Todos",value:"T"}],a.map(function(n){var a={label:n.MARCETI,value:n.MARCCOD};e.marcFiltro.push(a)});case 4:return n.a(2)}},n)}))()}},ae=a(12807);const re=(0,ae.A)(ne,[["render",T]]);var te=re}}]);