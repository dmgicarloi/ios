"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[88130],{88130:function(o,e,n){n.r(e),n.d(e,{default:function(){return k}});var r=n(61758),a={class:"row q-pa-none"},t={class:"col-xs-12 col-md-4"},i={class:"col-xs-12 col-md-4"},s={class:"col-xs-12 col-md-4"},l={class:"row"},u={class:"col-xs-12 col-md-6 q-pa-xs"},c={class:"col-xs-12 col-md-6 q-pa-xs"},O={class:"col-xs-12 q-pa-sm row"},d={class:"col-12 q-pa-xs"},C={class:"col-12 q-pa-xs"},p={class:"col-12 q-pa-xs"},I={class:"col-12 q-pa-xs"};function A(o,e){var n=this,A=(0,r.g2)("header-btn"),R=(0,r.g2)("sie-select"),f=(0,r.g2)("q-card-section"),m=(0,r.g2)("sie-table"),D=(0,r.g2)("q-card-main"),N=(0,r.g2)("q-field"),T=(0,r.g2)("q-datetime"),S=(0,r.g2)("sie-modal"),U=(0,r.g2)("q-page");return(0,r.uX)(),(0,r.Wv)(U,{class:"sie-flat bg-white q-pa-sm"},{default:(0,r.k6)(function(){return[(0,r.bF)(D,{class:"q-pa-none"},{default:(0,r.k6)(function(){return[(0,r.bF)(A,{name:"Copiar Cursos por Periodo",buttons:o.buttonsDatos},null,8,["buttons"]),(0,r.bF)(f,{class:"q-pa-none"},{default:(0,r.k6)(function(){return[(0,r.Lk)("div",a,[(0,r.Lk)("div",t,[(0,r.bF)(R,{type:"outlined",label:"ANO",val:"ANO",modelValue:o.ano,"onUpdate:modelValue":e[0]||(e[0]=function(e){return o.ano=e}),readonly:!1,placeholder:"Año Origen",options:o.optAnios,onInput:o.cargarCursos},null,8,["modelValue","options","onInput"])]),(0,r.Lk)("div",i,[(0,r.bF)(R,{type:"outlined",label:"DURADES",val:"DURACOD",modelValue:o.periodo,"onUpdate:modelValue":e[1]||(e[1]=function(e){return o.periodo=e}),readonly:!1,placeholder:"Periodo",options:o.periodoOpt,onInput:o.cargarCursos},null,8,["modelValue","options","onInput"])]),(0,r.Lk)("div",s,[(0,r.bF)(R,{type:"outlined",label:"GRUVADES",val:"GRUVACOD",modelValue:o.grupo,"onUpdate:modelValue":e[2]||(e[2]=function(e){return o.grupo=e}),readonly:!1,placeholder:"Grupo",options:o.grupoOpt,onInput:o.cambiaGrupo},null,8,["modelValue","options","onInput"])])])]}),_:1}),(0,r.bF)(f,null,{default:(0,r.k6)(function(){return[(0,r.Lk)("div",l,[(0,r.Lk)("div",u,[(0,r.bF)(m,{css:"height:calc(100vh - 220px)",ref:"sieTable","row-key":"DESCRIPCION",selection:"multiple",context:n,columns:o.columns,data:o.dataRows,selected:o.seleccionados,"onUpdate:selected":e[3]||(e[3]=function(e){return o.seleccionados=e}),config:o.config},null,8,["columns","data","selected","config"])]),(0,r.Lk)("div",c,[(0,r.bF)(m,{css:"height:calc(100vh - 220px)",ref:"exportTable","row-key":"DESCRIPCION",selection:"multiple",context:n,columns:o.columns,data:o.exportRows,selected:o.seleccionados,"onUpdate:selected":e[4]||(e[4]=function(e){return o.seleccionados=e}),config:o.config},null,8,["columns","data","selected","config"])])])]}),_:1})]}),_:1}),(0,r.bF)(S,{title:"Guardar Registros",modelValue:o.modalCambio,"onUpdate:modelValue":e[9]||(e[9]=function(e){return o.modalCambio=e}),ok:"Grabar",onSubmit:o.grabarRegistro},{default:(0,r.k6)(function(){return[(0,r.Lk)("div",O,[(0,r.Lk)("div",d,[(0,r.bF)(R,{type:"outlined",label:"DURADES",val:"DURACOD",modelValue:o.cambioPeriodo,"onUpdate:modelValue":e[5]||(e[5]=function(e){return o.cambioPeriodo=e}),readonly:!1,placeholder:"Nuevo Periodo",options:o.periodoOpt},null,8,["modelValue","options"])]),(0,r.Lk)("div",C,[(0,r.bF)(N,{class:"col",icon:"calendar"},{default:(0,r.k6)(function(){return[(0,r.bF)(R,{type:"outlined",label:"ANO",val:"ANO",modelValue:o.newAnoDestino,"onUpdate:modelValue":e[6]||(e[6]=function(e){return o.newAnoDestino=e}),readonly:!1,placeholder:"Año Destino",options:o.optAnios},null,8,["modelValue","options"])]}),_:1})]),(0,r.Lk)("div",p,[(0,r.bF)(N,{class:"col",icon:"calendar"},{default:(0,r.k6)(function(){return[(0,r.bF)(T,{class:"q-if-outlined col",modelValue:o.newIni,"onUpdate:modelValue":e[7]||(e[7]=function(e){return o.newIni=e}),format:"DD/MM/YYYY","ok-label":"","float-label":"Fecha Inicio"},null,8,["modelValue"])]}),_:1})]),(0,r.Lk)("div",I,[(0,r.bF)(N,{class:"col",icon:"calendar"},{default:(0,r.k6)(function(){return[(0,r.bF)(T,{class:"q-if-outlined col",modelValue:o.newFin,"onUpdate:modelValue":e[8]||(e[8]=function(e){return o.newFin=e}),format:"DD/MM/YYYY","float-label":"Fecha Fin"},null,8,["modelValue"])]}),_:1})])])]}),_:1},8,["modelValue","onSubmit"])]}),_:1})}var R=n(57008),f=n.n(R),m=n(76080),D=n.n(m),N=n(45254),T=n.n(N),S=(n(71225),n(74260),n(39866),n(52133),n(10239),n(50310),n(5962),n(32203),n(90095),n(6724),n(92802),n(9240),n(11777),n(515),n(83190),n(44264),n(62692),n(7346),n(13715),n(6123)),U=n(30545),E=n(10213),g=n(9736),h=n(16648),P=n(4437),_=n(33777),b=n(93616),v=n(57668),w=n(982),F=n(41615),L=(0,v["default"])(),V={components:{QTable:U.A,QDate:P.A,confirm:E.confirm,alert:E.alert,QInput:g.A,QSelect:h.A,sieTable:_.A,sieSelect:b.A,QDatetime:S.T5,QPageSticky:S._U,constantesTesoreria:F["default"],date:S.p6,QPage:S.Tu,QCardMain:S.d1,QField:S.Om},data:function(){var o=this;return{modalCambio:!1,cambioPeriodo:null,newAnoDestino:String(L.ano),newIni:new Date,newFin:new Date,optAnios:[],seleccionados:[],config:{},columns:[{name:"VACCOD",label:"Código",field:"VACCOD",align:"center",sortable:!0},{name:"CURSODES",label:"Curso",field:"CURSODES",align:"center",sortable:!0},{name:"HORARIO",label:"Horario",field:"HORARIO",align:"center",sortable:!0}],exportRows:[],dataRows:[],periodo:null,ano:L.ano,grupo:"T",anoOpt:[],periodoOpt:[],grupoOpt:[],buttonsDatos:[{icon:"chevron_left",label:"",tooltip:"Quitar",click:function(){var e=o.$refs.exportTable.rowsSelected();o.cambiarRegistros(e,o.exportRows,o.dataRows)}},{icon:"chevron_right",label:"",tooltip:"Agregar",click:function(){var e=o.$refs.sieTable.rowsSelected();o.cambiarRegistros(e,o.dataRows,o.exportRows)}},{icon:"save",label:"Copiar",tooltip:"Copiar Cursos",click:function(e){o.guardar(e)}}]}},methods:{getAnioVac:function(){var o=this;return T()(D()().m(function e(){var n;return D()().w(function(e){while(1)switch(e.n){case 0:return e.n=1,o.$http.get("api/MantenimientoController/getAniovac",{params:{params:{tipo:"",order:{sidx:"ANO",sord:"DESC"}}}});case 1:n=e.v,o.optAnios=n;case 2:return e.a(2)}},e)}))()},cambiarRegistros:function(o,e,n){if(o&&o.length){var r=o.map(function(o){return o.VACCOD});o.forEach(function(o){n.some(function(e){return e.VACCOD===o.VACCOD})||n.push(f()({},o))}),e===this.dataRows?this.dataRows=this.dataRows.filter(function(o){return!r.includes(o.VACCOD)}):this.exportRows=this.exportRows.filter(function(o){return!r.includes(o.VACCOD)})}},cambiaGrupo:function(){var o=this;this.cargarCursos(),this.dataRows=this.dataRows.filter(function(e){return e.GRUVACOD===o.grupo})},cargarCursos:function(){var o=this;return T()(D()().m(function e(){var n,r;return D()().w(function(e){while(1)switch(e.n){case 0:return n="T"===o.grupo?null:o.grupo,e.n=1,o.$http.get("api/CtCursoPeriodoController/getCursoPeriodo",{params:{params:{ano:o.ano,duracod:o.periodo,gruvacod:n}}});case 1:r=e.v,o.dataRows=r;case 2:return e.a(2)}},e)}))()},guardar:function(o){if(!this.exportRows.length>0)return(0,E.alert)("No se ha agregado ningún curso para copiar","warning"),0;this.modalCambio=!0},getParamsTurnoMultiple:function(o){var e=this;return T()(D()().m(function n(){var r,a,t,i,s,l,u,c,O,d,C,p,I,A,R,f,m,N,T,U,E,g,h,P,_,b,v,w,L,V,H,M,k,x,G,B,q;return D()().w(function(n){while(1)switch(n.n){case 0:return n.n=1,e.$http.get("api/CtCursoPeriodoController/getFrecCurso",{params:{params:{where:{ID_CURSO_PERIODO:o.ID_CURSO_PERIODO}}}});case 1:return r=n.v,n.n=2,e.$http.get("api/CtCursoPeriodoController/getPerfilesHabilitados",{params:{params:{where:{ID_CURSO_PERIODO:o.ID_CURSO_PERIODO}}}});case 2:return a=n.v,n.n=3,e.$http.get("api/CtCursoPeriodoController/getTurnos",{params:{params:{where:{ID_CURSO_PERIODO:o.ID_CURSO_PERIODO}}}});case 3:return t=n.v,o.AULACOD=t[0].AULACOD,n.n=4,e.$http.get("api/CtCursoPeriodoController/getHorario",{params:{idCursoPeriodo:o.ID_CURSO_PERIODO}});case 4:return i=n.v,t.map(function(o){o.horarios=i.filter(function(e){return e.TURNO===o.TURNO})}),n.n=5,e.$http.get("api/CtCursoPeriodoController/getCursoCondicion",{params:{idCursoPeriodo:o.ID_CURSO_PERIODO,tipocondicion:o.TIPOCONDICION}});case 5:return s=n.v,l=s.map(function(o){return o.VALOR}),o.CONDICION=l,u=a.map(function(o){return o.ID_PERFIL}),o.HABILITADOS={alumnos:u.includes(F["default"].PERFIL_ALUMNO),externos:u.includes(F["default"].PERFIL_ALUMNO_EXTERNO),trabajadores:u.includes(F["default"].PERFIL_PERSONAL),hijosTrabajadores:u.includes(F["default"].PERFIL_HIJO_PERSONAL)},c=t.map(function(o){var e={turno:o.TURNO,cubiertas:o.CUBIERTAS,vacantes:o.VACANTES,codTurno:o.VACCOD,horaPorDia:Boolean(o.FLAG_HORA_POR_DIA),horaInicio:o.FLAG_HORA_POR_DIA?"":S.p6.formatDate(o.horarios[0].HORAINI,"HH:mm"),horaFin:o.FLAG_HORA_POR_DIA?"":S.p6.formatDate(o.horarios[0].HORAFIN,"HH:mm"),ID_PERSONA:o.ID_PERSONA},n=o.horarios.map(function(o){var e={dia:o.DIA,horaInicio:S.p6.formatDate(o.HORAINI,"HH:mm"),horaFin:S.p6.formatDate(o.HORAFIN,"HH:mm")};return e});return e.horarios=n,e}),o.TURNOS=c,O=[],d=r.reduce(function(o,e){return o[e.ID_FRECUENCIA]||(o[e.ID_FRECUENCIA]=[]),o[e.ID_FRECUENCIA].push(e),o},{}),O=Object.keys(d).map(function(o){var e=d[o],n=e[e.length-1],r=e.reduce(function(o,e){return o[e.ID_PERFIL]=e.MONTO,o},{});return{ID_FRECUENCIA:Number(o),MONTO_FREC:n.MONTO,MONTOS:r}}),o.FREC_DIAS=O,C=o.CONDICION,p=o.TURNOS,I=o.FREC_DIAS,A=o.HABILITADOS,R=o.MONTOCUR,f=o.MONTOCURE,m=o.MONTOCURH,N=o.MONTOCURT,T=o.TIPOCONDICION,U=o.TIPOHORARIO,E=o.FL_ANULACION,g=o.TIPOCOD,h=o.TIPOCOB,P=o.GRUVACOD,_=o.CERRADO,b=o.FECINI,v=o.FECFIN,w=o.CURSODES,L=o.REQUISITOS,V=o.AULACOD,H=o.REGLAMENTO,M=o.UTILES,k=o.CUMPLEANIO,x=o.FLAG_MONTO_TIPO,G=o.FLAG_FREC_DIAS,B=o.FLAG_PAQUETE_FREC,q={CONDICION:C,TURNOS:p,FREC_DIAS:I,HABILITADOS:A,MONTOCUR:R,MONTOCURE:f,MONTOCURH:m,MONTOCURT:N,TIPOCONDICION:T,TIPOHORARIO:U,FL_ANULACION:E,TIPOCOD:g,TIPOCOB:h,GRUVACOD:P,CERRADO:_,FECINI:b,FECFIN:v,CURSODES:w,REQUISITOS:L,AULACOD:V,REGLAMENTO:H,UTILES:M,DURACOD:e.cambioPeriodo,CUMPLEANIO:k,FLAG_MONTO_TIPO:x,FLAG_FREC_DIAS:G,FLAG_PAQUETE_FREC:B},n.a(2,q)}},n)}))()},grabarRegistro:function(){var o=this;return T()(D()().m(function e(){var n,r;return D()().w(function(e){while(1)switch(e.p=e.n){case 0:if(o.cambioPeriodo){e.n=1;break}return(0,w["default"])("Por favor Seleccione un Periodo","error"),e.a(2,0);case 1:return e.p=1,n={ID_CONSTANTE:[F["default"].CONSTANTES_SISTEMA.T_NUEVA_VISTA_INSCRIPCION]},e.n=2,F["default"].API_CONSTANTES_SISTEMAS(n);case 2:r=e.v,o.exportRows.map(function(){var e=T()(D()().m(function e(n){var a,t,i,s,l,u,c,O,d,C,p,I,A,R,f,m,N,T,S,U,E,g,h,P,_,b,v,F,L,V,H,M,k,x;return D()().w(function(e){while(1)switch(e.n){case 0:return e.n=1,o.getParamsTurnoMultiple(n);case 1:if(a=e.v,t=a.TURNOS,!r.T_NUEVA_VISTA_INSCRIPCION){e.n=4;break}return i=1===n.TURNOS.length&&n.TURNOS.find(function(o){return 0===o.turno}),i&&(n.HABILITADOS.alumnos=!!n.MONTOCUR||n.HABILITADOS.alumnos,n.HABILITADOS.externos=!!n.MONTOCURE||n.HABILITADOS.externos,n.HABILITADOS.hijosTrabajadores=!!n.MONTOCURH||n.HABILITADOS.hijosTrabajadores,n.HABILITADOS.trabajadores=!!n.MONTOCURT||n.HABILITADOS.trabajadores,n.TURNOS.map(function(o,e){o.turno=e+1})),String(o.ano)!==o.newAnoDestino&&(a.anoDestino=o.newAnoDestino),a.anoOrigen=String(o.ano),e.n=2,o.$http.post("api/CtCursoPeriodoController/postNuevoCtCursoPeriodo",{data:a});case 2:return(0,w["default"])("El curso fue copiado satisfactoriamente","success"),e.n=3,o.cargarCursos();case 3:return o.exportRows=[],o.modalCambio=!1,e.a(2,1);case 4:if(r.T_NUEVA_VISTA_INSCRIPCION||!(t.length>1)){e.n=5;break}return o.$notify("El curso tiene 2 o más turnos, por favor active la nueva vista de talleres","warning"),e.a(2);case 5:return s=n.TIPOCONDICION,l=n.TIPOHORARIO,u=n.TIPOCOD,c=n.CURSODES,O=n.TIPOCOB,d=n.GRUVACOD,C=n.AULACOD,p=n.ID_PERSONA,I=n.ID_CURSO,A=n.ID_CURSO_PERIODO,R=n.TURNO,f=n.CERRADO,m=n.MONTOCUR,N=n.VACANTES,T=n.MONTOCURE,S=n.MONTOCURT,U=n.MONTOCURH,E=n.REQUISITOS,g=n.DISPONIBLES,h=n.FL_ANULACION,P=n.CUMPLEANIO,_=[],b=JSON.parse(n.HORARIOJSON),e.n=6,o.$http.get("api/CtCursoPeriodoController/getCursoCondicion",{params:{idCursoPeriodo:A,turno:R,tipocondicion:s}});case 6:for(H in v=e.v,F=v.map(function(o){return o.VALOR}),L=o.newIni,V=o.newFin,b)M=b[H],k={horaini:M.HORAINI,horafin:M.HORAFIN,DIA:parseInt(H)},_.push(k);return x={TIPOCONDICION:s,TIPOHORARIO:l,TIPOCOD:u,CURSODES:c,TIPOCOB:O,GRUVACOD:d,AULACOD:C,ID_PERSONA:p,ID_CURSO:I,CERRADO:f,MONTOCUR:m,VACANTES:N,MONTOCURE:T,MONTOCURT:S,MONTOCURH:U,FECINI:L,FECFIN:V,REQUISITOS:E,DURACOD:o.cambioPeriodo,DISPONIBLES:g,FL_ANULACION:h,CUMPLEANIO:P,HORARIO:_,CONDICION:F},String(o.ano)!==o.newAnoDestino&&(x.anoDestino=o.newAnoDestino),e.n=7,o.$http.post("api/CtCursoPeriodoController/addCtCursoPeriodo",{data:x});case 7:(0,w["default"])("El Proceso se realizo Satisfactoriamente","success"),o.modalCambio=!1,o.cargarCursos(),o.exportRows=[];case 8:return e.a(2)}},e)}));return function(o){return e.apply(this,arguments)}}()),e.n=4;break;case 3:e.p=3,e.v,(0,w["default"])("Ocurrio un error al hacer las copias","warning");case 4:return e.a(2)}},e,null,[[1,3]])}))()},cargarCombos:function(){var o=this;return T()(D()().m(function e(){return D()().w(function(e){while(1)switch(e.n){case 0:return e.n=1,o.$http.get("api/InscripcionController/getPeriodo",{params:{params:{activo:0}}});case 1:return o.periodoOpt=e.v,e.n=2,o.$http.get("api/GrupovacController/getGrupovac");case 2:return o.grupoOpt=e.v,o.periodoOpt.map(function(e){"S"===e.VIGENTE&&(o.periodo=e.DURACOD)}),o.grupoOpt.push({GRUVACOD:"T",GRUVADES:"Todos"}),e.n=3,o.getAnioVac();case 3:return e.a(2)}},e)}))()}},computed:{permiso:function(){return this.sie.ruta.nivel}},created:function(){var o=this;return T()(D()().m(function e(){return D()().w(function(e){while(1)switch(e.n){case 0:return o.ano=L.ano.toString(),e.n=1,o.cargarCombos();case 1:return e.n=2,o.cargarCursos();case 2:return e.a(2)}},e)}))()}},H=n(12807);const M=(0,H.A)(V,[["render",A]]);var k=M}}]);