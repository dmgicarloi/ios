"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[95427],{95427:function(n,a,e){e.r(a),e.d(a,{default:function(){return N}});var i=e(61758),t={class:"row q-pa-sm q-col-gutter-sm"},o={class:"col-xs-12 col-sm-3"},r={class:"row"},s={class:"col-12"},c={class:"col-xs-12 col-sm-12 col-md-3 scroll",style:{width:"100%",height:"calc(100vh - 150px)"}},d={class:"col-xs-12 col-sm-9"},l={class:"row"},u={class:"col-12"},g={class:"col-12"},f={class:"row"},v={class:"col-12 sie-flat"};function p(n,a){var e=this,p=(0,i.g2)("header-btn"),w=(0,i.g2)("tree-unidad-organizativa"),m=(0,i.g2)("sie-table"),h=(0,i.g2)("q-card-section"),U=(0,i.g2)("q-card"),b=(0,i.g2)("sie-modal"),O=(0,i.g2)("q-page");return(0,i.uX)(),(0,i.Wv)(O,{class:"q-pa-sm intranet-unidade-organizativa-personal sie-flat"},{default:(0,i.k6)(function(){return[(0,i.bF)(U,{flat:""},{default:(0,i.k6)(function(){return[(0,i.bF)(h,null,{default:(0,i.k6)(function(){return[(0,i.Lk)("div",t,[(0,i.Lk)("div",o,[(0,i.Lk)("div",r,[(0,i.Lk)("div",s,[(0,i.bF)(p,{name:"Unidad ".concat(n.$q.screen.width<=815?"Org.":"Organizativa"),"font-size":"15px"},null,8,["name"])]),(0,i.Lk)("div",c,[(0,i.bF)(w,{ref:"unidadesOrganizativa",onSelected:n.selectUnidadOrganizativa},null,8,["onSelected"])])])]),(0,i.Lk)("div",d,[(0,i.Lk)("div",l,[(0,i.Lk)("div",u,[!0===n.isLogged?((0,i.uX)(),(0,i.Wv)(p,{key:0,auto:!1,name:"Usuarios Asignados",size:"8px",buttons:n.buttons,"font-size":"15px"},null,8,["buttons"])):((0,i.uX)(),(0,i.Wv)(p,{key:1,auto:!1,name:"Usuarios Asignados",size:"8px",buttons:n.buttonsLogin,"font-size":"15px"},null,8,["buttons"]))]),(0,i.Lk)("div",g,[(0,i.bF)(m,{data:n.rowsDocentesConIdUnidadOrganizativa,columns:n.fieldsDocentesConIdUnidadOrganizativa,config:n.configDocentesConIdUnidadOrganizativa,css:"height: calc(100vh - 150px)",context:e},null,8,["data","columns","config"])])])])])]}),_:1})]}),_:1}),(0,i.bF)(b,{modelValue:n.openModalPersonal,"onUpdate:modelValue":a[0]||(a[0]=function(a){return n.openModalPersonal=a}),"esc-click":"",title:"Usuarios SieWeb",onSubmit:n.saveDocentes},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",f,[(0,i.Lk)("div",v,[(0,i.bF)(m,{ref:"refPersonal",selection:"multiple",data:n.rowsDocentesSinIdUnidadOrganizativa,columns:n.fieldsDocentesSinIdUnidadOrganizativa,config:n.configDocentesSinIdUnidadOrganizativa,css:"height: 350px",context:e},null,8,["data","columns","config"])])])]}),_:1},8,["modelValue","onSubmit"])]}),_:1})}var w=e(76080),m=e.n(w),h=e(45254),U=e.n(h),b=(e(10239),e(6123)),O=e(88567),z=e(95718),k=e(11654),C=e(95655),I=e(81288),S=(e(30683),{data:function(){return{configDocentesConIdUnidadOrganizativa:{ACCION:{component:"button",icon:["delete"],flat:!0,dense:!0,tooltip:{delete:"Retirar"},delete:function(n){var a=this;return U()(m()().m(function e(){var i,t;return m()().w(function(e){while(1)switch(e.p=e.n){case 0:return e.p=0,e.n=1,a.$confirmar("¿Realmente desea retirar a <b>".concat(n.USUNOM,"</b> de <b>").concat(a.rowDocentesConIdUnidadOrganizativa.orgUnitPath,"</b>?"),"delete",!0);case 1:if(i=e.v,!i){e.n=3;break}return t=[n.USUCOD],e.n=2,a.$http.put("api/HyoProfes/updateProfe",{idUnidadOrganizativa:null,usucods:t});case 2:return e.n=3,a.readDocentesConIdUnidadOrganizativa();case 3:e.n=5;break;case 4:e.p=4,e.v,a.$notify("No ha sido posible quitar este registro","warning");case 5:return e.a(2)}},e,null,[[0,4]])}))()}}},rowsDocentesConIdUnidadOrganizativa:[],fieldsDocentesConIdUnidadOrganizativa:[{name:"USUNOM",label:"Nombres",field:"USUNOM",align:"left"},{name:"ACCION",label:"Acción",field:"ACCION",align:"center"}]}}}),D={data:function(){return{configDocentesSinIdUnidadOrganizativa:{},rowsDocentesSinIdUnidadOrganizativa:[],fieldsDocentesSinIdUnidadOrganizativa:[{name:"USUNOM",label:"Nombres",field:"USUNOM",align:"left"}]}}},A={data:function(){return{configAlumnosSinIdUnidadOrganizativa:{},rowsAlumnosSinIdUnidadOrganizativa:[],fieldsAlumnosSinIdUnidadOrganizativa:[{name:"NOMCOMP",label:"Nombres",field:"NOMCOMP",align:"left"}]}}},L=e(30640),$=e(49723),y={components:{treeUnidadOrganizativa:$.A,sieModal:L.A,QCard:O.A,QCardSection:z.A,QBtn:k.A,QPage:b.Tu},mixins:[S,D,A],data:function(){return{buttons:[{label:"Agregar",icon:"plus",click:this.openPersonal},{label:"Cerrar Sesión",icon:"account_lock",click:this.cerrarSesionAdmin}],buttonsLogin:[{label:"Iniciar Sesión",icon:"vpn_key",click:this.login}],rowDocentesConIdUnidadOrganizativa:null,selected:"",openModalPersonal:!1,isLogged:!1}},methods:{cerrarSesionAdmin:function(){var n=this;return U()(m()().m(function a(){var e,i,t;return m()().w(function(a){while(1)switch(a.p=a.n){case 0:return a.p=0,a.n=1,n.$http.post("api/HyoLoginGoogleAdmin/cerrarSesionAdmin");case 1:e=a.v,i=e.message,n.$notify(i,"success"),n.$router.push({name:"intranet.muro"}),n.isLogged=!1,a.n=3;break;case 2:a.p=2,t=a.v,n.$notify(t.message,"warning");case 3:return a.a(2)}},a,null,[[0,2]])}))()},selectUnidadOrganizativa:function(n){this.rowDocentesConIdUnidadOrganizativa=n,this.readDocentesConIdUnidadOrganizativa()},saveDocentes:function(){var n=this;return U()(m()().m(function a(){var e,i;return m()().w(function(a){while(1)switch(a.p=a.n){case 0:return a.p=0,n.$q.loading.show(),e=n.$refs.refPersonal.rowsSelected(["USUCOD"]),i=n.rowDocentesConIdUnidadOrganizativa.orgUnitPath,a.n=1,n.$http.put("api/HyoProfes/updateProfe",{idUnidadOrganizativa:i,usucods:e});case 1:return a.n=2,n.readDocentesConIdUnidadOrganizativa();case 2:n.openModalPersonal=!1,a.n=4;break;case 3:a.p=3,a.v;case 4:n.$q.loading.hide();case 5:return a.a(2)}},a,null,[[0,3]])}))()},openPersonal:function(){var n=this;return U()(m()().m(function a(){var e,i;return m()().w(function(a){while(1)switch(a.n){case 0:if(n.rowDocentesConIdUnidadOrganizativa){a.n=1;break}return n.$notify("Debe seleccionar una unidad organizativa.","info"),a.a(2);case 1:return a.n=2,n.$http.get("api/HyoProfes/obtListadoProfecActivos",{params:{hasUnidadOrganizativa:!1}});case 2:e=a.v,i=e.json,n.rowsDocentesSinIdUnidadOrganizativa=i||[],n.openModalPersonal=!0;case 3:return a.a(2)}},a)}))()},readDocentesConIdUnidadOrganizativa:function(){var n=this;return U()(m()().m(function a(){var e;return m()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,n.$http.get("api/HyoUsuario/obtListadoUsuariosActivos",{params:{idUnidadOrganizativa:n.rowDocentesConIdUnidadOrganizativa.orgUnitPath}});case 1:e=a.v,n.rowsDocentesConIdUnidadOrganizativa=e||[];case 2:return a.a(2)}},a)}))()},login:function(){var n=this;return U()(m()().m(function a(){var e;return m()().w(function(a){while(1)switch(a.p=a.n){case 0:return a.p=0,delete window.localStorage._apiGoogle,n.isLogged=!1,a.n=1,n.$http.post("api/HyoLoginGoogleAdmin/login");case 1:e=a.v,"string"===typeof e?(0,C["default"])(e,"_system",500,500):(n.$refs.unidadesOrganizativa.getAllOrgunits(),n.isLogged=!0),a.n=3;break;case 2:a.p=2,a.v,n.$notify("Intentalo nuevamente.","warning");case 3:return a.a(2)}},a,null,[[0,2]])}))()}},created:function(){var n=this;return U()(m()().m(function a(){return m()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,n.login();case 1:window.currentSieCloud=!1,(0,I.watchAuth2)(["_apiGoogle"],function(){var a=U()(m()().m(function a(e,i){var t,o,r,s;return m()().w(function(a){while(1)switch(a.p=a.n){case 0:r=i,a.n="_apiGoogle"===r?1:6;break;case 1:return n.$q.loading.show(),a.p=2,a.n=3,n.$http.post("api/HyoLoginGoogleAdmin/guardarCodigo",{codigo:e});case 3:t=a.v,n.$refs.unidadesOrganizativa.getAllOrgunits(),n.isLogged=!0,n.$notify(t.message,"success"),a.n=5;break;case 4:a.p=4,s=a.v,o=s.error||{},n.$notify(o.msg||o.message||"No ha sido posible iniciar sesión","warning");case 5:return n.$q.loading.hide(),a.a(3,6);case 6:return a.a(2)}},a,null,[[2,4]])}));return function(n,e){return a.apply(this,arguments)}}());case 2:return a.a(2)}},a)}))()},unmounted:function(){window.callback&&window.removeEventListener("storage",window.callback.cb)},beforeCreate:function(){window.callback&&window.removeEventListener("storage",window.callback.cb)}},P=e(12807);const M=(0,P.A)(y,[["render",p]]);var N=M}}]);