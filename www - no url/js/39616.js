"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[39616],{39616:function(a,e,o){o.r(e),o.d(e,{default:function(){return R}});var t=o(61758),n=o(58790),s={class:"row q-card"},l={class:"row"},i={class:"q-pa-xs"},r={key:0},c={key:1},u={class:"col"},d={class:"col row justify-around"};function f(a,e){var o=(0,t.g2)("sie-salones"),f=(0,t.g2)("q-datetime"),m=(0,t.g2)("q-toggle"),p=(0,t.g2)("q-td"),h=(0,t.g2)("q-tooltip"),g=(0,t.g2)("q-icon"),b=(0,t.g2)("q-btn"),v=(0,t.g2)("q-table"),k=(0,t.g2)("q-radio"),A=(0,t.g2)("sie-modal"),E=(0,t.g2)("q-item"),O=(0,t.g2)("q-list"),D=(0,t.g2)("q-page-sticky"),C=(0,t.g2)("q-page");return(0,t.uX)(),(0,t.Wv)(C,null,{default:(0,t.k6)(function(){return[(0,t.Lk)("div",s,[(0,t.bF)(o,{class:"col",modelValue:a.nemo,"onUpdate:modelValue":e[0]||(e[0]=function(e){return a.nemo=e}),onSeleccionar:a.loadEstudiantes,label:a.$t("salon"),campos:["NEMO","NEMODES","INSTRUCOD","GRADOCOD","SECCIONCOD"],todos:!1},null,8,["modelValue","onSeleccionar","label"]),(0,t.bF)(f,{class:"q-if-outlined",modelValue:a.fecha,"onUpdate:modelValue":e[1]||(e[1]=function(e){return a.fecha=e}),type:"date","stack-label":a.$t("fecha"),format:"DD/MM/YYYY",onInput:a.loadEstudiantes},null,8,["modelValue","stack-label","onInput"]),(0,t.bF)(m,{class:"q-mx-sm",modelValue:a.sinRegistro,"onUpdate:modelValue":e[2]||(e[2]=function(e){return a.sinRegistro=e}),label:"Sin registrar",color:"secondary","true-value":0,"false-value":1,onInput:a.filtrar},null,8,["modelValue","onInput"])]),(0,t.bF)(v,{class:"col q-card q-ma-sm","table-style":"max-height: 80vh;min-height: 40vh",data:a.dataShow,columns:a.tablaAsistencia.columns,pagination:a.tablaAsistencia.paginacion,"onUpdate:pagination":e[3]||(e[3]=function(e){return a.tablaAsistencia.paginacion=e}),"hide-bottom":""},{"body-cell-ESTADOCOD":(0,t.k6)(function(a){return[(0,t.bF)(p,{class:"q-py-none",props:a},{default:(0,t.k6)(function(){return[(0,t.Lk)("div",l,[(0,t.Lk)("span",{class:"q-pa-xs",style:(0,n.Tr)({"background-color":a.row.COLORHEXF})},(0,n.v_)(a.row.ESTADOETI),5),(0,t.Lk)("span",i,(0,n.v_)(a.row.ESTADODES),1)])]}),_:2},1032,["props"])]}),"body-cell-HORA":(0,t.k6)(function(e){return[(0,t.bF)(p,{class:"q-py-none",props:e},{default:(0,t.k6)(function(){return[e.row.HORA?((0,t.uX)(),(0,t.CE)("span",r,(0,n.v_)(a.date(e.row.HORA,"hh:mm A")),1)):((0,t.uX)(),(0,t.CE)("span",c,(0,n.v_)(e.row.TIPREG),1)),e.row.HORA?((0,t.uX)(),(0,t.Wv)(g,{key:2,name:"info"},{default:(0,t.k6)(function(){return[(0,t.bF)(h,{class:"column"},{default:(0,t.k6)(function(){return[(0,t.Lk)("div",null,[(0,t.Lk)("span",null,"Fecha de Registro: "+(0,n.v_)(a.date(e.row.FECREG,"DD/MM/YYYY hh:mm:ss A")),1)]),(0,t.Lk)("span",null,"Usuario Registro: "+(0,n.v_)(e.row.USUCODREG),1)]}),_:2},1024)]}),_:2},1024)):(0,t.Q3)("v-if",!0)]}),_:2},1032,["props"])]}),"body-cell-ENVIAR":(0,t.k6)(function(e){return[(0,t.bF)(p,{class:"q-py-none",props:e},{default:(0,t.k6)(function(){return[1===a.sinRegistro?((0,t.uX)(),(0,t.Wv)(b,{key:0,flat:"",round:"",icon:"send",onClick:function(o){return a.enviarMsg([e.row.ALUCOD])}},{default:(0,t.k6)(function(){return[(0,t.bF)(h,null,{default:(0,t.k6)(function(){return[(0,t.eW)((0,n.v_)(a.$t("botones.enviar")),1)]}),_:1})]}),_:1},8,["onClick"])):(0,t.Q3)("v-if",!0)]}),_:2},1032,["props"])]}),_:1},8,["data","columns","pagination"]),(0,t.bF)(A,{modelValue:a.modalProcesar,"onUpdate:modelValue":e[5]||(e[5]=function(e){return a.modalProcesar=e}),title:"Procesar Asistencia",header:!0,noClose:a.cargando,loading:a.cargando,onSubmit:a.procesarAsistencias},{default:(0,t.k6)(function(){return[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(a.estados,function(o){return(0,t.uX)(),(0,t.CE)("div",{key:o.ESTADOCOD,class:"q-ma-sm"},[(0,t.Lk)("div",u,[(0,t.bF)(k,{class:"col",modelValue:a.estadoProcesar,"onUpdate:modelValue":e[4]||(e[4]=function(e){return a.estadoProcesar=e}),val:o.ESTADOCOD},{default:(0,t.k6)(function(){return[(0,t.eW)((0,n.v_)(o.ESTADODES),1)]}),_:2},1032,["modelValue","val"])])])}),128))]}),_:1},8,["modelValue","noClose","loading","onSubmit"]),(0,t.bF)(A,{modelValue:a.modalImprimir,"onUpdate:modelValue":e[7]||(e[7]=function(e){return a.modalImprimir=e}),title:"Imprimir Reportes",footer:!1,ok:!1},{default:(0,t.k6)(function(){return[(0,t.Lk)("div",d,[(0,t.bF)(O,{class:"col-6 column",separator:""},{default:(0,t.k6)(function(){return[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(a.listaReportes,function(o){return(0,t.uX)(),(0,t.Wv)(E,{key:o.id},{default:(0,t.k6)(function(){return[(0,t.bF)(k,{modelValue:a.reporteData.repcod,"onUpdate:modelValue":e[6]||(e[6]=function(e){return a.reporteData.repcod=e}),val:o.id,label:o.value,color:"secondary"},null,8,["modelValue","val","label"])]}),_:2},1024)}),128))]}),_:1}),e[9]||(e[9]=(0,t.Lk)("div",{class:"col-5"},[(0,t.Lk)("div",{class:"row"},[(0,t.Lk)("div",{class:"col-5"})])],-1))])]}),_:1},8,["modelValue"]),0===a.sinRegistro&&a.nemo?((0,t.uX)(),(0,t.Wv)(D,{key:0,position:"bottom-right",offset:[20,20]},{default:(0,t.k6)(function(){return[(0,t.bF)(b,{color:"secondary",icon:"cog",onClick:e[8]||(e[8]=function(e){return a.modalProcesar=!0}),fab:""})]}),_:1})):(0,t.Q3)("v-if",!0)]}),_:1})}o(10239),o(50310),o(90095),o(83190),o(13715);var m=o(6123),p=o(80660),h=o(57668),g=o(80340),b=o(88275),v=o(33001),k=o(30640),A=o(93616),E=o(24974),O=o(18105),D=o(982),C={components:{QSelect:m.Si,sieUsuario:E.A,sieModal:k.A,sieVacio:g.A,QToggle:m.c5,QCheckbox:m.vZ,QBtnToggle:m.QL,sieSelect:A.A,QRadio:m.$,QTabs:m.uw,QTab:m.zu,QTabPane:m.dg,sieSalones:b.Ay,QDatetime:m.T5,QTable:m.kH,QTh:m.EJ,QTr:m.qh,QTd:m.Ef,QPageSticky:m._U,QFab:m.l6,QFabAction:m.B$,QPage:m.Tu,QIcon:m.bP,QTooltip:m.nC,QBtn:m.Il,QList:m.Mb,QItem:m.H0},data:function(){return{now:new Date,sie:(0,h["default"])(),cargando:!1,nemo:null,fecha:new Date,estados:[],sinRegistro:1,modalProcesar:!1,tabs:[{id:"calendario",label:"Calendario",icono:"calendar_check_o"},{id:"horario",label:"Horarios de Asistencia",icono:"calendar_today"}],dataBase:[],dataShow:[],estadoProcesar:null,tablaAsistencia:{columns:[{name:"NOMCOMP",field:"NOMCOMP",align:"left",label:this.$t("estudiante")},{name:"ESTADOCOD",field:"ESTADOCOD",align:"left",label:this.$t("estado")},{name:"HORA",field:"HORA",align:"left",label:this.$t("hora")},{name:"ENVIAR",field:"ENVIAR",align:"CENTER"}],paginacion:{page:1,rowsPerPage:40}},modalImprimir:!1,repcod:"1",listaReportes:[]}},methods:{date:O.Ay,loadEstudiantes:function(){var a=this;if(this.fecha&&this.nemo){var e={fecha:this.fecha,nemo:this.nemo};p.$http.get("api/HyoHorasis/obtAsistenciaFecha",{params:e}).then(function(e){var o=e.json;a.dataBase=o,a.filtrar()})}},filtrar:function(){this.dataShow=(0,v.filterArray)(this.sinRegistro,{field:"REGISTRADO",list:this.dataBase||[]})},enviarMsg:function(a){var e=this;this.cargando=!0;var o={fecha:this.fecha,alucods:a,reenvio:"S"};p.$http.get("api/HyoHorasis/enviarAlerta",{params:o}).then(function(a){var o=a.json,t="m0019"===o?"success":"error";(0,D["default"])(e.$t("mensajes."+o),t),e.cargando=!1})},procesarAsistencias:function(){var a=this,e=[];if(this.estadoProcesar){var o=this.dataShow[0].BIMECOD;this.dataShow.forEach(function(a){e.push(a.ALUCOD)});var t={alucods:e,fecha:this.fecha,estado:this.estadoProcesar,nemo:this.nemo,bimecod:o};p.$http.get("api/HyoHorasis/procesarAsistenciaBloque",{params:t}).then(function(o){var t=o.json;(0,D["default"])(a.$t("regAsistencia."+t)),"m0000"===t&&p.$http.get("api/HyoHorasis/enviarAlerta",{params:{alucods:e,fecha:new Date(a.fecha)}}).then(function(e){e.json;a.modalProcesar=!1,a.loadEstudiantes()})})}}},watch:{},created:function(){var a=this;p.$http.get("api/HyoHorasisEstado/listarHorasisEstado",{params:{momento:1}}).then(function(e){var o=e.json;a.estados=o})}},y=o(12807);const S=(0,y.A)(C,[["render",f]]);var R=S}}]);