"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[10645],{10645:function(e,t,n){n.r(t),n.d(t,{default:function(){return ae}});var o=n(8445),i=n.n(o),a=n(61758),s=n(58790),r={class:"row q-col-gutter-sm"},l={class:"col-xs-4 col-sm-6 col-md-1 q-mt-xs"},c={class:"col-xs-4 col-sm-6 col-md-2 q-mt-xs"},u={key:0,class:"col-xs-4 col-md-2"},d={key:1,class:"col-xs-6 col-sm-6 col-md-2"},m={key:2,class:"col-xs-6 col-sm-6 col-md-2"},A={key:3,class:"col-xs-6 col-sm-6 col-md-2"},p={key:4,class:"col-xs-12 text-right"},f={key:5,class:"col-xs-12"},h={key:6,class:"col-xs-12"},I={key:1,class:"scroll-y column col relative-position",style:{"max-height":"68vh"}},b={class:"row"},g={class:"col-xs-12"},D={class:"text-grey q-caption"},S={class:"row q-pa-sm"},C={class:"col-12 q-pl-sm"},v={key:0,class:"col-12 q-pl-sm q-pt-sm"},O={style:{"font-size":"1.2rem","font-weight":"700"}},E={class:"col-12 q-pa-sm"},T={class:"row q-pa-lg"};function k(e,t){var n=this,o=(0,a.g2)("header-btn"),k=(0,a.g2)("q-spinner-oval"),F=(0,a.g2)("q-inner-loading"),R=(0,a.g2)("q-select"),_=(0,a.g2)("sie-select"),w=(0,a.g2)("sie-table"),N=(0,a.g2)("q-item-tile"),y=(0,a.g2)("q-btn"),P=(0,a.g2)("q-item-side"),V=(0,a.g2)("q-item-main"),U=(0,a.g2)("q-item"),x=(0,a.g2)("sie-usuario"),M=(0,a.g2)("q-tooltip"),q=(0,a.g2)("q-input"),Q=(0,a.g2)("q-popover"),L=(0,a.g2)("q-chip"),$=(0,a.g2)("q-list"),B=(0,a.g2)("q-card-section"),H=(0,a.g2)("q-card"),W=(0,a.g2)("tooltip-asistencia"),j=(0,a.g2)("sie-modal"),X=(0,a.g2)("q-radio"),z=(0,a.g2)("q-page");return(0,a.uX)(),(0,a.Wv)(z,null,{default:(0,a.k6)(function(){return[(0,a.bF)(H,null,{default:(0,a.k6)(function(){return[(0,a.bF)(o,{name:"Control de Asistencia por Curso",buttons:e.buttons},null,8,["buttons"]),(0,a.bF)(B,null,{default:(0,a.k6)(function(){return[(0,a.bF)(F,null,{default:(0,a.k6)(function(){return[(0,a.bF)(k,{size:"50px",color:"primary"})]}),_:1}),(0,a.Lk)("div",r,[(0,a.Lk)("div",l,[(0,a.bF)(R,{modelValue:e.diames,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.diames=t}),options:e.diamesOptions,label:"por"},null,8,["modelValue","options"])]),(0,a.Lk)("div",c,[(0,a.bF)(R,{modelValue:e.periodo,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.periodo=t}),options:e.periodos,label:"Periodo","option-value":"DURACOD","option-label":"DURADES",onInput:e.cambiaPeriodo},null,8,["modelValue","options","onInput"])]),(0,a.Lk)("div",{class:(0,s.C4)(["q-mt-xs",e.currentRow.NUMTURNOS>1&&e.showFilterDeudas?"col-xs-12 col-sm-12 col-md-3":"col-xs-12 col-sm-12 col-md-5"]),style:{padding:"3px"}},[(0,a.bF)(_,{class:"q-mb-sm",modelValue:e.cursocod,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.cursocod=t}),type:"outlined",options:e.cursos,label:"CURSODES",val:"VACCOD",onSelected:e.cambiarCurso,placeholder:"Curso","no-bottom":""},null,8,["modelValue","options","onSelected"])],2),e.currentRow.NUMTURNOS>1?((0,a.uX)(),(0,a.CE)("div",u,[(0,a.bF)(_,{type:"outlined",modelValue:e.vaccod,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.vaccod=t}),val:"VACCOD",label:"TURNODES",options:e.optTurnos,readonly:!1,placeholder:"Turno",onSelected:e.cambiarTurno},null,8,["modelValue","options","onSelected"])])):(0,a.Q3)("v-if",!0),"D"===e.diames?((0,a.uX)(),(0,a.CE)("div",d,[(0,a.bF)(_,{class:"q-mb-sm",modelValue:e.fecha,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.fecha=t}),type:"outlined",options:e.diasConclases,label:"label",val:"fecha",onInput:e.cambiarFecha,placeholder:"fecha","no-bottom":""},null,8,["modelValue","options","onInput"])])):((0,a.uX)(),(0,a.CE)("div",m,[(0,a.bF)(_,{class:"q-mb-sm",modelValue:e.mes,"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.mes=t}),type:"outlined",options:e.optionMeses,label:"label",val:"value",onInput:e.cambiaMes,placeholder:"Mes","no-bottom":""},null,8,["modelValue","options","onInput"])])),e.showFilterDeudas?((0,a.uX)(),(0,a.CE)("div",A,[(0,a.bF)(_,{class:"q-mb-sm",modelValue:e.deuda,"onUpdate:modelValue":t[6]||(t[6]=function(t){return e.deuda=t}),type:"outlined",options:e.optDeudas,label:"label",val:"value",onInput:e.cambiarDeuda,placeholder:"deuda","no-bottom":""},null,8,["modelValue","options","onInput"])])):(0,a.Q3)("v-if",!0),e.showFilterDeudas?((0,a.uX)(),(0,a.CE)("div",p,i()(t[16]||(t[16]=[(0,a.Lk)("div",{class:"row justify-end"},[(0,a.Lk)("div",{class:"col-xs-12"},[(0,a.Lk)("div",{class:"bg-deuda",style:{width:"8px",height:"8px",margin:"0 5px",display:"inline-table"}}),(0,a.Lk)("span",{class:"text-deuda q-caption"},"Tiene deuda")])],-1)])))):(0,a.Q3)("v-if",!0),"M"===e.diames?((0,a.uX)(),(0,a.CE)("div",f,[(0,a.bF)(w,{selection:"single",context:n,css:"height:calc(100vh - 140px)",search:"Buscar Alumno",columns:e.columns,data:e.rows,config:e.config},null,8,["columns","data","config"])])):((0,a.uX)(),(0,a.CE)("div",h,[(0,a.bF)($,{class:"q-py-none no-border full-width"},{default:(0,a.k6)(function(){return[e.isFamAlu?(0,a.Q3)("v-if",!0):((0,a.uX)(),(0,a.Wv)(U,{key:0},{default:(0,a.k6)(function(){return[(0,a.bF)(P,{class:"cursor-pointer",onClick:t[7]||(t[7]=function(t){return e.acceso?e.cambiarEstadosAll():null})},{default:(0,a.k6)(function(){return["-"==e.iconoAll.ESTADO?((0,a.uX)(),(0,a.Wv)(N,{key:0,icon:e.iconoAll.icon,color:e.iconoAll.colorvue},null,8,["icon","color"])):((0,a.uX)(),(0,a.Wv)(y,{key:1,class:"q-mr-xs",size:"sm",style:(0,s.Tr)({background:e.iconoAll.color,color:"#000"}),label:e.iconoAll.ESTADO,flat:""},null,8,["style","label"]))]}),_:1}),(0,a.bF)(V,{class:"col cursor-pointer"},{default:(0,a.k6)(function(){return[(0,a.bF)(N,null,{default:(0,a.k6)(function(){return[(0,a.eW)((0,s.v_)(e.iconoAll.descripcion),1)]}),_:1})]}),_:1}),(0,a.bF)(P,{right:""},{default:(0,a.k6)(function(){return[(0,a.bF)(N,{class:"text-primary"},{default:(0,a.k6)(function(){return[(0,a.eW)("hora: "+(0,s.v_)(e.horaActual),1)]}),_:1})]}),_:1})]}),_:1})),e.fecha?((0,a.uX)(),(0,a.CE)("div",I,[(0,a.bF)($,null,{default:(0,a.k6)(function(){return[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.rows,function(t,n){return(0,a.uX)(),(0,a.Wv)(U,{key:n,class:(0,s.C4)({"bg-deuda":e.showFilterDeudas&&t.TIENEDEUDA,"bg-sin-deuda":e.showFilterDeudas&&!t.TIENEDEUDA})},{default:(0,a.k6)(function(){return[(0,a.bF)(P,null,{default:(0,a.k6)(function(){return[(0,a.bF)(N,null,{default:(0,a.k6)(function(){return[(0,a.bF)(x,{alucod:t.ALUCOD},null,8,["alucod"])]}),_:2},1024)]}),_:2},1024),(0,a.bF)(V,null,{default:(0,a.k6)(function(){return[(0,a.bF)(N,{class:"row"},{default:(0,a.k6)(function(){return[(0,a.Lk)("span",null,(0,s.v_)(t.NOMCOMP_ALUMNO),1)]}),_:2},1024)]}),_:2},1024),"-"!==t.ASISTENCIADIARIA.ESTADO?((0,a.uX)(),(0,a.Wv)(P,{key:0},{default:(0,a.k6)(function(){return[(0,a.bF)(N,{class:"cursor-pointer",icon:"comment",color:t.ASISTENCIADIARIA.OBSERVACION?"secondary":"light"},{default:(0,a.k6)(function(){return[t.ASISTENCIADIARIA.OBSERVACION?((0,a.uX)(),(0,a.Wv)(M,{key:0,anchor:"bottom middle",self:"top middle"},{default:(0,a.k6)(function(){return[(0,a.eW)((0,s.v_)(t.ASISTENCIADIARIA.OBSERVACION),1)]}),_:2},1024)):(0,a.Q3)("v-if",!0)]}),_:2},1032,["color"]),e.isFamAlu?(0,a.Q3)("v-if",!0):((0,a.uX)(),(0,a.Wv)(Q,{key:0,style:{"min-width":"400px","overflow-y":"hidden"}},{default:(0,a.k6)(function(){return[(0,a.bF)(q,{class:"q-if-outlined no-bottom",type:"textarea",modelValue:t.ASISTENCIADIARIA.OBSERVACION,"onUpdate:modelValue":function(e){return t.ASISTENCIADIARIA.OBSERVACION=e},"float-label":"Observación"},null,8,["modelValue","onUpdate:modelValue"])]}),_:2},1024))]}),_:2},1024)):(0,a.Q3)("v-if",!0),(0,a.bF)(P,{class:"text-center cursor-pointer",onClick:function(n){return e.cambiarEstado(t)},style:{position:"relative"}},{default:(0,a.k6)(function(){return["-"===t.ASISTENCIADIARIA.ESTADO?((0,a.uX)(),(0,a.Wv)(N,{key:0,icon:t.ASISTENCIADIARIA.icon,color:t.ASISTENCIADIARIA.colorvue},{default:(0,a.k6)(function(){return[(0,a.bF)(M,null,{default:(0,a.k6)(function(){return[(0,a.eW)((0,s.v_)(t.ASISTENCIADIARIA.descripcion),1)]}),_:2},1024)]}),_:2},1032,["icon","color"])):((0,a.uX)(),(0,a.Wv)(y,{key:1,class:"q-mr-xs",size:"sm",style:(0,s.Tr)({background:t.ASISTENCIADIARIA.color,color:"#000"}),label:t.ASISTENCIADIARIA.ESTADO,flat:""},{default:(0,a.k6)(function(){return[(0,a.bF)(M,{anchor:"top middle",self:"top middle"},{default:(0,a.k6)(function(){return[(0,a.eW)((0,s.v_)(t.ASISTENCIADIARIA.descripcion),1)]}),_:2},1024)]}),_:2},1032,["style","label"])),t.UPDATED?((0,a.uX)(),(0,a.Wv)(L,{key:2,floating:"",color:"red",style:{width:"2px",height:"2px",position:"absolute","font-size":"7px",top:"-6px",right:"-6px"}})):(0,a.Q3)("v-if",!0)]}),_:2},1032,["onClick"])]}),_:2},1032,["class"])}),128))]}),_:1})])):(0,a.Q3)("v-if",!0)]}),_:1}),(0,a.bF)(U,{class:"row justify-end"},{default:(0,a.k6)(function(){return[(0,a.Lk)("div",b,[(0,a.Lk)("div",g,[(0,a.Lk)("span",D,(0,s.v_)(e.totalRows),1)])])]}),_:1})]))])]}),_:1})]}),_:1}),(0,a.bF)(j,{class:"modal-adicional",modelValue:e.modalAsistencia,"onUpdate:modelValue":t[11]||(t[11]=function(t){return e.modalAsistencia=t}),header:!0,title:"Marcar Asistencia",onSubmit:e.grabar},{default:(0,a.k6)(function(){return[(0,a.Lk)("div",S,[(0,a.Lk)("div",C,[(0,a.bF)(W,{modelValue:e.params.ESTADO,"onUpdate:modelValue":t[8]||(t[8]=function(t){return e.params.ESTADO=t}),modal:!0,onInput:t[9]||(t[9]=function(t){return e.params.ESTADO=t})},null,8,["modelValue"])]),e.valoresAsistencia[e.params.ESTADO]?((0,a.uX)(),(0,a.CE)("div",v,[(0,a.Lk)("span",O,(0,s.v_)(e.valoresAsistencia[e.params.ESTADO].descripcion),1)])):(0,a.Q3)("v-if",!0),(0,a.Lk)("div",E,[(0,a.bF)(q,{class:"q-if-outlined no-bottom",type:"textarea",modelValue:e.params.OBSERVACION,"onUpdate:modelValue":t[10]||(t[10]=function(t){return e.params.OBSERVACION=t}),"float-label":"Observación"},null,8,["modelValue"])])])]}),_:1},8,["modelValue","onSubmit"]),(0,a.bF)(j,{class:"modal-adicional",modelValue:e.modalImprimir,"onUpdate:modelValue":t[15]||(t[15]=function(t){return e.modalImprimir=t}),header:!0,title:"Imprimir Asistencia",onSubmit:e.imprimir},{default:(0,a.k6)(function(){return[(0,a.Lk)("div",T,[(0,a.bF)(X,{class:"col-sm-12",modelValue:e.tipoImpresion,"onUpdate:modelValue":t[12]||(t[12]=function(t){return e.tipoImpresion=t}),label:"Imprimir Asistencia",val:"tipo1"},null,8,["modelValue"]),(0,a.bF)(X,{class:"col-sm-12",modelValue:e.tipoImpresion,"onUpdate:modelValue":t[13]||(t[13]=function(t){return e.tipoImpresion=t}),label:"Imprimir Asistencia En blanco",val:"tipo2"},null,8,["modelValue"]),e.bpastor?((0,a.uX)(),(0,a.Wv)(X,{key:0,class:"col-sm-12",modelValue:e.tipoImpresion,"onUpdate:modelValue":t[14]||(t[14]=function(t){return e.tipoImpresion=t}),label:"Imprimir Asistencia (Fecha / Hora)",val:"tipo3"},null,8,["modelValue"])):(0,a.Q3)("v-if",!0)])]}),_:1},8,["modelValue","onSubmit"])]}),_:1})}var F=n(14794),R=n.n(F),_=n(57008),w=n.n(_),N=n(63053),y=n.n(N),P=n(76080),V=n.n(P),U=n(45254),x=n.n(U),M=(n(5170),n(99550)),q=n.n(M),Q=(n(30683),n(71225),n(74260),n(39866),n(23825),n(52133),n(10239),n(50310),n(5962),n(32203),n(90095),n(6724),n(70199),n(11777),n(83190),n(52776),n(62692),n(66307),n(81813),n(13715),n(24066),{data:function(){return{config:{ALUCOD:{renderHtml:function(e,t,n,o){return this.showFilterDeudas&&e.TIENEDEUDA?o["$$background"]="#FFA49D":o["$$background"]="white",t("span",{},e.ALUCOD)}},ICONO:{component:"button",icon:["check_box as otrafuncion"],tooltip:{otrafuncion:"texto otrafuncion"},otrafuncion:function(e){console.log("otrafuncion",e)},permisos:{eliminar:!this.isFamAlu&&"===3"},flat:!0,dense:!0}},columns:[],columnsIni:[{name:"ALUCOD",label:"Código",field:"ALUCOD",align:"left"},{label:"Nombres",name:"NOMCOMP_ALUMNO",field:"NOMCOMP_ALUMNO",align:"left"}]}}}),L=n(2819),$=n(88865),B=n(95718),H=n(30640),W=n(6123),j=n(24974),X=n(16648),z=n(93616),Y=n(57668),J=n(80660),G={registrarAsistencia:function(e){return J.$http.post("api/AsistenciaTalleresController/registrarAsistenciaNuevo",{data:e})},getAsistencia:function(e,t,n,o,i){return console.log("id_curso_periodo:",o),J.$http.get("api/AsistenciaTalleresController/getAsistencia",{params:{params:{ano:e,duracod:t,cursocod:n,id_curso_periodo:o,turno:i}}})},getPeriodos:function(e){return J.$http.get("api/TablasController/getDuravac")},getCursos:function(e,t){return J.$http.get("api/CtCursoPeriodoController/getListaCursos",{params:{params:{ano:e,duracod:t,noanulado:1,esAsistencia:!0}}}).then(function(e){return e.map(function(e){return e.CURSODES=e.VACCOD+" - "+e.CURSODES,e})})},getInscritos:function(e,t,n,o,i,a){return J.$http.get("api/InscripcionController/getInscripcionesPorCurso",{params:{params:{ano:e,duracod:t,cursocod:n,id_curso_periodo:o,turno:i,deuda:a,noanulado:1,asistencia:1}}})},getAnios:function(e){return J.$http.get("api/MantenimientoController/getAniovac",{params:{params:{tipo:e}}})},grabarAnio:function(e){return J.$http.post("api/MantenimientoController/grabarAnio",{data:e})},updateAnioVac:function(e){return J.$http.post("api/MantenimientoController/updateAnioVac",{data:e,ANO:e.ANO})},deleteAnio:function(e){return J.$http.delete("api/MantenimientoController/deleteAnioVac",{params:{ANO:e}})}};function K(e,t){var n=(0,a.g2)("q-tooltip"),o=(0,a.g2)("q-btn");return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.bF)(o,{class:(0,s.C4)(["q-mr-xs",e.getClase("P")]),size:"sm",style:{background:"#b6dff4"},label:"P",tooltip:"Presente",flat:"",onClick:t[0]||(t[0]=function(t){return e.btnClick("P")})},{default:(0,a.k6)(function(){return[(0,a.bF)(n,{anchor:"top middle",self:"top middle"},{default:(0,a.k6)(function(){return i()(t[8]||(t[8]=[(0,a.eW)("Presente",-1)]))}),_:1})]}),_:1},8,["class"]),(0,a.bF)(o,{class:(0,s.C4)(["q-mr-xs",e.getClase("T")]),size:"sm",style:{background:"#EBE76B"},label:"T",tooltip:"Presente",flat:"",onClick:t[1]||(t[1]=function(t){return e.btnClick("T")})},{default:(0,a.k6)(function(){return[(0,a.bF)(n,{anchor:"top middle",self:"top middle"},{default:(0,a.k6)(function(){return i()(t[9]||(t[9]=[(0,a.eW)("Tardanza",-1)]))}),_:1})]}),_:1},8,["class"]),(0,a.bF)(o,{class:(0,s.C4)(["q-mr-xs",e.getClase("TI")]),size:"sm",style:{background:"#FF9F0F"},label:"TI",tooltip:"Presente",flat:"",onClick:t[2]||(t[2]=function(t){return e.btnClick("TI")})},{default:(0,a.k6)(function(){return[(0,a.bF)(n,{anchor:"top middle",self:"top middle"},{default:(0,a.k6)(function(){return i()(t[10]||(t[10]=[(0,a.eW)("Tardanza Injustificada",-1)]))}),_:1})]}),_:1},8,["class"]),(0,a.bF)(o,{class:(0,s.C4)(["q-mr-xs",e.getClase("F")]),size:"sm",style:{background:"#CC0C15"},label:"F",tooltip:"Presente",flat:"",onClick:t[3]||(t[3]=function(t){return e.btnClick("F")})},{default:(0,a.k6)(function(){return[(0,a.bF)(n,{anchor:"top middle",self:"top middle"},{default:(0,a.k6)(function(){return i()(t[11]||(t[11]=[(0,a.eW)("Falta injustificada",-1)]))}),_:1})]}),_:1},8,["class"]),(0,a.bF)(o,{class:(0,s.C4)(["q-mr-xs",e.getClase("FJ")]),size:"sm",style:{background:"#45BE6A"},label:"FJ",tooltip:"Presente",flat:"",onClick:t[4]||(t[4]=function(t){return e.btnClick("FJ")})},{default:(0,a.k6)(function(){return[(0,a.bF)(n,{anchor:"top middle",self:"top middle"},{default:(0,a.k6)(function(){return i()(t[12]||(t[12]=[(0,a.eW)("Falta justificada",-1)]))}),_:1})]}),_:1},8,["class"]),(0,a.bF)(o,{class:(0,s.C4)(["q-mr-xs",e.getClase("S")]),size:"sm",style:{background:"#555555"},label:"S",tooltip:"Presente",flat:"",onClick:t[5]||(t[5]=function(t){return e.btnClick("S")})},{default:(0,a.k6)(function(){return[(0,a.bF)(n,{anchor:"top middle",self:"top middle"},{default:(0,a.k6)(function(){return i()(t[13]||(t[13]=[(0,a.eW)("Suspensión",-1)]))}),_:1})]}),_:1},8,["class"]),(0,a.bF)(o,{class:(0,s.C4)(["q-mr-xs",e.getClase("PV")]),size:"sm",style:{background:"#64f4c5"},label:"PV",tooltip:"Presente",flat:"",onClick:t[6]||(t[6]=function(t){return e.btnClick("PV")})},{default:(0,a.k6)(function(){return[(0,a.bF)(n,{anchor:"top middle",self:"top middle"},{default:(0,a.k6)(function(){return i()(t[14]||(t[14]=[(0,a.eW)("Presente Injustificado Virtual",-1)]))}),_:1})]}),_:1},8,["class"]),(0,a.bF)(o,{size:"sm",style:{background:"#64f4c5"},label:"PP",tooltip:"Presente",flat:"",onClick:t[7]||(t[7]=function(t){return e.btnClick("PP")}),class:(0,s.C4)(e.getClase("PP"))},{default:(0,a.k6)(function(){return[(0,a.bF)(n,{anchor:"top middle",self:"top middle"},{default:(0,a.k6)(function(){return i()(t[15]||(t[15]=[(0,a.eW)("Presente Injustificado Presencial",-1)]))}),_:1})]}),_:1},8,["class"]),(0,a.Q3)('q-btn( icon="comment"  inverse flat @click="btnClick")q-tooltip( anchor="top middle" self="top middle") Observación')])}var Z={emits:["update:modelValue","input"],props:{modal:{type:Boolean,default:!1},modelValue:{type:String}},components:{QBtn:W.Il,QTooltip:W.nC,sieSelect:z.A,QFab:W.l6,QFabAction:W.B$,QPageSticky:W._U,QSelect:X.A,QItemSection:$.A,QCardSection:B.A,QInnerLoading:W.SQ,sieModal:H.A,QSpinnerOval:W.VA},data:function(){return{periodo:null}},computed:{currentValue:{get:function(){return this.modelValue},set:function(e){this.$emit("update:modelValue",e),this.$emit("input",e)}}},methods:{btnClick:function(e){console.log(e),this.currentValue=e},getClase:function(e){return{"boton-elejido":this.modal&&e===this.modelValue,"boton-noelejido":this.modal&&e!==this.modelValue}},created:function(){console.log("this.value",this.modelValue)}}},ee=n(12807);const te=(0,ee.A)(Z,[["render",K]]);var ne=te,oe={components:{sieUsuario:j.A,QRadio:W.$,QChip:W.wQ,QDatetime:W.T5,TooltipAsistencia:ne,sieSelect:z.A,QBtn:W.Il,QFab:W.l6,QFabAction:W.B$,QPageSticky:W._U,QSelect:X.A,QItemSection:$.A,QCardSection:B.A,QInnerLoading:W.SQ,sieModal:H.A,QSpinnerOval:W.VA,QPage:W.Tu,QCard:W.C$,QList:W.Mb,QItem:W.H0,QItemSide:W.n1,QItemTile:W.lp,QItemMain:W.mF,QTooltip:W.nC,QPopover:W.VM,QInput:W.ie},mixins:[Q],data:function(){return{optTurnos:[],itemCurso:{},vaccod:null,tipoImpresion:"tipo1",modalImprimir:!1,isFamAlu:(0,Y["default"])().esFamilia||(0,Y["default"])().esFamiliaAdmision||(0,Y["default"])().esEstudiante||["E01","E02"].includes((0,Y["default"])().tipcod),diasConclases:[],iconoAll:{idx:8,ESTADO:"-",descripcion:"Sin asignar",icon:"check_box_outline_blank",color:"secondary",colorvue:"secondary"},acceso:(0,Y["default"])().ruta.nivel>=2,fecha:new Date((new Date).setUTCHours(0,0,0,0)).toISOString(),maxFecha:W.p6.formatDate(new Date,"MM/DD/YYYY"),params:{ESTADO:null,OBSERVACION:null,ALUCOD:null,FECHA:""},asistenciaObj:{},auxColumns:[],currentRow:{},modalAsistencia:!1,periodo:null,cursocod:null,mes:"T",diames:"D",optionMeses:[{value:"T",label:"Todos"}],diamesOptions:[{label:"Mes",value:"M"},{label:"Día",value:"D"}],periodos:[],cursos:[],rows:[],rowsClone:[],estados:{0:"P",1:"F",2:"T",3:"TI",4:"FJ",5:"S",6:"PV",7:"PP",8:"-"},valoresAsistencia:{P:{idx:0,color:"#b6dff4",colorvue:"secondary",ESTADO:"P",descripcion:"Presente",icon:"check_circle"},F:{idx:1,color:"#CC0C15",colorvue:"positive",ESTADO:"F",icon:"remove_circle",descripcion:"Falta"},T:{idx:2,color:"#EBE76B",colorvue:"positive",icon:"info",ESTADO:"T",descripcion:"Tardanza Justificada"},TI:{idx:3,color:"#FF9F0F",ESTADO:"TI",colorvue:"positive",icon:"alarm_on",descripcion:"Tardanza Injustificada"},FJ:{idx:4,color:"#45BE6A",colorvue:"positive",icon:"do_not_disturb_off",ESTADO:"FJ",descripcion:"Falta justificada"},S:{idx:5,color:"#555555",colorvue:"positive",icon:"help",ESTADO:"S",descripcion:"Suspensión"},PV:{color:"#64f4c5",idx:6,colorvue:"positive",ESTADO:"PV",descripcion:"Presente Injustificado Virtual"},PP:{color:"#64f4c5",idx:7,colorvue:"positive",ESTADO:"PP",descripcion:"Presente Injustificado Presencial"},"-":{idx:8,color:"secondary",colorvue:"positive",icon:"check_box_outline_blank",ESTADO:"-",descripcion:"Sin asignar"}},sie:(0,Y["default"])(),bpastor:["0090"].includes((0,Y["default"])().colcod),rowAno:{ANO:"",DES:"",VIGENTE:""},sino:[{label:"Si",value:"S"},{label:"No",value:"N"}],modalAgregar:!1,dataAlumno:[],tipoAlumnos:[{label:"Matriculados",value:"S"},{label:"Todos",value:"T"},{label:"Matriculados y Nuevos",value:"MN"}],tipoAlumno:"S",now:Date(),showFilterDeudas:["A018","0090"].includes((0,Y["default"])().colcod),optDeudas:[{value:0,label:"Todos"},{value:1,label:"Pendiente"},{value:2,label:"Pagado"}],deuda:0}},computed:{buttons:function(){var e=this,t=[{icon:"print",label:"Imprimir",tooltip:"Imprimir Asistencia",click:function(){return e.modalImprimir=!0},disable:this.sie.ruta.nivel<=2}];return!this.isFamAlu&&this.sie.ruta.nivel>2&&"D"===this.diames&&t.push({icon:"save",label:"Guardar",tooltip:"Guardar asistencia díaria",click:this.guardar,disable:this.sie.ruta.nivel<=2}),t},horaActual:function(){return W.p6.formatDate(this.now,"HH:mm:ss A")},keyFecha:function(){var e=this.fecha?this.fecha.split("T"):[""],t=q()(e,1),n=t[0],o=n.split("-"),i=q()(o,3),a=i[0],s=i[1],r=i[2],l="A"+r+"-"+s+"-"+a;return l},totalRows:function(){var e="Total: ".concat(this.rows.length);return e}},methods:{imprimir:function(){var e=this;if(!this.currentRow.ID_CURSO_PERIODO)return this.$notify("Debe seleccionar un curso","warning");var t=this.optTurnos.find(function(t){return t.VACCOD===e.vaccod}),n=t&&this.currentRow.NUMTURNOS>1?t.TURNO:"%",o="/webservice/reportes-talleres/jreport",i={REPCOD:"053",ANO:(0,Y["default"])().ano,DURACOD:this.periodo,ID_CURSO_PERIODO:this.currentRow.ID_CURSO_PERIODO,TURNO:n,FORMATO:"pdf",CASE:this.tipoImpresion};(0,L.exportFilePhp)(i,o,"Asistencia")},guardar:function(){var e=this;return x()(V()().m(function t(){var n,o,i,a,s,r,l;return V()().w(function(t){while(1)switch(t.n){case 0:return n=[],t.n=1,e.$http.get("api/InscripcionController/getFechaHoraServer");case 1:o=t.v,i=new Date(o).getHours(),a=new Date(o).getMinutes(),s=e.fecha,r=new Date(s),r.setUTCHours(i,a,0,0),l=r.toISOString(),e.rows.map(function(t){var o=t.ASISTENCIADIARIA.ID_ASISTENCIA;if(t.UPDATED){var i=new Date,a={ID_CURSO_PERIODO:t.ID_CURSO_PERIODO,TURNO:t.TURNO,ID_PERSONA:t.ID_PERSONA,USUCOD:e.sie.USUCOD,OBSERVACION:t.ASISTENCIADIARIA.OBSERVACION,ESTADO:t.ASISTENCIADIARIA.ESTADO,FECHA:l,HORA:i.toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit",hour12:!1})};o&&(a.ID_ASISTENCIA=o),e.currentRow.NUMTURNOS>1&&(e.currentRow.TURNO=a.TURNO),n.push(a)}}),n.length?G.registrarAsistencia(n).then(function(t){e.$notify(t.message,"success"),e.modalAsistencia=!1;var n=!0;e.cargarAsistentes(e.currentRow,n),e.iconoAll=e.valoresAsistencia["-"]}).catch(function(t){var n=t.error;e.$notify(n.message,"warning")}):e.$notify("No hay asistencias Modificadas","info");case 2:return t.a(2)}},t)}))()},comentario:function(e){this.editarAsistencia(e,this.keyFecha)},getIcon:function(e){var t=this.fecha?this.fecha.split("T"):[""],n=q()(t,1),o=n[0],i=o.split("-"),a=q()(i,3),s=a[0],r=a[1],l=a[2],c="A"+l+"-"+r+"-"+s,u=e&&"object"===y()(e)&&e[c]?e[c]:"-";return this.valoresAsistencia[u]},cambiarEstadosAll:function(){var e=this,t=this.iconoAll.idx;t=8===t?0:t+1;var n=this.valoresAsistencia[this.estados[t]];this.iconoAll=w()({},n),console.log("cambiarEstadosAll"),this.rows=this.rows.map(function(t){return t.ASISTENCIADIARIA=w()(w()({},t.ASISTENCIADIARIA),n),t.UPDATED=!("-"===n.ESTADO&&!t.ASISTENCIADIARIA.ID_ASISTENCIA),t[e.keyFecha]=n.ESTADO,t})},cambiarEstado:function(e){if(this.isFamAlu)return!1;var t=e[this.keyFecha]||"-",n=this.valoresAsistencia[t],o=8===n.idx?0:n.idx+1,i=this.valoresAsistencia[this.estados[o]].ESTADO;e[this.keyFecha]=i,e.UPDATED=!("-"===i&&!e.ASISTENCIADIARIA.ID_ASISTENCIA),e.ASISTENCIADIARIA=w()(w()({},e.ASISTENCIADIARIA),this.valoresAsistencia[this.estados[o]])},cambiarDeuda:function(){var e=this,t=this.optTurnos.find(function(t){return t.VACCOD===e.vaccod});t&&(this.currentRow.TURNO=t.TURNO),this.cargarAsistentes(this.currentRow,!0)},cambiarFecha:function(){var e=this;console.log("cambiarFecha:",this.rows,this.keyFecha,this.fecha),this.rows=this.rowsClone.map(function(t){var n=e.getAsistencia(t.ID_PERSONA,e.keyFecha);return t.ASISTENCIADIARIA=w()(w()({},n),e.valoresAsistencia[n.ESTADO]),t}).filter(function(t){return new Date(t.FECFIN)>=new Date(e.fecha)})},getDuracodActivo:function(){var e=this;this.$http.get("api/InscripcionController/getPeriodo",{params:{activo:!0}}).then(function(t){e.periodo=t?t.DURACOD:"",e.getCursos()})},btnClick:function(){},cambiaMes:function(e){var t=this;console.log("cambiaMes:",e);var n=i()(this.auxColumns);"T"===this.mes?this.columns=i()(n):this.columns=n.filter(function(e){return!e.mes||e.mes===t.mes})},eligeEstado:function(e){this.params.ESTADO=e},cargarAsistencia:function(){var e=this;return x()(V()().m(function t(){var n,o;return V()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,G.getAsistencia(e.sie.ano,e.periodo,e.cursocod,e.currentRow.ID_CURSO_PERIODO);case 1:n=t.v,o={},n.forEach(function(e){o.hasOwnProperty(e.ID_PERSONA)||(o[e.ID_PERSONA]={fechas:{}});var t=e.FECHA?e.FECHA.split("T"):[""],n=q()(t,1),i=n[0],a=i.split("-"),s=q()(a,3),r=s[0],l=s[1],c=s[2],u="A"+c+"-"+l+"-"+r;o[e.ID_PERSONA][u]=e,o[e.ID_PERSONA].fechas[u]=e.ESTADO}),e.asistenciaObj=o;case 2:return t.a(2)}},t)}))()},cargarDiasDeClases:function(e){var t=this;return x()(V()().m(function n(){var o,i,a,s,r,l,c,u,d,m,A,p,f,h,I,b,g;return V()().w(function(n){while(1)switch(n.n){case 0:console.log("cargarDiasDeClases:",e,e.FECINI,e.FECFIN,e.DIAS),o=[],i=new Date(e.FECINI),a=new Date(e.FECFIN),s=[],r={0:"Dom",1:"Lun",2:"Mar",3:"Mie",4:"Jue",5:"Vie",6:"Sáb"},l={"01":"Enero","02":"Febrero","03":"Marzo","04":"Abril","05":"Mayo","06":"Junio","07":"Julio","08":"Agosto","09":"Setiembre",10:"Octubre",11:"Noviembre",12:"Diciembre"},c=[{value:"T",label:"Todos"}],u=e.DIAS?e.DIAS.split(","):[],d="";while(i.getTime()<=a.getTime())m=i.getFullYear()+"",A=i.getMonth()+1,p=i.getDate(),f="0".concat(p).substr(-2),h="0".concat(A).substr(-2),d=h,I=i.getDay(),b=r[I]+" "+f+"/"+h,(new Date).getMonth()+1===A&&(t.mes=h,console.log("mes:",t.mes)),u.includes(String(I))&&(s.hasOwnProperty(h)||(s[h]={},c.push({value:h,label:l[h]})),g="A"+f+"-"+h+"-"+m,o.push({fecha:i.toISOString(),label:b,keyFecha:g,mes:h,align:"left"})),i.setDate(i.getDate()+1);return t.mes&&"T"!==t.mes||(t.mes=d),console.log("######################### data ###################"),console.log("optionMeses",c,JSON.stringify(c)),t.diasConclases=o,t.optionMeses=c,n.a(2,o)}},n)}))()},encontrarFechaAnterior:function(e,t,n){for(var o,i=0;i<e.length;i++){var a=new Date(n),s=e[i][t]&&"string"===typeof e[i][t]?new Date(e[i][t]):new Date;if(!(s.getTime()<=a.getTime()))break;o=e[i][t]}return o},getHorario:function(e){var t=this;return x()(V()().m(function n(){return V()().w(function(n){while(1)switch(n.n){case 0:return console.log("getHorario"),n.a(2,t.$http.get("api/CtCursoPeriodoController/getHorario",{params:{idCursoPeriodo:e.ID_CURSO_PERIODO}}).then(function(e){return e.map(function(e){var t="".concat(W.p6.formatDate(e.HORAINI,"DD-MM-YYYY HH:mm")).split(" ")[1],n="".concat(W.p6.formatDate(e.HORAFIN,"DD-MM-YYYY HH:mm")).split(" ")[1];return e.TURNODES="".concat(e.VALOR," (").concat(t," - ").concat(n,")"),e})}))}},n)}))()},cargarAsistentes:function(e){var t=arguments,n=this;return x()(V()().m(function o(){var a,s,r,l,c,u,d,m,A,p,f;return V()().w(function(o){while(1)switch(o.n){case 0:return a=t.length>1&&void 0!==t[1]&&t[1],console.log("cargarAsistentes:",e,a),s=i()(n.columnsIni),o.n=1,G.getInscritos(n.sie.ano,n.periodo,n.cursocod,e.ID_CURSO_PERIODO,e.TURNO,n.deuda);case 1:return r=o.v,o.n=2,n.cargarAsistencia();case 2:for(console.log("antes de cargarDiasDeClases"),n.cargarDiasDeClases(e),console.log("despues de cargarDiasDeClases"),console.log("this.diasConclases:",n.diasConclases),a||(n.fecha=n.encontrarFechaAnterior(n.diasConclases,"fecha",new Date)),console.log("inscritos:",r),l=0;l<r.length;l++)c=r[l],c.ID_PERSONA=c.ID_PERSONA_ALUMNO,u=n.getAsistencia(c.ID_PERSONA,n.keyFecha),c.ASISTENCIADIARIA=w()(w()({},n.valoresAsistencia[u.ESTADO]),u),n.asistenciaObj[c.ID_PERSONA]&&(c=w()(w()({},c),n.asistenciaObj[c.ID_PERSONA].fechas)),r[l]=c;d=w()({},n.config),m=n.diasConclases.length,A=n,p=V()().m(function e(){var t;return V()().w(function(e){while(1)switch(e.n){case 0:t=n.diasConclases[f],s.push(w()(w()({},t),{},{name:t.keyFecha,field:t.keyFecha})),d[t.keyFecha]={renderHtml:function(e,n){var o=A.getAsistencia(e.ID_PERSONA,t.keyFecha),i=A.valoresAsistencia[o.ESTADO]?A.valoresAsistencia[o.ESTADO]:{};return o.OBSERVACION?n("div",{style:{position:"relative",width:"30px",height:"100%",textAlign:"center",borderRadius:"2px",padding:"4px",background:i.color}},[n("span",{},i.ESTADO),n("div",{style:{position:"absolute",width:"10px",height:"10px",top:"-3px",right:"-5px"}},[n("i",{class:"row justify-center material-icons text-secondary",style:{fontSize:"20px"}},"comment")])]):n("div",{style:{width:"30px",height:"100%",textAlign:"center",borderRadius:"2px",padding:"4px",background:i.color}},i.ESTADO)},renderAction:function(e){this.editarAsistencia(e,t.keyFecha)},tooltip:function(e){var n=A.getAsistencia(e.ID_PERSONA,t.keyFecha),o=A.valoresAsistencia[n.ESTADO]?A.valoresAsistencia[n.ESTADO].descripcion:"";return o=n.OBSERVACION?o+":\n "+n.OBSERVACION:o,o}};case 1:return e.a(2)}},e)}),f=0;case 3:if(!(f<m)){o.n=5;break}return o.d(R()(p()),4);case 4:f++,o.n=3;break;case 5:n.config=d,n.auxColumns=i()(s),n.cambiaMes(),console.log("columns:",s),console.log("inscritos:",r),n.rows=r,n.rowsClone=i()(r),n.cambiarFecha();case 6:return o.a(2)}},o)}))()},cambiarTurno:function(e){var t=w()(w()({},this.currentRow),{},{TURNO:e.TURNO,DIAS:String(e.DIA)});console.log("cambiarTurno",e),console.log("currentRow",t),this.cargarAsistentes(t)},cambiarCurso:function(e){var t=arguments,n=this;return x()(V()().m(function o(){var i;return V()().w(function(o){while(1)switch(o.n){case 0:if(i=t.length>1&&void 0!==t[1]&&t[1],n.rows=[],n.currentRow=e,n.vaccod=null,!(e.NUMTURNOS>1)){o.n=2;break}return o.n=1,n.getHorario(e);case 1:return n.optTurnos=o.v,o.a(2,!1);case 2:n.cargarAsistentes(e,i);case 3:return o.a(2)}},o)}))()},cambiaPeriodo:function(){console.log("cambiaPeriodo:"),this.rows=[],"D"===this.diames?this.fecha=null:this.fecha="T",this.getCursos()},getAsistencia:function(e,t){return this.asistenciaObj[e]&&this.asistenciaObj[e][t]?this.asistenciaObj[e][t]:{ESTADO:"-"}},editarAsistencia:function(e,t){if(this.isFamAlu)return!1;try{console.log(e);var n=this.getAsistencia(e.ID_PERSONA,t),o=t.replace("A",""),i=o.split("-"),a=q()(i,3),s=a[0],r=a[1],l=a[2];this.params.ALUCOD=e.ALUCOD,this.params.ID_PERSONA=e.ID_PERSONA,this.params.PROALU=1===e.ID_PERFIL?"I":"E",this.params.FECHA=l+"-"+r+"-"+s,n.ID_ASISTENCIA?(this.params.ID_ASISTENCIA=n.ID_ASISTENCIA,this.params.ID_CURSO_PERIODO=n.ID_CURSO_PERIODO,this.params.TURNO=n.TURNO,this.params.OBSERVACION=n.OBSERVACION,this.params.ESTADO=n.ESTADO):(delete this.params.ID,this.params.OBSERVACION=null,this.params.ESTADO=null),this.modalAsistencia=!0}catch(e){console.log(e)}},actualizarCampo:function(e){var t=this;G.updateAnioVac(e).then(function(e){t.getAnios(),t.$notify(e.message,"success")})},getPeriodos:function(){var e=this;return x()(V()().m(function t(){return V()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,G.getPeriodos();case 1:e.periodos=t.v;case 2:return t.a(2)}},t)}))()},getCursos:function(){var e=this;return x()(V()().m(function t(){return V()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,G.getCursos(e.sie.ano,e.periodo);case 1:e.cursos=t.v;case 2:return t.a(2)}},t)}))()},nuevo:function(){this.modalAgregar=!0},eliminarAnio:function(e){var t=this;G.deleteAnio(e.ANO).then(function(e){t.getAnios(),t.$notify(e.message,"success")})},grabar:function(){var e=this;return x()(V()().m(function t(){var n,o,i;return V()().w(function(t){while(1)switch(t.n){case 0:if(n=w()({},e.params),o=Number(e.currentRow.VACCOD.split("A")[1]),n.ID_CURSO_PERIODO=e.currentRow.ID_CURSO_PERIODO,n.TURNO=e.currentRow.TURNO||o,i=new Date,n.HORA=i.toLocaleTimeString(),e.params.ESTADO){t.n=1;break}return t.a(2,e.$notify("Debe Marcar la asistencia","warning"));case 1:G.registrarAsistencia([n]).then(function(t){e.$notify(t.message,"success"),e.modalAsistencia=!1,e.cargarAsistentes(e.currentRow)}).catch(function(t){var n=t.error;e.$notify(n.message,"warning")});case 2:return t.a(2)}},t)}))()},getAnios:function(){var e=this;return x()(V()().m(function t(){return V()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,G.getAnios("");case 1:e.dataAlumno=t.v;case 2:return t.a(2)}},t)}))()}},beforeMounted:function(){},created:function(){var e=this;setInterval(function(){e.now=Date()},1e3),this.getDuracodActivo(),this.getPeriodos(),this.getIcon("P")}};const ie=(0,ee.A)(oe,[["render",k]]);var ae=ie}}]);