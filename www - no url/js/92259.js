"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[92259],{92259:function(e,o,t){t.r(o),t.d(o,{default:function(){return B}});var a=t(8445),n=t.n(a),r=t(91134),i=t.n(r),l=(t(71225),t(56285),t(50310),t(5962),t(83190),t(61758)),s=t(58790),u=t(29104),c={key:0,class:"sie-button-top row justify-center items-center"},d={class:"col"},m={class:"col"},f={class:"row items-center"},p={class:"col"},b={class:"row q-pa-md"},g={class:"col"};function D(e,o){var t=(0,l.g2)("q-btn"),a=(0,l.g2)("sie-estudiantes"),r=(0,l.g2)("q-tab"),D=(0,l.g2)("q-datetime"),O=(0,l.g2)("q-card-main"),C=(0,l.g2)("q-card-separator"),E=(0,l.g2)("q-search"),v=(0,l.g2)("q-th"),h=(0,l.g2)("q-tr"),M=(0,l.g2)("q-td"),N=(0,l.g2)("q-table"),_=(0,l.g2)("q-card"),k=(0,l.g2)("q-tab-pane"),A=(0,l.g2)("q-chip"),T=(0,l.g2)("q-select"),F=(0,l.g2)("q-date"),P=(0,l.g2)("q-popup-edit"),w=(0,l.g2)("q-tabs"),S=(0,l.g2)("q-tooltip"),y=(0,l.g2)("q-fab-action"),Y=(0,l.g2)("q-fab"),U=(0,l.g2)("q-page-sticky"),R=(0,l.g2)("q-input"),I=(0,l.g2)("sie-modal"),V=(0,l.g2)("sie-pdf"),L=(0,l.g2)("q-page");return(0,l.uX)(),(0,l.Wv)(L,{class:"intranet-estadocuenta"},{default:(0,l.k6)(function(){return[e.isGreater?(0,l.Q3)("v-if",!0):((0,l.uX)(),(0,l.CE)("div",c,[(0,l.bF)(t,{dense:"",round:"",flat:"",icon:"print",onClick:e.reporte},null,8,["onClick"])])),(0,l.bF)(a,{onSelected:e.selectEstudiante,modelValue:e.alucod,"onUpdate:modelValue":o[0]||(o[0]=function(o){return e.alucod=o}),txtCustom:!0,params:{brae:!0}},null,8,["onSelected","modelValue"]),(0,l.bF)(w,{class:"col",inverted:"",modelValue:e.selectReporte,"onUpdate:modelValue":o[7]||(o[7]=function(o){return e.selectReporte=o})},{title:(0,l.k6)(function(){return[(0,l.bF)(r,{default:!e.activaTabSegundo,label:"Reporte por Número de Pago",name:"0"},null,8,["default"]),(0,l.bF)(r,{default:e.activaTabSegundo,label:"Reporte por Saldo",name:"1"},null,8,["default"])]}),default:(0,l.k6)(function(){return[(0,l.bF)(k,{name:"0"},{default:(0,l.k6)(function(){return[(0,l.bF)(_,null,{default:(0,l.k6)(function(){return[(0,l.bF)(O,{class:"row"},{default:(0,l.k6)(function(){return[(0,l.Lk)("div",d,[(0,l.bF)(D,{class:"q-if-outlined no-bottom","float-label":"Total",color:"primary",onChange:e.getDate,format:"DD/MM/YYYY",modal:!0,modelValue:e.dateIni,"onUpdate:modelValue":o[1]||(o[1]=function(o){return e.dateIni=o}),type:"date"},null,8,["onChange","modelValue"])]),(0,l.Lk)("div",m,[(0,l.bF)(D,{class:"q-if-outlined no-bottom","float-label":"Filtro",color:"primary",onChange:e.fec,format:"DD/MM/YYYY",modal:!0,modelValue:e.dateFin,"onUpdate:modelValue":o[2]||(o[2]=function(o){return e.dateFin=o}),type:"date"},null,8,["onChange","modelValue"])])]}),_:1}),(0,l.bF)(C),(0,l.bF)(N,{class:"no-shadow table-sie",filter:e.filter,pagination:e.pagination,"onUpdate:pagination":o[4]||(o[4]=function(o){return e.pagination=o}),"hide-bottom":!0,data:e.pagos,columns:e.columnsPagos,"row-key":"name"},{"top-right":(0,l.k6)(function(t){return[(0,l.bF)(E,{class:"q-if-outlined","hide-underline":"",modelValue:e.filter,"onUpdate:modelValue":o[3]||(o[3]=function(o){return e.filter=o})},null,8,["modelValue"])]}),header:(0,l.k6)(function(e){return[(0,l.bF)(h,null,{default:(0,l.k6)(function(){return[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.cols,function(o){return(0,l.uX)(),(0,l.Wv)(v,{key:o.name,props:e},{default:(0,l.k6)(function(){return[(0,l.eW)((0,s.v_)(o.label),1)]}),_:2},1032,["props"])}),128))]}),_:2},1024)]}),"body-cell-FECVEN":(0,l.k6)(function(o){return["0042"===e.colcod?((0,l.uX)(),(0,l.Wv)(M,{key:0,props:o},{default:(0,l.k6)(function(){return[(0,l.eW)((0,s.v_)(o.row.FECVEN),1)]}),_:2},1032,["props"])):(0,l.Q3)("v-if",!0)]}),"body-cell-VER1":(0,l.k6)(function(o){return[e.mostrarPDF?((0,l.uX)(),(0,l.Wv)(M,{key:0,props:o},{default:(0,l.k6)(function(){return["S"===o.row.DELECTRONICO||e.reciboFisico?((0,l.uX)(),(0,l.Wv)(t,{key:0,onClick:function(t){return e.pdf(o.row)},dense:"",flat:"",icon:"file_pdf"},null,8,["onClick"])):(0,l.Q3)("v-if",!0)]}),_:2},1032,["props"])):(0,l.Q3)("v-if",!0)]}),"body-cell-VER2":(0,l.k6)(function(o){return[e.mostrarXML?((0,l.uX)(),(0,l.Wv)(M,{key:0,props:o},{default:(0,l.k6)(function(){return["S"===o.row.DELECTRONICO?((0,l.uX)(),(0,l.Wv)(t,{key:0,onClick:function(t){return e.xml(o.row)},dense:"",flat:"",icon:"file_xml"},null,8,["onClick"])):(0,l.Q3)("v-if",!0)]}),_:2},1032,["props"])):(0,l.Q3)("v-if",!0)]}),_:1},8,["filter","pagination","data","columns"])]}),_:1})]}),_:1}),(0,l.bF)(k,{name:"1"},{default:(0,l.k6)(function(){return[(0,l.bF)(_,null,{default:(0,l.k6)(function(){return[(0,l.bF)(O,{class:"items"},{default:(0,l.k6)(function(){return[(0,l.Lk)("div",f,[(0,l.Lk)("div",p,[(0,l.bF)(A,{icon:"info",color:"red"},{default:(0,l.k6)(function(){return[(0,l.eW)((0,s.v_)(e.$t("avisodeudavencida")),1)]}),_:1})]),(0,l.bF)(T,{class:"q-if-outlined no-bottom","float-label":"Año",modelValue:e.selectedYear,"onUpdate:modelValue":o[5]||(o[5]=function(o){return e.selectedYear=o}),options:e.dataYear,onInput:e.getYear},null,8,["modelValue","options","onInput"])])]}),_:1}),(0,l.bF)(C),(0,l.bF)(N,{class:"no-shadow table-sie",filter:e.filter,pagination:e.pagination,"onUpdate:pagination":o[6]||(o[6]=function(o){return e.pagination=o}),"hide-bottom":!0,data:e.deudas,columns:e.columnsDeudas,"row-key":"name"},{body:(0,l.k6)(function(o){return[(0,l.bF)(h,{props:o,class:(0,s.C4)(i()({},e.compareDate(o.row.FECVEN),!0)),style:(0,s.Tr)({color:"fondoTrans"===e.compareDate(o.row.FECVEN)?"black":"white"})},{default:(0,l.k6)(function(){return[(0,l.bF)(M,{key:"CONCEPTO",props:o},{default:(0,l.k6)(function(){return[(0,l.eW)((0,s.v_)(o.row.CONCEPTO),1)]}),_:2},1032,["props"]),(0,l.bF)(M,{key:"FECVEN",props:o},{default:(0,l.k6)(function(){return[(0,l.eW)((0,s.v_)(e.date(o.row.FECVEN,"DD/MM/YYYY")),1)]}),_:2},1032,["props"]),!0===e.config.compromiso?((0,l.uX)(),(0,l.Wv)(M,{key:"FECCOM_DEUDA",props:o},{default:(0,l.k6)(function(){return[(0,l.eW)((0,s.v_)(e.date(o.row.FECCOM_DEUDA,"DD/MM/YYYY")),1),(0,l.bo)((0,l.bF)(P,{class:"text-center",onShow:e.editPopover},{default:(0,l.k6)(function(){return[(0,l.bF)(F,{options:e.fechaMaxima,modelValue:o.row.FECCOM_DEUDA,"onUpdate:modelValue":function(e){return o.row.FECCOM_DEUDA=e},onInput:e.changeDay},null,8,["options","modelValue","onUpdate:modelValue","onInput"])]}),_:2},1032,["onShow"]),[[u.aG,2===e.estado||null===e.estado||0===e.estado]]),2===e.estado||null===e.estado||0===e.estado?((0,l.uX)(),(0,l.Wv)(t,{key:0,icon:"calendar_today",roun:"",flat:"",dense:""})):(0,l.Q3)("v-if",!0)]}),_:2},1032,["props"])):(0,l.Q3)("v-if",!0),(0,l.bF)(M,{key:"MONSIG",props:o},{default:(0,l.k6)(function(){return[(0,l.eW)((0,s.v_)(o.row.MONSIG),1)]}),_:2},1032,["props"]),(0,l.bF)(M,{key:"MONTOPEN",props:o},{default:(0,l.k6)(function(){return[(0,l.eW)((0,s.v_)(e.formatNumber(o.row.MONTOPEN)),1)]}),_:2},1032,["props"]),(0,l.bF)(M,{key:"MONTODES",props:o},{default:(0,l.k6)(function(){return[(0,l.eW)((0,s.v_)(e.formatNumber(o.row.MONTODES)),1)]}),_:2},1032,["props"]),(0,l.bF)(M,{key:"SALDO",props:o},{default:(0,l.k6)(function(){return[(0,l.eW)((0,s.v_)(e.formatNumber(o.row.SALDO)),1)]}),_:2},1032,["props"]),!0===e.imprimirProvicion?((0,l.uX)(),(0,l.Wv)(M,{key:"NRODOCUMENTO",props:o},{default:(0,l.k6)(function(){return["S"===o.row.BOLEMI?((0,l.uX)(),(0,l.Wv)(t,{key:0,onClick:function(t){return e.pdf(o.row)},dense:"",flat:"",icon:"file_pdf"},null,8,["onClick"])):(0,l.Q3)("v-if",!0)]}),_:2},1032,["props"])):(0,l.Q3)("v-if",!0)]}),_:2},1032,["props","class","style"])]}),_:1},8,["filter","pagination","data","columns"])]}),_:1})]}),_:1})]}),_:1},8,["modelValue"]),e.ocultaPagos?((0,l.uX)(),(0,l.Wv)(U,{key:1,position:"bottom-right",offset:[20,20]},{default:(0,l.k6)(function(){return[(0,l.bF)(Y,{icon:"more_vert",direction:"up",color:"secondary"},{default:(0,l.k6)(function(){return[(0,l.bF)(y,{color:"secondary",icon:"print",onClick:e.reporte},{default:(0,l.k6)(function(){return[(0,l.bF)(S,{anchor:"center left",self:"center right"},{default:(0,l.k6)(function(){return n()(o[12]||(o[12]=[(0,l.eW)("Imprimir",-1)]))}),_:1})]}),_:1},8,["onClick"]),e.config.compromiso?(0,l.bo)(((0,l.uX)(),(0,l.Wv)(y,{key:0,color:"secondary",icon:"save",onClick:o[8]||(o[8]=function(o){return e.verificarRegistrosModificados(!0)})},{default:(0,l.k6)(function(){return[(0,l.bF)(S,{anchor:"center left",self:"center right"},{default:(0,l.k6)(function(){return n()(o[13]||(o[13]=[(0,l.eW)("Guardar",-1)]))}),_:1})]}),_:1},512)),[[u.aG,2===e.estado||null===e.estado||0===e.estado]]):(0,l.Q3)("v-if",!0)]}),_:1})]}),_:1})):(0,l.Q3)("v-if",!0),(0,l.bF)(I,{modelValue:e.openModal,"onUpdate:modelValue":o[10]||(o[10]=function(o){return e.openModal=o}),title:"Solicitud de compromiso",onSubmit:e.guardarCompromiso},{default:(0,l.k6)(function(){return[(0,l.Lk)("div",b,[(0,l.Lk)("div",g,[(0,l.bF)(R,{type:"textarea",modelValue:e.params.observacion,"onUpdate:modelValue":o[9]||(o[9]=function(o){return e.params.observacion=o}),label:"Motivo"},null,8,["modelValue"])])])]}),_:1},8,["modelValue","onSubmit"]),(0,l.bF)(I,{class:"detalle-modal",modelValue:e.visor.modal,"onUpdate:modelValue":o[11]||(o[11]=function(o){return e.visor.modal=o}),title:e.visor.title,header:!0,ok:!1,footer:!1},{default:(0,l.k6)(function(){return[e.visor.url?((0,l.uX)(),(0,l.Wv)(V,{key:0,class:"col",src:e.visor.url,style:{"min-height":"100vh","min-width":"60vw"}},null,8,["src"])):(0,l.Q3)("v-if",!0)]}),_:1},8,["modelValue","title"])]}),_:1})}var O=t(99550),C=t.n(O),E=t(76080),v=t.n(E),h=t(45254),M=t.n(h),N=(t(30683),t(39866),t(23825),t(77507),t(52133),t(10239),t(89571),t(49790),t(32740),t(33186),t(45531),t(15683),t(6724),t(70199),t(11777),t(515),t(52776),t(62692),t(66307),t(81813),t(43851),t(72954),t(52321),t(12421),t(5993),t(19477),t(23302),t(96351),t(2318),t(42452),t(13765),t(15995),t(74369),t(2022),t(39994),t(26992),t(69307),t(71376),t(47998),t(79901),t(67236),t(63018),t(93056),t(22092),t(29880),t(37275),t(93568),t(55516),t(48635),t(37179),t(9048),t(7346),t(89710),t(3208),t(48592),t(55130),t(906),t(27360),t(24066),t(60858),t(64702),t(53514),t(57053),t(94013),t(32701),t(67396),t(50923),t(59502),t(92173)),_=t(80660),k=t(18105),A=t(6123),T=t(57668),F=t(81288),P=t(78131),w=t(49405),S=t(56089),y=t(80340),Y=t(84603),U=t(30640),R=t(9736),I=t(11654),V=t(4437),L=t(95477),Q=t(96303),q=t(982),G=function(e){for(var o=window.atob(e),t=o.length,a=new Uint8Array(t),n=0;n<t;n++)a[n]=o.charCodeAt(n);return a.buffer},W=function(e,o){var t=window.webkitURL||window.URL,a=t.createObjectURL(e);(0,P["default"])(a,o,function(){return t.revokeObjectURL(a)})},X={components:{QFabAction:A.B$,QFab:A.l6,QField:Q.A,QPopupEdit:A.GT,QBtn:I.A,QDate:V.A,QPopupProxy:L.A,QInput:R.A,sieEstudiantes:N.Ay,QTabs:A.uw,QTab:A.zu,QSelect:A.Si,QTabPane:A.dg,QDatetime:A.T5,QTable:A.kH,QTr:A.qh,QTh:A.EJ,QTd:A.Ef,QPageSticky:A._U,QChip:A.wQ,QIframe:S.A,sieVacio:y.A,siePdf:Y.A,sieModal:U.A,QPage:A.Tu,QCard:A.C$,QCardMain:A.d1,QCardSeparator:A.d6,QSearch:A.Ks,QTooltip:A.nC},data:function(){return{mostrarPDF:!1,mostrarXML:!1,imprimirProvicion:!1,flagQRCODE:!1,colcod:"",alucod:"",ocultaPagos:!1,url:[],showme:!0,selectedYear:"T",dataYear:[],selected:null,pagos:[],deudas:[],oldDeudas:[],reciboFisico:!1,clientesCompromiso:["0010","0035","0057","0077","0110","0126","0160","0161","0162","0163","0164","0165"],dateIni:new Date("01/01/"+(0,T["default"])().ano),dateFin:new Date,filter:"",activaTabSegundo:!1,pagination:{page:1,rowsPerPage:1e3},columnsPagos:[{name:"FECPAG",label:"Fecha",align:"left",field:function(e){return(0,k.Ay)(e.FECPAG,"DD/MM/YYYY")},sortable:!0},{name:"CONCEPTO",label:"Concepto",align:"left",field:"CONCEPTO",sortable:!0},{name:"MONSIG",label:"Moneda",align:"center",field:"MONSIG",sortable:!0},{name:"MONTOCOB",label:"Importe",align:"right",field:function(e){return(0,w.formatNumber)(e.MONTOCOB,2,"en")},sortable:!0},{name:"MONTODES",label:"Desc.",align:"right",field:function(e){return(0,w.formatNumber)(e.MONTODES,2,"en")},sortable:!0},{name:"MONTOMOR",label:"Mora",align:"right",field:function(e){return(0,w.formatNumber)(e.MONTOMOR,2,"en")},sortable:!0},{name:"MONTOPAG",label:"Total",align:"right",field:function(e){return(0,w.formatNumber)(e.MONTOPAG,2,"en")},sortable:!0}],columnsDeudas:[{name:"CONCEPTO",label:"Concepto",align:"left",field:"CONCEPTO",sortable:!0},{name:"FECVEN",label:"F.Vencimiento",align:"center",field:function(e){return(0,k.Ay)(e.FECVEN,"DD/MM/YYYY")},sortable:!0},{name:"MONSIG",label:"Moneda",align:"center",field:"MONSIG",sortable:!0},{name:"MONTOPEN",label:"Monto",align:"right",field:function(e){return(0,w.formatNumber)(e.MONTOPEN,2,"en")},sortable:!0},{name:"MONTODES",label:"Desc.",align:"right",field:function(e){return(0,w.formatNumber)(e.MONTODES,2,"en")},sortable:!0},{name:"SALDO",label:"Saldo",align:"right",field:function(e){return(0,w.formatNumber)(e.SALDO,2,"en")},sortable:!0}],selectReporte:"0",visor:{modal:!1,title:""},compromisoActual:!1,openModal:!1,params:{observacion:""},estado:null,compromisosModificados:{},config:{fecha_maximo:(new Date).toISOString()},addColumn:!1,TESORERIA:26,usaTesoreria:!1}},computed:{isGreater:function(){return(0,F.isGreater)()},isLess:function(){return(0,F.isLess)()}},methods:{date:k.Ay,formatNumber:function(e){var o=new Intl.NumberFormat("en",{minimumFractionDigits:2}).format(e);return o},fechaMaxima:function(e){return e>=(0,k.Ay)(new Date,"YYYY/MM/DD")&&e<=(0,k.Ay)(new Date(this.config.fecha_maximo.split("T")[0].replaceAll("-","/")),"YYYY/MM/DD")},verificarRegistrosModificados:function(){var e=arguments,o=this;return M()(v()().m(function t(){var a,n,r,i,l,s,u,c,d,m;return v()().w(function(t){while(1)switch(t.n){case 0:for(a=!(e.length>0&&void 0!==e[0])||e[0],n=o.oldDeudas.length,r=[],i="",l=null,s=0;s<n;s++)u=o.deudas[s],c=o.oldDeudas[s],u.ID_COMPROMISO&&null!==u.ID_COMPROMISO&&(i=String(u.ID_COMPROMISO)),u.ESTADO&&(l=u.ESTADO),u.FECCOM_DEUDA!==c.FECCOM_DEUDA&&(u.FECCOM_DEUDA=new Date(u.FECCOM_DEUDA).toLocaleDateString().split("/").reverse().join("/"),d={FECCOM_DEUDA:u.FECCOM_DEUDA,ID_DEUDA:u.ID_DEUDA},o.compromisosModificados[u.ID_DEUDA]=d,r.push(u.ID_DEUDA));if(Object.keys(o.compromisosModificados).length<1?(0,q["default"])("No hay cambios realizados.","warning"):o.openModal=!0,!0!==a){t.n=3;break}if(!i){t.n=2;break}return t.n=1,_.$http.post("api/HyoCompromiso/getCompromiso",{idCompromiso:i});case 1:m=t.v,o.params.observacion=m.OBSERVA,t.n=3;break;case 2:o.params.observacion="";case 3:return t.a(2,{result:r,idCompromiso:i,estado:l})}},t)}))()},guardarCompromiso:function(){var e=this;return M()(v()().m(function o(){var t,a,n,r,i;return v()().w(function(o){while(1)switch(o.p=o.n){case 0:if(""!==e.params.observacion){o.n=1;break}(0,q["default"])("Debe ingresar un motivo.","warning"),o.n=6;break;case 1:return e.compromisosModificados={},o.n=2,e.verificarRegistrosModificados(!1);case 2:return t=o.v,a=t.result,n=t.idCompromiso,r={alucod:e.alucod,observacion:e.params.observacion,fechasCompromiso:e.compromisosModificados,idCompromiso:n,ids:a},o.p=3,o.n=4,_.$http.post("api/HyoCompromiso/guardarCompromiso",r);case 4:i=o.v,e.params.observacion="",e.openModal=!1,e.getPagos(e.selected,!0),(0,q["default"])(i.message,"success"),o.n=6;break;case 5:o.p=5,o.v,(0,q["default"])("Ha ocurrido un problema vuelve a intentarlo.","warning");case 6:return o.a(2)}},o,null,[[3,5]])}))()},mostrarRef:function(){console.log(this.$refs.date)},getYear:function(e){this.getDeudas(this.selected,e)},getYears:function(e){var o=this;_.$http.get("api/HyoAlumnos/anoestudio",{params:{parametros:{alucod:e.ALUCOD,campos:["ano"]}}}).then(function(e){o.dataYear=[{value:"T",label:"Todos"}];var t=e.json.map(function(e){var o=e.ANO;return{label:o,value:o}});o.dataYear=o.dataYear.concat(t)})},getTotalDaysFromDate:function(e){var o=e.split("/"),t=o[0],a=o[1],n=o[2];return 12*parseInt(n)*30+30*parseInt(a)+t},compareDate:function(e){e=this.getTotalDaysFromDate((0,k.Ay)(e,"DD/MM/YYYY"));var o=this.getTotalDaysFromDate((0,k.Ay)(new Date,"DD/MM/YYYY"));return e<o?"fondoColor":"fondoTrans"},getDeudas:function(e){var o=arguments,t=this;return M()(v()().m(function a(){var n,r,i;return v()().w(function(a){while(1)switch(a.n){case 0:if(n=o.length>1&&void 0!==o[1]?o[1]:"T",r=o.length>2&&void 0!==o[2]&&o[2],!t.usaTesoreria){a.n=2;break}return t.getYears(e),a.n=1,_.$http.get("api/cobroController/getDeudasEstadoCuentaIntranet",{params:{params:{ALUCOD:e.ALUCOD,ANO:n}}});case 1:return i=a.v,i=i.map(function(e){return e.SALDO=Number(e.MONTOPEN),e.MONTOPEN+=Number(e.MONTODES),e}),t.deudas=i,a.a(2,!0);case 2:_.$http.get("api/HyoCobros/obtDeudasEECC",{params:{alucod:e.ALUCOD,ano:n}}).then(function(o){o.json.deudas.map(function(e){e.FECCOM_DEUDA=(0,k.Ay)(e.FECCOM_DEUDA,"YYYY/MM/DD")}),t.deudas=o.json.deudas,t.oldDeudas=JSON.parse(JSON.stringify(o.json.deudas));var a=t.deudas.length;t.estado="";for(var n=0;n<a;n++){var i=t.deudas[0];(i.ESTADO||null===i.ESTADO)&&(t.estado=i.ESTADO)}o.json.config.fecha_maximo=o.json.config.fecha_maximo||new Date("2099/01/01").toISOString(),t.config=o.json.config,t.clientesCompromiso.includes(t.colcod)&&t.config.compromiso?t.addColumn||(t.compromisoActual=!0,t.columnsDeudas.splice(2,0,{name:"FECCOM_DEUDA",label:"F.Compromiso",align:"center",field:"FECCOM_DEUDA",sortable:!1}),t.addColumn=!0):!0===t.addColumn&&!1===t.config.compromiso&&(t.columnsDeudas.splice(2,1),t.addColumn=!1),r&&t.getYears(e)});case 3:return a.a(2)}},a)}))()},pagosSistema:function(){var e=this;_.$http.get("api/HyoSistemasWeb/obtEstadoSistemas",{params:{sistemas:"02"}}).then(function(o){var t=o.json;e.ocultaPagos=1!==t[0].EST})},getPagos:function(e,o){var t=this;this.compromisosModificados={},_.$http.get("api/HyoCobros/obtPagosEECC",{params:{alucod:e.ALUCOD,fecfin:this.dateFin,fecini:this.dateIni}}).then(function(a){e||(e={ALUCOD:0}),t.selected=e,t.pagos=a.json,o&&t.getDeudas(e,void 0,!0)})},selectEstudiante:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selected,o=(0,T["default"])(),t=(0,F.isLess)()?"D":"I";this.url=[o.url+"/servicios-pensiones/reporte-pago-intranet/alucod/"+e.ALUCOD+"/fecha_de/"+(0,k.Ay)(this.dateIni,"DD-MM-YYYY")+"/fecha_hasta/"+(0,k.Ay)(this.dateFin,"DD-MM-YYYY")+"/usucod/"+o.usucod+"/output/"+t+"/case/reporte",o.url+"/servicios-pensiones/reporte-saldo-intranet/alucod/"+e.ALUCOD+"/anio/"+this.selectedYear+"/usucod/"+o.usucod+"/output/"+t+"/case/reporte"],this.pagosSistema(),this.getPagos(e,!0)},fec:function(){var e=(0,T["default"])(),o=this.selected;this.selected||(o={ALUCOD:0}),this.url[0]=e.url+"/servicios-pensiones/reporte-pago-intranet/alucod/"+o.ALUCOD+"/fecha_de/"+(0,k.Ay)(this.dateIni,"DD-MM-YYYY")+"/fecha_hasta/"+(0,k.Ay)(this.dateFin,"DD-MM-YYYY")+"/usucod/"+e.usucod+"/case/reporte"},getDate:function(){this.selected?(this.fec(),this.getPagos(this.selected,!1)):console.log("Nothing")},utf8_to_b64:function(e){return window.btoa(unescape(encodeURIComponent(e)))},pdf:function(e){var o=this;return M()(v()().m(function t(){var a,n;return v()().w(function(t){while(1)switch(t.n){case 0:a=(0,T["default"])(),n={controller:"servicios-pensiones",action:"generar-doc-electronico-remoto/showline/1",params:"numtal/"+e.TALONDOC+"/numpag/"+e.NUMERODOC},o.usaTesoreria?(o.visor.modal=!0,o.visor.title="".concat(e.NUMTAL,"-").concat(e.NUMPAG),o.visor.url=a.url+"/webservice/servicios-tesoreria/reporte?module=intranet&siscod=21&numtal=".concat(e.NUMTAL,"&numpag=").concat(e.NUMPAG)):(o.visor.modal=!0,o.visor.title=e.TALONDOC+"-"+e.NUMERODOC,!0===o.flagQRCODE?(o.reciboFisico&&"N"===e.DELECTRONICO&&(n.action="generar-recibo-remoto",n.params=n.params+"/alucod/"+o.alucod),o.visor.url=a.url+"/"+n.controller+"/"+n.action+"/"+n.params):_.$http.get("api/documento-electronico/obtener-documento-pdf",{params:{numpag:e.NUMPAG,numtal:e.NUMTAL}}).then(function(e){var o=new Blob([G(e.obtenerDocumentoPdf.documento)],{type:"application/pdf"});W(o,e.obtenerDocumentoPdf.correlativo+".pdf")}));case 1:return t.a(2)}},t)}))()},xml:function(e){var o=this;return M()(v()().m(function t(){var a,n,r,i,l,s;return v()().w(function(t){while(1)switch(t.n){case 0:if(!o.usaTesoreria){t.n=4;break}return t.n=1,_.$http.get("api/PagoController/getComprobante",{params:{parametros:{numtal:e.NUMTAL,numpag:e.NUMPAG}}});case 1:if(a=t.v,n=C()(a,1),r=n[0],"undefined"!==typeof r&&0!==Object.keys(r).length){t.n=2;break}return t.a(2,o.$alert("No se encontro datos del comprobante"));case 2:return i={CODSUNAT:r.CODSUNAT,SERIE:r.SERIE,NUMTAL:r.NUMTAL,NUMPAG:r.NUMPAG,TIPODOCUMENTO:"zip"},t.n=3,_.$http.get("api/TesoreriaServiciosController/getDatosXml",{params:{datosXml:i}});case 3:l=t.v,s=atob(l),window.open("".concat(location.origin,"/").concat(_.API_LMS,"/api/TesoreriaServiciosController/getDownloadField?token=").concat(btoa(s))),t.n=5;break;case 4:_.$http.get("api/documento-electronico/obtener-documento-xml",{params:{numpag:e.NUMPAG,numtal:e.NUMTAL}}).then(function(o){var t=e.NUMERO_PAGO+".xml",a=new Blob([o.obtenerDocumentoXml.xml_envio],{type:"text/xml;charset=utf-8"});W(a,t)});case 5:return t.a(2)}},t)}))()},reporte:function(){this.visor.modal=!0,this.visor.title="Reporte",this.visor.url=this.url[this.selectReporte]},changeDay:function(){document.body.querySelector(".q-popover")&&document.body.querySelector(".q-popover").remove()},editPopover:function(){var e=document.body.querySelector(".q-popover").style;e["box-shadow"]="none",e.background="transparent",e.overflow="hidden",e["max-height"]="100%"}},created:function(){var e=this;return M()(v()().m(function o(){var t,a,r,i,l,s,u;return v()().w(function(o){while(1)switch(o.n){case 0:return e.colcod=(0,T["default"])().colcod,["0460"].includes(e.colcod)||e.columnsPagos.splice(0,0,{name:"NUMERO_PAGO",label:"Nro. Documento",align:"left",field:"NUMERO_PAGO",sortable:!0}),["0073"].includes(e.colcod)&&(e.activaTabSegundo=!0),"0042"===e.colcod&&e.columnsPagos.splice(3,0,{name:"FECVEN",label:"F. Vencimiento",align:"left",field:function(e){return(0,k.Ay)(e.FECVEN,"DD/MM/YYYY")},sortable:!0}),o.n=1,_.$http.get("api/ConstanteSistemaController/getSistemasPorCodigo",{params:{params:{SISCOD:e.TESORERIA}}});case 1:if(t=o.v,t.length>0&&(a=n()(t),r=a[0],e.usaTesoreria=1===Number(r.ESTADO)),!e.usaTesoreria){o.n=3;break}return i={ID_CONSTANTE:[28,52,128]},o.n=2,_.$http.get("api/ConstanteSistemaController/getConstanteSistema",{params:{parametros:i}});case 2:l=o.v,e.mostrarPDF=Boolean(Number(l.P_EMITE_DE))||Boolean(Number(l.P_VER_RECIBO)),e.imprimirProvicion=Boolean(Number(l.P_IMP_PROV_INTRANET)),e.mostrarXML=Boolean(Number(l.P_EMITE_DE)),e.flagQRCODE=Boolean(Number(l.P_EMITE_DE)),e.reciboFisico=Boolean(Number(l.P_VER_RECIBO)),(e.mostrarPDF||e.reciboFisico)&&e.columnsPagos.push({name:"VER1",label:"Ver",align:"right",sortable:!1}),e.imprimirProvicion&&e.columnsDeudas.push({name:"NRODOCUMENTO",label:"Ver",align:"center",field:"NRODOCUMENTO"}),e.mostrarXML&&e.columnsPagos.push({name:"VER2",label:"",align:"left",sortable:!1}),o.n=5;break;case 3:return s={ID_CONSTANTE:[52]},o.n=4,_.$http.get("api/ConstanteSistemaController/getConstanteSistema",{params:{parametros:s}});case 4:u=o.v,e.reciboFisico=Boolean(Number(u.P_VER_RECIBO)),(0,F.constantes)(["P_EMITE_DE","P_PROVEEDOR_DOCELEC","P_QRCODE"]).then(function(o){e.mostrarPDF=o.P_EMITE_DE&&"HYO"===o.P_PROVEEDOR_DOCELEC||e.reciboFisico,e.mostrarXML=o.P_EMITE_DE&&"HYO"===o.P_PROVEEDOR_DOCELEC,e.flagQRCODE=o.P_QRCODE,e.mostrarPDF&&e.columnsPagos.push({name:"VER1",label:"Ver",align:"right",sortable:!1}),e.mostrarXML&&e.columnsPagos.push({name:"VER2",label:"",align:"left",sortable:!1})});case 5:return o.a(2)}},o)}))()}},x=t(12807);const $=(0,x.A)(X,[["render",D]]);var B=$}}]);