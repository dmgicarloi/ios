"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[79748],{79748:function(e,r,t){t.r(r),t.d(r,{default:function(){return ae}});t(71225),t(50310),t(5962),t(83190);var n=t(61758),a=t(29104),l={class:"row q-col-gutter-sm"},o={class:"col-xs-12 col-sm-3"},i={class:"col-xs-12"},s={class:"col-xs-12"},c={class:"row q-pa-sm q-col-gutter-sm"},u={class:"col-12 sie-flat"},d={class:"row q-pa-sm q-col-gutter-sm"},f={class:"col-xs-12"},m={class:"row q-pa-xs"},p={class:"col-xs-12"};function E(e,r){var t=this,E=(0,n.g2)("q-select"),U=(0,n.g2)("header-btn"),O=(0,n.g2)("sie-table"),I=(0,n.g2)("q-card-section"),D=(0,n.g2)("q-card"),A=(0,n.g2)("sie-modal"),R=(0,n.g2)("multi-ng"),w=(0,n.g2)("utiles"),N=(0,n.g2)("q-form"),v=(0,n.g2)("q-page");return(0,n.uX)(),(0,n.Wv)(v,{class:"q-pa-sm sie-flat"},{default:(0,n.k6)(function(){return[(0,n.bF)(D,{flat:"",bordered:""},{default:(0,n.k6)(function(){return[(0,n.bF)(I,null,{default:(0,n.k6)(function(){return[(0,n.Lk)("div",l,[(0,n.Lk)("div",o,[(0,n.bF)(E,{modelValue:e.filter.anio,"onUpdate:modelValue":r[0]||(r[0]=function(r){return e.filter.anio=r}),options:e.anios,"option-value":"ANO","option-label":"ANO","emit-value":"",label:"Año",onInput:e.readUtilEscolar},null,8,["modelValue","options","onInput"])]),(0,n.Lk)("div",i,[(0,n.bF)(U,{name:"Útiles Escolares",auto:!1,buttons:e.buttons},null,8,["buttons"])]),(0,n.Lk)("div",s,[(0,n.bF)(O,{type:"normal",data:e.rows,columns:e.fields,config:e.config,selection:"single","save-cells":"",ref:"tableUtilEscolar",onRowSelected:e.rowSelectUtilEscolar,css:"height:calc(100vh - 170px)",context:t},null,8,["data","columns","config","onRowSelected"])])])]}),_:1})]}),_:1}),(0,n.bF)(A,{esc:"","esc-click":"",modelValue:e.openUtilesDetallado,"onUpdate:modelValue":r[1]||(r[1]=function(r){return e.openUtilesDetallado=r}),footer:!1,css:{width:"550px"},title:"Útiles Escolares"},{default:(0,n.k6)(function(){return[(0,n.Lk)("div",c,[(0,n.Lk)("div",u,[(0,n.bF)(O,{data:e.rowsUtilesDetallado,columns:e.fieldsUtilesDetallado,config:e.configUtilesDetallado,ref:"tableUtilesEscolares","virtual-scroll":!1,css:"height:400px","show-search":!1,context:t},null,8,["data","columns","config"])])])]}),_:1},8,["modelValue"]),(0,n.bF)(A,{esc:"","esc-click":"",modelValue:e.openAdd,"onUpdate:modelValue":r[3]||(r[3]=function(r){return e.openAdd=r}),css:{width:"700px"},title:"create"===e.action?"Agregar":"Modificar",onSubmit:e.saveAcccion,ok:"create"===e.action?"Guardar":"Cerrar","before-close":e.beforeClose},{default:(0,n.k6)(function(){return[(0,n.bF)(N,{ref:"refForm"},{default:(0,n.k6)(function(){var l;return[(0,n.bo)((0,n.Lk)("div",d,[(0,n.Lk)("div",f,[(0,n.bF)(E,{disable:"",modelValue:e.form.ANO,"onUpdate:modelValue":r[2]||(r[2]=function(r){return e.form.ANO=r}),options:e.anios,"option-value":"ANO","option-label":"ANO",label:"Año",rules:[e.required]},null,8,["modelValue","options","rules"])])],512),[[a.aG,!1]]),(0,n.bF)(R,{class:"q-pa-sm q-col-gutter-sm",disables:{nivel:"update"===t.action,grado:"update"===t.action},n:e.n,g:e.g,ref:"refMultiGn","class-nivel":"col-xs-12 col-sm-4","class-grado":"col-xs-12 col-sm-3","multiple-nivel":!1},null,8,["disables","n","g"]),(0,n.Lk)("div",m,[(0,n.Lk)("div",p,[(0,n.bF)(w,{"parent-action":e.action,"nivel-grado":(null===(l=e.$refs)||void 0===l||null===(l=l.refMultiGn)||void 0===l?void 0:l.getNivelGrado())||[],ref:"utiles","load-data":e.loadData,"row-util-escolar":e.rowUtilEscolar,anio:e.filter.anio},null,8,["parent-action","nivel-grado","load-data","row-util-escolar","anio"])])])]}),_:1},512)]}),_:1},8,["modelValue","title","onSubmit","ok","before-close"])]}),_:1})}var U=t(76080),O=t.n(U),I=t(45254),D=t.n(I),A=(t(52133),t(89571),t(6724),t(70199),t(6123)),R=t(2819),w={data:function(){return{config:{ACTION:{component:"button",icon:["test as ver","edit as editar"],ver:function(e){var r=this;return D()(O()().m(function t(){return O()().w(function(t){while(1)switch(t.n){case 0:return r.openUtilesDetallado=!0,t.n=1,r.readUtilesEscolares(e.ID_UTIL_ESCOLAR);case 1:return t.a(2)}},t)}))()},editar:function(e,r){var t=this;return D()(O()().m(function n(){return O()().w(function(n){while(1)switch(n.n){case 0:return t.rowUtilEscolar=r,n.n=1,t.openActualizar(e);case 1:return n.a(2)}},n)}))()},pdf:function(e){var r={report_cod:"utilesescolares",ID_UTIL_ESCOLAR:e.ID_UTIL_ESCOLAR};(0,R.exportFilePhp)(r,"webservice/reportes-almacen/reporte")},tooltip:{ver:"Lista de útiles",editar:"Editar"},permisos:{editar:">1"},flat:!0,dense:!0}},rows:[],fields:[{name:"ID_UTIL_ESCOLAR",label:"Código",field:"ID_UTIL_ESCOLAR",align:"left",sortable:!0},{name:"ANO",label:"Año",field:"ANO",align:"left",sortable:!0},{name:"INSTRUDES",label:"Nivel",field:"INSTRUDES",align:"left",sortable:!0},{name:"GRADINIVDES",label:"Grados",field:"GRADINIVDES",align:"left",sortable:!0},{name:"ACTION",label:"Acción",field:"ACTION",align:"center",width:80}]}}},N=(t(30683),t(10239),t(11768)),v={data:function(){return{configUtilesDetallado:{GRUPO:{renderHtml:function(e,r){return e.CABECERA?r("b",{},e.GRUPO):r("span",{},"")}},DESCRIPCION:{renderHtml:function(e,r){return r("span",{style:"".concat(1===e.SUBGRUPO?"font-weight: bold":"")},e.DESCRIPCION)}}},rowsUtilesDetallado:[],fieldsUtilesDetallado:[{name:"GRUPO",label:"Grupo",field:"GRUPO",align:"left",sortable:!0,width:100,wrap:!0},{name:"NGS",label:"Sección",field:"NGS",align:"center",sortable:!0,width:80,wrap:!0},{name:"NOMCOMP",label:"Persona",field:"NOMCOMP",align:"left",sortable:!0,width:80,wrap:!0},{name:"DESCRIPCION",label:"Útil Escolar",field:"DESCRIPCION",align:"left",wrap:!0},{name:"CANTIDAD",label:"Cantidad",field:"CANTIDAD",align:"center"}]}},methods:{readUtilesEscolares:function(){var e=arguments,r=this;return D()(O()().m(function t(){var n,a,l,o,i,s,c,u,d;return O()().w(function(t){while(1)switch(t.p=t.n){case 0:return n=e.length>0&&void 0!==e[0]?e[0]:0,t.p=1,t.n=2,r.$http.get("api/UtilesEscolaresUtilesController/getListarDetallado",{params:{parametros:{ID_UTIL_ESCOLAR:n}}});case 2:for(i in a=t.v,l=[],o=(0,N.A)(a,["GRUPO"],!0),o)s=o[i],c=s.data,u=s.info,l.push({CABECERA:!0,GRUPO:u.GRUPO,DETALLE:u.DETALLE||""}),l=l.concat(c);r.rowsUtilesDetallado=l,t.n=4;break;case 3:t.p=3,d=t.v,r.$notify(d.message,"warning");case 4:return t.a(2)}},t,null,[[1,3]])}))()}}},C=t(39893),b=t(81288),g=t(2739),L=t(9736),S=t(16648),h=t(88567),_=t(3112),G=t(95718),T=t(25662),P={class:"row q-col-gutter-sm"},k={class:"col-xs-12"},$={class:"col-xs-12 sie-flat"},V={class:"row q-pa-sm q-col-gutter-sm"},M={class:"col-xs-12"},B={class:"row q-pa-sm q-col-gutter-sm"},y={class:"col-xs-12"},x={class:"col-xs-12"},F={class:"col-xs-12"},q={class:"col-xs-12"},Q={class:"col-xs-12"},z={class:"row justify-center q-gutter-md"},H={class:"col-xs-12"},j={class:"col-xs-12"},J={key:0,class:"col-xs-12"};function X(e,r){var t=(0,n.g2)("header-btn"),a=(0,n.g2)("sie-table"),l=(0,n.g2)("q-input"),o=(0,n.g2)("q-form"),i=(0,n.g2)("sie-modal"),s=(0,n.g2)("q-select"),c=(0,n.g2)("q-checkbox");return(0,n.uX)(),(0,n.CE)("div",P,[(0,n.Lk)("div",k,[(0,n.bF)(t,{name:"Útiles","padding-x":"q-px-xs","font-size":"16px",buttons:e.buttons},null,8,["buttons"])]),(0,n.Lk)("div",$,[(0,n.bF)(a,{type:"normal",data:e.rowsutilesAgrupado,columns:e.fields,config:e.config,selection:"single","save-cells":"","virtual-scroll":!1,ref:"tableUtilesEscolaresUtiles",onRowSelected:e.rowSelectUtilesEscolaresUtiles,css:"height:400px",context:this},null,8,["data","columns","config","onRowSelected"])]),(0,n.bF)(i,{esc:"","esc-click":"",modelValue:e.openModalDetalle,"onUpdate:modelValue":r[1]||(r[1]=function(r){return e.openModalDetalle=r}),css:{width:"300px"},title:"create"===e.action?"Agregar Detalle":"Modificar Detalle",onSubmit:e.saveDetalle},{default:(0,n.k6)(function(){return[(0,n.bF)(o,{ref:"refFormDetalle"},{default:(0,n.k6)(function(){return[(0,n.Lk)("div",V,[(0,n.Lk)("div",M,[(0,n.bF)(l,{type:"textarea",modelValue:e.rowCabceraGrupo.DETALLE,"onUpdate:modelValue":r[0]||(r[0]=function(r){return e.rowCabceraGrupo.DETALLE=r}),label:"Detalle"},null,8,["modelValue"])])])]}),_:1},512)]}),_:1},8,["modelValue","title","onSubmit"]),(0,n.bF)(i,{esc:"","esc-click":"",modelValue:e.openAdd,"onUpdate:modelValue":r[12]||(r[12]=function(r){return e.openAdd=r}),css:{width:"500px"},title:"create"===e.action?"Agregar":"Modificar",onSubmit:e.saveAcccion},{default:(0,n.k6)(function(){return[(0,n.bF)(o,{ref:"refForm"},{default:(0,n.k6)(function(){return[(0,n.Lk)("div",B,[(0,n.Lk)("div",y,[(0,n.bF)(s,{disable:"update"===e.action,modelValue:e.form.ID_UTIL_GRUPO,"onUpdate:modelValue":r[2]||(r[2]=function(r){return e.form.ID_UTIL_GRUPO=r}),options:e.grupos,"option-value":"ID_UTIL_GRUPO","option-label":"DESCRIPCION","emit-value":"",label:"Grupo",rules:[e.required],onInput:e.cambiarGrupo},null,8,["disable","modelValue","options","rules","onInput"])]),(0,n.Lk)("div",x,[(0,n.bF)(s,{disable:"update"===e.action,modelValue:e.form.NEMO,"onUpdate:modelValue":r[3]||(r[3]=function(r){return e.form.NEMO=r}),options:e.salones,"option-value":"NEMO","option-label":"NEMODES","emit-value":"",label:"Sección (Opcional)",onInput:e.seleccionarSeccion},null,8,["disable","modelValue","options","onInput"])]),(0,n.Lk)("div",F,[(0,n.bF)(s,{disable:"update"===e.action,modelValue:e.form.ID_PERSONA,"onUpdate:modelValue":r[4]||(r[4]=function(r){return e.form.ID_PERSONA=r}),options:e.alucods,label:"Alumno","emit-value":"","option-value":"ID_PERSONA","option-label":"NOMCOMP"},null,8,["disable","modelValue","options"])]),(0,n.Lk)("div",q,[(0,n.bF)(l,{type:"textarea",modelValue:e.form.DESCRIPCION,"onUpdate:modelValue":r[5]||(r[5]=function(r){return e.form.DESCRIPCION=r}),label:"Útil Solicitado",rules:[e.required]},null,8,["modelValue","rules"])]),(0,n.Lk)("div",Q,[(0,n.Lk)("div",z,[(0,n.bF)(c,{dense:"",modelValue:e.form.SUBGRUPO,"onUpdate:modelValue":r[6]||(r[6]=function(r){return e.form.SUBGRUPO=r}),"true-value":1,"false-value":0,label:"Subgrupo"},null,8,["modelValue"]),(0,n.bF)(c,{dense:"",modelValue:e.limpiarUtilSolicitado,"onUpdate:modelValue":r[7]||(r[7]=function(r){return e.limpiarUtilSolicitado=r}),label:"Limpiar"},null,8,["modelValue"]),(0,n.bF)(c,{dense:"",modelValue:e.form.ENTREGABLE,"onUpdate:modelValue":r[8]||(r[8]=function(r){return e.form.ENTREGABLE=r}),"true-value":1,"false-value":0,label:"Entregable"},null,8,["modelValue"])])]),(0,n.Lk)("div",H,[(0,n.bF)(l,{modelValue:e.form.CANTIDAD,"onUpdate:modelValue":r[9]||(r[9]=function(r){return e.form.CANTIDAD=r}),type:"number",label:"Cantidad",rules:[e.required]},null,8,["modelValue","rules"])]),(0,n.Lk)("div",j,[(0,n.bF)(l,{modelValue:e.form.ORDEN,"onUpdate:modelValue":r[10]||(r[10]=function(r){return e.form.ORDEN=r}),type:"number",label:"Orden",rules:[e.required]},null,8,["modelValue","rules"])]),"create"===e.action?((0,n.uX)(),(0,n.CE)("div",J,[(0,n.bF)(c,{dense:"",modelValue:e.repetir,"onUpdate:modelValue":r[11]||(r[11]=function(r){return e.repetir=r}),label:"Repetir"},null,8,["modelValue"])])):(0,n.Q3)("v-if",!0)])]}),_:1},512)]}),_:1},8,["modelValue","title","onSubmit"])])}t(74260),t(32203),t(11777),t(515),t(7346),t(25751);var W={data:function(){return{config:{GRUPO:{renderHtml:function(e,r){return e.CABECERA?r("b",{},e.GRUPO):r("span",{},"")}},DETALLE:{renderHtml:function(e,r,t){return e.CABECERA?t.icon({name:"file_text_o"}):r("span",{},"")},renderAction:function(e,r){this.openModalDetalle=!0,this.rowCabceraGrupo=r}},DESCRIPCION:{renderHtml:function(e,r){return r("span",{style:"".concat(1===e.SUBGRUPO?"font-weight: bold":"")},e.DESCRIPCION)}},ORDEN:{component:"input",type:"number",autoSelect:!0,input:function(e,r){return!(""===r.ORDEN)}},CANTIDAD:{component:"input",type:"number",autoSelect:!0,input:function(e,r){return!(""===r.CANTIDAD)}},ACTION:{component:"button",icon:["edit as editar","delete as eliminar"],editar:function(e,r){var t=this;return D()(O()().m(function e(){return O()().w(function(e){while(1)switch(e.n){case 0:return t.rowUtilesEscolaresUtiles=r,e.n=1,t.openActualizar();case 1:return e.a(2)}},e)}))()},eliminar:function(e,r){var t=this;return D()(O()().m(function n(){var a;return O()().w(function(n){while(1)switch(n.n){case 0:if(t.rowUtilesEscolaresUtiles=r,"update"!==t.parentAction){n.n=4;break}return n.n=1,t.$confirmar("Si elimina este útil escolar también se eliminará de la lista de checklist a todos los alumnos ¿realmente desea continuar?","delete");case 1:if(a=n.v,!a){n.n=3;break}return n.n=2,t.$http.delete("api/UtilesEscolaresUtilesController/deleteUtilesPersona",{params:{ID_UTIL_ESCOLAR_UTIL:e.ID_UTIL_ESCOLAR_UTIL}});case 2:t.rows.splice(t.rows.indexOf(r),1),t.rowUtilesEscolaresUtiles=null;case 3:n.n=5;break;case 4:return n.n=5,t.deleteUtilesEscolaresUtiles();case 5:return n.a(2)}},n)}))()},validate:{editar:function(e){return!e.CABECERA},eliminar:function(e){return!e.CABECERA}},tooltip:{editar:"Editar",eliminar:"Eliminar"},permisos:{editar:">1",eliminar:"===3"},flat:!0,dense:!0}},rowCabceraGrupo:{},openModalDetalle:!1,rows:[],fields:[{name:"GRUPO",label:"Grupo",field:"GRUPO",align:"left",sortable:!0,width:80,wrap:!0},{name:"NGS",label:"Sección",field:"NGS",align:"center",sortable:!0,width:80,wrap:!0},{name:"NOMCOMP",label:"Persona",field:"NOMCOMP",align:"left",sortable:!0,width:80,wrap:!0},{name:"DETALLE",label:"",field:"DETALLE",align:"left",sortable:!0},{name:"DESCRIPCION",label:"Útiles Solicitados",field:"DESCRIPCION",align:"left",width:250,wrap:!0},{name:"ORDEN",label:"Orden",field:"ORDEN",align:"center"},{name:"CANTIDAD",label:"Cantidad",field:"CANTIDAD",align:"center"},{name:"ACTION",label:"Acción",field:"ACTION",align:"center",width:80}]}},computed:{rowsutilesAgrupado:function(){var e=[],r=(0,N.A)(this.rows,["GRUPO"],!0);for(var t in r){var n=r[t],a=n.data,l=n.info;a.sort(function(e,r){return e.ORDEN-r.ORDEN}),e.push({CABECERA:!0,GRUPO:l.GRUPO,ID_UTIL_GRUPO:l.ID_UTIL_GRUPO,DETALLE:l.DETALLE||""}),e=e.concat(a)}return e}}},K=t(57668),Y={props:{loadData:{type:Array,default:function(){return[]}},rowUtilEscolar:{type:Object,default:function(){return{}}},parentAction:{type:String,default:"create"},nivelGrado:{type:Array,default:function(){return[]}},anio:{type:[String,Number],default:""}},mixins:[W],components:{QForm:g.A,QInput:L.A,QCheckbox:_.A,QSelect:S.A,QCard:h.A,QCardSection:G.A},data:function(){return{required:C.require,buttons:[{label:"Agregar",icon:"plus",permiso:">1",click:this.openAgregar}],grupos:[],repetir:!1,limpiarUtilSolicitado:!1,openAdd:!1,action:"create",rowUtilesEscolaresUtiles:null,salones:[],alucods:[],form:{ID_UTIL_ESCOLAR:null,ID_UTIL_GRUPO:null,DESCRIPCION:null,SUBGRUPO:0,ENTREGABLE:1,ORDEN:null,CANTIDAD:null,NEMO:null,ID_PERSONA:null},sie:(0,K["default"])()}},methods:{openAgregar:function(){var e=this;return D()(O()().m(function r(){var t;return O()().w(function(r){while(1)switch(r.n){case 0:if(!((null===(t=e.nivelGrado)||void 0===t?void 0:t.length)<1)){r.n=1;break}return e.$alert("Selecciona nivel y grado","info"),r.a(2);case 1:return e.action="create",e.rowUtilesEscolaresUtiles=null,(0,b.clear)(e.form),e.repetir=!1,e.limpiarUtilSolicitado=!1,e.form.SUBGRUPO=0,e.form.ENTREGABLE=1,e.openAdd=!0,r.n=2,e.readUtilGrupo();case 2:return r.a(2)}},r)}))()},refTableUtilesEscolaresUtiles:function(){return this.$refs.tableUtilesEscolaresUtiles},openActualizar:function(){var e=this;return D()(O()().m(function r(){return O()().w(function(r){while(1)switch(r.n){case 0:if(e.rowUtilesEscolaresUtiles){r.n=1;break}e.$notify("Selecciona un registro","info"),r.n=4;break;case 1:return e.action="update",r.n=2,e.readUtilGrupo();case 2:return e.repetir=!1,e.limpiarUtilSolicitado=!1,e.form.SUBGRUPO=e.rowUtilesEscolaresUtiles.SUBGRUPO,e.form.NEMO=e.rowUtilesEscolaresUtiles.NEMO,e.form.ENTREGABLE=e.rowUtilesEscolaresUtiles.ENTREGABLE,e.form.ID_UTIL_ESCOLAR=e.rowUtilesEscolaresUtiles.ID_UTIL_ESCOLAR,e.form.ID_UTIL_GRUPO=e.rowUtilesEscolaresUtiles.ID_UTIL_GRUPO,e.form.DESCRIPCION=e.rowUtilesEscolaresUtiles.DESCRIPCION,e.form.ORDEN=e.rowUtilesEscolaresUtiles.ORDEN,e.form.CANTIDAD=e.rowUtilesEscolaresUtiles.CANTIDAD,r.n=3,e.seleccionarSeccion();case 3:e.form.ID_PERSONA=e.rowUtilesEscolaresUtiles.ID_PERSONA,e.openAdd=!0;case 4:return r.a(2)}},r)}))()},cambiarGrupo:function(){var e=this.getDescripcionGrupo(this.form.ID_UTIL_GRUPO),r=(0,N.A)(this.rows,["GRUPO"],!0);"create"===this.action?r[e]?this.form.ORDEN=r[e].data[r[e].data.length-1].ORDEN+1:this.form.ORDEN=1:r[e]||(this.form.ORDEN=1)},getDescripcionGrupo:function(e){var r=this.grupos.find(function(r){return r.ID_UTIL_GRUPO===e})||{};return r.DESCRIPCION||""},saveDetalle:function(){var e=this;return D()(O()().m(function r(){var t;return O()().w(function(r){while(1)switch(r.p=r.n){case 0:if("create"!==e.parentAction){r.n=1;break}e.openModalDetalle=!1,r.n=4;break;case 1:return r.p=1,r.n=2,e.$http.post("api/DetalleGrupoController/updateDetalleGrupo",{ID_UTIL_ESCOLAR:e.rowUtilEscolar.ID_UTIL_ESCOLAR,ID_UTIL_GRUPO:e.rowUtilesEscolaresUtiles.ID_UTIL_GRUPO,DETALLE:e.rowCabceraGrupo.DETALLE});case 2:e.openModalDetalle=!1,e.$notify("Detalle actualizado","success"),r.n=4;break;case 3:r.p=3,t=r.v,console.log(t),e.$notify("No ha sido posible actualizar el detalle","warning");case 4:return r.a(2)}},r,null,[[1,3]])}))()},saveAcccion:function(){var e=this;return D()(O()().m(function r(){var t,n,a,l,o,i,s,c,u,d,f,m,p,E,U,I,D,A;return O()().w(function(r){while(1)switch(r.p=r.n){case 0:return r.n=1,e.$refs.refForm.validate();case 1:if(t=r.v,t){r.n=2;break}return r.a(2);case 2:if(n=null,a=null,e.salones&&e.alucods&&(n=e.salones.find(function(r){return r.NEMO===e.form.NEMO}),n&&(n.NGS=n.INSTRUCOD+n.GRADOCOD+n.SECCIONCOD),a=e.alucods.find(function(r){return r.ID_PERSONA===e.form.ID_PERSONA})),"create"!==e.action){r.n=5;break}if(s={ID_UTIL_ESCOLAR:null===(l=e.rowUtilEscolar)||void 0===l?void 0:l.ID_UTIL_ESCOLAR,ID_UTIL_GRUPO:e.form.ID_UTIL_GRUPO,DESCRIPCION:e.form.DESCRIPCION,ORDEN:e.form.ORDEN,CANTIDAD:e.form.CANTIDAD,SUBGRUPO:e.form.SUBGRUPO,ENTREGABLE:e.form.ENTREGABLE,NEMO:e.form.NEMO,NGS:(null===(o=n)||void 0===o?void 0:o.NGS)||"",ID_PERSONA:e.form.ID_PERSONA,NOMCOMP:(null===(i=a)||void 0===i?void 0:i.NOMCOMP)||""},"update"!==e.parentAction){r.n=4;break}return s={ID_UTIL_ESCOLAR:null===(c=e.rowUtilEscolar)||void 0===c?void 0:c.ID_UTIL_ESCOLAR,ID_UTIL_GRUPO:e.form.ID_UTIL_GRUPO,DESCRIPCION:e.form.DESCRIPCION,ORDEN:e.form.ORDEN,CANTIDAD:e.form.CANTIDAD,SUBGRUPO:e.form.SUBGRUPO,ENTREGABLE:e.form.ENTREGABLE,NEMO:e.form.NEMO,NGS:(null===(u=n)||void 0===u?void 0:u.NGS)||"",ID_PERSONA:e.form.ID_PERSONA,NOMCOMP:(null===(d=a)||void 0===d?void 0:d.NOMCOMP)||""},r.n=3,e.$http.post("api/UtilesEscolaresUtilesController/addUtilesEscolaresUtiles",{data:s});case 3:f=r.v,m=f.data,s.ID_UTIL_ESCOLAR_UTIL=m.ID_UTIL_ESCOLAR_UTIL;case 4:s.GRUPO=e.getDescripcionGrupo(e.form.ID_UTIL_GRUPO),e.rows.push(s),e.form.ORDEN=e.form.ORDEN||0,e.form.ORDEN=Number(e.form.ORDEN),e.form.ORDEN+=1,r.n=11;break;case 5:if(U={},"update"!==e.parentAction){r.n=10;break}return I={DESCRIPCION:e.form.DESCRIPCION,ORDEN:e.form.ORDEN,CANTIDAD:e.form.CANTIDAD,SUBGRUPO:e.form.SUBGRUPO,ENTREGABLE:e.form.ENTREGABLE},r.p=6,r.n=7,e.$http.post("api/UtilesEscolaresUtilesController/updateUtilesEscolaresUtiles",{params:I,ID_UTIL_ESCOLAR_UTIL:e.rowUtilesEscolaresUtiles.ID_UTIL_ESCOLAR_UTIL});case 7:r.n=10;break;case 8:if(r.p=8,A=r.v,!(A.msg.indexOf("transliterate character")>-1)){r.n=9;break}return e.$notify("Uno de los caracteres ingresados no es soportado","warning"),r.a(2);case 9:return e.$notify("No ha sido posible actualizar el útil escolar"),r.a(2);case 10:U.ID_UTIL_GRUPO=e.form.ID_UTIL_GRUPO,U.GRUPO=e.getDescripcionGrupo(e.form.ID_UTIL_GRUPO),D=e.$refs.tableUtilesEscolaresUtiles,D.updateRow(e.rowUtilesEscolaresUtiles,{ID_UTIL_GRUPO:e.form.ID_UTIL_GRUPO,GRUPO:e.getDescripcionGrupo(e.form.ID_UTIL_GRUPO),DESCRIPCION:e.form.DESCRIPCION,SUBGRUPO:e.form.SUBGRUPO,ENTREGABLE:e.form.ENTREGABLE,ORDEN:e.form.ORDEN,CANTIDAD:e.form.CANTIDAD,ID_UTIL_ESCOLAR_UTIL:e.rowUtilesEscolaresUtiles.ID_UTIL_ESCOLAR_UTIL,NEMO:e.form.NEMO,NGS:(null===(p=n)||void 0===p?void 0:p.NGS)||"",ID_PERSONA:e.form.ID_PERSONA,NOMCOMP:(null===(E=a)||void 0===E?void 0:E.NOMCOMP)||""});case 11:e.$notify("Util escolar agregado ","success"),!1===e.repetir&&(e.openAdd=!1),!0===e.limpiarUtilSolicitado&&(e.form.DESCRIPCION="");case 12:return r.a(2)}},r,null,[[6,8]])}))()},rowSelectUtilesEscolaresUtiles:function(e,r){this.rowUtilesEscolaresUtiles=r},createUtilesEscolaresUtiles:function(){var e=this;return D()(O()().m(function r(){var t,n,a,l;return O()().w(function(r){while(1)switch(r.p=r.n){case 0:return r.p=0,r.n=1,e.$http.post("api/utiles-escolares-utiles",e.form);case 1:t=r.v,n=t.message,a={ID_UTIL_ESCOLAR:e.form.ID_UTIL_ESCOLAR,ID_UTIL_GRUPO:e.form.ID_UTIL_GRUPO,DESCRIPCION:e.form.DESCRIPCION,SUBGRUPO:e.form.SUBGRUPO,ENTREGABLE:e.form.ENTREGABLE,ORDEN:e.form.ORDEN,CANTIDAD:e.form.CANTIDAD},e.rows.unshift(a),e.openAdd=!1,e.$notify(n,"success"),r.n=3;break;case 2:r.p=2,l=r.v,e.$notify(l.message,"warning");case 3:return r.a(2)}},r,null,[[0,2]])}))()},readUtilesEscolaresUtiles:function(){var e=this;return D()(O()().m(function r(){var t,n;return O()().w(function(r){while(1)switch(r.p=r.n){case 0:return r.p=0,r.n=1,e.$http.get("api/utiles-escolares-utiles",{params:{}});case 1:t=r.v,e.rows=t,r.n=3;break;case 2:r.p=2,n=r.v,e.$notify(n.message,"warning");case 3:return r.a(2)}},r,null,[[0,2]])}))()},readUtilGrupo:function(){var e=this;return D()(O()().m(function r(){var t,n;return O()().w(function(r){while(1)switch(r.p=r.n){case 0:return r.p=0,r.n=1,e.$http.get("api/UtilGrupoController/getUtilGrupo",{params:{}});case 1:t=r.v,e.grupos=t,r.n=3;break;case 2:r.p=2,n=r.v,e.$notify(n.message,"warning");case 3:return r.a(2)}},r,null,[[0,2]])}))()},deleteUtilesEscolaresUtiles:function(){var e=this;return D()(O()().m(function r(){var t;return O()().w(function(r){while(1)switch(r.n){case 0:if(e.rowUtilesEscolaresUtiles){r.n=1;break}e.$notify("Selecciona un registro","info"),r.n=3;break;case 1:return r.n=2,e.$confirmar("¿Estás seguro de eliminar el registro?","delete");case 2:if(t=r.v,t)try{e.rows.splice(e.rows.indexOf(e.rowUtilesEscolaresUtiles),1),e.rowUtilesEscolaresUtiles=null}catch(r){e.$notify(r.message,"warning")}case 3:return r.a(2)}},r)}))()},updateUtilesEscolaresUtiles:function(){var e=this;return D()(O()().m(function r(){var t,n,a,l;return O()().w(function(r){while(1)switch(r.p=r.n){case 0:return r.p=0,t=e.$refs.tableUtilesEscolaresUtiles,r.n=1,e.$http.put("api/utiles-escolares-utiles",{ID_UTIL_ESCOLAR:e.form.ID_UTIL_ESCOLAR,ID_UTIL_GRUPO:e.form.ID_UTIL_GRUPO,DESCRIPCION:e.form.DESCRIPCION,SUBGRUPO:e.form.SUBGRUPO,ENTREGABLE:e.form.ENTREGABLE,ORDEN:e.form.ORDEN,CANTIDAD:e.form.CANTIDAD});case 1:n=r.v,a=n.message,e.openAdd=!1,t.updateRow(e.rowUtilesEscolaresUtiles,e.form),e.$notify(a,"success"),r.n=3;break;case 2:r.p=2,l=r.v,e.$notify(l.message,"warning");case 3:return r.a(2)}},r,null,[[0,2]])}))()},getTable:function(){return this.$refs.tableUtilesEscolaresUtiles},readAlumnos:function(){var e=this;return D()(O()().m(function r(){var t,n,a,l,o,i,s;return O()().w(function(r){while(1)switch(r.p=r.n){case 0:return r.p=0,t=e.sie,n=t.tipcod,a=t.famcod,l={nemo:e.form.NEMO},"004"===n&&(l.famcod=a),r.n=1,e.$http.get("api/HyoSalones/retornaAlumnosSalon",{params:l});case 1:o=r.v,i=o.json,e.alucods=i,r.n=3;break;case 2:r.p=2,s=r.v,e.$notify(s.message,"warning");case 3:return r.a(2)}},r,null,[[0,2]])}))()},seleccionarSeccion:function(){var e=this;return D()(O()().m(function r(){return O()().w(function(r){while(1)switch(r.n){case 0:return e.form.ID_PERSONA=null,r.n=1,e.readAlumnos();case 1:return r.a(2)}},r)}))()},getRows:function(){var e=this,r=this.$refs.tableUtilesEscolaresUtiles.rowsSelected(["DETALLE","CABECERA","CANTIDAD","DESCRIPCION","SUBGRUPO","ENTREGABLE","GRUPO","ID_UTIL_GRUPO","ORDEN","NEMO","ID_PERSONA"],this.rowsutilesAgrupado),t=[],n=[];return r.map(function(r){var a;r.CABECERA?n.push({ID_UTIL_GRUPO:r.ID_UTIL_GRUPO,ID_UTIL_ESCOLAR:(null===(a=e.rowUtilEscolar)||void 0===a?void 0:a.ID_UTIL_ESCOLAR)||"",DETALLE:r.DETALLE}):t.push({ID_UTIL_GRUPO:r.ID_UTIL_GRUPO,DESCRIPCION:r.DESCRIPCION,SUBGRUPO:r.SUBGRUPO,ENTREGABLE:r.ENTREGABLE,ORDEN:r.ORDEN,CANTIDAD:r.CANTIDAD,NEMO:r.NEMO,ID_PERSONA:r.ID_PERSONA})}),{rows:t,detallesGrupo:n}}},created:function(){return D()(O()().m(function e(){return O()().w(function(e){while(1)switch(e.n){case 0:case 1:return e.a(2)}},e)}))()},watch:{loadData:{immediate:!0,deep:!0,handler:function(e){e=JSON.parse(JSON.stringify(e)),this.rows=e}},nivelGrado:function(e){var r=this;return D()(O()().m(function t(){var n;return O()().w(function(t){while(1)switch(t.n){case 0:if(!(e.length>0)){t.n=2;break}return t.n=1,r.$http.post("api/SalonController/postSalonSeccionAnoNivelGrado",{anio:r.anio,nivelGrado:e});case 1:n=t.v,n.unshift({NEMO:null,NEMODES:"Ninguno"}),r.salones=n;case 2:return t.a(2)}},t)}))()}}},Z=t(12807);const ee=(0,Z.A)(Y,[["render",X]]);var re=ee,te={mixins:[w,v],components:{QForm:g.A,QInput:L.A,QSelect:S.A,QCard:h.A,QCardSection:G.A,multiNg:T.A,QCheckbox:_.A,utiles:re,QPage:A.Tu},data:function(){return{required:C.require,buttons:[{label:"Agregar",icon:"plus",permiso:">1",click:this.openAgregar}],openAdd:!1,openUtilesDetallado:!1,action:"create",rowUtilEscolar:null,filter:{anio:null},anios:[],loadData:[],n:[],g:[],form:{ANO:null},nemo:"",id_persona:"",alucods:[],cambios:""}},methods:{getRowsValidar:function(){return JSON.stringify(this.$refs.tableUtilEscolar.rowsSelected(["CANTIDAD","DESCRIPCION","DETALLE","ENTREGABLE","GRUPO","ID_UTIL_GRUPO","ORDEN","SUBGRUPO","NEMO","ID_PERSONA"],this.$refs.utiles.rows))},openAgregar:function(){var e=this;return D()(O()().m(function r(){return O()().w(function(r){while(1)switch(r.n){case 0:return e.action="create",e.rowUtilEscolar=null,(0,b.clear)(e.form),e.form.ANO=e.filter.anio||(0,K["default"])().ano,e.n="",e.g=[],e.loadData=[],e.openAdd=!0,r.n=1,e.$nextTick();case 1:e.cambios=e.getRowsValidar();case 2:return r.a(2)}},r)}))()},openActualizar:function(e){var r=this;return D()(O()().m(function t(){var n,a,l;return O()().w(function(t){while(1)switch(t.n){case 0:if(r.rowUtilEscolar){t.n=1;break}r.$notify("Selecciona un registro","info"),t.n=6;break;case 1:return r.action="update",t.n=2,r.$http.get("api/UtilNivelGradoController/getNivel",{params:{ID_UTIL_ESCOLAR:e.ID_UTIL_ESCOLAR}});case 2:return n=t.v,a=n.INSTRUCOD,t.n=3,r.$http.get("api/UtilNivelGradoController/getNivelGrado",{params:{ID_UTIL_ESCOLAR:e.ID_UTIL_ESCOLAR}});case 3:return l=t.v,r.n=a,r.g=l,t.n=4,r.readUtiles(e.ID_UTIL_ESCOLAR);case 4:return r.form.ANO=r.rowUtilEscolar.ANO,r.openAdd=!0,t.n=5,r.$nextTick();case 5:r.cambios=r.getRowsValidar();case 6:return t.a(2)}},t)}))()},beforeClose:function(){var e=this;return D()(O()().m(function r(){var t,n;return O()().w(function(r){while(1)switch(r.n){case 0:if("create"!==e.action){r.n=3;break}if(t=e.getRowsValidar(),e.cambios!==t){r.n=1;break}return e.openAdd=!1,r.a(2);case 1:return r.n=2,e.$confirmar("No se guardará ningún cambio realizado ¿Realmente desea continuar?");case 2:n=r.v,n&&(e.openAdd=!1),r.n=4;break;case 3:e.openAdd=!1;case 4:return r.a(2)}},r)}))()},saveAcccion:function(){var e=this;return D()(O()().m(function r(){var t,n,a;return O()().w(function(r){while(1)switch(r.n){case 0:return r.n=1,e.$refs.refForm.validate();case 1:if(t=r.v,t){r.n=2;break}return r.a(2);case 2:if(n=e.$refs.refMultiGn.getNivelGrado().map(function(e){var r=(e||"").split("");return{INSTRUCOD:r[0],GRADOCOD:r[1]}}),"create"!==e.action){r.n=4;break}return r.n=3,e.$confirmar("El registro se creará ¿Desea continuar?","info");case 3:a=r.v,a&&e.createUtilEscolar(n),r.n=5;break;case 4:e.openAdd=!1;case 5:return r.a(2)}},r)}))()},rowSelectUtilEscolar:function(e,r){this.rowUtilEscolar=r},createUtilEscolar:function(e){var r=this;return D()(O()().m(function t(){var n,a,l,o,i,s;return O()().w(function(t){while(1)switch(t.p=t.n){case 0:return t.p=0,n=r.$refs.utiles.getRows(),a=n.rows,l=n.detallesGrupo,t.n=1,r.$http.post("api/UtilesEscolaresUtilesController/createUtilEscolar",{form:r.form,nivelGrado:e,data:a,detallesGrupo:l});case 1:return o=t.v,i=o.message,t.n=2,r.readUtilEscolar();case 2:r.openAdd=!1,r.$notify(i,"success"),t.n=4;break;case 3:t.p=3,s=t.v,r.$notify(s.message,"warning");case 4:return t.a(2)}},t,null,[[0,3]])}))()},readUtilEscolar:function(){var e=this;return D()(O()().m(function r(){var t,n;return O()().w(function(r){while(1)switch(r.p=r.n){case 0:return r.p=0,r.n=1,e.$http.get("api/UtilEscolarController/getCabeceraUtilesEscolares",{params:{parametros:{ANIO:e.filter.anio}}});case 1:t=r.v,e.rows=t,r.n=3;break;case 2:r.p=2,n=r.v,e.$notify(n.message,"warning");case 3:return r.a(2)}},r,null,[[0,2]])}))()},readUtiles:function(){var e=arguments,r=this;return D()(O()().m(function t(){var n,a,l;return O()().w(function(t){while(1)switch(t.p=t.n){case 0:return n=e.length>0&&void 0!==e[0]?e[0]:0,t.p=1,t.n=2,r.$http.get("api/UtilesEscolaresUtilesController/getListarDetallado",{params:{parametros:{ANIO:r.filter.anio,ID_UTIL_ESCOLAR:n}}});case 2:a=t.v,r.loadData=a,t.n=4;break;case 3:t.p=3,l=t.v,r.$notify(l.message,"warning");case 4:return t.a(2)}},t,null,[[1,3]])}))()},readAnios:function(){var e=this;return D()(O()().m(function r(){var t,n;return O()().w(function(r){while(1)switch(r.p=r.n){case 0:return r.p=0,r.n=1,e.$http.get("api/HyoAnos/getAnios",{params:{}});case 1:t=r.v,e.anios=t,r.n=3;break;case 2:r.p=2,n=r.v,e.$notify(n.message,"warning");case 3:return r.a(2)}},r,null,[[0,2]])}))()},deleteUtilEscolar:function(){var e=this;return D()(O()().m(function r(){var t,n,a,l;return O()().w(function(r){while(1)switch(r.p=r.n){case 0:if(e.rowUtilEscolar){r.n=1;break}e.$notify("Selecciona un registro","info"),r.n=6;break;case 1:return r.n=2,e.$confirmar("¿Estás seguro de eliminar el registro?","delete");case 2:if(t=r.v,!t){r.n=6;break}return r.p=3,r.n=4,e.$http.delete("api/util-escolar/");case 4:n=r.v,a=n.message,e.rows.splice(e.rows.indexOf(e.rowUtilEscolar),1),e.rowUtilEscolar=null,e.$notify(a,"success"),r.n=6;break;case 5:r.p=5,l=r.v,e.$notify(l.message,"warning");case 6:return r.a(2)}},r,null,[[3,5]])}))()},updateUtilEscolar:function(e){var r=this;return D()(O()().m(function t(){var n,a,l,o,i,s;return O()().w(function(t){while(1)switch(t.p=t.n){case 0:return t.p=0,n=r.$refs.utiles.getRows(),a=n.rows,l=n.detallesGrupo,t.n=1,r.$http.put("api/UtilesEscolaresUtilesController/putUtilEscolar",{form:r.form,nivelGrado:e,detallesGrupo:l,data:a,id_util_escolar:r.rowUtilEscolar.ID_UTIL_ESCOLAR});case 1:return o=t.v,i=o.message,t.n=2,r.readUtilEscolar();case 2:r.openAdd=!1,r.$notify(i,"success"),t.n=4;break;case 3:t.p=3,s=t.v,r.$notify(s.message,"warning");case 4:return t.a(2)}},t,null,[[0,3]])}))()}},created:function(){var e=this;return D()(O()().m(function r(){var t;return O()().w(function(r){while(1)switch(r.p=r.n){case 0:return r.p=0,r.n=1,e.readAnios();case 1:if(e.filter.anio=(0,K["default"])().ano,!e.filter.anio){r.n=2;break}return r.n=2,e.readUtilEscolar();case 2:e.form.ANO=(0,K["default"])().ano,r.n=4;break;case 3:r.p=3,t=r.v,e.$notify(t.message,"warning");case 4:return r.a(2)}},r,null,[[0,3]])}))()}};const ne=(0,Z.A)(te,[["render",E]]);var ae=ne}}]);