"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[18199],{18199:function(e,t,n){n.r(t),n.d(t,{default:function(){return Fe}});n(52776),n(53113);var a=n(61758),i=n(58790),o=n(29104),l={class:"row q-px-sm q-pt-sm bg-white q-bb q-mb-sm"},r={class:"col"},s={class:"col"},u={class:"row col full-height overflow-hidden"},c={key:0,class:"q-menu-mensajeria q-px-sm"},d={class:"col column row q-ba full-height bg-white"},f={class:"column"},m={class:"row col relative-position",id:"virtualHeight"},p={key:0,class:"col column full-height q-bt-sm relative-position"};function b(e,t){var n=(0,a.g2)("sie-select"),b=(0,a.g2)("q-icon"),h=(0,a.g2)("q-item-section"),v=(0,a.g2)("q-item"),k=(0,a.g2)("q-list"),g=(0,a.g2)("q-card"),_=(0,a.g2)("q-search"),C=(0,a.g2)("q-spinner-oval"),y=(0,a.g2)("q-inner-loading"),F=(0,a.g2)("sie-vacio"),j=(0,a.g2)("sie-usuario"),O=(0,a.g2)("q-item-label"),A=(0,a.g2)("q-item-side"),M=(0,a.g2)("q-item-main"),w=(0,a.g2)("q-popover"),I=(0,a.g2)("q-infinite-scroll"),L=(0,a.g2)("detalle-mensaje"),q=(0,a.g2)("menu-mensajeria-movil"),E=(0,a.g2)("sie-modal"),N=(0,a.g2)("q-toolbar-title"),D=(0,a.g2)("q-btn"),U=(0,a.g2)("q-toolbar"),S=(0,a.g2)("q-page"),T=(0,a.gN)("ripple"),Q=(0,a.gN)("close-overlay");return(0,a.uX)(),(0,a.Wv)(S,{class:"mensajeriaLite"},{default:(0,a.k6)(function(){return[(0,a.Lk)("div",l,[(0,a.Lk)("div",r,[(0,a.bF)(n,{type:"outlined",modelValue:e.tipcod,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.tipcod=t}),options:e.perfiles,label:"TIPNOM",val:"TIPCOD",placeholder:"seguridad.perfiles"},null,8,["modelValue","options"])]),(0,a.Lk)("div",s,[(0,a.bF)(n,{type:"outlined",modelValue:e.usucod,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.usucod=t}),options:e.usuarios,label:"USUNOM",val:"USUCOD",placeholder:"usuarios",onSelected:t[2]||(t[2]=function(t){return e.selectCarpeta(1)})},null,8,["modelValue","options"])])]),(0,a.Lk)("div",u,[e.isLess?(0,a.Q3)("v-if",!0):((0,a.uX)(),(0,a.CE)("div",c,[(0,a.bF)(g,null,{default:(0,a.k6)(function(){return[(0,a.bF)(k,{class:"q-py-none",link:"",dense:"",highlight:"",separator:""},{default:(0,a.k6)(function(){return[(0,a.bo)(((0,a.uX)(),(0,a.Wv)(v,{clickable:"",onClick:t[3]||(t[3]=function(t){return e.selectCarpeta(1)}),class:(0,i.C4)({"q-item-active":1===e.bandeja})},{default:(0,a.k6)(function(){return[(0,a.bF)(h,{avatar:""},{default:(0,a.k6)(function(){return[(0,a.bF)(b,{name:"inbox",color:"blue",size:"1.2em"})]}),_:1}),(0,a.bF)(h,{class:"q-body-1"},{default:(0,a.k6)(function(){return[(0,a.eW)((0,i.v_)(e.$t("intranet.mensajeria.micorreo")),1)]}),_:1})]}),_:1},8,["class"])),[[T]]),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(v,{clickable:"",onClick:t[4]||(t[4]=function(t){return e.selectCarpeta(2)}),class:(0,i.C4)({"q-item-active":2===e.bandeja})},{default:(0,a.k6)(function(){return[(0,a.bF)(h,{avatar:""},{default:(0,a.k6)(function(){return[(0,a.bF)(b,{name:"send",color:"secondary",size:"1.2em"})]}),_:1}),(0,a.bF)(h,{class:"q-body-1"},{default:(0,a.k6)(function(){return[(0,a.eW)((0,i.v_)(e.$t("intranet.mensajeria.enviados")),1)]}),_:1})]}),_:1},8,["class"])),[[T]]),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(v,{clickable:"",onClick:t[5]||(t[5]=function(t){return e.selectCarpeta(3)}),class:(0,i.C4)({"q-item-active":3===e.bandeja})},{default:(0,a.k6)(function(){return[(0,a.bF)(h,{avatar:""},{default:(0,a.k6)(function(){return[(0,a.bF)(b,{name:"delete",color:"blue-grey",size:"1.2em"})]}),_:1}),(0,a.bF)(h,{class:"q-body-1"},{default:(0,a.k6)(function(){return[(0,a.eW)((0,i.v_)(e.$t("intranet.mensajeria.papelera")),1)]}),_:1})]}),_:1},8,["class"])),[[T]])]}),_:1})]}),_:1})])),(0,a.Lk)("div",d,[(0,a.Lk)("div",f,[(0,a.bF)(_,{class:"q-pa-sm q-bb-sm",modelValue:e.search,"onUpdate:modelValue":t[6]||(t[6]=function(t){return e.search=t}),"hide-underline":"",onInput:t[7]||(t[7]=function(t){return e.selectCarpeta(e.bandeja)})},null,8,["modelValue"])]),(0,a.Lk)("div",m,[(0,a.bF)(y,{class:"z-marginals bg-white",visible:e.loadingMensajes},{default:(0,a.k6)(function(){return[(0,a.bF)(C,{size:"50px",color:"teal-4"})]}),_:1},8,["visible"]),e.vacio?((0,a.uX)(),(0,a.Wv)(F,{key:0,class:"col",subtitle:e.$t("seguridad.seleccione")},null,8,["subtitle"])):((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[e.mensajes.length?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[(0,a.bo)((0,a.bF)(I,{class:(0,i.C4)({"full-width":!0,"full-height":!0,"scroll-y":!0,col:e.idMensaje}),ref:"infinite",handler:e.listarMensajes},{default:(0,a.k6)(function(){return[(0,a.bF)(k,{class:"q-py-none",separator:""},{default:(0,a.k6)(function(){return[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.mensajes,function(t,n){return(0,a.bo)(((0,a.uX)(),(0,a.Wv)(v,{key:t.ID_MSJ_CARPETA_USUARIO,onClick:function(n){return e.obtDetalle(t,e.isLess)},class:(0,i.C4)({"row-noread":t.NOABIERTO,"q-item-active":t.ID_MENSAJERIA===e.idMensaje}),clickable:""},{default:(0,a.k6)(function(){return[(0,a.bF)(h,{avatar:""},{default:(0,a.k6)(function(){return[(0,a.bF)(j,{usucod:t.USUCOD},null,8,["usucod"])]}),_:2},1024),(0,a.bF)(h,null,{default:(0,a.k6)(function(){return[(0,a.bF)(O,{lines:"1"},{default:(0,a.k6)(function(){return[(0,a.eW)((0,i.v_)(t.EMISORNOM),1)]}),_:2},1024),(0,a.bF)(O,{caption:"",lines:"1",class:(0,i.C4)({"text-bold":t.NOLEIDO||t.NOABIERTO,"text-black":t.NOLEIDO||t.NOABIERTO})},{default:(0,a.k6)(function(){return[(0,a.eW)((0,i.v_)(t.ASUNTO),1)]}),_:2},1032,["class"])]}),_:2},1024),(0,a.bF)(h,{side:""},{default:(0,a.k6)(function(){return[t.ADJUNTO>0?((0,a.uX)(),(0,a.Wv)(O,{key:0,class:"text-right",avatar:""},{default:(0,a.k6)(function(){return[t.CC?((0,a.uX)(),(0,a.Wv)(b,{key:0,name:"closed_caption",size:"18px"})):(0,a.Q3)("v-if",!0),(0,a.bF)(b,{name:"paperclip",size:"18px"})]}),_:2},1024)):(0,a.Q3)("v-if",!0),t.ESHOY?((0,a.uX)(),(0,a.Wv)(O,{key:1},{default:(0,a.k6)(function(){return[(0,a.eW)((0,i.v_)(e.formatoHora(t.FH_ENVIO)),1)]}),_:2},1024)):((0,a.uX)(),(0,a.Wv)(O,{key:2},{default:(0,a.k6)(function(){return[(0,a.eW)((0,i.v_)(e.formatoFecha(t.FH_ENVIO)),1)]}),_:2},1024))]}),_:2},1024),e.permiso?((0,a.uX)(),(0,a.Wv)(h,{key:0,side:""},{default:(0,a.k6)(function(){return[1!==t.ID_MSJ_CARPETA?((0,a.uX)(),(0,a.Wv)(b,{key:0,name:"more_vert",size:"18px"},{default:(0,a.k6)(function(){return[(0,a.bF)(w,null,{default:(0,a.k6)(function(){return[(0,a.bF)(k,{link:"",style:{"min-width":"150px","max-height":"300px"}},{default:(0,a.k6)(function(){return[(0,a.bo)(((0,a.uX)(),(0,a.Wv)(v,{clickable:"",onClick:function(n){return e.deleteMessage(t)}},{default:(0,a.k6)(function(){return[(0,a.bF)(A,{icon:"delete",size:"10px"}),(0,a.bF)(M,{label:"Eliminar"})]}),_:1},8,["onClick"])),[[Q]])]}),_:2},1024)]}),_:2},1024)]}),_:2},1024)):(0,a.Q3)("v-if",!0)]}),_:2},1024)):(0,a.Q3)("v-if",!0)]}),_:2},1032,["onClick","class"])),[[T]])}),128))]}),_:1})]}),_:1},8,["class","handler"]),[[o.aG,"chevron_double_left"===e.chevronDouble]]),e.idMensaje&&!e.isLess?((0,a.uX)(),(0,a.CE)("div",p,[(0,a.bF)(O,{class:"full-width text-center cursor-pointer column",onClick:e.mensajeFull},{default:(0,a.k6)(function(){return[(0,a.bF)(b,{name:e.chevronDouble},null,8,["name"])]}),_:1},8,["onClick"]),(0,a.bF)(y,{class:"z-marginals bg-white",visible:e.loadingDetalleMensaje},{default:(0,a.k6)(function(){return[(0,a.bF)(C,{size:"50px",color:"teal-4"})]}),_:1},8,["visible"]),e.mensaje?((0,a.uX)(),(0,a.Wv)(L,{key:0,data:e.mensaje,leidos:e.leidos,para:e.para,de:e.de,cco:e.cco,cc:e.cc},null,8,["data","leidos","para","de","cco","cc"])):(0,a.Q3)("v-if",!0)])):(0,a.Q3)("v-if",!0)],64)):((0,a.uX)(),(0,a.Wv)(F,{key:1,class:"col"}))],64))])])]),(0,a.bF)(q,{modelValue:e.modalMenu,"onUpdate:modelValue":t[8]||(t[8]=function(t){return e.modalMenu=t}),onClose:e.closeMenuMovil,bandeja:e.bandeja,onSelection:e.selectCarpeta},null,8,["modelValue","onClose","bandeja","onSelection"]),e.idMensaje&&e.isLess?((0,a.uX)(),(0,a.Wv)(E,{key:0,modelValue:e.modalDetalle,"onUpdate:modelValue":t[9]||(t[9]=function(t){return e.modalDetalle=t}),ok:!1},{default:(0,a.k6)(function(){return[(0,a.bF)(y,{class:"z-marginals bg-white",visible:e.loadingDetalleMensaje},{default:(0,a.k6)(function(){return[(0,a.bF)(C,{size:"50px",color:"teal-4"})]}),_:1},8,["visible"]),e.mensaje?((0,a.uX)(),(0,a.Wv)(L,{key:0,data:e.mensaje,leidos:e.leidos,para:e.para,de:e.de,cco:e.cco,cc:e.cc},null,8,["data","leidos","para","de","cco","cc"])):(0,a.Q3)("v-if",!0)]}),_:1},8,["modelValue"])):(0,a.Q3)("v-if",!0),e.isLess?((0,a.uX)(),(0,a.Wv)(U,{key:1,class:"fixed-top q-toolbar-menu",inverted:"",style:{width:"calc(100% - 50px)",left:"50px"}},{default:(0,a.k6)(function(){return[(0,a.bF)(N,{class:"text-white"},{default:(0,a.k6)(function(){return[(0,a.eW)((0,i.v_)(e.titleCarpeta(e.bandeja)),1)]}),_:1}),(0,a.bF)(D,{flat:"",round:"",dense:"",icon:"backburger",color:"white",onClick:e.openMenuMovil},null,8,["onClick"])]}),_:1})):(0,a.Q3)("v-if",!0)]}),_:1})}var h=n(8445),v=n.n(h),k=n(76080),g=n.n(k),_=n(45254),C=n.n(_),y=(n(30683),n(71225),n(50310),n(5962),n(83190),n(6123)),F=n(65673),j=n(82327),O=n(88865),A=n(66824),M=n(93616),w=n(80340),I=n(24974),L=n(30640),q=n(34858),E=(n(56285),{class:"col full-height full-width overflow-auto detalleMensaje"}),N={class:"row q-pa-sm"},D={class:"col-6"},U={class:"col-6"},S={class:"col-12"},T={class:"q-pl-sm"},Q={class:"row q-pa-sm"},R={class:"col-6"},x={class:"col column items-start justify-start"},W={class:"text-bold q-body-1"},V={class:"col-6"},X={class:"col column items-end"},P={class:"text-bold q-body-1"},z={class:"q-pl-xl"};function J(e,t){var n=(0,a.g2)("sie-usuario"),o=(0,a.g2)("q-item-side"),l=(0,a.g2)("q-item-tile"),r=(0,a.g2)("q-item-main"),s=(0,a.g2)("q-tooltip"),u=(0,a.g2)("q-icon"),c=(0,a.g2)("q-item"),d=(0,a.g2)("q-item-separator"),f=(0,a.g2)("q-download-file"),m=(0,a.g2)("sie-html"),p=(0,a.g2)("sie-select"),b=(0,a.g2)("q-search"),h=(0,a.g2)("q-td"),k=(0,a.g2)("q-table"),g=(0,a.g2)("q-btn"),_=(0,a.g2)("sie-modal");return(0,a.uX)(),(0,a.CE)("div",E,[(0,a.bF)(c,null,{default:(0,a.k6)(function(){return[(0,a.bF)(o,null,{default:(0,a.k6)(function(){return[(0,a.bF)(n,{usucod:e.data.USUCOD},null,8,["usucod"])]}),_:1}),(0,a.bF)(r,null,{default:(0,a.k6)(function(){return[(0,a.bF)(l,{class:"q-caption",sublabel:""},{default:(0,a.k6)(function(){return[(0,a.eW)((0,i.v_)(e.formatoFechaHora(e.data.FH_ENVIO)),1)]}),_:1}),(0,a.bF)(l,{label:""},{default:(0,a.k6)(function(){return[(0,a.eW)((0,i.v_)(e.data.USUNOM),1)]}),_:1}),(0,a.bF)(l,{class:"text-bold",color:"black",sublabel:"",lines:"3"},{default:(0,a.k6)(function(){return[(0,a.eW)((0,i.v_)(e.data.ASUNTO),1)]}),_:1})]}),_:1}),e.leidos.length?((0,a.uX)(),(0,a.Wv)(o,{key:0,class:"cursor-pointer",onClick:t[0]||(t[0]=function(t){return e.verLeidos(e.leidos)})},{default:(0,a.k6)(function(){return[(0,a.bF)(u,{name:"email",size:"20px"},{default:(0,a.k6)(function(){return[(0,a.bF)(s,{anchor:"bottom middle",self:"top middle"},{default:(0,a.k6)(function(){return v()(t[8]||(t[8]=[(0,a.eW)("Ver destinatarios",-1)]))}),_:1})]}),_:1})]}),_:1})):(0,a.Q3)("v-if",!0)]}),_:1}),e.countPara?((0,a.uX)(),(0,a.Wv)(c,{key:0,class:"row q-item-receptor"},{default:(0,a.k6)(function(){return[(0,a.bF)(r,{class:"col"},{default:(0,a.k6)(function(){return[(0,a.bF)(l,{class:"q-caption height-para",sublabel:"",lines:e.paraLines},{default:(0,a.k6)(function(){return[(0,a.eW)((0,i.v_)("Para: "+e.para),1)]}),_:1},8,["lines"])]}),_:1}),e.paraActive?((0,a.uX)(),(0,a.Wv)(u,{key:0,class:"cursor-pointer",name:e.paraArrow,onClick:e.paraVerMas,size:"18px"},null,8,["name","onClick"])):(0,a.Q3)("v-if",!0)]}),_:1})):(0,a.Q3)("v-if",!0),e.countCC?((0,a.uX)(),(0,a.Wv)(c,{key:1,class:"row q-item-receptor"},{default:(0,a.k6)(function(){return[(0,a.bF)(r,{class:"col"},{default:(0,a.k6)(function(){return[(0,a.bF)(l,{class:"q-caption height-cc",sublabel:"",lines:e.ccLines},{default:(0,a.k6)(function(){return[(0,a.eW)((0,i.v_)("CC: "+e.cc),1)]}),_:1},8,["lines"])]}),_:1}),e.ccActive?((0,a.uX)(),(0,a.Wv)(u,{key:0,class:"cursor-pointer",name:e.ccArrow,onClick:e.ccVerMas,size:"18px"},null,8,["name","onClick"])):(0,a.Q3)("v-if",!0)]}),_:1})):(0,a.Q3)("v-if",!0),e.countCCO?((0,a.uX)(),(0,a.Wv)(c,{key:2,class:"row q-item-receptor"},{default:(0,a.k6)(function(){return[(0,a.bF)(r,{class:"col"},{default:(0,a.k6)(function(){return[(0,a.bF)(l,{class:"q-caption height-cco",sublabel:"",lines:e.ccoLines},{default:(0,a.k6)(function(){return[(0,a.eW)((0,i.v_)("CCO: "+e.cco),1)]}),_:1},8,["lines"])]}),_:1}),e.ccoActive?((0,a.uX)(),(0,a.Wv)(u,{key:0,class:"cursor-pointer",name:e.ccoArrow,onClick:e.ccoVerMas,size:"18px"},null,8,["name","onClick"])):(0,a.Q3)("v-if",!0)]}),_:1})):(0,a.Q3)("v-if",!0),e.data.ADJUNTO.length?((0,a.uX)(),(0,a.CE)(a.FK,{key:3},[(0,a.bF)(d),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.data.ADJUNTO,function(t,n){return(0,a.uX)(),(0,a.Wv)(f,{key:n,url:t.url,compartido:t.compartido,origen:t.origen,src:e.getUrl(t),name:t.name,extension:t.extension,"direct-link":t.directLink,inline:!0,adjuntos:e.data.ADJUNTO,item:t,usardrivecloud:"N",btnEditar:!1},null,8,["url","compartido","origen","src","name","extension","direct-link","adjuntos","item"])}),128))],64)):(0,a.Q3)("v-if",!0),(0,a.bF)(d),(0,a.bF)(c,null,{default:(0,a.k6)(function(){return[(0,a.bF)(r,null,{default:(0,a.k6)(function(){return[(0,a.bF)(m,{src:e.data.MENSAJE},null,8,["src"])]}),_:1})]}),_:1}),(0,a.bF)(_,{class:"modal-leidos",modelValue:e.modal,"onUpdate:modelValue":t[6]||(t[6]=function(t){return e.modal=t}),title:"Destinatarios",ok:!1,footer:!1,onSubmit:t[7]||(t[7]=function(){})},{default:(0,a.k6)(function(){return[(0,a.Lk)("div",N,[(0,a.Lk)("div",D,[(0,a.bF)(p,{type:"outlined",modelValue:e.tipo,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.tipo=t}),options:e.tipos,label:"label",val:"value",placeholder:"tipo"},null,8,["modelValue","options"])]),(0,a.Lk)("div",U,[(0,a.bF)(p,{type:"outlined",modelValue:e.estado,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.estado=t}),options:e.estados,label:"label",val:"value",placeholder:"matricula.estado"},null,8,["modelValue","options"])]),(0,a.Lk)("div",S,[(0,a.bF)(k,{style:(0,i.Tr)({height:e.isLess?"80vh":"69vh"}),data:e.destinatarios,columns:e.columns,filter:e.filter},{"top-right":(0,a.k6)(function(n){return[(0,a.bF)(b,{"hide-underline":"",modelValue:e.filter,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.filter=t})},null,8,["modelValue"])]}),"body-cell-USUNOM":(0,a.k6)(function(e){return[(0,a.bF)(h,{props:e},{default:(0,a.k6)(function(){return["S"===e.row.LECTURA?((0,a.uX)(),(0,a.Wv)(u,{key:0,name:"email_open",size:"20px",color:"faded"})):((0,a.uX)(),(0,a.Wv)(u,{key:1,name:"email",size:"20px",color:"faded"})),(0,a.Lk)("span",T,(0,i.v_)(e.row.USUNOM),1)]}),_:2},1032,["props"])]}),_:1},8,["style","data","columns","filter"])])]),(0,a.Lk)("div",Q,[(0,a.Lk)("div",R,[(0,a.Lk)("div",x,[(0,a.Lk)("span",W,[(0,a.eW)("Destinatarios : "+(0,i.v_)(e.destinatarios.length)+"  ",1),(0,a.bF)(g,{class:"q-ma-sm",icon:"file_pdf",dense:"",round:"",color:"primary",onClick:t[4]||(t[4]=function(t){return e.printDestinatarios("pdf")})}),(0,a.bF)(g,{icon:"file_excel",dense:"",round:"",color:"primary",onClick:t[5]||(t[5]=function(t){return e.printDestinatarios("xlsx")})})])])]),(0,a.Lk)("div",V,[(0,a.Lk)("div",X,[(0,a.bF)(c,null,{default:(0,a.k6)(function(){return[(0,a.Lk)("span",P,[(0,a.eW)("Leídos : "+(0,i.v_)(e.destinatariosRead.length),1),(0,a.Lk)("span",z,"No leídos : "+(0,i.v_)(e.destinatariosNoRead.length),1)])]}),_:1})])])])]}),_:1},8,["modelValue"])])}var H=n(18105),$=n(30545),Y=n(33001),B=n(81288),K=n(66099),G=n(62006),Z=n(2819),ee=n(57668),te=n(78131),ne={tipos:function(){return[{label:"Todos",value:"T"},{label:"Para",value:"P"},{label:"CC",value:"CC"},{label:"CCO",value:"CCO"}]},estados:function(){return[{label:"Todos",value:"T"},{label:"Leido",value:"S"},{label:"No leido",value:"N"}]},addProperty:function(e){document.querySelector(e).style.overflow="auto",document.querySelector(e).style.height="90px"},removeProperty:function(e){document.querySelector(e).style.overflow="hidden",document.querySelector(e).style.removeProperty("height")},handleResize:function(e){var t=!1;if(document.querySelector(e)){var n=document.querySelector(e).style;n.removeProperty("-webkit-line-clamp");var a=document.querySelector(e).getBoundingClientRect().height;a>28?(document.querySelector(e).style.webkitLineClamp="2",t=!0):t=!1}return t},getUrl:function(e){var t=(0,ee["default"])(),n=t.api,a=t.token,i=n+"/HyoMsjAdjunto/archivo/"+e.ID_MSJ_ADJUNTO+"?access_token="+a;"E"===e.TIPO?i=e.ADJUNTO:(0,te["default"])(i,e.ADJUNTO)}},ae=y.tT.ready,ie=function(e){return y.p6.formatDate(e,"DD/MM/YYYY hh:mm a")},oe={components:{QTable:$.A,QTd:y.Ef,QTooltip:y.nC,sieUsuario:I.A,sieModal:L.A,sieSelect:M.A,sieHtml:K.A,QDownloadFile:G.A,QItem:y.H0,QItemSide:y.n1,QItemMain:y.mF,QItemTile:y.lp,QIcon:y.bP,QItemSeparator:y.CL,QSearch:y.Ks,QBtn:y.Il},props:{data:Object,para:String,de:String,cco:String,cc:String,leidos:Array},data:function(){return{sieInfo:(0,ee["default"])(),paraLines:2,paraArrow:"keyboard_arrow_down",paraActive:!1,ccoLines:2,ccoArrow:"keyboard_arrow_down",ccoActive:!1,ccLines:2,ccArrow:"keyboard_arrow_down",ccActive:!1,modal:!1,columns:[{name:"USUNOM",label:"Usuario",field:"USUNOM",align:"left",sortable:!0},{name:"FH_LECTURA",label:"Fecha de lectura",field:"FH_LECTURA",align:"center",sortable:!0,format:ie}],filter:null,tipos:ne.tipos(),tipo:"T",estados:ne.estados(),estado:"T"}},computed:{countPara:function(){var e=0;return""!==this.para&&(e=this.para.split().length),e},countCCO:function(){var e=0;return""!==this.cco&&(e=this.cco.split().length),e},countCC:function(){var e=0;return""!==this.cc&&(e=this.cc.split().length),e},destinatarios:function(){var e=this.leidos;return"T"!==this.tipo&&(e=(0,Y.filterArray)(this.tipo,{field:"TIPO",list:e})),"T"!==this.estado&&(e=(0,Y.filterArray)(this.estado,{field:"LECTURA",list:e})),e},destinatariosRead:function(){var e=this.destinatarios;return e=(0,Y.filterArray)("S",{field:"LECTURA",list:e}),e},destinatariosNoRead:function(){var e=this.destinatarios;return e=(0,Y.filterArray)("N",{field:"LECTURA",list:e}),e},isLess:function(){return(0,B.isLess)()}},methods:{formatoFechaHora:function(e){return(0,H.Ay)(e,"dddd DD/MM/YYYY HH:mm:ss")},paraVerMas:function(){this.paraLines>2?(this.paraArrow="keyboard_arrow_down",this.paraLines=2,ne.removeProperty(".height-para")):(this.paraArrow="keyboard_arrow_up",this.paraLines=100,ne.addProperty(".height-para"))},ccoVerMas:function(){this.ccoLines>2?(this.ccoArrow="keyboard_arrow_down",this.ccoLines=2,ne.removeProperty(".height-cco")):(this.ccoArrow="keyboard_arrow_up",this.ccoLines=100,ne.addProperty(".height-cco"))},ccVerMas:function(){this.ccLines>2?(this.ccArrow="keyboard_arrow_down",this.ccLines=2,ne.removeProperty(".height-cc")):(this.ccArrow="keyboard_arrow_up",this.ccLines=100,ne.addProperty(".height-cc"))},donwload:function(e){ne.getUrl(e)},handleResize:function(){var e=this;ae(function(){e.paraActive=ne.handleResize(".height-para"),e.ccActive=ne.handleResize(".height-cc"),e.ccoActive=ne.handleResize(".height-cco")})},verLeidos:function(e){this.modal=!0},getUrl:function(e){return e.esEnlace?e.url:this.sieInfo.api+"/HyoMsjAdjunto/archivo/"+e.id+"?access_token="+this.sieInfo.token},printDestinatarios:function(e){var t="reporteDestinatarios",n={idMensaje:this.data.ID_MENSAJERIA,repcod:t,usucod:this.data.USUCOD,formato:e};this.filter&&(n.filtro=this.filter),"T"!==this.estado&&(n.estado="S"===this.estado?1:0),"T"!==this.tipo&&(n.tipo=this.tipo),(0,Z["default"])(n,"webservice/reportes/reporte","".concat(t,".pdf"))}},watch:{data:function(){this.handleResize()}},mounted:function(){window.addEventListener("resize",this.handleResize),this.handleResize()},unmounted:function(){window.removeEventListener("resize",this.handleResize)}},le=n(12807);const re=(0,le.A)(oe,[["render",J]]);var se=re;function ue(e,t){var n=(0,a.g2)("q-icon"),o=(0,a.g2)("q-item-section"),l=(0,a.g2)("q-item"),r=(0,a.g2)("q-item-label"),s=(0,a.g2)("q-list"),u=(0,a.g2)("q-modal");return(0,a.uX)(),(0,a.Wv)(u,{class:"menu-mensajeria-movil",modelValue:e.modal,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.modal=t}),position:"right"},{default:(0,a.k6)(function(){return[(0,a.bF)(s,{class:"q-py-none",link:"",highlight:"",separator:""},{default:(0,a.k6)(function(){return[(0,a.bF)(l,null,{default:(0,a.k6)(function(){return[(0,a.bF)(o,{side:"",right:""},{default:(0,a.k6)(function(){return[(0,a.bF)(n,{color:"black",name:"close",size:"18px",onClick:e.close},null,8,["onClick"])]}),_:1})]}),_:1}),(0,a.bF)(l,{onClick:t[0]||(t[0]=function(t){return e.seleccionarCarpeta(1)}),class:(0,i.C4)({"q-item-active":1===e.bandeja}),clickable:""},{default:(0,a.k6)(function(){return[(0,a.bF)(o,{side:""},{default:(0,a.k6)(function(){return[(0,a.bF)(n,{name:"inbox",color:"blue",size:"1.2em"})]}),_:1}),(0,a.bF)(o,null,{default:(0,a.k6)(function(){return[(0,a.bF)(r,{caption:""},{default:(0,a.k6)(function(){return[(0,a.eW)((0,i.v_)(e.$t("intranet.mensajeria.micorreo")),1)]}),_:1})]}),_:1})]}),_:1},8,["class"]),(0,a.bF)(l,{onClick:t[1]||(t[1]=function(t){return e.seleccionarCarpeta(2)}),class:(0,i.C4)({"q-item-active":2===e.bandeja}),clickable:""},{default:(0,a.k6)(function(){return[(0,a.bF)(o,{side:""},{default:(0,a.k6)(function(){return[(0,a.bF)(n,{name:"send",color:"secondary",size:"1.2em"})]}),_:1}),(0,a.bF)(o,null,{default:(0,a.k6)(function(){return[(0,a.bF)(r,{caption:""},{default:(0,a.k6)(function(){return[(0,a.eW)((0,i.v_)(e.$t("intranet.mensajeria.enviados")),1)]}),_:1})]}),_:1})]}),_:1},8,["class"]),(0,a.bF)(l,{onClick:t[2]||(t[2]=function(t){return e.seleccionarCarpeta(3)}),class:(0,i.C4)({"q-item-active":3===e.bandeja}),clickable:""},{default:(0,a.k6)(function(){return[(0,a.bF)(o,{side:""},{default:(0,a.k6)(function(){return[(0,a.bF)(n,{name:"delete",color:"blue-grey",size:"1.2em"})]}),_:1}),(0,a.bF)(o,null,{default:(0,a.k6)(function(){return[(0,a.bF)(r,{caption:""},{default:(0,a.k6)(function(){return[(0,a.eW)((0,i.v_)(e.$t("intranet.mensajeria.papelera")),1)]}),_:1})]}),_:1})]}),_:1},8,["class"])]}),_:1})]}),_:1},8,["modelValue"])}n(11777);var ce={emits:["update:modelValue","input","close","selection"],components:{QModal:y.tU,QItem:j.A,QItemSection:O.A,QItemLabel:A.A,QList:y.Mb,QIcon:y.bP},props:{modelValue:{type:Boolean,default:!1},bandeja:{type:Number}},computed:{modal:{get:function(){return this.modelValue},set:function(e){this.$emit("update:modelValue",e),this.$emit("input",e)}}},methods:{close:function(){this.$emit("close")},seleccionarCarpeta:function(e){this.$emit("selection",e)}}};const de=(0,le.A)(ce,[["render",ue]]);var fe=de,me=n(69027),pe=n(80660),be=n(30276),he=n(982),ve=(n(77507),n(13813)),ke=n(99637),ge=n(78786),_e={getPerfilesUsuarios:function(){return pe.$http.get("api/HyoMensajeria/getPerfilesUsuarios")},obtMensajes:function(e){return C()(g()().m(function t(){var n,a;return g()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,pe.$http.get("api/HyoMensajeria/obtMensajes",{params:e});case 1:return n=t.v,a=n.json,(0,ke["default"])(a,function(e){e.LEIDO=1===e.LECTURA,e.NOLEIDO=0===e.LECTURA,e.NOABIERTO=null===e.LECTURA}),t.a(2,a)}},t)}))()},obtDetalle:function(e){var t=this;return C()(g()().m(function n(){var a,i,o,l,r,s,u,c;return g()().w(function(n){while(1)switch(n.n){case 0:return n.n=1,pe.$http.get("api/HyoMensajeria/obtDetalle",{params:e});case 1:return a=n.v,i=a.destinatarios,o=a.mensaje,l=t.strDestinatarios("P",i),r=t.strDestinatarios("DE",i),s=t.strDestinatarios("CCO",i),u=t.strDestinatarios("CC",i),(0,ke["default"])(o.ADJUNTO,function(e){var n=t.getIconDocuments();(0,ke["default"])(n,function(t){(0,ge["default"])(t.EXTENSION,e.EXTENSION)>=0&&(e.ICON=t.ICON,e.COLOR=t.COLOR)})}),c=[],c=2===o.ID_MSJ_CARPETA_ORI?i.filter(function(e){return(0,ge["default"])(["DE"],e.TIPO)<0}):[],(0,ke["default"])(c,function(e){e.LECTURA=e.LECTURA?"S":"N"}),n.a(2,{leidos:c,mensaje:o,para:l,de:r,cco:s,cc:u})}},n)}))()},strDestinatarios:function(e,t){var n=(0,Y.filterArray)(e,{field:"TIPO",list:t,strict:!0});return n=(0,ve["default"])(n,function(e){return e.USUNOM}),n.join()},getIconDocuments:function(){var e=[{ICON:"file_word",EXTENSION:["doc","docx"],COLOR:"blue-8"},{ICON:"file_excel",EXTENSION:["xls","xlsx"],COLOR:"green-7"},{ICON:"file_pdf",EXTENSION:["pdf"],COLOR:"red-8"},{ICON:"file_powerpoint",EXTENSION:["ppt","pptx"],COLOR:"orange-10"},{ICON:"file_image",EXTENSION:["jpg","png","bmp","jpeg","jfif","JPG","PNG","BMP","JPEG","JFIF"],COLOR:"cyan"},{ICON:"file_text_o",EXTENSION:["txt"],COLOR:"blue-grey"},{ICON:"file",EXTENSION:["cdr","pub"],COLOR:"blue-grey"}];return e}},Ce={components:{QInnerLoading:y.SQ,QSpinnerOval:y.VA,QList:F.A,QItem:j.A,QItemSection:O.A,QItemLabel:A.A,sieSelect:M.A,sieVacio:w.A,sieUsuario:I.A,sieModal:L.A,virtualList:q.Ay,detalleMensaje:se,menuMensajeriaMovil:fe,QPage:y.Tu,QCard:y.C$,QIcon:y.bP,QSearch:y.Ks,QInfiniteScroll:y.nN,QPopover:y.VM,QItemSide:y.n1,QItemMain:y.mF,QToolbar:y.ZV,QToolbarTitle:y.r_,QBtn:y.Il},data:function(){return{perfiles:[],tipcod:null,todosUsuarios:[],usucod:null,bandeja:null,search:null,filter:null,mensajes:[],idMensaje:null,mensaje:null,leidos:[],para:null,de:null,cco:null,cc:null,chevronDouble:"chevron_double_left",modalMenu:!1,modalDetalle:!1,loadingMensajes:!1,loadingDetalleMensaje:!1,isRefresh:!1}},computed:{usuarios:function(){var e=this.todosUsuarios;return this.usucod=null,this.idMensaje=null,e=this.tipcod?"T"===this.tipcod?this.todosUsuarios:(0,Y.filterArray)(this.tipcod,{field:"TIPCOD",list:this.todosUsuarios}):[],e},vacio:function(){var e=!0;return e=!this.usucod||!this.bandeja,e},isLess:function(){return(0,B.isLess)()},permiso:function(){var e;switch((0,ee["default"])().colcod){case"0434":e=["001"].indexOf((0,ee["default"])().tipcod)>=0;break;default:e=["SIE"].indexOf((0,ee["default"])().usucod)>=0;break}return e}},methods:{formatoFecha:function(e){return(0,H.Ay)(e,"DD/MM/YYYY")},formatoHora:function(e){return(0,H.Ay)(e,"hh:mm")},titleCarpeta:function(e){var t="";switch(e){case 1:t=(0,be.$t)("intranet.mensajeria.micorreo");break;case 2:t=(0,be.$t)("intranet.mensajeria.enviados");break;case 3:t=(0,be.$t)("intranet.mensajeria.papelera");break}return t},getPerfilesUsuarios:function(){var e=this;return C()(g()().m(function t(){var n,a,i;return g()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,_e.getPerfilesUsuarios();case 1:n=t.v,a=n.perfiles,i=n.usuarios,a.unshift({TIPCOD:"T",TIPNOM:"Todos"}),e.perfiles=a,e.todosUsuarios=i;case 2:return t.a(2)}},t)}))()},selectCarpeta:function(e){this.mensajes=[],this.bandeja=e,this.idMensaje=null,this.modalMenu=!1,this.listarMensajes()},listarMensajes:function(e,t){var n=this;return C()(g()().m(function a(){var i,o;return g()().w(function(a){while(1)switch(a.p=a.n){case 0:if(t="function"===typeof t?t:function(){},!n.usucod){a.n=4;break}return i={search:n.search,filter:n.filter,idCarpeta:n.bandeja,usucod:n.usucod},e?(i.segmento=e,n.loadingMensajes=!1):n.loadingMensajes=!0,a.p=1,a.n=2,_e.obtMensajes(i);case 2:o=a.v,n.loadingMensajes=!1,n.isRefresh?n.mensajes=v()(o):n.mensajes=[].concat(v()(n.mensajes),v()(o)),o.length?t():(t(),n.$refs.infinite.stop()),a.n=4;break;case 3:a.p=3,a.v,n.mensajes=[];case 4:return a.a(2)}},a,null,[[1,3]])}))()},obtDetalle:function(e,t){var n=this;return C()(g()().m(function a(){var i,o,l,r,s,u,c,d,f;return g()().w(function(a){while(1)switch(a.p=a.n){case 0:if(i=300,t?n.modalDetalle=!0:i=0,n.loadingDetalleMensaje=!0,a.p=1,n.idMensaje===e.ID_MENSAJERIA){a.n=3;break}return n.mensaje=null,n.leidos=[],n.idMensaje=e.ID_MENSAJERIA,o={carpeta:n.bandeja,idMensaje:e.ID_MENSAJERIA,usucod:n.usucod},a.n=2,_e.obtDetalle(o);case 2:l=a.v,r=l.mensaje,s=l.leidos,u=l.para,c=l.de,d=l.cco,f=l.cc,n.para=u,n.de=c,n.cco=d,n.cc=f,setTimeout(function(){n.mensaje=r,n.leidos=s,n.loadingDetalleMensaje=!1},i),a.n=4;break;case 3:n.loadingDetalleMensaje=!1;case 4:a.n=6;break;case 5:a.p=5,a.v,n.para=null,n.de=null,n.cco=null,n.cc=null,n.mensaje=null,n.leidos=[];case 6:return a.a(2)}},a,null,[[1,5]])}))()},mensajeFull:function(){"chevron_double_left"===this.chevronDouble?this.chevronDouble="chevron_double_right":this.chevronDouble="chevron_double_left"},openMenuMovil:function(){this.modalMenu=!0},closeMenuMovil:function(){this.modalMenu=!1},deleteMessage:function(e){var t=this;(0,me.confirmar)("Se eliminará el mensaje a todos los destinatarios incluyendo al emisor, desea continuar",function(){pe.$http.get("api/HyoMensajeria/deleteMessageDestinatarios",{params:{idMensaje:e.ID_MENSAJERIA}}).then(function(e){var n=e.json;Object.prototype.hasOwnProperty.call(n,"error")?(0,he["default"])("El registro no ha sido eliminado","warning"):((0,he["default"])("El registro se eliminó correctamente","success"),t.isRefresh=!0,t.listarMensajes(),t.idMensaje=null)}).catch(function(){return(0,he["default"])("El registro no ha sido eliminado","warning"),!1})})}},created:function(){this.isRefresh=!1,this.getPerfilesUsuarios()}};const ye=(0,le.A)(Ce,[["render",b]]);var Fe=ye}}]);