"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[36166],{36166:function(e,a,n){n.r(a),n.d(a,{default:function(){return D}});var t=n(61758),o={class:"container-panel-configuracion flex",style:{"flex-wrap":"wrap","justify-content":"center"}};function i(e,a){var n=(0,t.g2)("header-btn"),i=(0,t.g2)("q-separator"),l=(0,t.g2)("crearBotones"),s=(0,t.g2)("q-card-section"),r=(0,t.g2)("envio"),c=(0,t.g2)("analytics"),u=(0,t.g2)("inbox"),d=(0,t.g2)("plantillas"),f=(0,t.g2)("exclusiones"),h=(0,t.g2)("configuracion"),g=(0,t.g2)("sie-upload"),p=(0,t.g2)("sie-modal"),A=(0,t.g2)("modal-file-header"),v=(0,t.g2)("q-card");return(0,t.uX)(),(0,t.Wv)(v,{class:"background-buttons my-card",flat:"",bordered:""},{default:(0,t.k6)(function(){return[(0,t.bF)(n,{name:e.titulo,buttons:e.buttons},null,8,["name","buttons"]),(0,t.bF)(i),"inicio"===e.estadoActual?((0,t.uX)(),(0,t.Wv)(s,{key:0},{default:(0,t.k6)(function(){return[(0,t.Lk)("div",o,[(0,t.bF)(l,{class:"create-buttons-style",componente:e.componente,buttons:e.botones,nivelAcceso:e.nivelAcceso,bigClass:"button-big-intranet"},null,8,["componente","buttons","nivelAcceso"])])]}),_:1})):(0,t.Q3)("v-if",!0),"envio"===e.estadoActual?((0,t.uX)(),(0,t.Wv)(r,{key:1,hideHeader:!0,sendMensaje:e.sendMensaje,onTerminaMensaje:e.falsoMensaje,onChangeEnvioTab:e.changeEnvioTab,ref:"envio"},null,8,["sendMensaje","onTerminaMensaje","onChangeEnvioTab"])):(0,t.Q3)("v-if",!0),"analytics"===e.estadoActual?((0,t.uX)(),(0,t.Wv)(c,{key:2,hideHeader:!0,ref:"analytics"},null,512)):(0,t.Q3)("v-if",!0),"inbox"===e.estadoActual?((0,t.uX)(),(0,t.Wv)(u,{key:3,hideHeader:!0})):(0,t.Q3)("v-if",!0),"plantillas"===e.estadoActual?((0,t.uX)(),(0,t.Wv)(d,{key:4,hideHeader:!0,infoMenus:e.dataMenu,onCloseModalPlantilla:e.closeModalPlantilla,ref:"plantillas"},null,8,["infoMenus","onCloseModalPlantilla"])):(0,t.Q3)("v-if",!0),"exclusiones"===e.estadoActual?((0,t.uX)(),(0,t.Wv)(f,{key:5,ref:"exclusiones"},null,512)):(0,t.Q3)("v-if",!0),"configuracion"===e.estadoActual?((0,t.uX)(),(0,t.Wv)(h,{key:6,ref:"configuracion"},null,512)):(0,t.Q3)("v-if",!0),(0,t.Q3)("Modal para agregar imagen por defecto"),(0,t.bF)(p,{modelValue:e.showModalImg,"onUpdate:modelValue":a[0]||(a[0]=function(a){return e.showModalImg=a}),ok:"Guardar",onSubmit:e.guardarHeaderDefault,title:"Agregar cabecera por defecto"},{default:(0,t.k6)(function(){return[(0,t.bF)(g,{onUpload:e.uploadHeader,src:e.headerUrlDefault,allow:["jpeg","jpg","png"]},null,8,["onUpload","src"])]}),_:1},8,["modelValue","onSubmit"]),(0,t.Q3)("Modal para seleccionar imagen de cabecera"),e.openModalFileHeader?((0,t.uX)(),(0,t.Wv)(A,{key:7,modelValue:e.openModalFileHeader,"onUpdate:modelValue":a[1]||(a[1]=function(a){return e.openModalFileHeader=a}),tipo:"crud"},null,8,["modelValue"])):(0,t.Q3)("v-if",!0)]}),_:1})}var l=n(76080),s=n.n(l),r=n(45254),c=n.n(r),u=(n(30683),n(74260),n(39866),n(52133),n(10239),n(25751),n(56285),n(50310),n(32203),n(6724),n(83190),n(62692),n(27360),n(60858),n(64702),n(53514),n(57668)),d=n(88567),f=n(82327),h=n(88865),g=n(74656),p=n(66824),A=n(2555),v=n(22471),b=n(48501),m=n(73283),E=n(18482),M=n(48576),R=n(53380),U=n(41615),C=n(64303),w=n(59089),_=n(30640),k=n(33950),I=n(52350),T={components:{QCard:d.A,QItem:f.A,QItemSection:h.A,QAvatar:g.A,QItemLabel:p.A,plantillas:A["default"],envio:v["default"],analytics:m["default"],inbox:b["default"],QSeparator:R.A,exclusiones:E["default"],crearBotones:C.A,SieUpload:w.A,sieModal:_.A,ModalFileHeader:I.A,configuracion:M["default"]},data:function(){return{componente:"GestionCobranzas",nivelAcceso:(0,u["default"])().ruta.nivel,botones:[],BG_COLOR:"white",LECTURA_ESCRITURA:U["default"].LECTURA_ESCRITURA,isVisible:!1,hijos:[],estadoActual:"inicio",titulo:"Gestión de Cobranzas",dataMenu:{},sendMensaje:!1,addPlantilla:!1,tabEnvioSelected:"envio",showModalImg:!1,dataImgUpload:{},headerUrlDefault:null,esAdmin:U["default"].USUARIOS_ADMIN.includes((0,u["default"])().usucod),ID_WABA_TELF:null,filePrueba:null,dataImgPrueba:{},openModalFileHeader:!1}},methods:{showElements:function(){this.isVisible=!this.isVisible},clasesFinal:function(e){return this.isVisible?"enter-".concat(e," mostrar"):""},openEstado:function(e){var a=e.URL,n=e.MENUNOM;this.estadoActual=a,this.dataMenu=e,this.titulo="Gestión de Cobranzas "+(n?"- "+n:"")},goHome:function(){this.tabEnvioSelected="envio",this.openEstado({URL:"inicio"})},enviar:function(){this.$refs.envio.$refs.envioMETA.enviar()},agregarPlantilla:function(){this.$refs.plantillas.nuevaPlantilla()},agregarPlan:function(){this.$refs.analytics.agregarPlan()},agregarExclusion:function(){this.$refs.exclusiones.openModalRegistrar("agregar")},closeModalPlantilla:function(){this.addPlantilla=!1},falsoMensaje:function(){console.log("cancelar"),this.sendMensaje=!1},generarBotones:function(){this.botones=this.hijos.sort(function(e,a){return e.ORDEN-a.ORDEN}).map(this.generarRowButton)},generarRowButton:function(e){var a=this;return{label:e.MENUNOM,icon:e.ICONO,minAcceso:U["default"].SOLO_LECTURA,big:!0,color:this.BG_COLOR,click:function(){return a.openEstado(e)}}},changeEnvioTab:function(e){this.tabEnvioSelected=e},verLog:function(){window.open("".concat((0,u["default"])().api,"/WhatsappController/getLogs?token=").concat(btoa('{"archivo": "historial_webhook.txt"}')))},obtenerHeaderDefault:function(){var e=this;return c()(s()().m(function a(){var n;return s()().w(function(a){while(1)switch(a.p=a.n){case 0:return a.p=0,a.n=1,e.$http.get("api/WhatsappController/getWabaHeaderUrl");case 1:n=a.v,n&&(n.HEADER_URL&&(e.headerUrlDefault=n.HEADER_URL),n.ID_WABA_TELF&&(e.ID_WABA_TELF=n.ID_WABA_TELF)),a.n=3;break;case 2:a.p=2,a.v;case 3:return a.a(2)}},a,null,[[0,2]])}))()},agregarHeaderDefault:function(){var e=this;return c()(s()().m(function a(){return s()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,e.obtenerHeaderDefault();case 1:e.showModalImg=!0;case 2:return a.a(2)}},a)}))()},openModalHeaderFile:function(){var e=this;return c()(s()().m(function a(){return s()().w(function(a){while(1)switch(a.n){case 0:e.openModalFileHeader=!0;case 1:return a.a(2)}},a)}))()},guardarHeaderDefault:function(){var e=this;return c()(s()().m(function a(){var n,t;return s()().w(function(a){while(1)switch(a.p=a.n){case 0:return a.p=0,n={HEADER_IMG:e.dataImgUpload,ID_WABA_TELF:e.ID_WABA_TELF},a.n=1,e.$http.post("api/WhatsappController/saveHeaderUrlDefault",{params:n});case 1:a.v,e.$notify("Imagen guardada correctamente","success"),e.showModalImg=!1,a.n=3;break;case 2:a.p=2,t=a.v,e.$notify(t.error?t.error.message:t.message,"warning");case 3:return a.a(2)}},a,null,[[0,2]])}))()},uploadHeader:function(e){var a=this,n=e[0];(0,k["default"])({file:n}).then(function(e){a.dataImgUpload=e}).catch(function(e){console.log(e)})}},computed:{buttons:function(){if("inicio"!==this.estadoActual&&this.hijos.length>1){var e=[{label:"Volver",icon:"arrow_left",click:this.goHome}];return"envio"===this.estadoActual?"envio"===this.tabEnvioSelected&&(this.esAdmin&&e.push({label:"Logs",icon:"file_document",click:this.verLog,permiso:this.nivelAcceso<U["default"].LECTURA_ESCRITURA}),e.push({label:"Enviar",icon:"send",click:this.enviar,permiso:this.nivelAcceso<U["default"].LECTURA_ESCRITURA})):"plantillas"===this.estadoActual?(this.esAdmin,e.push({label:"Cabecera",icon:"collections_bookmark ",click:this.openModalHeaderFile,permiso:this.nivelAcceso<U["default"].LECTURA_ESCRITURA}),e.push({label:"Agregar",icon:"add",click:this.agregarPlantilla,permiso:this.nivelAcceso<U["default"].LECTURA_ESCRITURA})):"exclusiones"===this.estadoActual?e.push({label:"Agregar",icon:"add",click:this.agregarExclusion,permiso:this.nivelAcceso<U["default"].LECTURA_ESCRITURA}):"analytics"===this.estadoActual&&this.esAdmin&&e.push({label:"Agregar Plan",icon:"add",click:this.agregarPlan,permiso:this.nivelAcceso<U["default"].LECTURA_ESCRITURA}),e}}},beforeMount:function(){var e=this;return c()(s()().m(function a(){var n,t;return s()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,e.$http.get("api/menus/obtListaMenuAyuda");case 1:n=a.v,t=n.json,e.hijos=t.find(function(e){return e.URL===(0,u["default"])().ruta.name}).children,1===e.hijos.length&&(console.log(e.hijos[0]),e.openEstado(e.hijos[0])),e.obtenerHeaderDefault(),e.generarBotones(),setTimeout(function(){e.isVisible=!0},3e3);case 2:return a.a(2)}},a)}))()}},L=n(12807);const H=(0,L.A)(T,[["render",i]]);var D=H}}]);