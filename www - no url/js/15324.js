"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[15324],{15324:function(e,r,n){n.r(r),n.d(r,{default:function(){return T}});var a=n(8445),s=n.n(a),o=(n(56285),n(61758)),t=n(58790),i={class:"column",style:{display:"grid"}},l={class:"row"},c={class:"row justify-end"},u={class:"q-ma-sm"},d={class:"q-ma-sm q-card"},p={class:"row"},R={class:"row container-tables"},f={class:"col q-card q-ma-xs"},v={key:0,class:"row"},m={class:"row justify-center"},b={key:1},h={class:"col q-card q-ma-xs"},g={class:"row justify-center"};function C(e,r){var n=(0,o.g2)("header-btn"),a=(0,o.g2)("q-btn"),C=(0,o.g2)("q-select"),k=(0,o.g2)("q-field"),w=(0,o.g2)("sie-modal"),E=(0,o.g2)("q-td"),U=(0,o.g2)("q-tr"),I=(0,o.g2)("q-table");return(0,o.uX)(),(0,o.CE)("div",i,[(0,o.bF)(n,{name:"Recursos por Unidades"}),(0,o.bF)(w,{modelValue:e.estadoModal,"onUpdate:modelValue":r[1]||(r[1]=function(r){return e.estadoModal=r}),title:"Agregar Recurso a Unidad",onSubmit:e.agregarRecursoUnidad,ok:!1,noClose:!0,escClick:!0,esc:!0},{footerMobile:(0,o.k6)(function(){return[(0,o.Lk)("div",l,[(0,o.bF)(a,{class:"q-ma-xs",dense:"",round:"",flat:"",icon:"close",onClick:e.cancelarAgregacion},null,8,["onClick"]),(0,o.bF)(a,{class:"q-ma-xs",dense:"",round:"",flat:"",icon:"save",onClick:e.agregarRecursoUnidad},null,8,["onClick"])])]}),footer:(0,o.k6)(function(){return[(0,o.Lk)("div",c,[(0,o.bF)(a,{class:"q-ma-xs style-button",dense:"",color:"secondary",onClick:e.cancelarAgregacion},{default:(0,o.k6)(function(){return s()(r[3]||(r[3]=[(0,o.eW)("Cancelar",-1)]))}),_:1},8,["onClick"]),(0,o.bF)(a,{class:"q-ma-xs style-button",dense:"",color:"primary",onClick:e.agregarRecursoUnidad},{default:(0,o.k6)(function(){return[(0,o.eW)((0,t.v_)(e.lbAccion),1)]}),_:1},8,["onClick"])])]}),default:(0,o.k6)(function(){return[(0,o.Lk)("div",u,[(0,o.bF)(k,{error:e.v$.datosModal.RECURSOS.$error,"error-label":e.$t("validaciones.requerido")},{default:(0,o.k6)(function(){return[(0,o.bF)(C,{class:"q-if-outlined","float-label":"Recurso",modelValue:e.v$.datosModal.RECURSOS.$model,"onUpdate:modelValue":r[0]||(r[0]=function(r){return e.v$.datosModal.RECURSOS.$model=r}),options:e.opRecursos,multiple:"",chips:"",filter:"",placeholder:"Seleccione recursos"},null,8,["modelValue","options"])]}),_:1},8,["error","error-label"])])]}),_:1},8,["modelValue","onSubmit"]),(0,o.Lk)("div",d,[(0,o.Lk)("div",p,[(0,o.bF)(C,{class:"q-if-outlined",modelValue:e.filtroTipoReserva,"onUpdate:modelValue":r[2]||(r[2]=function(r){return e.filtroTipoReserva=r}),filter:"",multiple:"",chips:"",options:e.tiposReserva,placeholder:"Tipos de Reserva",style:{width:"100%"},onInput:e.filtrarUnidades},null,8,["modelValue","options","onInput"])]),(0,o.Lk)("div",R,[(0,o.Lk)("div",f,[(0,o.bF)(I,{class:"tabla-responsive",data:e.unidadesReservables,columns:e.colReservables,style:(0,t.Tr)({height:e.alto}),"hide-bottom":""},{body:(0,o.k6)(function(r){return[(0,o.bF)(U,{props:r,onClick:function(n){return e.obtenerRecursosUnidad(r.row)},class:(0,t.C4)({"custom-selected":r.row.ID===e.unidadSelect})},{default:(0,o.k6)(function(){return[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.cols,function(n){return(0,o.uX)(),(0,o.Wv)(E,{key:n.name,props:r},{default:(0,o.k6)(function(){return["ACCIONES"===n.field?((0,o.uX)(),(0,o.CE)("div",v,[(0,o.Lk)("div",m,[(0,o.bF)(a,{color:"green",icon:"add",flat:"",dense:"",roun:"",onClick:function(n){return e.mostrarModal(r.row)}},null,8,["onClick"])])])):((0,o.uX)(),(0,o.CE)("span",b,(0,t.v_)(n.value),1))]}),_:2},1032,["props"])}),128))]}),_:2},1032,["props","onClick","class"])]}),_:1},8,["data","columns","style"])]),(0,o.Lk)("div",h,[(0,o.bF)(I,{data:e.recursos,columns:e.colRecursos,style:(0,t.Tr)({height:e.alto})},{"body-cell-ACCIONES":(0,o.k6)(function(r){return[(0,o.bF)(E,{props:r},{default:(0,o.k6)(function(){return[(0,o.Lk)("div",g,[(0,o.bF)(a,{color:"red",icon:"delete",flat:"",dense:"",round:"",onClick:function(n){return e.eliminarRecursoUnidad(r.row)}},null,8,["onClick"])])]}),_:2},1032,["props"])]}),_:1},8,["data","columns","style"])])])])])}var k=n(76080),w=n.n(k),E=n(45254),U=n.n(E),I=(n(30683),n(77507),n(10239),n(50310),n(90095),n(83190),n(13715),n(83972)),A=n(30545),S=n(11654),$=n(30640),O=n(6123),y=n(82640),_=n(57668),D={setup:function(){var e=(0,I.fG)();return{v$:e}},components:{QTable:A.A,QBtn:S.A,sieModal:$.A,QDatetime:O.T5,QSelect:O.Si,QTd:O.Ef,QToolbar:O.ZV,QRadio:O.$,QTr:O.qh,QField:O.Om},data:function(){return{alto:"0px",permiso:(0,_["default"])().ruta.nivel,fila:"",lbAccion:"Agregar",estadoModal:!1,filtroTipoReserva:[],unidadSelect:null,datosModal:{RECURSOS:[],UNIDAD_RESERVABLE_ID:null},opRecursos:[],recursos:[],tiposReserva:[],unidadesReservables:[],colReservables:[{name:"NOMBRE",label:"Unidad Reservable",field:"NOMBRE",align:"center",sortable:!0},{name:"TIPO_RESERVA",label:"Tipo de Reserva",field:"TIPO_RESERVA",align:"center"}],colRecursos:[{name:"NOMBRE",label:"Recursos",field:"NOMBRE",align:"center",sortable:!0},{name:"CODIGO_ACTIVO",label:"Código activo",field:"CODIGO_ACTIVO",align:"center"}]}},mounted:function(){this.obtenerTiposReservas(),this.obtenerUnidadesReservables(),this.handleResize(),this.permiso>=2&&this.colReservables.push({name:"ACCIONES",label:"Acciones",field:"ACCIONES",align:"center",style:"width: 40px"}),3===this.permiso&&this.colRecursos.push({name:"ACCIONES",label:"Acciones",field:"ACCIONES",align:"center",style:"max-width: 10px"})},validations:function(){var e={RECURSOS:{required:y.mw}};return{datosModal:e}},methods:{handleResize:function(){window.innerWidth>600?this.alto=window.innerHeight-240+"px":this.alto="400px"},mostrarModal:function(e){this.obtenerRecursos(e.ID),this.estadoModal=!0,this.datosModal.UNIDAD_RESERVABLE_ID=e.ID},agregarRecursoUnidad:function(){var e=this;return U()(w()().m(function r(){var n,a;return w()().w(function(r){while(1)switch(r.p=r.n){case 0:if(e.v$.$touch(),e.v$.$error){r.n=4;break}return r.p=1,r.n=2,e.$http.post("api/RsRecursoController/addRsRecursoUnidad",{data:e.datosModal});case 2:n=r.v,1===n.code&&(e.obtenerRecursosUnidad({ID:e.datosModal.UNIDAD_RESERVABLE_ID}),e.$notify("Agregado","success"),e.limpiarCampos(),e.estadoModal=!1),r.n=4;break;case 3:r.p=3,a=r.v,e.$notify(a.error.message,"error");case 4:return r.a(2)}},r,null,[[1,3]])}))()},eliminarRecursoUnidad:function(e){var r=this;return U()(w()().m(function n(){var a,s,o,t;return w()().w(function(n){while(1)switch(n.p=n.n){case 0:return n.n=1,r.$confirmar("¿Esta Ud. Seguro de Retirar el Recurso?","warning",!0);case 1:if(a=n.v,!a){n.n=5;break}return n.p=2,s=e.UNIDAD_RESERVABLE_ID,e={recurso_id:e.RECURSO_ID,unidad_reservable_id:s},n.n=3,r.$http.delete("api/RsRecursoController/deleteRsRecursoUnidad",{data:e});case 3:o=n.v,1===o.code&&(r.obtenerRecursosUnidad({ID:s}),r.$notify("Retirado","success")),n.n=5;break;case 4:n.p=4,t=n.v,r.$notify(t.error.message,"error");case 5:return n.a(2)}},n,null,[[2,4]])}))()},obtenerRecursosUnidad:function(e){var r=this;return U()(w()().m(function n(){var a;return w()().w(function(n){while(1)switch(n.p=n.n){case 0:return n.p=0,r.unidadSelect=e.ID,n.n=1,r.$http.get("api/RsUnidadReservableController/getRsUnidadRecurso",{params:{id:e.ID}});case 1:r.recursos=n.v,n.n=3;break;case 2:n.p=2,a=n.v,r.$notify(a.error.message,"error");case 3:return n.a(2)}},n,null,[[0,2]])}))()},obtenerUnidadesReservables:function(){var e=this;return U()(w()().m(function r(){var n;return w()().w(function(r){while(1)switch(r.p=r.n){case 0:return r.p=0,r.n=1,e.$http.get("api/RsUnidadReservableController/getRsUnidadReservable",{params:{tipoReserva:""}});case 1:e.unidadesReservables=r.v,r.n=3;break;case 2:r.p=2,n=r.v,e.$notify(n.error.message,"error");case 3:return r.a(2)}},r,null,[[0,2]])}))()},filtrarUnidades:function(){var e=this;return U()(w()().m(function r(){var n,a;return w()().w(function(r){while(1)switch(r.p=r.n){case 0:return r.p=0,n=e.filtroTipoReserva.join(","),r.n=1,e.$http.get("api/RsUnidadReservableController/getRsUnidadReservable",{params:{tipoReserva:n}});case 1:e.unidadesReservables=r.v,r.n=3;break;case 2:r.p=2,a=r.v,e.$notify(a.error.message,"error");case 3:return r.a(2)}},r,null,[[0,2]])}))()},obtenerRecursos:function(e){var r=this;return U()(w()().m(function n(){var a,s;return w()().w(function(n){while(1)switch(n.p=n.n){case 0:return n.p=0,r.opRecursos=[],n.n=1,r.$http.get("api/RsRecursoController/getRsRecursosDisponibles",{params:{id:e,noAsignados:!0}});case 1:a=n.v,a.forEach(function(e){var n={label:"".concat(e.NOMBRE," - ").concat(e.CODIGO_ACTIVO),value:e.ID};r.opRecursos.push(n)}),n.n=3;break;case 2:n.p=2,s=n.v,r.$notify(s.error.message,"error");case 3:return n.a(2)}},n,null,[[0,2]])}))()},obtenerTiposReservas:function(){var e=this;return U()(w()().m(function r(){var n,a;return w()().w(function(r){while(1)switch(r.p=r.n){case 0:return r.p=0,r.n=1,e.$http.get("api/RsTipoReservaController/getRsTipoReserva");case 1:n=r.v,n.forEach(function(r){var n={label:r.NOMBRE,value:r.ID};e.tiposReserva.push(n)}),r.n=3;break;case 2:r.p=2,a=r.v,e.$notify(a.error.message,"error");case 3:return r.a(2)}},r,null,[[0,2]])}))()},cancelarAgregacion:function(){this.limpiarCampos(),this.estadoModal=!1},limpiarCampos:function(){this.datosModal.RECURSOS=[],this.v$.$reset()}},unmounted:function(){window.removeEventListener("resize",this.handleResize)}},M=n(12807);const q=(0,M.A)(D,[["render",C]]);var T=q}}]);