"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[19237],{19237:function(n,e,t){t.r(e),t.d(e,{default:function(){return I}});var o=t(61758),a={class:"column q-ma-xs"},i={class:"row justify-center col q-mt-xs"},s={class:"col-xs-12"};function r(n,e){var t=(0,o.g2)("header-btn"),r=(0,o.g2)("q-btn"),c=(0,o.g2)("q-card-section"),u=(0,o.g2)("q-card");return(0,o.uX)(),(0,o.CE)("div",a,[(0,o.bF)(t,{name:"Registro de Whatsapp",buttons:n.buttons},null,8,["buttons"]),(0,o.bF)(u,{bordered:""},{default:(0,o.k6)(function(){return[(0,o.bF)(c,null,{default:(0,o.k6)(function(){return[(0,o.Lk)("div",i,[e[1]||(e[1]=(0,o.Lk)("div",{class:"col-xs-12"},[(0,o.Lk)("div",{class:"q-pb-md",id:"status"})],-1)),(0,o.Lk)("div",s,[(0,o.bF)(r,{class:"fb-login-btn",label:"Inicia Sesión con Facebook",onClick:e[0]||(e[0]=function(e){return n.launchWhatsAppSignup()})})])])]}),_:1})]}),_:1})])}var c=t(76080),u=t.n(c),l=t(45254),d=t.n(l),f=(t(56285),t(515),t(83190),t(27153),t(7346),t(9736)),p=t(16648),w=t(11654),g=t(96529),b=t(30545),m=t(88567),h=t(34262),v=t(95718),k=t(3112),A=t(6123),_=t(33777),B=(t(80660),t(66099)),S={components:{QInput:f.A,QSelect:p.A,sieFamilia:g.A,QTable:b.A,QCheckbox:k.A,QTr:A.qh,QTd:A.Ef,SieTable:_.A,QInnerLoading:A.SQ,QSpinnerOval:A.VA,sieHtml:B.A,QBtn:w.A,QCard:m.A,QCardSection:v.A,QIcon:h.A},data:function(){return{}},computed:{buttons:function(){var n=[];return n}},methods:{initFacebook:function(){var n=this;return d()(u()().m(function e(){return u()().w(function(e){while(1)switch(e.n){case 0:return e.a(2,new Promise(function(e){window.fbAsyncInit=function(){window.FB.init({appId:494123186480164,cookie:!0,xfbml:!0,version:"v20.0"}),e()},window.FB.getLoginStatus(function(e){n.statusChangeCallback(e)})}))}},e)}))()},loadFacebookSDK:function(n,e,t){return d()(u()().m(function o(){return u()().w(function(o){while(1)switch(o.n){case 0:return o.a(2,new Promise(function(o,a){var i,s=n.getElementsByTagName(e)[0];n.getElementById(t)||(i=n.createElement(e),i.id=t,i.src="https://connect.facebook.net/en_US/sdk.js",s.parentNode.insertBefore(i,s),i.onload=o,i.onerror=a)}))}},o)}))()},launchWhatsAppSignup:function(){return d()(u()().m(function n(){return u()().w(function(n){while(1)switch(n.n){case 0:window.fbq&&window.fbq("trackCustom","WhatsAppOnboardingStart",{appId:494123186480164,feature:"whatsapp_embedded_signup"}),window.FB.login(function(n){if(console.log(n),n.authResponse){var e=n.authResponse.code;console.log(e)}else console.log("User cancelled login or did not fully authorize.")},{config_id:854862043219613,response_type:"code",override_default_response_type:!0,extras:{setup:{}}});case 1:return n.a(2)}},n)}))()},logOut:function(){return d()(u()().m(function n(){return u()().w(function(n){while(1)switch(n.n){case 0:window.FB.logout(function(n){});case 1:return n.a(2)}},n)}))()},statusChangeCallback:function(n){"connected"===n.status?this.testAPI():document.getElementById("status").innerHTML="Por favor, inicie sesión en esta página web."},testAPI:function(){console.log("¡Bienvenido!  Obteniendo su información.... "),window.FB.api("/me",function(n){console.log("Inicio de sesión exitoso para: "+n.name),document.getElementById("status").innerHTML="¡Gracias por iniciar sesión, "+n.name+"!"})},checkLoginState:function(){var n=this;window.FB.getLoginStatus(function(e){n.statusChangeCallback(e)})},registrarWABA:function(n,e){var t=this;return d()(u()().m(function o(){var a;return u()().w(function(o){while(1)switch(o.p=o.n){case 0:return o.p=0,o.n=1,t.$http.post("api/WhatsappController/registrarWABA",{params:{params:{phone_number_id:e,waba_id:n}}});case 1:o.n=3;break;case 2:o.p=2,a=o.v,t.$notify(a.error?a.error.message:a.message,"warning");case 3:return o.a(2)}},o,null,[[0,2]])}))()}},beforeMount:function(){var n=this;return d()(u()().m(function e(){var t,o;return u()().w(function(e){while(1)switch(e.n){case 0:return e.n=1,n.loadFacebookSDK(document,"script","facebook-jssdk");case 1:return t=e.v,console.log(t),e.n=2,n.initFacebook();case 2:o=e.v,console.log(o);case 3:return e.a(2)}},e)}))()},mounted:function(){var n=this;window.addEventListener("message",function(e){if("https://www.facebook.com"===e.origin||"https://web.facebook.com"===e.origin)try{var t=JSON.parse(e.data);if("WA_EMBEDDED_SIGNUP"===t.type){console.log("message event: ",t);var o=t.data.waba_id,a=t.data.phone_number_id;o&&a&&n.registrarWABA(o,a)}}catch(n){console.log("message event: ",e.data)}})}},F=t(12807);const C=(0,F.A)(S,[["render",r],["__scopeId","data-v-f5ebe748"]]);var I=C}}]);