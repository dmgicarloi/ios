"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[14003],{14003:function(e,a,o){o.r(a),o.d(a,{default:function(){return oa}});o(23825),o(11777),o(15547),o(83190),o(24066);var r=o(61758),n=o(29104),t=o(58790),s={class:"row q-ma-xs q-col-gutter-sm"},i={class:"col-xs-12 col-md-6 col-lg-6"},l={class:"row q-ma-xs q-col-gutter-sm"},c={class:"col-xs-12 col-md-12 col-lg-12"},u={class:"row q-ma-xs q-col-gutter-sm"},d={class:"col-xs-12"},f={class:"col-xs-6 col-lg-4"},m={class:"col-xs-6 col-lg-4"},p={class:"row q-ma-xs q-col-gutter-sm"},g={class:"col-xs-11"},v={class:"col-xs-1 flex justify-center align-center"},P={class:"col-xs-6 col-lg-4"},h={class:"col-xs-6 col-lg-4"},b={class:"col-xs-12 col-lg-8"},E={class:"col-xs-6 col-md-4"},O={class:"col-xs-6 col-md-4"},A={key:0,class:"col-xs-6 col-lg-4"},N={key:0,class:"row q-ma-xs q-col-gutter-sm"},C={class:"col-xs-12"},w={class:"col-xs-6 col-lg-4"},I={class:"col-xs-6 col-lg-4"},_={class:"col-sm-12 col-lg-4"},T={class:"col-xs-12 col-md-6 col-lg-6"},D={class:"row q-ma-xs q-col-gutter-sm"},V={class:"col-xs-6 col-sm-4 col-lg-4"},S={class:"col-xs-6 col-sm-4 col-lg-4"},U={class:"col-xs-12 col-sm-4 col-lg-4"},k={class:"col-xs-12"},M={class:"col-xs-12 col-lg-6 flex align-center justify-end",style:{"align-items":"center"}},R={class:"column ptotal"};function L(e,a){var o=this,L=(0,r.g2)("q-page-header"),F=(0,r.g2)("q-separator"),x=(0,r.g2)("q-select"),y=(0,r.g2)("q-input"),G=(0,r.g2)("q-checkbox"),q=(0,r.g2)("q-date"),$=(0,r.g2)("q-popup-proxy"),j=(0,r.g2)("q-icon"),B=(0,r.g2)("q-card-main"),Q=(0,r.g2)("q-card"),H=(0,r.g2)("sie-grid"),X=(0,r.g2)("q-card-section"),Y=(0,r.g2)("AgregarPersona"),W=(0,r.g2)("consultarComprobante"),K=(0,r.g2)("formaPago"),J=(0,r.g2)("crear-pases"),z=(0,r.g2)("intercambiar-pases"),Z=(0,r.g2)("reasignar-pases");return(0,r.uX)(),(0,r.Wv)(Q,{class:"layout-v1 my-card",flat:"",bordered:"",style:{height:"100vh"}},{default:(0,r.k6)(function(){return[(0,r.bF)(L,{botones:e.pageHeader.botones,title:e.pageHeader.title,useTab:"",tabs:e.pageHeader.tabs,onActionTab:e.actionTab,componente:e.pageHeader.componente,nivelAcceso:e.pageHeader.nivelAcceso,dropdown:o.$q.screen.lt.md||o.$q.screen.lt.lg},null,8,["botones","title","tabs","onActionTab","componente","nivelAcceso","dropdown"]),(0,r.bF)(F),e.pageHeader.tabActive===e.pageHeader.tabsKeys.index?((0,r.uX)(),(0,r.Wv)(X,{key:0},{default:(0,r.k6)(function(){return[(0,r.Lk)("div",s,[(0,r.Lk)("div",i,[(0,r.Lk)("div",l,[(0,r.Lk)("div",c,[(0,r.Lk)("div",u,[(0,r.Lk)("div",d,[(0,r.bF)(x,{class:"truncate-label",modelValue:e.form.evento,"onUpdate:modelValue":a[0]||(a[0]=function(a){return e.form.evento=a}),label:"Evento",placeholder:"Seleccione el evento",options:e.data.eventos,"option-label":"EVENTO_TITULO","option-value":"EVENTO_ID",onInput:e.obtenerPases},null,8,["modelValue","options","onInput"])]),(0,r.Lk)("div",f,[(0,r.bF)(x,{class:"truncate-label",modelValue:e.form.talonario,"onUpdate:modelValue":a[1]||(a[1]=function(a){return e.form.talonario=a}),label:"Talonario",placeholder:"Seleccione el Talonario",options:e.data.talonarios,"option-label":"TALDES","option-value":"NUMTAL",onInput:e.getNroRecibo},null,8,["modelValue","options","onInput"])]),(0,r.Lk)("div",m,[(0,r.Lk)("div",p,[(0,r.Lk)("div",g,[(0,r.bF)(y,{modelValue:e.form.nroRecibo,"onUpdate:modelValue":a[2]||(a[2]=function(a){return e.form.nroRecibo=a}),label:"Numero",placeholder:"Ingrese el numero del correlatio",disable:!e.disable.nroRecibo,readonly:!e.disable.nroRecibo},null,8,["modelValue","disable","readonly"])]),(0,r.Lk)("div",v,[(0,r.bF)(G,{modelValue:e.disable.nroRecibo,"onUpdate:modelValue":a[3]||(a[3]=function(a){return e.disable.nroRecibo=a})},null,8,["modelValue"])])])]),(0,r.Lk)("div",P,[(0,r.bF)(x,{class:"truncate-label",onInput:e.changeMedioPago,modelValue:e.form.medioPago,"onUpdate:modelValue":a[4]||(a[4]=function(a){return e.form.medioPago=a}),label:"Medio Pago",placeholder:"Seleccione el medio de pago",options:e.data.formasPago,"option-value":"ID_MEDIOPAGO","option-label":"MEDIOPAGO"},null,8,["onInput","modelValue","options"])]),(0,r.Lk)("div",h,[(0,r.bF)(x,{class:"truncate-label",modelValue:e.form.perfil,"onUpdate:modelValue":a[5]||(a[5]=function(a){return e.form.perfil=a}),label:"Perfil",placeholder:"Seleccione el perfil",options:e.data.perfiles,onInput:e.getPersonasPerfil},null,8,["modelValue","options","onInput"])]),(0,r.Lk)("div",b,[(0,r.bF)(x,{class:"truncate-label",modelValue:e.form.persona,"onUpdate:modelValue":a[6]||(a[6]=function(a){return e.form.persona=a}),label:"Persona",placeholder:"Seleccione la persona",options:e.data.personas,onInput:e.obtenerPasesPorPersona},null,8,["modelValue","options","onInput"])]),(0,r.Lk)("div",E,[(0,r.bF)(y,{"reverse-fill-mask":"",modelValue:e.form.fecpag,"onUpdate:modelValue":a[9]||(a[9]=function(a){return e.form.fecpag=a}),maxlength:"10",mask:"##/##/####",label:"Fecha Pago"},{append:(0,r.k6)(function(){return[(0,r.bF)(j,{class:"cursor-pointer",name:"date_range"},{default:(0,r.k6)(function(){return[(0,r.bF)($,{ref:"qDateProxy1","transition-show":"scale","transition-hide":"scale"},{default:(0,r.k6)(function(){return[(0,r.bF)(q,{mask:"DD/MM/YYYY",modelValue:e.form.fecpag,"onUpdate:modelValue":a[7]||(a[7]=function(a){return e.form.fecpag=a}),onInput:a[8]||(a[8]=function(a){return e.closeCalendar("qDateProxy1")})},null,8,["modelValue"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])]),(0,r.Lk)("div",O,[(0,r.bF)(y,{"reverse-fill-mask":"",modelValue:e.form.fecVen,"onUpdate:modelValue":a[12]||(a[12]=function(a){return e.form.fecVen=a}),maxlength:"10",mask:"##/##/####",label:"Fecha Vencimiento"},{append:(0,r.k6)(function(){return[(0,r.bF)(j,{class:"cursor-pointer",name:"date_range"},{default:(0,r.k6)(function(){return[(0,r.bF)($,{ref:"qDateProxy2","transition-show":"scale","transition-hide":"scale"},{default:(0,r.k6)(function(){return[(0,r.bF)(q,{mask:"DD/MM/YYYY",modelValue:e.form.fecVen,"onUpdate:modelValue":a[10]||(a[10]=function(a){return e.form.fecVen=a}),onInput:a[11]||(a[11]=function(a){return e.closeCalendar("qDateProxy2")})},null,8,["modelValue"])]}),_:1},512)]}),_:1})]}),_:1},8,["modelValue"])]),e.views.mostrarVoucher?((0,r.uX)(),(0,r.CE)("div",A,[(0,r.bF)(y,{modelValue:e.form.voucher,"onUpdate:modelValue":a[13]||(a[13]=function(a){return e.form.voucher=a}),label:e.labels.numero,maxlength:"20",onInput:e.changeVoucher},null,8,["modelValue","label","onInput"])])):(0,r.Q3)("v-if",!0)]),e.views.notaCredito?((0,r.uX)(),(0,r.CE)("div",N,[(0,r.Lk)("div",C,[(0,r.bF)(Q,{class:"col-12 q-card-legend q-mt-lg",title:"Nota de Credito"},{default:(0,r.k6)(function(){return[(0,r.bF)(B,{class:"row gutter-xs"},{default:(0,r.k6)(function(){return[(0,r.Lk)("div",w,[(0,r.bF)(x,{class:"truncate-label",label:"Talonario",placeholder:"Seleccione la nota de crédito",options:e.data.notaCredito,"option-value":"NUMTAL","option-label":"TALDES",modelValue:e.form.notaCredito.numtal,"onUpdate:modelValue":a[14]||(a[14]=function(a){return e.form.notaCredito.numtal=a})},null,8,["options","modelValue"])]),(0,r.Lk)("div",I,[(0,r.bF)(y,{type:"numpag",maxlength:"7",label:"Nro. Documento",placeholder:"Ingrese el número de Documento",modelValue:e.form.notaCredito.numtal,"onUpdate:modelValue":a[15]||(a[15]=function(a){return e.form.notaCredito.numtal=a}),onKeyup:(0,n.jR)(e.consultarSaldoNotaCredito,["enter"])},{default:(0,r.k6)(function(){return[(0,r.bF)(j,{class:"cursor-pointer",name:"search",color:"primary",onClick:e.consultarSaldoNotaCredito,size:"sm"},null,8,["onClick"])]}),_:1},8,["modelValue","onKeyup"])]),(0,r.Lk)("div",_,[(0,r.bF)(y,{label:"Saldo",modelValue:e.form.notaCredito.saldo,"onUpdate:modelValue":a[16]||(a[16]=function(a){return e.form.notaCredito.saldo=a}),readonly:"",disable:""},null,8,["modelValue"])])]}),_:1})]}),_:1})])])):(0,r.Q3)("v-if",!0)])])]),(0,r.Lk)("div",T,[(0,r.Lk)("div",D,[(0,r.Lk)("div",V,[(0,r.bF)(x,{class:"truncate-label",modelValue:e.form.tipoUso,"onUpdate:modelValue":a[17]||(a[17]=function(a){return e.form.tipoUso=a}),label:"Concepto",placeholder:"Seleccione el tipo de uso",onInput:e.obtenerPasePorCorrelativo,options:e.data.tipoUso,"option-value":"ID_TIPO_USO","option-label":"CONDES"},null,8,["modelValue","onInput","options"])]),(0,r.Lk)("div",S,[(0,r.bF)(y,{modelValue:e.code,"onUpdate:modelValue":a[18]||(a[18]=function(a){return e.code=a}),autofocus:"",label:"Escanear código QR",placeholder:"Escanee el QR",onKeydown:e.codeWithGun},null,8,["modelValue","onKeydown"])]),(0,r.Lk)("div",U,[(0,r.bF)(y,{modelValue:e.form.tarjeta,"onUpdate:modelValue":a[19]||(a[19]=function(a){return e.form.tarjeta=a}),label:"Tarjeta",placeholder:"Seleccione una tarjeta",onKeyup:(0,n.jR)(e.onTarjeta,["enter"]),onInput:e.formatoPases},{default:(0,r.k6)(function(){return[(0,r.bF)(j,{class:"pointer",name:"search",style:{color:"primary","font-size":"2rem"},onClick:e.onTarjeta},null,8,["onClick"])]}),_:1},8,["modelValue","onKeyup","onInput"])]),(0,r.Lk)("div",k,[(0,r.bF)(H,{class:"ag-theme-balham",style:{height:"calc(100vh - 440px)",width:"100%"},rowData:e.grid.rowData,columnDefs:e.grid.columns,onGridReady:e.onGridReady,onRowSelected:e.getTotal,rowSelection:"multiple"},null,8,["rowData","columnDefs","onGridReady","onRowSelected"]),(0,r.Lk)("div",M,[(0,r.Lk)("p",R,"Total a Pagar: "+(0,t.v_)(e.grid.monedaTotal)+" "+(0,t.v_)(Number(e.grid.total).toFixed(2)),1)])])])])])]}),_:1})):(0,r.Q3)("v-if",!0),e.views.agregarPersona?((0,r.uX)(),(0,r.Wv)(Y,{key:1,modelValue:e.views.agregarPersona,"onUpdate:modelValue":a[20]||(a[20]=function(a){return e.views.agregarPersona=a}),onSubmit:e.seleccionarPersona,perfilDefecto:e.keys.perfilAuxiliar,eventos:""},null,8,["modelValue","onSubmit","perfilDefecto"])):(0,r.Q3)("v-if",!0),(0,r.bo)((0,r.bF)(W,{ref:e.pageHeader.tabsKeys.consultar,lessHeight:"360",tab:"",cp:"pagoEventos"},null,512),[[n.aG,e.pageHeader.tabActive===e.pageHeader.tabsKeys.consultar]]),e.formaPago.modal?((0,r.uX)(),(0,r.Wv)(K,{key:2,modelValue:e.formaPago.modal,"onUpdate:modelValue":a[21]||(a[21]=function(a){return e.formaPago.modal=a}),onSubmit:e.guardarFormasDePago,feccam:e.formaPago.feccam,mondeuda:e.formaPago.monedaActual,saldo:e.grid.total},null,8,["modelValue","onSubmit","feccam","mondeuda","saldo"])):(0,r.Q3)("v-if",!0),(0,r.bF)(J,{modelValue:e.views.crearPases,"onUpdate:modelValue":a[22]||(a[22]=function(a){return e.views.crearPases=a}),"evento-id":e.form.evento,"persona-id":e.form.persona,individual:"",onObtenerPasePorCorrelativo:e.obtenerPasePorCorrelativo},null,8,["modelValue","evento-id","persona-id","onObtenerPasePorCorrelativo"]),(0,r.bF)(z,{modelValue:e.views.intercambiarPases,"onUpdate:modelValue":a[23]||(a[23]=function(a){return e.views.intercambiarPases=a}),"evento-id":e.form.evento,"persona-id":e.form.persona},null,8,["modelValue","evento-id","persona-id"]),(0,r.bF)(Z,{modelValue:e.views.reasignarPase,"onUpdate:modelValue":a[24]||(a[24]=function(a){return e.views.reasignarPase=a}),"evento-id":e.form.evento},null,8,["modelValue","evento-id"])]}),_:1})}var F=o(41562),x=o.n(F),y=o(99550),G=o.n(y),q=o(76080),$=o.n(q),j=o(45254),B=o.n(j),Q=(o(12563),o(34634),o(30683),o(71225),o(74260),o(85472),o(39866),o(77507),o(52133),o(10239),o(23513),o(45467),o(50310),o(5962),o(32203),o(6724),o(92802),o(48426),o(32408),o(515),o(27153),o(40048),o(76921),o(13600),o(52776),o(37406),o(84433),o(44264),o(88390),o(62692),o(66307),o(2369),o(68017),o(88567)),H=o(95718),X=o(53380),Y=o(54489),W=o(12143),K=o(6123),J=o(54267),z=o(80660),Z=o(36408),ee=o(27560),ae=o(96330),oe=o(75053),re=o(64208),ne=o(95477),te=o(3112),se=o(41615),ie=o(42037),le=o(64303),ce=o(2805),ue=o(38739),de=o(2652),fe=o(14507),me=o(57668),pe=o(34262),ge=o(69759),ve=o(9820),Pe=o(21692),he=o(8445),be=o.n(he),Ee={class:"row q-col-gutter-sm"},Oe={class:"col-12"},Ae={class:"col-12"},Ne={class:"col-12"},Ce={class:"col-12"},we={class:"col-12"},Ie={class:"col-12"},_e={class:"q-mx-xs"},Te={class:"row"},De={class:"row q-col-gutter-sm"},Ve={class:"col-12 row q-gutter-sm"},Se={class:"text-h6"},Ue={class:"col-12"},ke={class:"absolute-full flex flex-center"};function Me(e,a){var o=this,n=(0,r.g2)("q-select"),s=(0,r.g2)("sie-table"),i=(0,r.g2)("q-checkbox"),l=(0,r.g2)("q-form"),c=(0,r.g2)("q-bar"),u=(0,r.g2)("q-icon"),d=(0,r.g2)("q-badge"),f=(0,r.g2)("q-linear-progress"),m=(0,r.g2)("q-card-section"),p=(0,r.g2)("q-btn"),g=(0,r.g2)("q-card-actions"),v=(0,r.g2)("q-card"),P=(0,r.g2)("q-dialog"),h=(0,r.g2)("sie-modal");return(0,r.uX)(),(0,r.Wv)(h,{class:"eventos--component-crear-pases",modelValue:e.modal,"onUpdate:modelValue":a[8]||(a[8]=function(a){return e.modal=a}),title:"Intercambiar pases",onClose:e.cerrarModal,ok:"Siguiente",cancel:"Cerrar","esc-click":"",onSubmit:e.reasignarPases},{default:(0,r.k6)(function(){return[(0,r.bF)(l,{class:"q-pa-md",ref:"formIntercambiarPases"},{default:(0,r.k6)(function(){return[(0,r.Lk)("div",Ee,[(0,r.Lk)("div",Oe,[a[9]||(a[9]=(0,r.eW)("Seleccione al participante de quien se tomarán los pases:",-1)),(0,r.bF)(n,{modelValue:e.idEventoPersonaOrigen,"onUpdate:modelValue":a[0]||(a[0]=function(a){return e.idEventoPersonaOrigen=a}),"option-label":"NOMCOMP","option-value":"EVENTO_PERSONA_ID","hide-bottom-space":"",options:e.personasOrigen,rules:[function(e){return!!e||"Seleccione un participante."}],custom:!1,outlined:!1,onSelected:e.obtenerPases},null,8,["modelValue","options","rules","onSelected"])]),(0,r.Lk)("div",Ae,[a[10]||(a[10]=(0,r.eW)("Tipo de uso:",-1)),(0,r.bF)(n,{modelValue:e.eventoTipoUsoId,"onUpdate:modelValue":a[1]||(a[1]=function(a){return e.eventoTipoUsoId=a}),"hide-bottom-space":"",options:e.eventoTipoUso,custom:!1,outlined:!1},null,8,["modelValue","options"])]),(0,r.Lk)("div",Ne,[(0,r.bF)(s,{dense:"",flat:"",bordered:"","wrap-cells":"","show-search":"",css:"height: 200px",selection:"multiple",ref:"pasesParticipante",context:o,columns:e.fields,data:e.dataRow,config:e.config},null,8,["columns","data","config"])]),(0,r.Lk)("div",Ce,[a[11]||(a[11]=(0,r.eW)("Seleccione al participante a quien se le asignarán los pases:",-1)),(0,r.bF)(n,{modelValue:e.idEventoPersonaDestino,"onUpdate:modelValue":a[2]||(a[2]=function(a){return e.idEventoPersonaDestino=a}),"option-label":"NOMCOMP","option-value":"EVENTO_PERSONA_ID","hide-bottom-space":"",options:e.personasDestino,rules:[function(e){return!!e||"Seleccione un participante."}],custom:!1,outlined:!1},null,8,["modelValue","options","rules"])]),(0,r.Lk)("div",we,[(0,r.bF)(i,{modelValue:e.cambiarEstadoPases,"onUpdate:modelValue":a[3]||(a[3]=function(a){return e.cambiarEstadoPases=a}),label:"Cambiar el estado de los pases",onInput:e.checkCambiarEstadoPases,"left-label":""},null,8,["modelValue","onInput"])]),(0,r.Lk)("div",Ie,[(0,r.Lk)("div",_e,[a[12]||(a[12]=(0,r.eW)("Los pases se reasignarán con el estado...",-1)),(0,r.bF)(n,{modelValue:e.eventoPaseEstadoId,"onUpdate:modelValue":a[4]||(a[4]=function(a){return e.eventoPaseEstadoId=a}),"option-label":"name","hide-bottom-space":"",options:e.eventoPaseEstado,rules:e.cambiarEstadoPases?[function(e){return!!e||"Seleccione un estado."}]:[],custom:!1,outlined:!1,disable:e.offEventoPaseEstado},null,8,["modelValue","options","rules","disable"])])])])]}),_:1},512),(0,r.bF)(P,{modelValue:e.inProgress,"onUpdate:modelValue":a[7]||(a[7]=function(a){return e.inProgress=a}),persistent:""},{default:(0,r.k6)(function(){return[(0,r.bF)(v,{class:"eventos--component-participantes-eventos--dialog-card"},{default:(0,r.k6)(function(){return[(0,r.bF)(c,{class:"row bg-primary text-white"},{default:(0,r.k6)(function(){return be()(a[13]||(a[13]=[(0,r.Lk)("div",{class:"col"},"SieWeb",-1)]))}),_:1}),(0,r.Lk)("div",Te,[(0,r.bF)(u,{class:"q-icon-ticket",name:"confirmation_number",size:"40px",color:"primary"}),(0,r.bF)(m,{class:"col"},{default:(0,r.k6)(function(){return[(0,r.Lk)("div",De,[(0,r.Lk)("div",Ve,[(0,r.Lk)("div",Se,(0,t.v_)(e.messageProgress),1)]),(0,r.Lk)("div",Ue,[(0,r.bF)(f,{size:"50px",value:e.progress,color:"secondary",rounded:"",stripe:""},{default:(0,r.k6)(function(){return[(0,r.Lk)("div",ke,[(0,r.bF)(d,{color:"white","text-color":"primary",label:e.progressLabel},null,8,["label"])])]}),_:1},8,["value"])])])]}),_:1})]),(0,r.bF)(g,{align:"right"},{default:(0,r.k6)(function(){return[e.errores.length?((0,r.uX)(),(0,r.Wv)(p,{key:0,size:"sm",label:"Pases no generados",color:"negative",onClick:a[5]||(a[5]=function(){})})):(0,r.Q3)("v-if",!0),(0,r.bF)(p,{size:"sm",label:"Cerrar",color:"primary",onClick:a[6]||(a[6]=function(a){return e.inProgress=!1}),disable:!e.complete},null,8,["disable"])]}),_:1})]}),_:1})]}),_:1},8,["modelValue"])]}),_:1},8,["modelValue","onClose","onSubmit"])}var Re=o(2739),Le=o(16648),Fe=o(42205),xe=o(20456),ye=o(11654),Ge=o(62565),qe=o(34963),$e=o(41126),je=(o(56285),o(78786)),Be={data:function(){return{config:{EVENTO_PASE_ESTADO:{renderHtml:function(e,a,o){var r=(0,je["default"])(this.eventoPaseEstado,e.EVENTO_PASE_ESTADO,{key:"value"});return o.background({text:this.eventoPaseEstado[r].name,textColor:"white",color:this.eventoPaseEstado[r].color})}}},fields:[{name:"EVENTO_PASE_CORRELATIVO",label:"Número de pase",field:"EVENTO_PASE_CORRELATIVO",align:"left",sortable:!0},{name:"EVENTO_PASE_ESTADO",label:"Estado",field:"EVENTO_PASE_ESTADO",align:"center"}],rows:[]}}},Qe=o(98472),He=o(39505),Xe=o(22825),Ye=o(95849),We={emits:["update:modelValue","input"],components:{QForm:Re.A,QSelect:Le.S,QCheckbox:te.A,QDialog:Fe.A,QCard:Q.A,QCardSection:H.A,QCardActions:xe.A,QBtn:ye.A,QBadge:Ge.A,QLinearProgress:qe.A,QIcon:pe.A,QBar:$e.A},mixins:[Be],props:{modelValue:{type:Boolean,default:!1},eventoId:{type:[Number,String],required:!0,default:"0",validator:function(e){return!isNaN(Number(e))}},personaId:[Number,String]},data:function(){return{eventoTipoUso:[],eventoPaseEstado:[],personasOrigen:[],personasDestino:[],idEventoPersonaOrigen:null,idEventoPersonaDestino:null,cambiarEstadoPases:!1,eventoPaseEstadoId:null,eventoTipoUsoId:null,errores:[],progress:0,complete:!1,inProgress:!1,messageProgress:"Reasignando pases..."}},computed:{modal:{get:function(){return this.modelValue},set:function(e){this.$emit("update:modelValue",e),this.$emit("input",e)}},offEventoPaseEstado:function(){return!1===this.cambiarEstadoPases},progressLabel:function(){return"".concat((100*this.progress).toFixed(2)," %")},dataRow:function(){var e=this,a=this.rows;return this.eventoTipoUsoId&&(a=a.filter(function(a){var o=a.ID_TIPO_USO;return o===e.eventoTipoUsoId})),a},infoParticipanteOrigen:function(){var e=this,a={};return this.idEventoPersonaOrigen&&(a=this.personasOrigen.filter(function(a){var o=a.EVENTO_PERSONA_ID;return o===e.idEventoPersonaOrigen})[0]),a},infoParticipanteDestino:function(){var e=this,a={};return this.idEventoPersonaDestino&&(a=this.personasDestino.filter(function(a){var o=a.EVENTO_PERSONA_ID;return o===e.idEventoPersonaDestino})[0]),a}},methods:{getTipoUsoPase:function(e){var a=this;return B()($()().m(function o(){return $()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,Xe.A.getTipoUsoPase({evento_id:e});case 1:a.eventoTipoUso=o.v.map(function(e){var a=e.ID_TIPO_USO,o=e.DESCRIPCION;return{label:o,value:a}}),a.eventoTipoUsoId=a.eventoTipoUso[0]?a.eventoTipoUso[0].value:null;case 2:return o.a(2)}},o)}))()},getCombosParticipantes:function(e){var a=this;return B()($()().m(function o(){var r,n;return $()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,Qe.A.getParticipantes(e);case 1:r=o.v,a.personasOrigen=r,a.personasDestino=r,a.personaId&&(n=r.filter(function(e){var o=e.ID_PERSONA;return o===a.personaId}),a.idEventoPersonaOrigen=n[0].EVENTO_PERSONA_ID);case 2:return o.a(2)}},o)}))()},obtenerPases:function(e){var a=this;return B()($()().m(function e(){return $()().w(function(e){while(1)switch(e.n){case 0:return e.n=1,He.A.getPasesParticipante(a.idEventoPersonaOrigen);case 1:a.rows=e.v;case 2:return e.a(2)}},e)}))()},checkCambiarEstadoPases:function(){this.$refs.formIntercambiarPases.resetValidation(),!1===this.cambiarEstadoPases&&(this.eventoPaseEstadoId=null)},reasignarPases:function(){var e=this;return B()($()().m(function a(){var o,r,n,t,s,i,l,c,u;return $()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,e.$refs.formIntercambiarPases.validate();case 1:if(o=a.v,o){a.n=2;break}return a.a(2);case 2:if(0!==e.$refs.pasesParticipante.rowsSelected([],null,!0).length){a.n=3;break}return e.$alert("No ha seleccionado ningun para para asignar","warning"),a.a(2);case 3:return a.n=4,e.$confirmar("Se reasignará(n) <b>".concat(e.$refs.pasesParticipante.rowsSelected([],null,!0).length," pase(s)</b> de <b>").concat(e.infoParticipanteOrigen.NOMCOMP,"</b> al participante <b>").concat(e.infoParticipanteDestino.NOMCOMP,"</b>. ¿Desea continuar?"),"info",!0);case 4:if(r=a.v,!r){a.n=6;break}return n={pases:e.$refs.pasesParticipante.rowsSelected([],null,!0).map(function(e){var a=e.EVENTO_PASE_ID;return a}),evento_persona_id:e.idEventoPersonaDestino},!0===e.cambiarEstadoPases&&(n.evento_pase_estado=e.eventoPaseEstadoId),e.errores=[],e.progress=0,e.complete=!1,e.inProgress=!0,e.messageProgress="Reasignando pases...",a.n=5,(0,z.streamFetch)("api/EventosPasesController/reasignarPases",{method:"POST",data:{params:n}},function(a){if(a&&"error"in a){e.inProgress=!1;var o=a.error;e.$alert(o.message,"info"),e.complete=!0}if(a&&"progress"in a){var r=a.progress;e.progress=r.progress/r.total}});case 5:if(t=a.v,s=t.length,!s){a.n=6;break}if(i=t[s-2],l=t[s-1],i&&"progress"in i&&(c=i.progress,e.progress=c.progress/c.total),!l||!("final"in l)){a.n=6;break}return u=l.final,e.errores=u.errores,e.complete=!0,e.messageProgress="Se reasignaron los pases.",e.progress=1,a.n=6,e.obtenerPases();case 6:return a.a(2)}},a)}))()},cerrarModal:function(){this.modal=!1}},watch:{modelValue:function(e){var a=this;return B()($()().m(function o(){return $()().w(function(o){while(1)switch(o.n){case 0:if(!e){o.n=4;break}return o.n=1,Ye["default"].ESTADOS_PASES();case 1:return a.eventoPaseEstado=o.v,o.n=2,a.getTipoUsoPase(a.eventoId);case 2:return o.n=3,a.getCombosParticipantes({evento_id:a.eventoId});case 3:if(!a.personaId){o.n=4;break}return o.n=4,a.obtenerPases();case 4:return o.a(2)}},o)}))()}}},Ke=o(12807);const Je=(0,Ke.A)(We,[["render",Me]]);var ze=Je,Ze=o(83493),ea={components:{QBtn:K.Il,headerGrid:ae.A,sieGrid:Z.A,footerGrid:ee.A,QCard:Q.A,QCardSection:H.A,QSelect:Y.S,QSeparator:X.A,sieModal:oe.A,QInput:re.A,QDate:W.A,QPopupProxy:ne.A,QDatetime:K.T5,QCheckbox:te.A,crearBotones:le.A,QOptionGroup:ue.A,QPageHeader:de.A,consultar:fe["default"],QIcon:pe.A,formaPago:ge.A,consultarComprobante:ve.A,AgregarPersona:ce.A,CrearPases:Pe.A,IntercambiarPases:ze,ReasignarPases:Ze.A,QCardMain:K.d1},data:function(){return{pageHeader:{tabs:[{name:"index",label:"Registro"},{name:"consultar",label:"Consultar"}],tabsKeys:{index:"index",adicional:"adicional",consultar:"consultar"},title:"Pago por Evento",componente:"pagoEvento",nivelAcceso:(0,me["default"])().ruta.nivelAcceso||3,botones:[],tabActive:"index",dropdown:!1},data:{perfiles:[],personas:[],eventos:[],formasPago:[],notasCredito:[],talonarios:[],monedas:[],tipoUso:[]},form:{talonario:"",nroRecibo:"",fecVen:se["default"].CURRENT_DAY,evento:"",perfil:se["default"].PERFIL_ALUMNO,persona:"",tarjeta:"",voucher:"",medioPago:1,tipoComprobante:"",notaCredito:{numtal:"",numpag:"",saldo:0},deudas:{},fecpag:se["default"].CURRENT_DAY,tipoUso:""},grid:{rowData:[],columns:[],api:null,params:null,pagina:1,pages:1,total:0,monedaTotal:"S/. "},formaPago:{modal:!1,feccam:new Date,monedaActual:{},formasPago:[]},labels:{numero:"Nro. Operación"},keys:{labelsNumero:{CHEQUE:"Nro. Cheque",TARJETA:"Nro. Voucher",PASARELA:"Nro. Operación"},perfilAuxiliar:se["default"].PERFIL_CLIENTE_AUXILIAR},disable:{nroRecibo:!1},views:{mostrarVoucher:!1,notaCredito:!1,agregarPersona:!1,crearPases:!1,intercambiarPases:!1,reasignarPase:!1},usaSerie:0,code:null}},beforeMount:function(){this.generarColumns(),this.getPerfiles(),this.getEventos(),this.crearBotones(),this.obtenerFormasPago(),this.getNotasCreditos(),this.getTalonarios(),this.getMonedas()},methods:{seleccionarPersona:function(e){var a=this;return B()($()().m(function o(){return $()().w(function(o){while(1)switch(o.n){case 0:return a.form.perfil=se["default"].PERFIL_CLIENTE_AUXILIAR,o.n=1,a.getPersonasPerfil();case 1:a.form.persona=e,a.obtenerPases(),a.views.agregarPersona=!1;case 2:return o.a(2)}},o)}))()},nuevaPersona:function(){this.views.agregarPersona=!0},getMoneda:function(e){var a=this.data.monedas.find(function(a){return a.MONCOD===e.MONCOD});this.formaPago.monedaActual={MONCOD:a.MONCOD,MONNOM:a.MONNOM,MONSIG:a.MONSIG}},consultarSaldoNotaCredito:function(){var e=this;return B()($()().m(function a(){var o,r,n,t,s,i;return $()().w(function(a){while(1)switch(a.p=a.n){case 0:if(a.p=0,o=e.form.notaCredito,o.numtal){a.n=1;break}throw new Error("No selecciono la nota de credito");case 1:if(o.numpag){a.n=2;break}throw new Error("No ingreso el número de documento de la nota de credito");case 2:return o.numpag=o.numpag.toString().padStart(se["default"].MAX_LENGTH_NUMPAG,0),r={numpag:o.numpag,numtal:o.numtal},a.n=3,z.$http.get("api/pagoController/getNotaCreditoCanje",{params:{datos:r}});case 3:if(n=a.v,n&&0!==n.length){a.n=4;break}throw new Error("No se encontro datos de la nota de credito");case 4:t=G()(n,1),s=t[0],o.saldo=s.SALDO?Number(s.SALDO).toFixed(2):0,a.n=6;break;case 5:a.p=5,i=a.v,e.$alert(i.error?i.error.message:i.message,"warning");case 6:return a.a(2)}},a,null,[[0,5]])}))()},getTalonarios:function(){var e=this;return B()($()().m(function a(){var o,r,n;return $()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,z.$http.get("api/talonarioController/getTalonariosUsuario",{params:{parametros:{response:"combo"}}});case 1:if(o=a.v,o&&0!==o.length){a.n=2;break}return a.a(2,!1);case 2:e.data.talonarios=o,r=G()(o,1),n=r[0],e.form.talonario=n.NUMTAL,e.getNroRecibo();case 3:return a.a(2)}},a)}))()},getNotasCreditos:function(){var e=this;return B()($()().m(function a(){var o,r,n;return $()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,z.$http.get("api/talonarioController/getTalonariosUsuario",{params:{parametros:{response:"combo",opcionMenu:"nota"}}});case 1:o=a.v,r=Object.groupBy(o,function(e){return e.ID_COMPROBANTE}),n=r[Number(se["default"].NOTA_CREDITO)],e.data.notasCredito=n;case 2:return a.a(2)}},a)}))()},findMedioPago:function(){var e=this;return this.data.formasPago.find(function(a){return a.ID_MEDIOPAGO===e.form.medioPago})},changeMedioPago:function(){this.views.mostrarVoucher=!1,this.views.notaCredito=!1;var e=this.findMedioPago(),a=se["default"].MEDIOS_PAGO_GRUPO;if(e&&0!==Object.keys(e)){var o=e.TIPO_MEDIO;this.views.notaCredito=o===a.CANJE,o===a.TARJETA&&(this.labels.numero=this.keys.labelsNumero.TARJETA,this.views.mostrarVoucher=!0),[a.BANCO,a.APIPAGO].includes(o)&&(this.labels.numero=this.keys.labelsNumero.PASARELA,this.views.mostrarVoucher=!0),a.CHEQUE===o&&(this.labels.numero=this.keys.labelsNumero.CHEQUE,this.views.mostrarVoucher=!0)}},changeVoucher:function(){this.form.voucher=this.form.voucher.split("").filter(function(e){return String(e).trim().length>0}).join("")},actionTab:function(e){var a=this;return B()($()().m(function o(){var r;return $()().w(function(o){while(1)switch(o.n){case 0:if(a.pageHeader.tabActive=e,e!==a.pageHeader.tabsKeys.index){o.n=1;break}return a.crearBotones(),a.pageHeader.title="Pago por Evento",a.pageHeader.componente="pagoEvento",a.pageHeader.nivelAcceso=3,o.a(2,!0);case 1:if(!a.$refs[String(e).trim()]){o.n=3;break}return o.n=2,a.$refs[String(e).trim()].actionTab();case 2:r=o.v,a.pageHeader.botones=r.botones,a.pageHeader.title=r.title,a.pageHeader.nivelAcceso=r.nivelAcceso,a.pageHeader.componente=r.componente;case 3:return o.a(2)}},o)}))()},crearPases:function(){this.views.crearPases=!0},abrirVentanaReasignarPase:function(){this.views.reasignarPase=!0},crearBotones:function(){var e=[{label:"reasignar pase",icon:"assignment_ind",click:this.abrirVentanaReasignarPase,minAcceso:se["default"].LECTURA_ESCRITURA},{label:"crear pases",icon:"confirmation_number",click:this.crearPases,minAcceso:se["default"].LECTURA_ESCRITURA},{label:"agregar persona",icon:"user",click:this.nuevaPersona,minAcceso:se["default"].LECTURA_ESCRITURA},{label:"Forma Pago",icon:"list_money",click:this.guardarFormasPago,minAcceso:se["default"].LECTURA_ESCRITURA},{label:"Pagar",icon:"save",click:this.guardarPagos,minAcceso:se["default"].LECTURA_ESCRITURA}];this.pageHeader.botones=e},getTipoUsoPase:function(e){var a=this;return B()($()().m(function o(){var r,n,t;return $()().w(function(o){while(1)switch(o.n){case 0:return r={},e&&(r.evento_id=e),o.n=1,z.$http.get("api/concobroController/getTipoUsoPase",{params:{parametros:r}});case 1:if(n=o.v,a.data.tipoUso=n,0!==a.data.tipoUso.length){o.n=2;break}return o.a(2,a.$alert("No se ha configurado ningún tipo de uso para los pases","warning"));case 2:t=a.data.tipoUso.find(function(e){return e.ID_TIPO_USO===a.form.tipoUso})||a.data.tipoUso.find(function(e){return e}),a.form.tipoUso=t.ID_TIPO_USO,a.usaSerie=t.USA_SERIE;case 3:return o.a(2)}},o)}))()},getNroRecibo:function(e){var a=this;return B()($()().m(function e(){var o,r,n;return $()().w(function(e){while(1)switch(e.n){case 0:return e.n=1,z.$http.get("api/talonarioController/getCorrelativo",{params:{parametros:{numtal:a.form.talonario}}});case 1:if(o=e.v,o&&0!==o.length){e.n=2;break}return e.a(2,!1);case 2:r=G()(o,1),n=r[0],a.form.nroRecibo=n.NUMPAG,a.form.tipoComprobante=n.ID_COMPROBANTE;case 3:return e.a(2)}},e)}))()},validateData:function(){try{var e=this.form;if(!e.talonario)throw new Error("No selecciono el talonario");if(!e.nroRecibo||7!==String(e.nroRecibo).length)throw new Error("El numero de recibo es incorrecto");if(!e.persona)throw new Error("No selecciono la persona");if(!e.medioPago)throw new Error("No selecciono el medio de pago");var a=this.findMedioPago();if(!a||0===Object.keys(a).length)throw new Error("No se encontro información del medio de pago")}catch(e){throw new Error(e.message)}},tarjetasSeleccionadas:function(){return this.grid.api.getSelectedRows()},obtPagoConcepto:function(){try{var e=this.form.deuda;if(!e||0===e.length)throw new Error("No se encontro informacion de la deuda","warning");var a=0,o=this.tarjetasSeleccionadas(),r=e.map(function(e){var r,n=o.filter(function(a){return a.ID_DEUDA===e.ID_DEUDA}),t={ANOCOB:e.ANOCOB,CONCOB:e.CONCOB,MESCOB:e.MESCOB,ID_DEUDA:e.ID_DEUDA,ID_PERFIL:e.ID_PERFIL,MONCOD:e.MONCOD,MONTOCOB:0,MONTODES:0,MONTOMOR:0,NRODOC:"",FECVEN:e.FECVEN,BOLEMI:e.BOLEMI,AFEIGV:e.AFEIGV?e.AFEIGV:"N"},s=x()(n);try{for(s.s();!(r=s.n()).done;){var i=r.value;t.MONTOCOB+=Number(i.EVENTO_PASE_IMPORTE)}}catch(e){s.e(e)}finally{s.f()}return t.MONTOPAG=t.MONTOCOB,a+=t.MONTOPAG,t});return{registros:r,totalPagar:a}}catch(e){throw new Error(e.message)}},obtOrigenPago:function(e){return e?se["default"].ORIGEN_BANCO:se["default"].ORIGEN_CAJA},obtenerOrigenPago:function(e){return e?se["default"].ORIPAG_BANCO:se["default"].ORIPAG_CAJA},verificarOrigenPago:function(e){var a=Number(se["default"].TIPO_MEDIO_PAGO_TARJETA),o=null;return Number(e.TIPO_MEDIO)===a&&e.NUMCTA&&(o=e.NUMCTA),o},obtenerCabeceraPago:function(e){var a=this.verificarOrigenPago(e),o=this.form.notaCredito,r=this.form,n={NUMTAL:r.talonario,NUMPAG:r.nroRecibo,ORIPAG:this.obtenerOrigenPago(a),FORPAG:e.FORPAG,ID_PERFIL:r.perfil,ID_PERSONA:r.persona,FECEMI:(0,J.convertToYMD)(se["default"].CURRENT_DAY),FECVEN:(0,J.convertToYMD)(r.fecVen),FECPAG:(0,J.convertToYMD)(r.fecpag),OBSERVACION:"",EDIT_NUMPAG:this.disable.nroRecibo,EVENTO:!0};return n.NUMCTA=a||null,n.NUMCHE=this.form.voucher,o.numtal&&o.numpag&&(n.NUMTALO=o.numtal,n.NUMPAGO=String(o.numpag).padStart(se["default"].MAX_LENGTH_NUMPAG,0)),n},obtTarjetas:function(){return this.tarjetasSeleccionadas().map(function(e){return{EVENTO_PASE_ID:e.EVENTO_PASE_ID,EVENTO_PASE_CORRELATIVO:e.EVENTO_PASE_CORRELATIVO}})},obtenerInfoPago:function(){var e=this;return B()($()().m(function a(){var o,r,n,t,s,i,l;return $()().w(function(a){while(1)switch(a.p=a.n){case 0:return a.p=0,o=e.obtPagoConcepto(),r=o.registros,n=e.findMedioPago(),t=e.verificarOrigenPago(n),s=e.obtenerCabeceraPago(n),i={pago:s,pagoDet:r,formaPago:{datos:{FECPAG:s.FECPAG,ORIPAG:e.obtOrigenPago(t)},detalle:e.obtenerDetalleFormaPago(r,t,n)},tarjetas:e.obtTarjetas()},a.a(2,i);case 1:throw a.p=1,l=a.v,new Error(l.message);case 2:return a.a(2)}},a,null,[[0,1]])}))()},obtenerDetalleFormaPago:function(e,a,o){var r,n=[],t=se["default"].MEDIOS_PAGO_GRUPO,s=x()(e);try{for(s.s();!(r=s.n()).done;){var i=r.value;if(this.formaPago.formasPago&&0!==this.formaPago.formasPago.length){var l,c=x()(this.formaPago.formasPago);try{for(c.s();!(l=c.n()).done;){var u=l.value;n.push({ID_MEDIOPAGO:u.FORMAPAGO,MONTOING:Number(u.INGRESO),MONTOSAL:Number(u.SALIDA),MONCOD:u.MONEDA,NUMVOU:u.OPERACION,CONCOB:i.CONCOB,MESCOB:i.MESCOB,ANOCOB:i.ANOCOB})}}catch(e){c.e(e)}finally{c.f()}}else{var d={ID_MEDIOPAGO:this.form.medioPago,MONTOING:Number(i.MONTOPAG),MONTOSAL:0,CONCOB:i.CONCOB,MONCOD:i.MONCOD,MESCOB:i.MESCOB,ANOCOB:i.ANOCOB};a&&(d.NUMCTA=a,a&&(d.NUMOPE=this.voucher),[t.BANCO,t.APIPAGO].includes(t.TIPO_MEDIO)&&(d.NUMOPE=this.voucher),[t.CHEQUE].includes(o.TIPO_MEDIO)&&(d.NUMCHE=this.voucher)),[t.TARJETA].includes(o.TIPO_MEDIO)&&(d.NUMVOU=this.voucher),n.push(d)}}}catch(e){s.e(e)}finally{s.f()}return n},verificarMedioCanje:function(e){var a,o=this,r=null,n=this.form.notaCredito,t=se["default"].MEDIOS_PAGO_GRUPO.CANJE,s=x()(e);try{var i=function(){var e=a.value,n=o.data.formasPago.find(function(a){return a.ID_MEDIOPAGO===e.FORMAPAGO&&a.TIPO_MEDIO===t});n&&Object.keys(n).length>0&&(r=Object.assign(e,n))};for(s.s();!(a=s.n()).done;)i()}catch(e){s.e(e)}finally{s.f()}if(!r)return!1;var l=r.OPERACION.slice(0,10).split("-");n.NUMTAL=l.at(0).slice(0,2),n.NUMPAG=l.at(1).slice(0,se["default"].MAX_LENGTH_NUMPAG).padStart(se["default"].MAX_LENGTH_NUMPAG,"0")},guardarFormasDePago:function(e){this.formaPago.formasPago=e.map(function(e){return e.data}),this.verificarMedioCanje(this.formaPago.formasPago),this.formaPago.modal=!1,this.guardarPagos()},guardarFormasPago:function(){if(0===this.tarjetasSeleccionadas().length)return this.$alert("No selecciono ningún registro","warning");this.formaPago.formasPago=[],this.formaPago.modal=!0},guardarPagos:function(){var e=this;return B()($()().m(function a(){var o;return $()().w(function(a){while(1)switch(a.p=a.n){case 0:a.p=0,e.validateData(),e.$confirm("¿Esta seguro de realizar el pago?").onOk(B()($()().m(function a(){var o,r,n;return $()().w(function(a){while(1)switch(a.p=a.n){case 0:return a.p=0,e.$q.loading.show(),a.n=1,e.obtenerInfoPago();case 1:return o=a.v,a.n=2,z.$http.post("api/PagoController/postPagoDeuda",{datos:o});case 2:return r=a.v,a.n=3,e.obtenerPases(!0);case 3:return a.n=4,e.getNroRecibo();case 4:return e.$refs[e.pageHeader.tabsKeys.consultar].pagosEmitidos(),e.$q.loading.hide(),e.formaPago.formasPago=[],a.a(2,e.$alert(r.message,"success").onOk(function(){e.$confirm("¿Desea Imprimir el Comprobante?","info",!1,!0).onOk(function(){var e=(0,me["default"])().origin,a=r.data&&r.data[0].NUMTAL?r.data[0].NUMTAL:o.pago.NUMTAL,n=r.data&&r.data[0].NUMPAG?r.data[0].NUMPAG:o.pago.NUMPAG;se["default"].IMPRIMIR_COMPROBANTE(e,a,n)})}));case 5:return a.p=5,n=a.v,e.$q.loading.hide(),a.a(2,e.$alert(n.error?n.error.message:n.message,"warning"))}},a,null,[[0,5]])}))),a.n=2;break;case 1:return a.p=1,o=a.v,a.a(2,e.$alert(o.error?o.error.message:o.message,"warning"));case 2:return a.a(2)}},a,null,[[0,1]])}))()},obtenerFormasPago:function(){var e=this;return B()($()().m(function a(){var o,r;return $()().w(function(a){while(1)switch(a.n){case 0:return o=se["default"].ORIPAG_CAJA,a.n=1,z.$http.get("api/formaPagoController/getMediosDePago",{params:{parametros:{response:"list",tipo_medio:o}}});case 1:r=a.v,e.data.formasPago=r,e.form.medioPago=1,e.changeMedioPago();case 2:return a.a(2)}},a)}))()},getTotal:function(){var e=this;return B()($()().m(function a(){var o,r,n;return $()().w(function(a){while(1)switch(a.n){case 0:o=e.grid.api.getSelectedRows(),r=o.reduce(function(e,a){return e.total+=Number(a.EVENTO_PASE_IMPORTE),e},{total:0}),n=r.total,e.grid.total=Number(n).toFixed(2);case 1:return a.a(2)}},a)}))()},obtenerPasePorCorrelativo:function(e,a){var o=this;return B()($()().m(function r(){return $()().w(function(r){while(1)switch(r.n){case 0:o.obtenerPases(!0,!1,e,a);case 1:return r.a(2)}},r)}))()},onTarjeta:function(){var e=this;return B()($()().m(function a(){var o,r;return $()().w(function(a){while(1)switch(a.n){case 0:if(!e.form.tarjeta){a.n=1;break}if(e.form.tarjeta=String(e.form.tarjeta).length<8?String(e.form.tarjeta).padStart(8,"0"):String(e.form.tarjeta).slice(0,8),o=null,o=e.usaSerie?"^[A-Z]-\\d{8}$":"^\\d{8}$",r=new RegExp(o),!r.test(e.form.tarjeta)){a.n=1;break}return a.n=1,e.obtenerPases(!0);case 1:return a.a(2)}},a)}))()},obtenerPasesPorPersona:function(){var e=this;return B()($()().m(function a(){return $()().w(function(a){while(1)switch(a.n){case 0:e.obtenerPases(!1,!0);case 1:return a.a(2)}},a)}))()},obtenerPases:function(){var e=arguments,a=this;return B()($()().m(function o(){var r,n,t,s,i,l,c,u,d;return $()().w(function(o){while(1)switch(o.n){case 0:if(r=e.length>0&&void 0!==e[0]&&e[0],e.length>1&&void 0!==e[1]&&e[1],e.length>2&&void 0!==e[2]?e[2]:"",e.length>3&&void 0!==e[3]?e[3]:"",a.grid.total=0,a.form.evento){o.n=1;break}return a.grid.rowData=[],a.form.persona="",a.form.tarjeta="",o.a(2,a.$alert("No selecciono el evento","warning"));case 1:return o.n=2,a.getTipoUsoPase(a.form.evento);case 2:if(a.form.tipoUso){o.n=3;break}return a.grid.rowData=[],a.form.persona="",a.form.tarjeta="",o.a(2,a.$alert("No selecciono el tipo de uso del pase"));case 3:if(a.$q.loading.show(),!r||!a.form.tarjeta){o.n=7;break}return n={correlativo:a.form.tarjeta,evento_id:a.form.evento,deuda_activa:1,tipoUso:a.form.tipoUso,campos:["ID_PERSONA","ID_PERFIL","EVENTO_PASE_CORRELATIVO"]},a.usaSerie?(t=a.form.tarjeta.split("-"),n.serie=t[0],n.correlativo=t[1]):n.evento_pase_serie_id=Ye["default"].EVENTO_NO_USA_SERIE_ID,o.n=4,z.$http.get("api/EventosPasesController/getPasesEvento",{params:{params:n}});case 4:if(s=o.v,s&&0!==s.length){o.n=5;break}return a.$q.loading.hide(),a.grid.rowData=[],a.form.persona="",i=a.data.tipoUso.find(function(e){return e.ID_TIPO_USO===a.form.tipoUso}),a.$alert("No se ha generado el pase con el correlativo <b>".concat(a.form.tarjeta,"</b> con el concepto de <b>").concat(String(i&&i.CONDES?i.CONDES:"").toUpperCase(),"</b>"),"warning",!0),a.form.tarjeta="",o.a(2,!0);case 5:return l=G()(s,1),c=l[0],a.form.perfil=c.ID_PERFIL,o.n=6,a.getPersonasPerfil();case 6:a.form.persona=c.ID_PERSONA;case 7:if(!a.form.persona){o.n=10;break}return u={campos:"*",id_persona:a.form.persona,id_perfil:a.form.perfil,deuda:!0,tipoUso:a.form.tipoUso,evento_pase_estado:1,deuda_activa:1},o.n=8,z.$http.get("api/EventosPasesController/getPasesEvento",{params:{evento_id:a.form.evento,params:u}});case 8:if(d=o.v,a.grid.rowData=d,0!==d.length){o.n=9;break}return o.a(2,a.$q.loading.hide());case 9:return o.n=10,a.getDeudaTarjetas(d);case 10:a.$q.loading.hide();case 11:return o.a(2)}},o)}))()},seleccinarPases:function(){var e=this;return B()($()().m(function a(){return $()().w(function(a){while(1)switch(a.n){case 0:setTimeout(function(){e.grid.api.forEachNode(function(e){return e.setSelected(!0)})},1);case 1:return a.a(2)}},a)}))()},getDeudaTarjetas:function(e){var a=this;return B()($()().m(function o(){var r,n,t,s,i,l,c,u;return $()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,a.seleccinarPases();case 1:if(e&&0!==e.length){o.n=2;break}return o.a(2,!1);case 2:return r=a.data.tipoUso.find(function(e){return e.ID_TIPO_USO===a.form.tipoUso}),n=[],t=e.reduce(function(e,o){if(250===e.length){var t={anocob:(0,me["default"])().ano,idDeudas:e,id_persona:a.form.persona,concob:r.CONCOB};n.push(z.$http.post("api/cobroController/postDatosCobro",{parametros:t})),e=[]}return e.push(o.ID_DEUDA),e},[]),s={anocob:(0,me["default"])().ano,idDeudas:t,id_persona:a.form.persona,concob:r.CONCOB},n.push(z.$http.post("api/cobroController/postDatosCobro",{parametros:s})),i=[],o.n=3,Promise.allSettled(n);case 3:l=o.v.filter(function(e){return!i.includes(e.ID_DEUDA)&&(i.push(e.ID_DEUDA),!0)}).map(function(e){return e.value}).flat(),l&&0!==l.length?(c=G()(l,1),u=c[0],a.form.deuda=l,a.getMoneda(u)):a.form.deuda=[];case 4:return o.a(2)}},o)}))()},getEventos:function(){var e=this;return B()($()().m(function a(){var o,r,n;return $()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,z.$http.get("api/EventosController/getEventos",{params:{parametros:{en_rango_de_dia:!0}}});case 1:if(o=a.v,e.data.eventos=o,0!==o.length){a.n=2;break}return a.a(2,!1);case 2:return r=G()(o,1),n=r[0],e.form.evento=n.EVENTO_ID,a.n=3,e.getTipoUsoPase(n.EVENTO_ID);case 3:return a.a(2)}},a)}))()},getPerfiles:function(){var e=this;return B()($()().m(function a(){return $()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,se["default"].API_PERFILES();case 1:e.data.perfiles=a.v,e.getPersonasPerfil();case 2:return a.a(2)}},a)}))()},getPersonasPerfil:function(){var e=this;return B()($()().m(function a(){return $()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,se["default"].API_PERSONAS(e.form.perfil);case 1:e.data.personas=a.v;case 2:return a.a(2)}},a)}))()},getMonedas:function(){var e=this;return B()($()().m(function a(){return $()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,z.$http.get("api/cobroController/getMoneda");case 1:e.data.monedas=a.v;case 2:return a.a(2)}},a)}))()},generarColumns:function(){var e=[{headerName:"Número",field:"EVENTO_PASE_CORRELATIVO"},{headerName:"Monto",field:"EVENTO_PASE_IMPORTE",valueFormatter:function(e){return"".concat((0,ie.toFixed)(e.value,2))}}];this.grid.columns=e},onGridReady:function(e){this.grid.params=e,this.grid.api=e.api},closeCalendar:function(e){this.$refs[e].hide()},formatoPases:function(){var e=null;this.form.tarjeta=this.form.tarjeta.toUpperCase(),e=this.usaSerie?"^[A-Z](-\\d{0,8})?$":"^\\d{0,8}$";var a=new RegExp(e);a.test(this.form.tarjeta)||(this.form.tarjeta=this.form.tarjeta.slice(0,-1))},codeWithGun:function(e){var a=this;return B()($()().m(function o(){return $()().w(function(o){while(1)switch(o.n){case 0:if(13!==e.which){o.n=3;break}return o.n=1,a.readCode(a.code);case 1:return o.n=2,a.onTarjeta();case 2:a.code=null;case 3:return o.a(2)}},o)}))()},readCode:function(e){var a=this;return B()($()().m(function o(){var r,n;return $()().w(function(o){while(1)switch(o.n){case 0:if(!e){o.n=2;break}return o.n=1,z.$http.get("api/EventosPasesController/getPaseCorrelativo",{params:{code:e}});case 1:r=o.v,n=r.correlativo,a.form.tarjeta=n;case 2:return o.a(2)}},o)}))()}}};const aa=(0,Ke.A)(ea,[["render",L]]);var oa=aa}}]);