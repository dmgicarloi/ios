"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[29375],{29375:function(e,n,t){t.r(n),t.d(n,{default:function(){return M}});t(56285);var a=t(61758),r={class:"row items-center no-wrap"},u={class:"col-auto"},i={class:"row q-ma-sm q-pt-sm"},o={key:0,class:"col-xs-12"};function c(e,n){var t=(0,a.g2)("crearBotones"),c=(0,a.g2)("q-separator"),s=(0,a.g2)("q-tab"),l=(0,a.g2)("config-monto"),f=(0,a.g2)("q-tab-pane"),C=(0,a.g2)("q-tabs"),E=(0,a.g2)("q-card-section"),p=(0,a.g2)("q-card"),I=(0,a.g2)("q-page");return(0,a.uX)(),(0,a.Wv)(I,{class:"sie-flat pasebrae bg-white q-pa-sm talleres--mantenimiento-paquetes-semanas"},{default:(0,a.k6)(function(){return[(0,a.bF)(p,{class:"q-ma-sm"},{default:(0,a.k6)(function(){return[(0,a.Lk)("div",r,[n[2]||(n[2]=(0,a.Lk)("div",{class:"col row"},[(0,a.Lk)("div",{class:"text-h6",style:{"font-size":"1.1rem","font-weight":"bold","padding-left":"16px"}},"Mantenimiento de Paquetes de Semanas")],-1)),(0,a.Lk)("div",u,[(0,a.bF)(t,{option:e.name,buttons:e.buttons,nivelAcceso:e.nivelAcceso},null,8,["option","buttons","nivelAcceso"])])]),(0,a.bF)(c),(0,a.Lk)("div",i,[e.niveles.length?((0,a.uX)(),(0,a.CE)("div",o,[(0,a.bF)(E,null,{default:(0,a.k6)(function(){return[(0,a.bF)(C,{modelValue:e.tab,"onUpdate:modelValue":n[0]||(n[0]=function(n){return e.tab=n}),inverted:"",animated:"",onSelect:n[1]||(n[1]=function(n){return e.cambiarTab(e.tab)})},{title:(0,a.k6)(function(){return[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.niveles,function(e){return(0,a.uX)(),(0,a.Wv)(s,{name:e.ID,label:e.DESCRIPCION},null,8,["name","label"])}),256))]}),default:(0,a.k6)(function(){return[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.niveles,function(n){return(0,a.uX)(),(0,a.CE)(a.FK,null,[e.tab===n.ID?((0,a.uX)(),(0,a.Wv)(f,{key:0,name:n.ID},{default:(0,a.k6)(function(){return[e.tab===n.ID?((0,a.uX)(),(0,a.Wv)(l,{key:0,nivel:e.tab,ref_for:!0,ref:e.tab},null,8,["nivel"])):(0,a.Q3)("v-if",!0)]}),_:2},1032,["name"])):(0,a.Q3)("v-if",!0)],64)}),256))]}),_:1},8,["modelValue"])]}),_:1})])):(0,a.Q3)("v-if",!0)])]}),_:1})]}),_:1})}var s=t(76080),l=t.n(s),f=t(45254),C=t.n(f),E=(t(39866),t(6123)),p=t(11654),I=t(9736),m=t(16648),P=t(88567),d=t(95718),A=t(57668),g=t(30640),h=t(88865),N=t(64303),v=t(53380),b=t(50425),_=t(34262),w=t(29104),S={class:"center gap-10 col-frecuencia"};function D(e,n){var t=(0,a.g2)("q-input"),r=(0,a.g2)("q-icon"),u=(0,a.g2)("q-card-section"),i=(0,a.g2)("q-select"),o=(0,a.g2)("q-card");return(0,a.uX)(),(0,a.Wv)(o,{class:"talleres--mantenimiento-paquetes-semanas--components--config-monto"},{default:(0,a.k6)(function(){return[(0,a.bF)(u,null,{default:(0,a.k6)(function(){return[(0,a.bF)(o,{class:"scroll",flat:"",bordered:""},{default:(0,a.k6)(function(){return[(0,a.bF)(u,null,{default:(0,a.k6)(function(){return[(0,a.Lk)("tr",null,[n[0]||(n[0]=(0,a.Lk)("th",{class:"text-left col-frecuencia color-primary"},"Monto (S/)",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.listaPaquetes,function(n){return(0,a.uX)(),(0,a.CE)("th",null,[(0,a.bF)(u,{class:"center gap-10 col-paquete"},{default:(0,a.k6)(function(){return[(0,a.bF)(t,{modelValue:n.DESCRIPCION,"onUpdate:modelValue":function(e){return n.DESCRIPCION=e},label:"Paquete",onBlur:function(t){return e.actualizarPaquete(n)},onKeyup:(0,w.jR)(function(t){return e.actualizarPaquete(n)},["enter"])},null,8,["modelValue","onUpdate:modelValue","onBlur","onKeyup"]),(0,a.bF)(t,{modelValue:n.NRO_SEMANAS,"onUpdate:modelValue":function(e){return n.NRO_SEMANAS=e},label:"Nro. Semanas",type:"Number",onBlur:function(t){return e.actualizarPaquete(n)},onKeyup:(0,w.jR)(function(t){return e.actualizarPaquete(n)},["enter"])},null,8,["modelValue","onUpdate:modelValue","onBlur","onKeyup"]),(0,a.bF)(r,{class:"cursor-pointer",name:"delete",size:"sm",onClick:function(t){return e.eliminarPaquete(n)}},null,8,["onClick"])]}),_:2},1024)])}),256))]),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.montos,function(n){return(0,a.uX)(),(0,a.CE)("tr",null,[(0,a.Lk)("td",S,[(0,a.bF)(i,{class:"full-width",modelValue:e.frecSeleccionadas[n.ID_FRECUENCIA],"onUpdate:modelValue":function(t){return e.frecSeleccionadas[n.ID_FRECUENCIA]=t},label:"Frecuencia",options:e.listaFrecuencias,rules:e.OBLIGATORIO,"option-value":"ID_FRECUENCIA","option-label":"DESCRIPCION",onInput:function(t){return e.actualizarFrecuencia(n)}},null,8,["modelValue","onUpdate:modelValue","options","rules","onInput"]),(0,a.bF)(r,{class:"cursor-pointer",name:"delete",size:"sm",onClick:function(t){return e.eliminarFrecuencia(n)}},null,8,["onClick"])]),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.listaPaquetes,function(r){return(0,a.uX)(),(0,a.CE)("td",null,[(0,a.bF)(u,null,{default:(0,a.k6)(function(){return[(0,a.bF)(t,{modelValue:n.MONTOS[r.ID_PAQUETE],"onUpdate:modelValue":function(e){return n.MONTOS[r.ID_PAQUETE]=e},label:"Monto",type:"Number",maxlength:"50",onBlur:function(t){return e.actualizarMonto(n,r)},onKeyup:(0,w.jR)(function(t){return e.actualizarMonto(n,r)},["enter"])},null,8,["modelValue","onUpdate:modelValue","onBlur","onKeyup"])]}),_:2},1024)])}),256))])}),256))]}),_:1})]}),_:1})]}),_:1})]}),_:1})}var q=t(41562),F=t.n(q),R=(t(12563),t(74260),t(52133),t(10239),t(25751),t(50310),t(32203),t(90095),t(6724),t(70199),t(515),t(83190),t(62692),t(7346),t(13715),{props:{nivel:{type:String,default:""}},components:{QItemSection:h.A,QBtn:p.A,QSelect:m.A,QInput:I.A,QCard:P.A,QCardSection:d.A,sieModal:g.A,crearBotones:N.A,QSeparator:v.A,QTable:b.A,QIcon:_.A},data:function(){return{name:"Mantenimiento de Paquetes de Semanas",nivelAcceso:2,sie:(0,A["default"])(),OBLIGATORIO:[function(e){return!!e||"El campo es obligatorio"}],listaFrecuencias:[],listaPaquetes:[],listaPrecioPaquetes:[],montos:[],listaMontosTemporal:[],listaPaquetesTemporal:[],frecSeleccionadas:[],listaFrec:[],modalCopiarPrecioPaquete:!1,idPrecioPaqueteTipo:null,idPrecioPaqueteDestino:null,copyListaPrecioPaquetes:[],optPrecioPaqueteTipo:[],optPrecioPaqueteTipoDet:[]}},methods:{getFrecuencias:function(){var e=this;return C()(l()().m(function n(){var t,a;return l()().w(function(n){while(1)switch(n.p=n.n){case 0:return n.p=0,n.n=1,e.$http.get("api/CtCursoPeriodoController/getFrecuenciaClases");case 1:t=n.v,e.listaFrecuencias=t,e.listaFrecuencias.sort(function(e,n){return e.VECES-n.VECES}),n.n=3;break;case 2:n.p=2,a=n.v,e.$alert(a.message,"warning");case 3:return n.a(2)}},n,null,[[0,2]])}))()},getPaquetes:function(){var e=this;return C()(l()().m(function n(){var t,a,r;return l()().w(function(n){while(1)switch(n.p=n.n){case 0:return n.p=0,t={where:{nivel:e.nivel}},n.n=1,e.$http.get("api/CtCursoPeriodoController/getCtPaquete",{params:{params:t}});case 1:a=n.v,e.listaPaquetes=a,e.listaPaquetes.sort(function(e,n){return e.ID_PAQUETE-n.ID_PAQUETE}),e.listaPaquetesTemporal=JSON.parse(JSON.stringify(e.listaPaquetes)),n.n=3;break;case 2:n.p=2,r=n.v,e.$alert(r.message,"warning");case 3:return n.a(2)}},n,null,[[0,2]])}))()},getPrecioPaquetes:function(){var e=this;return C()(l()().m(function n(){var t,a,r;return l()().w(function(n){while(1)switch(n.p=n.n){case 0:return n.p=0,t={where:{"t2.nivel":e.nivel}},n.n=1,e.$http.get("api/CtCursoPeriodoController/getCtPrecioPaquete",{params:{params:t}});case 1:a=n.v,e.listaPrecioPaquetes=a,e.listaMontosTemporal=JSON.parse(JSON.stringify(e.listaPrecioPaquetes)),n.n=3;break;case 2:n.p=2,r=n.v,e.$alert(r.message,"warning");case 3:return n.a(2)}},n,null,[[0,2]])}))()},cargarMontos:function(){var e=this;return C()(l()().m(function n(){var t,a;return l()().w(function(n){while(1)switch(n.n){case 0:t=[],a=[],e.listaFrecuencias.map(function(n){var t=e.listaPrecioPaquetes.find(function(e){return e.ID_FRECUENCIA===n.ID_FRECUENCIA});t&&a.push(n)}),a.map(function(n){var a={ID_FRECUENCIA:n.ID_FRECUENCIA,DESCRIPCION:n.DESCRIPCION,VECES:n.VECES,MONTOS:{}};e.listaPaquetes.map(function(t){var r=e.listaPrecioPaquetes.find(function(e){return e.ID_FRECUENCIA===n.ID_FRECUENCIA&&e.ID_PAQUETE===t.ID_PAQUETE});a.MONTOS[t.ID_PAQUETE]=r.MONTO}),t.push(a)}),t.map(function(n){e.frecSeleccionadas[n.ID_FRECUENCIA]=n.ID_FRECUENCIA}),e.listaFrec=a,e.montos=t;case 1:return n.a(2)}},n)}))()},agregarPaquete:function(){var e=this;return C()(l()().m(function n(){var t,a,r,u,i,o,c,s,f;return l()().w(function(n){while(1)switch(n.p=n.n){case 0:return t={DESCRIPCION:"",NRO_SEMANAS:0,NRO_CURSOS:2,NIVEL:e.nivel},n.p=1,n.n=2,e.$http.post("api/CtCursoPeriodoController/postCtPaquete",{params:t});case 2:if(a=n.v,e.listaPaquetes.length){n.n=4;break}return r={ID_FRECUENCIA:e.listaFrecuencias[0].ID_FRECUENCIA,ID_PAQUETE:a.ID_PAQUETE,MONTO:0,NRO_CLASES:0},n.n=3,e.$http.post("api/CtCursoPeriodoController/postCtPrecioPaquete",{params:r});case 3:n.n=11;break;case 4:u=F()(e.listaFrec),n.p=5,u.s();case 6:if((i=u.n()).done){n.n=8;break}return o=i.value,c={ID_FRECUENCIA:o.ID_FRECUENCIA,ID_PAQUETE:a.ID_PAQUETE,MONTO:0,NRO_CLASES:0},n.n=7,e.$http.post("api/CtCursoPeriodoController/postCtPrecioPaquete",{params:c});case 7:n.n=6;break;case 8:n.n=10;break;case 9:n.p=9,s=n.v,u.e(s);case 10:return n.p=10,u.f(),n.f(10);case 11:return n.n=12,e.getPaquetes();case 12:return n.n=13,e.getPrecioPaquetes();case 13:return n.n=14,e.cargarMontos();case 14:n.n=16;break;case 15:n.p=15,f=n.v,e.$alert(f.message,"warning");case 16:return n.a(2)}},n,null,[[5,9,10,11],[1,15]])}))()},actualizarPaquete:function(e){var n=this;return C()(l()().m(function t(){var a,r;return l()().w(function(t){while(1)switch(t.p=t.n){case 0:if(t.p=0,a=n.listaPaquetesTemporal.find(function(n){return n.ID_PAQUETE===e.ID_PAQUETE&&n.DESCRIPCION===e.DESCRIPCION&&n.NRO_SEMANAS===e.NRO_SEMANAS&&n.NRO_CURSOS===e.NRO_CURSOS&&n.NIVEL===e.NIVEL}),!a){t.n=1;break}return t.a(2);case 1:return t.n=2,n.$http.put("api/CtCursoPeriodoController/putCtPaquete",{params:{data:e,where:{ID_PAQUETE:e.ID_PAQUETE}}});case 2:return t.n=3,n.getPaquetes();case 3:t.n=5;break;case 4:t.p=4,r=t.v,n.$alert(r.message,"warning");case 5:return t.a(2)}},t,null,[[0,4]])}))()},eliminarPaquete:function(e){var n=this;this.$confirm("¿Está seguro de eliminar este paquete y todos sus montos de esta columna?").onOk(C()(l()().m(function t(){var a;return l()().w(function(t){while(1)switch(t.p=t.n){case 0:return t.p=0,t.n=1,n.$http.delete("api/CtCursoPeriodoController/deleteCtPaquete",{params:{params:e}});case 1:return t.n=2,n.getPaquetes();case 2:t.n=4;break;case 3:t.p=3,a=t.v,n.$alert(a.message,"warning");case 4:return t.a(2)}},t,null,[[0,3]])})))},eliminarFrecuencia:function(e){var n=this;this.$confirm("¿Está seguro de eliminar esta fila de montos?").onOk(C()(l()().m(function t(){var a;return l()().w(function(t){while(1)switch(t.p=t.n){case 0:return t.p=0,t.n=1,n.$http.delete("api/CtCursoPeriodoController/deleteCtPrecioPaquete",{params:{params:{ID_FRECUENCIA:e.ID_FRECUENCIA}}});case 1:return t.n=2,n.getPaquetes();case 2:return t.n=3,n.getPrecioPaquetes();case 3:return t.n=4,n.cargarMontos();case 4:delete n.frecSeleccionadas[e.ID_FRECUENCIA],t.n=6;break;case 5:t.p=5,a=t.v,n.$alert(a.message,"warning");case 6:return t.a(2)}},t,null,[[0,5]])})))},actualizarFrecuencia:function(e){var n=this;return C()(l()().m(function t(){var a,r,u,i;return l()().w(function(t){while(1)switch(t.p=t.n){case 0:if(t.p=0,!n.montos.map(function(e){return e.ID_FRECUENCIA}).includes(n.frecSeleccionadas[e.ID_FRECUENCIA])){t.n=1;break}throw n.frecSeleccionadas[e.ID_FRECUENCIA]=e.ID_FRECUENCIA,new Error("Por favor selecciona otra frecuencia que no esté seleccionada");case 1:return a={ID_FRECUENCIA:n.frecSeleccionadas[e.ID_FRECUENCIA]},r={ID_FRECUENCIA:e.ID_FRECUENCIA},t.n=2,n.$http.put("api/CtCursoPeriodoController/putCtPrecioPaquete",{params:{data:a,where:r}});case 2:return u=n.montos.find(function(n){return n.ID_FRECUENCIA===e.ID_FRECUENCIA}),u.ID_FRECUENCIA=n.frecSeleccionadas[e.ID_FRECUENCIA],n.montos.forEach(function(e){n.frecSeleccionadas[e.ID_FRECUENCIA]=e.ID_FRECUENCIA}),t.n=3,n.getPaquetes();case 3:return t.n=4,n.getPrecioPaquetes();case 4:return t.n=5,n.cargarMontos();case 5:t.n=7;break;case 6:t.p=6,i=t.v,n.$alert(i.message,"warning");case 7:return t.a(2)}},t,null,[[0,6]])}))()},actualizarMonto:function(e,n){var t=this;return C()(l()().m(function a(){var r,u,i,o;return l()().w(function(a){while(1)switch(a.p=a.n){case 0:if(a.p=0,e.MONTOS[n.ID_PAQUETE]){a.n=1;break}return t.$notify("Por favor ingresa un monto","warning"),a.a(2);case 1:if(r={ID_FRECUENCIA:e.ID_FRECUENCIA,ID_PAQUETE:n.ID_PAQUETE,MONTO:e.MONTOS[n.ID_PAQUETE],NRO_CLASES:e.VECES*n.NRO_SEMANAS},u={ID_FRECUENCIA:e.ID_FRECUENCIA,ID_PAQUETE:n.ID_PAQUETE},i=t.listaMontosTemporal.find(function(e){return e.ID_FRECUENCIA===r.ID_FRECUENCIA&&e.ID_PAQUETE===r.ID_PAQUETE&&e.MONTO===r.MONTO&&e.NRO_CLASES===r.NRO_CLASES}),!i){a.n=2;break}return a.a(2);case 2:return a.n=3,t.$http.put("api/CtCursoPeriodoController/putCtPrecioPaquete",{params:{data:r,where:u}});case 3:return a.n=4,t.getPrecioPaquetes();case 4:return a.n=5,t.cargarMontos();case 5:a.n=7;break;case 6:a.p=6,o=a.v,t.$alert(o.message,"warning");case 7:return a.a(2)}},a,null,[[0,6]])}))()},agregarFrecuencia:function(){var e=this;return C()(l()().m(function n(){var t,a,r,u,i,o,c;return l()().w(function(n){while(1)switch(n.p=n.n){case 0:if(n.p=0,t=e.listaFrecuencias.find(function(n){return!e.frecSeleccionadas.includes(n.ID_FRECUENCIA)}),t){n.n=1;break}throw new Error("Ya no hay frecuencias disponibles");case 1:a=F()(e.listaPaquetes),n.p=2,a.s();case 3:if((r=a.n()).done){n.n=5;break}return u=r.value,i={ID_FRECUENCIA:t.ID_FRECUENCIA,ID_PAQUETE:u.ID_PAQUETE,MONTO:0,NRO_CLASES:t.VECES*u.NRO_SEMANAS},n.n=4,e.$http.post("api/CtCursoPeriodoController/postCtPrecioPaquete",{params:i});case 4:n.n=3;break;case 5:n.n=7;break;case 6:n.p=6,o=n.v,a.e(o);case 7:return n.p=7,a.f(),n.f(7);case 8:return n.n=9,e.getPrecioPaquetes();case 9:return n.n=10,e.cargarMontos();case 10:n.n=12;break;case 11:n.p=11,c=n.v,e.$alert(c.message,"warning");case 12:return n.a(2)}},n,null,[[2,6,7,8],[0,11]])}))()},init:function(){var e=this;return C()(l()().m(function n(){return l()().w(function(n){while(1)switch(n.n){case 0:return n.n=1,e.getFrecuencias();case 1:return n.n=2,e.getPaquetes();case 2:return n.n=3,e.getPrecioPaquetes();case 3:return n.n=4,e.cargarMontos();case 4:return n.a(2)}},n)}))()}},beforeMount:function(){var e=this;return C()(l()().m(function n(){return l()().w(function(n){while(1)switch(n.n){case 0:e.init();case 1:return n.a(2)}},n)}))()},watch:{nivel:{handler:function(){var e=this;return C()(l()().m(function n(){return l()().w(function(n){while(1)switch(n.n){case 0:return n.n=1,e.init();case 1:return n.a(2)}},n)}))()}}}}),U=t(12807);const O=(0,U.A)(R,[["render",D]]);var k=O,T={components:{QTabs:E.uw,QTab:E.zu,QTabPane:E.dg,QItemSection:h.A,QBtn:p.A,QSelect:m.A,QInput:I.A,QCard:P.A,QCardSection:d.A,sieModal:g.A,crearBotones:N.A,QSeparator:v.A,QTable:b.A,QIcon:_.A,configMonto:k,QPage:E.Tu},data:function(){return{name:"Mantenimiento de Paquetes de Semanas",nivelAcceso:2,sie:(0,A["default"])(),buttons:[{label:"Agregar paquete",icon:"plus",click:this.agregarPaquete,minAcceso:2},{label:"Agregar frecuencia",icon:"plus",click:this.agregarFrecuencia,minAcceso:2}],niveles:[{ID:"T",DESCRIPCION:"Todos"},{ID:"I",DESCRIPCION:"Inicial"},{ID:"P",DESCRIPCION:"Primaria"},{ID:"S",DESCRIPCION:"Secundaria"}],showNiveles:["SIE"].includes((0,A["default"])().usucod),tab:"T"}},methods:{agregarPaquete:function(){var e=this;return C()(l()().m(function n(){return l()().w(function(n){while(1)switch(n.n){case 0:if(!Array.isArray(e.$refs[e.tab])){n.n=1;break}return n.n=1,e.$refs[e.tab][0].agregarPaquete();case 1:return n.a(2)}},n)}))()},agregarFrecuencia:function(){var e=this;return C()(l()().m(function n(){return l()().w(function(n){while(1)switch(n.n){case 0:if(!Array.isArray(e.$refs[e.tab])){n.n=1;break}return n.n=1,e.$refs[e.tab][0].agregarFrecuencia();case 1:return n.a(2)}},n)}))()},copiarPrecioPaquete:function(){var e=this;return C()(l()().m(function n(){return l()().w(function(n){while(1)switch(n.n){case 0:if(!Array.isArray(e.$refs[e.tab])){n.n=1;break}return n.n=1,e.$refs[e.tab][0].copiarPrecioPaquete();case 1:return n.a(2)}},n)}))()},cambiarTab:function(e){var n=this;return C()(l()().m(function t(){return l()().w(function(t){while(1)switch(t.n){case 0:n.tab=e;case 1:return t.a(2)}},t)}))()},init:function(){var e=this;return C()(l()().m(function n(){return l()().w(function(n){while(1)switch(n.n){case 0:["0042"].includes(e.sie.colcod);case 1:return n.a(2)}},n)}))()}},beforeMount:function(){var e=this;return C()(l()().m(function n(){return l()().w(function(n){while(1)switch(n.n){case 0:return n.n=1,e.init();case 1:return n.a(2)}},n)}))()}};const Q=(0,U.A)(T,[["render",c]]);var M=Q}}]);