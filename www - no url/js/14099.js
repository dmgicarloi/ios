"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[14099],{14099:function(t,e,o){o.r(e),o.d(e,{default:function(){return _}});var n=o(8445),i=o.n(n),r=(o(71225),o(50310),o(5962),o(83190),o(61758)),a=o(58790),l={class:"row q-px-sm q-pt-sm"},s={class:"col-6"},c={class:"col-xs-12 col-md-6"},u={class:"row q-px-sm col"},d={class:"col-xs-12 listaDetalle"},f={class:"col-10"};function g(t,e){var o=(0,r.g2)("q-toolbar-title"),n=(0,r.g2)("q-toolbar"),g=(0,r.g2)("q-select"),p=(0,r.g2)("q-search"),m=(0,r.g2)("q-td"),h=(0,r.g2)("sie-select"),v=(0,r.g2)("q-popup-edit"),R=(0,r.g2)("q-tr"),b=(0,r.g2)("q-table"),S=(0,r.g2)("q-tooltip"),D=(0,r.g2)("q-fab-action"),O=(0,r.g2)("q-fab"),T=(0,r.g2)("q-page-sticky"),A=(0,r.g2)("q-page");return(0,r.uX)(),(0,r.Wv)(A,{class:"bg-white"},{default:(0,r.k6)(function(){return[(0,r.bF)(n,{class:"shadow-2 z-fab",inverted:""},{default:(0,r.k6)(function(){return[(0,r.bF)(o,{class:"q-pa-none"},{default:(0,r.k6)(function(){return i()(e[3]||(e[3]=[(0,r.eW)("ASIGNACION DE TIPO DE REGISTROS",-1)]))}),_:1})]}),_:1}),(0,r.Lk)("div",l,[(0,r.Lk)("div",s,[(0,r.bF)(g,{class:"q-if-outlined no-border",color:"secondary",options:t.years,modelValue:t.ano,"onUpdate:modelValue":e[0]||(e[0]=function(e){return t.ano=e}),"float-label":t.$t("ano"),onChange:t.seleccionaAnio},null,8,["options","modelValue","float-label","onChange"])]),(0,r.Lk)("div",c,[(0,r.bF)(g,{class:"q-if-outlined",color:"secondary",modelValue:t.vmFiltro.instrucod,options:t.dataSelect.nivel,"float-label":t.$t("ngs.nivel"),onChange:t.seleccionaInstru,filter:""},null,8,["modelValue","options","float-label","onChange"])])]),(0,r.Lk)("div",u,[(0,r.Lk)("div",d,[(0,r.bF)(b,{data:t.dataDetalle,columns:t.conf.columns,selection:t.conf.selection,pagination:t.conf.pagination,selected:t.conf.selected,"onUpdate:selected":e[2]||(e[2]=function(e){return t.conf.selected=e}),"row-key":"ID_PGPROFE",color:"secondary",filter:t.conf.filter},{top:(0,r.k6)(function(o){return[(0,r.Lk)("div",f,[(0,r.bF)(p,{class:"q-if-outlined","hide-underline":"",modelValue:t.conf.filter,"onUpdate:modelValue":e[1]||(e[1]=function(e){return t.conf.filter=e})},null,8,["modelValue"])])]}),body:(0,r.k6)(function(e){return[(0,r.bF)(R,{class:(0,a.C4)(["cursor-pointer",e.row.__index==t.currentRow.row.__index?"tr-select":""]),props:e,onClick:function(o){return t.getCurrentRow(e.row)}},{default:(0,r.k6)(function(){return[(0,r.bF)(m,{key:"INSTRUDES",props:e},{default:(0,r.k6)(function(){return[(0,r.eW)((0,a.v_)(e.row.INSTRUDES),1)]}),_:2},1032,["props"]),(0,r.bF)(m,{key:"GRADODES",props:e},{default:(0,r.k6)(function(){return[(0,r.eW)((0,a.v_)(e.row.GRADODES),1)]}),_:2},1032,["props"]),(0,r.bF)(m,{key:"TIPODESC",props:e},{default:(0,r.k6)(function(){return[(0,r.eW)((0,a.v_)(null===e.row.TIPODESC?"-":e.row.TIPODESC),1),(0,r.bF)(v,null,{default:(0,r.k6)(function(){return[(0,r.bF)(h,{onSelected:t.cambiarTipoRegistro,modelValue:e.row.TIPO,"onUpdate:modelValue":function(t){return e.row.TIPO=t},type:"outlined",options:t.dataSelect.tipoRegistro,val:"tipo",label:"tipodes",placeholder:"Seleccione"},null,8,["onSelected","modelValue","onUpdate:modelValue","options"])]}),_:2},1024)]}),_:2},1032,["props"])]}),_:2},1032,["class","props","onClick"])]}),_:1},8,["data","columns","selection","pagination","selected","filter"])])]),t.isGreater?((0,r.uX)(),(0,r.Wv)(T,{key:0,position:"bottom-right",offset:[20,20]},{default:(0,r.k6)(function(){return[(0,r.bF)(O,{icon:"more_vert",direction:"up",color:"secondary"},{default:(0,r.k6)(function(){return[t.sinPermiso?(0,r.Q3)("v-if",!0):((0,r.uX)(),(0,r.Wv)(D,{key:0,color:"secondary",icon:"delete",onClick:t.eliminar},{default:(0,r.k6)(function(){return[(0,r.bF)(S,{anchor:"center left",self:"center right"},{default:(0,r.k6)(function(){return i()(e[4]||(e[4]=[(0,r.eW)("Eliminar",-1)]))}),_:1})]}),_:1},8,["onClick"]))]}),_:1})]}),_:1})):(0,r.Q3)("v-if",!0)]}),_:1})}var p=o(99550),m=o.n(p),h=(o(39866),o(23825),o(77507),o(52133),o(10239),o(6724),o(70199),o(515),o(27153),o(66307),o(7346),o(24066),o(6123)),v=o(93616),R=o(72453),b=o(30640),S=o(2819),D=o(62760),O=o(88275),T=o(81288),A=(o(3927),o(982)),N=o(13813),k=o(69027),C=o(27738),E=o(80660),w={default:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return{id:t,ano:e,instrucod:o,gradocod:"",tipo:"",oldtipo:""}},maxNivelEva:function(){return 2},getAnios:function(){return E.$http.get("api/HyoAnos/getAnios")},getAlumnosSinCierre:function(t){return E.$http.get("api/carpetarecuperacion/getAlumnosSinCierre",{params:{anio:t}})},getListar:function(t,e){return E.$http.get("api/HyoPgTipoRegistroNgs/getAsignacion",{params:{instrucod:t,anio:e}})},getCursosNivelGrado:function(t,e){return E.$http.get("api/HyoClase/obtClasesNivelGrado",{params:{instrucod:t,gradocod:e}})},grabar:function(t){var e={id:t.id,ano:t.ano,instrucod:t.instrucod,gradocod:t.gradocod,tipo:t.tipo,oldtipo:t.oldtipo};return E.$http.post("api/HyoPgTipoRegistroNgs/registrar",e)},eliminar:function(t){return E.$http.post("api/HyoPgTipoRegistroNgs/eliminar",{id:t})}},I=o(95523),G=o(57668),P={components:{sieAno:R.A,QFab:h.l6,QFabAction:h.B$,sieSalones:O.Ay,QTable:h.kH,QTh:h.EJ,QTr:h.qh,QTd:h.Ef,QToggle:h.c5,QPopupEdit:h.GT,QSelect:h.Si,QPageSticky:h._U,sieSelect:v.A,sieModal:b.A,selectMultiple:I.A,QPage:h.Tu,QToolbar:h.ZV,QToolbarTitle:h.r_,QSearch:h.Ks,QTooltip:h.nC},data:function(){return{sinPermiso:1===(0,G["default"])().ruta.nivel,nemo:null,ano:(0,G["default"])().ano+"",tempRegistro:{},acceso:(0,G["default"])().ruta.nivel>=2,currentRow:{old:{},row:{}},conf:{data:[],columns:[{name:"INSTRUDES",label:"Nivel",field:"INSTRUDES",align:"left"},{name:"GRADODES",label:this.$t("grado"),field:"GRADODES",align:"left",sortable:!1},{name:"TIPODESC",label:"Mostrar registro por",field:"TIPODESC",align:"left",sortable:!1}],pagination:{page:1,rowsPerPage:200},filter:"",selection:"none",selected:[]},modal:!1,niveles:[],form:w["default"](0,(0,G["default"])().ano),vmFiltro:{instrucod:null,gradocod:[],periodo:1},vmRegistro:{instrucod:null,gradocod:[],periodo:null},dataSelect:{nivel:[],tipoRegistro:[{tipodes:"Por Grado",tipo:"G"},{tipodes:"Por Secci칩n",tipo:"S"}]},gradosTemp:[],maxNivelEva:w.maxNivelEva(),nomPrograma:"",tipoRegistro:1,years:[],anoVigente:(0,G["default"])().ano+""}},computed:{isGreater:function(){return(0,T.isGreater)()},grados:function(){var t=this,e=this.gradosTemp;return this.vmFiltro.instrucod&&this.vmFiltro["instrucod"].length>0?(e=e.filter(function(e){return t.vmFiltro["instrucod"]===e.INSTRUCOD}),e=(0,N["default"])(e,function(t){return{label:t.GRADODES,value:t.GRADOCOD}})):e=[],e},gradosReg:function(){var t=this,e=this.gradosTemp;return this.form.instrucod.length>0?(e=e.filter(function(e){return t.form.instrucod===e.INSTRUCOD}),e=(0,N["default"])(e,function(t){return{label:t.GRADODES,value:t.GRADOCOD}})):e=[],e},verNotaFin:function(){return 0!==this.tipoRegistro},lblNotaIni:function(){return 0===this.tipoRegistro?"Nivel de progreso":"Nota Inicio"},dataDetalle:function(){var t=this.conf.data;return this.loadingDetalle=!0,this.loadingDetalle=!1,t},actualizarReg:function(){return Object.keys(this.form).length>0&&""!==this.form.id},titulo:function(){return Object.keys(this.form).length>0&&""!==this.form.id?"Actualizar Registro":"Nuevo Registro"}},methods:{getCurrentRow:function(t){t.select=1,this.currentRow={row:t,old:JSON.parse(JSON.stringify(t))}},cambiarTipoRegistro:function(t){var e=this,o=this.currentRow.old,n={id:o.ID_PGTIPOREG,ano:o.ANO,instrucod:o.INSTRUCOD,gradocod:o.GRADOCOD,tipo:t.tipo,oldtipo:o.TIPO};w.grabar(n).then(function(t){var o=t.message?t.message:"Se grab칩 correctamente";(0,A["default"])(o,"success"),e.getLista()}).catch(function(t){(0,A["default"])(t.error.message,"warning")})},seleccionaInstru:function(t){this.vmFiltro.instrucod=t,this.getLista()},seleccionaGrado:function(t){this.vmFiltro.gradocod=t},seleccionaAnio:function(t){this.ano=t,this.getLista()},listarAnios:function(){var t=this;w.getAnios().then(function(e){t.years=e.map(function(t){var e=t.ANO,o=t.ANO;return{value:e,label:o}})})},getLista:function(){var t=this;if(!this.ano)return!1;w.getListar(this.vmFiltro["instrucod"],this.ano).then(function(e){t.conf.data=e,t.form=w["default"](0,t.ano)})},obtNGS:function(){var t=this;Promise.all([C.A.getNiveles(),C.A.getGrados()]).then(function(e){var o=m()(e,2),n=o[0],i=o[1],r=(0,N["default"])(n,function(t){return{label:t.INSTRUDES,value:t.INSTRUCOD}});r.unshift({label:"Todos",value:"T"}),t.dataSelect.nivel=r,t.gradosTemp=i})},seleccionaInstruReg:function(t){this.limpiar("niveles"),this.form.instrucod=t},seleccionarSalon:function(t){this.limpiar("grado"),this.form.gradocod=t.GRADOCOD,this.form.instrucod=t.INSTRUCOD},loadSalon:function(t){var e=this;if(this.tempRegistro){var o=t.filter(function(t){return t.INSTRUCOD===e.tempRegistro.INSTRUCOD&&t.GRADOCOD===e.tempRegistro.GRADOCOD});this.nemo=o[0]?o[0].NEMO:null}},limpiar:function(t){switch(t){case"niveles":this.vmRegistro.gradocod=[];case"grado":var e=this.form.instrucod,o=this.form.id;this.form=w["default"](o,this.ano,e);break;case"form":this.form.tipo="";break}},eliminar:function(t){var e=this,o=this.currentRow.old;return o?0===t?(t=o.ID_PGPROFE,w.eliminar(t).then(function(t){(0,A["default"])("Registro eliminado","success"),e.getLista()}).catch(function(){(0,A["default"])("No se pudo eliminar","warning")}),!1):(t=o.ID_PGTIPOREG,void(0,k.confirmar)(this.$t("mensajes.m0006.confirmacion"),function(){w.eliminar(t).then(function(t){(0,A["default"])("Registro eliminado","success"),e.getLista()}).catch(function(t){(0,A["default"])("No se pudo eliminar","warning")})})):((0,A["default"])("Seleccione un registro","warning"),!1)},imprimirReporte:function(){var t={repcod:"listadoProfesoresEtapa",formato:"pdf",ano:this.ano,instrucod:this.vmFiltro.instrucod,gradocod:this.vmFiltro.gradocod};(0,S["default"])(t,"webservice/reportes/reporte")},cerrarModal:function(){this.modal=!1,this.getLista()}},watch:{ano:function(t){this.getLista()}},created:function(){var t=this;D.A.getAnio().then(function(e){t.ano=e.ANO,w.getAlumnosSinCierre(e.ANO).then(function(t){if(t&&t.length){for(var e=[],o=0;o<t.length;o++){var n=t[o];e.includes(n.NEMODES)||e.push(n.NEMODES)}(0,k.swal)("Ejecutar Cierre de a침o","Falta ejecutar el proceso de Cierre de a침o escolar en: "+e.join(", "),"warning")}})}),this.getLista(),this.obtNGS(),this.listarAnios()}},F=o(12807);const y=(0,F.A)(P,[["render",g]]);var _=y}}]);