"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[47127],{47127:function(e,r,o){o.r(r),o.d(r,{default:function(){return A}});var i=o(61758),c=o(58790),n={class:"row items-center q-pt-sm"},t={class:"col-12 text-center"},a=["src"],s={class:"row q-col-gutter-md q-py-sm"},l={class:"col-12 text-center"},d={class:"verified-email-box q-pa-md q-mb-md"},u={class:"text-h6 text-positive"},f={class:"col-12 text-center"},v={class:"text-caption text-grey-6"},m={class:"col-12 text-center q-mt-md"},k={class:"row q-col-gutter-md q-py-sm"},g={class:"col-12 text-center"},p={class:"error-box q-pa-md q-mb-md"},x={class:"text-negative"};function h(e,r){var o=(0,i.g2)("q-card-section"),h=(0,i.g2)("q-icon"),L=(0,i.g2)("q-btn"),q=(0,i.g2)("q-card"),w=(0,i.g2)("q-page");return(0,i.uX)(),(0,i.Wv)(w,{class:"q-pa-sm flex flex-center"},{default:(0,i.k6)(function(){return[(0,i.bF)(q,{class:"col-md-6 q-pa-md verification-card"},{default:(0,i.k6)(function(){return[(0,i.bF)(o,null,{default:(0,i.k6)(function(){return[(0,i.Lk)("div",n,[(0,i.Lk)("div",t,[(0,i.Lk)("img",{src:e.logosie,alt:"",id:"logo",width:"150"},null,8,a)])])]}),_:1}),e.verificacionExitosa?((0,i.uX)(),(0,i.Wv)(o,{key:0},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",s,[r[0]||(r[0]=(0,i.Lk)("div",{class:"col-12 text-center"},[(0,i.Lk)("h4",{class:"q-mt-sm text-positive h2-1"},"¡Correo Verificado!")],-1)),r[1]||(r[1]=(0,i.Lk)("div",{class:"col-12 text-center"},[(0,i.Lk)("p",{class:"text-grey-7"},"Su correo electrónico ha sido verificado exitosamente")],-1)),(0,i.Lk)("div",l,[(0,i.Lk)("div",d,[(0,i.bF)(h,{class:"q-mr-sm",name:"email",color:"positive",size:"sm"}),(0,i.Lk)("strong",u,(0,c.v_)(e.correoVerificado),1)])]),(0,i.Lk)("div",f,[(0,i.Lk)("p",v,"Verificado el "+(0,c.v_)(e.fechaVerificacion),1)]),(0,i.Lk)("div",m,[(0,i.bF)(L,{class:"action-btn",icon:"home",label:"Volver al Inicio",outline:"",color:"primary",size:"md",onClick:e.redirectToLogin},null,8,["onClick"])])])]}),_:1})):(0,i.Q3)("v-if",!0),e.errorVerificacion?((0,i.uX)(),(0,i.Wv)(o,{key:1},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",k,[r[2]||(r[2]=(0,i.Lk)("div",{class:"col-12 text-center"},[(0,i.Lk)("h4",{class:"q-mt-sm text-negative h2-1"},"Error de Verificación")],-1)),r[3]||(r[3]=(0,i.Lk)("div",{class:"col-12 text-center"},[(0,i.Lk)("p",{class:"text-grey-7"},"No se pudo verificar su correo electrónico.")],-1)),(0,i.Lk)("div",g,[(0,i.Lk)("div",p,[(0,i.bF)(h,{class:"q-mr-xs",name:"warning",color:"negative",size:"sm"}),(0,i.Lk)("span",x,(0,c.v_)(e.mensajeError),1)])]),r[4]||(r[4]=(0,i.Lk)("div",{class:"col-12 text-center q-mt-md"},[(0,i.Lk)("p",{class:"text-caption text-grey-6"},"Por favor, solicite un nuevo enlace de verificación.")],-1))])]}),_:1})):(0,i.Q3)("v-if",!0)]}),_:1})]}),_:1})}var L=o(76080),q=o.n(L),w=o(45254),b=o.n(w),y=(o(12563),o(23825),o(10239),o(83190),o(52776),o(66307),o(53113),o(24066),o(32701),o(67396),o(50923),o(59502),o(6123)),C=o(88567),E=o(95718),V=o(11654),T=o(34262),_=o(57668),F=o(80660),Q={components:{QCard:C.A,QCardSection:E.A,QBtn:V.A,QIcon:T.A,QPage:y.Tu},data:function(){return{sieInfo:(0,_["default"])(),logosie:(0,_["default"])().api+"/HyoEscudo/logosie",verificacionExitosa:!1,errorVerificacion:!1,correoVerificado:"",fechaVerificacion:"",currentToken:null,mensajeError:""}},methods:{getTokenFromUrl:function(){var e=null,r=new URLSearchParams(window.location.search);if(r.has("token"))return e=r.get("token"),console.log("Token: ",e),console.log("Decoded UrI : ",decodeURIComponent(e)),decodeURIComponent(e)},verifyToken:function(){var e=this;return b()(q()().m(function r(){var o,i,c;return q()().w(function(r){while(1)switch(r.p=r.n){case 0:if(o=e.getTokenFromUrl(),console.log("Token decodificado: ",o),o){r.n=1;break}return e.errorVerificacion=!0,e.mensajeError="No se encontró token de verificación",r.a(2);case 1:return e.currentToken=o,console.log("Current Token: ",e.currentToken),r.p=2,r.n=3,F.$http.post("api/SeguridadCorreoController/verificarCorreo",{token:o});case 3:if(i=r.v,console.log("Response Verify: ",i),!i.success){r.n=4;break}e.correoVerificado=i.correo||"Correo verificado",e.fechaVerificacion=(new Date).toLocaleDateString(),e.verificacionExitosa=!0,e.$q.notify({color:"positive",position:"top",message:i.message||"¡Correo verificado exitosamente!",icon:"verified_user"}),r.n=5;break;case 4:throw new Error(i.message||"Error en la verificación");case 5:r.n=7;break;case 6:r.p=6,c=r.v,console.error("Error al verificar token:",c),e.errorVerificacion=!0,e.mensajeError=c.message||"Error al verificar el correo",e.$q.notify({color:"negative",position:"top",message:"Error al verificar el correo. El enlace puede estar expirado.",icon:"error"});case 7:return r.a(2)}},r,null,[[2,6]])}))()},redirectToLogin:function(){this.$router.push("/login")}},mounted:function(){var e=this;return b()(q()().m(function r(){return q()().w(function(r){while(1)switch(r.n){case 0:return r.n=1,e.verifyToken();case 1:return r.a(2)}},r)}))()}},I=o(12807);const U=(0,I.A)(Q,[["render",h]]);var A=U}}]);