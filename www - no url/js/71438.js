"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[71438],{71438:function(e,o,t){t.r(o),t.d(o,{default:function(){return z}});t(71225),t(50310),t(5962),t(83190);var r=t(61758),a={class:"row q-col-gutter-md"},n={class:"col-xs-12"},l={class:"row q-pa-sm q-col-gutter-sm"},i={class:"col-xs-12"},c={class:"row"},u={class:"col"},s={class:"col-xs-12"},m={class:"col-xs-12"},d={class:"row"},f={class:"col-xs-3 column items-center justify-center"},p={class:"row q-col-gutter-md"},b={class:"col-xs-12 col-sm-4 col-md-3"},A={class:"col-xs-12 col-sm-4 col-md-3"},C={class:"col-xs-12 col-sm-4 col-md-3"},g={class:"col-xs-12 col-sm-4 col-md-3"},R={class:"row"},h={class:"col"},v={class:"col"},F={class:"col-xs-12 sie-flat"};function M(e,o){var t=this,M=(0,r.g2)("header-btn"),E=(0,r.g2)("sie-table"),k=(0,r.g2)("q-card-section"),w=(0,r.g2)("q-card"),P=(0,r.g2)("q-input"),I=(0,r.g2)("q-icon"),O=(0,r.g2)("q-form"),V=(0,r.g2)("sie-modal"),_=(0,r.g2)("q-select"),S=(0,r.g2)("q-checkbox"),x=(0,r.g2)("q-page");return(0,r.uX)(),(0,r.Wv)(x,{class:"biblioteca-mantenimiento-formato q-pa-sm sie-flat"},{default:(0,r.k6)(function(){return[(0,r.bF)(w,{flat:"",bordered:""},{default:(0,r.k6)(function(){return[(0,r.bF)(M,{name:"Formatos",auto:!0,buttons:e.buttons},null,8,["buttons"]),(0,r.bF)(k,null,{default:(0,r.k6)(function(){return[(0,r.Lk)("div",a,[(0,r.Lk)("div",n,[(0,r.bF)(E,{ref:"tabla",columns:e.fields,data:e.rows,selection:"single",config:e.config,context:t,css:{height:"calc(100vh - 165px)"}},null,8,["columns","data","config"])])])]}),_:1})]}),_:1}),(0,r.bF)(V,{modelValue:e.openModal,"onUpdate:modelValue":o[4]||(o[4]=function(o){return e.openModal=o}),title:"Agregar Formato",onSubmit:e.guardarFormato},{default:(0,r.k6)(function(){return[(0,r.bF)(O,{ref:"formFormato"},{default:(0,r.k6)(function(){return[(0,r.Lk)("div",l,[(0,r.Lk)("div",i,[(0,r.Lk)("div",c,[(0,r.Lk)("div",u,[(0,r.bF)(P,{modelValue:e.form.forabr,"onUpdate:modelValue":o[0]||(o[0]=function(o){return e.form.forabr=o}),label:"Código",maxlength:"3"},null,8,["modelValue"])]),(0,r.bF)(I,{class:"cursor-pointer",size:"30px",color:"primary",name:e.form.imagen,onClick:o[1]||(o[1]=function(o){return e.openModalIcono=!0})},null,8,["name"])])]),(0,r.Lk)("div",s,[(0,r.bF)(P,{modelValue:e.form.fordesc,"onUpdate:modelValue":o[2]||(o[2]=function(o){return e.form.fordesc=o}),label:"Nombre"},null,8,["modelValue"])]),(0,r.Lk)("div",m,[(0,r.bF)(P,{modelValue:e.form.forcoment,"onUpdate:modelValue":o[3]||(o[3]=function(o){return e.form.forcoment=o}),type:"textarea",label:"Descripción"},null,8,["modelValue"])])])]}),_:1},512)]}),_:1},8,["modelValue","onSubmit"]),(0,r.bF)(V,{modelValue:e.openModalIcono,"onUpdate:modelValue":o[5]||(o[5]=function(o){return e.openModalIcono=o}),title:"Agregar Ícono",css:{width:"687px"}},{default:(0,r.k6)(function(){return[(0,r.Lk)("div",d,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.icons,function(o,t){return(0,r.uX)(),(0,r.CE)("div",f,[(0,r.bF)(I,{class:"cursor-pointer",size:"50px",color:"primary",name:o,onClick:function(t){return e.cambiarIcono(o)}},null,8,["name","onClick"])])}),256))])]}),_:1},8,["modelValue"]),(0,r.bF)(V,{modelValue:e.openModalMarc,"onUpdate:modelValue":o[15]||(o[15]=function(o){return e.openModalMarc=o}),title:"Plantilla",footer:!1,maximized:""},{default:(0,r.k6)(function(){return[(0,r.bF)(w,null,{default:(0,r.k6)(function(){return[(0,r.bF)(M,{name:"Plantilla para formato",auto:!1,buttons:e.buttonPlantillaFormato},null,8,["buttons"]),(0,r.bF)(k,null,{default:(0,r.k6)(function(){return[(0,r.Lk)("div",p,[(0,r.Lk)("div",b,[(0,r.bF)(_,{modelValue:e.filter.forcod,"onUpdate:modelValue":o[6]||(o[6]=function(o){return e.filter.forcod=o}),options:e.filter.formatos,"option-label":"FORDESC","option-value":"FORCOD",label:"Formato",onInput:e.cambiarFormato},null,8,["modelValue","options","onInput"])]),(0,r.Lk)("div",A,[(0,r.bF)(P,{modelValue:e.filter.marccod,"onUpdate:modelValue":o[7]||(o[7]=function(o){return e.filter.marccod=o}),label:"Etiqueta",debounce:"600",onInput:o[8]||(o[8]=function(o){return e.cambiarFormato(e.filter.forcod)})},null,8,["modelValue"])]),(0,r.Lk)("div",C,[(0,r.bF)(P,{modelValue:e.filter.marcnom,"onUpdate:modelValue":o[9]||(o[9]=function(o){return e.filter.marcnom=o}),label:"Título",debounce:"600",onInput:o[10]||(o[10]=function(o){return e.cambiarFormato(e.filter.forcod)})},null,8,["modelValue"])]),(0,r.Lk)("div",g,[(0,r.Lk)("div",R,[(0,r.Lk)("div",h,[(0,r.bF)(S,{"toggle-indeterminate":"","indeterminate-value":2,modelValue:e.filter.pmarc,"onUpdate:modelValue":o[11]||(o[11]=function(o){return e.filter.pmarc=o}),label:"Marc","true-value":1,"false-value":0,onInput:o[12]||(o[12]=function(o){return e.setAllCheck("marc",e.filter.pmarc)})},null,8,["modelValue"])]),(0,r.Lk)("div",v,[(0,r.bF)(S,{"toggle-indeterminate":"","indeterminate-value":2,modelValue:e.filter.pbasica,"onUpdate:modelValue":o[13]||(o[13]=function(o){return e.filter.pbasica=o}),label:"Básica","true-value":1,"false-value":0,onInput:o[14]||(o[14]=function(o){return e.setAllCheck("pbasica",e.filter.pbasica)})},null,8,["modelValue"])])])]),(0,r.Lk)("div",F,[(0,r.bF)(E,{columns:e.fieldsFormatoEstructura,data:e.rowsFormatoEstructura,config:e.configFormatoEstructura,context:t,css:{height:"calc(100vh - 180px)"}},null,8,["columns","data","config"])])])]}),_:1})]}),_:1})]}),_:1},8,["modelValue"])]}),_:1})}var E=t(41562),k=t.n(E),w=t(57008),P=t.n(w),I=t(76080),O=t.n(I),V=t(45254),_=t.n(V),S=(t(30683),t(39866),t(52133),t(6724),t(70199),t(515),t(7346),t(6123)),x=(t(89571),{data:function(){return{config:{IMAGEN:{renderHtml:function(e,o,t){return t.icon({name:e.IMAGEN||""})}},MARC21:{component:"button",icon:["add_circle as plus"],plus:function(e,o){var t=this;return _()(O()().m(function r(){return O()().w(function(r){while(1)switch(r.n){case 0:return t.currentRow=o,r.n=1,t.cambiarFormato(e.FORCOD);case 1:return t.filter.forcod=e.FORCOD,r.n=2,t.getFormato();case 2:t.filter.formatos=r.v,t.openModalMarc=!0;case 3:return r.a(2)}},r)}))()},tooltip:{plus:"Agregar"},permisos:{plus:">1"},dense:!0,flat:!0},ACTION:{component:"button",icon:["edit","delete"],edit:function(e,o){this.currentRow=o,this.action="update",this.form.forabr=e.FORABR,this.form.fordesc=e.FORDESC,this.form.forcoment=e.FORCOMENT,this.form.imagen=e.IMAGEN,this.openModal=!0},delete:function(e,o){var t=this;return _()(O()().m(function r(){var a,n,l,i;return O()().w(function(r){while(1)switch(r.p=r.n){case 0:return r.n=1,t.$confirmar("¿Está seguro de eliminar el formato? ¡El proceso es irreversible!","delete");case 1:if(a=r.v,!a){r.n=6;break}return r.p=2,r.n=3,t.$http.delete("api/HyoBmFormato/deleteFormato",{params:{forcod:e.FORCOD}});case 3:n=r.v,l=n.message,t.rows.splice(t.rows.indexOf(o),1),t.$notify(l,"success"),r.n=6;break;case 4:if(r.p=4,i=r.v,!i.error){r.n=5;break}return r.a(2,t.$notify(i.error.message,"warning"));case 5:t.$notify("No ha sido posible eliminar el registro","warning");case 6:return r.a(2)}},r,null,[[2,4]])}))()},tooltip:{edit:"Editar",delete:"Eliminar"},permisos:{edit:">1",delete:"===3"},dense:!0,flat:!0}},rows:[],fields:[{name:"IMAGEN",label:"Ícono",field:"IMAGEN",align:"center"},{name:"FORABR",label:"Código",field:"FORABR",align:"center"},{name:"FORDESC",label:"Nombre",field:"FORDESC",align:"left"},{name:"FORCOMENT",label:"Descripción",field:"FORCOMENT",align:"left"},{name:"MARC21",label:"MARC",field:"MARC21",align:"center"},{name:"ACTION",label:"Acción",field:"ACTION",align:"center",width:80}]}}}),B={data:function(){return{configFormatoEstructura:{DESCRIPCION:{renderHtml:function(e,o){return!0===e.HEADER?o("b",{class:["text-primary"]},e.DESCRIPCION):o("div",{class:["row"]},[o("div",{class:["col","column","items-center","justify-center"]},[o("b",{},e.MARCCOD)])])}},MARCREP:{renderHtml:function(e,o){return!0===e.HEADER?o("span",{},""):o("span",{},e.MARCREP?"R":"RN")}},MARCREQ:{renderHtml:function(e,o){return!0===e.HEADER?o("span",{},""):o("span",{},e.MARCREQ?"Si":"No")}},PMARC:{renderHtml:function(e,o,t,r){return!0===e.HEADER?o("span",{},""):t.checkbox({value:r.PMARC,trueValue:1})},renderAction:function(e,o){1===e.PMARC?o.PMARC=0:o.PMARC=1,o.updated=!0}},PBASICA:{renderHtml:function(e,o,t,r){return!0===e.HEADER?o("span",{},""):t.checkbox({value:r.PBASICA,trueValue:1})},renderAction:function(e,o){1===e.PBASICA?o.PBASICA=0:o.PBASICA=1,o.updated=!0}}},rowsFormatoEstructura:[],fieldsFormatoEstructura:[{name:"DESCRIPCION",label:"Etiqueta",field:"DESCRIPCION",align:"left",wrap:!0},{name:"MARCNOM",label:"Título",field:"MARCNOM",align:"left",wrap:!0},{name:"MARCREP",label:"Repetible",field:"MARCREP",align:"center",width:90},{name:"MARCREQ",label:"Requerido",field:"MARCREQ",align:"center",width:90},{name:"PMARC",label:"Marc",field:"PMARC",align:"center",width:90},{name:"PBASICA",label:"Básico",field:"PBASICA",align:"center",width:90}]}}},y=t(9736),D=t(16648),N=t(88567),H=t(95718),q=t(3112),L=t(2739),Q=t(57668),$=t(11768),U={mixins:[x,B],components:{QInput:y.A,QCheckbox:q.A,QForm:L.A,QSelect:D.A,QCard:N.A,QCardSection:H.A,QPage:S.Tu,QIcon:S.bP},data:function(){return{sie:(0,Q["default"])(),buttons:[{icon:"plus",label:"Agregar",click:this.modal,permiso:">1"}],buttonPlantillaFormato:[{icon:"plus",label:"Guardar",click:this.guardarPlantillaFormato,loading:!1,permiso:">1"}],openModal:!1,form:{forabr:"",fordesc:"",forcoment:"",imagen:"university"},action:"create",openModalIcono:!1,currentRow:{},filter:{forcod:"",forabr:"",fordesc:"",pmarc:0,pbasica:0,marccod:"",marcnom:"",formatos:[]},icons:["book_open_page_variant","my_location","videogame_asset","address_book","documents","leanpub","newspaper_o","university","collections","television_guide","file_video","file_word","file_music","file_pdf","file_outline","file_image","book_open_page_variant","add_a_photo","photo_camera","games","headset","import_contacts","pin_drop","book","picture_o","map_marker","globe","chrome","firefox","guides"],openModalMarc:!1}},methods:{setAllCheck:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"marc",o=arguments.length>1?arguments[1]:void 0;this.rowsFormatoEstructura.map(function(t){t.updated=!0,"marc"===e?(t.PMARC=0,1===o&&(t.PMARC=1),1===t.MARCREQ&&2===o&&(t.PMARC=1)):"pbasica"===e&&(t.PBASICA=0,1===o&&(t.PBASICA=1),1===t.MARCREQ&&2===o&&(t.PBASICA=1))})},guardarPlantillaFormato:function(){var e=this;return _()(O()().m(function o(){var t,r,a;return O()().w(function(o){while(1)switch(o.n){case 0:return t=e.rowsFormatoEstructura.filter(function(e){return e.PBASICA||e.PMARC}).map(function(e){return{MARCCOD:e.MARCCOD,PBASICA:e.PBASICA||0,PMARC:e.PMARC||0}}).filter(function(e){return!e.HEADER}),e.buttonPlantillaFormato[0].loading=!0,o.n=1,e.$http.put("api/HyoBmFormato/updateEstructuraFormato",{forcod:e.filter.forcod,estructura:t});case 1:r=o.v,a=r.message,e.buttonPlantillaFormato[0].loading=!1,e.$notify(a,"success");case 2:return o.a(2)}},o)}))()},clear:function(){this.form.forabr="",this.form.fordesc="",this.form.forcoment="",this.form.imagen="university"},modal:function(){this.action="create",this.clear(),this.openModal=!0},required:function(e){return![null,void 0,""].includes(e)||"Campo requerido"},cambiarIcono:function(e){this.form.imagen=e,this.openModalIcono=!1},getFormato:function(){return this.$http.get("api/HyoBmFormato/getFormato")},guardarFormato:function(){var e=this;return _()(O()().m(function o(){var t,r,a,n,l,i;return O()().w(function(o){while(1)switch(o.p=o.n){case 0:if(o.p=0,"create"!==e.action){o.n=3;break}return o.n=1,e.$http.post("api/HyoBmFormato/createFormato",e.form);case 1:return t=o.v,r=t.message,o.n=2,e.getFormato();case 2:e.rows=o.v,e.openModal=!1,e.$notify(r,"success"),o.n=6;break;case 3:return a=P()({},e.form),a.forcod=e.currentRow.FORCOD,o.n=4,e.$http.put("api/HyoBmFormato/updateFormato",a);case 4:return n=o.v,l=n.message,o.n=5,e.getFormato();case 5:e.rows=o.v,e.openModal=!1,e.$notify(l,"success");case 6:o.n=8;break;case 7:o.p=7,i=o.v,e.$notify(i.message,"warning");case 8:return o.a(2)}},o,null,[[0,7]])}))()},verificarExisteCheck:function(e){var o=0,t=0,r=0;for(var a in e){var n,l=e[a],i=k()(l.data);try{for(i.s();!(n=i.n()).done;){var c=n.value;r++,c.PBASICA&&o++,c.PMARC&&t++}}catch(e){i.e(e)}finally{i.f()}}return{hasBasica:o,hasMarc:t,totalRegistros:r}},dataGroup:function(e){var o=[],t=this.verificarExisteCheck(e),r=t.hasBasica,a=t.hasMarc,n=t.totalRegistros;for(var l in this.filter.pbasica=0===r?2:r===n?1:2,this.filter.pmarc=0===a?2:a===n?1:2,e){var i=e[l];i=JSON.parse(JSON.stringify(i)),i.info.MARCNOM="",i.info.MARCREP="",i.info.MARCREQ="",i.info.PMARC="",i.info.PBASICA="",i.info.HEADER=!0,o[o.length]=i.info,i.data.map(function(e){1===e.MARCREQ&&0===r&&0===a&&(e.PBASICA=1,e.PMARC=1)}),o=o.concat(i.data)}return o},cambiarFormato:function(e){var o=this;return _()(O()().m(function t(){var r,a;return O()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,o.$http.get("api/HyoBmFormato/getFormatoEstructura",{params:{forcod:e,marccod:o.filter.marccod||"",marcnom:o.filter.marcnom||""}});case 1:r=t.v,a=(0,$.A)(r,["DESCRIPCION"]),o.rowsFormatoEstructura=o.dataGroup(a);case 2:return t.a(2)}},t)}))()}},created:function(){var e=this;return _()(O()().m(function o(){return O()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,e.getFormato();case 1:e.rows=o.v;case 2:return o.a(2)}},o)}))()}},T=t(12807);const G=(0,T.A)(U,[["render",M]]);var z=G}}]);