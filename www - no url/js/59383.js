"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[59383],{59383:function(e,o,a){a.r(o),a.d(o,{default:function(){return fe}});var t=a(8445),i=a.n(t),n=a(61758),l=a(58790),s={class:"q-card q-mt-sm"},c={class:"row q-mx-sm wrap"},u={class:"row q-mx-sm"},r={class:"row q-mx-sm"},d={class:"row justify-between col justify-center"},f={class:"col row justify-center"},h={class:"col row justify-end"},m={class:"row"},p={key:0,class:"text-bold"},b={class:"row"},A={class:"row"},E={class:"row"},D={class:"column"},O={class:"col q-ma-xs"},S={class:"col row"},g={class:"col row"},C={class:"q-ma-sm"},v={class:"row q-mx-sm"},T={class:"row q-mx-sm"},F={class:"row q-mx-sm"},k={class:"row q-mx-sm"},I={class:"row q-mx-sm"},M={class:"columns q-ma-sm col"},V={class:"row col q-gutter-sm"};function R(e,o){var a=this,t=(0,n.g2)("header-btn"),R=(0,n.g2)("sie-salones"),q=(0,n.g2)("q-select"),L=(0,n.g2)("q-search"),w=(0,n.g2)("q-datetime"),y=(0,n.g2)("q-btn"),U=(0,n.g2)("q-td"),J=(0,n.g2)("q-tooltip"),_=(0,n.g2)("q-icon"),H=(0,n.g2)("q-chip"),N=(0,n.g2)("q-download-file"),j=(0,n.g2)("q-table"),z=(0,n.g2)("q-input"),Y=(0,n.g2)("sie-modal"),$=(0,n.g2)("sie-upload"),G=(0,n.g2)("sie-select"),P=(0,n.g2)("q-tab"),Q=(0,n.g2)("q-tabs"),B=(0,n.g2)("q-item-side"),x=(0,n.g2)("q-item-main"),X=(0,n.g2)("q-item"),W=(0,n.g2)("q-checkbox"),K=(0,n.g2)("q-item-separator"),Z=(0,n.g2)("q-scroll-area"),ee=(0,n.g2)("q-list"),oe=(0,n.g2)("q-input1"),ae=(0,n.g2)("q-select1"),te=(0,n.g2)("sie-table"),ie=(0,n.g2)("q-page");return(0,n.uX)(),(0,n.Wv)(ie,{class:"column q-pa-md"},{default:(0,n.k6)(function(){return[(0,n.bF)(t,{name:"Justificaciones de Asistencia",buttons:e.buttons},null,8,["buttons"]),(0,n.Lk)("div",s,[(0,n.Lk)("div",c,[(0,n.bF)(R,{class:"col-12 col-sm no-border",style:{padding:"0 !important"},modelValue:e.filtros.nemo,"onUpdate:modelValue":o[0]||(o[0]=function(o){return e.filtros.nemo=o}),onSeleccionar:o[1]||(o[1]=function(o){return e.tipBusqueda(1)}),label:e.$t("salon"),campos:["NEMO","NEMODES","INSTRUCOD","GRADOCOD","SECCIONCOD"],todos:!0},null,8,["modelValue","label"]),(0,n.bF)(q,{class:"q-if-outlined",options:e.estadoJustificacion,multiple:"",chips:"",modelValue:e.filtros.estados,"onUpdate:modelValue":o[2]||(o[2]=function(o){return e.filtros.estados=o}),"float-label":"Estado",color:"secondary",onInput:e.filtrar},null,8,["options","modelValue","onInput"])]),(0,n.Lk)("div",u,[(0,n.bF)(q,{class:"q-if-outlined col",options:e.niveles,modelValue:e.instrucod,"onUpdate:modelValue":o[3]||(o[3]=function(o){return e.instrucod=o}),"float-label":"Nivel",onInput:o[4]||(o[4]=function(o){return e.tipBusqueda(2)})},null,8,["options","modelValue"]),(0,n.bF)(q,{class:"q-if-outlined col",options:e.grados,modelValue:e.gradocod,"onUpdate:modelValue":o[5]||(o[5]=function(o){return e.gradocod=o}),"float-label":"Grado",onInput:o[6]||(o[6]=function(o){return e.tipBusqueda(2)})},null,8,["options","modelValue"]),(0,n.bF)(q,{class:"q-if-outlined col",options:e.secciones,modelValue:e.seccioncod,"onUpdate:modelValue":o[7]||(o[7]=function(o){return e.seccioncod=o}),"float-label":"Sección",onInput:e.filtrar},null,8,["options","modelValue","onInput"])]),(0,n.Lk)("div",r,[(0,n.bF)(L,{class:"q-if-outlined col-12 col-sm",modelValue:e.filtros.alumno,"onUpdate:modelValue":o[8]||(o[8]=function(o){return e.filtros.alumno=o}),"float-label":"Alumno"},null,8,["modelValue"]),(0,n.bF)(q,{class:"q-if-outlined",options:e.modoFiltro,modelValue:e.filtros.modo,"onUpdate:modelValue":o[9]||(o[9]=function(o){return e.filtros.modo=o}),"float-label":"Modo Busqueda",onInput:e.cargaInicial},null,8,["options","modelValue","onInput"]),(0,n.bF)(w,{class:"q-if-outlined",modelValue:e.filtros.fIni,"onUpdate:modelValue":o[10]||(o[10]=function(o){return e.filtros.fIni=o}),type:"date",format:"DD/MM/YYYY","float-label":e.$t("fechainicio"),onInput:e.cargaInicial},null,8,["modelValue","float-label","onInput"]),(0,n.bF)(w,{class:"q-if-outlined",modelValue:e.filtros.fFin,"onUpdate:modelValue":o[11]||(o[11]=function(o){return e.filtros.fFin=o}),type:"date",format:"DD/MM/YYYY","float-label":e.$t("fechafin"),onInput:e.cargaInicial},null,8,["modelValue","float-label","onInput"])])]),(0,n.bF)(j,{class:"q-mt-xs",style:{height:"55vh"},data:e.data,columns:e.columns,"row-key":"ID",filter:e.filtros.alumno,selection:"multiple",selected:e.listSelect,"onUpdate:selected":o[12]||(o[12]=function(o){return e.listSelect=o})},{bottom:(0,n.k6)(function(a){return[(0,n.Lk)("div",d,[o[39]||(o[39]=(0,n.Lk)("div",{class:"col"},null,-1)),(0,n.Lk)("div",f,[(0,n.bF)(y,{icon:"refresh",flat:"",dense:"",round:"",onClick:e.cargaInicial},null,8,["onClick"])]),(0,n.Lk)("div",h,[o[38]||(o[38]=(0,n.Lk)("div",{class:"text-bold"},"Total: ",-1)),(0,n.Lk)("span",null,(0,l.v_)(e.data.length),1)])])]}),"body-cell-FH_REGISTRO":(0,n.k6)(function(o){return[(0,n.bF)(U,{props:o},{default:(0,n.k6)(function(){return[(0,n.eW)((0,l.v_)(e.date(o.row.FH_REGISTRO,"DD/MM/YYYY HH:mm")),1)]}),_:2},1032,["props"])]}),"body-cell-ESTADO":(0,n.k6)(function(a){return[(0,n.bF)(U,{props:a,style:(0,l.Tr)({"background-color":e.estados[a.row.ESTADO].color})},{default:(0,n.k6)(function(){return[(0,n.eW)((0,l.v_)(e.estados[a.row.ESTADO].abr),1),(0,n.bF)(J,{class:"column"},{default:(0,n.k6)(function(){return[(0,n.Lk)("div",m,["P"!==a.row.ESTADO?((0,n.uX)(),(0,n.CE)("div",p,"Estado: ")):(0,n.Q3)("v-if",!0),(0,n.Lk)("span",null,(0,l.v_)(e.estados[a.row.ESTADO].titulo),1)]),"P"!==a.row.ESTADO?((0,n.uX)(),(0,n.CE)(n.FK,{key:0},[(0,n.Lk)("div",b,[o[40]||(o[40]=(0,n.Lk)("div",{class:"text-bold"},"Usuario: ",-1)),(0,n.Lk)("span",null,(0,l.v_)(a.row.USUARIO_RPTA),1)]),(0,n.Lk)("div",A,[o[41]||(o[41]=(0,n.Lk)("div",{class:"text-bold"},"Fecha: ",-1)),(0,n.Lk)("span",null,(0,l.v_)(e.date(a.row.FH_RESPUESTA,"DD/MM/YYYY hh:mm A")),1)])],64)):(0,n.Q3)("v-if",!0)]}),_:2},1024)]}),_:2},1032,["props","style"])]}),"body-cell-DETALLE":(0,n.k6)(function(e){return[(0,n.bF)(U,{props:e},{default:(0,n.k6)(function(){return[(0,n.bF)(_,{name:"info"}),(0,n.bF)(J,null,{default:(0,n.k6)(function(){return[(0,n.Lk)("div",E,[o[42]||(o[42]=(0,n.Lk)("div",{class:"text-bold"},"Detalle:  ",-1)),(0,n.Lk)("span",null,(0,l.v_)(e.row.DETALLE),1)])]}),_:2},1024)]}),_:2},1032,["props"])]}),"body-cell-FECHAMOD":(0,n.k6)(function(o){return[(0,n.bF)(U,{props:o},{default:(0,n.k6)(function(){return[(0,n.Lk)("div",D,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(o.row.FECHAS,function(o){return(0,n.uX)(),(0,n.Wv)(H,{class:"text-center",dense:"",color:o.COLORVUE,icon:o.ICONO},{default:(0,n.k6)(function(){return[(0,n.eW)((0,l.v_)(e.date(o.FECHA,"DD/MM/YYYY")),1),(0,n.bF)(J,null,{default:(0,n.k6)(function(){return[(0,n.eW)((0,l.v_)(o.ESTADODES),1)]}),_:2},1024)]}),_:2},1032,["color","icon"])}),256))])]}),_:2},1032,["props"])]}),"body-cell-NOMBRE_ARCHIVO":(0,n.k6)(function(o){return[(0,n.bF)(U,{props:o},{default:(0,n.k6)(function(){return[o.row.EXTENSION?((0,n.uX)(),(0,n.Wv)(N,{key:0,src:e.devuelveUrl(o.row),item:o.row,name:o.row.NOMBRE_ARCHIVO,extension:o.row.EXTENSION,inline:!1},null,8,["src","item","name","extension"])):(0,n.Q3)("v-if",!0)]}),_:2},1032,["props"])]}),_:1},8,["data","columns","filter","selected"]),(0,n.bF)(Y,{modelValue:e.modalRechazar,"onUpdate:modelValue":o[19]||(o[19]=function(o){return e.modalRechazar=o}),title:e.dataRechazo.TIPO+" Justificación",labelButtonOk:e.dataRechazo.TIPO,onSubmit:o[20]||(o[20]=function(o){return e.rechazarJustificacion(e.dataRechazo.MODO)}),cancel:e.$t("cancelar")},{default:(0,n.k6)(function(){return[(0,n.Lk)("div",O,[(0,n.bF)(z,{class:"q-if-outlined",modelValue:e.dataRechazo.NOMCOMP,"onUpdate:modelValue":o[13]||(o[13]=function(o){return e.dataRechazo.NOMCOMP=o}),readonly:"","float-label":"Estudiante"},null,8,["modelValue"]),(0,n.Lk)("div",S,[(0,n.bF)(z,{class:"col q-if-outlined",modelValue:e.dataRechazo.NEMODES,"onUpdate:modelValue":o[14]||(o[14]=function(o){return e.dataRechazo.NEMODES=o}),readonly:"","float-label":"Salón"},null,8,["modelValue"])]),(0,n.Lk)("div",g,[(0,n.bF)(z,{class:"col q-if-outlined",modelValue:e.dataRechazo.SECUDES,"onUpdate:modelValue":o[15]||(o[15]=function(o){return e.dataRechazo.SECUDES=o}),readonly:"","float-label":"Tipo de justificación"},null,8,["modelValue"]),(0,n.bF)(z,{class:"col q-if-outlined",modelValue:e.dataRechazo.FH_JUSTIFICA,"onUpdate:modelValue":o[16]||(o[16]=function(o){return e.dataRechazo.FH_JUSTIFICA=o}),readonly:"","float-label":"Fecha justificación"},null,8,["modelValue"])]),(0,n.bF)(z,{class:"q-if-outlined col",type:"textarea",rows:"3",readonly:"",modelValue:e.dataRechazo.DETALLE,"onUpdate:modelValue":o[17]||(o[17]=function(o){return e.dataRechazo.DETALLE=o}),"float-label":"Detalle de la justificación"},null,8,["modelValue"]),(0,n.bF)(z,{class:"q-if-outlined col",type:"textarea",rows:"3",modelValue:e.dataRechazo.DETALLE_RECHAZO,"onUpdate:modelValue":o[18]||(o[18]=function(o){return e.dataRechazo.DETALLE_RECHAZO=o}),"float-label":"Motivo del "+e.dataRechazo.MOTIVO,maxlength:"250"},null,8,["modelValue","float-label"])])]}),_:1},8,["modelValue","title","labelButtonOk","cancel"]),(0,n.bF)(Y,{modelValue:e.modalAddJusitificacion,"onUpdate:modelValue":o[31]||(o[31]=function(o){return e.modalAddJusitificacion=o}),title:"Agregar Justificacion",onSubmit:e.saveModal},{default:(0,n.k6)(function(){return[(0,n.Lk)("div",C,[(0,n.Lk)("div",v,[(0,n.bF)(q,{class:"q-if-outlined col",options:e.nivelesAdd,modelValue:e.infoAdd.instrucod,"onUpdate:modelValue":o[21]||(o[21]=function(o){return e.infoAdd.instrucod=o}),"float-label":"Nivel",onInput:e.obtenerAlunosModal},null,8,["options","modelValue","onInput"]),(0,n.bF)(q,{class:"q-if-outlined col",options:e.gradosAdd,modelValue:e.infoAdd.gradocod,"onUpdate:modelValue":o[22]||(o[22]=function(o){return e.infoAdd.gradocod=o}),"float-label":"Grado",onInput:e.obtenerAlunosModal},null,8,["options","modelValue","onInput"]),(0,n.bF)(q,{class:"q-if-outlined col",options:e.seccionesAdd,modelValue:e.infoAdd.seccioncod,"onUpdate:modelValue":o[23]||(o[23]=function(o){return e.infoAdd.seccioncod=o}),"float-label":"Sección",onInput:e.obtenerAlunosModal},null,8,["options","modelValue","onInput"])]),(0,n.Lk)("div",T,[(0,n.bF)(q,{class:"q-if-outlined col",filter:"",options:e.alumnos,modelValue:e.infoAdd.alucod,"onUpdate:modelValue":o[24]||(o[24]=function(o){return e.infoAdd.alucod=o}),"float-label":"Estudiante"},null,8,["options","modelValue"])]),(0,n.Lk)("div",F,[(0,n.bF)(w,{class:"q-if-outlined col",modelValue:e.infoAdd.fecIni,"onUpdate:modelValue":o[25]||(o[25]=function(o){return e.infoAdd.fecIni=o}),type:"date",format:"DD/MM/YYYY","float-label":e.$t("fechainicio")},null,8,["modelValue","float-label"]),(0,n.bF)(w,{class:"q-if-outlined col",modelValue:e.infoAdd.fecFin,"onUpdate:modelValue":o[26]||(o[26]=function(o){return e.infoAdd.fecFin=o}),type:"date",format:"DD/MM/YYYY","float-label":e.$t("fechafin")},null,8,["modelValue","float-label"])]),(0,n.Lk)("div",k,[(0,n.bF)(q,{class:"q-if-outlined col",options:e.infoEstados,modelValue:e.infoAdd.estado,"onUpdate:modelValue":o[27]||(o[27]=function(o){return e.infoAdd.estado=o}),"float-label":"Asistencia"},null,8,["options","modelValue"]),(0,n.bF)(q,{class:"q-if-outlined col",options:e.tipoJustificacion,modelValue:e.infoAdd.justificacion,"onUpdate:modelValue":o[28]||(o[28]=function(o){return e.infoAdd.justificacion=o}),"float-label":"Justificación"},null,8,["options","modelValue"])]),(0,n.Lk)("div",I,[(0,n.bF)(z,{class:"q-if-outlined col",type:"textarea",modelValue:e.infoAdd.detalleJustificacion,"onUpdate:modelValue":o[29]||(o[29]=function(o){return e.infoAdd.detalleJustificacion=o}),"float-label":"Detalle",rows:"3"},null,8,["modelValue"])]),(0,n.bF)($,{class:"q-mx-sm",onUpload:e.addFile,icon:"file",modelValue:e.infoAdd.dataArchivo,"onUpdate:modelValue":o[30]||(o[30]=function(o){return e.infoAdd.dataArchivo=o}),onlyButton:!0,preview:!0,title:"Subir Archivos"},null,8,["onUpload","modelValue"])])]}),_:1},8,["modelValue","onSubmit"]),(0,n.bF)(Y,{modelValue:e.modalConfig,"onUpdate:modelValue":o[34]||(o[34]=function(o){return e.modalConfig=o}),title:"Configuración de Justificaciones",ok:!1},{footerMobile:(0,n.k6)(function(){return[(0,n.bF)(y,{flat:"",dense:"",round:"",icon:"save",onClick:e.saveAlertas},null,8,["onClick"])]}),postButtonFooter:(0,n.k6)(function(){return[(0,n.bF)(y,{label:"guardar",onClick:e.saveAlertas,color:"primary"},null,8,["onClick"])]}),default:(0,n.k6)(function(){return[(0,n.bF)(G,{class:"col",type:"outlined",modelValue:e.modalState,"onUpdate:modelValue":o[32]||(o[32]=function(o){return e.modalState=o}),label:"ESTADODES",val:"ESTADOCOD",options:e.estadosNoJus,placeholder:"estado"},null,8,["modelValue","options"]),(0,n.bF)(Q,{modelValue:e.tabSelectConfig,"onUpdate:modelValue":o[33]||(o[33]=function(o){return e.tabSelectConfig=o}),animated:"",inverted:""},{title:(0,n.k6)(function(){return[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.tabsConfig,function(e,o){return(0,n.uX)(),(0,n.Wv)(P,{key:e.value,name:e.label,label:e.label,modelValue:e.value},null,8,["name","label","modelValue"])}),128))]}),_:1},8,["modelValue"]),"Alerta"===e.tabSelectConfig?((0,n.uX)(),(0,n.Wv)(ee,{key:0,class:"q-ma-sm"},{default:(0,n.k6)(function(){return[(0,n.bF)(X,{class:"q-list-header text-primary"},{default:(0,n.k6)(function(){return[(0,n.bF)(B,{class:"text-primary"},{default:(0,n.k6)(function(){return i()(o[43]||(o[43]=[(0,n.Lk)("span",null,"Estado",-1)]))}),_:1}),(0,n.bF)(x,null,{default:(0,n.k6)(function(){return i()(o[44]||(o[44]=[(0,n.Lk)("span",null,"Perfil",-1)]))}),_:1})]}),_:1}),(0,n.bF)(Z,{class:"tabla-tamano"},{default:(0,n.k6)(function(){return[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.perfilesAlertas[e.modalState],function(e,o){return(0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.bF)(X,null,{default:(0,n.k6)(function(){return[(0,n.bF)(B,null,{default:(0,n.k6)(function(){return[(0,n.bF)(W,{modelValue:e.ESTADO,"onUpdate:modelValue":function(o){return e.ESTADO=o}},null,8,["modelValue","onUpdate:modelValue"])]}),_:2},1024),(0,n.bF)(x,null,{default:(0,n.k6)(function(){return[(0,n.Lk)("span",null,(0,l.v_)(e.TIPNOM),1)]}),_:2},1024)]}),_:2},1024),(0,n.bF)(K)],64)}),256))]}),_:1})]}),_:1})):((0,n.uX)(),(0,n.Wv)(ee,{key:1,class:"q-ma-sm"},{default:(0,n.k6)(function(){return[(0,n.bF)(X,{class:"q-list-header text-primary"},{default:(0,n.k6)(function(){return[(0,n.bF)(B,{class:"text-primary"},{default:(0,n.k6)(function(){return i()(o[45]||(o[45]=[(0,n.Lk)("span",null,"Estado",-1)]))}),_:1}),(0,n.bF)(x,null,{default:(0,n.k6)(function(){return i()(o[46]||(o[46]=[(0,n.Lk)("span",null,"Perfil",-1)]))}),_:1})]}),_:1}),(0,n.bF)(Z,{class:"tabla-tamano"},{default:(0,n.k6)(function(){return[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.perfilesPermisos[e.modalState],function(e,o){return(0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.bF)(X,null,{default:(0,n.k6)(function(){return[(0,n.bF)(B,null,{default:(0,n.k6)(function(){return[(0,n.bF)(W,{modelValue:e.ESTADO,"onUpdate:modelValue":function(o){return e.ESTADO=o}},null,8,["modelValue","onUpdate:modelValue"])]}),_:2},1024),(0,n.bF)(x,null,{default:(0,n.k6)(function(){return[(0,n.Lk)("span",null,(0,l.v_)(e.TIPNOM),1)]}),_:2},1024)]}),_:2},1024),(0,n.bF)(K)],64)}),256))]}),_:1})]}),_:1}))]}),_:1},8,["modelValue"]),(0,n.bF)(Y,{modelValue:e.modalCierre,"onUpdate:modelValue":o[37]||(o[37]=function(o){return e.modalCierre=o}),title:"Cierre de Justificaciones",onSubmit:e.grabarCierre},{default:(0,n.k6)(function(){return[(0,n.Lk)("div",M,[(0,n.Lk)("div",V,[(0,n.bF)(oe,{class:"col",modelValue:e.filtrarCierre,"onUpdate:modelValue":o[35]||(o[35]=function(o){return e.filtrarCierre=o}),label:"Filtrar"},{append:(0,n.k6)(function(){return[(0,n.bF)(_,{name:"search"})]}),_:1},8,["modelValue"]),(0,n.bF)(ae,{class:"col-4",modelValue:e.mesSeleccionado,"onUpdate:modelValue":o[36]||(o[36]=function(o){return e.mesSeleccionado=o}),options:e.meses,"option-value":"MESCOD","option-label":"MESDES",label:"Mes",onInput:e.marcarMes},null,8,["modelValue","options","onInput"])]),e.cargandoCierre?(0,n.Q3)("v-if",!0):((0,n.uX)(),(0,n.Wv)(te,{key:0,class:"q-mt-xs",dense:"",flat:"",bordered:"","wrap-cells":"",css:"height: calc(100vh - 380px)","show-search":!1,context:a,columns:e.columnsBloqueo,data:e.justificacionesBloq,config:e.configBloqueo},null,8,["columns","data","config"]))])]}),_:1},8,["modelValue","onSubmit"])]}),_:1})}var q=a(76080),L=a.n(q),w=a(45254),y=a.n(w),U=(a(10239),a(56285),a(50310),a(90095),a(92802),a(515),a(83190),a(27153),a(52776),a(81813),a(13715),a(83972)),J=a(6123),_=a(96122),H=a(30545),N=a(62006),j=a(88275),z=a(13813),Y=a(80660),$=a(57668),G=a(80340),P=a(34858),Q=a(51082),B=a(69027),x=a(2819),X=a(30640),W=a(93616),K=a(24974),Z=a(65818),ee=a(78131),oe=a(18105),ae=a(982),te=a(33001),ie=a(59089),ne=a(33950),le=a(9736),se=a(16648),ce=a(33777),ue={setup:function(){var e=(0,U.fG)();return{v$:e}},components:{SieTable:ce.A,sieSalones:j.Ay,QSelect:J.Si,sieUsuario:K.A,sieModal:X.A,sieVacio:G.A,QToggle:J.c5,QCheckbox:J.vZ,QBtnToggle:J.QL,sieSelect:W.A,QRadio:J.$,QClock:Z.A,QTable:H.A,QTh:J.EJ,QTr:J.qh,QTd:J.Ef,QTableColumns:J.$s,virtualList:P.Ay,QPopupEdit:J.GT,QChip:J.wQ,sieDate:Q.A,QFabAction:J.B$,QPageSticky:J._U,QFab:J.l6,QDatetime:J.T5,QDownloadFile:N.A,sieUpload:ie.A,QScrollArea:_.A,QTabs:J.uw,QTab:J.zu,QTabPane:J.dg,QInput1:le.A,QSelect1:se.A,QPage:J.Tu,QSearch:J.Ks,QBtn:J.Il,QTooltip:J.nC,QIcon:J.bP,QInput:J.ie,QList:J.Mb,QItem:J.H0,QItemSide:J.n1,QItemMain:J.mF,QItemSeparator:J.CL},data:function(){return{cargandoCierre:!1,sie:(0,$["default"])(),nemo:null,modalRechazar:!1,data:[],filtros:{fIni:new Date,fFin:new Date,nemo:"T",estados:["P"],alumno:null,modo:"J"},baseGrados:{},instrucod:"T",gradocod:"T",seccioncod:"T",preData:[],estadoAsistencia:{},justificaciones:[],justificacionesBloq:[],filtrarCierre:null,modalCierre:!1,justificacionesOG:{},mesSeleccionado:null,meses:[],listSelect:[],tabsConfig:[{value:"alerta",label:"Alerta"},{value:"permiso",label:"Permisos"}],tabSelectConfig:"Alerta",estados:{P:{titulo:"Pendiente",abr:"Pen",color:"#ffa50021"},A:{titulo:"Aceptado",abr:"Acep",color:"#0080002b"},R:{titulo:"Rechazado",abr:"Rech",color:"#ff000030"}},modoBusqueda:1,alumnos:[],columnsBloqueo:[{name:"NEMODES",label:"Aula",field:"NEMODES",align:"left",sortable:!0},{name:"MESCOD",label:"Mes cierre",field:"MESCOD",align:"center",sortable:!0}],columns:[{name:"NOMCOMP",label:"Estudiante",field:"NOMCOMP",align:"left",sortable:!0},{name:"NEMODES",label:"Salón",field:"NEMODES",align:"left",sortable:!0},{name:"FECHAMOD",label:"F. Asistencia",field:"FECHAMOD",align:"left",sortable:!0},{name:"FH_REGISTRO",label:"F. Justificacion",field:"FH_REGISTRO",align:"left",sortable:!0},{name:"ESTADO",label:"Estado",field:"ESTADO",align:"center",sortable:!0},{name:"SECUDES",label:"Justificación",field:"SECUDES",align:"center",sortable:!0},{name:"NOMBRE_ARCHIVO",label:"Archivo",field:"NOMBRE_ARCHIVO",align:"left",sortable:!0},{name:"DETALLE",label:"Detalle",field:"DETALLE",align:"left",sortable:!0}],modoFiltro:[{label:"F. Justificacion",value:"J"},{label:"F. Asistencia",value:"A"}],modo:"J",estadoJustificacion:[{label:"Pendiente",value:"P"},{label:"Aceptado",value:"A"},{label:"Rechazado",value:"R"}],dataRechazo:{},tipoJustificacion:[],modalAddJusitificacion:!1,infoEstados:[],modalConfig:!1,configuracion:{},configuracionJustificaciones:{},siNo:[{label:"Si",value:1},{label:"No",value:0}],infoAdd:{instrucod:null,gradocod:null,seccioncod:null,alucod:null,fecIni:new Date,fecFin:new Date,estado:null,justificacion:null,detalleJustificacion:null,dataArchivo:{},alto:""},showConfigParams:!1,tabSelect:"A",perfilesAlertas:{},perfilesPermisos:{},estadosNoJus:[],modalState:null}},methods:{date:oe.Ay,grabarCierre:function(){var e=this;return y()(L()().m(function o(){var a,t;return L()().w(function(o){while(1)switch(o.p=o.n){case 0:if(a={add:[],del:[],upd:[]},e.justificacionesBloq.forEach(function(e){e.ID?e.MESCOD&&null!==e.MESCOD?e.MESCODORIG!==e.MESCOD&&a.upd.push({ID:e.ID,MESCOD:e.MESCOD}):a.del.push({ID:e.ID}):e.MESCOD&&null!==e.MESCOD&&a.add.push({NEMO:e.NEMO,MESCOD:e.MESCOD})}),!(a.add.length>0||a.del.length>0||a.upd.length>0)){o.n=5;break}return o.n=1,e.$confirmar("Está seguro de guardar la información");case 1:if(t=o.v,!t){o.n=5;break}return o.p=2,o.n=3,e.$http.post("api/JustificacionController/saveJustificacionCierre",a);case 3:e.$notify("Grabado Correctamente"),e.modalCierre=!1,o.n=5;break;case 4:o.p=4,o.v;case 5:return o.a(2)}},o,null,[[2,4]])}))()},handleResize:function(){this.alto=window.innerHeight-305},cargaInicial:function(){var e=this;return y()(L()().m(function o(){return L()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,Y.$http.get("api/HyoConfigurajustificaciones/getJustificaciones",{params:{agrupado:!0}});case 1:e.configuracionJustificaciones=o.v,Y.$http.get("api/HyoJustificacionasistencias/getJustificacionesFecha",{params:e.filtros}).then(function(o){e.listSelect=[],o.forEach(function(e){e.FECHAMOD=(0,oe.Ay)(e.FECHA,"DD/MM/YYYY"),e.FECREGMOD=(0,oe.Ay)(e.FECREG,"DD/MM/YYYY HH:mm")}),e.preData=o,e.filtrar()});case 2:return o.a(2)}},o)}))()},tipBusqueda:function(e){this.modoBusqueda=e,this.filtrar()},addFile:function(e){var o=this;this.cerrarModal=!0,this.infoAdd.dataArchivo={},(0,ne.Upload)({url:"api/HyoArchivo/tmp/upload",file:e[0]}).then(function(e){o.infoAdd.dataArchivo.file=e}).catch(function(){})},saveModal:function(){var e=this;if(this.infoAdd.alucod)if(this.infoAdd.estado)if(this.infoAdd.justificacion)if(this.infoAdd.detalleJustificacion)if(!this.infoAdd.dataArchivo.file&&this.configuracionJustificaciones.ADJUNTO_OBLIGATORIO)(0,ae["default"])("Debe subir un archivo","error");else{var o={TIPJUSCOD:this.infoAdd.justificacion,ASISTENCIA:this.infoAdd.estado,ALUCOD:this.infoAdd.alucod,DETALLE:this.infoAdd.detalleJustificacion,ESTADO:"A",fecFin:this.infoAdd.fecFin,fecIni:this.infoAdd.fecIni};this.infoAdd.dataArchivo.file&&(o.nombreTemporal=this.infoAdd.dataArchivo.file.name,o.ARCHIVO=this.infoAdd.dataArchivo.file.originalFilename.replace(/ /g,"_")),Y.$http.post("api/HyoJustificacionasistencias/saveJustificacionAnticipada",{data:o}).then(function(a){"Ok"===a.json&&(o.listFechas=a.fechas,o.NEMO=a.NEMO,Y.$http.post("api/HyoJustificacionasistencias/grabaInformacion",{data:o}).then(function(o){var a=o.json;"Ok"===a&&((0,ae["default"])(e.$t("mensajes.m0001")),e.modalAddJusitificacion=!1,e.cargaInicial())}))})}else(0,ae["default"])("Seleccione un Detalle para la justificación","error");else(0,ae["default"])("Seleccione un tipo de justificación","error");else(0,ae["default"])("Seleccione un estado de asistencia","error");else(0,ae["default"])("Seleccione un Estudiante de la lista","error")},filtrar:function(){var e=this,o=i()(this.preData);switch(this.modoBusqueda){case 1:"T"!==this.filtros.nemo&&(o=(0,te.filterArray)(this.filtros.nemo,{field:"NEMO",list:o||[]}));break;case 2:if("T"!==this.instrucod){var a=[];o.forEach(function(o){var t=0;(o.INSTRUCOD!==e.instrucod||"T"!==e.gradocod&&(o.GRADOCOD!==e.gradocod||"T"!==e.seccioncod&&o.SECCIONCOD!==e.seccioncod))&&(t=1),0===t&&a.push(o)}),o=a}break}3!==this.filtros.estados.length&&(o=(0,te.filterArray)(this.filtros.estados,{field:"ESTADO",list:o||[]})),this.data=i()(o)},imprimir:function(e){var o=this.sie.api+"/HyoWjustifica/descargar/"+e.ALUCOD+"/"+e.FECHA+"?access_token="+this.sie.token;(0,ee["default"])(o,e.ARCHIVO)},imprimirReporte:function(){var e="intranet/reporte-node/reporte",o={repcod:"newListadoJustificaciones",fecini:(0,oe.Ay)(this.filtros.fIni,"DD/MM/YYYY"),fecfin:(0,oe.Ay)(this.filtros.fFin,"DD/MM/YYYY"),chkestjus:this.filtros.estados,modoBusqueda:this.modoBusqueda,formato:"pdf",alumno:this.filtros.alumno};1===this.modoBusqueda?o.nemo=this.filtros.nemo:"T"!==this.instrucod&&(o.instrucod=this.instrucod,"T"!==this.gradocod&&(o.gradocod=this.gradocod)),(0,B.dialogConfirm)({message:"Seleccione el formato de impresion",cancel:"PDF",ok:"Excel"}).then(function(a){a?(o.formato="xlsx",(0,x["default"])(o,e,"Reporte ")):(0,x["default"])(o,e,"Reporte ")})},procesarData:function(){var e=this;return new Promise(function(o,a){var t=[];e.listSelect.forEach(function(e){var o=e.FECHAS,a=e.NOMCOMP,i=e.ESTADO,n=e.DETALLE_RECHAZO,l=e.FAMDES,s=e.USUCODFAM,c=e.ID,u=e.SEXO,r=[];if("P"===i){var d={NOMCOMP:a,ESTADO:i,DETALLE_RECHAZO:n,FAMDES:l,USUCODFAM:s,ID:c,SEXO:u};o.forEach(function(e){var o=e.ID_CONTROL,a=e.NEMO,t=e.ALUCOD,i=e.ESTADOCOD,n=e.ESTJUSCOD,l=e.ESTADODES,s=e.FECHA;r.push({ID_CONTROL:o,NEMO:a,ALUCOD:t,ESTADOCOD:i,ESTJUSCOD:n,ESTADODES:l,FECHA:s})}),d["FECHAS"]=r,t.push(d)}}),o(t)})},revertirJustificacion:function(){var e=this,o=[],a="P";this.listSelect.forEach(function(e){"P"!==e.ESTADO&&o.push({ID:e.ID,DETALLE_RECHAZO:""})}),o.length>0?(0,B.dialogConfirm)({title:this.$t("confirmacion"),message:this.$t("mensajes.m0007")}).then(function(t){t&&Y.$http.post("api/HyoJustificacionasistencias/modifyState",{lista:o,estado:a}).then(function(o){(0,ae["default"])(e.$t("mensajes."+o)),e.cargaInicial()})}):(0,ae["default"])("El estado de la justificacion debe ser pendiente o aceptado","error")},aceptarJus:function(){var e=this,o="A";this.procesarData().then(function(a){(0,B.dialogConfirm)({title:e.$t("confirmacion"),message:e.$t("mensajes.m0007")}).then(function(t){t&&Y.$http.post("api/HyoJustificacionasistencias/modifyState",{lista:a,estado:o}).then(function(o){(0,ae["default"])(e.$t("mensajes."+o)),e.cargaInicial()})})})},aceptar:function(){1===this.listSelect.length?this.openModalRechazar(!0):this.listSelect.length>1&&this.aceptarJus()},openModalRechazar:function(e){e=!0===e;var o=this.listSelect,a=e?"aceptar":"rechazar";o.length>1?(0,ae["default"])("Solo puede ".concat(a," un registro a la vez"),"error"):"P"===o[0].ESTADO&&(this.dataRechazo={},this.dataRechazo=o[0],this.dataRechazo.DETALLE_RECHAZO=null,this.dataRechazo.TIPO=e?"Aceptar":"Rechazar",this.dataRechazo.MOTIVO=e?"Aceptación":"Rechazo",this.dataRechazo.MODO=e,this.modalRechazar=!0,this.dataRechazo.FH_JUSTIFICA=(0,oe.Ay)(o[0].FH_REGISTRO,"DD/MM/YYYY"))},eliminarJus:function(){var e=this;this.procesarData().then(function(o){o.length>0?(0,B.dialogConfirm)({title:e.$t("mensajes.m0006.confirmacion"),message:e.$t("mensajes.m0010")}).then(function(a){a&&Y.$http.post("api/HyoJustificacionasistencias/deleteJustificacion",{lista:o}).then(function(o){o.json;(0,ae["default"])(e.$t("mensajes.m0006.ok")),e.cargaInicial()})}):(0,B.dialogConfirm)({title:"¡Atención!",message:"Solo se pueden eliminar justificaciones pendientes",cancel:!1})})},rechazarJustificacion:function(e){var o=this;if(this.v$.dataRechazo.$touch(),!this.v$.$invalid){var a=e?"A":"R";this.procesarData().then(function(e){console.log(e)}),Y.$http.post("api/HyoJustificacionasistencias/modifyState",{lista:[this.dataRechazo],estado:a}).then(function(e){(0,ae["default"])(o.$t("mensajes."+e)),o.cargaInicial(),o.modalRechazar=!1})}},addJustificacion:function(){this.infoAdd={instrucod:"T",gradocod:"T",seccioncod:"T",alucod:null,fecIni:new Date,fecFin:new Date,estado:null,justificacion:null,detalleJustificacion:null,dataArchivo:{}},this.modalAddJusitificacion=!0,this.obtenerAlunosModal()},devuelveUrl:function(e){var o=e.ID,a=this.sie.api+"/HyoJustificacionasistencias/descargar/"+o+"?access_token="+this.sie.token;return a},obtenerAlunosModal:function(){var e=this;this.infoAdd.alucod=null;var o=this.infoAdd;this.infoAdd.instrucod&&this.infoAdd.gradocod&&this.infoAdd.seccioncod?Y.$http.get("api/HyoSalonAl/getAlumnosNGSTutor",{params:o}).then(function(o){e.alumnos=(0,z["default"])(o,function(e){var o=e.NOMCOMP,a=e.ALUCOD;return{label:o,value:a}})}):(this.alumnos=[],this.infoAdd.alucod=null)},configurarJustificaciones:function(){var e=this;this.tabSelect=["SIE","SIEWEB"].indexOf((0,$["default"])().usucod)>=0?"C":"A",Y.$http.get("api/HyoJustificanotificaciones/getConfig").then(function(o){var a=o.data,t=o.estados;e.perfilesAlertas=a,e.modalConfig=!0,e.estadosNoJus=t,e.modalState=t[0].ESTADOCOD}),Y.$http.get("api/HyoJustificacionpermisos/getConfig").then(function(o){e.perfilesPermisos=o})},saveAlertas:function(){var e=this,o={add:[],del:[]},a="Alerta"===this.tabSelectConfig?"perfilesAlertas":"perfilesPermisos",t="Alerta"===this.tabSelectConfig?"HyoJustificanotificaciones":"HyoJustificacionpermisos";Object.keys(this[a]).forEach(function(t){e[a][t].forEach(function(e){var a=e.ESTADO,t=e.TIPCOD,i=e.ID,n=e.ESTADOCOD;a?i||o.add.push({TIPCOD:t,ESTADOCOD:n}):i&&o.del.push(i)})}),0===o.add.length&&0===o.del.length?(0,ae["default"])("No hay cambios por guardar","error"):Y.$http.post("api/".concat(t,"/saveConfig"),{info:o}).then(function(o){(0,ae["default"])("Guardado Correctamente"),e.modalConfig=!1,e.cargaInicial()}).catch(function(){(0,ae["default"])("no se pudo guardar la informacion","error")})},openModalCierre:function(){var e=this;return y()(L()().m(function o(){return L()().w(function(o){while(1)switch(o.n){case 0:return e.cargandoCierre=!0,o.n=1,e.$http.get("api/JustificacionController/getJustificacion");case 1:e.justificaciones=o.v,e.justificacionesBloq=[],e.justificaciones.forEach(function(e){e.MESCOD=e.MESCODORIG}),e.mesSeleccionado=null,e.modalCierre=!0,e.filtrarCierre=null,e.filtrarBloqueo();case 2:return o.a(2)}},o)}))()},filtrarBloqueo:function(){var e=this;return y()(L()().m(function o(){var a;return L()().w(function(o){while(1)switch(o.n){case 0:if(a={},!(e.filtrarCierre&&e.filtrarCierre.length>0)){o.n=2;break}return o.n=1,(0,te.filterArray)(String(e.filtrarCierre).toLowerCase(),{field:"NEMODES",list:e.justificaciones||[]});case 1:e.justificacionesBloq=o.v,o.n=4;break;case 2:return o.n=3,i()(e.justificaciones);case 3:e.justificacionesBloq=o.v;case 4:e.justificacionesBloq.forEach(function(e){a[e.MESCOD]?a[e.MESCOD]++:a[e.MESCOD]=1}),e.mesSeleccionado=Object.keys(a).reduce(function(e,o){return a[e]>a[o]?e:o}),e.cargandoCierre=!1;case 5:return o.a(2)}},o)}))()},marcarMes:function(){var e=this;this.justificacionesBloq.forEach(function(o){o.MESCOD=e.mesSeleccionado})}},computed:{niveles:function(){var e=[{label:"Todos",value:"T"}];return this.baseGrados.niveles&&this.baseGrados.niveles.length>0&&this.baseGrados.niveles.forEach(function(o){e.push({value:o.INSTRUCOD,label:o.INSTRUDES})}),e},grados:function(){var e=[{label:"Todos",value:"T"}];return"T"!==this.instrucod&&this.baseGrados.grados&&this.baseGrados.grados[this.instrucod].length>0&&this.baseGrados.grados[this.instrucod].forEach(function(o){e.push({value:o.GRADOCOD,label:o.GRADODES})}),e},secciones:function(){var e=[{label:"Todos",value:"T"}];return"T"===this.gradocod&&(this.seccioncod="T"),"T"!==this.instrucod&&"T"!==this.gradocod&&this.baseGrados.secciones&&this.baseGrados.secciones[this.instrucod+this.gradocod].length>0&&this.baseGrados.secciones[this.instrucod+this.gradocod].forEach(function(o){e.push({value:o.SECCIONCOD,label:o.SECCIONCOD})}),e},nivelesAdd:function(){var e=[{label:"Todos",value:"T"}];return this.infoAdd.gradocod="T",this.baseGrados.niveles&&this.baseGrados.niveles.length>0&&this.baseGrados.niveles.forEach(function(o){e.push({value:o.INSTRUCOD,label:o.INSTRUDES})}),e},gradosAdd:function(){var e=[{label:"Todos",value:"T"}];return this.infoAdd.instrucod&&"T"!==this.infoAdd.instrucod&&this.baseGrados.grados&&this.baseGrados.grados[this.infoAdd.instrucod].length>0&&this.baseGrados.grados[this.infoAdd.instrucod].forEach(function(o){e.push({value:o.GRADOCOD,label:o.GRADODES})}),e},seccionesAdd:function(){var e=[{label:"Todos",value:"T"}];return this.infoAdd.seccioncod="T",this.infoAdd.instrucod&&"T"!==this.infoAdd.instrucod&&this.infoAdd.gradocod&&"T"!==this.infoAdd.gradocod&&this.baseGrados.secciones&&this.baseGrados.secciones[this.infoAdd.instrucod+this.infoAdd.gradocod].length>0&&this.baseGrados.secciones[this.infoAdd.instrucod+this.infoAdd.gradocod].forEach(function(o){e.push({value:o.SECCIONCOD,label:o.SECCIONCOD})}),e},maxLista:function(){var e=this.alto-200;return e/20},buttons:function(){var e=[{label:"Imprimir",icon:"print",click:this.imprimirReporte}];return 3===this.sie.ruta.nivel&&(e.unshift({label:"Agregar",icon:"add",click:this.addJustificacion}),["001"].indexOf(this.sie.tipcod)>=0&&(e.unshift({label:"Cierre",icon:"lock",click:this.openModalCierre}),e.unshift({label:"Configurar",icon:"cogs",click:this.configurarJustificaciones}))),this.listSelect.length>0&&3===this.sie.ruta.nivel&&(e.unshift({label:"Aceptar",icon:"done_all",click:this.aceptar}),1===this.listSelect.length&&e.unshift({label:"Rechazar",icon:"call_missed",click:this.openModalRechazar}),e.unshift({label:"Eliminar",icon:"delete",click:this.eliminarJus}),this.sie.esAdministrador&&e.unshift({label:"Revertir",icon:"undo",click:this.revertirJustificacion})),e},configBloqueo:function(){return{MESCOD:{component:"select",options:this.meses,optionValue:"MESCOD",optionLabel:"MESDES",edit:!0}}}},unmounted:function(){window.removeEventListener("resize",this.handleResize)},validations:function(){var e=this.dataRechazo,o={dataRechazo:{DETALLE_RECHAZO:{required:!e.MODO}}};return o},watch:{filtrarCierre:function(){this.filtrarBloqueo()},"infoAdd.instrucod":function(e){this.infoAdd.gradocod=null,this.infoAdd.seccioncod=null,this.alumnos=[],this.infoAdd.alucod=null},"this.infoAdd.gradocod":function(e){this.infoAdd.seccioncod=null,this.alumnos=[],this.infoAdd.alucod=null}},created:function(){var e=this;return y()(L()().m(function o(){return L()().w(function(o){while(1)switch(o.n){case 0:return o.n=1,e.$http.get("api/MesesController/getMeses");case 1:e.meses=o.v,e.meses.unshift({MESCOD:null,MESDES:"Ninguno"}),window.addEventListener("resize",e.handleResize),e.handleResize(),Y.$http.get("api/HyoHorasisEstado/listarHorasisEstadoConducta",{params:{soloInjustificada:!0}}).then(function(o){var a=o.json;e.infoEstados=(0,z["default"])(a,function(e){return{label:e.ESTADODES,value:e.ESTADOCOD}})}),Y.$http.get("api/HyoInstrus/obtGradosAsignadosTutor").then(function(o){e.baseGrados=o}),Y.$http.get("api/HyoTablaSe/obtArrayDatos",{params:{princods:["tJustificacion"],objOrden:{campos:"SECUDES",orden:"asc"}}}).then(function(o){var a=o.json;e.tipoJustificacion=(0,z["default"])(a.tJustificacion,function(e){var o=e.SECUCOD,a=e.SECUDES;return{label:a,value:o}})}),Y.$http.get("api/HyoHorasisEstado/listarHorasisEstado",{params:{momento:1}}).then(function(o){var a=o.json;a.forEach(function(o){e.estadoAsistencia[o.ESTADOCOD]={},e.estadoAsistencia[o.ESTADOCOD].color=o.COLORHEXF,e.estadoAsistencia[o.ESTADOCOD].etk=o.ESTADOETI,e.estadoAsistencia[o.ESTADOCOD].descripcion=o.ESTADODES}),e.cargaInicial()});case 2:return o.a(2)}},o)}))()}},re=a(12807);const de=(0,re.A)(ue,[["render",R]]);var fe=de}}]);