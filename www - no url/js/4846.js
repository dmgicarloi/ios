"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[4846],{4846:function(e,n,o){o.r(n),o.d(n,{default:function(){return y}});var r=o(61758),t={class:"row q-pa-sm q-col-gutter-sm"},i={class:"col-xs-12 col-sm-2"},a={class:"col-xs-12 col-sm-3"},s={class:"col-xs-12 col-sm-5"},c={class:"col-xs-12 col-sm-2"},u={class:"col-xs-12 col-sm-3"},l={key:0,class:"col-xs-12 col-sm-3"},f={key:1,class:"col-xs-12 col-sm-3"};function m(e,n){var o=this,m=(0,r.g2)("header-btn"),d=(0,r.g2)("q-select"),p=(0,r.g2)("q-search"),h=(0,r.g2)("q-checkbox"),O=(0,r.g2)("q-d"),b=(0,r.g2)("q-card-section"),g=(0,r.g2)("q-separator"),I=(0,r.g2)("sie-table"),w=(0,r.g2)("q-card"),E=(0,r.g2)("q-page");return(0,r.uX)(),(0,r.Wv)(E,{class:"q-pa-xs exalumnos-inscripciones sie-flat"},{default:(0,r.k6)(function(){return[(0,r.bF)(w,null,{default:(0,r.k6)(function(){return[(0,r.bF)(m,{name:"Inscripciones",buttons:e.buttons},null,8,["buttons"]),(0,r.bF)(b,null,{default:(0,r.k6)(function(){return[(0,r.Lk)("div",t,[(0,r.Lk)("div",i,[(0,r.bF)(d,{modelValue:e.frm.anioPromocion,"onUpdate:modelValue":n[0]||(n[0]=function(n){return e.frm.anioPromocion=n}),optionValue:"ANIO",optionLabel:"ANIO",options:e.promocionesUsuario,label:"Año de egreso",onInput:n[1]||(n[1]=function(n){return e.getInscripcionesAno()})},null,8,["modelValue","options"])]),(0,r.Lk)("div",a,[(0,r.bF)(d,{modelValue:e.frm.promocion,"onUpdate:modelValue":n[2]||(n[2]=function(n){return e.frm.promocion=n}),optionValue:"ID_PROMOCION",optionLabel:"NOMBRE",options:e.promocionesUsuario,label:"Promoción",onInput:n[3]||(n[3]=function(n){return e.getInscripcionesPromocion()})},null,8,["modelValue","options"])]),(0,r.Lk)("div",s,[(0,r.bF)(p,{class:"q-if-outlined",modelValue:e.frm.nombre,"onUpdate:modelValue":n[4]||(n[4]=function(n){return e.frm.nombre=n}),onInput:e.buscarNombre},null,8,["modelValue","onInput"])]),(0,r.Lk)("div",c,[(0,r.bF)(d,{modelValue:e.frm.estado,"onUpdate:modelValue":n[5]||(n[5]=function(n){return e.frm.estado=n}),options:e.estados,label:"Estado",onInput:n[6]||(n[6]=function(n){return e.getInscripciones()})},null,8,["modelValue","options"])]),(0,r.Lk)("div",u,[(0,r.bF)(h,{modelValue:e.frm.rangoFecha,"onUpdate:modelValue":n[7]||(n[7]=function(n){return e.frm.rangoFecha=n}),label:"Rango Fechas",onInput:n[8]||(n[8]=function(n){return e.checkRango()})},null,8,["modelValue"])]),e.frm.rangoFecha?((0,r.uX)(),(0,r.CE)("div",l,[(0,r.bF)(O,{class:"q-if-outlined",modelValue:e.frm.desde,"onUpdate:modelValue":n[9]||(n[9]=function(n){return e.frm.desde=n}),label:"Desde","float-label":"Desde",type:"date",format:"DD/MM/YYYY",onInput:n[10]||(n[10]=function(n){return e.getInscripcionesRango()})},null,8,["modelValue"])])):(0,r.Q3)("v-if",!0),e.frm.rangoFecha?((0,r.uX)(),(0,r.CE)("div",f,[(0,r.bF)(O,{class:"q-if-outlined",modelValue:e.frm.hasta,"onUpdate:modelValue":n[11]||(n[11]=function(n){return e.frm.hasta=n}),label:"Hasta","float-label":"Hasta",type:"date",format:"DD/MM/YYYY",onInput:n[12]||(n[12]=function(n){return e.getInscripcionesRango()})},null,8,["modelValue"])])):(0,r.Q3)("v-if",!0)])]}),_:1}),(0,r.bF)(g),(0,r.bF)(b,null,{default:(0,r.k6)(function(){return[(0,r.bF)(I,{data:e.rows,selection:"single",showSearch:!1,ref:"table",columns:e.fieldsInscripciones,onRowSelected:e.rowSelected,config:e.config,context:o,css:{height:"64vh"}},null,8,["data","columns","onRowSelected","config"])]}),_:1})]}),_:1})]}),_:1})}var d=o(57008),p=o.n(d),h=o(76080),O=o.n(h),b=o(45254),g=o.n(b),I=(o(71225),o(10239),o(50310),o(5962),o(515),o(83190),o(6123)),w=o(95718),E=o(53380),R=o(16648),v=o(9736),C=o(95477),S=o(4437),P=(o(30683),{data:function(){return{config:{FH_REGISTRO:{component:"datetime",edit:!1},USUCOD:{renderHtml:function(e,n){var o=e.ESTADO?e.USUCOD:"";return n("span",{},o)}},ACCION:{component:"button",icon:["edit","delete"],permisos:{delete:"=== 3"},tooltip:{edit:"Editar",delete:"Eliminar"},edit:function(e){var n=this;return g()(O()().m(function o(){return O()().w(function(o){while(1)switch(o.n){case 0:n.inscripcionSelected=e.ID_EXA_PERSONA,n.id_persona=e.ID_PERSONA,n.id_perfil=e.ID_PERFIL,n.$router.push({name:"exalumno.inscripciones.editar",params:{id:e.ID_PERSONA,perfil:e.ID_PERFIL}}),n.titulo="Edición: ".concat(e.NOMBRES_COMPLETO);case 1:return o.a(2)}},o)}))()},delete:function(e){var n=this;this.$confirm("¿Realmente desea eliminar este registro?","delete").onOk(g()(O()().m(function o(){var r,t,i,a;return O()().w(function(o){while(1)switch(o.p=o.n){case 0:return r=e.NOMBRES_COMPLETO?e.NOMBRES_COMPLETO:e.NRO_DOCUMENTO,o.p=1,o.n=2,n.$http.delete("api/personaController/deletePersona",{params:{id:e.ID_PERSONA,id_perfil:e.ID_PERFIL}});case 2:return t=o.v,i=t.message,n.$notify(i,"success"),n.frm.nombre="",o.n=3,n.getInscripciones();case 3:o.n=5;break;case 4:o.p=4,a=o.v,n.$alert("No se puede eliminar ".concat(r," : ").concat(a.message),"warning");case 5:return o.a(2)}},o,null,[[1,4]])})))},flat:!0,color:"primary",dense:!1}},rows:[],fieldsInscripciones:[{name:"PROMOCION",label:"Promoción",field:"PROMOCION",align:"left",sortable:!0},{name:"NRO_DOCUMENTO",label:"Nro. Documento",field:"NRO_DOCUMENTO",align:"left",sortable:!0},{name:"NOMBRES_COMPLETO",label:"Apellidos y Nombres",field:"NOMBRES_COMPLETO",align:"left",sortable:!0},{name:"USUCOD",label:"Usuario",field:"USUCOD",align:"left",sortable:!0},{name:"FH_REGISTRO",label:"FH. Registro",field:"FH_REGISTRO",align:"left",sortable:!0},{name:"ACCION",label:"Acciones",field:"ACCION",align:"center",width:100}]}}}),N=o(57668),_=o(30640),M=o(81288),A=o(73922),D=o(2739),F=o(50304),k=o(43926),x=o(54981),T=o(56777),U=o(41615),$={mixins:[P],components:{QCheckbox:I.vZ,QDatetime:F.A,QD:I.T5,QDate:S.A,QPopupProxy:C.A,QInput:v.A,QSelect:R.A,QSeparator:E.A,QCardSection:w.A,sieModal:_.A,QForm:D.A,multiRegistros:k.A,exalumnoInscripcion:x.A,editarExalumnos:T["default"],QPage:I.Tu,QCard:I.C$,QSearch:I.Ks},data:function(){var e=this;return{currentDatetime:new Date,frm:{rangoFecha:!1,desde:"",hasta:"",nombre:"",promocion:"",anioPromocion:"Todos",estado:0,usucod:(0,N["default"])().usucod,SISCOD_EXALUMNOS:""},sie:(0,N["default"])(),inscripcionSelected:"",id_persona:"",id_perfil:"",currentRow:{},openModalCorreo:!1,openModalTelefono:!1,openModalProfesiones:!1,openModal:!1,titulo:"",promociones:[],promocionesUsuario:[],estados:[{label:"Todos",value:0},{label:"Por aprobar",value:1},{label:"Aprobados",value:2}],tipoDoc:[],paises:[],departamentos:[],buttons:[],buttonsGrl:{pdf:{icon:"file_pdf",label:"Pdf",click:function(){e.imprimir("pdf")},permiso:">= 1"},xls:{icon:"file_excel",label:"Xls",click:function(){e.imprimir("xls")},permiso:">= 1"},person_add:{icon:"person_add",label:"Crear cuenta",click:this.crearCuenta,permiso:"=== 3"},email:{icon:"email",label:"Enviar Correo",click:this.enviarCorreo,permiso:"=== 3"},exalumno_add:{icon:"plus",label:"Agregar",click:this.addExalumno,permiso:"=== 3"},exalumno_clear:{icon:"broom",label:"Limpiar",click:this.init,permiso:">= 1"}}}},computed:{isLess:function(){return(0,M.isLess)()}},methods:{getPromocionesUsuario:function(){var e=this;return g()(O()().m(function n(){var o;return O()().w(function(n){while(1)switch(n.n){case 0:return n.n=1,e.$http.get("api/ExAlumnos/getPromocionesUsuario",{params:{usucod:e.frm.usucod}});case 1:return o=n.v,o.unshift({NOMBRE:"Todas",ID_PROMOCION:"",ANIO:"Todos"}),n.a(2,o)}},n)}))()},buscarNombre:function(e){this.$refs.table.setFilter(e)},checkRango:function(){var e=this;return g()(O()().m(function n(){return O()().w(function(n){while(1)switch(n.n){case 0:e.frm.rangoFecha?e.getInscripcionesRango():e.getInscripciones();case 1:return n.a(2)}},n)}))()},getInscripcionesRango:function(){var e=this;return g()(O()().m(function n(){return O()().w(function(n){while(1)switch(n.n){case 0:e.frm.desde&&e.frm.hasta&&e.getInscripciones();case 1:return n.a(2)}},n)}))()},getInscripciones:function(){var e=this;return g()(O()().m(function n(){return O()().w(function(n){while(1)switch(n.n){case 0:return n.n=1,e.$http.get("api/ExAlumnos/getInscripcionesPersona",{params:{data:e.frm}});case 1:e.rows=n.v;case 2:return n.a(2)}},n)}))()},getInscripcionesPromocion:function(){var e=this;return g()(O()().m(function n(){var o;return O()().w(function(n){while(1)switch(n.n){case 0:if(e.frm.promocion){n.n=1;break}return n.a(2,!1);case 1:o=e.promocionesUsuario.filter(function(n){return n.ID_PROMOCION===e.frm.promocion}),e.frm.anioPromocion=o.length?o[0].ANIO:"",e.getInscripciones();case 2:return n.a(2)}},n)}))()},getInscripcionesAno:function(){var e=this;return g()(O()().m(function n(){var o;return O()().w(function(n){while(1)switch(n.n){case 0:if(e.frm.anioPromocion){n.n=1;break}return n.a(2,!1);case 1:o=e.promocionesUsuario.filter(function(n){return n.ANIO===e.frm.anioPromocion}),e.frm.promocion=o.length?o[0].ID_PROMOCION:"",e.getInscripciones();case 2:return n.a(2)}},n)}))()},grabarDatos:function(){var e=this;return g()(O()().m(function n(){var o;return O()().w(function(n){while(1)switch(n.n){case 0:return e.$refs.refEditarPersona.guardar(),n.n=1,e.$refs.formInscripcion.guardarInscripcion();case 1:if(o=n.v,!o){n.n=2;break}return e.$notify(o,"success"),e.openModal=!1,n.n=2,e.getInscripciones();case 2:return n.a(2)}},n)}))()},init:function(){var e=this;return g()(O()().m(function n(){return O()().w(function(n){while(1)switch(n.n){case 0:return e.frm={rangoFecha:!1,desde:"",hasta:"",nombre:"",promocion:"",anioPromocion:"Todos",estado:0,usucod:(0,N["default"])().usucod,SISCOD_EXALUMNOS:""},e.currentRow={},e.rowSelected(e.currentRow),n.n=1,e.getInscripciones();case 1:e.$refs.table.setFilter("");case 2:return n.a(2)}},n)}))()},rowSelected:function(e){var n=this;return g()(O()().m(function o(){return O()().w(function(o){while(1)switch(o.n){case 0:n.buttons=[n.buttonsGrl.pdf,n.buttonsGrl.xls],n.currentRow=e,Object.keys(n.currentRow).length>0?0===n.currentRow.ESTADO?n.buttons.push(n.buttonsGrl.person_add):n.buttons.push(n.buttonsGrl.email):n.buttons.push(n.buttonsGrl.exalumno_add),n.buttons.push(n.buttonsGrl.exalumno_clear);case 1:return o.a(2)}},o)}))()},crearCuenta:function(){var e=this;return g()(O()().m(function n(){var o,r;return O()().w(function(n){while(1)switch(n.p=n.n){case 0:if(1!==e.currentRow.ESTADO){n.n=1;break}return e.$notify("".concat(e.currentRow.NOMBRES_COMPLETO,", Tiene una cuenta creada"),"warning"),n.a(2,!1);case 1:return n.p=1,n.n=2,e.$http.post("api/ExAlumnos/crearCuenta",{idPersona:e.currentRow.ID_PERSONA});case 2:return o=n.v,r=o.message,e.$notify(r,"success"),n.n=3,e.getInscripciones();case 3:n.n=5;break;case 4:n.p=4,n.v,e.$notify("Ocurrió un problema de conexión.","warning");case 5:return n.a(2)}},n,null,[[1,4]])}))()},addExalumno:function(){var e=this;return g()(O()().m(function n(){return O()().w(function(n){while(1)switch(n.n){case 0:e.$router.push({name:"exalumno.inscripciones.agregar"});case 1:return n.a(2)}},n)}))()},enviarCorreo:function(){var e=this;return g()(O()().m(function n(){var o,r,t;return O()().w(function(n){while(1)switch(n.p=n.n){case 0:if(e.currentRow.USUCOD){n.n=1;break}return e.$notify("".concat(e.currentRow.NOMBRES_COMPLETO,", No tiene cuenta"),"warning"),n.a(2,!1);case 1:return n.p=1,n.n=2,e.$http.post("api/ExAlumnos/enviarCorreo",{params:{id_persona:e.currentRow.ID_PERSONA,tipo:"Credencial"}});case 2:o=n.v,r=o.message,e.$notify(r,"success"),n.n=4;break;case 3:n.p=3,t=n.v,e.$notify(t.message||"Ocurrió un problema de conexión.","warning");case 4:return n.a(2)}},n,null,[[1,3]])}))()},imprimir:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"pdf",n=p()({},this.frm);n["formato"]=e,n["repcod"]="inscripcionesExalumnos",n["formato"]=e,(0,A["default"])({parametros:n,metodo:"GET",nombre:"inscripcionesExalumnos",url:(0,N["default"])().url+"/intranet/reporte-node/reporte",formatoTipo:"formato",formato:e,tipo:(0,M.isLess)()?"download":"vista"})},agregarCorreos:function(e){this.$refs.formInscripcion.frm.CORREOS&&(this.$refs.formInscripcion.frm.CORREOS=e.arrayValores,this.$refs.formInscripcion.frm.CORREO=e.valorCampo),this.openModalCorreo=!1},openCorreos:function(){this.openModalCorreo=!0},cerrarModal:function(){this.id="",this.perfil=""},agregarTelefonos:function(e){this.$refs.formInscripcion.frm.TELEFONOS&&(this.$refs.formInscripcion.frm.TELEFONOS=e.arrayValores,this.$refs.formInscripcion.frm.TELEFONO=e.valorCampo),this.openModalTelefono=!1},openTelefonos:function(){this.openModalTelefono=!0},openProfesiones:function(){this.openModalProfesiones=!0},agregarProfesiones:function(e){this.$refs.formInscripcion.frm.PROFESIONES&&(this.$refs.formInscripcion.frm.PROFESIONES=e.arrayValores,this.$refs.formInscripcion.frm.PROFESION=e.valorCampo),this.openModalProfesiones=!1}},created:function(){var e=this;return g()(O()().m(function n(){return O()().w(function(n){while(1)switch(n.n){case 0:return e.SISCOD_EXALUMNOS=U["default"].SISCOD_EXALUMNOS,n.n=1,e.getPromocionesUsuario();case 1:e.promocionesUsuario=n.v,e.init();case 2:return n.a(2)}},n)}))()}},L=o(12807);const V=(0,L.A)($,[["render",m]]);var y=V}}]);