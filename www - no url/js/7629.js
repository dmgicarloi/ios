"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[7629],{7629:function(e,t,a){a.r(t),a.d(t,{default:function(){return st}});var r=a(8445),n=a.n(r),i=(a(39866),a(515),a(68017),a(61758)),o=a(58790),s=a(29104),u={class:"row items-center no-wrap"},l={class:"col-auto"},c={class:"col-auto"},d={class:"row q-ma-xs q-col-gutter-sm"},g={class:"col-xs-12 col-lg-6"},f={class:"row items-center no-wrap flex header-query"},h={class:"col-xs-12 col-lg-6"},p={class:"row q-ma-xs q-col-gutter-sm"},m={class:"col-lg-6 flex",style:{"justify-content":"flex-end"}},b={class:"row q-ma-xs q-col-gutter-sm",style:{position:"relative"}},v={key:0,style:{"font-size":"1rem"}},y=["onClick"],Q={class:"msg-alert-query"},w={class:"msg-success-query"},k={style:{"list-style":"none"}},A={style:{"max-width":"100%"}},x={contenteditable:""};function C(e,t){var a=this,r=(0,i.g2)("q-checkbox"),C=(0,i.g2)("crearBotones"),S=(0,i.g2)("q-card-section"),q=(0,i.g2)("q-separator"),E=(0,i.g2)("q-tab"),F=(0,i.g2)("q-tabs"),T=(0,i.g2)("q-btn"),P=(0,i.g2)("reportetador"),L=(0,i.g2)("q-icon"),D=(0,i.g2)("tabQuery"),$=(0,i.g2)("q-card");return(0,i.uX)(),(0,i.Wv)($,{class:"layout-v1 my-card",flat:"",bordered:""},{default:(0,i.k6)(function(){return[(0,i.bF)(S,null,{default:(0,i.k6)(function(){return[(0,i.Lk)("div",u,[t[6]||(t[6]=(0,i.Lk)("div",{class:"col"},[(0,i.Lk)("div",{class:"text-h6"},"Editor SQL")],-1)),(0,i.Lk)("div",l,[e.tabActive===e.tabConsulta?((0,i.uX)(),(0,i.Wv)(r,{key:0,modelValue:e.horizontal,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.horizontal=t}),"left-label":"",label:"Horizontal",onInput:e.changeModeQuery},null,8,["modelValue","onInput"])):(0,i.Q3)("v-if",!0)]),(0,i.Lk)("div",c,[e.tabActive!==e.tabReporte?((0,i.uX)(),(0,i.Wv)(C,{key:0,buttons:e.botones,nivelAcceso:e.nivelAcceso,option:e.componente,dropdown:e.$q.screen.lt.md},null,8,["buttons","nivelAcceso","option","dropdown"])):(0,i.Q3)("v-if",!0)])])]}),_:1}),(0,i.bF)(q),(0,i.bF)(S,null,{default:(0,i.k6)(function(){return[(0,i.Lk)("div",d,[(0,i.Lk)("div",g,[(0,i.Lk)("div",f,[(0,i.bF)(F,{class:"flex tabs-query","default-tab":"tab-4",modelValue:e.tabActive,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.tabActive=t}),onInput:e.changeTab},{default:(0,i.k6)(function(){return[(0,i.bF)(E,{name:e.tabConsulta},{default:(0,i.k6)(function(){return n()(t[7]||(t[7]=[(0,i.eW)("Querys",-1)]))}),_:1},8,["name"]),(0,i.bF)(E,{name:e.tabExecute},{default:(0,i.k6)(function(){return n()(t[8]||(t[8]=[(0,i.eW)("Execute",-1)]))}),_:1},8,["name"]),(0,i.bF)(E,{name:e.tabDrop},{default:(0,i.k6)(function(){return n()(t[9]||(t[9]=[(0,i.eW)("Delete",-1)]))}),_:1},8,["name"]),(0,i.bF)(E,{name:e.tabHistory},{default:(0,i.k6)(function(){return n()(t[10]||(t[10]=[(0,i.eW)("Historial",-1)]))}),_:1},8,["name"])]}),_:1},8,["modelValue","onInput"]),e.tabActive===e.tabHistory||e.$q.screen.lt.md?(0,i.Q3)("v-if",!0):((0,i.uX)(),(0,i.Wv)(T,{key:0,class:"q-mr-sm",icon:"play_arrow",label:"ejecutar",color:"primary",style:{height:"35px"},onClick:e.procesar,size:"sm"},null,8,["onClick"]))])]),(0,i.Lk)("div",h,[(0,i.Lk)("div",p,[t[11]||(t[11]=(0,i.Lk)("div",{class:"col-lg-6"},null,-1)),(0,i.Lk)("div",m,[e.tabActive===e.tabConsulta&&a.pages.length>1?((0,i.uX)(),(0,i.Wv)(T,{key:0,class:"q-mr-sm",icon:"remove",color:"primary",style:{height:"25px"},onClick:e.removePageOld,size:"sm"},null,8,["onClick"])):(0,i.Q3)("v-if",!0),e.tabActive===e.tabConsulta?((0,i.uX)(),(0,i.Wv)(T,{key:1,class:"q-mr-sm",icon:"check",color:"primary",style:{height:"25px"},onClick:e.actualizarData,size:"sm"},null,8,["onClick"])):(0,i.Q3)("v-if",!0),e.multiQuerys.show||e.tabActive!==e.tabConsulta?(0,i.Q3)("v-if",!0):((0,i.uX)(),(0,i.Wv)(T,{key:2,class:"q-mr-sm",icon:"search",color:"primary",style:{height:"25px"},onClick:e.agregarFiltro,size:"sm"},null,8,["onClick"])),e.tabActive!==e.tabHistory&&e.$q.screen.lt.md?((0,i.uX)(),(0,i.Wv)(T,{key:3,class:"q-mr-sm",icon:"play_arrow",color:"primary",style:{height:"25px"},onClick:e.procesar,size:"sm"},null,8,["onClick"])):(0,i.Q3)("v-if",!0)])])])])]}),_:1}),(0,i.bF)(q),(0,i.bF)(S,null,{default:(0,i.k6)(function(){return[(0,i.Lk)("div",b,[[e.tabExecute,e.tabDrop].includes(e.tabActive)?((0,i.uX)(),(0,i.CE)("div",{key:0,class:(0,o.C4)(["col-xs-12",(e.reducir,"col-lg-12")])},[(0,i.Lk)("div",{class:(0,o.C4)(["row q-ma-xs q-col-gutter-sm container-textarea-query",e.reducir?"reducir ":"w-text-area"])},[[e.tabConsulta,e.tabExecute,e.tabDrop].includes(e.tabActive)?(0,i.bo)(((0,i.uX)(),(0,i.CE)("textarea",{key:0,class:"textarea-query-builder",id:"query-builder","onUpdate:modelValue":t[2]||(t[2]=function(t){return e.query=t}),onKeyup:t[3]||(t[3]=(0,s.jR)(function(){return e.procesar&&e.procesar.apply(e,arguments)},["f9"])),onInput:t[4]||(t[4]=function(){return e.setQueryLocalStorage&&e.setQueryLocalStorage.apply(e,arguments)})},null,544)),[[s.Jo,e.query]]):(0,i.Q3)("v-if",!0)],2)],2)):(0,i.Q3)("v-if",!0),e.tabActive===e.tabHistory?((0,i.uX)(),(0,i.Wv)(S,{key:1},{default:(0,i.k6)(function(){return[t[13]||(t[13]=(0,i.Lk)("div",{class:"row items-center no-wrap"},[(0,i.Lk)("div",{class:"col"},[(0,i.Lk)("div",{class:"text-h6"},"Historial de consultas Local")])],-1)),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.historial,function(a){return(0,i.uX)(),(0,i.CE)(i.FK,null,[String(a).trim().length>0?((0,i.uX)(),(0,i.CE)("p",v,[t[12]||(t[12]=(0,i.eW)("Query :",-1)),(0,i.Lk)("a",{style:{"text-decoration":"none"},href:"javascript:void(0)",onClick:function(t){return e.goQuery(a)}},(0,o.v_)(a),9,y)])):(0,i.Q3)("v-if",!0)],64)}),256))]}),_:1})):(0,i.Q3)("v-if",!0),e.tabActive===e.tabReporte?((0,i.uX)(),(0,i.Wv)(S,{key:2},{default:(0,i.k6)(function(){return[(0,i.bF)(P,{tags:e.dataCuerpo&&e.dataCuerpo.length>0?Object.keys(e.dataCuerpo[0]):[],data:a.generarDataParaExportar()},null,8,["tags","data"])]}),_:1})):(0,i.Q3)("v-if",!0),e.error?((0,i.uX)(),(0,i.Wv)(S,{key:3},{default:(0,i.k6)(function(){return[(0,i.Lk)("p",Q,"Error: "+(0,o.v_)(e.messageError),1)]}),_:1})):(0,i.Q3)("v-if",!0),e.executeProcess?((0,i.uX)(),(0,i.Wv)(S,{key:4},{default:(0,i.k6)(function(){return[(0,i.Lk)("p",w,(0,o.v_)(e.messageSuccess),1)]}),_:1})):(0,i.Q3)("v-if",!0),e.tabActive===e.tabSchema?((0,i.uX)(),(0,i.Wv)(S,{key:5},{default:(0,i.k6)(function(){return[(0,i.Lk)("ul",null,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.dataTables,function(e){return(0,i.uX)(),(0,i.CE)("li",k,(0,o.v_)(e.TABLA),1)}),256))])]}),_:1})):(0,i.Q3)("v-if",!0),e.tabActive===e.tabConsulta?((0,i.uX)(),(0,i.CE)(i.FK,{key:6},[(0,i.Lk)("div",A,[e.tabActive===e.tabConsulta?((0,i.uX)(),(0,i.Wv)(F,{key:0,modelValue:e.pageActive,"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.pageActive=t}),onClick:e.changePage,"default-tab":"tab-4"},{default:(0,i.k6)(function(){return[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.pages,function(e){return(0,i.uX)(),(0,i.Wv)(E,{key:e,class:"tab-hover",active:1===e,name:"page".concat(e)},{default:(0,i.k6)(function(){return[(0,i.Lk)("p",x,"Script "+(0,o.v_)(e),1)]}),_:2},1032,["active","name"])}),128)),e.tabActive===e.tabConsulta&&a.pages.length<e.maxPagesTabs?((0,i.uX)(),(0,i.Wv)(E,{key:0,name:"plus",color:"primary","text-color":"white"},{default:(0,i.k6)(function(){return[(0,i.bF)(L,{name:"plus"})]}),_:1})):(0,i.Q3)("v-if",!0)]}),_:1},8,["modelValue","onClick"])):(0,i.Q3)("v-if",!0)]),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.pages,function(t){return(0,i.bo)(((0,i.uX)(),(0,i.Wv)(D,{key:t,index:t,ref_for:!0,ref:"page".concat(t),onError:e.renderError},null,8,["index","onError"])),[[s.aG,e.pageActive==="page".concat(t)]])}),128))],64)):(0,i.Q3)("v-if",!0)])]}),_:1})]}),_:1})}var S=a(99550),q=a.n(S),E=a(41562),F=a.n(E),T=a(76080),P=a.n(T),L=a(45254),D=a.n(L),$=(a(12563),a(34634),a(30683),a(71225),a(77507),a(52133),a(10239),a(23513),a(50310),a(5962),a(6724),a(92802),a(11777),a(83190),a(52776),a(84433),a(88390),a(62692),a(2369),a(81813),a(6123)),I=a(95718),R=a(53380),X=a(64208),_=a(54489),H=a(75053),M=a(93616),O=a(80660),z=a(41615),V=a(64303),B=a(36408),N=a(27560),j=a(96330),U=a(34262),G=a(23540),W=a(26697),K=a(53093),Z={class:"col-xs-3"},J={key:0,class:"row q-ma-xs q-col-gutter-sm"},Y={class:"col-xs-4"},ee={class:"row q-ma-xs q-col-gutter-sm"},te={class:"col-xs-12"},ae={class:"col-xs-12"};function re(e,t){var a=(0,i.g2)("q-btn"),r=(0,i.g2)("q-icon"),o=(0,i.g2)("q-input"),s=(0,i.g2)("q-card-section"),u=(0,i.g2)("q-select"),l=(0,i.g2)("q-checkbox"),c=(0,i.g2)("sie-modal");return(0,i.uX)(),(0,i.CE)("div",null,[(0,i.Lk)("div",Z,[(0,i.bF)(a,{class:"q-mb-xs q-mr-sm",color:"primary",icon:"add",onClick:e.openModalFiltro},null,8,["onClick"])]),e.showFilter?((0,i.uX)(),(0,i.CE)("div",J,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.keyFilters,function(t){return(0,i.uX)(),(0,i.CE)("div",Y,[(0,i.bF)(o,{label:t,modelValue:e.inputsFilters[t],"onUpdate:modelValue":function(a){return e.inputsFilters[t]=a},onInput:e.filterData},{default:(0,i.k6)(function(){return[(0,i.bF)(r,{name:"clear",color:"primary",style:{"font-size":"2rem",cursor:"pointer"},onClick:function(a){return e.removeFilter(t)}},null,8,["onClick"])]}),_:2},1032,["label","modelValue","onUpdate:modelValue","onInput"])])}),256))])):(0,i.Q3)("v-if",!0),(0,i.bF)(c,{modelValue:e.modalAddFiltro,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.modalAddFiltro=t}),onSubmit:e.agregarFiltro,labelButtonOk:"Agregar"},{default:(0,i.k6)(function(){return[(0,i.bF)(s,null,{default:(0,i.k6)(function(){return n()(t[3]||(t[3]=[(0,i.Lk)("div",{class:"row-item"},[(0,i.Lk)("div",{class:"text-h6"},"Agregar Nuevo Filtro")],-1)]))}),_:1}),(0,i.bF)(s,null,{default:(0,i.k6)(function(){return[(0,i.Lk)("div",ee,[(0,i.Lk)("div",te,[(0,i.bF)(u,{options:e.dataFiltros,modelValue:e.newFilter,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.newFilter=t}),placeholder:"Seleccione el nuevo filtro",label:"Filtro Nuevo"},null,8,["options","modelValue"])]),(0,i.Lk)("div",ae,[(0,i.bF)(l,{modelValue:e.repetir,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.repetir=t}),label:"¿Seguir Agregando?"},null,8,["modelValue"])])])]}),_:1})]}),_:1},8,["modelValue","onSubmit"])])}a(89571),a(9240),a(57668),a(25814),a(18105);var ne=a(6557),ie={emits:["filter"],props:["filtros","data"],components:{sieGrid:B.A,footerGrid:N.A,headerGrid:j.A,sieSelect:M.A,sieModal:H.A,QTable:$.kH,QTr:$.qh,QTd:$.Ef,QCard:$.C$,QPopupEdit:$.GT,QCardTitle:$.u0,QCheckbox:$.vZ,QBtn:$.Il,QCardMain:$.d1,QToggle:$.c5,QDatetime:$.T5,QCardSection:I.A,QSeparator:R.A,QSelect:_.S,QInput:X.A,QOptionGroup:$.EX,crearBotones:V.A,QIcon:U.A,QIntersection:G.A,QTabs:W.A,QTab:K.A},data:function(){return{keyFilters:[],inputsFilters:{},modelFilters:{},modalAddFiltro:!1,newFilter:"",showFilter:!0,dataFiltros:[],repetir:!1,dataBackup:[]}},computed:{},methods:{filterData:function(){var e=this;return D()(P()().m(function t(){var a,r,i;return P()().w(function(t){while(1)switch(t.n){case 0:if(a=e.keyFilters.some(function(t){return String(e.inputsFilters[t]).length>0}),!(e.data.length>0&&a)){t.n=2;break}return r=n()(e.dataBackup),t.n=1,(0,ne.A)({keys:e.inputsFilters,data:r});case 1:return i=t.v,e.$emit("filter",i),e.refresh(),t.a(2,!0);case 2:e.$emit("filter",e.dataBackup),e.refresh();case 3:return t.a(2)}},t)}))()},openModalFiltro:function(){this.modalAddFiltro=!0,this.clearFiltros()},agregarFiltro:function(){var e=this.newFilter;this.keyFilters.push(e),this.inputsFilters[e]="",this.refresh(),this.clearFiltros(),this.repetir||(this.modalAddFiltro=!1)},clearFiltros:function(){var e=this;this.newFilter="",this.dataFiltros=this.filtros.filter(function(t){return!e.keyFilters.includes(t.value)})},refresh:function(){this.showFilter=!1,this.showFilter=!0},removeFilter:function(e){delete this.inputsFilters[e],this.keyFilters.splice(e,1),this.filterData()}},beforeMounted:function(){this.keyFilters=[],this.inputsFilters={},this.dataFiltros=n()(this.filtros)},created:function(){var e=this;return D()(P()().m(function t(){return P()().w(function(t){while(1)switch(t.n){case 0:e.dataBackup=n()(e.data);case 1:return t.a(2)}},t)}))()}},oe=a(12807);const se=(0,oe.A)(ie,[["render",re]]);var ue=se,le={key:0,class:"row q-ma-xs q-col-gutter-sm"},ce={class:"col-xs-6 flex container-filters"};function de(e,t){var a=(0,i.g2)("q-select"),r=(0,i.g2)("q-icon"),n=(0,i.g2)("q-input");return(0,i.uX)(),(0,i.CE)("div",null,[e.refresh?((0,i.uX)(),(0,i.CE)("div",le,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(Object.keys(e.filter),function(t){return(0,i.uX)(),(0,i.CE)("div",ce,[(0,i.bF)(a,{class:"select-filter-all",options:e.dataFilter,modelValue:e.filter[t].label,"onUpdate:modelValue":function(a){return e.filter[t].label=a},placeholder:"Seleccione el filtro",label:"Filtro",onInput:function(a){return e.getFilter(t)}},null,8,["options","modelValue","onUpdate:modelValue","onInput"]),(0,i.bF)(n,{class:"input-filter-all",modelValue:e.filter[t].value,"onUpdate:modelValue":function(a){return e.filter[t].value=a},placeholder:"Ingrese el valor",label:"Valor",onInput:e.getFilter},{default:(0,i.k6)(function(){return[(0,i.bF)(r,{class:"q-icon-filter-all",name:"clear",color:"primary",onClick:function(a){return e.removeFilter(t)}},null,8,["onClick"])]}),_:2},1032,["modelValue","onUpdate:modelValue","onInput"])])}),256))])):(0,i.Q3)("v-if",!0)])}var ge=a(9504),fe=a.n(ge),he=a(57008),pe=a.n(he),me=(a(85472),a(45467),{emits:["filter-page","filter"],props:["dataFilter","data","pagina","dataPaginator"],components:{sieGrid:B.A,footerGrid:N.A,headerGrid:j.A,sieSelect:M.A,sieModal:H.A,QTable:$.kH,QTr:$.qh,QTd:$.Ef,QCard:$.C$,QPopupEdit:$.GT,QCardTitle:$.u0,QCheckbox:$.vZ,QBtn:$.Il,QCardMain:$.d1,QToggle:$.c5,QDatetime:$.T5,QCardSection:I.A,QSeparator:R.A,QSelect:_.S,QInput:X.A,QOptionGroup:$.EX,crearBotones:V.A,QIcon:U.A,QIntersection:G.A,QTabs:W.A,QTab:K.A},data:function(){return{filter:{},mask:{label:"",value:""},refresh:!0,copyPaginator:[],page:1,filtrosActivos:{}}},computed:{},methods:{searchPage:function(){this.$emit("filter-page",Number(this.page))},paginar:function(e,t){var a,r={},n={data:[],index:0},i=F()(e);try{for(i.s();!(a=i.n()).done;){var o=a.value;n.data.length===t&&(r[n.index]=n.data,n.data=[],n.index++),n.data.push(o)}}catch(e){i.e(e)}finally{i.f()}return n.data.length>0&&(r[n.index]=n.data),r},getFilterPaginator:function(e){var t=this;return D()(P()().m(function a(){var r,i,o,s,u,l,c,d;return P()().w(function(a){while(1)switch(a.n){case 0:r=[],i=pe()({},t.copyPaginator),l=fe()(i);case 1:if((c=l()).done){a.n=3;break}return o=c.value,s=n()(i[o]),d=r,a.n=2,(0,ne.A)({keys:e,data:s});case 2:d.push.call(d,a.v),a.n=1;break;case 3:return u=r.flat(),a.a(2,{paginador:t.paginar(u,100),totalRows:u.length})}},a)}))()},getFilter:function(e){var t=this;return D()(P()().m(function e(){var a,r,n;return P()().w(function(e){while(1)switch(e.n){case 0:for(r in a={},t.filter)t.filter[r].label&&String(t.filter[r].label).length>0&&(a[t.filter[r].label]=t.filter[r].value,t.filtrosActivos[r]=t.filter[r].label);return e.n=1,t.getFilterPaginator(a);case 1:n=e.v,t.$emit("filter",n.paginador,n.totalRows),t.functionRefresh();case 2:return e.a(2)}},e)}))()},removeFilter:function(e){delete this.filtrosActivos[e],delete this.filter[e],this.functionRefresh(),this.getFilter()},functionRefresh:function(){this.refresh=!1,this.refresh=!0},addFiltro:function(){Object.keys(this.filter).length<this.dataFilter.length&&(this.filter[Object.keys(this.filter).length+1]=pe()({},this.mask),this.functionRefresh())}},beforeMounted:function(){this.filter={},this.functionRefresh()},mounted:function(){this.$store.addFiltro=this.addFiltro},created:function(){var e=this;return D()(P()().m(function t(){return P()().w(function(t){while(1)switch(t.n){case 0:e.copyPaginator=e.dataPaginator,e.page=e.pagina,e.refresh=!0;case 1:return t.a(2)}},t)}))()}});const be=(0,oe.A)(me,[["render",de]]);var ve=be,ye={class:"row q-ma-xs q-col-gutter-sm"},Qe={class:"col-xs-5"},we={class:"col-xs-7 flex",style:{"justify-content":"flex-start","align-items":"center"}},ke={style:{margin:"0 1rem"}};function Ae(e,t){var a=(0,i.g2)("q-btn");return(0,i.uX)(),(0,i.CE)("div",ye,[(0,i.Lk)("div",Qe,[(0,i.Lk)("b",null,"Total Registros: "+(0,o.v_)(e.totalRegistros),1)]),(0,i.Lk)("div",we,[Number(e.pagina)>e.minPage?((0,i.uX)(),(0,i.Wv)(a,{key:0,class:"icon-footer",onClick:e.afterPaginator,icon:"skip_previous","bg-color":"#fff"},null,8,["onClick"])):(0,i.Q3)("v-if",!0),(0,i.Lk)("b",ke,"Pagina "+(0,o.v_)(Number(Number(e.pagina)))+" de "+(0,o.v_)(Number(0===e.maxPages?1:e.maxPages)),1),Number(e.pagina)<e.maxPages?((0,i.uX)(),(0,i.Wv)(a,{key:1,class:"icon-footer",onClick:e.nextPaginator,icon:"skip_next","bg-color":"#fff"},null,8,["onClick"])):(0,i.Q3)("v-if",!0)])])}var xe={emits:["after","next"],props:["totalRegistros","pagina","maxPages"],components:{sieGrid:B.A,footerGrid:N.A,headerGrid:j.A,sieSelect:M.A,sieModal:H.A,QTable:$.kH,QTr:$.qh,QTd:$.Ef,QCard:$.C$,QPopupEdit:$.GT,QCardTitle:$.u0,QCheckbox:$.vZ,QBtn:$.Il,QCardMain:$.d1,QToggle:$.c5,QDatetime:$.T5,QCardSection:I.A,QSeparator:R.A,QSelect:_.S,QInput:X.A,QOptionGroup:$.EX,crearBotones:V.A,QIcon:U.A,QIntersection:G.A,QTabs:W.A,QTab:K.A},data:function(){return{minPage:1}},computed:{},methods:{afterPaginator:function(){this.$emit("after")},nextPaginator:function(){this.$emit("next")}},beforeMounted:function(){},created:function(){return D()(P()().m(function e(){return P()().w(function(e){while(1)switch(e.n){case 0:return e.a(2)}},e)}))()}};const Ce=(0,oe.A)(xe,[["render",Ae]]);var Se=Ce,qe={class:"table-query",border:"1"},Ee={class:"head-table-query",style:{position:"sticky",top:"0"}},Fe={class:"tr-table-query"},Te={class:"body-table",id:"body-table"},Pe=["contenteditable","data-column","data-key"];function Le(e,t){return(0,i.uX)(),(0,i.CE)("div",null,[(0,i.Lk)("div",{class:(0,o.C4)(e.multi?"container-multi-table-query":"container-table-query")},[(0,i.Lk)("table",qe,[(0,i.Lk)("thead",Ee,[(0,i.Lk)("tr",Fe,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.dataFilter,function(e){return(0,i.uX)(),(0,i.CE)("th",null,(0,o.v_)(e.value),1)}),256))])]),(0,i.Lk)("tbody",Te,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.dataCuerpo,function(a,r){return(0,i.uX)(),(0,i.CE)("tr",{key:r,onInput:t[0]||(t[0]=function(){return e.cambios&&e.cambios.apply(e,arguments)})},[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(Object.keys(a),function(t){return(0,i.uX)(),(0,i.CE)("td",{contenteditable:e.editable,"data-column":t,"data-key":r},(0,o.v_)(a[t]),9,Pe)}),256))],32)}),128))])])],2)])}var De={emits:["setDataActulizar"],props:["dataFilter","dataCuerpo","dataTypes","editable","multi","index"],components:{QCard:$.C$,QCardTitle:$.u0,QCardMain:$.d1,QCardSection:I.A,QSeparator:R.A},data:function(){return{dataEditable:{},dataOld:{}}},computed:{},watch:{dataCuerpo:function(e,t){for(var a in this.dataOld={},e)this.dataOld[a]=this.dataCuerpo[a]}},methods:{cambios:function(e){var t=this;return D()(P()().m(function a(){var r,n,i,o;return P()().w(function(a){while(1)switch(a.n){case 0:r=e.target.parentElement.children,n=F()(r);try{for(n.s();!(i=n.n()).done;)o=i.value,t.dataEditable[o.dataset.key]||(t.dataEditable[o.dataset.key]={}),t.dataEditable[o.dataset.key][o.dataset.column]=o.textContent}catch(e){n.e(e)}finally{n.f()}e.target.style="background-color:rgb(60, 179, 113,.5)",t.submit();case 1:return a.a(2)}},a)}))()},submit:function(){var e={};for(var t in this.dataEditable)for(var a in e[t]=this.dataOld[t],this.dataOld[t])e[t][a]=this.dataOld[t][a]||0===Number(this.dataOld[t][a])?this.dataOld[t][a]:"";this.editable&&this.$emit("setDataActulizar",this.dataEditable,e,this.index||"")}},beforeMounted:function(){},created:function(){var e=this;return D()(P()().m(function t(){var a;return P()().w(function(t){while(1)switch(t.n){case 0:for(a in e.dataOld={},e.dataCuerpo)e.dataOld[a]=e.dataCuerpo[a];case 1:return t.a(2)}},t)}))()}};const $e=(0,oe.A)(De,[["render",Le]]);var Ie=$e,Re={class:"col-auto"},Xe={class:"col-xs-12",style:{border:"0.05rem solid rgba(0,0,0,.3)",padding:"0.6rem"}},_e={class:"text-h6"},He={class:"flex",style:{"flex-wrap":"wrap",padding:"0.5rem"}},Me={class:"etiqueta"};function Oe(e,t){var a=(0,i.g2)("q-btn"),r=(0,i.g2)("q-card-section"),n=(0,i.g2)("sie-editor");return(0,i.uX)(),(0,i.CE)("div",null,[(0,i.bF)(r,null,{default:(0,i.k6)(function(){return[(0,i.Lk)("div",Re,[(0,i.bF)(a,{class:"q-mr-sm",icon:"settings",color:"primary",label:"generar reporte",onClick:e.generarReporte,size:"sm"},null,8,["onClick"])])]}),_:1}),(0,i.bF)(r,null,{default:(0,i.k6)(function(){return[(0,i.bF)(n,{modelValue:e.cabecera,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.cabecera=t}),label:"Cuerpo",resize:!1,type:"dbox"},null,8,["modelValue"])]}),_:1}),(0,i.bF)(r,null,{default:(0,i.k6)(function(){return[(0,i.bF)(n,{modelValue:e.mensaje,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.mensaje=t}),label:"Cuerpo",resize:!1,type:"dbox"},null,8,["modelValue"]),(0,i.Lk)("div",Xe,[(0,i.Lk)("div",_e,[t[2]||(t[2]=(0,i.eW)("Etiquetas",-1)),(0,i.Lk)("div",He,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.dataTags,function(e){return(0,i.uX)(),(0,i.CE)("p",Me,(0,o.v_)("".concat(e)),1)}),256))])])]),t[3]||(t[3]=(0,i.Lk)("div",{id:"div-hidden",style:{display:"none"}},null,-1))]}),_:1})])}a(76921),a(13600),a(37406),a(44264);var ze=a(6083),Ve={props:["tags","data"],components:{sieGrid:B.A,footerGrid:N.A,headerGrid:j.A,sieSelect:M.A,sieModal:H.A,QTable:$.kH,QTr:$.qh,QTd:$.Ef,QCard:$.C$,QPopupEdit:$.GT,QCardTitle:$.u0,QCheckbox:$.vZ,QBtn:$.Il,QCardMain:$.d1,QToggle:$.c5,QDatetime:$.T5,QCardSection:I.A,QSeparator:R.A,QSelect:_.S,QInput:X.A,QOptionGroup:$.EX,crearBotones:V.A,QIcon:U.A,QIntersection:G.A,QTabs:W.A,QTab:K.A,sieEditor:ze.A},data:function(){return{mensaje:"",dataTags:[],cabecera:""}},computed:{},methods:{generarReporte:function(){var e=this;return D()(P()().m(function t(){var a,r,n,i,o,s,u,l;return P()().w(function(t){while(1)switch(t.n){case 0:a=String(e.mensaje).substring(0),r=e.cabecera,n=F()(e.data);try{for(n.s();!(i=n.n()).done;){for(u in o=i.value,s=a,o)l=new RegExp("\\{\\{".concat(u,"\\}\\}"),"g"),s=s.replace(l,o[u]?o[u]:"");r+=s}}catch(e){n.e(e)}finally{n.f()}return document.getElementById("div-hidden").innerHTML=r,console.log(r),t.n=1,O.$http.post("api/TesoreriaServiciosController/postGenerarReporteQuery",{params:{body:r}});case 1:return t.a(2)}},t)}))()}},beforeMount:function(){this.dataTags=this.tags.map(function(e){return"{{".concat(e,"}}")})}};const Be=(0,oe.A)(Ve,[["render",Oe]]);var Ne=Be,je=a(72029),Ue={class:"row q-ma-xs q-col-gutter-sm"},Ge={key:0,class:"col-xs-12"},We={key:0,class:"msg-alert-query"},Ke={class:"msg-alert-query"},Ze={style:{"list-style":"none"}};function Je(e,t){var a=(0,i.g2)("QueryFilterAll"),r=(0,i.g2)("QueryFooter"),n=(0,i.g2)("QueryTable"),u=(0,i.g2)("q-card-section"),l=(0,i.g2)("q-separator"),c=(0,i.g2)("Qsplitter");return[e.tabConsulta].includes(e.tabActive)?((0,i.uX)(),(0,i.Wv)(c,{key:0,modelValue:e.splitterModel,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.splitterModel=t}),horizontal:e.horizontal,limits:[0,50],style:{padding:"0",overflow:"hidden","min-height":"60vh",width:"100%",border:"0.05rem solid #000"}},{before:(0,i.k6)(function(){return[(0,i.Lk)("div",{class:(0,o.C4)(["container-textarea-query",e.reducir?"reducir ":"w-text-area"]),style:{height:"100%",overflow:"hidden",padding:"0"}},[[e.tabConsulta,e.tabExecute,e.tabDrop].includes(e.tabActive)?(0,i.bo)(((0,i.uX)(),(0,i.CE)("textarea",{key:0,class:"textarea-query-builder",id:"query-builder","onUpdate:modelValue":t[0]||(t[0]=function(t){return e.query=t}),onKeyup:t[1]||(t[1]=(0,s.jR)(function(){return e.getPeticion&&e.getPeticion.apply(e,arguments)},["f9"])),onInput:t[2]||(t[2]=function(){return e.setQueryLocalStorage&&e.setQueryLocalStorage.apply(e,arguments)}),style:{border:"none","max-height":"60vh"},onMouseup:t[3]||(t[3]=function(){return e.handleMouseUp&&e.handleMouseUp.apply(e,arguments)})},null,544)),[[s.Jo,e.query]]):(0,i.Q3)("v-if",!0)],2)]}),after:(0,i.k6)(function(){return[(0,i.Lk)("div",{class:(0,o.C4)(["col-xs-12",(e.reducir,"col-lg-12")]),style:{overflow:"hidden"}},[e.data&&e.tabActive===e.tabConsulta&&!e.multiQuerys.show?((0,i.uX)(),(0,i.Wv)(u,{key:0,class:"responsive-body-query"},{default:(0,i.k6)(function(){return[e.showQueryFilter?((0,i.uX)(),(0,i.Wv)(a,{key:0,ref:"queryFilter",dataFilter:e.dataFilter,data:e.dataCuerpo,onFilter:e.getFilter,onFilterPage:e.searchPage,pagina:e.pagina,dataPaginator:e.dataPaginator},null,8,["dataFilter","data","onFilter","onFilterPage","pagina","dataPaginator"])):(0,i.Q3)("v-if",!0),(0,i.bF)(r,{pagina:e.pagina,maxPages:e.maxPages,totalRegistros:e.totalRegistros,onNext:e.nextPaginator,onAfter:e.afterPaginator},null,8,["pagina","maxPages","totalRegistros","onNext","onAfter"]),e.showTable?((0,i.uX)(),(0,i.Wv)(n,{key:1,dataCuerpo:e.dataCuerpo,dataFilter:e.dataFilter,dataTypes:e.dataTypes,editable:e.editable,onSetDataActulizar:e.setDataActulizar,style:{height:"100%"},multi:!1},null,8,["dataCuerpo","dataFilter","dataTypes","editable","onSetDataActulizar"])):(0,i.Q3)("v-if",!0)]}),_:1})):(0,i.Q3)("v-if",!0),e.showTable&&e.tabActive===e.tabConsulta&&e.multiQuerys.show?((0,i.uX)(),(0,i.Wv)(u,{key:1,class:"responsive-body-query",style:{overflow:"hidden","overflow-y":"scroll"}},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",Ue,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(Object.keys(e.multiQuerys.queries),function(a){return(0,i.uX)(),(0,i.CE)(i.FK,{key:a},[!0===e.multiQuerys.showTable[a]?((0,i.uX)(),(0,i.CE)("div",Ge,[e.multiQuerys.showError[a]?((0,i.uX)(),(0,i.CE)("p",We,"Error: "+(0,o.v_)(e.multiQuerys.error[a]),1)):(0,i.Q3)("v-if",!0),e.multiQuerys.showError[a]?(0,i.Q3)("v-if",!0):((0,i.uX)(),(0,i.Wv)(r,{key:1,pagina:e.multiQuerys.pagina[a],maxPages:e.multiQuerys.maxPages[a],totalRegistros:e.multiQuerys.total[a],onNext:function(t){return e.nextPaginatorMultiQuery(a)},onAfter:function(t){return e.afterPaginatorMultiQuery(a)}},null,8,["pagina","maxPages","totalRegistros","onNext","onAfter"])),e.showTable&&!e.multiQuerys.showError[a]?((0,i.uX)(),(0,i.Wv)(n,{key:2,dataCuerpo:e.multiQuerys.data[a].data[Number(e.multiQuerys.pagina[a])-1],dataFilter:e.multiQuerys.cabecera[a],dataTypes:[],editable:e.multiQuerys.editable[a],onSetDataActulizar:e.setDataActulizar,multi:!0,index:a},null,8,["dataCuerpo","dataFilter","editable","onSetDataActulizar","index"])):(0,i.Q3)("v-if",!0),t[5]||(t[5]=(0,i.Lk)("br",null,null,-1)),(0,i.bF)(l)])):(0,i.Q3)("v-if",!0)],64)}),128))])]}),_:1})):(0,i.Q3)("v-if",!0),e.error?((0,i.uX)(),(0,i.Wv)(u,{key:2},{default:(0,i.k6)(function(){return[(0,i.Lk)("p",Ke,"Error: "+(0,o.v_)(e.messageError),1)]}),_:1})):(0,i.Q3)("v-if",!0)],2)]}),default:(0,i.k6)(function(){return[e.tabActive===e.tabSchema?((0,i.uX)(),(0,i.Wv)(u,{key:0},{default:(0,i.k6)(function(){return[(0,i.Lk)("ul",null,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.dataTables,function(e){return(0,i.uX)(),(0,i.CE)("li",Ze,(0,o.v_)(e.TABLA),1)}),256))])]}),_:1})):(0,i.Q3)("v-if",!0)]}),_:1},8,["modelValue","horizontal"])):(0,i.Q3)("v-if",!0)}var Ye=1,et={components:{sieGrid:B.A,footerGrid:N.A,headerGrid:j.A,sieSelect:M.A,sieModal:H.A,QTable:$.kH,QTr:$.qh,QTd:$.Ef,QCard:$.C$,QPopupEdit:$.GT,QCardTitle:$.u0,QCheckbox:$.vZ,QBtn:$.Il,QCardMain:$.d1,QToggle:$.c5,QDatetime:$.T5,QCardSection:I.A,QSeparator:R.A,QSelect:_.S,QInput:X.A,QOptionGroup:$.EX,crearBotones:V.A,QIcon:U.A,QIntersection:G.A,QTabs:W.A,QTab:K.A,QueryFilter:ue,QueryFilterAll:ve,QueryFooter:Se,QueryTable:Ie,sieEditor:ze.A,Qsplitter:je.A},props:{index:{type:Number,default:1}},data:function(){return{nivelAcceso:3,botones:[],componente:"QueryBuilder",query:"",opcion:Ye,options:1,opciones:[{value:1,label:"Consulta SQL"},{value:2,label:"Execute SQL"}],columnDefs:[],rowData:[],frameworkComponents:{},api:null,data:!1,error:"",totalRegistros:0,dataFilter:[],filtros:[{value:"",label:""}],filter:{value:"",label:""},copyData:[],filename:"consulta-query-builder",offset:50,rows:1,maxItems:100,dataPaginator:[],pagina:1,maxPages:0,filterPages:0,dataCuerpo:[],tabActive:"consulta",tabConsulta:"consulta",tabExecute:"execute",tabSchema:"schema",tabReporte:"report",tabDrop:"drop",executeProcess:!1,showQueryFilter:!1,showSearchPagina:!1,page:1,messageError:"",messageSuccess:"",dataTypes:[],dataTables:[],localStorage:{consulta:"consulta",execute:"execute",report:"report",drop:"drop"},showTable:!1,editable:!1,table:"",tabHistory:"history",historial:[],queryEditable:"",queryResolve:"",dataActualizar:{new:{},old:{}},pages:{1:!0},multiQuerys:{show:!1,queries:[],data:{},model:{},cabecera:{},pagina:{},maxPages:{},showTable:{},total:{},editable:{},dataEditable:{},table:{},error:{},showError:{}},open:!0,reducir:!1,splitterModel:30,execute_block:!0,horizontal:!0}},computed:{},methods:{limpiarComentarios:function(e){while(e.includes("/*")){var t=e.indexOf("/*"),a=e.includes("*/")?e.indexOf("*/"):-1;e=e.includes("*/")?e.replace(e.slice(t,a),""):e.replace(e.slice(t),""),e=e.replace("*/","")}var r=e.split("\n").map(function(e){return e.includes("--")?e.substring(0,e.indexOf("--")):e});return r.join("\n")},validarQueryLink:function(e){return/^select/gi.test(e)},validarLinkQueryDelete:function(e){return/delete/gi.test(e)},goQuery:function(e){var t=String(e).slice(10);return this.query=t.trim(),this.validarQueryLink(this.query)?(this.tabActive=this.tabConsulta,this.procesar(),this.setQueryLocalStorage(),!0):this.validarLinkQueryDelete(this.query)?(this.tabActive=this.tabDrop,this.setQueryLocalStorage(),!0):(this.tabActive=this.tabConsulta,this.setQueryLocalStorage(),!0)},changeModeQuery:function(e){},agregarFiltro:function(){this.$refs.queryFilter.addFiltro()},getHoraHistorial:function(){var e=new Date,t=String(e.getHours()).padStart(2,"0"),a=String(e.getMinutes()).padStart(2,"0"),r=String(e.getSeconds()).padStart(2,"0");return"".concat(t,":").concat(a,":").concat(r)},setDataActulizar:function(e,t,a){var r=this;return D()(P()().m(function n(){return P()().w(function(n){while(1)switch(n.n){case 0:if(!r.multiQuerys.show){n.n=1;break}return r.multiQuerys.dataEditable[a]={new:e,old:t},n.a(2,!1);case 1:r.dataActualizar.new=e,r.dataActualizar.old=t;case 2:return n.a(2)}},n)}))()},setHistorial:function(e){var t=arguments,a=this;return D()(P()().m(function r(){var n,i;return P()().w(function(r){while(1)switch(r.n){case 0:n=t.length>1&&void 0!==t[1]&&t[1],i=a.getHistorialQuery()?a.getHistorialQuery():"",e=n?a.obtenerQueryString().trim().replace(/;/g,""):a.obtenerQueryString().trim()+"-",localStorage.setItem("historial-query","".concat(i,"(").concat(a.getHoraHistorial(),") ").concat(e,"-"));case 1:return r.a(2)}},r)}))()},getHistorialQuery:function(){return localStorage.getItem("historial-query")},viewHistorialQuery:function(){this.historial=this.getHistorialQuery()?this.getHistorialQuery().split("-"):""},changeTab:function(){var e=this;return D()(P()().m(function t(){var a;return P()().w(function(t){while(1)switch(t.n){case 0:if(e.query="",![e.tabReporte,e.tabHistory].includes(e.tabActive)){t.n=1;break}return e.error="",e.executeProcess=e.messageSuccess.length>0&&e.tabActive===e.tabExecute&&!e.error,e.viewHistorialQuery(),e.crearBotones(),t.a(2,!1);case 1:try{a=document.getElementById("query-builder"),a.focus()}catch(e){}return e.query="",e.error="",e.executeProcess="",e.crearBotones(),t.n=2,e.getQueryLocalStorage();case 2:return t.n=3,e.obtenerQueryString();case 3:e.procesar();case 4:return t.a(2)}},t)}))()},clearPaginator:function(){this.pagina=1,this.maxPages=0,this.filterPages=0,this.dataPaginator=[]},searchPage:function(e){var t=this;return D()(P()().m(function a(){return P()().w(function(a){while(1)switch(a.n){case 0:if(/\d/.test(e)){a.n=1;break}return a.a(2,t.$alert("No existe la pagina","warning"));case 1:if(!(e<=0||e>t.maxPages)){a.n=2;break}return a.a(2,t.$alert("No existe la pagina ".concat(e," "),"warning"));case 2:return t.pagina=e,a.n=3,t.renderData(t.dataPaginator[t.pagina-1]);case 3:return a.a(2)}},a)}))()},nextPaginator:function(){var e=this;return D()(P()().m(function t(){return P()().w(function(t){while(1)switch(t.n){case 0:if(e.pagina!==e.maxPages){t.n=1;break}return t.a(2,!1);case 1:return e.pagina++,t.n=2,e.renderData(e.dataPaginator[e.pagina-1]);case 2:return t.a(2)}},t)}))()},afterPaginator:function(){var e=this;return D()(P()().m(function t(){return P()().w(function(t){while(1)switch(t.n){case 0:return e.pagina--,e.pagina<=0&&(e.pagina=1),t.n=1,e.renderData(e.dataPaginator[e.pagina-1]);case 1:return t.a(2)}},t)}))()},getFilter:function(e,t){this.pagina=Object.keys(e).length!==Object.keys(this.dataPaginator)?1:this.pagina,this.dataPaginator=e,this.maxPages=Object.keys(this.dataPaginator).length,this.totalRegistros=t,this.renderData(this.dataPaginator[this.pagina-1])},onGridReady:function(e){this.api=e.api},setQueryLocalStorage:function(){var e=this.localStorage[this.tabActive];localStorage.setItem("query-".concat(this.index,"-").concat(e),this.query)},getQueryLocalStorage:function(){var e=this.localStorage[this.tabActive],t=localStorage.getItem("query-".concat(this.index,"-").concat(e));t&&(this.query=t)},limpiarFiltros:function(){this.dataFilter=[],this.filter.value="",this.filter.label=""},verficarMultiQuery:function(e){var t=e.trim().split(";").reduce(function(e,t){return t&&t.length>0&&e.push(t),e},[]);return t},handleMouseUp:function(){var e=window.getSelection().toString();e||console.log("Texto deseleccionado")},obtenerQueryString:function(){var e=document.getElementById("query-builder"),t="";return e&&null!==e.selectionStart&&window.getSelection().toString().length>0&&(t=e.value.substring(e.selectionStart,e.selectionEnd),e.setSelectionRange(e.selectionStart,e.selectionEnd),e.focus()),t=t.length>0?t:this.query,t=this.limpiarComentarios(t),t=t.split("\n").reduce(function(e,t){return t.length>0?e+="".concat(t," "):e},""),t},getResponseData:function(e){return O.$http.get("api/TesoreriaServiciosController/getQueryBuilder",{params:{params:e}})},nextPaginatorMultiQuery:function(e){var t=this;return D()(P()().m(function a(){var r;return P()().w(function(a){while(1)switch(a.n){case 0:if(r=Number(t.multiQuerys.pagina[e])+1,!(r>Number(t.multiQuerys.maxPages[e]))){a.n=1;break}return a.a(2,!1);case 1:t.showTable=!1,t.multiQuerys.pagina[e]=r,t.showTable=!0;case 2:return a.a(2)}},a)}))()},afterPaginatorMultiQuery:function(e){var t=this;return D()(P()().m(function a(){var r;return P()().w(function(a){while(1)switch(a.n){case 0:if(r=Number(t.multiQuerys.pagina[e])-1,0!==r){a.n=1;break}return a.a(2,!1);case 1:t.showTable=!1,t.multiQuerys.pagina[e]=r,t.showTable=!0;case 2:return a.a(2)}},a)}))()},getDataMultiQuery:function(e){var t=this;return D()(P()().m(function a(){var r,n,i,o,s,u,l,c,d,g,f,h;return P()().w(function(a){while(1)switch(a.p=a.n){case 0:t.$q.loading.show(),t.clearPaginator(),t.messageError="",t.multiQuerys={show:!1,queries:[],data:{},model:{},cabecera:{},pagina:{},maxPages:{},showTable:{},total:{},editable:{},dataEditable:{},table:{},error:{},showError:{}},t.multiQuerys.show=!0,a.p=1,r=F()(e),a.p=2,r.s();case 3:if((n=r.n()).done){a.n=8;break}return i=n.value,t.showTable=!1,t.multiQuerys.queries.push(i),o=t.multiQuerys.queries.length-1,a.p=4,a.n=5,t.getResponseData({query:t.multiQuerys.queries.at(o)});case 5:for(d in s=a.v,t.multiQuerys.data[o]={data:s.data.paginator},u=q()(s.data.paginator[0],1),l=u[0],c=[],l)c.push({value:d,label:d});t.multiQuerys.cabecera[o]=c,t.multiQuerys.pagina[o]=1,t.multiQuerys.maxPages[o]=Object.keys(s.data.paginator).length,t.multiQuerys.showTable[o]=!0,t.multiQuerys.total[o]=s.data.totalRows,t.multiQuerys.editable[o]=s.data.dataEditable,t.multiQuerys.table[o]=s.data.tabla,t.multiQuerys.dataEditable[o]={new:[],old:[]},a.n=7;break;case 6:a.p=6,g=a.v,t.multiQuerys.error[o]=g.error?g.error.message:g.message,t.multiQuerys.showError[o]=!0,t.multiQuerys.showTable[o]=!0;case 7:a.n=3;break;case 8:a.n=10;break;case 9:a.p=9,f=a.v,r.e(f);case 10:return a.p=10,r.f(),a.f(10);case 11:t.showTable=!0,t.error=!1,t.$q.loading.hide(),a.n=13;break;case 12:a.p=12,h=a.v,t.renderError(h.error?h.error.message:h.message);case 13:return a.p=13,t.setHistorial(t.query),t.$q.loading.hide(),a.f(13);case 14:return a.a(2)}},a,null,[[4,6],[2,9,10,11],[1,12,13,14]])}))()},getDataQuery:function(e){var t=this;return D()(P()().m(function a(){var r;return P()().w(function(a){while(1)switch(a.n){case 0:return t.clearPaginator(),a.n=1,t.getResponseData(e);case 1:if(r=a.v,t.dataPaginator=r.data.paginator,t.totalRegistros=r.data.totalRows,t.dataTypes=r.data.dataTypes,t.maxPages=Object.keys(t.dataPaginator).length,t.editable=r.data.dataEditable,t.table=r.data.tabla,t.viewHistorialQuery(),0!==r.length){a.n=2;break}throw new Error("No existen datos");case 2:return a.a(2,t.dataPaginator[t.pagina-1])}},a)}))()},executeQuery:function(){var e=this;return D()(P()().m(function t(){return P()().w(function(t){while(1)switch(t.n){case 0:e.$confirm("¿Está seguro de ejecutar el proceso?").onOk(D()(P()().m(function t(){var a,r,n;return P()().w(function(t){while(1)switch(t.p=t.n){case 0:return t.p=0,e.$q.loading.show(),a=e.obtenerQueryString(),t.n=1,O.$http.post("api/TesoreriaServiciosController/postQueryBuilder",{params:{query:a}});case 1:return r=t.v,e.renderSuccess(r.message),t.n=2,e.obtenerQueryString();case 2:t.n=4;break;case 3:t.p=3,n=t.v,e.renderError(n.error?n.error.message:n.message);case 4:return t.p=4,e.setHistorial(e.query),e.$q.loading.hide(),t.f(4);case 5:return t.a(2)}},t,null,[[0,3,4,5]])})));case 1:return t.a(2)}},t)}))()},executeDelete:function(){var e=this;return D()(P()().m(function t(){return P()().w(function(t){while(1)switch(t.n){case 0:e.$confirm("¿Está seguro de ejecutar el proceso?").onOk(D()(P()().m(function t(){var a,r;return P()().w(function(t){while(1)switch(t.p=t.n){case 0:return t.p=0,e.$q.loading.show(),a=e.obtenerQueryString(),t.n=1,O.$http.post("api/TesoreriaServiciosController/postQueryBuilder",{params:{query:a,drop:!0}});case 1:return e.renderSuccess("Proceso Finalizado Satisfactoriamente"),t.n=2,e.obtenerQueryString();case 2:t.n=4;break;case 3:t.p=3,r=t.v,e.renderError(r.error?r.error.message:r.message);case 4:return t.p=4,e.setHistorial(e.query),e.$q.loading.hide(),t.f(4);case 5:return t.a(2)}},t,null,[[0,3,4,5]])})));case 1:return t.a(2)}},t)}))()},actualizarDataMultiQuery:function(){var e=this;return D()(P()().m(function t(){return P()().w(function(t){while(1)switch(t.n){case 0:e.$confirm("¿Está seguro de ejecutar el proceso?").onOk(D()(P()().m(function t(){var a,r,n,i,o,s;return P()().w(function(t){while(1)switch(t.p=t.n){case 0:t.p=0,e.$q.loading.show(),i=fe()(e.multiQuerys.dataEditable);case 1:if((o=i()).done){t.n=5;break}if(a=o.value,r=e.multiQuerys.dataEditable[a],!1!==e.multiQuerys.editable[a]){t.n=2;break}return t.a(3,1);case 2:if(0!==Object.keys(r.new).length){t.n=3;break}return t.a(3,1);case 3:return n={editable:pe()({},r.new),old:pe()({},r.old),tabla:e.multiQuerys.table[a]},t.n=4,O.$http.put("api/TesoreriaServiciosController/putMasivoQueryBuilder",{params:n});case 4:t.n=1;break;case 5:return e.getPeticion(),t.a(2,e.$alert("Proceso Finalizado Correctamente","success"));case 6:t.p=6,s=t.v,e.renderError(s.error?s.error.message:s.message);case 7:return t.p=7,t.f(7);case 8:return t.a(2)}},t,null,[[0,6,7,8]])})));case 1:return t.a(2)}},t)}))()},actualizarData:function(){var e=this;return D()(P()().m(function t(){var a,r;return P()().w(function(t){while(1)switch(t.n){case 0:if(!e.multiQuerys.show){t.n=1;break}return t.a(2,e.actualizarDataMultiQuery());case 1:if(a=pe()({},e.dataActualizar.new),r=pe()({},e.dataActualizar.old),0!==Object.keys(a).length){t.n=2;break}return t.a(2,e.$alert("No se edito ningún registro","warning"));case 2:e.$confirm("¿Está seguro de ejecutar el proceso?").onOk(D()(P()().m(function t(){var n;return P()().w(function(t){while(1)switch(t.p=t.n){case 0:return t.p=0,e.$q.loading.show(),t.n=1,O.$http.put("api/TesoreriaServiciosController/putMasivoQueryBuilder",{params:{editable:a,old:r,tabla:e.table}});case 1:return e.getPeticion(),t.a(2,e.$alert("Proceso Finalizado Correctamente","success"));case 2:t.p=2,n=t.v,e.renderError(n.error?n.error.message:n.message);case 3:return t.p=3,e.$q.loading.hide(),t.f(3);case 4:return t.a(2)}},t,null,[[0,2,3,4]])})));case 3:return t.a(2)}},t)}))()},procesar:function(){var e=this;return D()(P()().m(function t(){var a;return P()().w(function(t){while(1)switch(t.n){case 0:if(e.getQueryLocalStorage(),e.query&&0!==String(e.query).trim().length){t.n=1;break}return t.a(2,e.$alert("No ingreso ninguna consulta","warning"));case 1:if(a={consulta:e.getPeticion,execute:e.executeQuery,drop:e.executeDelete},!a[e.tabActive]){t.n=2;break}return t.a(2,a[e.tabActive]());case 2:return t.a(2,e.$alert("No existe un proceso configurado para esta TAB"))}},t)}))()},getPeticion:function(){var e=this;return D()(P()().m(function t(){var a,r,i,o;return P()().w(function(t){while(1)switch(t.p=t.n){case 0:if(e.tabActive!==e.tabHistory){t.n=1;break}return t.a(2,!1);case 1:if(e.showTable=!1,a=e.obtenerQueryString(),r=e.verficarMultiQuery(a),!(r.length>1)){t.n=2;break}return t.a(2,e.getDataMultiQuery(r));case 2:return t.p=2,e.$q.loading.show(),e.multiQuerys.show=!1,e.showQueryFilter=!1,t.n=3,e.getDataQuery({query:a});case 3:i=t.v,e.copyData=n()(i),e.limpiarFiltros(),e.renderData(i),e.setQueryLocalStorage(),e.showQueryFilter=!0,e.showTable=!0,e.error=!1,t.n=5;break;case 4:t.p=4,o=t.v,e.renderError(o.message);case 5:return t.p=5,e.setHistorial(e.query),e.$q.loading.hide(),t.f(5);case 6:return t.a(2)}},t,null,[[2,4,5,6]])}))()},renderError:function(e){this.data=!1,this.error=!0,this.messageError=e,this.executeProcess=!1},renderSuccess:function(e){this.error=!1,this.executeProcess=!0,this.messageSuccess=e},renderData:function(e){var t=this;return D()(P()().m(function a(){return P()().w(function(a){while(1)switch(a.n){case 0:return t.error=!1,t.data=!0,t.columnDefs=[],t.rowData=e||[],a.n=1,t.generarCabecera(e);case 1:return a.a(2)}},a)}))()},generarCabecera:function(e){if(e){var t=q()(e,1),a=t[0],r=[];for(var n in a)r.push({value:n,label:n}),this.dataFilter=r}this.generarContenido(e)},generarContenido:function(e){this.dataCuerpo=e,this.showQueryFilter=!1,this.showQueryFilter=!0},generarDataParaExportar:function(){var e=[];for(var t in this.dataPaginator)e=[].concat(n()(e),n()(this.dataPaginator[t]));return e},exportarData:function(){var e=this;return D()(P()().m(function t(){var a,r,n,i;return P()().w(function(t){while(1)switch(t.p=t.n){case 0:if(0!==e.rowData.length){t.n=1;break}return t.a(2,!1);case 1:return t.p=1,e.$q.loading.show(),t.n=2,e.generarDataParaExportar();case 2:return a=t.v,t.n=3,O.$http.post("api/TesoreriaServiciosController/postExportarExcel",{datos:{data:a,filename:e.filename}});case 3:r=t.v,n='{"name":"'.concat(r.ruta,'","ruta":"').concat(r.ruta,'","tipo":"xlsx"}'),z["default"].DESCARGAR_ARCHIVO(n),e.$alert("Archivo Excportado Satisfactoriamente","success"),t.n=5;break;case 4:t.p=4,i=t.v,e.$alert(i.error?i.error.message:i.message,"warning");case 5:return t.p=5,e.$q.loading.hide(),t.f(5);case 6:return t.a(2)}},t,null,[[1,4,5,6]])}))()},verLog:function(){window.open("/".concat(O.API_LMS,"/api/TesoreriaServiciosController/getViewLogQuery"),"_blank")},clearHistory:function(){var e=this;this.$confirm("¿Seguro de limpiar el historial de consultas local?").onOk(function(){localStorage.setItem("historial-query",""),e.viewHistorialQuery()})},crearBotones:function(){this.botones=[{label:"Excel",icon:"file_excel",click:this.exportarData,minAcceso:z["default"].LECTURA_ESCRITURA},{label:"Log",icon:"file_document",click:this.verLog,minAcceso:z["default"].LECTURA_ESCRITURA}],this.tabActive===this.tabHistory&&this.botones.unshift({label:"Limpiar Historial",icon:"delete",click:this.clearHistory,minAcceso:z["default"].LECTURA_ESCRITURA})}},beforeMount:function(){},mounted:function(){},created:function(){var e=this;return D()(P()().m(function t(){var a;return P()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,z["default"].VERIFICAR_USUARIO_ADMINISTRADOR();case 1:return a=t.v,a||e.$router.push({name:"tesoreria.home"}),e.crearBotones(),e.getQueryLocalStorage(),e.viewHistorialQuery(),t.n=2,O.$http.get("api/TesoreriaServiciosController/getTablas");case 2:e.dataTables=t.v;case 3:return t.a(2)}},t)}))()}};const tt=(0,oe.A)(et,[["render",Je]]);var at=tt,rt=a(62565),nt=1,it={components:{sieGrid:B.A,footerGrid:N.A,headerGrid:j.A,sieSelect:M.A,sieModal:H.A,QTable:$.kH,QTr:$.qh,QTd:$.Ef,QCard:$.C$,QPopupEdit:$.GT,QCardTitle:$.u0,QCheckbox:$.vZ,QBtn:$.Il,QCardMain:$.d1,QToggle:$.c5,QDatetime:$.T5,QCardSection:I.A,QSeparator:R.A,QSelect:_.S,QInput:X.A,QOptionGroup:$.EX,crearBotones:V.A,QIcon:U.A,QIntersection:G.A,QTabs:W.A,QTab:K.A,QueryFilter:ue,QueryFilterAll:ve,QueryFooter:Se,QueryTable:Ie,sieEditor:ze.A,reportetador:Ne,Qsplitter:je.A,tabQuery:at,QBadge:rt.A},data:function(){return{nivelAcceso:3,botones:[],componente:"QueryBuilder",query:"",opcion:nt,options:1,opciones:[{value:1,label:"Consulta SQL"},{value:2,label:"Execute SQL"}],columnDefs:[],rowData:[],frameworkComponents:{},api:null,data:!1,error:"",totalRegistros:0,dataFilter:[],filtros:[{value:"",label:""}],filter:{value:"",label:""},copyData:[],filename:"consulta-query-builder",offset:50,rows:1,maxItems:100,dataPaginator:[],pagina:1,maxPages:0,filterPages:0,dataCuerpo:[],tabActive:"consulta",tabConsulta:"consulta",tabExecute:"execute",tabSchema:"schema",tabReporte:"report",tabDrop:"drop",executeProcess:!1,showQueryFilter:!1,showSearchPagina:!1,page:1,messageError:"",messageSuccess:"",dataTypes:[],dataTables:[],localStorage:{consulta:"consulta",execute:"execute",report:"report",drop:"drop"},showTable:!1,editable:!1,table:"",tabHistory:"history",historial:[],queryEditable:"",queryResolve:"",dataActualizar:{new:{},old:{}},pages:[1],multiQuerys:{show:!1,queries:[],data:{},model:{},cabecera:{},pagina:{},maxPages:{},showTable:{},total:{},editable:{},dataEditable:{},table:{},error:{},showError:{}},open:!0,reducir:!1,splitterModel:30,execute_block:!0,horizontal:!0,pageActive:"page1",maxPagesTabs:10,executeMax:!1}},computed:{},methods:{addPage:function(){this.pages.push(this.pages.at(-1)+1)},removePageOld:function(){var e=this.pageActive.replace("page","");this.pages=this.pages.filter(function(t){return Number(t)!==Number(e)});var t=this.pages[this.pages.length-1];Number(e)===Number(this.pages[0])&&(t=this.pages[1]),this.pageActive="page".concat(Number(t))},removePage:function(){var e=this.pages.length-1;this.pageActive==="page".concat(this.pages.length)&&(this.pageActive="page".concat(e)),this.pages=this.pages.slice(0,this.pages.length-1)},limpiarComentarios:function(e){while(e.includes("/*")){var t=e.indexOf("/*"),a=e.includes("*/")?e.indexOf("*/"):-1;e=e.includes("*/")?e.replace(e.slice(t,a),""):e.replace(e.slice(t),""),e=e.replace("*/","")}var r=e.split("\n").map(function(e){return e.includes("--")?e.substring(0,e.indexOf("--")):e});return r.join("\n")},validarQueryLink:function(e){return/^select/gi.test(e)},validarLinkQueryDelete:function(e){return/delete/gi.test(e)},goQuery:function(e){var t=this;this.tabActive=this.tabConsulta,setTimeout(function(){t.$refs[t.pageActive][0].goQuery(e)},1)},changeModeQuery:function(e){this.$refs[this.pageActive][0].horizontal=this.horizontal},changePage:function(){if("plus"===this.pageActive)return this.addPage(),this.pageActive="page".concat(this.pages.length),!0;this.horizontal=this.$refs[this.pageActive][0].horizontal},agregarFiltro:function(){this.$refs[this.pageActive][0].agregarFiltro()},getHoraHistorial:function(){var e=new Date,t=String(e.getHours()).padStart(2,"0"),a=String(e.getMinutes()).padStart(2,"0"),r=String(e.getSeconds()).padStart(2,"0");return"".concat(t,":").concat(a,":").concat(r)},setDataActulizar:function(e,t,a){var r=this;return D()(P()().m(function n(){return P()().w(function(n){while(1)switch(n.n){case 0:if(!r.multiQuerys.show){n.n=1;break}return r.multiQuerys.dataEditable[a]={new:e,old:t},n.a(2,!1);case 1:r.dataActualizar.new=e,r.dataActualizar.old=t;case 2:return n.a(2)}},n)}))()},setHistorial:function(e){var t=arguments,a=this;return D()(P()().m(function r(){var n,i;return P()().w(function(r){while(1)switch(r.n){case 0:n=t.length>1&&void 0!==t[1]&&t[1],i=a.getHistorialQuery()?a.getHistorialQuery():"",e=n?a.obtenerQueryString().trim().replace(/;/g,""):a.obtenerQueryString().trim()+"-",localStorage.setItem("historial-query","".concat(i,"(").concat(a.getHoraHistorial(),") ").concat(e,"-"));case 1:return r.a(2)}},r)}))()},getHistorialQuery:function(){return localStorage.getItem("historial-query")},viewHistorialQuery:function(){this.historial=this.getHistorialQuery()?this.getHistorialQuery().split("-"):""},changeTab:function(){var e=this;return D()(P()().m(function t(){return P()().w(function(t){while(1)switch(t.n){case 0:if(e.query="",![e.tabReporte,e.tabHistory].includes(e.tabActive)){t.n=1;break}return e.error="",e.executeProcess=e.messageSuccess.length>0&&e.tabActive===e.tabExecute&&!e.error,e.viewHistorialQuery(),e.crearBotones(),t.a(2,!1);case 1:return e.query="",e.error="",e.executeProcess="",e.crearBotones(),t.n=2,e.getQueryLocalStorage();case 2:return t.n=3,e.obtenerQueryString();case 3:e.$nextTick(function(){var t,a;if([e.tabConsulta].includes(e.tabActive)&&(null!==(t=e.$refs)&&void 0!==t&&null!==(t=t[e.pageActive][0])&&void 0!==t&&t.procesar))return null===(a=e.$refs)||void 0===a||null===(a=a[e.pageActive][0])||void 0===a?void 0:a.procesar()});case 4:return t.a(2)}},t)}))()},clearPaginator:function(){this.pagina=1,this.maxPages=0,this.filterPages=0,this.dataPaginator=[]},searchPage:function(e){var t=this;return D()(P()().m(function a(){return P()().w(function(a){while(1)switch(a.n){case 0:if(/\d/.test(e)){a.n=1;break}return a.a(2,t.$alert("No existe la pagina","warning"));case 1:if(!(e<=0||e>t.maxPages)){a.n=2;break}return a.a(2,t.$alert("No existe la pagina ".concat(e," "),"warning"));case 2:return t.pagina=e,a.n=3,t.renderData(t.dataPaginator[t.pagina-1]);case 3:return a.a(2)}},a)}))()},nextPaginator:function(){var e=this;return D()(P()().m(function t(){return P()().w(function(t){while(1)switch(t.n){case 0:if(e.pagina!==e.maxPages){t.n=1;break}return t.a(2,!1);case 1:return e.pagina++,t.n=2,e.renderData(e.dataPaginator[e.pagina-1]);case 2:return t.a(2)}},t)}))()},afterPaginator:function(){var e=this;return D()(P()().m(function t(){return P()().w(function(t){while(1)switch(t.n){case 0:return e.pagina--,e.pagina<=0&&(e.pagina=1),t.n=1,e.renderData(e.dataPaginator[e.pagina-1]);case 1:return t.a(2)}},t)}))()},getFilter:function(e,t){this.pagina=Object.keys(e).length!==Object.keys(this.dataPaginator)?1:this.pagina,this.dataPaginator=e,this.maxPages=Object.keys(this.dataPaginator).length,this.totalRegistros=t,this.renderData(this.dataPaginator[this.pagina-1])},onGridReady:function(e){this.api=e.api},setQueryLocalStorage:function(){var e=this.localStorage[this.tabActive];localStorage.setItem("query-".concat(e),this.query)},getQueryLocalStorage:function(){var e=this.localStorage[this.tabActive],t=localStorage.getItem("query-".concat(e));t&&(this.query=t)},limpiarFiltros:function(){this.dataFilter=[],this.filter.value="",this.filter.label=""},verficarMultiQuery:function(e){var t=e.trim().split(";").reduce(function(e,t){return t&&t.length>0&&e.push(t),e},[]);return t},obtenerQueryString:function(){var e=document.getElementById("query-builder"),t="";return e&&null!==e.selectionStart&&(t=e.value.substring(e.selectionStart,e.selectionEnd),e.setSelectionRange(e.selectionStart,e.selectionEnd),e.focus()),t=t.length>0?t:this.query,t=this.limpiarComentarios(t),t=t.split("\n").reduce(function(e,t){return t.length>0?e+="".concat(t," "):e},""),t},getResponseData:function(e){return O.$http.get("api/TesoreriaServiciosController/getQueryBuilder",{params:{params:e}})},nextPaginatorMultiQuery:function(e){var t=this;return D()(P()().m(function a(){var r;return P()().w(function(a){while(1)switch(a.n){case 0:if(r=Number(t.multiQuerys.pagina[e])+1,!(r>Number(t.multiQuerys.maxPages[e]))){a.n=1;break}return a.a(2,!1);case 1:t.showTable=!1,t.multiQuerys.pagina[e]=r,t.showTable=!0;case 2:return a.a(2)}},a)}))()},afterPaginatorMultiQuery:function(e){var t=this;return D()(P()().m(function a(){var r;return P()().w(function(a){while(1)switch(a.n){case 0:if(r=Number(t.multiQuerys.pagina[e])-1,0!==r){a.n=1;break}return a.a(2,!1);case 1:t.showTable=!1,t.multiQuerys.pagina[e]=r,t.showTable=!0;case 2:return a.a(2)}},a)}))()},getDataMultiQuery:function(e){var t=this;return D()(P()().m(function a(){var r,n,i,o,s,u,l,c,d,g,f,h;return P()().w(function(a){while(1)switch(a.p=a.n){case 0:t.$q.loading.show(),t.clearPaginator(),t.messageError="",t.multiQuerys={show:!1,queries:[],data:{},model:{},cabecera:{},pagina:{},maxPages:{},showTable:{},total:{},editable:{},dataEditable:{},table:{},error:{},showError:{}},t.multiQuerys.show=!0,a.p=1,r=F()(e),a.p=2,r.s();case 3:if((n=r.n()).done){a.n=8;break}return i=n.value,t.showTable=!1,t.multiQuerys.queries.push(i),o=t.multiQuerys.queries.length-1,a.p=4,a.n=5,t.getResponseData({query:t.multiQuerys.queries.at(o)});case 5:for(d in s=a.v,t.multiQuerys.data[o]={data:s.data.paginator},u=q()(s.data.paginator[0],1),l=u[0],c=[],l)c.push({value:d,label:d});t.multiQuerys.cabecera[o]=c,t.multiQuerys.pagina[o]=1,t.multiQuerys.maxPages[o]=Object.keys(s.data.paginator).length,t.multiQuerys.showTable[o]=!0,t.multiQuerys.total[o]=s.data.totalRows,t.multiQuerys.editable[o]=s.data.dataEditable,t.multiQuerys.table[o]=s.data.tabla,t.multiQuerys.dataEditable[o]={new:[],old:[]},a.n=7;break;case 6:a.p=6,g=a.v,t.multiQuerys.error[o]=g.error?g.error.message:g.message,t.multiQuerys.showError[o]=!0,t.multiQuerys.showTable[o]=!0;case 7:a.n=3;break;case 8:a.n=10;break;case 9:a.p=9,f=a.v,r.e(f);case 10:return a.p=10,r.f(),a.f(10);case 11:t.showTable=!0,t.error=!1,t.$q.loading.hide(),a.n=13;break;case 12:a.p=12,h=a.v,t.renderError(h.error?h.error.message:h.message);case 13:return a.p=13,t.setHistorial(t.query),t.$q.loading.hide(),a.f(13);case 14:return a.a(2)}},a,null,[[4,6],[2,9,10,11],[1,12,13,14]])}))()},getDataQuery:function(e){var t=this;return D()(P()().m(function a(){var r;return P()().w(function(a){while(1)switch(a.n){case 0:return t.clearPaginator(),a.n=1,t.getResponseData(e);case 1:if(r=a.v,t.dataPaginator=r.data.paginator,t.totalRegistros=r.data.totalRows,t.dataTypes=r.data.dataTypes,t.maxPages=Object.keys(t.dataPaginator).length,t.editable=r.data.dataEditable,t.table=r.data.tabla,t.viewHistorialQuery(),0!==r.length){a.n=2;break}throw new Error("No existen datos");case 2:return a.a(2,t.dataPaginator[t.pagina-1])}},a)}))()},executeQuery:function(){var e=this;return D()(P()().m(function t(){return P()().w(function(t){while(1)switch(t.n){case 0:e.$confirm("¿Está seguro de ejecutar el proceso?").onOk(D()(P()().m(function t(){var a,r,n;return P()().w(function(t){while(1)switch(t.p=t.n){case 0:return t.p=0,e.$q.loading.show(),a=e.obtenerQueryString(),t.n=1,O.$http.post("api/TesoreriaServiciosController/postQueryBuilder",{params:{query:a,executeMax:!0}});case 1:return r=t.v,e.renderSuccess(r.message),t.n=2,e.obtenerQueryString();case 2:t.n=4;break;case 3:t.p=3,n=t.v,e.renderError(n.error?n.error.message:n.message);case 4:return t.p=4,e.setHistorial(e.query),e.$q.loading.hide(),t.f(4);case 5:return t.a(2)}},t,null,[[0,3,4,5]])})));case 1:return t.a(2)}},t)}))()},executeDelete:function(){var e=this;return D()(P()().m(function t(){return P()().w(function(t){while(1)switch(t.n){case 0:e.$confirm("¿Está seguro de ejecutar el proceso?").onOk(D()(P()().m(function t(){var a,r;return P()().w(function(t){while(1)switch(t.p=t.n){case 0:return t.p=0,e.$q.loading.show(),a=e.obtenerQueryString(),t.n=1,O.$http.post("api/TesoreriaServiciosController/postQueryBuilder",{params:{query:a,drop:!0,executeMax:e.executeMax}});case 1:return e.renderSuccess("Proceso Finalizado Satisfactoriamente"),t.n=2,e.obtenerQueryString();case 2:t.n=4;break;case 3:t.p=3,r=t.v,e.renderError(r.error?r.error.message:r.message);case 4:return t.p=4,e.setHistorial(e.query),e.$q.loading.hide(),t.f(4);case 5:return t.a(2)}},t,null,[[0,3,4,5]])})));case 1:return t.a(2)}},t)}))()},actualizarDataMultiQuery:function(){var e=this;return D()(P()().m(function t(){return P()().w(function(t){while(1)switch(t.n){case 0:e.$refs[e.tabActive][0].actualizarData();case 1:return t.a(2)}},t)}))()},actualizarData:function(){var e=this;return D()(P()().m(function t(){return P()().w(function(t){while(1)switch(t.n){case 0:e.$refs[e.pageActive][0].actualizarData();case 1:return t.a(2)}},t)}))()},procesar:function(){var e=this;return D()(P()().m(function t(){var a,r;return P()().w(function(t){while(1)switch(t.n){case 0:if(e.error=!1,r={consulta:null===(a=e.$refs)||void 0===a||null===(a=a[e.pageActive][0])||void 0===a?void 0:a.procesar,execute:e.executeQuery,drop:e.executeDelete},!r[e.tabActive]){t.n=1;break}return t.a(2,r[e.tabActive]());case 1:return t.a(2,e.$alert("No existe un proceso configurado para esta TAB"))}},t)}))()},getPeticion:function(){var e=this;return D()(P()().m(function t(){var a,r,i,o;return P()().w(function(t){while(1)switch(t.p=t.n){case 0:if(e.tabActive!==e.tabHistory){t.n=1;break}return t.a(2,!1);case 1:if(e.showTable=!1,a=e.obtenerQueryString(),r=e.verficarMultiQuery(a),!(r.length>1)){t.n=2;break}return t.a(2,e.getDataMultiQuery(r));case 2:return t.p=2,e.$q.loading.show(),e.multiQuerys.show=!1,e.showQueryFilter=!1,t.n=3,e.getDataQuery({query:a});case 3:i=t.v,e.copyData=n()(i),e.limpiarFiltros(),e.renderData(i),e.setQueryLocalStorage(),e.showQueryFilter=!0,e.showTable=!0,e.error=!1,t.n=5;break;case 4:t.p=4,o=t.v,e.renderError(o.message);case 5:return t.p=5,e.setHistorial(e.query),e.$q.loading.hide(),t.f(5);case 6:return t.a(2)}},t,null,[[2,4,5,6]])}))()},renderError:function(e){this.data=!1,this.error=!0,this.messageError=e,this.executeProcess=!1},renderSuccess:function(e){this.error=!1,this.executeProcess=!0,this.messageSuccess=e},renderData:function(e){var t=this;return D()(P()().m(function a(){return P()().w(function(a){while(1)switch(a.n){case 0:return t.error=!1,t.data=!0,t.columnDefs=[],t.rowData=e||[],a.n=1,t.generarCabecera(e);case 1:return a.a(2)}},a)}))()},generarCabecera:function(e){if(e){var t=q()(e,1),a=t[0],r=[];for(var n in a)r.push({value:n,label:n}),this.dataFilter=r}this.generarContenido(e)},generarContenido:function(e){this.dataCuerpo=e,this.showQueryFilter=!1,this.showQueryFilter=!0},generarDataParaExportar:function(){},exportarData:function(){var e=this;return D()(P()().m(function t(){return P()().w(function(t){while(1)switch(t.n){case 0:e.$refs[e.pageActive][0].exportarData();case 1:return t.a(2)}},t)}))()},verLog:function(){window.open("/".concat(O.API_LMS,"/api/TesoreriaServiciosController/getViewLogQuery"),"_blank")},clearHistory:function(){var e=this;this.$confirm("¿Seguro de limpiar el historial de consultas local?").onOk(function(){localStorage.setItem("historial-query",""),e.viewHistorialQuery()})},crearBotones:function(){this.botones=[{label:"Excel",icon:"file_excel",click:this.exportarData,minAcceso:z["default"].LECTURA_ESCRITURA},{label:"Log",icon:"file_document",click:this.verLog,minAcceso:z["default"].LECTURA_ESCRITURA}],this.tabActive===this.tabHistory&&this.botones.unshift({label:"Limpiar Historial",icon:"delete",click:this.clearHistory,minAcceso:z["default"].LECTURA_ESCRITURA})}},beforeMount:function(){},mounted:function(){},created:function(){var e=this;return D()(P()().m(function t(){var a;return P()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,z["default"].VERIFICAR_USUARIO_ADMINISTRADOR();case 1:return a=t.v,a||e.$router.push({name:"tesoreria.home"}),e.crearBotones(),e.getQueryLocalStorage(),e.viewHistorialQuery(),t.n=2,O.$http.get("api/TesoreriaServiciosController/getTablas");case 2:e.dataTables=t.v;case 3:return t.a(2)}},t)}))()}};const ot=(0,oe.A)(it,[["render",C]]);var st=ot}}]);