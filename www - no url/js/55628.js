"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[55628],{33247:function(o,e,t){t.r(e),t.d(e,{default:function(){return x}});var n=t(8445),r=t.n(n),i=(t(71225),t(50310),t(5962),t(83190),t(61758)),a=t(58790),l={class:"row q-px-sm q-pt-sm"},s={class:"col-2"},c={class:"col-xs-12 col-md-2"},u={class:"col-xs-12 col-md-2"},d={class:"col-xs-12 col-md-6"},f={class:"row q-px-sm col"},g={class:"col-xs-12 listaDetalle"},m={class:"col-10"},p={class:"col-12"},h={class:"row q-pa-sm"},O={class:"col-12"},C={class:"row q-pa-sm"},v={class:"col-12"};function S(o,e){var t=(0,i.g2)("q-toolbar-title"),n=(0,i.g2)("q-toolbar"),S=(0,i.g2)("q-select"),R=(0,i.g2)("selectMultiple"),D=(0,i.g2)("q-search"),b=(0,i.g2)("q-td"),N=(0,i.g2)("sie-select"),k=(0,i.g2)("q-popup-edit"),A=(0,i.g2)("q-tr"),F=(0,i.g2)("q-table"),P=(0,i.g2)("q-tooltip"),E=(0,i.g2)("q-fab-action"),U=(0,i.g2)("q-fab"),w=(0,i.g2)("q-page-sticky"),I=(0,i.g2)("sie-salones"),G=(0,i.g2)("sie-modal"),M=(0,i.g2)("q-page");return(0,i.uX)(),(0,i.Wv)(M,{class:"bg-white"},{default:(0,i.k6)(function(){return[(0,i.bF)(n,{class:"shadow-2 z-fab",inverted:""},{default:(0,i.k6)(function(){return[(0,i.bF)(t,{class:"q-pa-none"},{default:(0,i.k6)(function(){return r()(e[8]||(e[8]=[(0,i.eW)("ASIGNACIÓN DE PROFESOR",-1)]))}),_:1})]}),_:1}),(0,i.Lk)("div",l,[(0,i.Lk)("div",s,[(0,i.bF)(S,{class:"q-if-outlined no-border",color:"secondary",options:o.years,modelValue:o.ano,"onUpdate:modelValue":e[0]||(e[0]=function(e){return o.ano=e}),"float-label":o.$t("ano"),onChange:o.seleccionaAnio},null,8,["options","modelValue","float-label","onChange"])]),(0,i.Lk)("div",c,[(0,i.bF)(S,{class:"q-if-outlined",color:"secondary",modelValue:o.vmFiltro.instrucod,options:o.dataSelect.nivel,"float-label":o.$t("ngs.nivel"),onChange:o.seleccionaInstru,filter:""},null,8,["modelValue","options","float-label","onChange"])]),(0,i.Lk)("div",u,[(0,i.bF)(S,{class:"q-if-outlined",multiple:"",color:"secondary",modelValue:o.vmFiltro.gradocod,options:o.grados,"float-label":o.$t("ngs.grado"),onChange:o.seleccionaGrado,filter:""},null,8,["modelValue","options","float-label","onChange"])]),(0,i.Lk)("div",d,[(0,i.bF)(R,{options:o.dataSelect.curso,modelValue:o.vmFiltro.curso,labelSelect:o.$t("curso"),onChange:o.seleccionaCurso},null,8,["options","modelValue","labelSelect","onChange"])])]),(0,i.Lk)("div",f,[(0,i.Lk)("div",g,[(0,i.bF)(F,{data:o.dataDetalle,columns:o.conf.columns,selection:o.conf.selection,pagination:o.conf.pagination,selected:o.conf.selected,"onUpdate:selected":e[2]||(e[2]=function(e){return o.conf.selected=e}),"row-key":"ID_PGPROFE",color:"secondary",filter:o.conf.filter},{top:(0,i.k6)(function(t){return[(0,i.Lk)("div",m,[(0,i.bF)(D,{class:"q-if-outlined","hide-underline":"",modelValue:o.conf.filter,"onUpdate:modelValue":e[1]||(e[1]=function(e){return o.conf.filter=e})},null,8,["modelValue"])])]}),body:(0,i.k6)(function(e){return[(0,i.bF)(A,{class:(0,a.C4)(["cursor-pointer",e.row.__index==o.currentRow.row.__index?"tr-select":""]),props:e,onClick:function(t){return o.getCurrentRow(e.row)}},{default:(0,i.k6)(function(){return[(0,i.bF)(b,{key:"INSTRUDES",props:e},{default:(0,i.k6)(function(){return[(0,i.eW)((0,a.v_)(e.row.INSTRUDES),1)]}),_:2},1032,["props"]),(0,i.bF)(b,{key:"GRADODES",props:e},{default:(0,i.k6)(function(){return[(0,i.eW)((0,a.v_)(e.row.GRADODES),1)]}),_:2},1032,["props"]),(0,i.bF)(b,{key:"SECCIONDES",props:e},{default:(0,i.k6)(function(){return[(0,i.eW)((0,a.v_)(e.row.SECCIONDES),1)]}),_:2},1032,["props"]),(0,i.bF)(b,{key:"CURSONOM",props:e},{default:(0,i.k6)(function(){return[(0,i.eW)((0,a.v_)(e.row.CURSONOM),1)]}),_:2},1032,["props"]),(0,i.bF)(b,{key:"NOMCOMP",props:e},{default:(0,i.k6)(function(){return[(0,i.eW)((0,a.v_)(null===e.row.PROFCOD?"-":e.row.NOMCOMP),1),o.dataSelect&&o.dataSelect.profesores&&o.dataSelect.profesores.length>1?((0,i.uX)(),(0,i.Wv)(k,{key:0},{default:(0,i.k6)(function(){return[(0,i.bF)(N,{onSelected:o.cambiarProfesor,modelValue:e.row.PROFCOD,"onUpdate:modelValue":function(o){return e.row.PROFCOD=o},type:"outlined",options:o.dataSelect.profesores,val:"PROFCOD",label:"NOMCOMP",placeholder:"Seleccione"},null,8,["onSelected","modelValue","onUpdate:modelValue","options"])]}),_:2},1024)):(0,i.Q3)("v-if",!0)]}),_:2},1032,["props"])]}),_:2},1032,["class","props","onClick"])]}),_:1},8,["data","columns","selection","pagination","selected","filter"])])]),o.isGreater?((0,i.uX)(),(0,i.Wv)(w,{key:0,position:"bottom-right",offset:[20,20]},{default:(0,i.k6)(function(){return[(0,i.bF)(U,{icon:"more_vert",direction:"up",color:"secondary"},{default:(0,i.k6)(function(){return[o.sinPermiso?(0,i.Q3)("v-if",!0):((0,i.uX)(),(0,i.Wv)(E,{key:0,color:"secondary",icon:"add",onClick:e[3]||(e[3]=function(e){return o.add()})},{default:(0,i.k6)(function(){return[(0,i.bF)(P,{anchor:"center left",self:"center right"},{default:(0,i.k6)(function(){return r()(e[9]||(e[9]=[(0,i.eW)("Agregar",-1)]))}),_:1})]}),_:1})),o.sinPermiso?(0,i.Q3)("v-if",!0):((0,i.uX)(),(0,i.Wv)(E,{key:1,color:"secondary",icon:"delete",onClick:o.eliminar},{default:(0,i.k6)(function(){return[(0,i.bF)(P,{anchor:"center left",self:"center right"},{default:(0,i.k6)(function(){return r()(e[10]||(e[10]=[(0,i.eW)("Eliminar",-1)]))}),_:1})]}),_:1},8,["onClick"]))]}),_:1})]}),_:1})):(0,i.Q3)("v-if",!0),(0,i.bF)(G,{class:"plantilla-comentario-modal",modelValue:o.modal,"onUpdate:modelValue":e[7]||(e[7]=function(e){return o.modal=e}),title:o.titulo,ok:o.$t("botones.guardar"),footer:!0,onSubmit:o.grabar,onClose:o.cerrarModal},{default:(0,i.k6)(function(){return[(0,i.Lk)("div",p,[(0,i.bF)(I,{class:"col-xs-12 col-sm-6 no-border",modelValue:o.nemo,"onUpdate:modelValue":e[4]||(e[4]=function(e){return o.nemo=e}),ref:"sieSalon",onLoad:o.loadSalon,gradonivel:!0,onSeleccionar:o.seleccionarSalon,campos:["NEMO","NEMODES","INSTRUCOD","GRADOCOD","SECCIONCOD","TIPO"],ano:o.ano,recuperacion:!0,todos:!1},null,8,["modelValue","onLoad","onSeleccionar","ano"])]),(0,i.Lk)("div",h,[(0,i.Lk)("div",O,[(0,i.bF)(N,{type:"outlined",modelValue:o.form.cursocod,"onUpdate:modelValue":e[5]||(e[5]=function(e){return o.form.cursocod=e}),options:o.dataSelect.cursoReg,label:"CURSONOM",val:"CURSOCOD",placeholder:"curso"},null,8,["modelValue","options"])])]),(0,i.Lk)("div",C,[(0,i.Lk)("div",v,[(0,i.bF)(N,{type:"outlined",modelValue:o.form.profcod,"onUpdate:modelValue":e[6]||(e[6]=function(e){return o.form.profcod=e}),options:o.dataSelect.profesores,label:"NOMCOMP",val:"PROFCOD",placeholder:"profesor"},null,8,["modelValue","options"])])])]}),_:1},8,["modelValue","title","ok","onSubmit","onClose"])]}),_:1})}var R=t(99550),D=t.n(R),b=(t(39866),t(23825),t(77507),t(52133),t(10239),t(6724),t(9240),t(70199),t(515),t(27153),t(52776),t(66307),t(81813),t(7346),t(24066),t(83972)),N=t(6123),k=t(93616),A=t(72453),F=t(30640),P=t(2819),E=t(62760),U=t(88275),w=t(81288),I=t(3927),G=t(982),M=t(13813),y=t(69027),_=t(27738),T=t(80660),V={default:function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return{id:o,ano:e,instrucod:t,gradocod:"",cursocod:"",profcod:"",seccioncod:"",oldseccioncod:""}},maxNivelEva:function(){return 2},getAnios:function(){return T.$http.get("api/HyoAnos/getAnios")},getAlumnosSinCierre:function(o){return T.$http.get("api/carpetarecuperacion/getAlumnosSinCierre",{params:{anio:o}})},getListar:function(o,e){return T.$http.get("api/HyoPgprofesor/getAsignacionProfesor",{params:{instrucod:o,anio:e}})},getCursosNivelGrado:function(o,e){return T.$http.get("api/HyoClase/obtClasesNivelGrado",{params:{instrucod:o,gradocod:e}})},grabar:function(o){var e={id:o.id,ano:o.ano,instrucod:o.instrucod,gradocod:o.gradocod,cursocod:o.cursocod,profcod:o.profcod,seccioncod:o.seccioncod,oldseccioncod:o.oldseccioncod};return T.$http.post("api/HyoPgprofesor/registrar",e)},eliminar:function(o){return T.$http.post("api/HyoPgprofesor/eliminar",{id:o})}},L=t(95523),q=t(57668),Q={setup:function(){var o=(0,b.fG)();return{v$:o}},components:{sieAno:A.A,QFab:N.l6,QFabAction:N.B$,sieSalones:U.Ay,QTable:N.kH,QTh:N.EJ,QTr:N.qh,QTd:N.Ef,QToggle:N.c5,QPopupEdit:N.GT,QSelect:N.Si,QPageSticky:N._U,sieSelect:k.A,sieModal:F.A,selectMultiple:L.A,QPage:N.Tu,QToolbar:N.ZV,QToolbarTitle:N.r_,QSearch:N.Ks,QTooltip:N.nC},data:function(){return{sinPermiso:1===(0,q["default"])().ruta.nivel,nemo:null,ano:(0,q["default"])().ano+"",tempRegistro:{},acceso:(0,q["default"])().ruta.nivel>=2,currentRow:{old:{},row:{}},conf:{data:[],columns:[{name:"INSTRUDES",label:"Nivel",field:"INSTRUDES",align:"left"},{name:"GRADODES",label:this.$t("grado"),field:"GRADODES",align:"left",sortable:!1},{name:"SECCIONDES",label:"Sección",field:"SECCIONDES",align:"left",sortable:!1},{name:"CURSONOM",label:this.$t("curso"),field:"CURSONOM",align:"left",sortable:!1},{name:"NOMCOMP",label:this.$t("profesor"),field:"NOMCOMP",align:"left",sortable:!1}],pagination:{page:1,rowsPerPage:200},filter:"",selection:"none",selected:[]},modal:!1,niveles:[],form:V["default"](0,(0,q["default"])().ano),vmFiltro:{instrucod:null,gradocod:[],curso:[],periodo:1},vmRegistro:{instrucod:null,gradocod:[],curso:{},nivel1:{},nivel2:{},periodo:null},dataSelect:{nivel:[],curso:[],cursoReg:[],profesores:[]},gradosTemp:[],maxNivelEva:V.maxNivelEva(),nomPrograma:"",tipoRegistro:1,years:[],anoVigente:(0,q["default"])().ano+""}},computed:{isGreater:function(){return(0,w.isGreater)()},grados:function(){var o=this,e=this.gradosTemp;return this.vmFiltro.instrucod&&this.vmFiltro["instrucod"].length>0?(e=e.filter(function(e){return o.vmFiltro["instrucod"]===e.INSTRUCOD}),e=(0,M["default"])(e,function(o){return{label:o.GRADODES,value:o.GRADOCOD}})):e=[],e},gradosReg:function(){var o=this,e=this.gradosTemp;return this.form.instrucod.length>0?(e=e.filter(function(e){return o.form.instrucod===e.INSTRUCOD}),e=(0,M["default"])(e,function(o){return{label:o.GRADODES,value:o.GRADOCOD}})):e=[],e},verNotaFin:function(){return 0!==this.tipoRegistro},lblNotaIni:function(){return 0===this.tipoRegistro?"Nivel de progreso":"Nota Inicio"},dataDetalle:function(){var o=this,e=this.conf.data;return this.loadingDetalle=!0,this.vmFiltro.curso.length>0&&(e=e.filter(function(e){return o.vmFiltro["curso"].some(function(o){return e.CURSOCOD===o})})),this.vmFiltro.gradocod.length>0&&(e=e.filter(function(e){return o.vmFiltro["gradocod"].some(function(o){return e.GRADOCOD===o})})),this.loadingDetalle=!1,e},actualizarReg:function(){return Object.keys(this.form).length>0&&""!==this.form.id},titulo:function(){return Object.keys(this.form).length>0&&""!==this.form.id?"Actualizar Registro":"Nuevo Registro"}},methods:{getCurrentRow:function(o){o.select=1,this.currentRow={row:o,old:JSON.parse(JSON.stringify(o))}},cambiarProfesor:function(o){var e=this,t=this.currentRow,n=t.old,r=t.row;if("00"===r.PROFCOD)return this.eliminar(0),!1;var i={id:n.ID_PGPROFE,ano:n.ANO,instrucod:n.INSTRUCOD,gradocod:n.GRADOCOD,cursocod:n.CURSOCOD,profcod:o.PROFCOD,seccioncod:n.SECCIONCOD,oldseccioncod:n.SECCIONASIG?n.SECCIONASIG:""};V.grabar(i).then(function(o){var t=o.message?o.message:"Se grabó correctamente";(0,G["default"])(t,"success"),e.getLista()})},seleccionaInstru:function(o){this.vmFiltro.instrucod=o,this.getLista()},seleccionaGrado:function(o){this.vmFiltro.gradocod=o},seleccionaCurso:function(o){this.vmFiltro.curso=o},seleccionaAnio:function(o){this.ano=o,this.getLista()},listarAnios:function(){var o=this;V.getAnios().then(function(e){o.years=e.map(function(o){var e=o.ANO,t=o.ANO;return{value:e,label:t}})})},getLista:function(){var o=this;if(!this.ano)return!1;V.getListar(this.vmFiltro["instrucod"],this.ano).then(function(e){o.conf.data=e,o.form=V["default"](0,o.ano)})},obtNGS:function(){var o=this;Promise.all([_.A.getNiveles(),_.A.getGrados(),_.A.getCursosCurGra(),_.A.getProfesores("21")]).then(function(e){var t=D()(e,4),n=t[0],r=t[1],i=t[2],a=t[3],l=(0,M["default"])(n,function(o){return{label:o.INSTRUDES,value:o.INSTRUCOD}});l.unshift({label:"Todos",value:"T"}),o.dataSelect.nivel=l,o.dataSelect.curso=(0,M["default"])(i,function(o){return{label:o.CURSOCOD+"- "+o.CURSONOM,value:o.CURSOCOD}}),o.gradosTemp=r,a.unshift({ID_PERSONA:"00",NOMCOMP:"Ninguno",PROFCOD:"00",USUCOD:null,USUNOM:"Ninguno"}),o.dataSelect.profesores=a})},seleccionaInstruReg:function(o){this.limpiar("niveles"),this.form.instrucod=o},seleccionarSalon:function(o){var e=this;this.limpiar("grado"),this.form.gradocod=o.GRADOCOD,this.form.instrucod=o.INSTRUCOD,this.form.seccioncod=o.SECCIONCOD,this.dataSelect.cursoReg=[],E.A.getCursosPeriodos(this.nemo,this.ano).then(function(o){var t=(0,I["default"])(o.cursos.k,o.cursos.v),n=[];t=t.filter(function(o){return n.includes(o.CURSOCOD)||"001"===o.GRUPOCOD||(n.push(o.CURSOCOD),o.GRUPOCOD="001",o.CURSONOM=o.CURSONOM?o.CURSONOM.replace(/\([\wáéíóú\s]+\)/gi,"").replace(/\([\wáéíóú\s]+\)/gi,""):o.CURSONOM,o.DESCRIPCION=o.DESCRIPCION?o.DESCRIPCION.replace(/\([\wáéíóú\s]+\)/gi,"").replace(/\([\wáéíóú\s]+\)/gi,""):o.DESCRIPCION),"001"===o.GRUPOCOD});var r=e.dataSelect;r.cursoReg=t,e.dataSelect=r})},loadSalon:function(o){var e=this;if(this.tempRegistro){var t=o.filter(function(o){return o.INSTRUCOD===e.tempRegistro.INSTRUCOD&&o.GRADOCOD===e.tempRegistro.GRADOCOD});this.nemo=t[0]?t[0].NEMO:null}},add:function(o,e){if(!this.ano)return(0,G["default"])("Selecione un año","warning"),!1;this.modal=!0,o?(this.tempRegistro=e,this.form=V["default"](o,e.ANO,e.INSTRUCOD),this.seleccionarSalon(e.GRADOCOD),this.form.gradocod=e.GRADOCOD,this.form.gradocod=e.GRADOCOD,this.form.seccioncod=e.SECCIONCOD,this.form.cursocod=e.CURSOCOD,this.form.ano=e.ANO,this.form.profcod=e.PROFCOD):(this.form=V["default"](0,this.ano),this.tempRegistro={})},grabar:function(){var o=this;return""===this.form.cursocod?((0,G["default"])("Seleccione Curso","warning"),!1):""===this.form.profcod?((0,G["default"])("Seleccione Profesor","warning"),!1):void V.grabar(this.form,this.actualizarReg).then(function(e){var t=e.message?e.message:"Se grabó correctamente";(0,G["default"])(t,"success"),o.limpiar("form"),o.cerrarModal(),o.modal=!1}).catch(function(o){(0,G["default"])("No se pudo grabar","warning")})},limpiar:function(o){switch(o){case"niveles":this.vmRegistro.gradocod=[];case"grado":var e=this.form.instrucod,t=this.form.id;this.form=V["default"](t,this.ano,e),this.vmRegistro.curso={},this.dataSelect.cursoReg=[];break;case"form":this.form.profcod="";break}},eliminar:function(o){var e=this,t=this.currentRow.old;return t?0===o?(o=t.ID_PGPROFE,V.eliminar(o).then(function(o){(0,G["default"])("Registro eliminado","success"),e.getLista()}).catch(function(){(0,G["default"])("No se pudo eliminar","warning")}),!1):(o=t.ID_PGPROFE,void(0,y.confirmar)(this.$t("mensajes.m0006.confirmacion"),function(){V.eliminar(o).then(function(o){(0,G["default"])("Registro eliminado","success"),e.getLista()}).catch(function(o){(0,G["default"])("No se pudo eliminar","warning")})})):((0,G["default"])("Seleccione un registro","warning"),!1)},imprimirReporte:function(){var o={repcod:"listadoProfesoresEtapa",formato:"pdf",ano:this.ano,instrucod:this.vmFiltro.instrucod,gradocod:this.vmFiltro.gradocod};(0,P["default"])(o,"webservice/reportes/reporte")},cerrarModal:function(){this.modal=!1,this.getLista()}},watch:{ano:function(o){this.getLista()}},created:function(){var o=this;E.A.getAnio().then(function(e){o.ano=e.ANO,V.getAlumnosSinCierre(e.ANO).then(function(o){if(o&&o.length){for(var e=[],t=0;t<o.length;t++){var n=o[t];e.includes(n.NEMODES)||e.push(n.NEMODES)}(0,y.swal)("Ejecutar Cierre de año","Falta ejecutar el proceso de Cierre de año escolar en: "+e.join(", "),"warning")}})}),this.getLista(),this.obtNGS(),this.listarAnios()}},$=t(12807);const W=(0,$.A)(Q,[["render",S]]);var x=W}}]);