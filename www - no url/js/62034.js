"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[62034],{62034:function(a,e,l){l.r(e),l.d(e,{default:function(){return J}});var n=l(61758),o={key:0,class:"row q-pb-sm"},r={class:"col-xs-12"},t={class:"col-xs-12"},i={key:1,class:"row q-col-gutter-sm"},s={class:"col-xs-12 col-sm-4 col-md-5"},c={class:"col-xs-12 col-sm-2"},u={class:"col-xs-12 col-sm-2"},d={class:"col-xs-12 col-sm-3"},m={key:2,class:"row q-col-gutter-sm"},f={class:"col-xs-12 col-sm-6"},p={class:"col-xs-12 col-sm-6"},h={class:"col-xs-12 col-sm-6"},g={class:"col-xs-12 col-sm-6"},b={class:"row"},v={class:"col-xs-12"},A={key:1,class:"column"},D={key:0,class:"row q-pa-sm"},P={class:"col-xs-12 col-sm-6"},M={class:"col-xs-12 col-sm-6"},F={class:"col-xs-12"},k={class:"row q-pa-sm"},w={class:"col-xs-12"},C={key:1,class:"column"};function O(a,e){var l=this,O=(0,n.g2)("header-btn"),T=(0,n.g2)("q-radio"),V=(0,n.g2)("q-select"),L=(0,n.g2)("q-input"),x=(0,n.g2)("q-card-section"),y=(0,n.g2)("q-separator"),R=(0,n.g2)("q-spinner-oval"),I=(0,n.g2)("q-inner-loading"),q=(0,n.g2)("sie-table"),E=(0,n.g2)("sie-vacio"),S=(0,n.g2)("q-card"),$=(0,n.g2)("q-d"),N=(0,n.g2)("q-form"),U=(0,n.g2)("sie-modal"),Q=(0,n.g2)("q-page");return(0,n.uX)(),(0,n.Wv)(Q,{class:"asignacionMovilidad q-pa-sm"},{default:(0,n.k6)(function(){return[(0,n.bF)(S,null,{default:(0,n.k6)(function(){return[(0,n.bF)(O,{name:"Alumnos por Transportista",buttons:a.buttons},null,8,["buttons"]),(0,n.bF)(x,null,{default:(0,n.k6)(function(){return[a.mostrarRadio?((0,n.uX)(),(0,n.CE)("div",o,[(0,n.Lk)("div",r,[(0,n.bF)(T,{class:"q-px-md",modelValue:a.operacion,"onUpdate:modelValue":e[0]||(e[0]=function(e){return a.operacion=e}),val:1,label:"Movilidad",color:"secondary",onInput:a.cambiarOperacion},null,8,["modelValue","onInput"])]),(0,n.Lk)("div",t,[(0,n.bF)(T,{class:"q-px-md",modelValue:a.operacion,"onUpdate:modelValue":e[1]||(e[1]=function(e){return a.operacion=e}),val:2,label:"Pull",color:"secondary",onInput:a.cambiarOperacion},null,8,["modelValue","onInput"])])])):(0,n.Q3)("v-if",!0),a.operacion<2?((0,n.uX)(),(0,n.CE)("div",i,[(0,n.Lk)("div",s,[(0,n.bF)(V,{modelValue:a.frm.tracod,"onUpdate:modelValue":e[2]||(e[2]=function(e){return a.frm.tracod=e}),options:a.transportistas,optionValue:"TRACOD",optionLabel:"TRANOMCOM",label:"Transportista",onInput:e[3]||(e[3]=function(e){return a.changeTransportista()})},null,8,["modelValue","options"])]),(0,n.Lk)("div",c,[(0,n.bF)(L,{modelValue:a.frm.tradoc,"onUpdate:modelValue":e[4]||(e[4]=function(e){return a.frm.tradoc=e}),readonly:"",label:"Código","float-label":"Código"},null,8,["modelValue"])]),(0,n.Lk)("div",u,[(0,n.bF)(L,{modelValue:a.frm.traplaca,"onUpdate:modelValue":e[5]||(e[5]=function(e){return a.frm.traplaca=e}),readonly:"",label:"Placa","float-label":"Placa"},null,8,["modelValue"])]),(0,n.Lk)("div",d,[(0,n.bF)(L,{modelValue:a.frm.tramarca,"onUpdate:modelValue":e[6]||(e[6]=function(e){return a.frm.tramarca=e}),readonly:"",label:"Marca","float-label":"Marca"},null,8,["modelValue"])])])):((0,n.uX)(),(0,n.CE)("div",m,[(0,n.Lk)("div",f,[(0,n.bF)(V,{modelValue:a.frmPull.famcod,"onUpdate:modelValue":e[7]||(e[7]=function(e){return a.frmPull.famcod=e}),options:a.familia,optionValue:"FAMCOD",optionLabel:"FAMDES",label:"Familia",onInput:e[8]||(e[8]=function(e){return a.getPadres()})},null,8,["modelValue","options"])]),(0,n.Lk)("div",p,[(0,n.bF)(V,{modelValue:a.frmPull.codpad,"onUpdate:modelValue":e[9]||(e[9]=function(e){return a.frmPull.codpad=e}),options:a.padres,optionValue:"DOC",optionLabel:"NOMBRE",label:"Padre/Madre",onInput:e[10]||(e[10]=function(e){return a.getDatosPadres()})},null,8,["modelValue","options"])]),(0,n.Lk)("div",h,[(0,n.bF)(L,{modelValue:a.frmPull.famdir,"onUpdate:modelValue":e[11]||(e[11]=function(e){return a.frmPull.famdir=e}),readonly:"",label:"Dirección","float-label":"Dirección"},null,8,["modelValue"])]),(0,n.Lk)("div",g,[(0,n.bF)(L,{modelValue:a.frmPull.famtel,"onUpdate:modelValue":e[12]||(e[12]=function(e){return a.frmPull.famtel=e}),readonly:"",label:"Teléfono","float-label":"Teléfono"},null,8,["modelValue"])])]))]}),_:1}),(0,n.bF)(y),(0,n.bF)(x,null,{default:(0,n.k6)(function(){return[(0,n.Lk)("div",b,[(0,n.Lk)("div",v,[(0,n.bF)(I,{visible:a.loadingDetalle},{default:(0,n.k6)(function(){return[(0,n.bF)(R,{size:"50px",color:"primary"})]}),_:1},8,["visible"]),a.dataDetalle.length>0?((0,n.uX)(),(0,n.Wv)(q,{key:0,selection:"multiple",search:"Buscar",ref:"seleccionados",context:l,css:"height:calc(100vh - 295px)",columns:a.configTbl.columnas,data:a.dataDetalle,config:a.dinamicos},null,8,["columns","data","config"])):((0,n.uX)(),(0,n.CE)("div",A,[(0,n.bF)(E,{icon:"settings_applications",style:{height:"calc(100vh - 295px)"}})]))])])]}),_:1})]}),_:1}),(0,n.bF)(U,{class:"modal-asignacion-movilidad",modelValue:a.openModal,"onUpdate:modelValue":e[16]||(e[16]=function(e){return a.openModal=e}),title:"Asignar Alumos por Transportistas",ok:a.$t("botones.guardar"),footer:!0,onSubmit:a.grabarDatos,onClose:a.cerrarModal},{default:(0,n.k6)(function(){return[(0,n.bF)(N,{class:"column",ref:"form"},{default:(0,n.k6)(function(){return[a.operacion>1?((0,n.uX)(),(0,n.CE)("div",D,[(0,n.Lk)("div",P,[(0,n.bF)($,{class:"q-if-outlined",modelValue:a.frmPull.fechaIni,"onUpdate:modelValue":e[13]||(e[13]=function(e){return a.frmPull.fechaIni=e}),label:"FechaIni","float-label":"FechaIni",type:"date",format:"DD/MM/YYYY"},null,8,["modelValue"])]),(0,n.Lk)("div",M,[(0,n.bF)($,{class:"q-if-outlined",modelValue:a.frmPull.fechaFin,"onUpdate:modelValue":e[14]||(e[14]=function(e){return a.frmPull.fechaFin=e}),label:"FechaFin","float-label":"FechaFin",type:"date",format:"DD/MM/YYYY"},null,8,["modelValue"])]),(0,n.Lk)("div",F,[(0,n.bF)(L,{modelValue:a.frmPull.zona,"onUpdate:modelValue":e[15]||(e[15]=function(e){return a.frmPull.zona=e}),label:"Zona","float-label":"Zona"},null,8,["modelValue"])])])):(0,n.Q3)("v-if",!0),(0,n.Lk)("div",k,[(0,n.Lk)("div",w,[(0,n.bF)(I,{visible:a.loadingDetalleAlumno},{default:(0,n.k6)(function(){return[(0,n.bF)(R,{size:"50px",color:"primary"})]}),_:1},8,["visible"]),a.dataDetalleAlumno.length>0?((0,n.uX)(),(0,n.Wv)(q,{key:0,selection:"multiple",search:"Buscar",ref:"alumnosSeleccionados",context:l,css:"height:calc(100vh - 210px)",columns:a.configTblAlumnos.columnas,data:a.dataDetalleAlumno,config:a.dinamicosAlumnos},null,8,["columns","data","config"])):((0,n.uX)(),(0,n.CE)("div",C,[(0,n.bF)(E,{icon:"settings_applications",style:{height:"calc(100vh - 210px)"}})]))])])]}),_:1},512)]}),_:1},8,["modelValue","ok","onSubmit","onClose"])]}),_:1})}var T=l(76080),V=l.n(T),L=l(45254),x=l.n(L),y=(l(71225),l(10239),l(50310),l(5962),l(83190),l(6123)),R=l(88567),I=l(95718),q=l(53380),E=l(9736),S=l(16648),$=l(30640),N=l(80340),U=l(57668),Q=l(65229),z=l(81288),_=l(2739),X=l(33777),Y={data:function(){return{dinamicos:{},configTbl:{columnas:[]},dataDetalle:[]}}},B={data:function(){return{dinamicosAlumnos:{},configTblAlumnos:{columnas:[{name:"ALUCOD",label:"Código",field:"ALUCOD",align:"left",sortable:!0},{name:"NOMCOMP",label:"Apellidos y nombres",field:"NOMCOMP",align:"left",sortable:!0}]},dataDetalle:[]}}},G=l(80660),W=l(2819),Z={directives:{sieActive:Q.A},mixins:[Y,B],components:{QD:y.T5,QCard:R.A,QCardSection:I.A,QSeparator:q.A,QInnerLoading:y.SQ,QSpinnerOval:y.VA,QSelect:S.A,QInput:E.A,QOptionGroup:y.EX,sieModal:$.A,sieVacio:N.A,QForm:_.A,sieTable:X.A,QCheckbox:y.vZ,QRadio:y.$,QPage:y.Tu},props:{},computed:{isLess:function(){return(0,z.isLess)()}},data:function(){var a=this;return{buttons:[{icon:"add",label:"Agregar",permiso:">= 1",click:function(){a.agregar()}},{icon:"delete",label:"Eliminar",permiso:">= 1",click:this.eliminar},{icon:"file_pdf",label:"Pdf",click:function(){a.imprimir("pdf")},permiso:">= 1"},{icon:"file_excel",label:"Xls",click:function(){a.imprimir("xls")},permiso:">= 1"}],sie:(0,U["default"])(),config:{},loadingDetalle:!1,loadingDetalleAlumno:!1,etiquetaLogro:"",usaActividad:!1,usaInstituciones:!1,usaTorneo:!1,usaCategoria:!1,dataDetalle:[],dataDetalleAlumno:[],actividades:[],anios:[],tipos:[],alumnos:[],alumnosPrint:[],padres:[],filtros:[{label:"Todos",value:"T"},{label:"Activos",value:"act"},{label:"Matriculados",value:"matr"}],familia:[],transportistas:[],openModal:!1,operacion:1,mostrarRadio:!0,frm:{tracod:"",tradoc:"",traplaca:"",tramarca:"",zona:""},frmPull:{famcod:"",codpad:"",nompadre:"",famdir:"",famtel:"",fechaIni:new Date((new Date).setDate(1)),fechaFin:new Date,zona:""},frmSave:{codigo:"",nombre:""}}},methods:{configurarTabla:function(){var a=this;return x()(V()().m(function e(){return V()().w(function(e){while(1)switch(e.n){case 0:a.configTbl.columnas=[{name:"NOMCOMP",label:"Apellidos y nombres",field:"NOMCOMP",align:"left",sortable:!0},{name:"NGS",label:"NGS",field:"NGS",align:"left",sortable:!0},{name:"FAMTEL",label:"Teléfono",field:"FAMTEL",align:"left",sortable:!0},{name:"FAMDIR",label:"Direccion",field:"FAMDIR",align:"left",sortable:!0}],a.configTbl.paginacion={page:1,rowsPerPage:500},a.dataDetalle=[];case 1:return e.a(2)}},e)}))()},imprimir:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"pdf",e={};e["ano"]=this.sie.ano,e["tracod"]=this.frm.tracod,e["formato"]=a,e["repcod"]="ListaMovilidad",(0,W.exportFilePhp)(e,"intranet/reporte-node/reporte","ListaMovilidad")},eliminar:function(){var a=this,e=this.$refs.seleccionados.rowsSelected(["ALUCOD"]);0===e.length&&this.$notify("Por favor seleccione los alumnos a eliminar","warning"),this.$confirm("¿Realmente desea eliminar los registros seleccionados?","delete").onOk(x()(V()().m(function l(){var n,o;return V()().w(function(l){while(1)switch(l.p=l.n){case 0:return l.p=0,l.n=1,a.$http.delete("api/TransporController/deleteAsignacionAlumno",{params:{alumnos:e}});case 1:return n=l.v,o=n.message,a.$notify(o,"success"),l.n=2,a.listarAsignacionMovilidad();case 2:l.n=4;break;case 3:l.p=3,l.v,a.$notify("Ocurrió un problema de conexión.","warning");case 4:return l.a(2)}},l,null,[[0,3]])})))},changeTransportista:function(){var a=this;this.frm.tradoc="",this.frm.traplaca="",this.frm.tramarca="",this.frm.tracod||(this.dataDetalle=[]),this.listarAsignacionMovilidad();var e=this.transportistas.filter(function(e){return e.TRACOD===a.frm.tracod});e.length>0&&(this.frm.tradoc=e[0].TRADOC||"",this.frm.traplaca=e[0].TRAPLACA||"",this.frm.tramarca=e[0].TRAMARCA||"")},cambiarOperacion:function(){this.dataDetalle=[],1===this.operacion?(this.frm.tracod="",this.frm.tradoc="",this.frm.traplaca="",this.frm.tramarca=""):(this.frmPull.famcod="",this.frmPull.codpad="",this.frmPull.famdir="",this.frmPull.nompadre="",this.frmPull.famtel="")},listarAsignacionMovilidad:function(){var a=this;return x()(V()().m(function e(){var l;return V()().w(function(e){while(1)switch(e.n){case 0:if(a.dataDetalle=[],2!==a.operacion||a.frmPull.nompadre){e.n=1;break}return e.a(2);case 1:return l=1===a.operacion?a.frm:{tracod:a.frmPull.famcod,nompadre:a.frmPull.nompadre},e.n=2,G.$http.get("api/TransporController/getAsignacionMovilidad",{params:{parametros:l}});case 2:a.dataDetalle=e.v;case 3:return e.a(2)}},e)}))()},listarAlumnos:function(){return x()(V()().m(function a(){return V()().w(function(a){while(1)switch(a.n){case 0:return a.a(2,G.$http.get("api/AlumnoController/getAlumnosSinTransport"))}},a)}))()},agregar:function(){var a=this;return x()(V()().m(function e(){return V()().w(function(e){while(1)switch(e.n){case 0:if(a.frm.tracod||a.frmPull.codpad){e.n=1;break}return a.$notify("No ha seleccionado a un Responsable.","warning"),e.a(2,!1);case 1:return e.n=2,a.listarAlumnos();case 2:a.dataDetalleAlumno=e.v,a.abrirModal();case 3:return e.a(2)}},e)}))()},abrirModal:function(){var a=this;return x()(V()().m(function e(){return V()().w(function(e){while(1)switch(e.n){case 0:a.openModal=!0;case 1:return e.a(2)}},e)}))()},grabarDatos:function(){var a=this;return x()(V()().m(function e(){var l,n,o,r;return V()().w(function(e){while(1)switch(e.p=e.n){case 0:if(e.p=0,l=a.$refs.alumnosSeleccionados.rowsSelected(["ALUCOD"]),0!==l.length){e.n=1;break}return a.$notify("Por favor seleccione los alumnos a asignar","warning"),e.a(2,!1);case 1:if(n={alumnos:l,codigo:a.frm.tracod},2!==a.operacion){e.n=5;break}if(n.codigo=a.frmPull.famcod,!a.frmPull.fechaIni){e.n=2;break}return a.$notify("Por favor indique la fecha de inicio","warning"),e.a(2,!1);case 2:if(!a.frmPull.fechaFin){e.n=3;break}return a.$notify("Por favor indique la fecha de fin","warning"),e.a(2,!1);case 3:if(!a.frmPull.zona){e.n=4;break}return a.$notify("Por favor indique la zona","warning"),e.a(2,!1);case 4:n.pull=!0,n.nompadre=a.frmPull.nompadre,n.fechaIni=a.frmPull.fechaIni,n.fechaFin=a.frmPull.fechaFin,n.zona=a.frmPull.zona,n.tiptra="F",e.n=6;break;case 5:n.zona=a.frm.zona;case 6:return e.n=7,a.$http.post("api/TransporController/guardarAsignacionAlumnos",{data:n});case 7:o=e.v,r=o.message,a.$notify(r,"success"),a.listarAsignacionMovilidad(),a.cerrarModal(),e.n=9;break;case 8:e.p=8,e.v,a.$notify("Ocurrió un problema de conexión.","warning");case 9:return e.a(2)}},e,null,[[0,8]])}))()},getTransportistas:function(a){var e=this;return x()(V()().m(function l(){var n;return V()().w(function(l){while(1)switch(l.n){case 0:return a=a||{},a.activo=1,l.n=1,G.$http.get("api/TransporController/getTranspor",{params:{parametros:a}});case 1:n=l.v,n.unshift({TRACOD:"",TRANOMCOM:"Todos..."}),e.transportistas=n;case 2:return l.a(2)}},l)}))()},getDatosFamilia:function(){var a=this;return x()(V()().m(function e(){var l,n;return V()().w(function(e){while(1)switch(e.n){case 0:return l={},l.columnas=["FAMCOD","FAMDES","PADNOM","PADDOC","PADDIR","PADTEL","MADNOM","MADDOC"],l.order={sidx:"famdes",sord:"asc"},l.estado="A",e.n=1,G.$http.get("api/FamiliaController/getDatosFamilia",{params:{parametros:l}});case 1:n=e.v,n.unshift({FAMCOD:"",FAMDES:"Seleccione..."}),a.familia=n,a.frmPull.famcod="";case 2:return e.a(2)}},e)}))()},getPadres:function(){var a=this;this.listarAsignacionMovilidad();var e=this.familia.filter(function(e){return e.FAMCOD===a.frmPull.famcod});this.padres=[{NOMBRE:"Seleccione...",DOC:""}],e.length>0&&(this.padres.push({NOMBRE:e[0].PADNOM||"",DOC:e[0].PADDOC||"",PADDIR:e[0].PADDIR||"",PADTEL:e[0].PADTEL||"",FLAG:"P"}),this.padres.push({NOMBRE:e[0].MADNOM||"",DOC:e[0].MADDOC||"",MADDIR:e[0].MADDIR||"",MADTEL:e[0].MADTEL||"",FLAG:"M"}),this.frmPull.codpad="",this.frmPull.famdir="",this.frmPull.nompadre="",this.frmPull.famtel="")},getDatosPadres:function(){var a=this,e=this.padres.filter(function(e){return e.DOC===a.frmPull.codpad});e.length>0&&("P"===e[0].FLAG?(this.frmPull.famdir=e[0].PADDIR||"",this.frmPull.famtel=e[0].PADTEL||""):(this.frmPull.famdir=e[0].MADDIR||"",this.frmPull.famtel=e[0].MADTEL||""),this.frmPull.nompadre=e[0].NOMBRE||"",this.listarAsignacionMovilidad())},cerrarModal:function(){var a=this;return x()(V()().m(function e(){return V()().w(function(e){while(1)switch(e.n){case 0:a.openModal=!1;case 1:return e.a(2)}},e)}))()}},created:function(){var a=this;return x()(V()().m(function e(){return V()().w(function(e){while(1)switch(e.n){case 0:return a.mostrarRadio="0038"===a.sie.colcod,e.n=1,a.configurarTabla();case 1:return e.n=2,a.getTransportistas();case 2:return e.n=3,a.getDatosFamilia();case 3:a.listarAsignacionMovilidad();case 4:return e.a(2)}},e)}))()}},j=l(12807);const H=(0,j.A)(Z,[["render",O]]);var J=H}}]);