"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[46724],{46724:function(e,n,t){t.r(n),t.d(n,{default:function(){return K}});var r=t(61758),o={class:"row"},a={class:"col-12"},c={class:"col-xs-12"},l={class:"row q-pa-sm q-col-gutter-sm"},i={class:"col-xs-12 col-sm-6"};function s(e,n){var t=this,s=(0,r.g2)("header-btn"),u=(0,r.g2)("q-select"),d=(0,r.g2)("sie-table"),f=(0,r.g2)("q-card-section"),m=(0,r.g2)("q-card"),p=(0,r.g2)("q-input"),S=(0,r.g2)("q-form"),g=(0,r.g2)("sie-modal"),b=(0,r.g2)("q-page");return(0,r.uX)(),(0,r.Wv)(b,{class:"q-pa-sm sie-flat"},{default:(0,r.k6)(function(){return[(0,r.bF)(m,{flat:"",bordered:""},{default:(0,r.k6)(function(){return[(0,r.bF)(s,{name:"Stock producto por almacén",buttons:e.buttons},null,8,["buttons"]),(0,r.bF)(f,null,{default:(0,r.k6)(function(){return[(0,r.Lk)("div",o,[(0,r.Lk)("div",a,[(0,r.bF)(u,{modelValue:e.producto,"onUpdate:modelValue":n[0]||(n[0]=function(n){return e.producto=n}),options:e.productos,"option-label":"DESCRIPCION","option-value":"IDPRODUCTO",label:"Producto","emit-value":"",onInput:e.readStoProAlm},null,8,["modelValue","options","onInput"])]),(0,r.Lk)("div",c,[(0,r.bF)(d,{type:"normal",data:e.rows,columns:e.fields,config:e.config,selection:"none","save-cells":"",ref:"tableStoProAlm",onRowSelected:e.rowSelectStoProAlm,css:"height:calc(100vh - 170px)",context:t},null,8,["data","columns","config","onRowSelected"])])])]}),_:1})]}),_:1}),(0,r.bF)(g,{esc:"","esc-click":"",modelValue:e.openAdd,"onUpdate:modelValue":n[2]||(n[2]=function(n){return e.openAdd=n}),css:{width:"500px"},title:"create"===e.action?"Agregar":"Modificar",onSubmit:e.saveAcccion},{default:(0,r.k6)(function(){return[(0,r.bF)(S,{ref:"refForm"},{default:(0,r.k6)(function(){return[(0,r.Lk)("div",l,[(0,r.Lk)("div",i,[(0,r.bF)(p,{modelValue:e.form.STOCK,"onUpdate:modelValue":n[1]||(n[1]=function(n){return e.form.STOCK=n}),label:"STOCK"},null,8,["modelValue"])])])]}),_:1},512)]}),_:1},8,["modelValue","title","onSubmit"])]}),_:1})}var u=t(76080),d=t.n(u),f=t(45254),m=t.n(f),p=(t(89571),t(6123)),S={data:function(){return{config:{STOCK:{renderHtml:function(e,n,t){var r=e.STOCK_MINIMO;r=r||0;var o=r+.2*r,a={fontWeight:"bold",fontSize:"13px"};return e.STOCK<r?t.background({text:e.STOCK,textColor:"red",color:"transparent",align:"center",style:a}):e.STOCK>r&&e.STOCK<o?t.background({text:e.STOCK,textColor:"orange",color:"transparent",align:"center",style:a}):t.background({text:e.STOCK,textColor:"green",color:"transparent",align:"center",style:a})},tooltip:function(e){var n=e.STOCK_MINIMO;n=n||0;var t=n+.2*n;return e.STOCK<n?"Stock por debajo del mínimo":e.STOCK>n&&e.STOCK<t?"Se recomienda aumentar el stock":"Stock recomendado"}}},rows:[],fields:[{name:"DESCRIPCION",label:"Descripción",field:"DESCRIPCION",align:"left",sortable:!0},{name:"IDPRODUCTO",label:"Código",field:"IDPRODUCTO",align:"center",sortable:!0},{name:"MARCA",label:"Marca",field:"MARCA",align:"left",sortable:!0},{name:"UNIDAD",label:"Unidad",field:"UNIDAD",align:"left",sortable:!0},{name:"STOCK_MINIMO",label:"Stock Min.",field:"STOCK_MINIMO",align:"center",sortable:!0},{name:"STOCK_MAXIMO",label:"Stock Max.",field:"STOCK_MAXIMO",align:"center",sortable:!0},{name:"STOCK",label:"Stock",field:"STOCK",align:"center",sortable:!0}]}}},g=t(39893),b=t(81288),w=t(2739),h=t(9736),v=t(88567),A=t(95718),C=t(43136),O=t(5215),k={mixins:[S,C.initialConfig],components:{QForm:w.A,QInput:h.A,QCard:v.A,QCardSection:A.A,QSelect:O.A,QPage:p.Tu},data:function(){return{required:g.require,buttons:[],openAdd:!1,action:"create",rowStoProAlm:null,almacenes:[],productos:[],producto:null,form:{STOCK:null}}},methods:{openAgregar:function(){this.action="create",this.rowStoProAlm=null,(0,b.clear)(this.form),this.openAdd=!0},openActualizar:function(){this.rowStoProAlm?(this.action="update",this.form.STOCK=this.rowStoProAlm.STOCK,this.openAdd=!0):this.$notify("Selecciona un registro","info")},saveAcccion:function(){var e=this;return m()(d()().m(function n(){var t,r,o;return d()().w(function(n){while(1)switch(n.n){case 0:return n.n=1,e.$refs.refForm.validate();case 1:if(t=n.v,t){n.n=2;break}return n.a(2);case 2:if("create"!==e.action){n.n=4;break}return n.n=3,e.$confirmar("El registro se creará ¿Desea continuar?","info");case 3:r=n.v,r&&e.createStoProAlm(),n.n=6;break;case 4:return n.n=5,e.$confirmar("El registro se modificará ¿Desea continuar?","info");case 5:o=n.v,o&&e.updateStoProAlm();case 6:return n.a(2)}},n)}))()},rowSelectStoProAlm:function(e,n){this.rowStoProAlm=n},createStoProAlm:function(){var e=this;return m()(d()().m(function n(){var t,r,o,a;return d()().w(function(n){while(1)switch(n.p=n.n){case 0:return n.p=0,n.n=1,e.$http.post("api/sto-pro-alm",e.form);case 1:t=n.v,t.result,r=t.message,o={STOCK:e.form.STOCK},e.rows.unshift(o),e.openAdd=!1,e.$notify(r,"success"),n.n=3;break;case 2:n.p=2,a=n.v,e.$notify(a.message,"warning");case 3:return n.a(2)}},n,null,[[0,2]])}))()},readStoProAlm:function(){var e=this;return m()(d()().m(function n(){var t,r;return d()().w(function(n){while(1)switch(n.p=n.n){case 0:return n.p=0,n.n=1,e.$http.get("api/HyoArticulos/readProductoExistenciasPorAlmacen",{params:{id_local:e.id_local,idproducto:e.producto}});case 1:t=n.v,e.rows=t,n.n=3;break;case 2:n.p=2,r=n.v,e.$notify(r.message,"warning");case 3:return n.a(2)}},n,null,[[0,2]])}))()},readAlmacen:function(){var e=this;return m()(d()().m(function n(){var t;return d()().w(function(n){while(1)switch(n.p=n.n){case 0:return n.p=0,n.n=1,e.$http.get("api/HyoAlmacenes/getAlmacenesBySede",{params:{id_local:e.id_local,idalmacen:e.almacen}});case 1:e.almacenes=n.v,n.n=3;break;case 2:n.p=2,t=n.v,e.$notify(t.message,"warning");case 3:return n.a(2)}},n,null,[[0,2]])}))()},readProducto:function(){var e=arguments,n=this;return m()(d()().m(function t(){var r,o,a,c;return d()().w(function(t){while(1)switch(t.n){case 0:return r=e.length>0&&void 0!==e[0]?e[0]:["idproducto","descripcion"],o={empcod:n.empcod,fields:r},t.n=1,n.$http.get("api/HyoArticulos/getAllArticulos",{params:o});case 1:a=t.v,c=a.json,n.productos=c;case 2:return t.a(2)}},t)}))()},deleteStoProAlm:function(){var e=this;return m()(d()().m(function n(){var t,r,o,a;return d()().w(function(n){while(1)switch(n.p=n.n){case 0:if(e.rowStoProAlm){n.n=1;break}e.$notify("Selecciona un registro","info"),n.n=6;break;case 1:return n.n=2,e.$confirmar("¿Estás seguro de eliminar el registro?","delete");case 2:if(t=n.v,!t){n.n=6;break}return n.p=3,n.n=4,e.$http.delete("api/sto-pro-alm/");case 4:r=n.v,o=r.message,e.rows.splice(e.rows.indexOf(e.rowStoProAlm),1),e.rowStoProAlm=null,e.$notify(o,"success"),n.n=6;break;case 5:n.p=5,a=n.v,e.$notify(a.message,"warning");case 6:return n.a(2)}},n,null,[[3,5]])}))()},updateStoProAlm:function(){var e=this;return m()(d()().m(function n(){var t,r,o,a;return d()().w(function(n){while(1)switch(n.p=n.n){case 0:return n.p=0,t=e.$refs.tableStoProAlm,n.n=1,e.$http.put("api/sto-pro-alm",{STOCK:e.form.STOCK});case 1:r=n.v,o=r.message,e.openAdd=!1,t.updateRow(e.rowStoProAlm,e.form),e.$notify(o,"success"),n.n=3;break;case 2:n.p=2,a=n.v,e.$notify(a.message,"warning");case 3:return n.a(2)}},n,null,[[0,2]])}))()}},created:function(){var e=this;return m()(d()().m(function n(){var t;return d()().w(function(n){while(1)switch(n.p=n.n){case 0:return n.p=0,n.n=1,e.readProducto();case 1:n.n=3;break;case 2:n.p=2,t=n.v,e.$notify(t.message,"warning");case 3:return n.a(2)}},n,null,[[0,2]])}))()}},P=t(12807);const T=(0,P.A)(k,[["render",s]]);var K=T}}]);