"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[15642],{15642:function(e,t,r){r.r(t),r.d(t,{default:function(){return q}});var n=r(61758),a=r(29104),o={class:"row q-col-gutter-md text-weight-thin text-bold"},i={class:"col-xs-12"},c={class:"row q-pa-sm q-col-gutter-sm"},l={class:"col-12"},s={class:"col-12"},u={class:"col-xs-12 col-sm-6"},d={class:"row q-col-gutter-lg"},f={class:"col-12 text-center"},g={class:"col-xs-12 col-sm-6"},m={class:"row q-col-gutter-lg"},p={class:"col-12 text-center"};function b(e,t){var r=this,b=(0,n.g2)("header-btn"),h=(0,n.g2)("sie-table"),C=(0,n.g2)("q-card-section"),w=(0,n.g2)("q-card"),v=(0,n.g2)("q-input"),M=(0,n.g2)("multi-n-g"),I=(0,n.g2)("q-icon"),A=(0,n.g2)("q-img"),k=(0,n.g2)("q-form"),y=(0,n.g2)("sie-modal"),L=(0,n.g2)("q-page");return(0,n.uX)(),(0,n.Wv)(L,{class:"biblioteca-mantenimiento-categoria q-pa-sm sie-flat"},{default:(0,n.k6)(function(){return[(0,n.bF)(w,{flat:"",bordered:""},{default:(0,n.k6)(function(){return[(0,n.bF)(b,{name:"Categoría",auto:!1,buttons:e.buttons},null,8,["buttons"]),(0,n.bF)(C,null,{default:(0,n.k6)(function(){return[(0,n.Lk)("div",o,[(0,n.Lk)("div",i,[((0,n.uX)(),(0,n.Wv)(h,{ref:"tabla",columns:e.fields,data:e.rows,selection:"single",config:e.config,context:r,key:e.key,css:{height:"calc(100vh - 165px)"}},null,8,["columns","data","config"]))])])]}),_:1})]}),_:1}),(0,n.bF)(y,{modelValue:e.openModal,"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.openModal=t}),title:e.title,onSubmit:e.guardarCategoria,css:{width:"700px"}},{default:(0,n.k6)(function(){return[(0,n.bF)(k,{ref:"refCategoria"},{default:(0,n.k6)(function(){return[(0,n.Lk)("div",c,[(0,n.Lk)("div",l,[(0,n.bF)(v,{modelValue:e.form.nombre,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.form.nombre=t}),label:"Nombre",rules:[e.required]},null,8,["modelValue","rules"])]),(0,n.Lk)("div",s,[(0,n.bF)(M,{class:"q-col-gutter-sm",ref:"refMultiNG","nivel-todos":"","grado-todos":"",n:e.form.nivel,g:e.form.grado,"class-nivel":"col-xs-12","class-grado":"col-xs-12"},null,8,["n","g"])]),(0,n.Lk)("div",u,[(0,n.Lk)("div",d,[t[6]||(t[6]=(0,n.Lk)("div",{class:"col-12 text-center"},[(0,n.Lk)("b",null,"Imagen Lúdica")],-1)),(0,n.Lk)("div",f,[(0,n.bo)((0,n.bF)(v,{accept:e.accept,ref:"fileLudica",type:"file",onChange:t[1]||(t[1]=function(t){return e.putImage(1)})},null,8,["accept"]),[[a.aG,!1]]),(0,n.bF)(A,{class:"cursor-pointer",contain:"",src:e.currentRow.IMG_LUDICAS,style:{height:"200px"},onClick:t[2]||(t[2]=function(t){return e.loadImage(1)})},{error:(0,n.k6)(function(){return[(0,n.bF)(I,{size:"150px",name:"photo",color:"primary"})]}),_:1},8,["src"])])])]),(0,n.Lk)("div",g,[(0,n.Lk)("div",m,[t[7]||(t[7]=(0,n.Lk)("div",{class:"col-12 text-center"},[(0,n.Lk)("b",null,"Imagen Mayores")],-1)),(0,n.Lk)("div",p,[(0,n.bo)((0,n.bF)(v,{accept:e.accept,ref:"fileMayores",type:"file",onChange:t[3]||(t[3]=function(t){return e.putImage(2)})},null,8,["accept"]),[[a.aG,!1]]),(0,n.bF)(A,{class:"cursor-pointer",contain:"",src:e.currentRow.IMG_MAYORES,style:{height:"200px"},onClick:t[4]||(t[4]=function(t){return e.loadImage(2)})},{error:(0,n.k6)(function(){return[(0,n.bF)(I,{size:"150px",name:"photo",color:"primary"})]}),_:1},8,["src"])])])])])]}),_:1},512)]}),_:1},8,["modelValue","title","onSubmit"])]}),_:1})}var h=r(76080),C=r.n(h),w=r(45254),v=r.n(w),M=(r(39866),r(23825),r(70199),r(515),r(83190),r(66307),r(7346),r(24066),r(57053),r(94013),r(32701),r(67396),r(50923),r(59502),r(6123)),I=(r(30683),r(89571),r(80660)),A={data:function(){return{config:{ACTION:{component:"button",icon:["edit","delete"],edit:function(e,t){var r=this;return v()(C()().m(function n(){var a,o,i;return C()().w(function(n){while(1)switch(n.n){case 0:return r.currentRow=t,r.action="update",r.form.nombre=e.CATNOM,n.n=1,r.$http.get("api/HyoBmCategorias/getCategoriaNG",{params:{catcod:e.CATCOD}});case 1:a=n.v,o=a.nivel,i=a.grado,r.form.nivel=o,r.form.grado=i,r.openModal=!0;case 2:return n.a(2)}},n)}))()},delete:function(e,t){var r=this;return v()(C()().m(function n(){var a,o;return C()().w(function(n){while(1)switch(n.p=n.n){case 0:return n.n=1,r.$confirmar("¿Está seguro de eliminar la categoría? ¡El proceso es irreversible!","delete");case 1:if(a=n.v,!a){n.n=5;break}return n.p=2,n.n=3,r.$http.delete("api/HyoBmCategorias/deleteCategoria",{params:{catcod:e.CATCOD}});case 3:r.rows.splice(r.rows.indexOf(t),1),r.$notify("Proceso finalizado correctamente","success"),n.n=5;break;case 4:n.p=4,o=n.v,console.log("e",o),r.$notify("No ha sido posible eliminar la categoría","warning");case 5:return n.a(2)}},n,null,[[2,4]])}))()},tooltip:{edit:"Editar",delete:"Eliminar"},permisos:{edit:">1",delete:"===3"},dense:!0,flat:!0},IMG_LUDICAS:{renderHtml:function(e,t,r,n){var a=n.IMAGE_KEY||0,o="".concat(this.sie.url,"/").concat(I.API_LMS,"/api/HyoCatalogo/descargarImagenCategoria/").concat(e.CATCOD,"/1?sie-token=").concat(this.sie.token,"&rnd=").concat(a);return n.IMG_LUDICAS=o,t("img",{src:o,width:"30px"})}},IMG_MAYORES:{renderHtml:function(e,t,r,n){var a=n.IMAGE_KEY||0,o="".concat(this.sie.url,"/").concat(I.API_LMS,"/api/HyoCatalogo/descargarImagenCategoria/").concat(e.CATCOD,"/2?sie-token=").concat(this.sie.token,"&rnd=").concat(a);return n.IMG_MAYORES=o,t("img",{src:o,width:"30px"})}}},rows:[],fields:[{name:"CATNOM",label:"Nombre",field:"CATNOM",align:"left",sortable:!0},{name:"IMG_LUDICAS",label:"Imagen Lúdica",field:"IMG_LUDICAS",align:"center",sortable:!0},{name:"IMG_MAYORES",label:"Imagen",field:"IMG_MAYORES",align:"center",sortable:!0},{name:"ACTION",label:"Acción",field:"ACTION",align:"center",width:60}]}}},k=r(9736),y=r(2739),L=r(53399),S=r(57668),O=r(88567),_=r(25662),G=r(95718),$={mixins:[A],components:{QInput:k.A,QForm:y.A,QImg:L.A,QCard:O.A,multiNG:_.A,QCardSection:G.A,QPage:M.Tu,QIcon:M.bP},data:function(){var e=this;return{sie:(0,S["default"])(),buttons:[{label:"Agregar",icon:"plus",permiso:">1",click:function(){e.currentRow={IMG_LUDICAS:"http://",IMG_MAYORES:"http://"},e.action="create",e.form.nombre=null,e.openModal=!0}}],openModal:!1,action:"create",form:{nombre:null,nivel:[],grado:[]},currentRow:{IMG_LUDICAS:"http://",IMG_MAYORES:"http://"},accept:".jpg, .png",key:0}},computed:{title:function(){return"create"===this.action?"Agregar Categoría":"Edición de Categoría"}},methods:{required:function(e){return![null,void 0,""].includes(e)||"Campo requerido"},getCategorias:function(){var e=this;return v()(C()().m(function t(){return C()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,e.$http.get("api/HyoBmCategorias/getCategoria");case 1:e.rows=t.v;case 2:return t.a(2)}},t)}))()},guardarCategoria:function(){var e=this;return v()(C()().m(function t(){var r;return C()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,e.$refs.refCategoria.validate();case 1:if(r=t.v,r){t.n=2;break}return t.a(2);case 2:return t.n=3,e.guardar();case 3:return t.a(2)}},t)}))()},loadImage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;1===e?this.$refs.fileLudica.$el.querySelector("input").click():this.$refs.fileMayores.$el.querySelector("input").click()},putImage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;try{var t=JSON.parse(JSON.stringify(this.currentRow));1===e?(t.IMG_LUDICAS=window.URL.createObjectURL(this.$refs.fileLudica.$el.querySelector("input").files[0]),t.IMAGE_KEY=Date.now()):(t.IMG_MAYORES=window.URL.createObjectURL(this.$refs.fileMayores.$el.querySelector("input").files[0]),t.IMAGE_KEY=Date.now()),this.currentRow=t}catch(e){}},guardar:function(){var e=this;return v()(C()().m(function t(){var r,n,a,o,i,c;return C()().w(function(t){while(1)switch(t.p=t.n){case 0:if(r=e.$refs.refMultiNG.getCombinacionTodos(),!(r.length<1)){t.n=1;break}return t.a(2,e.$notify("Nivel y Grado son obligatorios","warning"));case 1:return n=new FormData,(e.currentRow.IMG_LUDICAS||"").indexOf("blob:")>-1&&n.append("fimagenludica",e.$refs.fileLudica.$el.querySelector("input").files[0]),(e.currentRow.IMG_MAYORES||"").indexOf("blob:")>-1&&n.append("fimagenmayores",e.$refs.fileMayores.$el.querySelector("input").files[0]),"update"===e.action&&n.append("catcod",e.currentRow.CATCOD),n.append("catnom",e.form.nombre),n.append("ng",r),n.append("action",e.action),t.p=2,t.n=3,e.$http.post("api/HyoBmCategorias/guardarCategoria",n,{headers:{"Content-Type":"multipart/form-data"}});case 3:return a=t.v,o=a.message,"create"===e.action?e.rows.unshift({CATCOD:o.CATCOD,CATNOM:e.form.nombre}):(i=JSON.parse(JSON.stringify(e.currentRow)),i.CATNOM=e.form.nombre,e.rows[e.currentRow.$$key]=i,e.key=Date.now()),e.openModal=!1,t.a(2,e.$notify("Se grabó correctamente","success"));case 4:if(t.p=4,c=t.v,e.openModal=!1,"string"!==typeof c.message){t.n=5;break}return e.$notify(c.message,"warning"),t.a(2);case 5:e.$notify("No ha sido posible actualizar el registro.","warning");case 6:return t.a(2)}},t,null,[[2,4]])}))()}},created:function(){var e=this;return v()(C()().m(function t(){return C()().w(function(t){while(1)switch(t.n){case 0:return t.n=1,e.getCategorias();case 1:return t.a(2)}},t)}))()}},R=r(12807);const x=(0,R.A)($,[["render",b]]);var q=x}}]);