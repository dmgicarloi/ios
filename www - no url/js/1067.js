"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[1067],{1067:function(e,a,t){t.r(a),t.d(a,{default:function(){return x}});var o=t(61758),l={class:"column"};function i(e,a){var t=(0,o.g2)("q-tab"),i=(0,o.g2)("registro"),s=(0,o.g2)("listado"),n=(0,o.g2)("q-tab-pane"),r=(0,o.g2)("q-tabs");return(0,o.uX)(),(0,o.CE)("div",l,[(0,o.bF)(r,{class:"q card",animated:"",inverted:"",modelValue:e.tabSelect,"onUpdate:modelValue":a[0]||(a[0]=function(a){return e.tabSelect=a})},{title:(0,o.k6)(function(){return[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.tabs,function(e){return(0,o.uX)(),(0,o.Wv)(t,{key:e,label:e,name:e},null,8,["label","name"])}),128))]}),default:(0,o.k6)(function(){return[(0,o.bF)(n,{name:e.tabSelect},{default:(0,o.k6)(function(){return["registro"==e.tabSelect?((0,o.uX)(),(0,o.Wv)(i,{key:0,is:e.tabSelect,listaEstados:e.listaEstados},null,8,["is","listaEstados"])):(0,o.Q3)("v-if",!0),"listado"==e.tabSelect?((0,o.uX)(),(0,o.Wv)(s,{key:1,is:e.tabSelect,listaEstados:e.listaEstados},null,8,["is","listaEstados"])):(0,o.Q3)("v-if",!0)]}),_:1},8,["name"])]}),_:1},8,["modelValue"])])}var s=t(6123),n=t(57668),r={class:"column items-stretch"},c={class:"column q-pa-sm"},u={key:0,class:"row"},d={key:0,class:"col q-pl-sm"},f={class:"row"};function p(e,a){var t=(0,o.g2)("header-btn"),l=(0,o.g2)("sieFamilia"),i=(0,o.g2)("q-table"),s=(0,o.g2)("q-datetime"),n=(0,o.g2)("q-select"),p=(0,o.g2)("q-input");return(0,o.uX)(),(0,o.CE)("div",r,[(0,o.bF)(t,{name:"Control de Asistencia de Familia",buttons:e.buttons},null,8,["buttons"]),(0,o.Lk)("div",c,[(0,o.bF)(l,{onSelected:e.cargarAsistencia,"filter-mode":2},null,8,["onSelected"]),e.hijos.length>0?((0,o.uX)(),(0,o.CE)("div",u,[(0,o.bF)(i,{class:"col-8","table-style":"min-height: 60vh","row-key":"ALUCOD",data:e.hijos,selection:e.configTblListado.tipoSeleccion,selected:e.configTblListado.registrosSeleccionados,"onUpdate:selected":a[0]||(a[0]=function(a){return e.configTblListado.registrosSeleccionados=a}),columns:e.configTblListado.columns,"hide-bottom":""},null,8,["data","selection","selected","columns"]),e.configTblListado.registrosSeleccionados.length>0?((0,o.uX)(),(0,o.CE)("div",d,[(0,o.Lk)("div",f,[(0,o.bF)(s,{class:"col-5 q-if-outlined",modelValue:e.now,"onUpdate:modelValue":a[1]||(a[1]=function(a){return e.now=a}),type:"date","stack-label":e.$t("fecha"),format:"DD/MM/YYYY"},null,8,["modelValue","stack-label"]),(0,o.bF)(s,{class:"col-5 q-if-outlined",modelValue:e.now,"onUpdate:modelValue":a[2]||(a[2]=function(a){return e.now=a}),type:"time","stack-label":e.$t("hora")},null,8,["modelValue","stack-label"])]),(0,o.bF)(n,{class:"q-if-outlined",modelValue:e.estado,"onUpdate:modelValue":a[3]||(a[3]=function(a){return e.estado=a}),options:e.listaEstados,"stack-label":e.$t("configuracionMatricula.aviso.estado")},null,8,["modelValue","options","stack-label"]),(0,o.bF)(p,{class:"q-if-outlined",modelValue:e.observacion,"onUpdate:modelValue":a[4]||(a[4]=function(a){return e.observacion=a}),type:"textarea","stack-label":e.$t("observacion"),rows:"5"},null,8,["modelValue","stack-label"])])):(0,o.Q3)("v-if",!0)])):(0,o.Q3)("v-if",!0)])])}t(10239),t(50310),t(90095),t(83190),t(13715);var b=t(96122),m=t(80660),h=t(96529),g=t(69027),v={components:{QCheckbox:s.vZ,QCollapsible:s.eS,QScrollArea:b.A,QTable:s.kH,QTd:s.Ef,QSelect:s.Si,QDatetime:s.T5,sieFamilia:h.A,QPageSticky:s._U,QInput:s.ie},props:["listaEstados"],data:function(){return{now:new Date,sie:(0,n["default"])(),hijos:[],estado:"P",familiaSelect:{},observacion:null,configTblListado:{}}},methods:{cargarAsistencia:function(e){var a=this;this.familiaSelect=e,this.hijos=[],this.configTblListado.registrosSeleccionados=[],e=e.FAMCOD,m.$http.get("api/HyoHorasisfam/obtAsistenciaFamilia",{params:{famcod:e}}).then(function(e){var t=e.json;t.forEach(function(e){e.ESTADO||a.hijos.push(e)}),1===a.hijos.length&&(a.configTblListado.registrosSeleccionados=a.hijos)})},creaTabla:function(){var e={columns:[{name:"ALUCOD",field:"ALUCOD",label:"Codigo",align:"left"},{name:"NOMCOMP",label:"Estudiante",field:"NOMCOMP",align:"left"},{name:"NEMODES",label:"Salón",field:"NEMODES",align:"left"}],paginacion:{page:1,rowsPerPage:500},registrosSeleccionados:[],tipoSeleccion:"multiple"};this.configTblListado=e},grabarAsistencia:function(){var e=this,a=[];this.configTblListado.registrosSeleccionados.forEach(function(e){var t=e.ALUCOD,o=e.NEMO;a.push({ALUCOD:t,NEMO:o})}),(0,g.dialogConfirm)({message:"¿Estas seguro de registrar la asistencia?"}).then(function(t){var o={arrAlumnos:a,fhIngreso:e.now,observacion:e.observacion,estado:e.estado};m.$http.post("api/HyoHorasisfam/registrarAsistencia",o).then(function(a){var t=a.json;(0,g.dialogConfirm)({title:e.$t(t),ok:"Aceptar",cancel:!1}).then(function(a){"asistenciaConfirmada"===t&&e.cargarAsistencia(e.familiaSelect)})})}),console.log(this.configTblListado.registrosSeleccionados)}},created:function(){this.creaTabla()},computed:{buttons:function(){var e=[];return this.configTblListado.registrosSeleccionados.length>0&&e.push({label:"Grabar",icon:"save",click:this.grabarAsistencia}),e}}},A=t(12807);const S=(0,A.A)(v,[["render",p]]);var E=S,k=(t(71225),t(5962),{class:"column items-stretch"}),D={class:"row"},M={class:"row q-pa-sm"},V={class:"column"},F={class:"row items-stetch"},T={class:"row"},y={class:"row"},O={class:"row justify-center"};function w(e,a){var t=(0,o.g2)("header-btn"),l=(0,o.g2)("q-search"),i=(0,o.g2)("q-datetime"),s=(0,o.g2)("q-select"),n=(0,o.g2)("q-table"),r=(0,o.g2)("q-option-group"),c=(0,o.g2)("sie-select"),u=(0,o.g2)("q-btn"),d=(0,o.g2)("q-btn-group"),f=(0,o.g2)("sie-modal");return(0,o.uX)(),(0,o.CE)("div",k,[(0,o.bF)(t,{name:"Listado de Asistencia de Familia",buttons:e.buttons},null,8,["buttons"]),(0,o.Lk)("div",D,[(0,o.bF)(l,{class:"col-5 q-if-outlined",modelValue:e.filter,"onUpdate:modelValue":a[0]||(a[0]=function(a){return e.filter=a})},null,8,["modelValue"]),(0,o.bF)(i,{class:"col-2 q-if-outlined",modelValue:e.fIni,"onUpdate:modelValue":a[1]||(a[1]=function(a){return e.fIni=a}),type:"date","stack-label":e.$t("desde"),onInput:e.buscarData,format:"DD/MM/YYYY"},null,8,["modelValue","stack-label","onInput"]),(0,o.bF)(i,{class:"col-2 q-if-outlined",modelValue:e.fFin,"onUpdate:modelValue":a[2]||(a[2]=function(a){return e.fFin=a}),type:"date","stack-label":e.$t("hasta"),onInput:e.buscarData,format:"DD/MM/YYYY"},null,8,["modelValue","stack-label","onInput"]),(0,o.bF)(s,{class:"col-2 q-if-outlined",modelValue:e.estado,"onUpdate:modelValue":a[3]||(a[3]=function(a){return e.estado=a}),options:e.listaEstados,"stack-label":e.$t("configuracionMatricula.aviso.estado"),onInput:e.filtrarAsistencia},null,8,["modelValue","options","stack-label","onInput"])]),(0,o.bF)(n,{class:"col-8","table-style":"max-height: 60vh;max-width 60px !important","row-key":"ALUCOD",filter:e.filter,data:e.dataAsistencia,selected:e.tablaAsistencia.registrosSeleccionados,"onUpdate:selected":a[4]||(a[4]=function(a){return e.tablaAsistencia.registrosSeleccionados=a}),columns:e.tablaAsistencia.columns,pagination:e.tablaAsistencia.paginacion,"onUpdate:pagination":a[5]||(a[5]=function(a){return e.tablaAsistencia.paginacion=a})},null,8,["filter","data","selected","columns","pagination"]),(0,o.bF)(f,{class:"sie-modal-adjuntos",modelValue:e.modalReportes,"onUpdate:modelValue":a[13]||(a[13]=function(a){return e.modalReportes=a}),title:"Reportes de Asistencia",footer:!1},{default:(0,o.k6)(function(){return[(0,o.Lk)("div",M,[(0,o.bF)(r,{class:"col-xs-12 col-md-6",type:"radio",color:"secondary",modelValue:e.reporte.id,"onUpdate:modelValue":a[6]||(a[6]=function(a){return e.reporte.id=a}),options:e.listaReportes},null,8,["modelValue","options"]),(0,o.Lk)("div",V,[(0,o.Lk)("div",F,["001"==e.reporte.id||"002"==e.reporte.id?((0,o.uX)(),(0,o.Wv)(c,{key:0,class:"col-12",type:"outlined",modelValue:e.reporte.nemo,"onUpdate:modelValue":a[7]||(a[7]=function(a){return e.reporte.nemo=a}),options:1==e.reporte.id?e.salonesTodos:e.salones,label:"NEMODES",val:"NEMO",placeholder:"Salon"},null,8,["modelValue","options"])):(0,o.Q3)("v-if",!0)]),(0,o.Lk)("div",T,["001"==e.reporte.id?((0,o.uX)(),(0,o.Wv)(i,{key:0,class:"q-if-outlined",modelValue:e.reporte.fecini,"onUpdate:modelValue":a[8]||(a[8]=function(a){return e.reporte.fecini=a}),type:"date","stack-label":e.$t("desde"),format:"DD/MM/YYYY"},null,8,["modelValue","stack-label"])):(0,o.Q3)("v-if",!0),"001"==e.reporte.id?((0,o.uX)(),(0,o.Wv)(i,{key:1,class:"q-if-outlined",modelValue:e.reporte.fecfin,"onUpdate:modelValue":a[9]||(a[9]=function(a){return e.reporte.fecfin=a}),type:"date","stack-label":e.$t("hasta"),format:"DD/MM/YYYY"},null,8,["modelValue","stack-label"])):(0,o.Q3)("v-if",!0)]),(0,o.Lk)("div",y,["003"==e.reporte.id?((0,o.uX)(),(0,o.Wv)(s,{key:0,class:"col-12 q-if-outlined",modelValue:e.reporte.periodo,"onUpdate:modelValue":a[10]||(a[10]=function(a){return e.reporte.periodo=a}),options:e.periodos,"stack-label":e.$t("periodo")},null,8,["modelValue","options","stack-label"])):(0,o.Q3)("v-if",!0)])])]),(0,o.Lk)("div",O,[(0,o.bF)(d,{push:""},{default:(0,o.k6)(function(){return[(0,o.bF)(u,{color:"secondary",label:"Exp. Excel",icon:"file_excel",push:"",onClick:a[11]||(a[11]=function(a){return e.imprimir("xls")})}),(0,o.bF)(u,{color:"secondary",label:"Exp. PDF",icon:"file_pdf",push:"",onClick:a[12]||(a[12]=function(a){return e.imprimir("pdf")})})]}),_:1})])]}),_:1},8,["modelValue"])])}var C=t(57008),Q=t.n(C),Y=t(30640),U=t(18105),q=t(93616),L=t(2819),P=t(33001),I=function(e){return(0,U.Ay)(e,"DD/MM/YYYY")},N={components:{QCheckbox:s.vZ,QCollapsible:s.eS,QScrollArea:b.A,QTable:s.kH,QTd:s.Ef,QSelect:s.Si,QDatetime:s.T5,QPageSticky:s._U,sieModal:Y.A,QOptionGroup:s.EX,QBtnGroup:s.bk,QBtn:s.Il,sieSelect:q.A,QSearch:s.Ks},props:["listaEstados"],data:function(){return{now:new Date,sie:(0,n["default"])(),tablaAsistencia:{},asistencia:[],fIni:new Date,fFin:new Date,filter:"",estado:"%",dataAsistencia:[],modalReportes:!1,salones:[],salonesTodos:[{NEMO:"T",NEMODES:"Todos"}],reporte:{id:"001",periodo:1,nemo:"T",fecini:new Date,fecfin:new Date,repcod:"reporteAsisFam"},periodos:[{value:1,label:"Primer Periodo"},{value:2,label:"Segundo Periodo"},{value:3,label:"Tercer Periodo"},{value:4,label:"Cuarto Periodo"}],listaReportes:[{label:"Resumen asistencia",value:"001"},{label:"Asistencia por Salón",value:"002"},{label:"Estadística por periodo",value:"003"},{label:"reporte Anual",value:"004"}]}},methods:{filtrarAsistencia:function(){"%"!==this.estado?this.dataAsistencia=(0,P.filterArray)(this.estado,{field:"ESTADO",list:this.asistencia}):this.dataAsistencia=this.asistencia},creaTabla:function(){var e={};e.columns=[{name:"FECHA",label:"Fecha",field:"FECHA",align:"left",format:I},{name:"HORAING",label:"Hora",field:"HORAING",align:"left"},{name:"FAMDES",label:"Familia",field:"FAMDES",align:"left"},{name:"NOMCOMP",label:"Estudiante",field:"NOMCOMP",align:"left"},{name:"ESTADODES",label:"Estado",field:"ESTADODES",align:"left"},{name:"USUNOM",label:"Usuario",field:"USUNOM",align:"left"}],e.paginacion={page:1,rowsPerPage:500},e.registrosSeleccionados=[],e.tipoSeleccion="multiple",this.tablaAsistencia=e},buscarData:function(){var e=this,a={fIni:this.fIni,fFin:this.fFin};m.$http.get("api/HyoHorasisfam/obtAsistenciaFecha",{params:a}).then(function(a){var t=a.json;t.forEach(function(a){a.ESTADODES=(0,P.filterArray)(a.ESTADO,{field:"value",list:e.listaEstados})[0].label}),e.asistencia=t,e.filtrarAsistencia()})},obtDataSalones:function(){var e=this;m.$http.post("api/HyoSalones/getSalones").then(function(a){var t=a.json;t["v"].forEach(function(a){var t={NEMO:a[0],NEMODES:a[1]};e.salones.push(t),e.salonesTodos.push(t)})})},imprimir:function(e){if("002"!==this.reporte.id||"T"!==this.reporte.nemo){var a={"001":"Record_de_asistencia","002":"Asistencia_salon","003":"Estadistica_periodo","004":"Asistencia_anual"},t=Q()(Q()({},this.reporte),{},{formato:e});t.repNom=a[t["id"]],t.ano=this.sie.ano,t.fecini=(0,U.Ay)(t.fecini,"YYYY-MM-DD"),t.fecfin=(0,U.Ay)(t.fecfin,"YYYY-MM-DD"),(0,L.exportFilePhp)(t,"webservice/reportes/reporte")}},openModal:function(){this.modalReportes=!0}},created:function(){this.creaTabla(),this.fIni.setMonth(this.fIni.getMonth()-1),this.reporte.fecini.setMonth(this.reporte.fecini.getMonth()-1),"%"!==this.listaEstados[0].value&&this.listaEstados.unshift({label:"Todos",value:"%"}),this.buscarData(),this.obtDataSalones()},computed:{buttons:function(){var e=[];return e.push({label:"Imprimir",icon:"print",click:this.openModal}),e}}};const $=(0,A.A)(N,[["render",w]]);var H=$,X={components:{QTabs:s.uw,QTab:s.zu,QTabPane:s.dg,registro:E,listado:H},data:function(){return{now:new Date,sie:(0,n["default"])(),tabs:["registro","listado"],tabSelect:"registro",listaEstados:[{label:"Presente",value:"P"},{label:"Tardanza",value:"T"},{label:"Falta",value:"F"}]}}};const j=(0,A.A)(X,[["render",i]]);var x=j}}]);