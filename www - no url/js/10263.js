"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[10263],{10263:function(o,n,e){e.r(n),e.d(n,{default:function(){return S}});var l=e(61758),u={class:"row q-col-gutter-sm q-pt-md"},t={class:"col-xs-12 col-sm-5"},a={class:"col-xs-12 col-sm-7"},s={class:"col-xs-12 col-sm-5"},i={class:"col-xs-12 col-sm-7"},r={class:"row q-pa-sm q-col-gutter-sm"},c={class:"col-xs-12"},d={class:"col-xs-12 sie-flat"};function m(o,n){var e=this,m=(0,l.g2)("header-btn"),g=(0,l.g2)("q-input"),f=(0,l.g2)("q-form"),h=(0,l.g2)("q-card-section"),p=(0,l.g2)("q-card"),A=(0,l.g2)("q-checkbox"),v=(0,l.g2)("sie-table"),b=(0,l.g2)("sie-modal"),w=(0,l.g2)("q-page");return(0,l.uX)(),(0,l.Wv)(w,{class:"cambio-codigo-alumno bg-white q-pa-sm sie-flat"},{default:(0,l.k6)(function(){return[(0,l.bF)(p,null,{default:(0,l.k6)(function(){return[(0,l.bF)(m,{name:"Modificar Código de Estudiante",buttons:o.buttons},null,8,["buttons"]),(0,l.bF)(h,{style:{height:"calc(100vh - 195px)"}},{default:(0,l.k6)(function(){return[(0,l.bF)(f,{ref:"refForm"},{default:(0,l.k6)(function(){return[(0,l.Lk)("div",u,[(0,l.Lk)("div",t,[(0,l.bF)(g,{modelValue:o.codigo,"onUpdate:modelValue":n[0]||(n[0]=function(n){return o.codigo=n}),label:"Código del Estudiante",rules:[o.campoRequerido],debounce:"500",onInput:o.getDatosAlumno},null,8,["modelValue","rules","onInput"])]),(0,l.Lk)("div",a,[(0,l.bF)(g,{modelValue:o.alumno,"onUpdate:modelValue":n[1]||(n[1]=function(n){return o.alumno=n}),disable:"",label:"Estudiante"},null,8,["modelValue"])]),(0,l.Lk)("div",s,[(0,l.bF)(g,{modelValue:o.nuevoCodigo,"onUpdate:modelValue":n[2]||(n[2]=function(n){return o.nuevoCodigo=n}),label:"Nuevo código del Estudiante",maxlength:"8",rules:[o.alphanumericRule],debounce:"500",onInput:o.validarNuevoCodigo},null,8,["modelValue","rules","onInput"])]),(0,l.Lk)("div",i,[(0,l.bF)(g,{modelValue:o.nuevoAlumno,"onUpdate:modelValue":n[3]||(n[3]=function(n){return o.nuevoAlumno=n}),disable:"",label:"Nuevo código del Estudiante"},null,8,["modelValue"])])])]}),_:1},512)]}),_:1})]}),_:1}),(0,l.bF)(b,{class:"modal-alumno-filtro",modelValue:o.openModal,"onUpdate:modelValue":n[5]||(n[5]=function(n){return o.openModal=n}),title:"Buscar Estudiantes"},{default:(0,l.k6)(function(){return[(0,l.Lk)("div",r,[(0,l.Lk)("div",c,[(0,l.bF)(A,{modelValue:o.todosLosAlumnos,"onUpdate:modelValue":n[4]||(n[4]=function(n){return o.todosLosAlumnos=n}),label:"Listar todos"},null,8,["modelValue"])]),(0,l.Lk)("div",d,[(0,l.bF)(v,{selection:"single",context:e,css:"height: 400px",search:"Buscar Estudiante",columns:o.columnsAlumnos,onRowSelected:o.rowSelected,data:o.rows,config:o.configAlumnos},null,8,["columns","onRowSelected","data","config"])])])]}),_:1},8,["modelValue"])]}),_:1})}var g=e(76080),f=e.n(g),h=e(45254),p=e.n(h),A=e(99550),v=e.n(A),b=(e(71225),e(52133),e(50310),e(5962),e(6724),e(83190),e(52776),e(84433),e(44264),e(6123)),w={data:function(){return{configAlumnos:{},rowsAlumnos:[],columnsAlumnos:[{name:"ALUCOD",label:"Código",field:"ALUCOD",align:"center"},{name:"NOMCOMP",label:"Apellidos y Nombres",field:"NOMCOMP",align:"left"}]}}},C=e(88567),k=e(95718),V=e(982),q=e(30640),L=e(9736),M=e(2739),F=e(3112),x=e(80660),N={components:{QCard:C.A,QCardSection:k.A,sieModal:q.A,QInput:L.A,QForm:M.A,QCheckbox:F.A,QPage:b.Tu},mixins:[w],data:function(){return{codigo:null,alumno:null,nuevoCodigo:null,nuevoAlumno:null,dataSinMatricula:[],buttons:[{icon:"search",label:"Buscar",click:this.buscar},{icon:"cog",label:"Procesar",click:this.procesar}],openModal:!1,todosLosAlumnos:!1}},computed:{rows:function(){var o=[];return!1===this.todosLosAlumnos?this.rowsAlumnos.map(function(n){"V"===n.ESTADO&&(o[o.length]=n)}):o=this.rowsAlumnos,o}},methods:{campoRequerido:function(o){return!!o||"Campo requerido"},rowSelected:function(o){this.codigo=o.ALUCOD,this.alumno=o.NOMCOMP,this.openModal=!1},encontraAlumno:function(o){var n=this.rowsAlumnos.filter(function(n){return n.ALUCOD===o}),e=v()(n,1),l=e[0];return l?l.NOMCOMP:null},getDatosAlumno:function(){this.alumno=this.encontraAlumno(this.codigo)},validarNuevoCodigo:function(){this.nuevoAlumno=this.encontraAlumno(this.nuevoCodigo),this.nuevoAlumno&&(0,V["default"])("El nuevo código ingresado ya se encuentra registrado","warning")},buscar:function(){this.openModal=!0},alphanumericRule:function(o){return!!(!o||/^[a-zA-Z0-9]*$/.test(o)||o.toString().length<=4||o.toString().length>=9)||"El código debe ser alfanumérico entre 5 a 8 dígitos"},getAllAlumnos:function(){var o=this;return p()(f()().m(function n(){return f()().w(function(n){while(1)switch(n.n){case 0:return n.n=1,o.$http.get("api/HyoAlumnos/getAllAlumnos");case 1:o.rowsAlumnos=n.v,o.codigo=null,o.alumno=null,o.nuevoCodigo=null,o.nuevoAlumno=null,o.$refs.refForm.reset();case 2:return n.a(2)}},n)}))()},procesar:function(){var o=this;return p()(f()().m(function n(){var e,l,u,t,a,s;return f()().w(function(n){while(1)switch(n.p=n.n){case 0:return n.p=0,n.n=1,o.$refs.refForm.validate();case 1:if(e=n.v,e){n.n=2;break}return n.a(2);case 2:if(!o.nuevoAlumno){n.n=3;break}return(0,V["default"])("El nuevo código ingresado ya se encuentra registrado","warning"),n.a(2,!1);case 3:return o.$q.loading.show(),l={alucod:o.codigo.toString(),alucodNuevo:o.nuevoCodigo.toString()},n.n=4,x.$http.post("api/AlumnoController/cambiarCodigoAlumno",{alucod:l.alucod,newalucod:l.alucodNuevo});case 4:return u=n.v,t=u.message,n.n=5,x.$http.post("api/personaController/postCambiarImgAlumno",{params:l});case 5:if(a=n.v,"{'resp':1}"==a){n.n=6;break}return(0,V["default"])("Datos modificados. No se pudo copiar la imagen.","warning"),n.a(2);case 6:o.getAllAlumnos(),o.$q.loading.hide(),o.$notify(t,"success"),n.n=8;break;case 7:n.p=7,s=n.v,o.$q.loading.hide(),(0,V["default"])(s.message||"No ha sido posible actualizar el código del alumno.","warning");case 8:return n.a(2)}},n,null,[[0,7]])}))()}},created:function(){var o=this;return p()(f()().m(function n(){return f()().w(function(n){while(1)switch(n.n){case 0:o.getAllAlumnos();case 1:return n.a(2)}},n)}))()}},O=e(12807);const E=(0,O.A)(N,[["render",m]]);var S=E}}]);