"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[14218],{14218:function(e,t,n){n.r(t),n.d(t,{default:function(){return U}});var o=n(61758),a={class:"col column"};function i(e,t){var n=(0,o.g2)("registro"),i=(0,o.g2)("accesoRestringido");return(0,o.uX)(),(0,o.CE)("div",a,[e.acceso?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[e.acceso.HABILITADO?((0,o.uX)(),(0,o.Wv)(n,{key:0})):((0,o.uX)(),(0,o.Wv)(i,{key:1,acceso:e.acceso},null,8,["acceso"]))],64)):(0,o.Q3)("v-if",!0)])}var s=n(76080),r=n.n(s),c=n(45254),l=n.n(c),u=(n(39866),n(83190),n(44264),n(65848)),d=n(58790),m={class:"row q-col-gutter-md"},f={class:"col-xs-12"},v={key:0,class:"row q-col-gutter-md"},E={class:"text-subtitle2"},g={class:"text-h6"},p={class:"text-subtitle2 text-gray-3 q-mb-sm"},h={key:0,class:"text-subtitle2 text-gray-3"},A={key:1,class:"row q-col-gutter-md"},k={class:"col-xs-12"},O={class:"row q-col-gutter-md"},_={class:"text-subtitle2"},C={class:"text-h6"},F={class:"text-subtitle2 text-gray-3 q-mb-sm"},b={key:0,class:"text-subtitle2 text-gray-3"},I={key:1,class:"text-subtitle2 text-gray-3"};function N(e,t){var n=(0,o.g2)("header-btn"),a=(0,o.g2)("formulario"),i=(0,o.g2)("q-card-section"),s=(0,o.g2)("q-btn"),r=(0,o.g2)("q-card-actions"),c=(0,o.g2)("q-card"),l=(0,o.g2)("q-intersection"),u=(0,o.g2)("sie-vacio"),N=(0,o.g2)("sie-modal"),T=(0,o.g2)("q-page");return(0,o.uX)(),(0,o.Wv)(T,{class:"q-pa-sm sie-flat"},{default:(0,o.k6)(function(){return[(0,o.bF)(c,{flat:"",bordered:""},{default:(0,o.k6)(function(){return[(0,o.bF)(n,{name:e.tituloForm,auto:!0,buttons:e.botonesForm},null,8,["name","buttons"]),(0,o.bF)(i,null,{default:(0,o.k6)(function(){return[(0,o.Lk)("div",m,[(0,o.Lk)("div",f,[(0,o.bF)(a,{schema:e.schemas.viewEventosFamilia,ref:"formApp",key:"formApp",onClickIconGrid:e.clickIconGrid,onChangeInput:e.changeInput},null,8,["schema","onClickIconGrid","onChangeInput"])])]),e.tipoEventoSel&&0==e.eventosRegistrados.length?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[e.eventos.length>0?((0,o.uX)(),(0,o.CE)("div",v,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.eventos,function(t,n){return(0,o.uX)(),(0,o.Wv)(l,{key:t.ID_EVENTO,class:"col-xs-12 col-sm-6",transition:"scale"},{default:(0,o.k6)(function(){return[(0,o.bF)(c,{class:"card-evento"},{default:(0,o.k6)(function(){return[(0,o.bF)(i,{class:"col"},{default:(0,o.k6)(function(){return[(0,o.Lk)("p",E,(0,d.v_)(t.TIPO_EVENTO),1),(0,o.Lk)("p",g,(0,d.v_)(t.FECHA_EVENTO),1),(0,o.Lk)("p",p,(0,d.v_)(t.HORA_EVENTO)+" ("+(0,d.v_)(t.DURACION_MIN)+" minutos)",1),0==t.VIRTUAL?((0,o.uX)(),(0,o.CE)("p",h,"Lugar: "+(0,d.v_)(t.LOCAL_NOMBRE),1)):(0,o.Q3)("v-if",!0)]}),_:2},1024),(0,o.bF)(r,null,{default:(0,o.k6)(function(){return[(0,o.bF)(s,{class:"full-width",icon:"add",label:"INSCRIBIRSE",color:"primary",onClick:function(n){return e.seleccionarEvento(t)}},null,8,["onClick"])]}),_:2},1024)]}),_:2},1024)]}),_:2},1024)}),128))])):((0,o.uX)(),(0,o.CE)("div",A,[(0,o.Lk)("div",k,[(0,o.bF)(u,{icon:"info",title:"No existen eventos programados"})])]))],64)):(0,o.Q3)("v-if",!0),e.tipoEventoSel&&e.eventosRegistrados.length>0?((0,o.uX)(),(0,o.CE)(o.FK,{key:1},[t[1]||(t[1]=(0,o.Lk)("div",{class:"row q-col-gutter-md items-center justify-center q-my-lg"},[(0,o.Lk)("div",{class:"col-xs-12 text-center"},[(0,o.Lk)("span",null,"Estimada Familia, usted posee los siguientes eventos registrados:")])],-1)),(0,o.Lk)("div",O,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.eventosRegistrados,function(t,n){return(0,o.uX)(),(0,o.Wv)(l,{key:t.ID_EVENTO,class:"col-xs-12 col-sm-6",transition:"scale"},{default:(0,o.k6)(function(){return[(0,o.bF)(c,{class:"card-evento"},{default:(0,o.k6)(function(){return[(0,o.bF)(i,{class:"col"},{default:(0,o.k6)(function(){return[(0,o.Lk)("p",_,(0,d.v_)(t.TIPO_EVENTO),1),(0,o.Lk)("p",C,(0,d.v_)(t.FECHA_EVENTO),1),(0,o.Lk)("p",F,(0,d.v_)(t.HORA_EVENTO)+" ("+(0,d.v_)(t.DURACION_MIN)+" minutos)",1),0==t.VIRTUAL?((0,o.uX)(),(0,o.CE)("p",b,"Lugar: "+(0,d.v_)(t.LOCAL_NOMBRE),1)):(0,o.Q3)("v-if",!0),1==t.VIRTUAL?((0,o.uX)(),(0,o.CE)("p",I,"Enlace: "+(0,d.v_)(t.ENLACE),1)):(0,o.Q3)("v-if",!0)]}),_:2},1024),(0,o.bF)(r,null,{default:(0,o.k6)(function(){return[0===t.CONFIRMO?((0,o.uX)(),(0,o.Wv)(s,{key:0,class:"full-width",icon:"calendar",label:"CONFIRMAR ASISTENCIA",color:"primary",onClick:function(n){return e.confirmarAsistencia(t)}},null,8,["onClick"])):((0,o.uX)(),(0,o.Wv)(s,{key:1,class:"full-width",icon:"check",label:"ASISTENCIA CONFIRMADA",color:"primary"}))]}),_:2},1024)]}),_:2},1024)]}),_:2},1024)}),128))])],64)):(0,o.Q3)("v-if",!0)]}),_:1})]}),_:1}),(0,o.bF)(N,{title:e.configModalSel.titulo,modelValue:e.openModal,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.openModal=t}),ok:"GUARDAR",onSubmit:e.submit},{default:(0,o.k6)(function(){return[(0,o.bF)(i,{class:"cont-modal-lg"},{default:(0,o.k6)(function(){return[(0,o.bF)(a,{schema:e.schemaModal,ref:"formModal",key:"formModal",modal:!0},null,8,["schema"])]}),_:1})]}),_:1},8,["title","modelValue","onSubmit"])]}),_:1})}n(71225),n(52133),n(10239),n(50310),n(5962),n(6724),n(35534);var T=n(6123),S=n(80660),w=n(10213),M=n(23540),R=n(40714),L={components:{$http:S.$http,alert:w.alert,confirm:w.confirm,QIntersection:M.A,QPage:T.Tu,QCard:T.C$,QCardActions:T.zZ,QBtn:T.Il},mixins:[u.A,R.A],data:function(){var e=this.init();return e.eventosRegistrados=[],e.tipoEventoSel=null,e.eventos=[],e.maxAcompanantes=1,e},methods:{updateListaEventos:function(e){var t=this;return l()(r()().m(function n(){var o,a,i;return r()().w(function(n){while(1)switch(n.n){case 0:return t.eventosRegistrados=[],t.eventos=[],o=e.KEY.split("-"),a=[],a.push({id:"registros",dto:"PostulacionDto",method:"getEventoRegistros",params:'{"idEventoTipo": '+o[0]+', "flagTipo": "'+o[1]+'", "validarFamilia": "true", "validarVigenciaAsistencia": "true"}'}),a.push({id:"eventos",dto:"PostulacionDto",method:"getEventos",params:'{"idEventoTipo": '+o[0]+', "flagTipo": "'+o[1]+'", "validarCupos": "true", "validarFecha": "true", "flagPublico": "P"}'}),n.n=1,t.getAllData(a);case 1:i=n.v,i.eventos.map(function(e){e.FECHA_EVENTO=t.formatMoment(e.FH_EVENTO_BD,"dddd, D  MMMM  YYYY"),e.HORA_EVENTO=t.formatMoment(e.FH_EVENTO_BD,"hh:mm a")}),i.registros.map(function(e){e.FECHA_EVENTO=t.formatMoment(e.FH_EVENTO,"dddd, D  MMMM  YYYY"),e.HORA_EVENTO=t.formatMoment(e.FH_EVENTO,"hh:mm a")}),t.eventosRegistrados=i.registros,t.eventos=i.eventos;case 2:return n.a(2)}},n)}))()},getEventos:function(e,t,n,o){var a=this;return l()(r()().m(function e(){return r()().w(function(e){while(1)switch(e.n){case 0:return e.n=1,a.updateListaEventos(o);case 1:a.tipoEventoSel=o;case 2:return e.a(2)}},e)}))()},seleccionarEvento:function(e){var t=this;return l()(r()().m(function n(){return r()().w(function(n){while(1)switch(n.n){case 0:0===e.VIRTUAL?t.runModal({evento:e},"eventoFamilia","I"):(0,w.confirm)("¿Realmente desea inscribirse en el evento?","add").onOk(function(){S.$http.post("api/postulacionController/inscribirEventoAdmision",{data:{USUCOD:t.sie.usucod,evento:e,EXTERNOS:[]}}).then(function(e){t.$notify(e.message,"success"),t.updateListaEventos(t.tipoEventoSel)}).catch(function(e){t.$notify(e.error.message,"warning")})});case 1:return n.a(2)}},n)}))()},confirmarAsistencia:function(e){var t=this;return l()(r()().m(function n(){return r()().w(function(n){while(1)switch(n.n){case 0:(0,w.confirm)("¿Realmente desea confirmar la asistencia?","add").onOk(function(){S.$http.post("api/postulacionController/confirmarAsistEventoAdmision",{data:{USUCOD:t.sie.usucod,evento:e}}).then(function(e){t.$notify(e.message,"success"),t.updateListaEventos(t.tipoEventoSel)}).catch(function(e){t.$notify(e.error.message,"warning")})});case 1:return n.a(2)}},n)}))()},preModal:function(e,t,n){var o=this;return l()(r()().m(function t(){var n;return r()().w(function(t){while(1)switch(t.n){case 0:n=o.configModalSel.codigoFormulario,t.n="eventoFamilia"===n?1:2;break;case 1:return e.VIRTUAL=e.evento.VIRTUAL,e.USUCOD=o.sie.usucod,t.a(3,2);case 2:return t.a(2,e)}},t)}))()},postModal:function(e,t,n){switch(this.configModalSel.codigoFormulario){case"eventoFamilia":for(var o=[],a=1;a<=this.maxAcompanantes;a++)o.push({APELLIDOS:"",NOMBRES:"",TELEFONO:"",PARENTESCO:""});this.$refs["formModal"].rows["GRID_1"]=o;break}},preSubmit:function(e){var t=!0;switch(this.configModalSel.codigoFormulario){case"eventoFamilia":var n=this.$refs["formModal"].$refs["GRID_1"].selected;if(e.EXTERNOS=n,n.length>0){var o=n.filter(function(e){return e.APELLIDOS.length>0&&e.NOMBRES.length>0&&e.TELEFONO.length>0});n.length!==o.length&&(this.$notify("Existen registros que no tienen los datos completos: si marca el check debe llenar los apellidos, nombres y teléfono","warning"),t=!1)}break}return{res:t,data:e}},postSubmit:function(e){var t=this;return l()(r()().m(function e(){var n;return r()().w(function(e){while(1)switch(e.n){case 0:n=t.configModalSel.codigoFormulario,e.n="eventoFamilia"===n?1:2;break;case 1:return t.updateListaEventos(t.tipoEventoSel),e.a(3,2);case 2:return e.a(2)}},e)}))()}},created:function(){var e=this;return l()(r()().m(function t(){var n,o,a;return r()().w(function(t){while(1)switch(t.n){case 0:return n=[{id:"viewEventosFamilia",ref:"formApp"}],e.loadSchemas(n),t.n=1,e.getParametrosAdmision(["MAX_ACOMPANANTES_EVENTOS"]);case 1:o=t.v,a=parseInt(e.striptags(o.MAX_ACOMPANANTES_EVENTOS)),e.maxAcompanantes=Number.isInteger(a)?a:1;case 2:return t.a(2)}},t)}))()}},y=n(12807);const V=(0,y.A)(L,[["render",N]]);var x=V,D=n(55471),X={components:{registro:x,accesoRestringido:D["default"]},mixins:[u.A],data:function(){var e=this.init();return e.acceso=null,e.esFamiliaAdmision=!0,e},created:function(){var e=this;return l()(r()().m(function t(){var n,o;return r()().w(function(t){while(1)switch(t.n){case 0:return n=null,t.n=1,e.getApiAction("api/postulacionController/getConstantesAdmision");case 1:if(o=t.v,e.esFamiliaAdmision=["004","099"].includes(e.sie.tipcod.toString()),!e.esFamiliaAdmision||!o.VALIDAR_ACCESOS_ADMISION.EVENTOS){t.n=3;break}return t.n=2,e.getApiAction("api/postulacionController/getAccesoFamiliaAdmision",{opcion:"EVENTOS"});case 2:n=t.v,t.n=4;break;case 3:n={HABILITADO:!0};case 4:e.acceso=n;case 5:return t.a(2)}},t)}))()}};const q=(0,y.A)(X,[["render",i]]);var U=q}}]);