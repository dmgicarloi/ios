"use strict";(self["webpackChunklms"]=self["webpackChunklms"]||[]).push([[3043],{3043:function(e,a,n){n.r(a),n.d(a,{default:function(){return Ne}});var t=n(61758);function o(e,a){var n=(0,t.g2)("devolver"),o=(0,t.g2)("listado"),l=(0,t.g2)("individual"),r=(0,t.g2)("bloque"),i=(0,t.g2)("q-page");return(0,t.uX)(),(0,t.Wv)(i,null,{default:(0,t.k6)(function(){return["devolver"===e.menuSelect?((0,t.uX)(),(0,t.Wv)(n,{key:0,onCambiarVentana:e.cambiarEstado,devolucion:e.devolucionId,onDevolver:e.devolver,transferenciaData:e.transferenciaData},null,8,["onCambiarVentana","devolucion","onDevolver","transferenciaData"])):(0,t.Q3)("v-if",!0),"listado"===e.menuSelect?((0,t.uX)(),(0,t.Wv)(o,{key:1,onCambiarVentana:e.cambiarEstado,onDevolver:e.devolver},null,8,["onCambiarVentana","onDevolver"])):(0,t.Q3)("v-if",!0),"individual"===e.menuSelect?((0,t.uX)(),(0,t.Wv)(l,{key:2,onCambiarVentana:e.cambiarEstado,nombre:e.titulo,dataEdit:e.dataEdit},null,8,["onCambiarVentana","nombre","dataEdit"])):(0,t.Q3)("v-if",!0),"bloque"===e.menuSelect?((0,t.uX)(),(0,t.Wv)(r,{key:3,onCambiarVentana:e.cambiarEstado,nombre:e.titulo,dataEdit:e.dataEdit},null,8,["onCambiarVentana","nombre","dataEdit"])):(0,t.Q3)("v-if",!0)]}),_:1})}n(515);var l=n(6123),r=n(66594),i=n(8445),s=n.n(i),c=n(58790),u={class:"row"},d={class:"row q-col-gutter-sm"},f={class:"col-12 row q-gutter-sm"},I={class:"text-h6"},m={class:"col-12"},p={class:"absolute-full flex flex-center"},v={class:"q-my-md q-mx-sm"},b={class:"col row-md q-gutter-md"},g={class:"col q-card"},h={class:"q-ma-sm"},O={class:"row col q-gutter-sm"},N={class:"q-mt-sm"},A={key:0,class:"row col q-gutter-sm"},C={class:"row col q-gutter-sm"},_={class:"q-mx-sm"},E={class:"col"},S={class:"col q-card q-pa-md column"},T={class:"row col row q-gutter-md"},F={class:"row col"},D={class:"span"},P={class:"row col"},L={class:"span"};function V(e,a){var n=this,o=(0,t.g2)("header-btn"),l=(0,t.g2)("q-bar"),r=(0,t.g2)("q-icon"),i=(0,t.g2)("q-badge"),V=(0,t.g2)("q-linear-progress"),R=(0,t.g2)("q-card-section"),k=(0,t.g2)("q-card"),w=(0,t.g2)("q-dialog"),M=(0,t.g2)("q-select"),q=(0,t.g2)("q-input1"),y=(0,t.g2)("q-checkbox"),B=(0,t.g2)("sie-table"),Q=(0,t.g2)("q-page");return(0,t.uX)(),(0,t.Wv)(Q,null,{default:(0,t.k6)(function(){return[(0,t.bF)(o,{name:"Transferencia en bloque de Activos",buttons:e.buttons},null,8,["buttons"]),(0,t.bF)(w,{modelValue:e.loading,"onUpdate:modelValue":a[0]||(a[0]=function(a){return e.loading=a}),persistent:""},{default:(0,t.k6)(function(){return[(0,t.bF)(k,{style:{"min-width":"450px"}},{default:(0,t.k6)(function(){return[(0,t.bF)(l,{class:"row bg-primary text-white"},{default:(0,t.k6)(function(){return s()(a[10]||(a[10]=[(0,t.Lk)("div",{class:"col"},"SieWeb",-1)]))}),_:1}),(0,t.Lk)("div",u,[(0,t.bF)(r,{class:"q-pl-sm",name:"compare_arrows",size:"40px",color:"primary"}),(0,t.bF)(R,{class:"col"},{default:(0,t.k6)(function(){return[(0,t.Lk)("div",d,[(0,t.Lk)("div",f,[(0,t.Lk)("div",I,(0,c.v_)(e.messageProgress),1)]),(0,t.Lk)("div",m,[(0,t.bF)(V,{size:"50px",value:e.progressPercent,color:"secondary",rounded:"",stripe:""},{default:(0,t.k6)(function(){return[(0,t.Lk)("div",p,[(0,t.bF)(i,{color:"white","text-color":"primary",label:e.progressLabel},null,8,["label"])])]}),_:1},8,["value"])])])]}),_:1})])]}),_:1})]}),_:1},8,["modelValue"]),(0,t.Lk)("div",v,[(0,t.Lk)("div",b,[(0,t.Lk)("div",g,[(0,t.Lk)("div",h,[(0,t.Lk)("div",O,[(0,t.bF)(M,{class:"col",modelValue:e.TIPO_PERSONA,"onUpdate:modelValue":a[1]||(a[1]=function(a){return e.TIPO_PERSONA=a}),options:e.tiposPersona,"option-value":"ID_PERFIL","option-label":"DESCRIPCION",label:"Tipo",onInput:e.obtenerPersonas,"emit-value":""},null,8,["modelValue","options","onInput"]),(0,t.bF)(M,{class:"col",modelValue:e.ID_CATALOGO,"onUpdate:modelValue":a[2]||(a[2]=function(a){return e.ID_CATALOGO=a}),options:e.catalogos,"option-value":"ID_CATALOGO","option-label":"DESCRIPCION",label:"Catálogo",onInput:e.obtenerActivos,"emit-value":""},null,8,["modelValue","options","onInput"]),(0,t.bF)(M,{class:"col",modelValue:e.ID_TIPO,"onUpdate:modelValue":a[3]||(a[3]=function(a){return e.ID_TIPO=a}),options:e.tipoTransferencia,"option-value":"ID","option-label":"DESCRIPCION",label:"Tipo de Transferencia","emit-value":""},null,8,["modelValue","options"])]),(0,t.Lk)("div",N,[1===e.TIPO_PERSONA?((0,t.uX)(),(0,t.CE)("div",A,[(0,t.bF)(M,{class:"col",modelValue:e.NIVEL,"onUpdate:modelValue":a[4]||(a[4]=function(a){return e.NIVEL=a}),options:e.niveles,"option-value":"INSTRUCOD","option-label":"INSTRUDES",label:"Nivel",onInput:e.obtenerPersonas,"emit-value":""},null,8,["modelValue","options","onInput"]),e.NIVEL&&e.grados[e.NIVEL].length>0?((0,t.uX)(),(0,t.Wv)(M,{key:0,class:"col",modelValue:e.GRADO,"onUpdate:modelValue":a[5]||(a[5]=function(a){return e.GRADO=a}),options:e.grados[e.NIVEL],"option-value":"GRADOCOD","option-label":"GRADODES",label:"Grado",onInput:e.obtenerPersonas,"emit-value":""},null,8,["modelValue","options","onInput"])):(0,t.Q3)("v-if",!0),e.NIVEL&&e.GRADO&&e.secciones[e.NIVEL+e.GRADO].length>0?((0,t.uX)(),(0,t.Wv)(M,{key:1,class:"col",modelValue:e.SECCION,"onUpdate:modelValue":a[6]||(a[6]=function(a){return e.SECCION=a}),options:e.secciones[e.NIVEL+e.GRADO],"option-value":"SECCIONCOD","option-label":"SECCIONDES",label:"Seccion","emit-value":"",onInput:e.obtenerPersonas},null,8,["modelValue","options","onInput"])):(0,t.Q3)("v-if",!0)])):(0,t.Q3)("v-if",!0)]),(0,t.Lk)("div",C,[(0,t.bF)(q,{class:"col",label:"Fecha de Inicio",modelValue:e.F_INICIO,"onUpdate:modelValue":a[7]||(a[7]=function(a){return e.F_INICIO=a}),type:"date",onInput:e.obtenerActivos},null,8,["modelValue","onInput"]),(0,t.bF)(y,{modelValue:e.IS_FH_FIN,"onUpdate:modelValue":a[8]||(a[8]=function(a){return e.IS_FH_FIN=a}),"true-value":1,"false-value":0,color:"secondary",onInput:e.obtenerActivos},{default:(0,t.k6)(function(){return s()(a[11]||(a[11]=[(0,t.eW)("Sin fecha de fin",-1)]))}),_:1},8,["modelValue","onInput"]),0===e.IS_FH_FIN?((0,t.uX)(),(0,t.Wv)(q,{key:0,class:"col",label:"Fecha de fin",modelValue:e.F_FIN,"onUpdate:modelValue":a[9]||(a[9]=function(a){return e.F_FIN=a}),type:"date",onInput:e.obtenerActivos},null,8,["modelValue","onInput"])):(0,t.Q3)("v-if",!0)])])])])]),(0,t.Lk)("div",_,[(0,t.Lk)("div",E,[(0,t.Lk)("div",S,[(0,t.Lk)("div",T,[(0,t.Lk)("div",F,[a[12]||(a[12]=(0,t.Lk)("div",{class:"text-bold"},"Activos Disponibles:  ",-1)),(0,t.Lk)("div",D,(0,c.v_)(e.activos.length),1)]),(0,t.Lk)("div",P,[a[13]||(a[13]=(0,t.Lk)("div",{class:"text-bold"},"Cantidad de Personas: ",-1)),(0,t.Lk)("div",L,(0,c.v_)(e.listaPersonas.length),1)])]),(0,t.bF)(B,{class:"q-mt-sm",dense:"",flat:"",bordered:"","wrap-cells":"","load-selection":e.load,"load-disabled":e.disabled,ref:"tablaActivos",css:"height: calc(100vh - 335px)",context:n,"show-search":!1,columns:e.columns,data:e.dataTabla,config:e.config,"check-all-position":"right","show-index":!0,"hide-bottom":!0,selection:"multiple"},null,8,["load-selection","load-disabled","columns","data","config"])])])])]}),_:1})}var R=n(57008),k=n.n(R),w=n(76080),M=n.n(w),q=n(45254),y=n.n(q),B=(n(30683),n(74260),n(23825),n(10239),n(50310),n(32203),n(90095),n(83190),n(13715),n(24066),n(57668)),Q=n(9736),x=n(55973),$=n(3112),U=n(16648),Y=n(33777),G=n(88567),H=n(41126),X=n(95718),W=n(34262),j=n(34963),z=n(62565),K=n(18105),J=n(42205),Z={emits:["cambiarVentana"],components:{QInput1:Q.A,QToggle:x.A,SieTable:Y.A,QSelect:U.A,QCheckbox:$.A,QInnerLoading:l.SQ,QSpinnerOval:l.VA,QDialog:J.A,QCard:G.A,QBar:H.A,QCardSection:X.A,QIcon:W.A,QLinearProgress:j.A,QBadge:z.A,QPage:l.Tu},props:{nombre:{type:String,default:"Nuevo Activo"},dataEdit:{type:Object,default:{}}},data:function(){return{loading:!1,messageProgress:"",progress:0,ID_CATALOGO:null,TIPO_PERSONA:null,ID_TIPO:null,catalogos:[],tiposPersona:[],tipoTransferencia:[],F_INICIO:(0,K.Ay)(new Date,"YYYY-MM-DD"),F_FIN:(0,K.Ay)(new Date((new Date).getFullYear(),11,31),"YYYY-MM-DD"),IS_FH_FIN:0,niveles:[],grados:{},secciones:{},NIVEL:null,GRADO:null,SECCION:null,listaPersonas:[],dataTabla:[],activos:[],config:{PARENTESCO_RESPONSABLE:{component:"select",prevent:!0,options:[{label:"Padre",value:5},{label:"Madre",value:6},{label:"Otros",value:"O"}],input:function(e,a){e.NOMCOMP_RESPONSABLE=e.objFamilia[e.PARENTESCO_RESPONSABLE].PERSONA,a.NOMCOMP_RESPONSABLE=e.objFamilia[e.PARENTESCO_RESPONSABLE].PERSONA,a.NUMDOC_RESPONSABLE=e.objFamilia[e.PARENTESCO_RESPONSABLE].NRODOC,e.NUMDOC_RESPONSABLE=e.objFamilia[e.PARENTESCO_RESPONSABLE].NRODOC}},NOMCOMP_RESPONSABLE:{component:"input",prevent:!0,renderHtml:function(e,a,n,t){return"O"===t.PARENTESCO_RESPONSABLE?t["$$NOMCOMP_RESPONSABLE"]=!1:t["$$NOMCOMP_RESPONSABLE"]=!0,a("span",e.NOMCOMP_RESPONSABLE)}},NUMDOC_RESPONSABLE:{component:"input",prevent:!0,renderHtml:function(e,a,n,t){return"O"===t.PARENTESCO_RESPONSABLE?t["$$NUMDOC_RESPONSABLE"]=!1:t["$$NUMDOC_RESPONSABLE"]=!0,a("span",e.NUMDOC_RESPONSABLE)}}},load:{},disabled:{},total:0}},methods:{cargarPersonas:function(e){console.log({info:e})},cargarActivos:function(e){console.log(e)},filtarData:function(e){console.log(e)},obtenerGrados:function(e){return y()(M()().m(function e(){return M()().w(function(e){while(1)switch(e.n){case 0:return e.a(2)}},e)}))()},obtenerSecciones:function(e){return y()(M()().m(function e(){return M()().w(function(e){while(1)switch(e.n){case 0:return e.a(2)}},e)}))()},obtenerPersonas:function(){var e=this;return y()(M()().m(function a(){return M()().w(function(a){while(1)switch(a.n){case 0:if(1!==e.TIPO_PERSONA){a.n=3;break}if(!(e.NIVEL&&e.GRADO&&e.SECCION)){a.n=2;break}return a.n=1,e.$http.get("api/AfTransferenciaController/getAlumnosxANGS",{params:{params:{nivel:e.NIVEL,grado:e.GRADO,seccion:e.SECCION}}});case 1:e.listaPersonas=a.v;case 2:a.n=5;break;case 3:return a.n=4,e.$http.get("api/personaController/getPersonaPorPerfil",{params:{params:{id_perfil:e.TIPO_PERSONA,estado:1}}});case 4:e.listaPersonas=a.v;case 5:e.generarDataTabla();case 6:return a.a(2)}},a)}))()},generarDataTabla:function(){var e=[],a={};this.load.key="ID_PERSONA",this.disabled.key="ID_PERSONA";for(var n=[],t=[],o=this.listaPersonas.length>this.activos.length?this.listaPersonas.length:this.activos.length,l=0;l<o;l++)a=k()(k()({},this.listaPersonas[l]),this.activos[l]),a.ID_ACTIVO&&a.ID_PERSONA?n.push(a):t.push(a),e.push(a);this.deudores=[].concat(n),this.load.values=[].concat(n),this.disabled.values=[].concat(t),this.dataTabla=e},obtenerActivos:function(){var e=this;return y()(M()().m(function a(){var n;return M()().w(function(a){while(1)switch(a.n){case 0:if(!e.F_INICIO||0!==e.IS_FH_FIN&&!e.F_FIN||!e.ID_CATALOGO){a.n=2;break}return n={catalogo:e.ID_CATALOGO,fecIni:e.F_INICIO,fecFin:e.F_FIN},a.n=1,e.$http.get("api/AfActivoController/getAfActivosDisponibles",{params:n});case 1:e.activos=a.v,e.generarDataTabla();case 2:return a.a(2)}},a)}))()},volver:function(){this.$emit("cambiarVentana","listado")},saveBloque:function(){var e=this;return y()(M()().m(function a(){var n;return M()().w(function(a){while(1)switch(a.n){case 0:n=[],e.$refs.tablaActivos.rowsSelected().forEach(function(a){var t=e.dataTabla.find(function(e){return e.ID_PERSONA===a.ID_PERSONA});n.push(k()(k()({},t),{TIPO_PERSONA:1}))}),e.total=n.length,n.length>0&&e.ID_TIPO&&e.$confirm("¿Está seguro de realizar esta transferencia en bloque?","info").onOk(y()(M()().m(function a(){var t;return M()().w(function(a){while(1)switch(a.p=a.n){case 0:return a.p=0,t={info:n,fecInic:e.F_INICIO,fecFin:e.F_FIN,sinFecFin:e.IS_FH_FIN,ID_TIPO:e.ID_TIPO},a.n=1,e.$http.post("api/AfTransferenciaController/grabarransferenciaBloque   ",t);case 1:e.$notify("Transferencias registradas correctamente"),e.volver(),a.n=3;break;case 2:a.p=2,a.v;case 3:return a.a(2)}},a,null,[[0,2]])}))),e.ID_TIPO||e.$notify("Debe seleccionar un tipo de transferencia","error");case 1:return a.a(2)}},a)}))()}},watch:{F_INICIO:function(e){this.IS_FH_FIN||this.F_FIN<e&&(this.F_FIN=new Date(this.F_INICIO),this.F_FIN.setMonth(this.F_FIN.getMonth()+1),this.F_FIN=(0,K.Ay)(this.F_FIN,"YYYY-MM-DD"))},F_FIN:function(e){this.IS_FH_FIN||e<this.F_INICIO&&(this.F_INICIO=new Date(e),this.F_INICIO.setMonth(this.F_INICIO.getMonth()-1),this.F_INICIO=(0,K.Ay)(this.F_INICIO,"YYYY-MM-DD"))}},computed:{columns:function(){var e=[{name:"ID_ACTIVO_TXT",label:"Id",align:"left",field:"ID_ACTIVO_TXT"},{name:"DESCRIPCION",label:"Activo",align:"left",field:"DESCRIPCION"},{name:"NOMBRE",label:"Nombre",align:"left",field:"NOMBRE"}];return 1===this.TIPO_PERSONA&&(e.push({name:"PARENTESCO_RESPONSABLE",field:"PARENTESCO_RESPONSABLE",label:"Parentesco Resp"}),e.push({name:"NUMDOC_RESPONSABLE",field:"NUMDOC_RESPONSABLE",label:"Documento Resp"}),e.push({name:"NOMCOMP_RESPONSABLE",field:"NOMCOMP_RESPONSABLE",label:"Nombre Resp"})),e},buttons:function(){var e=[{label:"Volver",icon:"arrow_left",click:this.volver}];return 3===(0,B["default"])().ruta.nivel&&e.push({label:"Grabar",icon:"save",click:this.saveBloque}),e},progressPercent:function(){return 0===this.total?0:this.progress/this.total},progressLabel:function(){return"".concat(this.progress," de ").concat(this.total," mensajes enviados")},gradosFinal:function(){return this.NIVEL?(console.log(this.NIVEL,this.grados),this.grados[this.NIVEL]):[]}},mounted:function(){var e=this;return y()(M()().m(function a(){var n,t,o;return M()().w(function(a){while(1)switch(a.n){case 0:return n={agrupado:!0},a.n=1,e.$http.get("api/AfActivoController/getCargaInicial",{params:{isNuevo:!1}});case 1:return t=a.v,o=t.tipoTransferencia,e.tipoTransferencia=o,a.n=2,e.$http.get("api/AfCatalogoController/getAfCatalogo");case 2:return e.catalogos=a.v,a.n=3,e.$http.get("api/personaController/getTipoPerfil");case 3:return e.tiposPersona=a.v,a.n=4,e.$http.get("api/InstruController/getInstru",{params:{parametros:{whereNotIn:["T"]}}});case 4:return e.niveles=a.v,a.n=5,e.$http.get("api/HyoGradoNivs/obtGrados",{params:n});case 5:return e.grados=a.v,a.n=6,e.$http.get("api/HyoSecciones/obtSecciones",{params:n});case 6:e.secciones=a.v,e.grados=e.grados.json,e.secciones=e.secciones.json;case 7:return a.a(2)}},a)}))()}},ee=n(12807);const ae=(0,ee.A)(Z,[["render",V]]);var ne=ae,te=(n(52776),n(53113),{class:"colum q-ma-sm items-center"}),oe={class:"justify-center row"},le={class:"text-bold row justify-center"},re={class:"row justify-center q-ma-xs"},ie={class:"q-gutter-sm"},se={class:"q-card q-pa-sm q-ma-sm"},ce={class:"row q-gutter-sm q-ma-xs"},ue={class:"row q-gutter-sm q-ma-xs"};function de(e,a){var n=this,o=(0,t.g2)("q-icon"),l=(0,t.g2)("q-select"),r=(0,t.g2)("q-btn"),i=(0,t.g2)("sie-modal"),c=(0,t.g2)("sie-pdf"),u=(0,t.g2)("header-btn"),d=(0,t.g2)("q-spinner-oval"),f=(0,t.g2)("q-inner-loading"),I=(0,t.g2)("q-input1"),m=(0,t.g2)("sie-table"),p=(0,t.g2)("q-page");return(0,t.uX)(),(0,t.Wv)(p,null,{default:(0,t.k6)(function(){return[(0,t.bF)(i,{modelValue:e.showModal,"onUpdate:modelValue":a[2]||(a[2]=function(a){return e.showModal=a}),footer:!1},{default:(0,t.k6)(function(){return[(0,t.Lk)("div",te,[(0,t.Lk)("div",oe,[(0,t.bF)(o,{class:"text-warning",name:"info_outline",style:{"font-size":"xxx-large"}})]),a[13]||(a[13]=(0,t.Lk)("div",{class:"text-bold row justify-center"},[(0,t.Lk)("span",null,"¿De que manera desea transferir los activos?")],-1)),(0,t.Lk)("div",le,[(0,t.bF)(l,{modelValue:e.modoTrans,"onUpdate:modelValue":a[0]||(a[0]=function(a){return e.modoTrans=a}),options:e.tiposTransferencia},null,8,["modelValue","options"])]),(0,t.Lk)("div",re,[(0,t.Lk)("div",ie,[(0,t.bF)(r,{color:"primary",dense:"",onClick:e.nuevaTransferencia},{default:(0,t.k6)(function(){return s()(a[11]||(a[11]=[(0,t.eW)("Aceptar",-1)]))}),_:1},8,["onClick"]),(0,t.bF)(r,{color:"primary",dense:"",outline:"",onClick:a[1]||(a[1]=function(a){return e.showModal=!1})},{default:(0,t.k6)(function(){return s()(a[12]||(a[12]=[(0,t.eW)("Cancelar",-1)]))}),_:1})])])])]}),_:1},8,["modelValue"]),e.dataModal?((0,t.uX)(),(0,t.Wv)(i,{key:0,modelValue:e.modalDetalle,"onUpdate:modelValue":a[3]||(a[3]=function(a){return e.modalDetalle=a}),title:"Detalle de "+e.dataModal.ID_ACTIVO_TXT},{default:(0,t.k6)(function(){return[(0,t.bF)(c,{class:"col",src:e.url(e.dataModal),style:{"min-height":"60vh","min-width":"50vw"}},null,8,["src"])]}),_:1},8,["modelValue","title"])):(0,t.Q3)("v-if",!0),(0,t.bF)(u,{name:"Transferencias",buttons:e.buttons},null,8,["buttons"]),(0,t.bF)(f,{visible:e.cargando},{default:(0,t.k6)(function(){return[(0,t.bF)(d,{size:"50px",color:"primary"})]}),_:1},8,["visible"]),(0,t.Lk)("div",se,[(0,t.Lk)("div",ce,[(0,t.bF)(I,{class:"col",modelValue:e.search,"onUpdate:modelValue":a[4]||(a[4]=function(a){return e.search=a}),label:e.$t("Buscar"),onInput:e.filterTransferencias},{append:(0,t.k6)(function(){return[(0,t.bF)(o,{name:"search"})]}),_:1},8,["modelValue","label","onInput"]),(0,t.bF)(I,{class:"col",modelValue:e.searchCod,"onUpdate:modelValue":a[5]||(a[5]=function(a){return e.searchCod=a}),label:e.$t("Código de Transferencia"),onKeydown:e.buscarTransferencia},{append:(0,t.k6)(function(){return[(0,t.bF)(o,{name:"select_all"})]}),_:1},8,["modelValue","label","onKeydown"])]),(0,t.Lk)("div",ue,[(0,t.bF)(I,{class:"col",modelValue:e.F_INICIO,"onUpdate:modelValue":a[6]||(a[6]=function(a){return e.F_INICIO=a}),type:"date",label:"Inicio",onInput:a[7]||(a[7]=function(a){return e.filtrarTransferencias()})},null,8,["modelValue"]),(0,t.bF)(I,{class:"col",modelValue:e.F_FIN,"onUpdate:modelValue":a[8]||(a[8]=function(a){return e.F_FIN=a}),type:"date",label:"Fin",onInput:a[9]||(a[9]=function(a){return e.filtrarTransferencias()})},null,8,["modelValue"])]),(0,t.bF)(m,{class:"q-mt-xs",dense:"",flat:"",bordered:"","wrap-cells":"",css:"height: calc(100vh - 220px)","show-search":!1,context:n,columns:e.columns,data:e.dataTransferencias,config:e.config,"show-refresh":!0,onRefresh:a[10]||(a[10]=function(a){return e.filtrarTransferencias()})},null,8,["columns","data","config"])])]}),_:1})}n(11777);var fe=n(33001),Ie=n(30640),me=n(84603),pe={emits:["devolver","intercambio","cambiarVentana"],props:{devolucion:{type:Number,default:null},transferenciaData:{type:Object,default:{}}},components:{QInput1:Q.A,QToggle:x.A,SieTable:Y.A,QSelect:U.A,sieModal:Ie.A,QInnerLoading:l.SQ,QSpinnerOval:l.VA,siePdf:me.A,QPage:l.Tu,QIcon:l.bP,QBtn:l.Il},data:function(){return{search:null,searchCod:null,generaConstancia:0,F_INICIO:(0,K.Ay)(new Date((new Date).getFullYear(),(new Date).getMonth(),1),"YYYY-MM-DD"),F_FIN:(0,K.Ay)(new Date((new Date).getFullYear(),(new Date).getMonth()+1,0),"YYYY-MM-DD"),modoTrans:"individual",tiposTransferencia:[{label:"Individual",value:"individual"},{label:"Bloque",value:"bloque"}],showModal:!1,aDepreciacion:"T",dataCatalogos:[],dataCatalogosBase:[],dataTransferencias:[],aDepreciacionList:[{label:"Todos",value:"T"},{label:"No",value:0},{label:"Si",value:1}],columns:[{name:"ID_ACTIVO_TXT",label:"Id Transferencia",align:"left",field:"ID_ACTIVO_TXT"},{name:"ID_SOLICITUD",label:"Id Solicitud",align:"left",field:"ID_SOLICITUD"},{name:"ID_TIPO",label:"Tipo de Transferencia",align:"left",field:"ID_TIPO"},{name:"NOMPERSONA",label:"Nombre",align:"left",field:"NOMPERSONA"},{name:"ACTIVOS",label:"Cant. activos",align:"center",field:"ACTIVOS"},{name:"FH_TRANSFERENCIA_I",label:"Desde",align:"center",field:"FH_TRANSFERENCIA_I"},{name:"FH_FIN",label:"Hasta",align:"center",field:"FH_FIN"},{name:"ACCIONES",align:"center",field:"ACCIONES"}],tipoTransferencia:[],modalDetalle:!1,dataModal:{},config:{FH_TRANSFERENCIA_I:{component:"date"},FH_FIN:{component:"date"},ACCIONES:{flat:!0,round:!0,component:"button",permisos:{ver:"=== 3"},icon:["reply as regresar"],tooltip:{ver:"Ver Detalles",regresar:"Regresar Activos"},ver:function(e){},regresar:function(e){this.$emit("devolver",e.ID,e)},intercambiar:function(e){this.$emit("intercambio",e.ID,e)},imprimir:function(e){this.modalDetalle=!0,this.dataModal=e},validate:{}},flat:!0,round:!0,color:"primary"}}},methods:{url:function(e){return(0,B["default"])().api+"/AfTransferenciaController/getConstancia"+"?ID_TRANSFERENCIA=".concat(e.ID,"&itdipo=").concat(e.ID_TIPO,"&token2=").concat((0,B["default"])().token,"&access_token=").concat((0,B["default"])().token)},nuevaTransferencia:function(e){this.$emit("cambiarVentana",this.modoTrans)},buscarTransferencia:function(e){13===e.which&&this.filtrarTransferencias({ID:this.searchCod})},filtrarTransferencias:function(e){var a=this;return y()(M()().m(function n(){return M()().w(function(n){while(1)switch(n.n){case 0:if(a.dataCatalogosBase=[],e||(e={FECHAI:a.F_INICIO,FECHAF:a.F_FIN}),e.general=!0,!e){n.n=2;break}return n.n=1,a.$http.get("api/AfTransferenciaController/getAfTransferencia",{params:{parametros:e}});case 1:a.dataCatalogosBase=n.v;case 2:a.filterTransferencias();case 3:return n.a(2)}},n)}))()},modalAddTrans:function(){this.showModal=!0,this.modoTrans="individual"},init:function(){var e=this;return y()(M()().m(function a(){return M()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,e.$http.get("api/AfCatalogoController/getAfCatalogo");case 1:e.dataCatalogosBase=a.v,e.filtrarTransferencias();case 2:return a.a(2)}},a)}))()},filterTransferencias:function(){var e=s()(this.dataCatalogosBase);this.search&&this.search.length>0?this.dataTransferencias=(0,fe.filterArray)(this.search,{field:["NOMPERSONA","ID_ACTIVO_TXT"],list:e})||[]:this.dataTransferencias=s()(this.dataCatalogosBase)}},computed:{cargando:function(){return this.dataCatalogosBase.length>0},buttons:function(){var e=[];return 3===(0,B["default"])().ruta.nivel&&e.push({label:"Transferir",icon:"add",click:this.modalAddTrans}),e}},mounted:function(){var e=this;return y()(M()().m(function a(){var n,t,o,l;return M()().w(function(a){while(1)switch(a.n){case 0:return a.n=1,e.$http.get("api/AfActivoController/getCargaInicial",{params:{isNuevo:!1}});case 1:return n=a.v,t=n.tipoTransferencia,e.config.ID_TIPO={component:"select",options:t,optionValue:"ID",optionLabel:"DESCRIPCION",edit:!1},a.n=2,e.$http.get("api/AfPlantillaController/getAfPlantilla",{params:{parametros:{id:3}}});case 2:o=a.v,e.filtrarTransferencias(),l={},o.forEach(function(e){l[e.TIPO_DETALLE]=e.ESTADO}),e.config.ACCIONES.icon.push("print as imprimir"),e.config.ACCIONES.validate={imprimir:function(e){return 1===l[e.ID_TIPO]},regresar:function(e){return e.CANT>0},intercambiar:function(e){return e.CANT>0}};case 3:return a.a(2)}},a)}))()}};const ve=(0,ee.A)(pe,[["render",de]]);var be=ve,ge=n(55824),he={components:{individual:r.A,bloque:ne,listado:be,devolver:ge.A,QPage:l.Tu},data:function(){return{menuSelect:"listado",titulo:null,devolucionId:null,dataEdit:{},transferenciaData:{}}},methods:{printxls:function(){},cambiarEstado:function(e,a){this.menuSelect=e,this.dataEdit={},a&&0!==Object.keys(a).length?(this.dataEdit=a,this.titulo="Editar "+a.DESCRIPCION):this.titulo="Nuevo Catálogo"},devolver:function(e,a){this.devolucionId=e,this.transferenciaData=a,this.menuSelect="devolver"}}};const Oe=(0,ee.A)(he,[["render",o]]);var Ne=Oe}}]);